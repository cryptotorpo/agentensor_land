const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DdXaTUle.js","./MmZK_szb.js","./entry.Bp2ActUd.css"])))=>i.map(i=>d[i]);
import{s as Ya,d as $w,r as B5,o as eS,a as tS,b as iS,v as rS}from"./MmZK_szb.js";var sS=Object.create,ud=Object.defineProperty,aS=Object.getOwnPropertyDescriptor,nS=Object.getOwnPropertyNames,oS=Object.getPrototypeOf,lS=Object.prototype.hasOwnProperty,hS=(e,t,i)=>t in e?ud(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,sa=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),cS=(e,t)=>{for(var i in t)ud(e,i,{get:t[i],enumerable:!0})},dS=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of nS(t))!lS.call(e,s)&&s!==i&&ud(e,s,{get:()=>t[s],enumerable:!(r=aS(t,s))||r.enumerable});return e},aa=(e,t,i)=>(i=e!=null?sS(oS(e)):{},dS(t||!e||!e.__esModule?ud(i,"default",{value:e,enumerable:!0}):i,e)),gn=(e,t,i)=>(hS(e,typeof t!="symbol"?t+"":t,i),i),uS=sa((e,t)=>{(function(i,r){typeof e=="object"?t.exports=r():typeof define=="function"&&define.amd?define(r):i.Alea=r()})(e,function(){return i.importState=function(s){var a=new i;return a.importState(s),a},i;function i(){return function(s){var a=0,n=0,o=0,l=1;s.length==0&&(s=[+new Date]);var h=r();a=h(" "),n=h(" "),o=h(" ");for(var c=0;c<s.length;c++)a-=h(s[c]),a<0&&(a+=1),n-=h(s[c]),n<0&&(n+=1),o-=h(s[c]),o<0&&(o+=1);h=null;var d=function(){var u=2091639*a+l*23283064365386963e-26;return a=n,n=o,o=u-(l=u|0)};return d.next=d,d.uint32=function(){return d()*4294967296},d.fract53=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.version="Alea 0.9",d.args=s,d.exportState=function(){return[a,n,o,l]},d.importState=function(u){a=+u[0]||0,n=+u[1]||0,o=+u[2]||0,l=+u[3]||0},d}(Array.prototype.slice.call(arguments))}function r(){var s=4022871197,a=function(n){n=n.toString();for(var o=0;o<n.length;o++){s+=n.charCodeAt(o);var l=.02519603282416938*s;s=l>>>0,l-=s,l*=s,s=l>>>0,l-=s,s+=l*4294967296}return(s>>>0)*23283064365386963e-26};return a.version="Mash 0.9",a}})}),Z7=sa((e,t)=>{(function(i,r){typeof e=="object"&&typeof t<"u"?r(e):typeof define=="function"&&define.amd?define(["exports"],r):r((i=typeof globalThis<"u"?globalThis:i||self).SVDJS={})})(e,function(i){i.SVD=function(r,s,a,n,o){if(s=s===void 0||s,a=a===void 0||a,o=1e-64/(n=n||Math.pow(2,-52)),!r)throw new TypeError("Matrix a is not defined");var l,h,c,d,u,p,f,g,m,v,y,x,w=r[0].length,_=r.length;if(_<w)throw new TypeError("Invalid matrix: m < n");for(var b=[],A=[],S=[],M=s==="f"?_:w,C=v=f=0;C<_;C++)A[C]=new Array(M).fill(0);for(C=0;C<w;C++)S[C]=new Array(w).fill(0);var T,P=new Array(w).fill(0);for(C=0;C<_;C++)for(l=0;l<w;l++)A[C][l]=r[C][l];for(C=0;C<w;C++){for(b[C]=f,m=0,c=C+1,l=C;l<_;l++)m+=Math.pow(A[l][C],2);if(m<o)f=0;else for(g=(p=A[C][C])*(f=p<0?Math.sqrt(m):-Math.sqrt(m))-m,A[C][C]=p-f,l=c;l<w;l++){for(m=0,h=C;h<_;h++)m+=A[h][C]*A[h][l];for(p=m/g,h=C;h<_;h++)A[h][l]=A[h][l]+p*A[h][C]}for(P[C]=f,m=0,l=c;l<w;l++)m+=Math.pow(A[C][l],2);if(m<o)f=0;else{for(g=(p=A[C][C+1])*(f=p<0?Math.sqrt(m):-Math.sqrt(m))-m,A[C][C+1]=p-f,l=c;l<w;l++)b[l]=A[C][l]/g;for(l=c;l<_;l++){for(m=0,h=c;h<w;h++)m+=A[l][h]*A[C][h];for(h=c;h<w;h++)A[l][h]=A[l][h]+m*b[h]}}v<(y=Math.abs(P[C])+Math.abs(b[C]))&&(v=y)}if(a)for(C=w-1;0<=C;C--){if(f!==0){for(g=A[C][C+1]*f,l=c;l<w;l++)S[l][C]=A[C][l]/g;for(l=c;l<w;l++){for(m=0,h=c;h<w;h++)m+=A[C][h]*S[h][l];for(h=c;h<w;h++)S[h][l]=S[h][l]+m*S[h][C]}}for(l=c;l<w;l++)S[C][l]=0,S[l][C]=0;S[C][C]=1,f=b[C],c=C}if(s){if(s==="f")for(C=w;C<_;C++){for(l=w;l<_;l++)A[C][l]=0;A[C][C]=1}for(C=w-1;0<=C;C--){for(c=C+1,f=P[C],l=c;l<M;l++)A[C][l]=0;if(f!==0){for(g=A[C][C]*f,l=c;l<M;l++){for(m=0,h=c;h<_;h++)m+=A[h][C]*A[h][l];for(p=m/g,h=C;h<_;h++)A[h][l]=A[h][l]+p*A[h][C]}for(l=C;l<_;l++)A[l][C]=A[l][C]/f}else for(l=C;l<_;l++)A[l][C]=0;A[C][C]=A[C][C]+1}}for(n*=v,h=w-1;0<=h;h--)for(var I=0;I<50;I++){for(T=!1,c=h;0<=c;c--){if(Math.abs(b[c])<=n){T=!0;break}if(Math.abs(P[c-1])<=n)break}if(!T){for(u=0,d=c-(m=1),C=c;C<h+1&&(p=m*b[C],b[C]=u*b[C],!(Math.abs(p)<=n));C++)if(f=P[C],P[C]=Math.sqrt(p*p+f*f),u=f/(g=P[C]),m=-p/g,s)for(l=0;l<_;l++)y=A[l][d],x=A[l][C],A[l][d]=y*u+x*m,A[l][C]=-y*m+x*u}if(x=P[h],c===h){if(x<0&&(P[h]=-x,a))for(l=0;l<w;l++)S[l][h]=-S[l][h];break}for(v=P[c],p=(((y=P[h-1])-x)*(y+x)+((f=b[h-1])-(g=b[h]))*(f+g))/(2*g*y),f=Math.sqrt(p*p+1),p=((v-x)*(v+x)+g*(y/(p<0?p-f:p+f)-g))/v,C=c+(m=u=1);C<h+1;C++){if(f=b[C],y=P[C],g=m*f,f*=u,x=Math.sqrt(p*p+g*g),p=v*(u=p/(b[C-1]=x))+f*(m=g/x),f=-v*m+f*u,g=y*m,y*=u,a)for(l=0;l<w;l++)v=S[l][C-1],x=S[l][C],S[l][C-1]=v*u+x*m,S[l][C]=-v*m+x*u;if(x=Math.sqrt(p*p+g*g),p=(u=p/(P[C-1]=x))*f+(m=g/x)*y,v=-m*f+u*y,s)for(l=0;l<_;l++)y=A[l][C-1],x=A[l][C],A[l][C-1]=y*u+x*m,A[l][C]=-y*m+x*u}b[c]=0,b[h]=p,P[h]=v}for(C=0;C<w;C++)P[C]<n&&(P[C]=0);return{u:A,q:P,v:S}},i.VERSION="1.1.1",Object.defineProperty(i,"__esModule",{value:!0})})}),pS=sa((e,t)=>{(function(i,r){typeof e=="object"&&typeof t<"u"?t.exports=r():typeof define=="function"&&define.amd?define(r):(i=i||self,i.TinyQueue=r())})(e,function(){var i=function(s,a){if(s===void 0&&(s=[]),a===void 0&&(a=r),this.data=s,this.length=this.data.length,this.compare=a,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)};i.prototype.push=function(s){this.data.push(s),this.length++,this._up(this.length-1)},i.prototype.pop=function(){if(this.length!==0){var s=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),s}},i.prototype.peek=function(){return this.data[0]},i.prototype._up=function(s){for(var a=this,n=a.data,o=a.compare,l=n[s];s>0;){var h=s-1>>1,c=n[h];if(o(l,c)>=0)break;n[s]=c,s=h}n[s]=l},i.prototype._down=function(s){for(var a=this,n=a.data,o=a.compare,l=this.length>>1,h=n[s];s<l;){var c=(s<<1)+1,d=n[c],u=c+1;if(u<this.length&&o(n[u],d)<0&&(c=u,d=n[u]),o(d,h)>=0)break;n[s]=d,s=c}n[s]=h};function r(s,a){return s<a?-1:s>a?1:0}return i})}),fS=sa((e,t)=>{var i=pS();i.default&&(i=i.default),t.exports=r,t.exports.default=r;function r(h,c,d){c=c||1;for(var u,p,f,g,m=0;m<h[0].length;m++){var v=h[0][m];(!m||v[0]<u)&&(u=v[0]),(!m||v[1]<p)&&(p=v[1]),(!m||v[0]>f)&&(f=v[0]),(!m||v[1]>g)&&(g=v[1])}var y=f-u,x=g-p,w=Math.min(y,x),_=w/2;if(w===0){var b=[u,p];return b.distance=0,b}for(var A=new i(void 0,s),S=u;S<f;S+=w)for(var M=p;M<g;M+=w)A.push(new a(S+_,M+_,_,h));var C=o(h),T=new a(u+y/2,p+x/2,0,h);T.d>C.d&&(C=T);for(var P=A.length;A.length;){var I=A.pop();I.d>C.d&&(C=I,d&&Math.round(1e4*I.d)/1e4),!(I.max-C.d<=c)&&(_=I.h/2,A.push(new a(I.x-_,I.y-_,_,h)),A.push(new a(I.x+_,I.y-_,_,h)),A.push(new a(I.x-_,I.y+_,_,h)),A.push(new a(I.x+_,I.y+_,_,h)),P+=4)}d&&(""+P,""+C.d);var D=[C.x,C.y];return D.distance=C.d,D}function s(h,c){return c.max-h.max}function a(h,c,d,u){this.x=h,this.y=c,this.h=d,this.d=n(h,c,u),this.max=this.d+this.h*Math.SQRT2}function n(h,c,d){for(var u=!1,p=1/0,f=0;f<d.length;f++)for(var g=d[f],m=0,v=g.length,y=v-1;m<v;y=m++){var x=g[m],w=g[y];x[1]>c!=w[1]>c&&h<(w[0]-x[0])*(c-x[1])/(w[1]-x[1])+x[0]&&(u=!u),p=Math.min(p,l(h,c,x,w))}return p===0?0:(u?1:-1)*Math.sqrt(p)}function o(h){for(var c=0,d=0,u=0,p=h[0],f=0,g=p.length,m=g-1;f<g;m=f++){var v=p[f],y=p[m],x=v[0]*y[1]-y[0]*v[1];d+=(v[0]+y[0])*x,u+=(v[1]+y[1])*x,c+=x*3}return c===0?new a(p[0][0],p[0][1],0,h):new a(d/c,u/c,0,h)}function l(h,c,d,u){var p=d[0],f=d[1],g=u[0]-p,m=u[1]-f;if(g!==0||m!==0){var v=((h-p)*g+(c-f)*m)/(g*g+m*m);v>1?(p=u[0],f=u[1]):v>0&&(p+=g*v,f+=m*v)}return g=h-p,m=c-f,g*g+m*m}}),mS=sa((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=i;function i(r){if(r===null||r===!0||r===!1)return NaN;var s=Number(r);return isNaN(s)?s:s<0?Math.ceil(s):Math.floor(s)}t.exports=e.default}),gS=sa((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=i;function i(r){var s=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return s.setUTCFullYear(r.getFullYear()),r.getTime()-s.getTime()}t.exports=e.default}),vS=sa((e,t)=>{function i(a,n){function o(){this.constructor=a}o.prototype=n.prototype,a.prototype=new o}function r(a,n,o,l){this.message=a,this.expected=n,this.found=o,this.location=l,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,r)}i(r,Error),r.buildMessage=function(a,n){var o={literal:function(f){return'"'+h(f.text)+'"'},class:function(f){var g="",m;for(m=0;m<f.parts.length;m++)g+=f.parts[m]instanceof Array?c(f.parts[m][0])+"-"+c(f.parts[m][1]):c(f.parts[m]);return"["+(f.inverted?"^":"")+g+"]"},any:function(f){return"any character"},end:function(f){return"end of input"},other:function(f){return f.description}};function l(f){return f.charCodeAt(0).toString(16).toUpperCase()}function h(f){return f.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(g){return"\\x0"+l(g)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(g){return"\\x"+l(g)})}function c(f){return f.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(g){return"\\x0"+l(g)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(g){return"\\x"+l(g)})}function d(f){return o[f.type](f)}function u(f){var g=new Array(f.length),m,v;for(m=0;m<f.length;m++)g[m]=d(f[m]);if(g.sort(),g.length>0){for(m=1,v=1;m<g.length;m++)g[m-1]!==g[m]&&(g[v]=g[m],v++);g.length=v}switch(g.length){case 1:return g[0];case 2:return g[0]+" or "+g[1];default:return g.slice(0,-1).join(", ")+", or "+g[g.length-1]}}function p(f){return f?'"'+h(f)+'"':"end of input"}return"Expected "+u(a)+" but "+p(n)+" found."};function s(a,n){n=n!==void 0?n:{};var o={},l={svg_path:ti},h=ti,c=function(O){if(!O)return[];for(var L=[],q=0;q<O.length;q++)L=L.concat.apply(L,O[q]);var z=L[0];return z&&z.code=="m"&&(delete z.relative,z.code="M"),L},d=function(O,L){return xs(O,L)},u=/^[Mm]/,p=Le(["M","m"],!1,!1),f=function(O,L,q){var z=Ur(O,[L]);return q&&(z=z.concat(Ur(O=="M"?"L":"l",q[1]))),z},g=/^[Zz]/,m=Le(["Z","z"],!1,!1),v=function(){return Ur("Z")},y=/^[Ll]/,x=Le(["L","l"],!1,!1),w=function(O,L){return Ur(O,L)},_=/^[Hh]/,b=Le(["H","h"],!1,!1),A=function(O,L){return Ur(O,L.map(function(q){return{x:q}}))},S=/^[Vv]/,M=Le(["V","v"],!1,!1),C=function(O,L){return Ur(O,L.map(function(q){return{y:q}}))},T=/^[Cc]/,P=Le(["C","c"],!1,!1),I=function(O,L,q){return{x1:O.x,y1:O.y,x2:L.x,y2:L.y,x:q.x,y:q.y}},D=/^[Ss]/,k=Le(["S","s"],!1,!1),H=function(O,L){return{x2:O.x,y2:O.y,x:L.x,y:L.y}},U=/^[Qq]/,F=Le(["Q","q"],!1,!1),Z=function(O,L){return{x1:O.x,y1:O.y,x:L.x,y:L.y}},W=/^[Tt]/,G=Le(["T","t"],!1,!1),X=/^[Aa]/,ee=Le(["A","a"],!1,!1),Y=function(O,L,q,z,J,_e){return{rx:O,ry:L,xAxisRotation:q,largeArc:z,sweep:J,x:_e.x,y:_e.y}},$=function(O,L){return{x:O,y:L}},Q=function(O){return O*1},le=function(O){return O.join("")*1},re=/^[01]/,te=Le(["0","1"],!1,!1),ne=function(O){return O=="1"},ce=function(){return""},pe=",",xe=Ve(",",!1),Re=function(O){return O.join("")},Ae=".",Ne=Ve(".",!1),Fe=/^[eE]/,Ee=Le(["e","E"],!1,!1),Me=/^[+\-]/,Ye=Le(["+","-"],!1,!1),He=/^[0-9]/,V=Le([["0","9"]],!1,!1),B=function(O){return O.join("")},ae=/^[ \t\n\r]/,Se=Le([" ","	",`
`,"\r"],!1,!1),R=0,Ce=[{line:1,column:1}],Ue=0,Ie=[],de;if("startRule"in n){if(!(n.startRule in l))throw new Error(`Can't start parsing from rule "`+n.startRule+'".');h=l[n.startRule]}function Ve(O,L){return{type:"literal",text:O,ignoreCase:L}}function Le(O,L,q){return{type:"class",parts:O,inverted:L,ignoreCase:q}}function We(){return{type:"end"}}function $e(O){var L=Ce[O],q;if(L)return L;for(q=O-1;!Ce[q];)q--;for(L=Ce[q],L={line:L.line,column:L.column};q<O;)a.charCodeAt(q)===10?(L.line++,L.column=1):L.column++,q++;return Ce[O]=L,L}function Xe(O,L){var q=$e(O),z=$e(L);return{start:{offset:O,line:q.line,column:q.column},end:{offset:L,line:z.line,column:z.column}}}function Ze(O){R<Ue||(R>Ue&&(Ue=R,Ie=[]),Ie.push(O))}function Ht(O,L,q){return new r(r.buildMessage(O,L),O,L,q)}function ti(){var O,L,q,z,J;for(O=R,L=[],q=xt();q!==o;)L.push(q),q=xt();if(L!==o)if(q=K(),q===o&&(q=null),q!==o){for(z=[],J=xt();J!==o;)z.push(J),J=xt();z!==o?(L=c(q),O=L):(R=O,O=o)}else R=O,O=o;else R=O,O=o;return O}function K(){var O,L,q,z,J,_e;if(O=R,L=fe(),L!==o){for(q=[],z=R,J=[],_e=xt();_e!==o;)J.push(_e),_e=xt();for(J!==o?(_e=fe(),_e!==o?(J=[J,_e],z=J):(R=z,z=o)):(R=z,z=o);z!==o;){for(q.push(z),z=R,J=[],_e=xt();_e!==o;)J.push(_e),_e=xt();J!==o?(_e=fe(),_e!==o?(J=[J,_e],z=J):(R=z,z=o)):(R=z,z=o)}q!==o?(L=d(L,q),O=L):(R=O,O=o)}else R=O,O=o;return O}function fe(){var O,L,q,z,J,_e;if(O=R,L=Be(),L!==o){for(q=[],z=R,J=[],_e=xt();_e!==o;)J.push(_e),_e=xt();for(J!==o?(_e=be(),_e!==o?(J=[J,_e],z=J):(R=z,z=o)):(R=z,z=o);z!==o;){for(q.push(z),z=R,J=[],_e=xt();_e!==o;)J.push(_e),_e=xt();J!==o?(_e=be(),_e!==o?(J=[J,_e],z=J):(R=z,z=o)):(R=z,z=o)}q!==o?(L=d(L,q),O=L):(R=O,O=o)}else R=O,O=o;return O}function be(){var O;return O=rt(),O===o&&(O=At(),O===o&&(O=ki(),O===o&&(O=Qt(),O===o&&(O=pr(),O===o&&(O=Ud(),O===o&&(O=N(),O===o&&(O=se(),O===o&&(O=qe())))))))),O}function Be(){var O,L,q,z,J,_e,bs;if(O=R,u.test(a.charAt(R))?(L=a.charAt(R),R++):(L=o,Ze(p)),L!==o){for(q=[],z=xt();z!==o;)q.push(z),z=xt();q!==o?(z=st(),z!==o?(J=R,_e=yt(),_e===o&&(_e=null),_e!==o?(bs=di(),bs!==o?(_e=[_e,bs],J=_e):(R=J,J=o)):(R=J,J=o),J===o&&(J=null),J!==o?(L=f(L,z,J),O=L):(R=O,O=o)):(R=O,O=o)):(R=O,O=o)}else R=O,O=o;return O}function rt(){var O,L;return O=R,g.test(a.charAt(R))?(L=a.charAt(R),R++):(L=o,Ze(m)),L!==o&&(L=v()),O=L,O}function At(){var O,L,q,z;if(O=R,y.test(a.charAt(R))?(L=a.charAt(R),R++):(L=o,Ze(x)),L!==o){for(q=[],z=xt();z!==o;)q.push(z),z=xt();q!==o?(z=di(),z!==o?(L=w(L,z),O=L):(R=O,O=o)):(R=O,O=o)}else R=O,O=o;return O}function di(){var O,L,q,z,J,_e;if(O=R,L=st(),L!==o){for(q=[],z=R,J=yt(),J===o&&(J=null),J!==o?(_e=st(),_e!==o?(J=[J,_e],z=J):(R=z,z=o)):(R=z,z=o);z!==o;)q.push(z),z=R,J=yt(),J===o&&(J=null),J!==o?(_e=st(),_e!==o?(J=[J,_e],z=J):(R=z,z=o)):(R=z,z=o);q!==o?(L=d(L,q),O=L):(R=O,O=o)}else R=O,O=o;return O}function ki(){var O,L,q,z;if(O=R,_.test(a.charAt(R))?(L=a.charAt(R),R++):(L=o,Ze(b)),L!==o){for(q=[],z=xt();z!==o;)q.push(z),z=xt();q!==o?(z=kr(),z!==o?(L=A(L,z),O=L):(R=O,O=o)):(R=O,O=o)}else R=O,O=o;return O}function kr(){var O,L,q,z,J,_e;if(O=R,L=wt(),L!==o){for(q=[],z=R,J=yt(),J===o&&(J=null),J!==o?(_e=wt(),_e!==o?(J=[J,_e],z=J):(R=z,z=o)):(R=z,z=o);z!==o;)q.push(z),z=R,J=yt(),J===o&&(J=null),J!==o?(_e=wt(),_e!==o?(J=[J,_e],z=J):(R=z,z=o)):(R=z,z=o);q!==o?(L=d(L,q),O=L):(R=O,O=o)}else R=O,O=o;return O}function Qt(){var O,L,q,z;if(O=R,S.test(a.charAt(R))?(L=a.charAt(R),R++):(L=o,Ze(M)),L!==o){for(q=[],z=xt();z!==o;)q.push(z),z=xt();q!==o?(z=kr(),z!==o?(L=C(L,z),O=L):(R=O,O=o)):(R=O,O=o)}else R=O,O=o;return O}function pr(){var O,L,q,z;if(O=R,T.test(a.charAt(R))?(L=a.charAt(R),R++):(L=o,Ze(P)),L!==o){for(q=[],z=xt();z!==o;)q.push(z),z=xt();q!==o?(z=O1(),z!==o?(L=w(L,z),O=L):(R=O,O=o)):(R=O,O=o)}else R=O,O=o;return O}function O1(){var O,L,q,z,J,_e;if(O=R,L=Yn(),L!==o){for(q=[],z=R,J=yt(),J===o&&(J=null),J!==o?(_e=Yn(),_e!==o?(J=[J,_e],z=J):(R=z,z=o)):(R=z,z=o);z!==o;)q.push(z),z=R,J=yt(),J===o&&(J=null),J!==o?(_e=Yn(),_e!==o?(J=[J,_e],z=J):(R=z,z=o)):(R=z,z=o);q!==o?(L=d(L,q),O=L):(R=O,O=o)}else R=O,O=o;return O}function Yn(){var O,L,q,z,J,_e;return O=R,L=st(),L!==o?(q=yt(),q===o&&(q=null),q!==o?(z=st(),z!==o?(J=yt(),J===o&&(J=null),J!==o?(_e=st(),_e!==o?(L=I(L,z,_e),O=L):(R=O,O=o)):(R=O,O=o)):(R=O,O=o)):(R=O,O=o)):(R=O,O=o),O}function Ud(){var O,L,q,z;if(O=R,D.test(a.charAt(R))?(L=a.charAt(R),R++):(L=o,Ze(k)),L!==o){for(q=[],z=xt();z!==o;)q.push(z),z=xt();q!==o?(z=Nd(),z!==o?(L=w(L,z),O=L):(R=O,O=o)):(R=O,O=o)}else R=O,O=o;return O}function Nd(){var O,L,q,z,J,_e;if(O=R,L=Rl(),L!==o){for(q=[],z=R,J=yt(),J===o&&(J=null),J!==o?(_e=Rl(),_e!==o?(J=[J,_e],z=J):(R=z,z=o)):(R=z,z=o);z!==o;)q.push(z),z=R,J=yt(),J===o&&(J=null),J!==o?(_e=Rl(),_e!==o?(J=[J,_e],z=J):(R=z,z=o)):(R=z,z=o);q!==o?(L=d(L,q),O=L):(R=O,O=o)}else R=O,O=o;return O}function Rl(){var O,L,q,z;return O=R,L=st(),L!==o?(q=yt(),q===o&&(q=null),q!==o?(z=st(),z!==o?(L=H(L,z),O=L):(R=O,O=o)):(R=O,O=o)):(R=O,O=o),O}function N(){var O,L,q,z;if(O=R,U.test(a.charAt(R))?(L=a.charAt(R),R++):(L=o,Ze(F)),L!==o){for(q=[],z=xt();z!==o;)q.push(z),z=xt();q!==o?(z=oe(),z!==o?(L=w(L,z),O=L):(R=O,O=o)):(R=O,O=o)}else R=O,O=o;return O}function oe(){var O,L,q,z,J,_e;if(O=R,L=me(),L!==o){for(q=[],z=R,J=yt(),J===o&&(J=null),J!==o?(_e=me(),_e!==o?(J=[J,_e],z=J):(R=z,z=o)):(R=z,z=o);z!==o;)q.push(z),z=R,J=yt(),J===o&&(J=null),J!==o?(_e=me(),_e!==o?(J=[J,_e],z=J):(R=z,z=o)):(R=z,z=o);q!==o?(L=d(L,q),O=L):(R=O,O=o)}else R=O,O=o;return O}function me(){var O,L,q,z;return O=R,L=st(),L!==o?(q=yt(),q===o&&(q=null),q!==o?(z=st(),z!==o?(L=Z(L,z),O=L):(R=O,O=o)):(R=O,O=o)):(R=O,O=o),O}function se(){var O,L,q,z;if(O=R,W.test(a.charAt(R))?(L=a.charAt(R),R++):(L=o,Ze(G)),L!==o){for(q=[],z=xt();z!==o;)q.push(z),z=xt();q!==o?(z=ge(),z!==o?(L=w(L,z),O=L):(R=O,O=o)):(R=O,O=o)}else R=O,O=o;return O}function ge(){var O,L,q,z,J,_e;if(O=R,L=st(),L!==o){for(q=[],z=R,J=yt(),J===o&&(J=null),J!==o?(_e=st(),_e!==o?(J=[J,_e],z=J):(R=z,z=o)):(R=z,z=o);z!==o;)q.push(z),z=R,J=yt(),J===o&&(J=null),J!==o?(_e=st(),_e!==o?(J=[J,_e],z=J):(R=z,z=o)):(R=z,z=o);q!==o?(L=d(L,q),O=L):(R=O,O=o)}else R=O,O=o;return O}function qe(){var O,L,q,z;if(O=R,X.test(a.charAt(R))?(L=a.charAt(R),R++):(L=o,Ze(ee)),L!==o){for(q=[],z=xt();z!==o;)q.push(z),z=xt();q!==o?(z=ut(),z!==o?(L=w(L,z),O=L):(R=O,O=o)):(R=O,O=o)}else R=O,O=o;return O}function ut(){var O,L,q,z,J,_e;if(O=R,L=vt(),L!==o){for(q=[],z=R,J=yt(),J===o&&(J=null),J!==o?(_e=vt(),_e!==o?(J=[J,_e],z=J):(R=z,z=o)):(R=z,z=o);z!==o;)q.push(z),z=R,J=yt(),J===o&&(J=null),J!==o?(_e=vt(),_e!==o?(J=[J,_e],z=J):(R=z,z=o)):(R=z,z=o);q!==o?(L=d(L,q),O=L):(R=O,O=o)}else R=O,O=o;return O}function vt(){var O,L,q,z,J,_e,bs,Vd,xh,jd,bh,Gd;return O=R,L=zt(),L!==o?(q=yt(),q===o&&(q=null),q!==o?(z=zt(),z!==o?(J=yt(),J===o&&(J=null),J!==o?(_e=wt(),_e!==o?(bs=yt(),bs!==o?(Vd=Mt(),Vd!==o?(xh=yt(),xh===o&&(xh=null),xh!==o?(jd=Mt(),jd!==o?(bh=yt(),bh===o&&(bh=null),bh!==o?(Gd=st(),Gd!==o?(L=Y(L,z,_e,Vd,jd,Gd),O=L):(R=O,O=o)):(R=O,O=o)):(R=O,O=o)):(R=O,O=o)):(R=O,O=o)):(R=O,O=o)):(R=O,O=o)):(R=O,O=o)):(R=O,O=o)):(R=O,O=o)):(R=O,O=o),O}function st(){var O,L,q,z;return O=R,L=wt(),L!==o?(q=yt(),q===o&&(q=null),q!==o?(z=wt(),z!==o?(L=$(L,z),O=L):(R=O,O=o)):(R=O,O=o)):(R=O,O=o),O}function zt(){var O,L;return O=R,L=X1(),L===o&&(L=fr()),L!==o&&(L=Q(L)),O=L,O}function wt(){var O,L,q,z;return O=R,L=R,q=St(),q===o&&(q=null),q!==o?(z=X1(),z!==o?(q=[q,z],L=q):(R=L,L=o)):(R=L,L=o),L===o&&(L=R,q=St(),q===o&&(q=null),q!==o?(z=fr(),z!==o?(q=[q,z],L=q):(R=L,L=o)):(R=L,L=o)),L!==o&&(L=le(L)),O=L,O}function Mt(){var O,L;return O=R,re.test(a.charAt(R))?(L=a.charAt(R),R++):(L=o,Ze(te)),L!==o&&(L=ne(L)),O=L,O}function yt(){var O,L,q,z,J;if(O=R,L=[],q=xt(),q!==o)for(;q!==o;)L.push(q),q=xt();else L=o;if(L!==o)if(q=h1(),q===o&&(q=null),q!==o){for(z=[],J=xt();J!==o;)z.push(J),J=xt();z!==o?(L=[L,q,z],O=L):(R=O,O=o)}else R=O,O=o;else R=O,O=o;if(O===o){if(O=R,L=R,q=h1(),q!==o){for(z=[],J=xt();J!==o;)z.push(J),J=xt();z!==o?(q=[q,z],L=q):(R=L,L=o)}else R=L,L=o;L!==o&&(L=ce()),O=L}return O}function h1(){var O;return a.charCodeAt(R)===44?(O=pe,R++):(O=o,Ze(xe)),O}function X1(){var O,L,q,z;return O=R,L=R,q=ys(),q!==o?(z=ii(),z===o&&(z=null),z!==o?(q=[q,z],L=q):(R=L,L=o)):(R=L,L=o),L===o&&(L=R,q=fr(),q!==o?(z=ii(),z!==o?(q=[q,z],L=q):(R=L,L=o)):(R=L,L=o)),L!==o&&(L=Re(L)),O=L,O}function ys(){var O,L,q,z,J;return O=R,L=R,q=fr(),q===o&&(q=null),q!==o?(a.charCodeAt(R)===46?(z=Ae,R++):(z=o,Ze(Ne)),z!==o?(J=fr(),J!==o?(q=[q,z,J],L=q):(R=L,L=o)):(R=L,L=o)):(R=L,L=o),L===o&&(L=R,q=fr(),q!==o?(a.charCodeAt(R)===46?(z=Ae,R++):(z=o,Ze(Ne)),z!==o?(q=[q,z],L=q):(R=L,L=o)):(R=L,L=o)),L!==o&&(L=Re(L)),O=L,O}function ii(){var O,L,q,z,J;return O=R,L=R,Fe.test(a.charAt(R))?(q=a.charAt(R),R++):(q=o,Ze(Ee)),q!==o?(z=St(),z===o&&(z=null),z!==o?(J=fr(),J!==o?(q=[q,z,J],L=q):(R=L,L=o)):(R=L,L=o)):(R=L,L=o),L!==o&&(L=Re(L)),O=L,O}function St(){var O;return Me.test(a.charAt(R))?(O=a.charAt(R),R++):(O=o,Ze(Ye)),O}function fr(){var O,L,q;if(O=R,L=[],He.test(a.charAt(R))?(q=a.charAt(R),R++):(q=o,Ze(V)),q!==o)for(;q!==o;)L.push(q),He.test(a.charAt(R))?(q=a.charAt(R),R++):(q=o,Ze(V));else L=o;return L!==o&&(L=B(L)),O=L,O}function xt(){var O,L;return O=R,ae.test(a.charAt(R))?(L=a.charAt(R),R++):(L=o,Ze(Se)),L!==o&&(L=ce()),O=L,O}function xs(O,L){if(!L)return[O];for(var q=[O],z=0,J=L.length;z<J;z++)q[z+1]=L[z][1];return q}var Za={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var la in Za)Za[la.toUpperCase()]=Za[la];function Ur(O,L){L||(L=[{}]);for(var q=L.length;q--;){var z={code:O,command:Za[O]};O==O.toLowerCase()&&(z.relative=!0);for(var J in L[q])z[J]=L[q][J];L[q]=z}return L}if(de=h(),de!==o&&R===a.length)return de;throw de!==o&&R<a.length&&Ze(We()),Ht(Ie,Ue<a.length?a.charAt(Ue):null,Ue<a.length?Xe(Ue,Ue+1):Xe(Ue,Ue))}t.exports={SyntaxError:r,parse:s}}),K7=sa((e,t)=>{var i=vS().parse;i.parseSVG=i,i.makeAbsolute=r,t.exports=i;function r(s){var a,n={x:0,y:0},o={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return s.forEach(function(l){l.command==="moveto"&&(a=l),l.x0=n.x,l.y0=n.y;for(var h in o)h in l&&(l[h]+=l.relative?l[o[h]]:0);"x"in l||(l.x=n.x),"y"in l||(l.y=n.y),l.relative=!1,l.code=l.code.toUpperCase(),l.command=="closepath"&&(l.x=a.x,l.y=a.y),n=l}),s}}),yS=sa((e,t)=>{t.exports=function(i,r){for(var s=i.split("."),a=r.split("."),n=0;n<3;n++){var o=Number(s[n]),l=Number(a[n]);if(o>l)return 1;if(l>o)return-1;if(!isNaN(o)&&isNaN(l))return 1;if(isNaN(o)&&!isNaN(l))return-1}return 0}}),gl="149",Q1={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},xS=0,z5=1,bS=2,Kf=1,wS=2,c2=3,Or=0,Yi=1,f1=2,Mi=0,Cn=1,F5=2,k5=3,U5=4,SS=5,Co=100,_S=101,AS=102,N5=103,V5=104,MS=200,ES=201,CS=202,TS=203,J7=204,$7=205,PS=206,DS=207,IS=208,OS=209,RS=210,LS=0,BS=1,zS=2,Zp=3,FS=4,kS=5,US=6,NS=7,ev=0,VS=1,jS=2,os=0,GS=1,HS=2,WS=3,qS=4,YS=5,tv=300,Ln=301,Bn=302,Kp=303,Jp=304,ih=306,Gs=1e3,ei=1001,$p=1002,Bt=1003,j5=1004,Hd=1005,gt=1006,XS=1007,tl=1008,y1=1009,QS=1010,ZS=1011,iv=1012,KS=1013,Hs=1014,_i=1015,Ks=1016,JS=1017,$S=1018,Tn=1020,e_=1021,Wi=1023,t_=1024,i_=1025,Pn=1026,zn=1027,r_=1028,s_=1029,lc=1030,a_=1031,rv=1033,Wd=33776,qd=33777,Yd=33778,Xd=33779,G5=35840,H5=35841,W5=35842,q5=35843,n_=36196,Y5=37492,X5=37496,Q5=37808,Z5=37809,K5=37810,J5=37811,$5=37812,em=37813,tm=37814,im=37815,rm=37816,sm=37817,am=37818,nm=37819,om=37820,lm=37821,Qd=36492,o_=36283,hm=36284,cm=36285,dm=36286,sv=2200,av=2201,Jf=2202,hc=2300,cc=2301,Zd=2302,Lo=2400,Bo=2401,dc=2402,$f=2500,l_=2501,Rr=3e3,ft=3001,na=3200,nv=3201,h_=0,c_=1,Jr="srgb",uc="srgb-linear",Kd=7680,d_=519,e3=35044,u_=35048,um="300 es",t3=1035,l1=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let i=this._listeners[e];if(i!==void 0){let r=i.indexOf(t);r!==-1&&i.splice(r,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let t=this._listeners[e.type];if(t!==void 0){e.target=this;let i=t.slice(0);for(let r=0,s=i.length;r<s;r++)i[r].call(this,e);e.target=null}}},c1=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],pm=1234567,x2=Math.PI/180,O2=180/Math.PI;function lr(){let e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(c1[e&255]+c1[e>>8&255]+c1[e>>16&255]+c1[e>>24&255]+"-"+c1[t&255]+c1[t>>8&255]+"-"+c1[t>>16&15|64]+c1[t>>24&255]+"-"+c1[i&63|128]+c1[i>>8&255]+"-"+c1[i>>16&255]+c1[i>>24&255]+c1[r&255]+c1[r>>8&255]+c1[r>>16&255]+c1[r>>24&255]).toLowerCase()}function wi(e,t,i){return Math.max(t,Math.min(i,e))}function e4(e,t){return(e%t+t)%t}function p_(e,t,i,r,s){return r+(e-t)*(s-r)/(i-t)}function f_(e,t,i){return e!==t?(i-e)/(t-e):0}function b2(e,t,i){return(1-i)*e+i*t}function m_(e,t,i,r){return b2(e,t,1-Math.exp(-i*r))}function g_(e,t=1){return t-Math.abs(e4(e,t*2)-t)}function v_(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t),e*e*(3-2*e))}function y_(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t),e*e*e*(e*(e*6-15)+10))}function x_(e,t){return e+Math.floor(Math.random()*(t-e+1))}function b_(e,t){return e+Math.random()*(t-e)}function w_(e){return e*(.5-Math.random())}function S_(e){e!==void 0&&(pm=e);let t=pm+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function __(e){return e*x2}function A_(e){return e*O2}function i3(e){return(e&e-1)===0&&e!==0}function ov(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function pc(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function M_(e,t,i,r,s){let a=Math.cos,n=Math.sin,o=a(i/2),l=n(i/2),h=a((t+r)/2),c=n((t+r)/2),d=a((t-r)/2),u=n((t-r)/2),p=a((r-t)/2),f=n((r-t)/2);switch(s){case"XYX":e.set(o*c,l*d,l*u,o*h);break;case"YZY":e.set(l*u,o*c,l*d,o*h);break;case"ZXZ":e.set(l*d,l*u,o*c,o*h);break;case"XZX":e.set(o*c,l*f,l*p,o*h);break;case"YXY":e.set(l*p,o*c,l*f,o*h);break;case"ZYZ":e.set(l*f,l*p,o*c,o*h);break;default:""+s}}function Ws(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function Xt(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw new Error("Invalid component type.")}}var Oe=Object.freeze({__proto__:null,DEG2RAD:x2,RAD2DEG:O2,ceilPowerOfTwo:ov,clamp:wi,damp:m_,degToRad:__,denormalize:Ws,euclideanModulo:e4,floorPowerOfTwo:pc,generateUUID:lr,inverseLerp:f_,isPowerOfTwo:i3,lerp:b2,mapLinear:p_,normalize:Xt,pingpong:g_,radToDeg:A_,randFloat:b_,randFloatSpread:w_,randInt:x_,seededRandom:S_,setQuaternionFromProperEuler:M_,smootherstep:y_,smoothstep:v_}),j=class{constructor(e=0,t=0){j.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*i-a*r+e.x,this.y=s*r+a*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Ai=class{constructor(){Ai.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,i,r,s,a,n,o,l){let h=this.elements;return h[0]=e,h[1]=r,h[2]=n,h[3]=t,h[4]=s,h[5]=o,h[6]=i,h[7]=a,h[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,r=t.elements,s=this.elements,a=i[0],n=i[3],o=i[6],l=i[1],h=i[4],c=i[7],d=i[2],u=i[5],p=i[8],f=r[0],g=r[3],m=r[6],v=r[1],y=r[4],x=r[7],w=r[2],_=r[5],b=r[8];return s[0]=a*f+n*v+o*w,s[3]=a*g+n*y+o*_,s[6]=a*m+n*x+o*b,s[1]=l*f+h*v+c*w,s[4]=l*g+h*y+c*_,s[7]=l*m+h*x+c*b,s[2]=d*f+u*v+p*w,s[5]=d*g+u*y+p*_,s[8]=d*m+u*x+p*b,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],a=e[4],n=e[5],o=e[6],l=e[7],h=e[8];return t*a*h-t*n*l-i*s*h+i*n*o+r*s*l-r*a*o}invert(){let e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],a=e[4],n=e[5],o=e[6],l=e[7],h=e[8],c=h*a-n*l,d=n*o-h*s,u=l*s-a*o,p=t*c+i*d+r*u;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);let f=1/p;return e[0]=c*f,e[1]=(r*l-h*i)*f,e[2]=(n*i-r*a)*f,e[3]=d*f,e[4]=(h*t-r*o)*f,e[5]=(r*s-n*t)*f,e[6]=u*f,e[7]=(i*o-l*t)*f,e[8]=(a*t-i*s)*f,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,a,n){let o=Math.cos(s),l=Math.sin(s);return this.set(i*o,i*l,-i*(o*a+l*n)+a+e,-r*l,r*o,-r*(-l*a+o*n)+n+t,0,0,1),this}scale(e,t){return this.premultiply(Jd.makeScale(e,t)),this}rotate(e){return this.premultiply(Jd.makeRotation(-e)),this}translate(e,t){return this.premultiply(Jd.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}},Jd=new Ai;function lv(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}var E_={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function wh(e,t){return new E_[e](t)}function R2(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function Dn(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function H0(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}var $d={[Jr]:{[uc]:Dn},[uc]:{[Jr]:H0}},b1={legacyMode:!0,get workingColorSpace(){return uc},set workingColorSpace(e){},convert:function(e,t,i){if(this.legacyMode||t===i||!t||!i)return e;if($d[t]&&$d[t][i]!==void 0){let r=$d[t][i];return e.r=r(e.r),e.g=r(e.g),e.b=r(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},hv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ti={r:0,g:0,b:0},mr={h:0,s:0,l:0},Sh={h:0,s:0,l:0};function eu(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*6*(2/3-i):e}function _h(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}var Je=class{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&i===void 0?this.set(e):this.setRGB(e,t,i)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Jr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,b1.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=b1.workingColorSpace){return this.r=e,this.g=t,this.b=i,b1.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=b1.workingColorSpace){if(e=e4(e,1),t=wi(t,0,1),i=wi(i,0,1),t===0)this.r=this.g=this.b=i;else{let s=i<=.5?i*(1+t):i+t-i*t,a=2*i-s;this.r=eu(a,s,e+1/3),this.g=eu(a,s,e),this.b=eu(a,s,e-1/3)}return b1.toWorkingColorSpace(this,r),this}setStyle(e,t=Jr){function i(s){s!==void 0&&parseFloat(s)<1&&""+e}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let s,a=r[1],n=r[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(n))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,b1.toWorkingColorSpace(this,t),i(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(n))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,b1.toWorkingColorSpace(this,t),i(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(n)){let o=parseFloat(s[1])/360,l=parseFloat(s[2])/100,h=parseFloat(s[3])/100;return i(s[4]),this.setHSL(o,l,h,t)}break}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){let s=r[1],a=s.length;if(a===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,b1.toWorkingColorSpace(this,t),this;if(a===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,b1.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=Jr){let i=hv[e.toLowerCase()];return i!==void 0?this.setHex(i,t):""+e,this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Dn(e.r),this.g=Dn(e.g),this.b=Dn(e.b),this}copyLinearToSRGB(e){return this.r=H0(e.r),this.g=H0(e.g),this.b=H0(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Jr){return b1.fromWorkingColorSpace(_h(this,Ti),e),wi(Ti.r*255,0,255)<<16^wi(Ti.g*255,0,255)<<8^wi(Ti.b*255,0,255)<<0}getHexString(e=Jr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=b1.workingColorSpace){b1.fromWorkingColorSpace(_h(this,Ti),t);let i=Ti.r,r=Ti.g,s=Ti.b,a=Math.max(i,r,s),n=Math.min(i,r,s),o,l,h=(n+a)/2;if(n===a)o=0,l=0;else{let c=a-n;switch(l=h<=.5?c/(a+n):c/(2-a-n),a){case i:o=(r-s)/c+(r<s?6:0);break;case r:o=(s-i)/c+2;break;case s:o=(i-r)/c+4;break}o/=6}return e.h=o,e.s=l,e.l=h,e}getRGB(e,t=b1.workingColorSpace){return b1.fromWorkingColorSpace(_h(this,Ti),t),e.r=Ti.r,e.g=Ti.g,e.b=Ti.b,e}getStyle(e=Jr){return b1.fromWorkingColorSpace(_h(this,Ti),e),e!==Jr?`color(${e} ${Ti.r} ${Ti.g} ${Ti.b})`:`rgb(${Ti.r*255|0},${Ti.g*255|0},${Ti.b*255|0})`}offsetHSL(e,t,i){return this.getHSL(mr),mr.h+=e,mr.s+=t,mr.l+=i,this.setHSL(mr.h,mr.s,mr.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(mr),e.getHSL(Sh);let i=b2(mr.h,Sh.h,t),r=b2(mr.s,Sh.s,t),s=b2(mr.l,Sh.l,t);return this.setHSL(i,r,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};Je.NAMES=hv;var Xn,cv=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Xn===void 0&&(Xn=R2("canvas")),Xn.width=e.width,Xn.height=e.height;let i=Xn.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Xn}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=R2("canvas");t.width=e.width,t.height=e.height;let i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);let r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let a=0;a<s.length;a++)s[a]=Dn(s[a]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){let t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(Dn(t[i]/255)*255):t[i]=Dn(t[i]);return{data:t,width:e.width,height:e.height}}else return e}},dv=class{constructor(e=null){this.isSource=!0,this.uuid=lr(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let a=0,n=r.length;a<n;a++)r[a].isDataTexture?s.push(tu(r[a].image)):s.push(tu(r[a]))}else s=tu(r);i.url=s}return t||(e.images[this.uuid]=i),i}};function tu(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?cv.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:{}}var C_=0,ai=class extends l1{constructor(e=ai.DEFAULT_IMAGE,t=ai.DEFAULT_MAPPING,i=ei,r=ei,s=gt,a=tl,n=Wi,o=y1,l=ai.DEFAULT_ANISOTROPY,h=Rr){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:C_++}),this.uuid=lr(),this.name="",this.source=new dv(e),this.mipmaps=[],this.mapping=t,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=a,this.anisotropy=l,this.format=n,this.internalFormat=null,this.type=o,this.offset=new j(0,0),this.repeat=new j(1,1),this.center=new j(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ai,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=h,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==tv)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Gs:e.x=e.x-Math.floor(e.x);break;case ei:e.x=e.x<0?0:1;break;case $p:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Gs:e.y=e.y-Math.floor(e.y);break;case ei:e.y=e.y<0?0:1;break;case $p:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}};ai.DEFAULT_IMAGE=null;ai.DEFAULT_MAPPING=tv;ai.DEFAULT_ANISOTROPY=1;var ht=class{constructor(e=0,t=0,i=0,r=1){ht.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,i=this.y,r=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*i+a[8]*r+a[12]*s,this.y=a[1]*t+a[5]*i+a[9]*r+a[13]*s,this.z=a[2]*t+a[6]*i+a[10]*r+a[14]*s,this.w=a[3]*t+a[7]*i+a[11]*r+a[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s,a=e.elements,n=a[0],o=a[4],l=a[8],h=a[1],c=a[5],d=a[9],u=a[2],p=a[6],f=a[10];if(Math.abs(o-h)<.01&&Math.abs(l-u)<.01&&Math.abs(d-p)<.01){if(Math.abs(o+h)<.1&&Math.abs(l+u)<.1&&Math.abs(d+p)<.1&&Math.abs(n+c+f-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let m=(n+1)/2,v=(c+1)/2,y=(f+1)/2,x=(o+h)/4,w=(l+u)/4,_=(d+p)/4;return m>v&&m>y?m<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(m),r=x/i,s=w/i):v>y?v<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(v),i=x/r,s=_/r):y<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(y),i=w/s,r=_/s),this.set(i,r,s,t),this}let g=Math.sqrt((p-d)*(p-d)+(l-u)*(l-u)+(h-o)*(h-o));return Math.abs(g)<.001&&(g=1),this.x=(p-d)/g,this.y=(l-u)/g,this.z=(h-o)/g,this.w=Math.acos((n+c+f-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},Rt=class extends l1{constructor(e=1,t=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new ht(0,0,e,t),this.scissorTest=!1,this.viewport=new ht(0,0,e,t);let r={width:e,height:t,depth:1};this.texture=new ai(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:gt,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new dv(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},uv=class extends ai{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Bt,this.minFilter=Bt,this.wrapR=ei,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},T_=class extends ai{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Bt,this.minFilter=Bt,this.wrapR=ei,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},P_=class extends Rt{constructor(e=1,t=1,i=1,r={}){super(e,t,r),this.isWebGLMultipleRenderTargets=!0;let s=this.texture;this.texture=[];for(let a=0;a<i;a++)this.texture[a]=s.clone(),this.texture[a].isRenderTargetTexture=!0}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=i;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,i=e.texture.length;t<i;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}},lt=class{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,a,n){let o=i[r+0],l=i[r+1],h=i[r+2],c=i[r+3],d=s[a+0],u=s[a+1],p=s[a+2],f=s[a+3];if(n===0){e[t+0]=o,e[t+1]=l,e[t+2]=h,e[t+3]=c;return}if(n===1){e[t+0]=d,e[t+1]=u,e[t+2]=p,e[t+3]=f;return}if(c!==f||o!==d||l!==u||h!==p){let g=1-n,m=o*d+l*u+h*p+c*f,v=m>=0?1:-1,y=1-m*m;if(y>Number.EPSILON){let w=Math.sqrt(y),_=Math.atan2(w,m*v);g=Math.sin(g*_)/w,n=Math.sin(n*_)/w}let x=n*v;if(o=o*g+d*x,l=l*g+u*x,h=h*g+p*x,c=c*g+f*x,g===1-n){let w=1/Math.sqrt(o*o+l*l+h*h+c*c);o*=w,l*=w,h*=w,c*=w}}e[t]=o,e[t+1]=l,e[t+2]=h,e[t+3]=c}static multiplyQuaternionsFlat(e,t,i,r,s,a){let n=i[r],o=i[r+1],l=i[r+2],h=i[r+3],c=s[a],d=s[a+1],u=s[a+2],p=s[a+3];return e[t]=n*p+h*c+o*u-l*d,e[t+1]=o*p+h*d+l*c-n*u,e[t+2]=l*p+h*u+n*d-o*c,e[t+3]=h*p-n*c-o*d-l*u,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){let i=e._x,r=e._y,s=e._z,a=e._order,n=Math.cos,o=Math.sin,l=n(i/2),h=n(r/2),c=n(s/2),d=o(i/2),u=o(r/2),p=o(s/2);switch(a){case"XYZ":this._x=d*h*c+l*u*p,this._y=l*u*c-d*h*p,this._z=l*h*p+d*u*c,this._w=l*h*c-d*u*p;break;case"YXZ":this._x=d*h*c+l*u*p,this._y=l*u*c-d*h*p,this._z=l*h*p-d*u*c,this._w=l*h*c+d*u*p;break;case"ZXY":this._x=d*h*c-l*u*p,this._y=l*u*c+d*h*p,this._z=l*h*p+d*u*c,this._w=l*h*c-d*u*p;break;case"ZYX":this._x=d*h*c-l*u*p,this._y=l*u*c+d*h*p,this._z=l*h*p-d*u*c,this._w=l*h*c+d*u*p;break;case"YZX":this._x=d*h*c+l*u*p,this._y=l*u*c+d*h*p,this._z=l*h*p-d*u*c,this._w=l*h*c-d*u*p;break;case"XZY":this._x=d*h*c-l*u*p,this._y=l*u*c-d*h*p,this._z=l*h*p+d*u*c,this._w=l*h*c+d*u*p;break;default:""+a}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,i=t[0],r=t[4],s=t[8],a=t[1],n=t[5],o=t[9],l=t[2],h=t[6],c=t[10],d=i+n+c;if(d>0){let u=.5/Math.sqrt(d+1);this._w=.25/u,this._x=(h-o)*u,this._y=(s-l)*u,this._z=(a-r)*u}else if(i>n&&i>c){let u=2*Math.sqrt(1+i-n-c);this._w=(h-o)/u,this._x=.25*u,this._y=(r+a)/u,this._z=(s+l)/u}else if(n>c){let u=2*Math.sqrt(1+n-i-c);this._w=(s-l)/u,this._x=(r+a)/u,this._y=.25*u,this._z=(o+h)/u}else{let u=2*Math.sqrt(1+c-i-n);this._w=(a-r)/u,this._x=(s+l)/u,this._y=(o+h)/u,this._z=.25*u}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(wi(this.dot(e),-1,1)))}rotateTowards(e,t){let i=this.angleTo(e);if(i===0)return this;let r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let i=e._x,r=e._y,s=e._z,a=e._w,n=t._x,o=t._y,l=t._z,h=t._w;return this._x=i*h+a*n+r*l-s*o,this._y=r*h+a*o+s*n-i*l,this._z=s*h+a*l+i*o-r*n,this._w=a*h-i*n-r*o-s*l,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let i=this._x,r=this._y,s=this._z,a=this._w,n=a*e._w+i*e._x+r*e._y+s*e._z;if(n<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,n=-n):this.copy(e),n>=1)return this._w=a,this._x=i,this._y=r,this._z=s,this;let o=1-n*n;if(o<=Number.EPSILON){let u=1-t;return this._w=u*a+t*this._w,this._x=u*i+t*this._x,this._y=u*r+t*this._y,this._z=u*s+t*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(o),h=Math.atan2(l,n),c=Math.sin((1-t)*h)/l,d=Math.sin(t*h)/l;return this._w=a*c+this._w*d,this._x=i*c+this._x*d,this._y=r*c+this._y*d,this._z=s*c+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){let e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},E=class{constructor(e=0,t=0,i=0){E.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(fm.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(fm.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,i=this.y,r=this.z,s=e.elements,a=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*a,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*a,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*a,this}applyQuaternion(e){let t=this.x,i=this.y,r=this.z,s=e.x,a=e.y,n=e.z,o=e.w,l=o*t+a*r-n*i,h=o*i+n*t-s*r,c=o*r+s*i-a*t,d=-s*t-a*i-n*r;return this.x=l*o+d*-s+h*-n-c*-a,this.y=h*o+d*-a+c*-s-l*-n,this.z=c*o+d*-n+l*-a-h*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let i=e.x,r=e.y,s=e.z,a=t.x,n=t.y,o=t.z;return this.x=r*o-s*n,this.y=s*a-i*o,this.z=i*n-r*a,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return iu.copy(this).projectOnVector(e),this.sub(iu)}reflect(e){return this.sub(iu.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let i=this.dot(e)/t;return Math.acos(wi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){let r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},iu=new E,fm=new lt,vi=class{constructor(e=new E(1/0,1/0,1/0),t=new E(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,r=1/0,s=-1/0,a=-1/0,n=-1/0;for(let o=0,l=e.length;o<l;o+=3){let h=e[o],c=e[o+1],d=e[o+2];h<t&&(t=h),c<i&&(i=c),d<r&&(r=d),h>s&&(s=h),c>a&&(a=c),d>n&&(n=d)}return this.min.set(t,i,r),this.max.set(s,a,n),this}setFromBufferAttribute(e){let t=1/0,i=1/0,r=1/0,s=-1/0,a=-1/0,n=-1/0;for(let o=0,l=e.count;o<l;o++){let h=e.getX(o),c=e.getY(o),d=e.getZ(o);h<t&&(t=h),c<i&&(i=c),d<r&&(r=d),h>s&&(s=h),c>a&&(a=c),d>n&&(n=d)}return this.min.set(t,i,r),this.max.set(s,a,n),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let i=Ka.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let i=e.geometry;if(i!==void 0)if(t&&i.attributes!=null&&i.attributes.position!==void 0){let s=i.attributes.position;for(let a=0,n=s.count;a<n;a++)Ka.fromBufferAttribute(s,a).applyMatrix4(e.matrixWorld),this.expandByPoint(Ka)}else i.boundingBox===null&&i.computeBoundingBox(),ru.copy(i.boundingBox),ru.applyMatrix4(e.matrixWorld),this.union(ru);let r=e.children;for(let s=0,a=r.length;s<a;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Ka),Ka.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ll),Ah.subVectors(this.max,Ll),Qn.subVectors(e.a,Ll),Zn.subVectors(e.b,Ll),Kn.subVectors(e.c,Ll),ha.subVectors(Zn,Qn),ca.subVectors(Kn,Zn),Ja.subVectors(Qn,Kn);let t=[0,-ha.z,ha.y,0,-ca.z,ca.y,0,-Ja.z,Ja.y,ha.z,0,-ha.x,ca.z,0,-ca.x,Ja.z,0,-Ja.x,-ha.y,ha.x,0,-ca.y,ca.x,0,-Ja.y,Ja.x,0];return!su(t,Qn,Zn,Kn,Ah)||(t=[1,0,0,0,1,0,0,0,1],!su(t,Qn,Zn,Kn,Ah))?!1:(Mh.crossVectors(ha,ca),t=[Mh.x,Mh.y,Mh.z],su(t,Qn,Zn,Kn,Ah))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Ka.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(Ka).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(ws[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ws[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ws[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ws[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ws[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ws[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ws[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ws[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ws),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},ws=[new E,new E,new E,new E,new E,new E,new E,new E],Ka=new E,ru=new vi,Qn=new E,Zn=new E,Kn=new E,ha=new E,ca=new E,Ja=new E,Ll=new E,Ah=new E,Mh=new E,$a=new E;function su(e,t,i,r,s){for(let a=0,n=e.length-3;a<=n;a+=3){$a.fromArray(e,a);let o=s.x*Math.abs($a.x)+s.y*Math.abs($a.y)+s.z*Math.abs($a.z),l=t.dot($a),h=i.dot($a),c=r.dot($a);if(Math.max(-Math.max(l,h,c),Math.min(l,h,c))>o)return!1}return!0}var D_=new vi,Bl=new E,au=new E,V1=class{constructor(e=new E,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let i=this.center;t!==void 0?i.copy(t):D_.setFromPoints(e).getCenter(i);let r=0;for(let s=0,a=e.length;s<a;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Bl.subVectors(e,this.center);let t=Bl.lengthSq();if(t>this.radius*this.radius){let i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.addScaledVector(Bl,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(au.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Bl.copy(e.center).add(au)),this.expandByPoint(Bl.copy(e.center).sub(au))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},Ss=new E,nu=new E,Eh=new E,da=new E,ou=new E,Ch=new E,lu=new E,vl=class{constructor(e=new E,t=new E(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ss)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=Ss.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Ss.copy(this.direction).multiplyScalar(t).add(this.origin),Ss.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){nu.copy(e).add(t).multiplyScalar(.5),Eh.copy(t).sub(e).normalize(),da.copy(this.origin).sub(nu);let s=e.distanceTo(t)*.5,a=-this.direction.dot(Eh),n=da.dot(this.direction),o=-da.dot(Eh),l=da.lengthSq(),h=Math.abs(1-a*a),c,d,u,p;if(h>0)if(c=a*o-n,d=a*n-o,p=s*h,c>=0)if(d>=-p)if(d<=p){let f=1/h;c*=f,d*=f,u=c*(c+a*d+2*n)+d*(a*c+d+2*o)+l}else d=s,c=Math.max(0,-(a*d+n)),u=-c*c+d*(d+2*o)+l;else d=-s,c=Math.max(0,-(a*d+n)),u=-c*c+d*(d+2*o)+l;else d<=-p?(c=Math.max(0,-(-a*s+n)),d=c>0?-s:Math.min(Math.max(-s,-o),s),u=-c*c+d*(d+2*o)+l):d<=p?(c=0,d=Math.min(Math.max(-s,-o),s),u=d*(d+2*o)+l):(c=Math.max(0,-(a*s+n)),d=c>0?s:Math.min(Math.max(-s,-o),s),u=-c*c+d*(d+2*o)+l);else d=a>0?-s:s,c=Math.max(0,-(a*d+n)),u=-c*c+d*(d+2*o)+l;return i&&i.copy(this.direction).multiplyScalar(c).add(this.origin),r&&r.copy(Eh).multiplyScalar(d).add(nu),u}intersectSphere(e,t){Ss.subVectors(e.center,this.origin);let i=Ss.dot(this.direction),r=Ss.dot(Ss)-i*i,s=e.radius*e.radius;if(r>s)return null;let a=Math.sqrt(s-r),n=i-a,o=i+a;return n<0&&o<0?null:n<0?this.at(o,t):this.at(n,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){let i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,a,n,o,l=1/this.direction.x,h=1/this.direction.y,c=1/this.direction.z,d=this.origin;return l>=0?(i=(e.min.x-d.x)*l,r=(e.max.x-d.x)*l):(i=(e.max.x-d.x)*l,r=(e.min.x-d.x)*l),h>=0?(s=(e.min.y-d.y)*h,a=(e.max.y-d.y)*h):(s=(e.max.y-d.y)*h,a=(e.min.y-d.y)*h),i>a||s>r||((s>i||isNaN(i))&&(i=s),(a<r||isNaN(r))&&(r=a),c>=0?(n=(e.min.z-d.z)*c,o=(e.max.z-d.z)*c):(n=(e.max.z-d.z)*c,o=(e.min.z-d.z)*c),i>o||n>r)||((n>i||i!==i)&&(i=n),(o<r||r!==r)&&(r=o),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,Ss)!==null}intersectTriangle(e,t,i,r,s){ou.subVectors(t,e),Ch.subVectors(i,e),lu.crossVectors(ou,Ch);let a=this.direction.dot(lu),n;if(a>0){if(r)return null;n=1}else if(a<0)n=-1,a=-a;else return null;da.subVectors(this.origin,e);let o=n*this.direction.dot(Ch.crossVectors(da,Ch));if(o<0)return null;let l=n*this.direction.dot(ou.cross(da));if(l<0||o+l>a)return null;let h=-n*da.dot(lu);return h<0?null:this.at(h/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},we=class{constructor(){we.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,i,r,s,a,n,o,l,h,c,d,u,p,f,g){let m=this.elements;return m[0]=e,m[4]=t,m[8]=i,m[12]=r,m[1]=s,m[5]=a,m[9]=n,m[13]=o,m[2]=l,m[6]=h,m[10]=c,m[14]=d,m[3]=u,m[7]=p,m[11]=f,m[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new we().fromArray(this.elements)}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){let t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,i=e.elements,r=1/Jn.setFromMatrixColumn(e,0).length(),s=1/Jn.setFromMatrixColumn(e,1).length(),a=1/Jn.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*a,t[9]=i[9]*a,t[10]=i[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,i=e.x,r=e.y,s=e.z,a=Math.cos(i),n=Math.sin(i),o=Math.cos(r),l=Math.sin(r),h=Math.cos(s),c=Math.sin(s);if(e.order==="XYZ"){let d=a*h,u=a*c,p=n*h,f=n*c;t[0]=o*h,t[4]=-o*c,t[8]=l,t[1]=u+p*l,t[5]=d-f*l,t[9]=-n*o,t[2]=f-d*l,t[6]=p+u*l,t[10]=a*o}else if(e.order==="YXZ"){let d=o*h,u=o*c,p=l*h,f=l*c;t[0]=d+f*n,t[4]=p*n-u,t[8]=a*l,t[1]=a*c,t[5]=a*h,t[9]=-n,t[2]=u*n-p,t[6]=f+d*n,t[10]=a*o}else if(e.order==="ZXY"){let d=o*h,u=o*c,p=l*h,f=l*c;t[0]=d-f*n,t[4]=-a*c,t[8]=p+u*n,t[1]=u+p*n,t[5]=a*h,t[9]=f-d*n,t[2]=-a*l,t[6]=n,t[10]=a*o}else if(e.order==="ZYX"){let d=a*h,u=a*c,p=n*h,f=n*c;t[0]=o*h,t[4]=p*l-u,t[8]=d*l+f,t[1]=o*c,t[5]=f*l+d,t[9]=u*l-p,t[2]=-l,t[6]=n*o,t[10]=a*o}else if(e.order==="YZX"){let d=a*o,u=a*l,p=n*o,f=n*l;t[0]=o*h,t[4]=f-d*c,t[8]=p*c+u,t[1]=c,t[5]=a*h,t[9]=-n*h,t[2]=-l*h,t[6]=u*c+p,t[10]=d-f*c}else if(e.order==="XZY"){let d=a*o,u=a*l,p=n*o,f=n*l;t[0]=o*h,t[4]=-c,t[8]=l*h,t[1]=d*c+f,t[5]=a*h,t[9]=u*c-p,t[2]=p*c-u,t[6]=n*h,t[10]=f*c+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(I_,e,O_)}lookAt(e,t,i){let r=this.elements;return G1.subVectors(e,t),G1.lengthSq()===0&&(G1.z=1),G1.normalize(),ua.crossVectors(i,G1),ua.lengthSq()===0&&(Math.abs(i.z)===1?G1.x+=1e-4:G1.z+=1e-4,G1.normalize(),ua.crossVectors(i,G1)),ua.normalize(),Th.crossVectors(G1,ua),r[0]=ua.x,r[4]=Th.x,r[8]=G1.x,r[1]=ua.y,r[5]=Th.y,r[9]=G1.y,r[2]=ua.z,r[6]=Th.z,r[10]=G1.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,r=t.elements,s=this.elements,a=i[0],n=i[4],o=i[8],l=i[12],h=i[1],c=i[5],d=i[9],u=i[13],p=i[2],f=i[6],g=i[10],m=i[14],v=i[3],y=i[7],x=i[11],w=i[15],_=r[0],b=r[4],A=r[8],S=r[12],M=r[1],C=r[5],T=r[9],P=r[13],I=r[2],D=r[6],k=r[10],H=r[14],U=r[3],F=r[7],Z=r[11],W=r[15];return s[0]=a*_+n*M+o*I+l*U,s[4]=a*b+n*C+o*D+l*F,s[8]=a*A+n*T+o*k+l*Z,s[12]=a*S+n*P+o*H+l*W,s[1]=h*_+c*M+d*I+u*U,s[5]=h*b+c*C+d*D+u*F,s[9]=h*A+c*T+d*k+u*Z,s[13]=h*S+c*P+d*H+u*W,s[2]=p*_+f*M+g*I+m*U,s[6]=p*b+f*C+g*D+m*F,s[10]=p*A+f*T+g*k+m*Z,s[14]=p*S+f*P+g*H+m*W,s[3]=v*_+y*M+x*I+w*U,s[7]=v*b+y*C+x*D+w*F,s[11]=v*A+y*T+x*k+w*Z,s[15]=v*S+y*P+x*H+w*W,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],a=e[1],n=e[5],o=e[9],l=e[13],h=e[2],c=e[6],d=e[10],u=e[14],p=e[3],f=e[7],g=e[11],m=e[15];return p*(+s*o*c-r*l*c-s*n*d+i*l*d+r*n*u-i*o*u)+f*(+t*o*u-t*l*d+s*a*d-r*a*u+r*l*h-s*o*h)+g*(+t*l*c-t*n*u-s*a*c+i*a*u+s*n*h-i*l*h)+m*(-r*n*h-t*o*c+t*n*d+r*a*c-i*a*d+i*o*h)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){let r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){let e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],a=e[4],n=e[5],o=e[6],l=e[7],h=e[8],c=e[9],d=e[10],u=e[11],p=e[12],f=e[13],g=e[14],m=e[15],v=c*g*l-f*d*l+f*o*u-n*g*u-c*o*m+n*d*m,y=p*d*l-h*g*l-p*o*u+a*g*u+h*o*m-a*d*m,x=h*f*l-p*c*l+p*n*u-a*f*u-h*n*m+a*c*m,w=p*c*o-h*f*o-p*n*d+a*f*d+h*n*g-a*c*g,_=t*v+i*y+r*x+s*w;if(_===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let b=1/_;return e[0]=v*b,e[1]=(f*d*s-c*g*s-f*r*u+i*g*u+c*r*m-i*d*m)*b,e[2]=(n*g*s-f*o*s+f*r*l-i*g*l-n*r*m+i*o*m)*b,e[3]=(c*o*s-n*d*s-c*r*l+i*d*l+n*r*u-i*o*u)*b,e[4]=y*b,e[5]=(h*g*s-p*d*s+p*r*u-t*g*u-h*r*m+t*d*m)*b,e[6]=(p*o*s-a*g*s-p*r*l+t*g*l+a*r*m-t*o*m)*b,e[7]=(a*d*s-h*o*s+h*r*l-t*d*l-a*r*u+t*o*u)*b,e[8]=x*b,e[9]=(p*c*s-h*f*s-p*i*u+t*f*u+h*i*m-t*c*m)*b,e[10]=(a*f*s-p*n*s+p*i*l-t*f*l-a*i*m+t*n*m)*b,e[11]=(h*n*s-a*c*s-h*i*l+t*c*l+a*i*u-t*n*u)*b,e[12]=w*b,e[13]=(h*f*r-p*c*r+p*i*d-t*f*d-h*i*g+t*c*g)*b,e[14]=(p*n*r-a*f*r-p*i*o+t*f*o+a*i*g-t*n*g)*b,e[15]=(a*c*r-h*n*r+h*i*o-t*c*o-a*i*d+t*n*d)*b,this}scale(e){let t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let i=Math.cos(t),r=Math.sin(t),s=1-i,a=e.x,n=e.y,o=e.z,l=s*a,h=s*n;return this.set(l*a+i,l*n-r*o,l*o+r*n,0,l*n+r*o,h*n+i,h*o-r*a,0,l*o-r*n,h*o+r*a,s*o*o+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,a){return this.set(1,i,s,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){let r=this.elements,s=t._x,a=t._y,n=t._z,o=t._w,l=s+s,h=a+a,c=n+n,d=s*l,u=s*h,p=s*c,f=a*h,g=a*c,m=n*c,v=o*l,y=o*h,x=o*c,w=i.x,_=i.y,b=i.z;return r[0]=(1-(f+m))*w,r[1]=(u+x)*w,r[2]=(p-y)*w,r[3]=0,r[4]=(u-x)*_,r[5]=(1-(d+m))*_,r[6]=(g+v)*_,r[7]=0,r[8]=(p+y)*b,r[9]=(g-v)*b,r[10]=(1-(d+f))*b,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){let r=this.elements,s=Jn.set(r[0],r[1],r[2]).length(),a=Jn.set(r[4],r[5],r[6]).length(),n=Jn.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],gr.copy(this);let o=1/s,l=1/a,h=1/n;return gr.elements[0]*=o,gr.elements[1]*=o,gr.elements[2]*=o,gr.elements[4]*=l,gr.elements[5]*=l,gr.elements[6]*=l,gr.elements[8]*=h,gr.elements[9]*=h,gr.elements[10]*=h,t.setFromRotationMatrix(gr),i.x=s,i.y=a,i.z=n,this}makePerspective(e,t,i,r,s,a){let n=this.elements,o=2*s/(t-e),l=2*s/(i-r),h=(t+e)/(t-e),c=(i+r)/(i-r),d=-(a+s)/(a-s),u=-2*a*s/(a-s);return n[0]=o,n[4]=0,n[8]=h,n[12]=0,n[1]=0,n[5]=l,n[9]=c,n[13]=0,n[2]=0,n[6]=0,n[10]=d,n[14]=u,n[3]=0,n[7]=0,n[11]=-1,n[15]=0,this}makeOrthographic(e,t,i,r,s,a){let n=this.elements,o=1/(t-e),l=1/(i-r),h=1/(a-s),c=(t+e)*o,d=(i+r)*l,u=(a+s)*h;return n[0]=2*o,n[4]=0,n[8]=0,n[12]=-c,n[1]=0,n[5]=2*l,n[9]=0,n[13]=-d,n[2]=0,n[6]=0,n[10]=-2*h,n[14]=-u,n[3]=0,n[7]=0,n[11]=0,n[15]=1,this}equals(e){let t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}},Jn=new E,gr=new we,I_=new E(0,0,0),O_=new E(1,1,1),ua=new E,Th=new E,G1=new E,mm=new we,gm=new lt,Ri=class{constructor(e=0,t=0,i=0,r=Ri.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){let r=e.elements,s=r[0],a=r[4],n=r[8],o=r[1],l=r[5],h=r[9],c=r[2],d=r[6],u=r[10];switch(t){case"XYZ":this._y=Math.asin(wi(n,-1,1)),Math.abs(n)<.9999999?(this._x=Math.atan2(-h,u),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(d,l),this._z=0);break;case"YXZ":this._x=Math.asin(-wi(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(n,u),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-c,s),this._z=0);break;case"ZXY":this._x=Math.asin(wi(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-c,u),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(o,s));break;case"ZYX":this._y=Math.asin(-wi(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(d,u),this._z=Math.atan2(o,s)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(wi(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-h,l),this._y=Math.atan2(-c,s)):(this._x=0,this._y=Math.atan2(n,u));break;case"XZY":this._z=Math.asin(-wi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,l),this._y=Math.atan2(n,s)):(this._x=Math.atan2(-h,u),this._y=0);break;default:""+t}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return mm.makeRotationFromQuaternion(e),this.setFromRotationMatrix(mm,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return gm.setFromEuler(this),this.setFromQuaternion(gm,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};Ri.DEFAULT_ORDER="XYZ";var t4=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},R_=0,vm=new E,$n=new lt,_s=new we,Ph=new E,zl=new E,L_=new E,B_=new lt,ym=new E(1,0,0),xm=new E(0,1,0),bm=new E(0,0,1),z_={type:"added"},wm={type:"removed"},kt=class extends l1{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:R_++}),this.uuid=lr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=kt.DEFAULT_UP.clone();let e=new E,t=new Ri,i=new lt,r=new E(1,1,1);function s(){i.setFromEuler(t,!1)}function a(){t.setFromQuaternion(i,void 0,!1)}t._onChange(s),i._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new we},normalMatrix:{value:new Ai}}),this.matrix=new we,this.matrixWorld=new we,this.matrixAutoUpdate=kt.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=kt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new t4,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return $n.setFromAxisAngle(e,t),this.quaternion.multiply($n),this}rotateOnWorldAxis(e,t){return $n.setFromAxisAngle(e,t),this.quaternion.premultiply($n),this}rotateX(e){return this.rotateOnAxis(ym,e)}rotateY(e){return this.rotateOnAxis(xm,e)}rotateZ(e){return this.rotateOnAxis(bm,e)}translateOnAxis(e,t){return vm.copy(e).applyQuaternion(this.quaternion),this.position.add(vm.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(ym,e)}translateY(e){return this.translateOnAxis(xm,e)}translateZ(e){return this.translateOnAxis(bm,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(_s.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?Ph.copy(e):Ph.set(e,t,i);let r=this.parent;this.updateWorldMatrix(!0,!1),zl.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_s.lookAt(zl,Ph,this.up):_s.lookAt(Ph,zl,this.up),this.quaternion.setFromRotationMatrix(_s),r&&(_s.extractRotation(r.matrixWorld),$n.setFromRotationMatrix(_s),this.quaternion.premultiply($n.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?this:(e&&e.isObject3D&&(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(z_)),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}let t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(wm)),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){let t=this.children[e];t.parent=null,t.dispatchEvent(wm)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),_s.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),_s.multiply(e.parent.matrixWorld)),e.applyMatrix4(_s),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){let s=this.children[i].getObjectByProperty(e,t);if(s!==void 0)return s}}getObjectsByProperty(e,t){let i=[];this[e]===t&&i.push(this);for(let r=0,s=this.children.length;r<s;r++){let a=this.children[r].getObjectsByProperty(e,t);a.length>0&&(i=i.concat(a))}return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(zl,e,L_),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(zl,B_,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){let t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let i=0,r=t.length;i<r;i++){let s=t[i];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){let i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){let r=this.children;for(let s=0,a=r.length;s<a;s++){let n=r[s];n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!1,!0)}}}toJSON(e){let t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function s(n,o){return n[o.uuid]===void 0&&(n[o.uuid]=o.toJSON(e)),o.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);let n=this.geometry.parameters;if(n!==void 0&&n.shapes!==void 0){let o=n.shapes;if(Array.isArray(o))for(let l=0,h=o.length;l<h;l++){let c=o[l];s(e.shapes,c)}else s(e.shapes,o)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let n=[];for(let o=0,l=this.material.length;o<l;o++)n.push(s(e.materials,this.material[o]));r.material=n}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let n=0;n<this.children.length;n++)r.children.push(this.children[n].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let n=0;n<this.animations.length;n++){let o=this.animations[n];r.animations.push(s(e.animations,o))}}if(t){let n=a(e.geometries),o=a(e.materials),l=a(e.textures),h=a(e.images),c=a(e.shapes),d=a(e.skeletons),u=a(e.animations),p=a(e.nodes);n.length>0&&(i.geometries=n),o.length>0&&(i.materials=o),l.length>0&&(i.textures=l),h.length>0&&(i.images=h),c.length>0&&(i.shapes=c),d.length>0&&(i.skeletons=d),u.length>0&&(i.animations=u),p.length>0&&(i.nodes=p)}return i.object=r,i;function a(n){let o=[];for(let l in n){let h=n[l];delete h.metadata,o.push(h)}return o}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){let r=e.children[i];this.add(r.clone())}return this}};kt.DEFAULT_UP=new E(0,1,0);kt.DEFAULT_MATRIX_AUTO_UPDATE=!0;kt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var vr=new E,As=new E,hu=new E,Ms=new E,eo=new E,to=new E,Sm=new E,cu=new E,du=new E,uu=new E,r1=class{constructor(e=new E,t=new E,i=new E){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),vr.subVectors(e,t),r.cross(vr);let s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){vr.subVectors(r,t),As.subVectors(i,t),hu.subVectors(e,t);let a=vr.dot(vr),n=vr.dot(As),o=vr.dot(hu),l=As.dot(As),h=As.dot(hu),c=a*l-n*n;if(c===0)return s.set(-2,-1,-1);let d=1/c,u=(l*o-n*h)*d,p=(a*h-n*o)*d;return s.set(1-u-p,p,u)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,Ms),Ms.x>=0&&Ms.y>=0&&Ms.x+Ms.y<=1}static getUV(e,t,i,r,s,a,n,o){return this.getBarycoord(e,t,i,r,Ms),o.set(0,0),o.addScaledVector(s,Ms.x),o.addScaledVector(a,Ms.y),o.addScaledVector(n,Ms.z),o}static isFrontFacing(e,t,i,r){return vr.subVectors(i,t),As.subVectors(e,t),vr.cross(As).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return vr.subVectors(this.c,this.b),As.subVectors(this.a,this.b),vr.cross(As).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return r1.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return r1.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return r1.getUV(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return r1.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return r1.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let i=this.a,r=this.b,s=this.c,a,n;eo.subVectors(r,i),to.subVectors(s,i),cu.subVectors(e,i);let o=eo.dot(cu),l=to.dot(cu);if(o<=0&&l<=0)return t.copy(i);du.subVectors(e,r);let h=eo.dot(du),c=to.dot(du);if(h>=0&&c<=h)return t.copy(r);let d=o*c-h*l;if(d<=0&&o>=0&&h<=0)return a=o/(o-h),t.copy(i).addScaledVector(eo,a);uu.subVectors(e,s);let u=eo.dot(uu),p=to.dot(uu);if(p>=0&&u<=p)return t.copy(s);let f=u*l-o*p;if(f<=0&&l>=0&&p<=0)return n=l/(l-p),t.copy(i).addScaledVector(to,n);let g=h*p-u*c;if(g<=0&&c-h>=0&&u-p>=0)return Sm.subVectors(s,r),n=(c-h)/(c-h+(u-p)),t.copy(r).addScaledVector(Sm,n);let m=1/(g+f+d);return a=f*m,n=d*m,t.copy(i).addScaledVector(eo,a).addScaledVector(to,n)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},F_=0,rh=class extends l1{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:F_++}),this.uuid=lr(),this.name="",this.type="Material",this.blending=Cn,this.side=Or,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=J7,this.blendDst=$7,this.blendEquation=Co,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Zp,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=d_,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Kd,this.stencilZFail=Kd,this.stencilZPass=Kd,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let i=e[t];if(i===void 0){""+t;continue}let r=this[t];if(r===void 0){""+this.type+t;continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Cn&&(i.blending=this.blending),this.side!==Or&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(i.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(i.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=this.flatShading),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){let a=[];for(let n in s){let o=s[n];delete o.metadata,a.push(o)}return a}if(t){let s=r(e.textures),a=r(e.images);s.length>0&&(i.textures=s),a.length>0&&(i.images=a)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,i=null;if(t!==null){let r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},Js=class extends rh{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Je(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ev,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},xi=new E,Dh=new j,ot=class{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=e3,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)Dh.fromBufferAttribute(this,t),Dh.applyMatrix3(e),this.setXY(t,Dh.x,Dh.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)xi.fromBufferAttribute(this,t),xi.applyMatrix3(e),this.setXYZ(t,xi.x,xi.y,xi.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)xi.fromBufferAttribute(this,t),xi.applyMatrix4(e),this.setXYZ(t,xi.x,xi.y,xi.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)xi.fromBufferAttribute(this,t),xi.applyNormalMatrix(e),this.setXYZ(t,xi.x,xi.y,xi.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)xi.fromBufferAttribute(this,t),xi.transformDirection(e),this.setXYZ(t,xi.x,xi.y,xi.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Ws(t,this.array)),t}setX(e,t){return this.normalized&&(t=Xt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Ws(t,this.array)),t}setY(e,t){return this.normalized&&(t=Xt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Ws(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Xt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Ws(t,this.array)),t}setW(e,t){return this.normalized&&(t=Xt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Xt(t,this.array),i=Xt(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Xt(t,this.array),i=Xt(i,this.array),r=Xt(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Xt(t,this.array),i=Xt(i,this.array),r=Xt(r,this.array),s=Xt(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==e3&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){}copyVector2sArray(){}copyVector3sArray(){}copyVector4sArray(){}},pv=class extends ot{constructor(e,t,i){super(new Uint16Array(e),t,i)}},Vo=class extends ot{constructor(e,t,i){super(new Uint32Array(e),t,i)}},De=class extends ot{constructor(e,t,i){super(new Float32Array(e),t,i)}},k_=0,Z1=new we,pu=new kt,io=new E,H1=new vi,Fl=new vi,Ui=new E,Ge=class extends l1{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:k_++}),this.uuid=lr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(lv(e)?Vo:pv)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let s=new Ai().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}let r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Z1.makeRotationFromQuaternion(e),this.applyMatrix4(Z1),this}rotateX(e){return Z1.makeRotationX(e),this.applyMatrix4(Z1),this}rotateY(e){return Z1.makeRotationY(e),this.applyMatrix4(Z1),this}rotateZ(e){return Z1.makeRotationZ(e),this.applyMatrix4(Z1),this}translate(e,t,i){return Z1.makeTranslation(e,t,i),this.applyMatrix4(Z1),this}scale(e,t,i){return Z1.makeScale(e,t,i),this.applyMatrix4(Z1),this}lookAt(e){return pu.lookAt(e),pu.updateMatrix(),this.applyMatrix4(pu.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(io).negate(),this.translate(io.x,io.y,io.z),this}setFromPoints(e){let t=[];for(let i=0,r=e.length;i<r;i++){let s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new De(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new vi);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){this.boundingBox.set(new E(-1/0,-1/0,-1/0),new E(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){let s=t[i];H1.setFromBufferAttribute(s),this.morphTargetsRelative?(Ui.addVectors(this.boundingBox.min,H1.min),this.boundingBox.expandByPoint(Ui),Ui.addVectors(this.boundingBox.max,H1.max),this.boundingBox.expandByPoint(Ui)):(this.boundingBox.expandByPoint(H1.min),this.boundingBox.expandByPoint(H1.max))}}else this.boundingBox.makeEmpty();isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new V1);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){this.boundingSphere.set(new E,1/0);return}if(e){let i=this.boundingSphere.center;if(H1.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){let n=t[s];Fl.setFromBufferAttribute(n),this.morphTargetsRelative?(Ui.addVectors(H1.min,Fl.min),H1.expandByPoint(Ui),Ui.addVectors(H1.max,Fl.max),H1.expandByPoint(Ui)):(H1.expandByPoint(Fl.min),H1.expandByPoint(Fl.max))}H1.getCenter(i);let r=0;for(let s=0,a=e.count;s<a;s++)Ui.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Ui));if(t)for(let s=0,a=t.length;s<a;s++){let n=t[s],o=this.morphTargetsRelative;for(let l=0,h=n.count;l<h;l++)Ui.fromBufferAttribute(n,l),o&&(io.fromBufferAttribute(e,l),Ui.add(io)),r=Math.max(r,i.distanceToSquared(Ui))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0)return;let i=e.array,r=t.position.array,s=t.normal.array,a=t.uv.array,n=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new ot(new Float32Array(4*n),4));let o=this.getAttribute("tangent").array,l=[],h=[];for(let M=0;M<n;M++)l[M]=new E,h[M]=new E;let c=new E,d=new E,u=new E,p=new j,f=new j,g=new j,m=new E,v=new E;function y(M,C,T){c.fromArray(r,M*3),d.fromArray(r,C*3),u.fromArray(r,T*3),p.fromArray(a,M*2),f.fromArray(a,C*2),g.fromArray(a,T*2),d.sub(c),u.sub(c),f.sub(p),g.sub(p);let P=1/(f.x*g.y-g.x*f.y);!isFinite(P)||(m.copy(d).multiplyScalar(g.y).addScaledVector(u,-f.y).multiplyScalar(P),v.copy(u).multiplyScalar(f.x).addScaledVector(d,-g.x).multiplyScalar(P),l[M].add(m),l[C].add(m),l[T].add(m),h[M].add(v),h[C].add(v),h[T].add(v))}let x=this.groups;x.length===0&&(x=[{start:0,count:i.length}]);for(let M=0,C=x.length;M<C;++M){let T=x[M],P=T.start,I=T.count;for(let D=P,k=P+I;D<k;D+=3)y(i[D+0],i[D+1],i[D+2])}let w=new E,_=new E,b=new E,A=new E;function S(M){b.fromArray(s,M*3),A.copy(b);let C=l[M];w.copy(C),w.sub(b.multiplyScalar(b.dot(C))).normalize(),_.crossVectors(A,C);let T=_.dot(h[M])<0?-1:1;o[M*4]=w.x,o[M*4+1]=w.y,o[M*4+2]=w.z,o[M*4+3]=T}for(let M=0,C=x.length;M<C;++M){let T=x[M],P=T.start,I=T.count;for(let D=P,k=P+I;D<k;D+=3)S(i[D+0]),S(i[D+1]),S(i[D+2])}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new ot(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let d=0,u=i.count;d<u;d++)i.setXYZ(d,0,0,0);let r=new E,s=new E,a=new E,n=new E,o=new E,l=new E,h=new E,c=new E;if(e)for(let d=0,u=e.count;d<u;d+=3){let p=e.getX(d+0),f=e.getX(d+1),g=e.getX(d+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,f),a.fromBufferAttribute(t,g),h.subVectors(a,s),c.subVectors(r,s),h.cross(c),n.fromBufferAttribute(i,p),o.fromBufferAttribute(i,f),l.fromBufferAttribute(i,g),n.add(h),o.add(h),l.add(h),i.setXYZ(p,n.x,n.y,n.z),i.setXYZ(f,o.x,o.y,o.z),i.setXYZ(g,l.x,l.y,l.z)}else for(let d=0,u=t.count;d<u;d+=3)r.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),a.fromBufferAttribute(t,d+2),h.subVectors(a,s),c.subVectors(r,s),h.cross(c),i.setXYZ(d+0,h.x,h.y,h.z),i.setXYZ(d+1,h.x,h.y,h.z),i.setXYZ(d+2,h.x,h.y,h.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return this}normalizeNormals(){let e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Ui.fromBufferAttribute(e,t),Ui.normalize(),e.setXYZ(t,Ui.x,Ui.y,Ui.z)}toNonIndexed(){function e(n,o){let l=n.array,h=n.itemSize,c=n.normalized,d=new l.constructor(o.length*h),u=0,p=0;for(let f=0,g=o.length;f<g;f++){n.isInterleavedBufferAttribute?u=o[f]*n.data.stride+n.offset:u=o[f]*h;for(let m=0;m<h;m++)d[p++]=l[u++]}return new ot(d,h,c)}if(this.index===null)return this;let t=new Ge,i=this.index.array,r=this.attributes;for(let n in r){let o=r[n],l=e(o,i);t.setAttribute(n,l)}let s=this.morphAttributes;for(let n in s){let o=[],l=s[n];for(let h=0,c=l.length;h<c;h++){let d=l[h],u=e(d,i);o.push(u)}t.morphAttributes[n]=o}t.morphTargetsRelative=this.morphTargetsRelative;let a=this.groups;for(let n=0,o=a.length;n<o;n++){let l=a[n];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){let e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let o=this.parameters;for(let l in o)o[l]!==void 0&&(e[l]=o[l]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let i=this.attributes;for(let o in i){let l=i[o];e.data.attributes[o]=l.toJSON(e.data)}let r={},s=!1;for(let o in this.morphAttributes){let l=this.morphAttributes[o],h=[];for(let c=0,d=l.length;c<d;c++){let u=l[c];h.push(u.toJSON(e.data))}h.length>0&&(r[o]=h,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);let a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));let n=this.boundingSphere;return n!==null&&(e.data.boundingSphere={center:n.center.toArray(),radius:n.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let i=e.index;i!==null&&this.setIndex(i.clone(t));let r=e.attributes;for(let l in r){let h=r[l];this.setAttribute(l,h.clone(t))}let s=e.morphAttributes;for(let l in s){let h=[],c=s[l];for(let d=0,u=c.length;d<u;d++)h.push(c[d].clone(t));this.morphAttributes[l]=h}this.morphTargetsRelative=e.morphTargetsRelative;let a=e.groups;for(let l=0,h=a.length;l<h;l++){let c=a[l];this.addGroup(c.start,c.count,c.materialIndex)}let n=e.boundingBox;n!==null&&(this.boundingBox=n.clone());let o=e.boundingSphere;return o!==null&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},_m=new we,ro=new vl,fu=new V1,kl=new E,Ul=new E,Nl=new E,mu=new E,Ih=new E,Oh=new j,Rh=new j,Lh=new j,gu=new E,Bh=new E,si=class extends kt{constructor(e=new Ge,t=new Js){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let i=e[t[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,s=i.length;r<s;r++){let a=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}getVertexPosition(e,t){let i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,a=i.morphTargetsRelative;t.fromBufferAttribute(r,e);let n=this.morphTargetInfluences;if(s&&n){Ih.set(0,0,0);for(let o=0,l=s.length;o<l;o++){let h=n[o],c=s[o];h!==0&&(mu.fromBufferAttribute(c,e),a?Ih.addScaledVector(mu,h):Ih.addScaledVector(mu.sub(t),h))}t.add(Ih)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){let i=this.geometry,r=this.material,s=this.matrixWorld;if(r===void 0||(i.boundingSphere===null&&i.computeBoundingSphere(),fu.copy(i.boundingSphere),fu.applyMatrix4(s),e.ray.intersectsSphere(fu)===!1)||(_m.copy(s).invert(),ro.copy(e.ray).applyMatrix4(_m),i.boundingBox!==null&&ro.intersectsBox(i.boundingBox)===!1))return;let a,n=i.index,o=i.attributes.position,l=i.attributes.uv,h=i.attributes.uv2,c=i.groups,d=i.drawRange;if(n!==null)if(Array.isArray(r))for(let u=0,p=c.length;u<p;u++){let f=c[u],g=r[f.materialIndex],m=Math.max(f.start,d.start),v=Math.min(n.count,Math.min(f.start+f.count,d.start+d.count));for(let y=m,x=v;y<x;y+=3){let w=n.getX(y),_=n.getX(y+1),b=n.getX(y+2);a=zh(this,g,e,ro,l,h,w,_,b),a&&(a.faceIndex=Math.floor(y/3),a.face.materialIndex=f.materialIndex,t.push(a))}}else{let u=Math.max(0,d.start),p=Math.min(n.count,d.start+d.count);for(let f=u,g=p;f<g;f+=3){let m=n.getX(f),v=n.getX(f+1),y=n.getX(f+2);a=zh(this,r,e,ro,l,h,m,v,y),a&&(a.faceIndex=Math.floor(f/3),t.push(a))}}else if(o!==void 0)if(Array.isArray(r))for(let u=0,p=c.length;u<p;u++){let f=c[u],g=r[f.materialIndex],m=Math.max(f.start,d.start),v=Math.min(o.count,Math.min(f.start+f.count,d.start+d.count));for(let y=m,x=v;y<x;y+=3){let w=y,_=y+1,b=y+2;a=zh(this,g,e,ro,l,h,w,_,b),a&&(a.faceIndex=Math.floor(y/3),a.face.materialIndex=f.materialIndex,t.push(a))}}else{let u=Math.max(0,d.start),p=Math.min(o.count,d.start+d.count);for(let f=u,g=p;f<g;f+=3){let m=f,v=f+1,y=f+2;a=zh(this,r,e,ro,l,h,m,v,y),a&&(a.faceIndex=Math.floor(f/3),t.push(a))}}}};function U_(e,t,i,r,s,a,n,o){let l;if(t.side===Yi?l=r.intersectTriangle(n,a,s,!0,o):l=r.intersectTriangle(s,a,n,t.side===Or,o),l===null)return null;Bh.copy(o),Bh.applyMatrix4(e.matrixWorld);let h=i.ray.origin.distanceTo(Bh);return h<i.near||h>i.far?null:{distance:h,point:Bh.clone(),object:e}}function zh(e,t,i,r,s,a,n,o,l){e.getVertexPosition(n,kl),e.getVertexPosition(o,Ul),e.getVertexPosition(l,Nl);let h=U_(e,t,i,r,kl,Ul,Nl,gu);if(h){s&&(Oh.fromBufferAttribute(s,n),Rh.fromBufferAttribute(s,o),Lh.fromBufferAttribute(s,l),h.uv=r1.getUV(gu,kl,Ul,Nl,Oh,Rh,Lh,new j)),a&&(Oh.fromBufferAttribute(a,n),Rh.fromBufferAttribute(a,o),Lh.fromBufferAttribute(a,l),h.uv2=r1.getUV(gu,kl,Ul,Nl,Oh,Rh,Lh,new j));let c={a:n,b:o,c:l,normal:new E,materialIndex:0};r1.getNormal(kl,Ul,Nl,c.normal),h.face=c}return h}var Lr=class extends Ge{constructor(e=1,t=1,i=1,r=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:a};let n=this;r=Math.floor(r),s=Math.floor(s),a=Math.floor(a);let o=[],l=[],h=[],c=[],d=0,u=0;p("z","y","x",-1,-1,i,t,e,a,s,0),p("z","y","x",1,-1,i,t,-e,a,s,1),p("x","z","y",1,1,e,i,t,r,a,2),p("x","z","y",1,-1,e,i,-t,r,a,3),p("x","y","z",1,-1,e,t,i,r,s,4),p("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(o),this.setAttribute("position",new De(l,3)),this.setAttribute("normal",new De(h,3)),this.setAttribute("uv",new De(c,2));function p(f,g,m,v,y,x,w,_,b,A,S){let M=x/b,C=w/A,T=x/2,P=w/2,I=_/2,D=b+1,k=A+1,H=0,U=0,F=new E;for(let Z=0;Z<k;Z++){let W=Z*C-P;for(let G=0;G<D;G++){let X=G*M-T;F[f]=X*v,F[g]=W*y,F[m]=I,l.push(F.x,F.y,F.z),F[f]=0,F[g]=0,F[m]=_>0?1:-1,h.push(F.x,F.y,F.z),c.push(G/b),c.push(1-Z/A),H+=1}}for(let Z=0;Z<A;Z++)for(let W=0;W<b;W++){let G=d+W+D*Z,X=d+W+D*(Z+1),ee=d+(W+1)+D*(Z+1),Y=d+(W+1)+D*Z;o.push(G,X,Y),o.push(X,ee,Y),U+=6}n.addGroup(u,U,S),u+=U,d+=H}}static fromJSON(e){return new Lr(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function il(e){let t={};for(let i in e){t[i]={};for(let r in e[i]){let s=e[i][r];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?t[i][r]=s.clone():Array.isArray(s)?t[i][r]=s.slice():t[i][r]=s}}return t}function A1(e){let t={};for(let i=0;i<e.length;i++){let r=il(e[i]);for(let s in r)t[s]=r[s]}return t}function N_(e){let t=[];for(let i=0;i<e.length;i++)t.push(e[i].clone());return t}function fv(e){return e.getRenderTarget()===null&&e.outputEncoding===ft?Jr:uc}var yl={clone:il,merge:A1},V_=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,j_=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,It=class extends rh{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=V_,this.fragmentShader=j_,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=il(e.uniforms),this.uniformsGroups=N_(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let r in this.uniforms){let s=this.uniforms[r].value;s&&s.isTexture?t.uniforms[r]={type:"t",value:s.toJSON(e).uuid}:s&&s.isColor?t.uniforms[r]={type:"c",value:s.getHex()}:s&&s.isVector2?t.uniforms[r]={type:"v2",value:s.toArray()}:s&&s.isVector3?t.uniforms[r]={type:"v3",value:s.toArray()}:s&&s.isVector4?t.uniforms[r]={type:"v4",value:s.toArray()}:s&&s.isMatrix3?t.uniforms[r]={type:"m3",value:s.toArray()}:s&&s.isMatrix4?t.uniforms[r]={type:"m4",value:s.toArray()}:t.uniforms[r]={value:s}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let i={};for(let r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}},Vn=class extends kt{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new we,this.projectionMatrix=new we,this.projectionMatrixInverse=new we}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},u1=class extends Vn{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=O2*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(x2*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return O2*2*Math.atan(Math.tan(x2*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(x2*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r,a=this.view;if(this.view!==null&&this.view.enabled){let o=a.fullWidth,l=a.fullHeight;s+=a.offsetX*r/o,t-=a.offsetY*i/l,r*=a.width/o,i*=a.height/l}let n=this.filmOffset;n!==0&&(s+=e*n/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},so=-90,ao=1,G_=class extends kt{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i;let r=new u1(so,ao,e,t);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(1,0,0),this.add(r);let s=new u1(so,ao,e,t);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(-1,0,0),this.add(s);let a=new u1(so,ao,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(0,1,0),this.add(a);let n=new u1(so,ao,e,t);n.layers=this.layers,n.up.set(0,0,1),n.lookAt(0,-1,0),this.add(n);let o=new u1(so,ao,e,t);o.layers=this.layers,o.up.set(0,1,0),o.lookAt(0,0,1),this.add(o);let l=new u1(so,ao,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(e,t){this.parent===null&&this.updateMatrixWorld();let i=this.renderTarget,[r,s,a,n,o,l]=this.children,h=e.getRenderTarget(),c=e.toneMapping,d=e.xr.enabled;e.toneMapping=os,e.xr.enabled=!1;let u=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,s),e.setRenderTarget(i,2),e.render(t,a),e.setRenderTarget(i,3),e.render(t,n),e.setRenderTarget(i,4),e.render(t,o),i.texture.generateMipmaps=u,e.setRenderTarget(i,5),e.render(t,l),e.setRenderTarget(h),e.toneMapping=c,e.xr.enabled=d,i.texture.needsPMREMUpdate=!0}},i4=class extends ai{constructor(e,t,i,r,s,a,n,o,l,h){e=e!==void 0?e:[],t=t!==void 0?t:Ln,super(e,t,i,r,s,a,n,o,l,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},H_=class extends Rt{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new i4(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:gt}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Lr(5,5,5),s=new It({name:"CubemapFromEquirect",uniforms:il(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Yi,blending:Mi});s.uniforms.tEquirect.value=t;let a=new si(r,s),n=t.minFilter;return t.minFilter===tl&&(t.minFilter=gt),new G_(1,10,this).update(e,a),t.minFilter=n,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,i,r){let s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,i,r);e.setRenderTarget(s)}},vu=new E,W_=new E,q_=new Ai,B1=class{constructor(e=new E(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){let r=vu.subVectors(i,t).cross(W_.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let i=e.delta(vu),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(i).multiplyScalar(s).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let i=t||q_.getNormalMatrix(e),r=this.coplanarPoint(vu).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},no=new V1,Fh=new E,r4=class{constructor(e=new B1,t=new B1,i=new B1,r=new B1,s=new B1,a=new B1){this.planes=[e,t,i,r,s,a]}set(e,t,i,r,s,a){let n=this.planes;return n[0].copy(e),n[1].copy(t),n[2].copy(i),n[3].copy(r),n[4].copy(s),n[5].copy(a),this}copy(e){let t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){let t=this.planes,i=e.elements,r=i[0],s=i[1],a=i[2],n=i[3],o=i[4],l=i[5],h=i[6],c=i[7],d=i[8],u=i[9],p=i[10],f=i[11],g=i[12],m=i[13],v=i[14],y=i[15];return t[0].setComponents(n-r,c-o,f-d,y-g).normalize(),t[1].setComponents(n+r,c+o,f+d,y+g).normalize(),t[2].setComponents(n+s,c+l,f+u,y+m).normalize(),t[3].setComponents(n-s,c-l,f-u,y-m).normalize(),t[4].setComponents(n-a,c-h,f-p,y-v).normalize(),t[5].setComponents(n+a,c+h,f+p,y+v).normalize(),this}intersectsObject(e){let t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),no.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(no)}intersectsSprite(e){return no.center.set(0,0,0),no.radius=.7071067811865476,no.applyMatrix4(e.matrixWorld),this.intersectsSphere(no)}intersectsSphere(e){let t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){let t=this.planes;for(let i=0;i<6;i++){let r=t[i];if(Fh.x=r.normal.x>0?e.max.x:e.min.x,Fh.y=r.normal.y>0?e.max.y:e.min.y,Fh.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Fh)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function mv(){let e=null,t=!1,i=null,r=null;function s(a,n){i(a,n),r=e.requestAnimationFrame(s)}return{start:function(){t!==!0&&i!==null&&(r=e.requestAnimationFrame(s),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(a){i=a},setContext:function(a){e=a}}}function Y_(e,t){let i=t.isWebGL2,r=new WeakMap;function s(h,c){let d=h.array,u=h.usage,p=e.createBuffer();e.bindBuffer(c,p),e.bufferData(c,d,u),h.onUploadCallback();let f;if(d instanceof Float32Array)f=5126;else if(d instanceof Uint16Array)if(h.isFloat16BufferAttribute)if(i)f=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else f=5123;else if(d instanceof Int16Array)f=5122;else if(d instanceof Uint32Array)f=5125;else if(d instanceof Int32Array)f=5124;else if(d instanceof Int8Array)f=5120;else if(d instanceof Uint8Array)f=5121;else if(d instanceof Uint8ClampedArray)f=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);return{buffer:p,type:f,bytesPerElement:d.BYTES_PER_ELEMENT,version:h.version}}function a(h,c,d){let u=c.array,p=c.updateRange;e.bindBuffer(d,h),p.count===-1?e.bufferSubData(d,0,u):(i?e.bufferSubData(d,p.offset*u.BYTES_PER_ELEMENT,u,p.offset,p.count):e.bufferSubData(d,p.offset*u.BYTES_PER_ELEMENT,u.subarray(p.offset,p.offset+p.count)),p.count=-1),c.onUploadCallback()}function n(h){return h.isInterleavedBufferAttribute&&(h=h.data),r.get(h)}function o(h){h.isInterleavedBufferAttribute&&(h=h.data);let c=r.get(h);c&&(e.deleteBuffer(c.buffer),r.delete(h))}function l(h,c){if(h.isGLBufferAttribute){let u=r.get(h);(!u||u.version<h.version)&&r.set(h,{buffer:h.buffer,type:h.type,bytesPerElement:h.elementSize,version:h.version});return}h.isInterleavedBufferAttribute&&(h=h.data);let d=r.get(h);d===void 0?r.set(h,s(h,c)):d.version<h.version&&(a(d.buffer,h,c),d.version=h.version)}return{get:n,remove:o,update:l}}var $s=class extends Ge{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};let s=e/2,a=t/2,n=Math.floor(i),o=Math.floor(r),l=n+1,h=o+1,c=e/n,d=t/o,u=[],p=[],f=[],g=[];for(let m=0;m<h;m++){let v=m*d-a;for(let y=0;y<l;y++){let x=y*c-s;p.push(x,-v,0),f.push(0,0,1),g.push(y/n),g.push(1-m/o)}}for(let m=0;m<o;m++)for(let v=0;v<n;v++){let y=v+l*m,x=v+l*(m+1),w=v+1+l*(m+1),_=v+1+l*m;u.push(y,x,_),u.push(x,w,_)}this.setIndex(u),this.setAttribute("position",new De(p,3)),this.setAttribute("normal",new De(f,3)),this.setAttribute("uv",new De(g,2))}static fromJSON(e){return new $s(e.width,e.height,e.widthSegments,e.heightSegments)}},X_=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,Q_=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Z_=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,K_=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,J_=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,$_=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,eA="vec3 transformed = vec3( position );",tA=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,iA=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,rA=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,sA=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,aA=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,nA=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,oA=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,lA=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,hA=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,cA=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,dA=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,uA=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,pA=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,fA=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,mA=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,gA=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,vA=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,yA=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,xA=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,bA="gl_FragColor = linearToOutputTexel( gl_FragColor );",wA=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,SA=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,_A=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,AA=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,MA=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,EA=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,CA=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,TA=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,PA=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,DA=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,IA=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,OA=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,RA=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,LA=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,BA=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,zA=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,FA=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,kA=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,UA=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,NA=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,VA=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,jA=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,GA=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,HA=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,WA=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,qA=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,YA=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,XA=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,QA=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,ZA=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,KA=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,JA=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,$A=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,eM=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,tM=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,iM=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,rM=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,sM=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,aM=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,nM=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,oM=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,lM=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,hM=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,cM=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,dM=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,uM=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,pM=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,fM=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,mM=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,gM=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,vM=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,yM=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,xM=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,bM=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,wM=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,SM=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,_M=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,AM=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,MM=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,EM=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,CM=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,TM=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,PM=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,DM=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,IM=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,OM=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,RM=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,LM=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,BM=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,zM=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,FM=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,kM=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,UM=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,NM=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,VM=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,jM=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,GM=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,HM=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,WM=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,qM=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,YM=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,XM=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,QM=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,ZM=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,KM=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,JM=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,$M=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,eE=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,tE=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,iE=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,rE=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,sE=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,aE=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,nE=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,oE=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,lE=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,hE=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,cE=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,dE=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,uE=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,pE=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,fE=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,mE=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gE=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,vE=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,yE=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,xE=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,bE=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,wE=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,SE=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,_E=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,AE=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,ME=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,mt={alphamap_fragment:X_,alphamap_pars_fragment:Q_,alphatest_fragment:Z_,alphatest_pars_fragment:K_,aomap_fragment:J_,aomap_pars_fragment:$_,begin_vertex:eA,beginnormal_vertex:tA,bsdfs:iA,iridescence_fragment:rA,bumpmap_pars_fragment:sA,clipping_planes_fragment:aA,clipping_planes_pars_fragment:nA,clipping_planes_pars_vertex:oA,clipping_planes_vertex:lA,color_fragment:hA,color_pars_fragment:cA,color_pars_vertex:dA,color_vertex:uA,common:pA,cube_uv_reflection_fragment:fA,defaultnormal_vertex:mA,displacementmap_pars_vertex:gA,displacementmap_vertex:vA,emissivemap_fragment:yA,emissivemap_pars_fragment:xA,encodings_fragment:bA,encodings_pars_fragment:wA,envmap_fragment:SA,envmap_common_pars_fragment:_A,envmap_pars_fragment:AA,envmap_pars_vertex:MA,envmap_physical_pars_fragment:FA,envmap_vertex:EA,fog_vertex:CA,fog_pars_vertex:TA,fog_fragment:PA,fog_pars_fragment:DA,gradientmap_pars_fragment:IA,lightmap_fragment:OA,lightmap_pars_fragment:RA,lights_lambert_fragment:LA,lights_lambert_pars_fragment:BA,lights_pars_begin:zA,lights_toon_fragment:kA,lights_toon_pars_fragment:UA,lights_phong_fragment:NA,lights_phong_pars_fragment:VA,lights_physical_fragment:jA,lights_physical_pars_fragment:GA,lights_fragment_begin:HA,lights_fragment_maps:WA,lights_fragment_end:qA,logdepthbuf_fragment:YA,logdepthbuf_pars_fragment:XA,logdepthbuf_pars_vertex:QA,logdepthbuf_vertex:ZA,map_fragment:KA,map_pars_fragment:JA,map_particle_fragment:$A,map_particle_pars_fragment:eM,metalnessmap_fragment:tM,metalnessmap_pars_fragment:iM,morphcolor_vertex:rM,morphnormal_vertex:sM,morphtarget_pars_vertex:aM,morphtarget_vertex:nM,normal_fragment_begin:oM,normal_fragment_maps:lM,normal_pars_fragment:hM,normal_pars_vertex:cM,normal_vertex:dM,normalmap_pars_fragment:uM,clearcoat_normal_fragment_begin:pM,clearcoat_normal_fragment_maps:fM,clearcoat_pars_fragment:mM,iridescence_pars_fragment:gM,output_fragment:vM,packing:yM,premultiplied_alpha_fragment:xM,project_vertex:bM,dithering_fragment:wM,dithering_pars_fragment:SM,roughnessmap_fragment:_M,roughnessmap_pars_fragment:AM,shadowmap_pars_fragment:MM,shadowmap_pars_vertex:EM,shadowmap_vertex:CM,shadowmask_pars_fragment:TM,skinbase_vertex:PM,skinning_pars_vertex:DM,skinning_vertex:IM,skinnormal_vertex:OM,specularmap_fragment:RM,specularmap_pars_fragment:LM,tonemapping_fragment:BM,tonemapping_pars_fragment:zM,transmission_fragment:FM,transmission_pars_fragment:kM,uv_pars_fragment:UM,uv_pars_vertex:NM,uv_vertex:VM,uv2_pars_fragment:jM,uv2_pars_vertex:GM,uv2_vertex:HM,worldpos_vertex:WM,background_vert:qM,background_frag:YM,backgroundCube_vert:XM,backgroundCube_frag:QM,cube_vert:ZM,cube_frag:KM,depth_vert:JM,depth_frag:$M,distanceRGBA_vert:eE,distanceRGBA_frag:tE,equirect_vert:iE,equirect_frag:rE,linedashed_vert:sE,linedashed_frag:aE,meshbasic_vert:nE,meshbasic_frag:oE,meshlambert_vert:lE,meshlambert_frag:hE,meshmatcap_vert:cE,meshmatcap_frag:dE,meshnormal_vert:uE,meshnormal_frag:pE,meshphong_vert:fE,meshphong_frag:mE,meshphysical_vert:gE,meshphysical_frag:vE,meshtoon_vert:yE,meshtoon_frag:xE,points_vert:bE,points_frag:wE,shadow_vert:SE,shadow_frag:_E,sprite_vert:AE,sprite_frag:ME},Te={common:{diffuse:{value:new Je(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ai},uv2Transform:{value:new Ai},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new j(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Je(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Je(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ai}},sprite:{diffuse:{value:new Je(16777215)},opacity:{value:1},center:{value:new j(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ai}}},es={basic:{uniforms:A1([Te.common,Te.specularmap,Te.envmap,Te.aomap,Te.lightmap,Te.fog]),vertexShader:mt.meshbasic_vert,fragmentShader:mt.meshbasic_frag},lambert:{uniforms:A1([Te.common,Te.specularmap,Te.envmap,Te.aomap,Te.lightmap,Te.emissivemap,Te.bumpmap,Te.normalmap,Te.displacementmap,Te.fog,Te.lights,{emissive:{value:new Je(0)}}]),vertexShader:mt.meshlambert_vert,fragmentShader:mt.meshlambert_frag},phong:{uniforms:A1([Te.common,Te.specularmap,Te.envmap,Te.aomap,Te.lightmap,Te.emissivemap,Te.bumpmap,Te.normalmap,Te.displacementmap,Te.fog,Te.lights,{emissive:{value:new Je(0)},specular:{value:new Je(1118481)},shininess:{value:30}}]),vertexShader:mt.meshphong_vert,fragmentShader:mt.meshphong_frag},standard:{uniforms:A1([Te.common,Te.envmap,Te.aomap,Te.lightmap,Te.emissivemap,Te.bumpmap,Te.normalmap,Te.displacementmap,Te.roughnessmap,Te.metalnessmap,Te.fog,Te.lights,{emissive:{value:new Je(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:mt.meshphysical_vert,fragmentShader:mt.meshphysical_frag},toon:{uniforms:A1([Te.common,Te.aomap,Te.lightmap,Te.emissivemap,Te.bumpmap,Te.normalmap,Te.displacementmap,Te.gradientmap,Te.fog,Te.lights,{emissive:{value:new Je(0)}}]),vertexShader:mt.meshtoon_vert,fragmentShader:mt.meshtoon_frag},matcap:{uniforms:A1([Te.common,Te.bumpmap,Te.normalmap,Te.displacementmap,Te.fog,{matcap:{value:null}}]),vertexShader:mt.meshmatcap_vert,fragmentShader:mt.meshmatcap_frag},points:{uniforms:A1([Te.points,Te.fog]),vertexShader:mt.points_vert,fragmentShader:mt.points_frag},dashed:{uniforms:A1([Te.common,Te.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:mt.linedashed_vert,fragmentShader:mt.linedashed_frag},depth:{uniforms:A1([Te.common,Te.displacementmap]),vertexShader:mt.depth_vert,fragmentShader:mt.depth_frag},normal:{uniforms:A1([Te.common,Te.bumpmap,Te.normalmap,Te.displacementmap,{opacity:{value:1}}]),vertexShader:mt.meshnormal_vert,fragmentShader:mt.meshnormal_frag},sprite:{uniforms:A1([Te.sprite,Te.fog]),vertexShader:mt.sprite_vert,fragmentShader:mt.sprite_frag},background:{uniforms:{uvTransform:{value:new Ai},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:mt.background_vert,fragmentShader:mt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:mt.backgroundCube_vert,fragmentShader:mt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:mt.cube_vert,fragmentShader:mt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:mt.equirect_vert,fragmentShader:mt.equirect_frag},distanceRGBA:{uniforms:A1([Te.common,Te.displacementmap,{referencePosition:{value:new E},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:mt.distanceRGBA_vert,fragmentShader:mt.distanceRGBA_frag},shadow:{uniforms:A1([Te.lights,Te.fog,{color:{value:new Je(0)},opacity:{value:1}}]),vertexShader:mt.shadow_vert,fragmentShader:mt.shadow_frag}};es.physical={uniforms:A1([es.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new j(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Je(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new j},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Je(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Je(1,1,1)},specularColorMap:{value:null}}]),vertexShader:mt.meshphysical_vert,fragmentShader:mt.meshphysical_frag};var kh={r:0,b:0,g:0};function EE(e,t,i,r,s,a,n){let o=new Je(0),l=a===!0?0:1,h,c,d=null,u=0,p=null;function f(m,v){let y=!1,x=v.isScene===!0?v.background:null;x&&x.isTexture&&(x=(v.backgroundBlurriness>0?i:t).get(x));let w=e.xr,_=w.getSession&&w.getSession();_&&_.environmentBlendMode==="additive"&&(x=null),x===null?g(o,l):x&&x.isColor&&(g(x,1),y=!0),(e.autoClear||y)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),x&&(x.isCubeTexture||x.mapping===ih)?(c===void 0&&(c=new si(new Lr(1,1,1),new It({name:"BackgroundCubeMaterial",uniforms:il(es.backgroundCube.uniforms),vertexShader:es.backgroundCube.vertexShader,fragmentShader:es.backgroundCube.fragmentShader,side:Yi,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(b,A,S){this.matrixWorld.copyPosition(S.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(c)),c.material.uniforms.envMap.value=x,c.material.uniforms.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,c.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,c.material.toneMapped=x.encoding!==ft,(d!==x||u!==x.version||p!==e.toneMapping)&&(c.material.needsUpdate=!0,d=x,u=x.version,p=e.toneMapping),c.layers.enableAll(),m.unshift(c,c.geometry,c.material,0,0,null)):x&&x.isTexture&&(h===void 0&&(h=new si(new $s(2,2),new It({name:"BackgroundMaterial",uniforms:il(es.background.uniforms),vertexShader:es.background.vertexShader,fragmentShader:es.background.fragmentShader,side:Or,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(h)),h.material.uniforms.t2D.value=x,h.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,h.material.toneMapped=x.encoding!==ft,x.matrixAutoUpdate===!0&&x.updateMatrix(),h.material.uniforms.uvTransform.value.copy(x.matrix),(d!==x||u!==x.version||p!==e.toneMapping)&&(h.material.needsUpdate=!0,d=x,u=x.version,p=e.toneMapping),h.layers.enableAll(),m.unshift(h,h.geometry,h.material,0,0,null))}function g(m,v){m.getRGB(kh,fv(e)),r.buffers.color.setClear(kh.r,kh.g,kh.b,v,n)}return{getClearColor:function(){return o},setClearColor:function(m,v=1){o.set(m),l=v,g(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(m){l=m,g(o,l)},render:f}}function CE(e,t,i,r){let s=e.getParameter(34921),a=r.isWebGL2?null:t.get("OES_vertex_array_object"),n=r.isWebGL2||a!==null,o={},l=m(null),h=l,c=!1;function d(D,k,H,U,F){let Z=!1;if(n){let W=g(U,H,k);h!==W&&(h=W,p(h.object)),Z=v(D,U,H,F),Z&&y(D,U,H,F)}else{let W=k.wireframe===!0;(h.geometry!==U.id||h.program!==H.id||h.wireframe!==W)&&(h.geometry=U.id,h.program=H.id,h.wireframe=W,Z=!0)}F!==null&&i.update(F,34963),(Z||c)&&(c=!1,S(D,k,H,U),F!==null&&e.bindBuffer(34963,i.get(F).buffer))}function u(){return r.isWebGL2?e.createVertexArray():a.createVertexArrayOES()}function p(D){return r.isWebGL2?e.bindVertexArray(D):a.bindVertexArrayOES(D)}function f(D){return r.isWebGL2?e.deleteVertexArray(D):a.deleteVertexArrayOES(D)}function g(D,k,H){let U=H.wireframe===!0,F=o[D.id];F===void 0&&(F={},o[D.id]=F);let Z=F[k.id];Z===void 0&&(Z={},F[k.id]=Z);let W=Z[U];return W===void 0&&(W=m(u()),Z[U]=W),W}function m(D){let k=[],H=[],U=[];for(let F=0;F<s;F++)k[F]=0,H[F]=0,U[F]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:k,enabledAttributes:H,attributeDivisors:U,object:D,attributes:{},index:null}}function v(D,k,H,U){let F=h.attributes,Z=k.attributes,W=0,G=H.getAttributes();for(let X in G)if(G[X].location>=0){let ee=F[X],Y=Z[X];if(Y===void 0&&(X==="instanceMatrix"&&D.instanceMatrix&&(Y=D.instanceMatrix),X==="instanceColor"&&D.instanceColor&&(Y=D.instanceColor)),ee===void 0||ee.attribute!==Y||Y&&ee.data!==Y.data)return!0;W++}return h.attributesNum!==W||h.index!==U}function y(D,k,H,U){let F={},Z=k.attributes,W=0,G=H.getAttributes();for(let X in G)if(G[X].location>=0){let ee=Z[X];ee===void 0&&(X==="instanceMatrix"&&D.instanceMatrix&&(ee=D.instanceMatrix),X==="instanceColor"&&D.instanceColor&&(ee=D.instanceColor));let Y={};Y.attribute=ee,ee&&ee.data&&(Y.data=ee.data),F[X]=Y,W++}h.attributes=F,h.attributesNum=W,h.index=U}function x(){let D=h.newAttributes;for(let k=0,H=D.length;k<H;k++)D[k]=0}function w(D){_(D,0)}function _(D,k){let H=h.newAttributes,U=h.enabledAttributes,F=h.attributeDivisors;H[D]=1,U[D]===0&&(e.enableVertexAttribArray(D),U[D]=1),F[D]!==k&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](D,k),F[D]=k)}function b(){let D=h.newAttributes,k=h.enabledAttributes;for(let H=0,U=k.length;H<U;H++)k[H]!==D[H]&&(e.disableVertexAttribArray(H),k[H]=0)}function A(D,k,H,U,F,Z){r.isWebGL2===!0&&(H===5124||H===5125)?e.vertexAttribIPointer(D,k,H,F,Z):e.vertexAttribPointer(D,k,H,U,F,Z)}function S(D,k,H,U){if(r.isWebGL2===!1&&(D.isInstancedMesh||U.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;x();let F=U.attributes,Z=H.getAttributes(),W=k.defaultAttributeValues;for(let G in Z){let X=Z[G];if(X.location>=0){let ee=F[G];if(ee===void 0&&(G==="instanceMatrix"&&D.instanceMatrix&&(ee=D.instanceMatrix),G==="instanceColor"&&D.instanceColor&&(ee=D.instanceColor)),ee!==void 0){let Y=ee.normalized,$=ee.itemSize,Q=i.get(ee);if(Q===void 0)continue;let le=Q.buffer,re=Q.type,te=Q.bytesPerElement;if(ee.isInterleavedBufferAttribute){let ne=ee.data,ce=ne.stride,pe=ee.offset;if(ne.isInstancedInterleavedBuffer){for(let xe=0;xe<X.locationSize;xe++)_(X.location+xe,ne.meshPerAttribute);D.isInstancedMesh!==!0&&U._maxInstanceCount===void 0&&(U._maxInstanceCount=ne.meshPerAttribute*ne.count)}else for(let xe=0;xe<X.locationSize;xe++)w(X.location+xe);e.bindBuffer(34962,le);for(let xe=0;xe<X.locationSize;xe++)A(X.location+xe,$/X.locationSize,re,Y,ce*te,(pe+$/X.locationSize*xe)*te)}else{if(ee.isInstancedBufferAttribute){for(let ne=0;ne<X.locationSize;ne++)_(X.location+ne,ee.meshPerAttribute);D.isInstancedMesh!==!0&&U._maxInstanceCount===void 0&&(U._maxInstanceCount=ee.meshPerAttribute*ee.count)}else for(let ne=0;ne<X.locationSize;ne++)w(X.location+ne);e.bindBuffer(34962,le);for(let ne=0;ne<X.locationSize;ne++)A(X.location+ne,$/X.locationSize,re,Y,$*te,$/X.locationSize*ne*te)}}else if(W!==void 0){let Y=W[G];if(Y!==void 0)switch(Y.length){case 2:e.vertexAttrib2fv(X.location,Y);break;case 3:e.vertexAttrib3fv(X.location,Y);break;case 4:e.vertexAttrib4fv(X.location,Y);break;default:e.vertexAttrib1fv(X.location,Y)}}}}b()}function M(){P();for(let D in o){let k=o[D];for(let H in k){let U=k[H];for(let F in U)f(U[F].object),delete U[F];delete k[H]}delete o[D]}}function C(D){if(o[D.id]===void 0)return;let k=o[D.id];for(let H in k){let U=k[H];for(let F in U)f(U[F].object),delete U[F];delete k[H]}delete o[D.id]}function T(D){for(let k in o){let H=o[k];if(H[D.id]===void 0)continue;let U=H[D.id];for(let F in U)f(U[F].object),delete U[F];delete H[D.id]}}function P(){I(),c=!0,h!==l&&(h=l,p(h.object))}function I(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:d,reset:P,resetDefaultState:I,dispose:M,releaseStatesOfGeometry:C,releaseStatesOfProgram:T,initAttributes:x,enableAttribute:w,disableUnusedAttributes:b}}function TE(e,t,i,r){let s=r.isWebGL2,a;function n(h){a=h}function o(h,c){e.drawArrays(a,h,c),i.update(c,a,1)}function l(h,c,d){if(d===0)return;let u,p;if(s)u=e,p="drawArraysInstanced";else if(u=t.get("ANGLE_instanced_arrays"),p="drawArraysInstancedANGLE",u===null)return;u[p](a,h,c,d),i.update(c,a,d)}this.setMode=n,this.render=o,this.renderInstances=l}function PE(e,t,i){let r;function s(){if(r!==void 0)return r;if(t.has("EXT_texture_filter_anisotropic")===!0){let A=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(A.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function a(A){if(A==="highp"){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";A="mediump"}return A==="mediump"&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let n=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext,o=i.precision!==void 0?i.precision:"highp",l=a(o);l!==o&&(o=l);let h=n||t.has("WEBGL_draw_buffers"),c=i.logarithmicDepthBuffer===!0,d=e.getParameter(34930),u=e.getParameter(35660),p=e.getParameter(3379),f=e.getParameter(34076),g=e.getParameter(34921),m=e.getParameter(36347),v=e.getParameter(36348),y=e.getParameter(36349),x=u>0,w=n||t.has("OES_texture_float"),_=x&&w,b=n?e.getParameter(36183):0;return{isWebGL2:n,drawBuffers:h,getMaxAnisotropy:s,getMaxPrecision:a,precision:o,logarithmicDepthBuffer:c,maxTextures:d,maxVertexTextures:u,maxTextureSize:p,maxCubemapSize:f,maxAttributes:g,maxVertexUniforms:m,maxVaryings:v,maxFragmentUniforms:y,vertexTextures:x,floatFragmentTextures:w,floatVertexTextures:_,maxSamples:b}}function DE(e){let t=this,i=null,r=0,s=!1,a=!1,n=new B1,o=new Ai,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,u){let p=d.length!==0||u||r!==0||s;return s=u,r=d.length,p},this.beginShadows=function(){a=!0,c(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(d,u){i=c(d,u,0)},this.setState=function(d,u,p){let f=d.clippingPlanes,g=d.clipIntersection,m=d.clipShadows,v=e.get(d);if(!s||f===null||f.length===0||a&&!m)a?c(null):h();else{let y=a?0:r,x=y*4,w=v.clippingState||null;l.value=w,w=c(f,u,x,p);for(let _=0;_!==x;++_)w[_]=i[_];v.clippingState=w,this.numIntersection=g?this.numPlanes:0,this.numPlanes+=y}};function h(){l.value!==i&&(l.value=i,l.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function c(d,u,p,f){let g=d!==null?d.length:0,m=null;if(g!==0){if(m=l.value,f!==!0||m===null){let v=p+g*4,y=u.matrixWorldInverse;o.getNormalMatrix(y),(m===null||m.length<v)&&(m=new Float32Array(v));for(let x=0,w=p;x!==g;++x,w+=4)n.copy(d[x]).applyMatrix4(y,o),n.normal.toArray(m,w),m[w+3]=n.constant}l.value=m,l.needsUpdate=!0}return t.numPlanes=g,t.numIntersection=0,m}}function IE(e){let t=new WeakMap;function i(n,o){return o===Kp?n.mapping=Ln:o===Jp&&(n.mapping=Bn),n}function r(n){if(n&&n.isTexture&&n.isRenderTargetTexture===!1){let o=n.mapping;if(o===Kp||o===Jp)if(t.has(n)){let l=t.get(n).texture;return i(l,n.mapping)}else{let l=n.image;if(l&&l.height>0){let h=new H_(l.height/2);return h.fromEquirectangularTexture(e,n),t.set(n,h),n.addEventListener("dispose",s),i(h.texture,n.mapping)}else return null}}return n}function s(n){let o=n.target;o.removeEventListener("dispose",s);let l=t.get(o);l!==void 0&&(t.delete(o),l.dispose())}function a(){t=new WeakMap}return{get:r,dispose:a}}var pd=class extends Vn{constructor(e=-1,t=1,i=1,r=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2,s=i-e,a=i+e,n=r+t,o=r-t;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=l*this.view.offsetX,a=s+l*this.view.width,n-=h*this.view.offsetY,o=n-h*this.view.height}this.projectionMatrix.makeOrthographic(s,a,n,o,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},zo=4,Am=[.125,.215,.35,.446,.526,.582],dn=20,yu=new pd,Mm=new Je,xu=null,on=(1+Math.sqrt(5))/2,oo=1/on,Em=[new E(1,1,1),new E(-1,1,1),new E(1,1,-1),new E(-1,1,-1),new E(0,on,oo),new E(0,on,-oo),new E(oo,0,on),new E(-oo,0,on),new E(on,oo,0),new E(-on,oo,0)],Cm=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){xu=this._renderer.getRenderTarget(),this._setSize(256);let s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Dm(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Pm(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(xu),e.scissorTest=!1,Uh(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Ln||e.mapping===Bn?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),xu=this._renderer.getRenderTarget();let i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:gt,minFilter:gt,generateMipmaps:!1,type:Ks,format:Wi,encoding:Rr,depthBuffer:!1},r=Tm(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Tm(e,t,i);let{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=OE(s)),this._blurMaterial=RE(s,e,t)}return r}_compileMaterial(e){let t=new si(this._lodPlanes[0],e);this._renderer.compile(t,yu)}_sceneToCubeUV(e,t,i,r){let s=new u1(90,1,t,i),a=[1,-1,1,1,1,1],n=[1,1,1,-1,-1,-1],o=this._renderer,l=o.autoClear,h=o.toneMapping;o.getClearColor(Mm),o.toneMapping=os,o.autoClear=!1;let c=new Js({name:"PMREM.Background",side:Yi,depthWrite:!1,depthTest:!1}),d=new si(new Lr,c),u=!1,p=e.background;p?p.isColor&&(c.color.copy(p),e.background=null,u=!0):(c.color.copy(Mm),u=!0);for(let f=0;f<6;f++){let g=f%3;g===0?(s.up.set(0,a[f],0),s.lookAt(n[f],0,0)):g===1?(s.up.set(0,0,a[f]),s.lookAt(0,n[f],0)):(s.up.set(0,a[f],0),s.lookAt(0,0,n[f]));let m=this._cubeSize;Uh(r,g*m,f>2?m:0,m,m),o.setRenderTarget(r),u&&o.render(d,s),o.render(e,s)}d.geometry.dispose(),d.material.dispose(),o.toneMapping=h,o.autoClear=l,e.background=p}_textureToCubeUV(e,t){let i=this._renderer,r=e.mapping===Ln||e.mapping===Bn;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=Dm()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Pm());let s=r?this._cubemapMaterial:this._equirectMaterial,a=new si(this._lodPlanes[0],s),n=s.uniforms;n.envMap.value=e;let o=this._cubeSize;Uh(t,0,0,3*o,2*o),i.setRenderTarget(t),i.render(a,yu)}_applyPMREM(e){let t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){let s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),a=Em[(r-1)%Em.length];this._blur(e,r-1,r,s,a)}t.autoClear=i}_blur(e,t,i,r,s){let a=this._pingPongRenderTarget;this._halfBlur(e,a,t,i,r,"latitudinal",s),this._halfBlur(a,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,a,n){let o=this._renderer,l=this._blurMaterial,h=3,c=new si(this._lodPlanes[r],l),d=l.uniforms,u=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*u):2*Math.PI/(2*dn-1),f=s/p,g=isFinite(s)?1+Math.floor(h*f):dn;g>dn&&`${s}${g}${dn}`;let m=[],v=0;for(let b=0;b<dn;++b){let A=b/f,S=Math.exp(-A*A/2);m.push(S),b===0?v+=S:b<g&&(v+=2*S)}for(let b=0;b<m.length;b++)m[b]=m[b]/v;d.envMap.value=e.texture,d.samples.value=g,d.weights.value=m,d.latitudinal.value=a==="latitudinal",n&&(d.poleAxis.value=n);let{_lodMax:y}=this;d.dTheta.value=p,d.mipInt.value=y-i;let x=this._sizeLods[r],w=3*x*(r>y-zo?r-y+zo:0),_=4*(this._cubeSize-x);Uh(t,w,_,3*x,2*x),o.setRenderTarget(t),o.render(c,yu)}};function OE(e){let t=[],i=[],r=[],s=e,a=e-zo+1+Am.length;for(let n=0;n<a;n++){let o=Math.pow(2,s);i.push(o);let l=1/o;n>e-zo?l=Am[n-e+zo-1]:n===0&&(l=0),r.push(l);let h=1/(o-2),c=-h,d=1+h,u=[c,c,d,c,d,d,c,c,d,d,c,d],p=6,f=6,g=3,m=2,v=1,y=new Float32Array(g*f*p),x=new Float32Array(m*f*p),w=new Float32Array(v*f*p);for(let b=0;b<p;b++){let A=b%3*2/3-1,S=b>2?0:-1,M=[A,S,0,A+2/3,S,0,A+2/3,S+1,0,A,S,0,A+2/3,S+1,0,A,S+1,0];y.set(M,g*f*b),x.set(u,m*f*b);let C=[b,b,b,b,b,b];w.set(C,v*f*b)}let _=new Ge;_.setAttribute("position",new ot(y,g)),_.setAttribute("uv",new ot(x,m)),_.setAttribute("faceIndex",new ot(w,v)),t.push(_),s>zo&&s--}return{lodPlanes:t,sizeLods:i,sigmas:r}}function Tm(e,t,i){let r=new Rt(e,t,i);return r.texture.mapping=ih,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function Uh(e,t,i,r,s){e.viewport.set(t,i,r,s),e.scissor.set(t,i,r,s)}function RE(e,t,i){let r=new Float32Array(dn),s=new E(0,1,0);return new It({name:"SphericalGaussianBlur",defines:{n:dn,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:s4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Mi,depthTest:!1,depthWrite:!1})}function Pm(){return new It({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:s4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Mi,depthTest:!1,depthWrite:!1})}function Dm(){return new It({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:s4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Mi,depthTest:!1,depthWrite:!1})}function s4(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function LE(e){let t=new WeakMap,i=null;function r(o){if(o&&o.isTexture){let l=o.mapping,h=l===Kp||l===Jp,c=l===Ln||l===Bn;if(h||c)if(o.isRenderTargetTexture&&o.needsPMREMUpdate===!0){o.needsPMREMUpdate=!1;let d=t.get(o);return i===null&&(i=new Cm(e)),d=h?i.fromEquirectangular(o,d):i.fromCubemap(o,d),t.set(o,d),d.texture}else{if(t.has(o))return t.get(o).texture;{let d=o.image;if(h&&d&&d.height>0||c&&d&&s(d)){i===null&&(i=new Cm(e));let u=h?i.fromEquirectangular(o):i.fromCubemap(o);return t.set(o,u),o.addEventListener("dispose",a),u.texture}else return null}}}return o}function s(o){let l=0,h=6;for(let c=0;c<h;c++)o[c]!==void 0&&l++;return l===h}function a(o){let l=o.target;l.removeEventListener("dispose",a);let h=t.get(l);h!==void 0&&(t.delete(l),h.dispose())}function n(){t=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:r,dispose:n}}function BE(e){let t={};function i(r){if(t[r]!==void 0)return t[r];let s;switch(r){case"WEBGL_depth_texture":s=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=e.getExtension(r)}return t[r]=s,s}return{has:function(r){return i(r)!==null},init:function(r){r.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(r){let s=i(r);return s===null&&""+r,s}}}function zE(e,t,i,r){let s={},a=new WeakMap;function n(d){let u=d.target;u.index!==null&&t.remove(u.index);for(let f in u.attributes)t.remove(u.attributes[f]);u.removeEventListener("dispose",n),delete s[u.id];let p=a.get(u);p&&(t.remove(p),a.delete(u)),r.releaseStatesOfGeometry(u),u.isInstancedBufferGeometry===!0&&delete u._maxInstanceCount,i.memory.geometries--}function o(d,u){return s[u.id]===!0||(u.addEventListener("dispose",n),s[u.id]=!0,i.memory.geometries++),u}function l(d){let u=d.attributes;for(let f in u)t.update(u[f],34962);let p=d.morphAttributes;for(let f in p){let g=p[f];for(let m=0,v=g.length;m<v;m++)t.update(g[m],34962)}}function h(d){let u=[],p=d.index,f=d.attributes.position,g=0;if(p!==null){let y=p.array;g=p.version;for(let x=0,w=y.length;x<w;x+=3){let _=y[x+0],b=y[x+1],A=y[x+2];u.push(_,b,b,A,A,_)}}else{let y=f.array;g=f.version;for(let x=0,w=y.length/3-1;x<w;x+=3){let _=x+0,b=x+1,A=x+2;u.push(_,b,b,A,A,_)}}let m=new(lv(u)?Vo:pv)(u,1);m.version=g;let v=a.get(d);v&&t.remove(v),a.set(d,m)}function c(d){let u=a.get(d);if(u){let p=d.index;p!==null&&u.version<p.version&&h(d)}else h(d);return a.get(d)}return{get:o,update:l,getWireframeAttribute:c}}function FE(e,t,i,r){let s=r.isWebGL2,a;function n(u){a=u}let o,l;function h(u){o=u.type,l=u.bytesPerElement}function c(u,p){e.drawElements(a,p,o,u*l),i.update(p,a,1)}function d(u,p,f){if(f===0)return;let g,m;if(s)g=e,m="drawElementsInstanced";else if(g=t.get("ANGLE_instanced_arrays"),m="drawElementsInstancedANGLE",g===null)return;g[m](a,p,o,u*l,f),i.update(p,a,f)}this.setMode=n,this.setIndex=h,this.render=c,this.renderInstances=d}function kE(e){let t={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function r(a,n,o){switch(i.calls++,n){case 4:i.triangles+=o*(a/3);break;case 1:i.lines+=o*(a/2);break;case 3:i.lines+=o*(a-1);break;case 2:i.lines+=o*a;break;case 0:i.points+=o*a;break;default:break}}function s(){i.frame++,i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:t,render:i,programs:null,autoReset:!0,reset:s,update:r}}function UE(e,t){return e[0]-t[0]}function NE(e,t){return Math.abs(t[1])-Math.abs(e[1])}function VE(e,t,i){let r={},s=new Float32Array(8),a=new WeakMap,n=new ht,o=[];for(let h=0;h<8;h++)o[h]=[h,0];function l(h,c,d,u){let p=h.morphTargetInfluences;if(t.isWebGL2===!0){let f=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,g=f!==void 0?f.length:0,m=a.get(c);if(m===void 0||m.count!==g){let x=function(){D.dispose(),a.delete(c),c.removeEventListener("dispose",x)};m!==void 0&&m.texture.dispose();let w=c.morphAttributes.position!==void 0,_=c.morphAttributes.normal!==void 0,b=c.morphAttributes.color!==void 0,A=c.morphAttributes.position||[],S=c.morphAttributes.normal||[],M=c.morphAttributes.color||[],C=0;w===!0&&(C=1),_===!0&&(C=2),b===!0&&(C=3);let T=c.attributes.position.count*C,P=1;T>t.maxTextureSize&&(P=Math.ceil(T/t.maxTextureSize),T=t.maxTextureSize);let I=new Float32Array(T*P*4*g),D=new uv(I,T,P,g);D.type=_i,D.needsUpdate=!0;let k=C*4;for(let H=0;H<g;H++){let U=A[H],F=S[H],Z=M[H],W=T*P*4*H;for(let G=0;G<U.count;G++){let X=G*k;w===!0&&(n.fromBufferAttribute(U,G),I[W+X+0]=n.x,I[W+X+1]=n.y,I[W+X+2]=n.z,I[W+X+3]=0),_===!0&&(n.fromBufferAttribute(F,G),I[W+X+4]=n.x,I[W+X+5]=n.y,I[W+X+6]=n.z,I[W+X+7]=0),b===!0&&(n.fromBufferAttribute(Z,G),I[W+X+8]=n.x,I[W+X+9]=n.y,I[W+X+10]=n.z,I[W+X+11]=Z.itemSize===4?n.w:1)}}m={count:g,texture:D,size:new j(T,P)},a.set(c,m),c.addEventListener("dispose",x)}let v=0;for(let x=0;x<p.length;x++)v+=p[x];let y=c.morphTargetsRelative?1:1-v;u.getUniforms().setValue(e,"morphTargetBaseInfluence",y),u.getUniforms().setValue(e,"morphTargetInfluences",p),u.getUniforms().setValue(e,"morphTargetsTexture",m.texture,i),u.getUniforms().setValue(e,"morphTargetsTextureSize",m.size)}else{let f=p===void 0?0:p.length,g=r[c.id];if(g===void 0||g.length!==f){g=[];for(let w=0;w<f;w++)g[w]=[w,0];r[c.id]=g}for(let w=0;w<f;w++){let _=g[w];_[0]=w,_[1]=p[w]}g.sort(NE);for(let w=0;w<8;w++)w<f&&g[w][1]?(o[w][0]=g[w][0],o[w][1]=g[w][1]):(o[w][0]=Number.MAX_SAFE_INTEGER,o[w][1]=0);o.sort(UE);let m=c.morphAttributes.position,v=c.morphAttributes.normal,y=0;for(let w=0;w<8;w++){let _=o[w],b=_[0],A=_[1];b!==Number.MAX_SAFE_INTEGER&&A?(m&&c.getAttribute("morphTarget"+w)!==m[b]&&c.setAttribute("morphTarget"+w,m[b]),v&&c.getAttribute("morphNormal"+w)!==v[b]&&c.setAttribute("morphNormal"+w,v[b]),s[w]=A,y+=A):(m&&c.hasAttribute("morphTarget"+w)===!0&&c.deleteAttribute("morphTarget"+w),v&&c.hasAttribute("morphNormal"+w)===!0&&c.deleteAttribute("morphNormal"+w),s[w]=0)}let x=c.morphTargetsRelative?1:1-y;u.getUniforms().setValue(e,"morphTargetBaseInfluence",x),u.getUniforms().setValue(e,"morphTargetInfluences",s)}}return{update:l}}function jE(e,t,i,r){let s=new WeakMap;function a(l){let h=r.render.frame,c=l.geometry,d=t.get(l,c);return s.get(d)!==h&&(t.update(d),s.set(d,h)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),i.update(l.instanceMatrix,34962),l.instanceColor!==null&&i.update(l.instanceColor,34962)),d}function n(){s=new WeakMap}function o(l){let h=l.target;h.removeEventListener("dispose",o),i.remove(h.instanceMatrix),h.instanceColor!==null&&i.remove(h.instanceColor)}return{update:a,dispose:n}}var gv=new ai,vv=new uv,yv=new T_,xv=new i4,Im=[],Om=[],Rm=new Float32Array(16),Lm=new Float32Array(9),Bm=new Float32Array(4);function xl(e,t,i){let r=e[0];if(r<=0||r>0)return e;let s=t*i,a=Im[s];if(a===void 0&&(a=new Float32Array(s),Im[s]=a),t!==0){r.toArray(a,0);for(let n=1,o=0;n!==t;++n)o+=i,e[n].toArray(a,o)}return a}function Bi(e,t){if(e.length!==t.length)return!1;for(let i=0,r=e.length;i<r;i++)if(e[i]!==t[i])return!1;return!0}function zi(e,t){for(let i=0,r=t.length;i<r;i++)e[i]=t[i]}function fd(e,t){let i=Om[t];i===void 0&&(i=new Int32Array(t),Om[t]=i);for(let r=0;r!==t;++r)i[r]=e.allocateTextureUnit();return i}function GE(e,t){let i=this.cache;i[0]!==t&&(e.uniform1f(this.addr,t),i[0]=t)}function HE(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(Bi(i,t))return;e.uniform2fv(this.addr,t),zi(i,t)}}function WE(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else if(t.r!==void 0)(i[0]!==t.r||i[1]!==t.g||i[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),i[0]=t.r,i[1]=t.g,i[2]=t.b);else{if(Bi(i,t))return;e.uniform3fv(this.addr,t),zi(i,t)}}function qE(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(Bi(i,t))return;e.uniform4fv(this.addr,t),zi(i,t)}}function YE(e,t){let i=this.cache,r=t.elements;if(r===void 0){if(Bi(i,t))return;e.uniformMatrix2fv(this.addr,!1,t),zi(i,t)}else{if(Bi(i,r))return;Bm.set(r),e.uniformMatrix2fv(this.addr,!1,Bm),zi(i,r)}}function XE(e,t){let i=this.cache,r=t.elements;if(r===void 0){if(Bi(i,t))return;e.uniformMatrix3fv(this.addr,!1,t),zi(i,t)}else{if(Bi(i,r))return;Lm.set(r),e.uniformMatrix3fv(this.addr,!1,Lm),zi(i,r)}}function QE(e,t){let i=this.cache,r=t.elements;if(r===void 0){if(Bi(i,t))return;e.uniformMatrix4fv(this.addr,!1,t),zi(i,t)}else{if(Bi(i,r))return;Rm.set(r),e.uniformMatrix4fv(this.addr,!1,Rm),zi(i,r)}}function ZE(e,t){let i=this.cache;i[0]!==t&&(e.uniform1i(this.addr,t),i[0]=t)}function KE(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(Bi(i,t))return;e.uniform2iv(this.addr,t),zi(i,t)}}function JE(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else{if(Bi(i,t))return;e.uniform3iv(this.addr,t),zi(i,t)}}function $E(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(Bi(i,t))return;e.uniform4iv(this.addr,t),zi(i,t)}}function eC(e,t){let i=this.cache;i[0]!==t&&(e.uniform1ui(this.addr,t),i[0]=t)}function tC(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(Bi(i,t))return;e.uniform2uiv(this.addr,t),zi(i,t)}}function iC(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else{if(Bi(i,t))return;e.uniform3uiv(this.addr,t),zi(i,t)}}function rC(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(Bi(i,t))return;e.uniform4uiv(this.addr,t),zi(i,t)}}function sC(e,t,i){let r=this.cache,s=i.allocateTextureUnit();r[0]!==s&&(e.uniform1i(this.addr,s),r[0]=s),i.setTexture2D(t||gv,s)}function aC(e,t,i){let r=this.cache,s=i.allocateTextureUnit();r[0]!==s&&(e.uniform1i(this.addr,s),r[0]=s),i.setTexture3D(t||yv,s)}function nC(e,t,i){let r=this.cache,s=i.allocateTextureUnit();r[0]!==s&&(e.uniform1i(this.addr,s),r[0]=s),i.setTextureCube(t||xv,s)}function oC(e,t,i){let r=this.cache,s=i.allocateTextureUnit();r[0]!==s&&(e.uniform1i(this.addr,s),r[0]=s),i.setTexture2DArray(t||vv,s)}function lC(e){switch(e){case 5126:return GE;case 35664:return HE;case 35665:return WE;case 35666:return qE;case 35674:return YE;case 35675:return XE;case 35676:return QE;case 5124:case 35670:return ZE;case 35667:case 35671:return KE;case 35668:case 35672:return JE;case 35669:case 35673:return $E;case 5125:return eC;case 36294:return tC;case 36295:return iC;case 36296:return rC;case 35678:case 36198:case 36298:case 36306:case 35682:return sC;case 35679:case 36299:case 36307:return aC;case 35680:case 36300:case 36308:case 36293:return nC;case 36289:case 36303:case 36311:case 36292:return oC}}function hC(e,t){e.uniform1fv(this.addr,t)}function cC(e,t){let i=xl(t,this.size,2);e.uniform2fv(this.addr,i)}function dC(e,t){let i=xl(t,this.size,3);e.uniform3fv(this.addr,i)}function uC(e,t){let i=xl(t,this.size,4);e.uniform4fv(this.addr,i)}function pC(e,t){let i=xl(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,i)}function fC(e,t){let i=xl(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,i)}function mC(e,t){let i=xl(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,i)}function gC(e,t){e.uniform1iv(this.addr,t)}function vC(e,t){e.uniform2iv(this.addr,t)}function yC(e,t){e.uniform3iv(this.addr,t)}function xC(e,t){e.uniform4iv(this.addr,t)}function bC(e,t){e.uniform1uiv(this.addr,t)}function wC(e,t){e.uniform2uiv(this.addr,t)}function SC(e,t){e.uniform3uiv(this.addr,t)}function _C(e,t){e.uniform4uiv(this.addr,t)}function AC(e,t,i){let r=this.cache,s=t.length,a=fd(i,s);Bi(r,a)||(e.uniform1iv(this.addr,a),zi(r,a));for(let n=0;n!==s;++n)i.setTexture2D(t[n]||gv,a[n])}function MC(e,t,i){let r=this.cache,s=t.length,a=fd(i,s);Bi(r,a)||(e.uniform1iv(this.addr,a),zi(r,a));for(let n=0;n!==s;++n)i.setTexture3D(t[n]||yv,a[n])}function EC(e,t,i){let r=this.cache,s=t.length,a=fd(i,s);Bi(r,a)||(e.uniform1iv(this.addr,a),zi(r,a));for(let n=0;n!==s;++n)i.setTextureCube(t[n]||xv,a[n])}function CC(e,t,i){let r=this.cache,s=t.length,a=fd(i,s);Bi(r,a)||(e.uniform1iv(this.addr,a),zi(r,a));for(let n=0;n!==s;++n)i.setTexture2DArray(t[n]||vv,a[n])}function TC(e){switch(e){case 5126:return hC;case 35664:return cC;case 35665:return dC;case 35666:return uC;case 35674:return pC;case 35675:return fC;case 35676:return mC;case 5124:case 35670:return gC;case 35667:case 35671:return vC;case 35668:case 35672:return yC;case 35669:case 35673:return xC;case 5125:return bC;case 36294:return wC;case 36295:return SC;case 36296:return _C;case 35678:case 36198:case 36298:case 36306:case 35682:return AC;case 35679:case 36299:case 36307:return MC;case 35680:case 36300:case 36308:case 36293:return EC;case 36289:case 36303:case 36311:case 36292:return CC}}var PC=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=lC(t.type)}},DC=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=TC(t.type)}},IC=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){let r=this.seq;for(let s=0,a=r.length;s!==a;++s){let n=r[s];n.setValue(e,t[n.id],i)}}},bu=/(\w+)(\])?(\[|\.)?/g;function zm(e,t){e.seq.push(t),e.map[t.id]=t}function OC(e,t,i){let r=e.name,s=r.length;for(bu.lastIndex=0;;){let a=bu.exec(r),n=bu.lastIndex,o=a[1],l=a[2]==="]",h=a[3];if(l&&(o=o|0),h===void 0||h==="["&&n+2===s){zm(i,h===void 0?new PC(o,e,t):new DC(o,e,t));break}else{let c=i.map[o];c===void 0&&(c=new IC(o),zm(i,c)),i=c}}}var W0=class{constructor(e,t){this.seq=[],this.map={};let i=e.getProgramParameter(t,35718);for(let r=0;r<i;++r){let s=e.getActiveUniform(t,r),a=e.getUniformLocation(t,s.name);OC(s,a,this)}}setValue(e,t,i,r){let s=this.map[t];s!==void 0&&s.setValue(e,i,r)}setOptional(e,t,i){let r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,a=t.length;s!==a;++s){let n=t[s],o=i[n.id];o.needsUpdate!==!1&&n.setValue(e,o.value,r)}}static seqWithValue(e,t){let i=[];for(let r=0,s=e.length;r!==s;++r){let a=e[r];a.id in t&&i.push(a)}return i}};function Fm(e,t,i){let r=e.createShader(t);return e.shaderSource(r,i),e.compileShader(r),r}var RC=0;function LC(e,t){let i=e.split(`
`),r=[],s=Math.max(t-6,0),a=Math.min(t+6,i.length);for(let n=s;n<a;n++){let o=n+1;r.push(`${o===t?">":" "} ${o}: ${i[n]}`)}return r.join(`
`)}function BC(e){switch(e){case Rr:return["Linear","( value )"];case ft:return["sRGB","( value )"];default:return["Linear","( value )"]}}function km(e,t,i){let r=e.getShaderParameter(t,35713),s=e.getShaderInfoLog(t).trim();if(r&&s==="")return"";let a=/ERROR: 0:(\d+)/.exec(s);if(a){let n=parseInt(a[1]);return i.toUpperCase()+`

`+s+`

`+LC(e.getShaderSource(t),n)}else return s}function zC(e,t){let i=BC(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function FC(e,t){let i;switch(t){case GS:i="Linear";break;case HS:i="Reinhard";break;case WS:i="OptimizedCineon";break;case qS:i="ACESFilmic";break;case YS:i="Custom";break;default:i="Linear"}return"vec3 "+e+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function kC(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(d2).join(`
`)}function UC(e){let t=[];for(let i in e){let r=e[i];r!==!1&&t.push("#define "+i+" "+r)}return t.join(`
`)}function NC(e,t){let i={},r=e.getProgramParameter(t,35721);for(let s=0;s<r;s++){let a=e.getActiveAttrib(t,s),n=a.name,o=1;a.type===35674&&(o=2),a.type===35675&&(o=3),a.type===35676&&(o=4),i[n]={type:a.type,location:e.getAttribLocation(t,n),locationSize:o}}return i}function d2(e){return e!==""}function Um(e,t){let i=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Nm(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var VC=/^[ \t]*#include +<([\w\d./]+)>/gm;function r3(e){return e.replace(VC,jC)}function jC(e,t){let i=mt[t];if(i===void 0)throw new Error("Can not resolve #include <"+t+">");return r3(i)}var GC=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Vm(e){return e.replace(GC,HC)}function HC(e,t,i,r){let s="";for(let a=parseInt(t);a<parseInt(i);a++)s+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return s}function jm(e){let t="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function WC(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===Kf?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===wS?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===c2&&(t="SHADOWMAP_TYPE_VSM"),t}function qC(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Ln:case Bn:t="ENVMAP_TYPE_CUBE";break;case ih:t="ENVMAP_TYPE_CUBE_UV";break}return t}function YC(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case Bn:t="ENVMAP_MODE_REFRACTION";break}return t}function XC(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case ev:t="ENVMAP_BLENDING_MULTIPLY";break;case VS:t="ENVMAP_BLENDING_MIX";break;case jS:t="ENVMAP_BLENDING_ADD";break}return t}function QC(e){let t=e.envMapCubeUVHeight;if(t===null)return null;let i=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,i),7*16)),texelHeight:r,maxMip:i}}function ZC(e,t,i,r){let s=e.getContext(),a=i.defines,n=i.vertexShader,o=i.fragmentShader,l=WC(i),h=qC(i),c=YC(i),d=XC(i),u=QC(i),p=i.isWebGL2?"":kC(i),f=UC(a),g=s.createProgram(),m,v,y=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(m=[f].filter(d2).join(`
`),m.length>0&&(m+=`
`),v=[p,f].filter(d2).join(`
`),v.length>0&&(v+=`
`)):(m=[jm(i),"#define SHADER_NAME "+i.shaderName,f,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+c:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(d2).join(`
`),v=[p,jm(i),"#define SHADER_NAME "+i.shaderName,f,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+h:"",i.envMap?"#define "+c:"",i.envMap?"#define "+d:"",u?"#define CUBEUV_TEXEL_WIDTH "+u.texelWidth:"",u?"#define CUBEUV_TEXEL_HEIGHT "+u.texelHeight:"",u?"#define CUBEUV_MAX_MIP "+u.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==os?"#define TONE_MAPPING":"",i.toneMapping!==os?mt.tonemapping_pars_fragment:"",i.toneMapping!==os?FC("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",mt.encodings_pars_fragment,zC("linearToOutputTexel",i.outputEncoding),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(d2).join(`
`)),n=r3(n),n=Um(n,i),n=Nm(n,i),o=r3(o),o=Um(o,i),o=Nm(o,i),n=Vm(n),o=Vm(o),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,m=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+m,v=["#define varying in",i.glslVersion===um?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===um?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);let x=y+m+n,w=y+v+o,_=Fm(s,35633,x),b=Fm(s,35632,w);if(s.attachShader(g,_),s.attachShader(g,b),i.index0AttributeName!==void 0?s.bindAttribLocation(g,0,i.index0AttributeName):i.morphTargets===!0&&s.bindAttribLocation(g,0,"position"),s.linkProgram(g),e.debug.checkShaderErrors){let M=s.getProgramInfoLog(g).trim(),C=s.getShaderInfoLog(_).trim(),T=s.getShaderInfoLog(b).trim(),P=!0,I=!0;if(s.getProgramParameter(g,35714)===!1){P=!1;let D=km(s,_,"vertex"),k=km(s,b,"fragment");""+s.getError()+s.getProgramParameter(g,35715)+M+D+k}else M!==""||(C===""||T==="")&&(I=!1);I&&(this.diagnostics={runnable:P,programLog:M,vertexShader:{log:C,prefix:m},fragmentShader:{log:T,prefix:v}})}s.deleteShader(_),s.deleteShader(b);let A;this.getUniforms=function(){return A===void 0&&(A=new W0(s,g)),A};let S;return this.getAttributes=function(){return S===void 0&&(S=NC(s,g)),S},this.destroy=function(){r.releaseStatesOfProgram(this),s.deleteProgram(g),this.program=void 0},this.name=i.shaderName,this.id=RC++,this.cacheKey=t,this.usedTimes=1,this.program=g,this.vertexShader=_,this.fragmentShader=b,this}var KC=0,JC=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(i),a=this._getShaderCacheForMaterial(e);return a.has(r)===!1&&(a.add(r),r.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){let t=this.shaderCache,i=t.get(e);return i===void 0&&(i=new $C(e),t.set(e,i)),i}},$C=class{constructor(e){this.id=KC++,this.code=e,this.usedTimes=0}};function eT(e,t,i,r,s,a,n){let o=new t4,l=new JC,h=[],c=s.isWebGL2,d=s.logarithmicDepthBuffer,u=s.vertexTextures,p=s.precision,f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(S,M,C,T,P){let I=T.fog,D=P.geometry,k=S.isMeshStandardMaterial?T.environment:null,H=(S.isMeshStandardMaterial?i:t).get(S.envMap||k),U=H&&H.mapping===ih?H.image.height:null,F=f[S.type];S.precision!==null&&(p=s.getMaxPrecision(S.precision),p!==S.precision&&S.precision);let Z=D.morphAttributes.position||D.morphAttributes.normal||D.morphAttributes.color,W=Z!==void 0?Z.length:0,G=0;D.morphAttributes.position!==void 0&&(G=1),D.morphAttributes.normal!==void 0&&(G=2),D.morphAttributes.color!==void 0&&(G=3);let X,ee,Y,$;if(F){let ne=es[F];X=ne.vertexShader,ee=ne.fragmentShader}else X=S.vertexShader,ee=S.fragmentShader,l.update(S),Y=l.getVertexShaderID(S),$=l.getFragmentShaderID(S);let Q=e.getRenderTarget(),le=S.alphaTest>0,re=S.clearcoat>0,te=S.iridescence>0;return{isWebGL2:c,shaderID:F,shaderName:S.type,vertexShader:X,fragmentShader:ee,defines:S.defines,customVertexShaderID:Y,customFragmentShaderID:$,isRawShaderMaterial:S.isRawShaderMaterial===!0,glslVersion:S.glslVersion,precision:p,instancing:P.isInstancedMesh===!0,instancingColor:P.isInstancedMesh===!0&&P.instanceColor!==null,supportsVertexTextures:u,outputEncoding:Q===null?e.outputEncoding:Q.isXRRenderTarget===!0?Q.texture.encoding:Rr,map:!!S.map,matcap:!!S.matcap,envMap:!!H,envMapMode:H&&H.mapping,envMapCubeUVHeight:U,lightMap:!!S.lightMap,aoMap:!!S.aoMap,emissiveMap:!!S.emissiveMap,bumpMap:!!S.bumpMap,normalMap:!!S.normalMap,objectSpaceNormalMap:S.normalMapType===c_,tangentSpaceNormalMap:S.normalMapType===h_,decodeVideoTexture:!!S.map&&S.map.isVideoTexture===!0&&S.map.encoding===ft,clearcoat:re,clearcoatMap:re&&!!S.clearcoatMap,clearcoatRoughnessMap:re&&!!S.clearcoatRoughnessMap,clearcoatNormalMap:re&&!!S.clearcoatNormalMap,iridescence:te,iridescenceMap:te&&!!S.iridescenceMap,iridescenceThicknessMap:te&&!!S.iridescenceThicknessMap,displacementMap:!!S.displacementMap,roughnessMap:!!S.roughnessMap,metalnessMap:!!S.metalnessMap,specularMap:!!S.specularMap,specularIntensityMap:!!S.specularIntensityMap,specularColorMap:!!S.specularColorMap,opaque:S.transparent===!1&&S.blending===Cn,alphaMap:!!S.alphaMap,alphaTest:le,gradientMap:!!S.gradientMap,sheen:S.sheen>0,sheenColorMap:!!S.sheenColorMap,sheenRoughnessMap:!!S.sheenRoughnessMap,transmission:S.transmission>0,transmissionMap:!!S.transmissionMap,thicknessMap:!!S.thicknessMap,combine:S.combine,vertexTangents:!!S.normalMap&&!!D.attributes.tangent,vertexColors:S.vertexColors,vertexAlphas:S.vertexColors===!0&&!!D.attributes.color&&D.attributes.color.itemSize===4,vertexUvs:!!S.map||!!S.bumpMap||!!S.normalMap||!!S.specularMap||!!S.alphaMap||!!S.emissiveMap||!!S.roughnessMap||!!S.metalnessMap||!!S.clearcoatMap||!!S.clearcoatRoughnessMap||!!S.clearcoatNormalMap||!!S.iridescenceMap||!!S.iridescenceThicknessMap||!!S.displacementMap||!!S.transmissionMap||!!S.thicknessMap||!!S.specularIntensityMap||!!S.specularColorMap||!!S.sheenColorMap||!!S.sheenRoughnessMap,uvsVertexOnly:!(S.map||S.bumpMap||S.normalMap||S.specularMap||S.alphaMap||S.emissiveMap||S.roughnessMap||S.metalnessMap||S.clearcoatNormalMap||S.iridescenceMap||S.iridescenceThicknessMap||S.transmission>0||S.transmissionMap||S.thicknessMap||S.specularIntensityMap||S.specularColorMap||S.sheen>0||S.sheenColorMap||S.sheenRoughnessMap)&&!!S.displacementMap,fog:!!I,useFog:S.fog===!0,fogExp2:I&&I.isFogExp2,flatShading:!!S.flatShading,sizeAttenuation:S.sizeAttenuation,logarithmicDepthBuffer:d,skinning:P.isSkinnedMesh===!0,morphTargets:D.morphAttributes.position!==void 0,morphNormals:D.morphAttributes.normal!==void 0,morphColors:D.morphAttributes.color!==void 0,morphTargetsCount:W,morphTextureStride:G,numDirLights:M.directional.length,numPointLights:M.point.length,numSpotLights:M.spot.length,numSpotLightMaps:M.spotLightMap.length,numRectAreaLights:M.rectArea.length,numHemiLights:M.hemi.length,numDirLightShadows:M.directionalShadowMap.length,numPointLightShadows:M.pointShadowMap.length,numSpotLightShadows:M.spotShadowMap.length,numSpotLightShadowsWithMaps:M.numSpotLightShadowsWithMaps,numClippingPlanes:n.numPlanes,numClipIntersection:n.numIntersection,dithering:S.dithering,shadowMapEnabled:e.shadowMap.enabled&&C.length>0,shadowMapType:e.shadowMap.type,toneMapping:S.toneMapped?e.toneMapping:os,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:S.premultipliedAlpha,doubleSided:S.side===f1,flipSided:S.side===Yi,useDepthPacking:!!S.depthPacking,depthPacking:S.depthPacking||0,index0AttributeName:S.index0AttributeName,extensionDerivatives:S.extensions&&S.extensions.derivatives,extensionFragDepth:S.extensions&&S.extensions.fragDepth,extensionDrawBuffers:S.extensions&&S.extensions.drawBuffers,extensionShaderTextureLOD:S.extensions&&S.extensions.shaderTextureLOD,rendererExtensionFragDepth:c||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:c||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:c||r.has("EXT_shader_texture_lod"),customProgramCacheKey:S.customProgramCacheKey()}}function m(S){let M=[];if(S.shaderID?M.push(S.shaderID):(M.push(S.customVertexShaderID),M.push(S.customFragmentShaderID)),S.defines!==void 0)for(let C in S.defines)M.push(C),M.push(S.defines[C]);return S.isRawShaderMaterial===!1&&(v(M,S),y(M,S),M.push(e.outputEncoding)),M.push(S.customProgramCacheKey),M.join()}function v(S,M){S.push(M.precision),S.push(M.outputEncoding),S.push(M.envMapMode),S.push(M.envMapCubeUVHeight),S.push(M.combine),S.push(M.vertexUvs),S.push(M.fogExp2),S.push(M.sizeAttenuation),S.push(M.morphTargetsCount),S.push(M.morphAttributeCount),S.push(M.numDirLights),S.push(M.numPointLights),S.push(M.numSpotLights),S.push(M.numSpotLightMaps),S.push(M.numHemiLights),S.push(M.numRectAreaLights),S.push(M.numDirLightShadows),S.push(M.numPointLightShadows),S.push(M.numSpotLightShadows),S.push(M.numSpotLightShadowsWithMaps),S.push(M.shadowMapType),S.push(M.toneMapping),S.push(M.numClippingPlanes),S.push(M.numClipIntersection),S.push(M.depthPacking)}function y(S,M){o.disableAll(),M.isWebGL2&&o.enable(0),M.supportsVertexTextures&&o.enable(1),M.instancing&&o.enable(2),M.instancingColor&&o.enable(3),M.map&&o.enable(4),M.matcap&&o.enable(5),M.envMap&&o.enable(6),M.lightMap&&o.enable(7),M.aoMap&&o.enable(8),M.emissiveMap&&o.enable(9),M.bumpMap&&o.enable(10),M.normalMap&&o.enable(11),M.objectSpaceNormalMap&&o.enable(12),M.tangentSpaceNormalMap&&o.enable(13),M.clearcoat&&o.enable(14),M.clearcoatMap&&o.enable(15),M.clearcoatRoughnessMap&&o.enable(16),M.clearcoatNormalMap&&o.enable(17),M.iridescence&&o.enable(18),M.iridescenceMap&&o.enable(19),M.iridescenceThicknessMap&&o.enable(20),M.displacementMap&&o.enable(21),M.specularMap&&o.enable(22),M.roughnessMap&&o.enable(23),M.metalnessMap&&o.enable(24),M.gradientMap&&o.enable(25),M.alphaMap&&o.enable(26),M.alphaTest&&o.enable(27),M.vertexColors&&o.enable(28),M.vertexAlphas&&o.enable(29),M.vertexUvs&&o.enable(30),M.vertexTangents&&o.enable(31),M.uvsVertexOnly&&o.enable(32),S.push(o.mask),o.disableAll(),M.fog&&o.enable(0),M.useFog&&o.enable(1),M.flatShading&&o.enable(2),M.logarithmicDepthBuffer&&o.enable(3),M.skinning&&o.enable(4),M.morphTargets&&o.enable(5),M.morphNormals&&o.enable(6),M.morphColors&&o.enable(7),M.premultipliedAlpha&&o.enable(8),M.shadowMapEnabled&&o.enable(9),M.physicallyCorrectLights&&o.enable(10),M.doubleSided&&o.enable(11),M.flipSided&&o.enable(12),M.useDepthPacking&&o.enable(13),M.dithering&&o.enable(14),M.specularIntensityMap&&o.enable(15),M.specularColorMap&&o.enable(16),M.transmission&&o.enable(17),M.transmissionMap&&o.enable(18),M.thicknessMap&&o.enable(19),M.sheen&&o.enable(20),M.sheenColorMap&&o.enable(21),M.sheenRoughnessMap&&o.enable(22),M.decodeVideoTexture&&o.enable(23),M.opaque&&o.enable(24),S.push(o.mask)}function x(S){let M=f[S.type],C;if(M){let T=es[M];C=yl.clone(T.uniforms)}else C=S.uniforms;return C}function w(S,M){let C;for(let T=0,P=h.length;T<P;T++){let I=h[T];if(I.cacheKey===M){C=I,++C.usedTimes;break}}return C===void 0&&(C=new ZC(e,M,S,a),h.push(C)),C}function _(S){if(--S.usedTimes===0){let M=h.indexOf(S);h[M]=h[h.length-1],h.pop(),S.destroy()}}function b(S){l.remove(S)}function A(){l.dispose()}return{getParameters:g,getProgramCacheKey:m,getUniforms:x,acquireProgram:w,releaseProgram:_,releaseShaderCache:b,programs:h,dispose:A}}function tT(){let e=new WeakMap;function t(a){let n=e.get(a);return n===void 0&&(n={},e.set(a,n)),n}function i(a){e.delete(a)}function r(a,n,o){e.get(a)[n]=o}function s(){e=new WeakMap}return{get:t,remove:i,update:r,dispose:s}}function iT(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Gm(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Hm(){let e=[],t=0,i=[],r=[],s=[];function a(){t=0,i.length=0,r.length=0,s.length=0}function n(d,u,p,f,g,m){let v=e[t];return v===void 0?(v={id:d.id,object:d,geometry:u,material:p,groupOrder:f,renderOrder:d.renderOrder,z:g,group:m},e[t]=v):(v.id=d.id,v.object=d,v.geometry=u,v.material=p,v.groupOrder=f,v.renderOrder=d.renderOrder,v.z=g,v.group=m),t++,v}function o(d,u,p,f,g,m){let v=n(d,u,p,f,g,m);p.transmission>0?r.push(v):p.transparent===!0?s.push(v):i.push(v)}function l(d,u,p,f,g,m){let v=n(d,u,p,f,g,m);p.transmission>0?r.unshift(v):p.transparent===!0?s.unshift(v):i.unshift(v)}function h(d,u){i.length>1&&i.sort(d||iT),r.length>1&&r.sort(u||Gm),s.length>1&&s.sort(u||Gm)}function c(){for(let d=t,u=e.length;d<u;d++){let p=e[d];if(p.id===null)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.group=null}}return{opaque:i,transmissive:r,transparent:s,init:a,push:o,unshift:l,finish:c,sort:h}}function rT(){let e=new WeakMap;function t(r,s){let a=e.get(r),n;return a===void 0?(n=new Hm,e.set(r,[n])):s>=a.length?(n=new Hm,a.push(n)):n=a[s],n}function i(){e=new WeakMap}return{get:t,dispose:i}}function sT(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let i;switch(t.type){case"DirectionalLight":i={direction:new E,color:new Je};break;case"SpotLight":i={position:new E,direction:new E,color:new Je,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new E,color:new Je,distance:0,decay:0};break;case"HemisphereLight":i={direction:new E,skyColor:new Je,groundColor:new Je};break;case"RectAreaLight":i={color:new Je,position:new E,halfWidth:new E,halfHeight:new E};break}return e[t.id]=i,i}}}function aT(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let i;switch(t.type){case"DirectionalLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new j};break;case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new j};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new j,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[t.id]=i,i}}}var nT=0;function oT(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function lT(e,t){let i=new sT,r=aT(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let c=0;c<9;c++)s.probe.push(new E);let a=new E,n=new we,o=new we;function l(c,d){let u=0,p=0,f=0;for(let T=0;T<9;T++)s.probe[T].set(0,0,0);let g=0,m=0,v=0,y=0,x=0,w=0,_=0,b=0,A=0,S=0;c.sort(oT);let M=d!==!0?Math.PI:1;for(let T=0,P=c.length;T<P;T++){let I=c[T],D=I.color,k=I.intensity,H=I.distance,U=I.shadow&&I.shadow.map?I.shadow.map.texture:null;if(I.isAmbientLight)u+=D.r*k*M,p+=D.g*k*M,f+=D.b*k*M;else if(I.isLightProbe)for(let F=0;F<9;F++)s.probe[F].addScaledVector(I.sh.coefficients[F],k);else if(I.isDirectionalLight){let F=i.get(I);if(F.color.copy(I.color).multiplyScalar(I.intensity*M),I.castShadow){let Z=I.shadow,W=r.get(I);W.shadowBias=Z.bias,W.shadowNormalBias=Z.normalBias,W.shadowRadius=Z.radius,W.shadowMapSize=Z.mapSize,s.directionalShadow[g]=W,s.directionalShadowMap[g]=U,s.directionalShadowMatrix[g]=I.shadow.matrix,w++}s.directional[g]=F,g++}else if(I.isSpotLight){let F=i.get(I);F.position.setFromMatrixPosition(I.matrixWorld),F.color.copy(D).multiplyScalar(k*M),F.distance=H,F.coneCos=Math.cos(I.angle),F.penumbraCos=Math.cos(I.angle*(1-I.penumbra)),F.decay=I.decay,s.spot[v]=F;let Z=I.shadow;if(I.map&&(s.spotLightMap[A]=I.map,A++,Z.updateMatrices(I),I.castShadow&&S++),s.spotLightMatrix[v]=Z.matrix,I.castShadow){let W=r.get(I);W.shadowBias=Z.bias,W.shadowNormalBias=Z.normalBias,W.shadowRadius=Z.radius,W.shadowMapSize=Z.mapSize,s.spotShadow[v]=W,s.spotShadowMap[v]=U,b++}v++}else if(I.isRectAreaLight){let F=i.get(I);F.color.copy(D).multiplyScalar(k),F.halfWidth.set(I.width*.5,0,0),F.halfHeight.set(0,I.height*.5,0),s.rectArea[y]=F,y++}else if(I.isPointLight){let F=i.get(I);if(F.color.copy(I.color).multiplyScalar(I.intensity*M),F.distance=I.distance,F.decay=I.decay,I.castShadow){let Z=I.shadow,W=r.get(I);W.shadowBias=Z.bias,W.shadowNormalBias=Z.normalBias,W.shadowRadius=Z.radius,W.shadowMapSize=Z.mapSize,W.shadowCameraNear=Z.camera.near,W.shadowCameraFar=Z.camera.far,s.pointShadow[m]=W,s.pointShadowMap[m]=U,s.pointShadowMatrix[m]=I.shadow.matrix,_++}s.point[m]=F,m++}else if(I.isHemisphereLight){let F=i.get(I);F.skyColor.copy(I.color).multiplyScalar(k*M),F.groundColor.copy(I.groundColor).multiplyScalar(k*M),s.hemi[x]=F,x++}}y>0&&(t.isWebGL2||e.has("OES_texture_float_linear")===!0?(s.rectAreaLTC1=Te.LTC_FLOAT_1,s.rectAreaLTC2=Te.LTC_FLOAT_2):e.has("OES_texture_half_float_linear")===!0&&(s.rectAreaLTC1=Te.LTC_HALF_1,s.rectAreaLTC2=Te.LTC_HALF_2)),s.ambient[0]=u,s.ambient[1]=p,s.ambient[2]=f;let C=s.hash;(C.directionalLength!==g||C.pointLength!==m||C.spotLength!==v||C.rectAreaLength!==y||C.hemiLength!==x||C.numDirectionalShadows!==w||C.numPointShadows!==_||C.numSpotShadows!==b||C.numSpotMaps!==A)&&(s.directional.length=g,s.spot.length=v,s.rectArea.length=y,s.point.length=m,s.hemi.length=x,s.directionalShadow.length=w,s.directionalShadowMap.length=w,s.pointShadow.length=_,s.pointShadowMap.length=_,s.spotShadow.length=b,s.spotShadowMap.length=b,s.directionalShadowMatrix.length=w,s.pointShadowMatrix.length=_,s.spotLightMatrix.length=b+A-S,s.spotLightMap.length=A,s.numSpotLightShadowsWithMaps=S,C.directionalLength=g,C.pointLength=m,C.spotLength=v,C.rectAreaLength=y,C.hemiLength=x,C.numDirectionalShadows=w,C.numPointShadows=_,C.numSpotShadows=b,C.numSpotMaps=A,s.version=nT++)}function h(c,d){let u=0,p=0,f=0,g=0,m=0,v=d.matrixWorldInverse;for(let y=0,x=c.length;y<x;y++){let w=c[y];if(w.isDirectionalLight){let _=s.directional[u];_.direction.setFromMatrixPosition(w.matrixWorld),a.setFromMatrixPosition(w.target.matrixWorld),_.direction.sub(a),_.direction.transformDirection(v),u++}else if(w.isSpotLight){let _=s.spot[f];_.position.setFromMatrixPosition(w.matrixWorld),_.position.applyMatrix4(v),_.direction.setFromMatrixPosition(w.matrixWorld),a.setFromMatrixPosition(w.target.matrixWorld),_.direction.sub(a),_.direction.transformDirection(v),f++}else if(w.isRectAreaLight){let _=s.rectArea[g];_.position.setFromMatrixPosition(w.matrixWorld),_.position.applyMatrix4(v),o.identity(),n.copy(w.matrixWorld),n.premultiply(v),o.extractRotation(n),_.halfWidth.set(w.width*.5,0,0),_.halfHeight.set(0,w.height*.5,0),_.halfWidth.applyMatrix4(o),_.halfHeight.applyMatrix4(o),g++}else if(w.isPointLight){let _=s.point[p];_.position.setFromMatrixPosition(w.matrixWorld),_.position.applyMatrix4(v),p++}else if(w.isHemisphereLight){let _=s.hemi[m];_.direction.setFromMatrixPosition(w.matrixWorld),_.direction.transformDirection(v),m++}}}return{setup:l,setupView:h,state:s}}function Wm(e,t){let i=new lT(e,t),r=[],s=[];function a(){r.length=0,s.length=0}function n(c){r.push(c)}function o(c){s.push(c)}function l(c){i.setup(r,c)}function h(c){i.setupView(r,c)}return{init:a,state:{lightsArray:r,shadowsArray:s,lights:i},setupLights:l,setupLightsView:h,pushLight:n,pushShadow:o}}function hT(e,t){let i=new WeakMap;function r(a,n=0){let o=i.get(a),l;return o===void 0?(l=new Wm(e,t),i.set(a,[l])):n>=o.length?(l=new Wm(e,t),o.push(l)):l=o[n],l}function s(){i=new WeakMap}return{get:r,dispose:s}}var bv=class extends rh{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=na,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},cT=class extends rh{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new E,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},dT=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,uT=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function pT(e,t,i){let r=new r4,s=new j,a=new j,n=new ht,o=new bv({depthPacking:nv}),l=new cT,h={},c=i.maxTextureSize,d={[Or]:Yi,[Yi]:Or,[f1]:f1},u=new It({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new j},radius:{value:4}},vertexShader:dT,fragmentShader:uT}),p=u.clone();p.defines.HORIZONTAL_PASS=1;let f=new Ge;f.setAttribute("position",new ot(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let g=new si(f,u),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Kf,this.render=function(w,_,b){if(m.enabled===!1||m.autoUpdate===!1&&m.needsUpdate===!1||w.length===0)return;let A=e.getRenderTarget(),S=e.getActiveCubeFace(),M=e.getActiveMipmapLevel(),C=e.state;C.setBlending(Mi),C.buffers.color.setClear(1,1,1,1),C.buffers.depth.setTest(!0),C.setScissorTest(!1);for(let T=0,P=w.length;T<P;T++){let I=w[T],D=I.shadow;if(D===void 0||D.autoUpdate===!1&&D.needsUpdate===!1)continue;s.copy(D.mapSize);let k=D.getFrameExtents();if(s.multiply(k),a.copy(D.mapSize),(s.x>c||s.y>c)&&(s.x>c&&(a.x=Math.floor(c/k.x),s.x=a.x*k.x,D.mapSize.x=a.x),s.y>c&&(a.y=Math.floor(c/k.y),s.y=a.y*k.y,D.mapSize.y=a.y)),D.map===null){let U=this.type!==c2?{minFilter:Bt,magFilter:Bt}:{};D.map=new Rt(s.x,s.y,U),D.map.texture.name=I.name+".shadowMap",D.camera.updateProjectionMatrix()}e.setRenderTarget(D.map),e.clear();let H=D.getViewportCount();for(let U=0;U<H;U++){let F=D.getViewport(U);n.set(a.x*F.x,a.y*F.y,a.x*F.z,a.y*F.w),C.viewport(n),D.updateMatrices(I,U),r=D.getFrustum(),x(_,b,D.camera,I,this.type)}D.isPointLightShadow!==!0&&this.type===c2&&v(D,b),D.needsUpdate=!1}m.needsUpdate=!1,e.setRenderTarget(A,S,M)};function v(w,_){let b=t.update(g);u.defines.VSM_SAMPLES!==w.blurSamples&&(u.defines.VSM_SAMPLES=w.blurSamples,p.defines.VSM_SAMPLES=w.blurSamples,u.needsUpdate=!0,p.needsUpdate=!0),w.mapPass===null&&(w.mapPass=new Rt(s.x,s.y)),u.uniforms.shadow_pass.value=w.map.texture,u.uniforms.resolution.value=w.mapSize,u.uniforms.radius.value=w.radius,e.setRenderTarget(w.mapPass),e.clear(),e.renderBufferDirect(_,null,b,u,g,null),p.uniforms.shadow_pass.value=w.mapPass.texture,p.uniforms.resolution.value=w.mapSize,p.uniforms.radius.value=w.radius,e.setRenderTarget(w.map),e.clear(),e.renderBufferDirect(_,null,b,p,g,null)}function y(w,_,b,A,S,M){let C=null,T=b.isPointLight===!0?w.customDistanceMaterial:w.customDepthMaterial;if(T!==void 0)C=T;else if(C=b.isPointLight===!0?l:o,e.localClippingEnabled&&_.clipShadows===!0&&Array.isArray(_.clippingPlanes)&&_.clippingPlanes.length!==0||_.displacementMap&&_.displacementScale!==0||_.alphaMap&&_.alphaTest>0||_.map&&_.alphaTest>0){let P=C.uuid,I=_.uuid,D=h[P];D===void 0&&(D={},h[P]=D);let k=D[I];k===void 0&&(k=C.clone(),D[I]=k),C=k}return C.visible=_.visible,C.wireframe=_.wireframe,M===c2?C.side=_.shadowSide!==null?_.shadowSide:_.side:C.side=_.shadowSide!==null?_.shadowSide:d[_.side],C.alphaMap=_.alphaMap,C.alphaTest=_.alphaTest,C.map=_.map,C.clipShadows=_.clipShadows,C.clippingPlanes=_.clippingPlanes,C.clipIntersection=_.clipIntersection,C.displacementMap=_.displacementMap,C.displacementScale=_.displacementScale,C.displacementBias=_.displacementBias,C.wireframeLinewidth=_.wireframeLinewidth,C.linewidth=_.linewidth,b.isPointLight===!0&&C.isMeshDistanceMaterial===!0&&(C.referencePosition.setFromMatrixPosition(b.matrixWorld),C.nearDistance=A,C.farDistance=S),C}function x(w,_,b,A,S){if(w.visible===!1)return;if(w.layers.test(_.layers)&&(w.isMesh||w.isLine||w.isPoints)&&(w.castShadow||w.receiveShadow&&S===c2)&&(!w.frustumCulled||r.intersectsObject(w))){w.modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,w.matrixWorld);let C=t.update(w),T=w.material;if(Array.isArray(T)){let P=C.groups;for(let I=0,D=P.length;I<D;I++){let k=P[I],H=T[k.materialIndex];if(H&&H.visible){let U=y(w,H,A,b.near,b.far,S);e.renderBufferDirect(b,null,C,U,w,k)}}}else if(T.visible){let P=y(w,T,A,b.near,b.far,S);e.renderBufferDirect(b,null,C,P,w,null)}}let M=w.children;for(let C=0,T=M.length;C<T;C++)x(M[C],_,b,A,S)}}function fT(e,t,i){let r=i.isWebGL2;function s(){let K=!1,fe=new ht,be=null,Be=new ht(0,0,0,0);return{setMask:function(rt){be!==rt&&!K&&(e.colorMask(rt,rt,rt,rt),be=rt)},setLocked:function(rt){K=rt},setClear:function(rt,At,di,ki,kr){kr===!0&&(rt*=ki,At*=ki,di*=ki),fe.set(rt,At,di,ki),Be.equals(fe)===!1&&(e.clearColor(rt,At,di,ki),Be.copy(fe))},reset:function(){K=!1,be=null,Be.set(-1,0,0,0)}}}function a(){let K=!1,fe=null,be=null,Be=null;return{setTest:function(rt){rt?le(2929):re(2929)},setMask:function(rt){fe!==rt&&!K&&(e.depthMask(rt),fe=rt)},setFunc:function(rt){if(be!==rt){switch(rt){case LS:e.depthFunc(512);break;case BS:e.depthFunc(519);break;case zS:e.depthFunc(513);break;case Zp:e.depthFunc(515);break;case FS:e.depthFunc(514);break;case kS:e.depthFunc(518);break;case US:e.depthFunc(516);break;case NS:e.depthFunc(517);break;default:e.depthFunc(515)}be=rt}},setLocked:function(rt){K=rt},setClear:function(rt){Be!==rt&&(e.clearDepth(rt),Be=rt)},reset:function(){K=!1,fe=null,be=null,Be=null}}}function n(){let K=!1,fe=null,be=null,Be=null,rt=null,At=null,di=null,ki=null,kr=null;return{setTest:function(Qt){K||(Qt?le(2960):re(2960))},setMask:function(Qt){fe!==Qt&&!K&&(e.stencilMask(Qt),fe=Qt)},setFunc:function(Qt,pr,O1){(be!==Qt||Be!==pr||rt!==O1)&&(e.stencilFunc(Qt,pr,O1),be=Qt,Be=pr,rt=O1)},setOp:function(Qt,pr,O1){(At!==Qt||di!==pr||ki!==O1)&&(e.stencilOp(Qt,pr,O1),At=Qt,di=pr,ki=O1)},setLocked:function(Qt){K=Qt},setClear:function(Qt){kr!==Qt&&(e.clearStencil(Qt),kr=Qt)},reset:function(){K=!1,fe=null,be=null,Be=null,rt=null,At=null,di=null,ki=null,kr=null}}}let o=new s,l=new a,h=new n,c=new WeakMap,d=new WeakMap,u={},p={},f=new WeakMap,g=[],m=null,v=!1,y=null,x=null,w=null,_=null,b=null,A=null,S=null,M=!1,C=null,T=null,P=null,I=null,D=null,k=e.getParameter(35661),H=!1,U=0,F=e.getParameter(7938);F.indexOf("WebGL")!==-1?(U=parseFloat(/^WebGL (\d)/.exec(F)[1]),H=U>=1):F.indexOf("OpenGL ES")!==-1&&(U=parseFloat(/^OpenGL ES (\d)/.exec(F)[1]),H=U>=2);let Z=null,W={},G=e.getParameter(3088),X=e.getParameter(2978),ee=new ht().fromArray(G),Y=new ht().fromArray(X);function $(K,fe,be){let Be=new Uint8Array(4),rt=e.createTexture();e.bindTexture(K,rt),e.texParameteri(K,10241,9728),e.texParameteri(K,10240,9728);for(let At=0;At<be;At++)e.texImage2D(fe+At,0,6408,1,1,0,6408,5121,Be);return rt}let Q={};Q[3553]=$(3553,3553,1),Q[34067]=$(34067,34069,6),o.setClear(0,0,0,1),l.setClear(1),h.setClear(0),le(2929),l.setFunc(Zp),Ne(!1),Fe(z5),le(2884),Re(Mi);function le(K){u[K]!==!0&&(e.enable(K),u[K]=!0)}function re(K){u[K]!==!1&&(e.disable(K),u[K]=!1)}function te(K,fe){return p[K]!==fe?(e.bindFramebuffer(K,fe),p[K]=fe,r&&(K===36009&&(p[36160]=fe),K===36160&&(p[36009]=fe)),!0):!1}function ne(K,fe){let be=g,Be=!1;if(K)if(be=f.get(fe),be===void 0&&(be=[],f.set(fe,be)),K.isWebGLMultipleRenderTargets){let rt=K.texture;if(be.length!==rt.length||be[0]!==36064){for(let At=0,di=rt.length;At<di;At++)be[At]=36064+At;be.length=rt.length,Be=!0}}else be[0]!==36064&&(be[0]=36064,Be=!0);else be[0]!==1029&&(be[0]=1029,Be=!0);Be&&(i.isWebGL2?e.drawBuffers(be):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(be))}function ce(K){return m!==K?(e.useProgram(K),m=K,!0):!1}let pe={[Co]:32774,[_S]:32778,[AS]:32779};if(r)pe[N5]=32775,pe[V5]=32776;else{let K=t.get("EXT_blend_minmax");K!==null&&(pe[N5]=K.MIN_EXT,pe[V5]=K.MAX_EXT)}let xe={[MS]:0,[ES]:1,[CS]:768,[J7]:770,[RS]:776,[IS]:774,[PS]:772,[TS]:769,[$7]:771,[OS]:775,[DS]:773};function Re(K,fe,be,Be,rt,At,di,ki){if(K===Mi){v===!0&&(re(3042),v=!1);return}if(v===!1&&(le(3042),v=!0),K!==SS){if(K!==y||ki!==M){if((x!==Co||b!==Co)&&(e.blendEquation(32774),x=Co,b=Co),ki)switch(K){case Cn:e.blendFuncSeparate(1,771,1,771);break;case F5:e.blendFunc(1,1);break;case k5:e.blendFuncSeparate(0,769,0,1);break;case U5:e.blendFuncSeparate(0,768,0,770);break;default:break}else switch(K){case Cn:e.blendFuncSeparate(770,771,1,771);break;case F5:e.blendFunc(770,1);break;case k5:e.blendFuncSeparate(0,769,0,1);break;case U5:e.blendFunc(0,768);break;default:break}w=null,_=null,A=null,S=null,y=K,M=ki}return}rt=rt||fe,At=At||be,di=di||Be,(fe!==x||rt!==b)&&(e.blendEquationSeparate(pe[fe],pe[rt]),x=fe,b=rt),(be!==w||Be!==_||At!==A||di!==S)&&(e.blendFuncSeparate(xe[be],xe[Be],xe[At],xe[di]),w=be,_=Be,A=At,S=di),y=K,M=!1}function Ae(K,fe){K.side===f1?re(2884):le(2884);let be=K.side===Yi;fe&&(be=!be),Ne(be),K.blending===Cn&&K.transparent===!1?Re(Mi):Re(K.blending,K.blendEquation,K.blendSrc,K.blendDst,K.blendEquationAlpha,K.blendSrcAlpha,K.blendDstAlpha,K.premultipliedAlpha),l.setFunc(K.depthFunc),l.setTest(K.depthTest),l.setMask(K.depthWrite),o.setMask(K.colorWrite);let Be=K.stencilWrite;h.setTest(Be),Be&&(h.setMask(K.stencilWriteMask),h.setFunc(K.stencilFunc,K.stencilRef,K.stencilFuncMask),h.setOp(K.stencilFail,K.stencilZFail,K.stencilZPass)),Me(K.polygonOffset,K.polygonOffsetFactor,K.polygonOffsetUnits),K.alphaToCoverage===!0?le(32926):re(32926)}function Ne(K){C!==K&&(K?e.frontFace(2304):e.frontFace(2305),C=K)}function Fe(K){K!==xS?(le(2884),K!==T&&(K===z5?e.cullFace(1029):K===bS?e.cullFace(1028):e.cullFace(1032))):re(2884),T=K}function Ee(K){K!==P&&(H&&e.lineWidth(K),P=K)}function Me(K,fe,be){K?(le(32823),(I!==fe||D!==be)&&(e.polygonOffset(fe,be),I=fe,D=be)):re(32823)}function Ye(K){K?le(3089):re(3089)}function He(K){K===void 0&&(K=33984+k-1),Z!==K&&(e.activeTexture(K),Z=K)}function V(K,fe,be){be===void 0&&(Z===null?be=33984+k-1:be=Z);let Be=W[be];Be===void 0&&(Be={type:void 0,texture:void 0},W[be]=Be),(Be.type!==K||Be.texture!==fe)&&(Z!==be&&(e.activeTexture(be),Z=be),e.bindTexture(K,fe||Q[K]),Be.type=K,Be.texture=fe)}function B(){let K=W[Z];K!==void 0&&K.type!==void 0&&(e.bindTexture(K.type,null),K.type=void 0,K.texture=void 0)}function ae(){try{e.compressedTexImage2D.apply(e,arguments)}catch(K){}}function Se(){try{e.compressedTexImage3D.apply(e,arguments)}catch(K){}}function R(){try{e.texSubImage2D.apply(e,arguments)}catch(K){}}function Ce(){try{e.texSubImage3D.apply(e,arguments)}catch(K){}}function Ue(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(K){}}function Ie(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(K){}}function de(){try{e.texStorage2D.apply(e,arguments)}catch(K){}}function Ve(){try{e.texStorage3D.apply(e,arguments)}catch(K){}}function Le(){try{e.texImage2D.apply(e,arguments)}catch(K){}}function We(){try{e.texImage3D.apply(e,arguments)}catch(K){}}function $e(K){ee.equals(K)===!1&&(e.scissor(K.x,K.y,K.z,K.w),ee.copy(K))}function Xe(K){Y.equals(K)===!1&&(e.viewport(K.x,K.y,K.z,K.w),Y.copy(K))}function Ze(K,fe){let be=d.get(fe);be===void 0&&(be=new WeakMap,d.set(fe,be));let Be=be.get(K);Be===void 0&&(Be=e.getUniformBlockIndex(fe,K.name),be.set(K,Be))}function Ht(K,fe){let be=d.get(fe).get(K);c.get(fe)!==be&&(e.uniformBlockBinding(fe,be,K.__bindingPointIndex),c.set(fe,be))}function ti(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),r===!0&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),u={},Z=null,W={},p={},f=new WeakMap,g=[],m=null,v=!1,y=null,x=null,w=null,_=null,b=null,A=null,S=null,M=!1,C=null,T=null,P=null,I=null,D=null,ee.set(0,0,e.canvas.width,e.canvas.height),Y.set(0,0,e.canvas.width,e.canvas.height),o.reset(),l.reset(),h.reset()}return{buffers:{color:o,depth:l,stencil:h},enable:le,disable:re,bindFramebuffer:te,drawBuffers:ne,useProgram:ce,setBlending:Re,setMaterial:Ae,setFlipSided:Ne,setCullFace:Fe,setLineWidth:Ee,setPolygonOffset:Me,setScissorTest:Ye,activeTexture:He,bindTexture:V,unbindTexture:B,compressedTexImage2D:ae,compressedTexImage3D:Se,texImage2D:Le,texImage3D:We,updateUBOMapping:Ze,uniformBlockBinding:Ht,texStorage2D:de,texStorage3D:Ve,texSubImage2D:R,texSubImage3D:Ce,compressedTexSubImage2D:Ue,compressedTexSubImage3D:Ie,scissor:$e,viewport:Xe,reset:ti}}function mT(e,t,i,r,s,a,n){let o=s.isWebGL2,l=s.maxTextures,h=s.maxCubemapSize,c=s.maxTextureSize,d=s.maxSamples,u=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,p=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),f=new WeakMap,g,m=new WeakMap,v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(V,B){return v?new OffscreenCanvas(V,B):R2("canvas")}function x(V,B,ae,Se){let R=1;if((V.width>Se||V.height>Se)&&(R=Se/Math.max(V.width,V.height)),R<1||B===!0)if(typeof HTMLImageElement<"u"&&V instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&V instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&V instanceof ImageBitmap){let Ce=B?pc:Math.floor,Ue=Ce(R*V.width),Ie=Ce(R*V.height);g===void 0&&(g=y(Ue,Ie));let de=ae?y(Ue,Ie):g;return de.width=Ue,de.height=Ie,de.getContext("2d").drawImage(V,0,0,Ue,Ie),""+V.width+V.height+Ue+Ie,de}else return"data"in V&&""+V.width+V.height,V;return V}function w(V){return i3(V.width)&&i3(V.height)}function _(V){return o?!1:V.wrapS!==ei||V.wrapT!==ei||V.minFilter!==Bt&&V.minFilter!==gt}function b(V,B){return V.generateMipmaps&&B&&V.minFilter!==Bt&&V.minFilter!==gt}function A(V){e.generateMipmap(V)}function S(V,B,ae,Se,R=!1){if(o===!1)return B;if(V!==null){if(e[V]!==void 0)return e[V];""+V}let Ce=B;return B===6403&&(ae===5126&&(Ce=33326),ae===5131&&(Ce=33325),ae===5121&&(Ce=33321)),B===33319&&(ae===5126&&(Ce=33328),ae===5131&&(Ce=33327),ae===5121&&(Ce=33323)),B===6408&&(ae===5126&&(Ce=34836),ae===5131&&(Ce=34842),ae===5121&&(Ce=Se===ft&&R===!1?35907:32856),ae===32819&&(Ce=32854),ae===32820&&(Ce=32855)),(Ce===33325||Ce===33326||Ce===33327||Ce===33328||Ce===34842||Ce===34836)&&t.get("EXT_color_buffer_float"),Ce}function M(V,B,ae){return b(V,ae)===!0||V.isFramebufferTexture&&V.minFilter!==Bt&&V.minFilter!==gt?Math.log2(Math.max(B.width,B.height))+1:V.mipmaps!==void 0&&V.mipmaps.length>0?V.mipmaps.length:V.isCompressedTexture&&Array.isArray(V.image)?B.mipmaps.length:1}function C(V){return V===Bt||V===j5||V===Hd?9728:9729}function T(V){let B=V.target;B.removeEventListener("dispose",T),I(B),B.isVideoTexture&&f.delete(B)}function P(V){let B=V.target;B.removeEventListener("dispose",P),k(B)}function I(V){let B=r.get(V);if(B.__webglInit===void 0)return;let ae=V.source,Se=m.get(ae);if(Se){let R=Se[B.__cacheKey];R.usedTimes--,R.usedTimes===0&&D(V),Object.keys(Se).length===0&&m.delete(ae)}r.remove(V)}function D(V){let B=r.get(V);e.deleteTexture(B.__webglTexture);let ae=V.source,Se=m.get(ae);delete Se[B.__cacheKey],n.memory.textures--}function k(V){let B=V.texture,ae=r.get(V),Se=r.get(B);if(Se.__webglTexture!==void 0&&(e.deleteTexture(Se.__webglTexture),n.memory.textures--),V.depthTexture&&V.depthTexture.dispose(),V.isWebGLCubeRenderTarget)for(let R=0;R<6;R++)e.deleteFramebuffer(ae.__webglFramebuffer[R]),ae.__webglDepthbuffer&&e.deleteRenderbuffer(ae.__webglDepthbuffer[R]);else{if(e.deleteFramebuffer(ae.__webglFramebuffer),ae.__webglDepthbuffer&&e.deleteRenderbuffer(ae.__webglDepthbuffer),ae.__webglMultisampledFramebuffer&&e.deleteFramebuffer(ae.__webglMultisampledFramebuffer),ae.__webglColorRenderbuffer)for(let R=0;R<ae.__webglColorRenderbuffer.length;R++)ae.__webglColorRenderbuffer[R]&&e.deleteRenderbuffer(ae.__webglColorRenderbuffer[R]);ae.__webglDepthRenderbuffer&&e.deleteRenderbuffer(ae.__webglDepthRenderbuffer)}if(V.isWebGLMultipleRenderTargets)for(let R=0,Ce=B.length;R<Ce;R++){let Ue=r.get(B[R]);Ue.__webglTexture&&(e.deleteTexture(Ue.__webglTexture),n.memory.textures--),r.remove(B[R])}r.remove(B),r.remove(V)}let H=0;function U(){H=0}function F(){let V=H;return V>=l&&""+V+l,H+=1,V}function Z(V){let B=[];return B.push(V.wrapS),B.push(V.wrapT),B.push(V.wrapR||0),B.push(V.magFilter),B.push(V.minFilter),B.push(V.anisotropy),B.push(V.internalFormat),B.push(V.format),B.push(V.type),B.push(V.generateMipmaps),B.push(V.premultiplyAlpha),B.push(V.flipY),B.push(V.unpackAlignment),B.push(V.encoding),B.join()}function W(V,B){let ae=r.get(V);if(V.isVideoTexture&&Ye(V),V.isRenderTargetTexture===!1&&V.version>0&&ae.__version!==V.version){let Se=V.image;if(Se!==null){if(Se.complete!==!1){re(ae,V,B);return}}}i.bindTexture(3553,ae.__webglTexture,33984+B)}function G(V,B){let ae=r.get(V);if(V.version>0&&ae.__version!==V.version){re(ae,V,B);return}i.bindTexture(35866,ae.__webglTexture,33984+B)}function X(V,B){let ae=r.get(V);if(V.version>0&&ae.__version!==V.version){re(ae,V,B);return}i.bindTexture(32879,ae.__webglTexture,33984+B)}function ee(V,B){let ae=r.get(V);if(V.version>0&&ae.__version!==V.version){te(ae,V,B);return}i.bindTexture(34067,ae.__webglTexture,33984+B)}let Y={[Gs]:10497,[ei]:33071,[$p]:33648},$={[Bt]:9728,[j5]:9984,[Hd]:9986,[gt]:9729,[XS]:9985,[tl]:9987};function Q(V,B,ae){if(ae?(e.texParameteri(V,10242,Y[B.wrapS]),e.texParameteri(V,10243,Y[B.wrapT]),(V===32879||V===35866)&&e.texParameteri(V,32882,Y[B.wrapR]),e.texParameteri(V,10240,$[B.magFilter]),e.texParameteri(V,10241,$[B.minFilter])):(e.texParameteri(V,10242,33071),e.texParameteri(V,10243,33071),(V===32879||V===35866)&&e.texParameteri(V,32882,33071),B.wrapS!==ei||B.wrapT,e.texParameteri(V,10240,C(B.magFilter)),e.texParameteri(V,10241,C(B.minFilter)),B.minFilter!==Bt&&B.minFilter),t.has("EXT_texture_filter_anisotropic")===!0){let Se=t.get("EXT_texture_filter_anisotropic");if(B.magFilter===Bt||B.minFilter!==Hd&&B.minFilter!==tl||B.type===_i&&t.has("OES_texture_float_linear")===!1||o===!1&&B.type===Ks&&t.has("OES_texture_half_float_linear")===!1)return;(B.anisotropy>1||r.get(B).__currentAnisotropy)&&(e.texParameterf(V,Se.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(B.anisotropy,s.getMaxAnisotropy())),r.get(B).__currentAnisotropy=B.anisotropy)}}function le(V,B){let ae=!1;V.__webglInit===void 0&&(V.__webglInit=!0,B.addEventListener("dispose",T));let Se=B.source,R=m.get(Se);R===void 0&&(R={},m.set(Se,R));let Ce=Z(B);if(Ce!==V.__cacheKey){R[Ce]===void 0&&(R[Ce]={texture:e.createTexture(),usedTimes:0},n.memory.textures++,ae=!0),R[Ce].usedTimes++;let Ue=R[V.__cacheKey];Ue!==void 0&&(R[V.__cacheKey].usedTimes--,Ue.usedTimes===0&&D(B)),V.__cacheKey=Ce,V.__webglTexture=R[Ce].texture}return ae}function re(V,B,ae){let Se=3553;(B.isDataArrayTexture||B.isCompressedArrayTexture)&&(Se=35866),B.isData3DTexture&&(Se=32879);let R=le(V,B),Ce=B.source;i.bindTexture(Se,V.__webglTexture,33984+ae);let Ue=r.get(Ce);if(Ce.version!==Ue.__version||R===!0){i.activeTexture(33984+ae),e.pixelStorei(37440,B.flipY),e.pixelStorei(37441,B.premultiplyAlpha),e.pixelStorei(3317,B.unpackAlignment),e.pixelStorei(37443,0);let Ie=_(B)&&w(B.image)===!1,de=x(B.image,Ie,!1,c);de=He(B,de);let Ve=w(de)||o,Le=a.convert(B.format,B.encoding),We=a.convert(B.type),$e=S(B.internalFormat,Le,We,B.encoding,B.isVideoTexture);Q(Se,B,Ve);let Xe,Ze=B.mipmaps,Ht=o&&B.isVideoTexture!==!0,ti=Ue.__version===void 0||R===!0,K=M(B,de,Ve);if(B.isDepthTexture)$e=6402,o?B.type===_i?$e=36012:B.type===Hs?$e=33190:B.type===Tn?$e=35056:$e=33189:B.type,B.format===Pn&&$e===6402&&B.type!==iv&&B.type!==Hs&&(B.type=Hs,We=a.convert(B.type)),B.format===zn&&$e===6402&&($e=34041,B.type!==Tn&&(B.type=Tn,We=a.convert(B.type))),ti&&(Ht?i.texStorage2D(3553,1,$e,de.width,de.height):i.texImage2D(3553,0,$e,de.width,de.height,0,Le,We,null));else if(B.isDataTexture)if(Ze.length>0&&Ve){Ht&&ti&&i.texStorage2D(3553,K,$e,Ze[0].width,Ze[0].height);for(let fe=0,be=Ze.length;fe<be;fe++)Xe=Ze[fe],Ht?i.texSubImage2D(3553,fe,0,0,Xe.width,Xe.height,Le,We,Xe.data):i.texImage2D(3553,fe,$e,Xe.width,Xe.height,0,Le,We,Xe.data);B.generateMipmaps=!1}else Ht?(ti&&i.texStorage2D(3553,K,$e,de.width,de.height),i.texSubImage2D(3553,0,0,0,de.width,de.height,Le,We,de.data)):i.texImage2D(3553,0,$e,de.width,de.height,0,Le,We,de.data);else if(B.isCompressedTexture)if(B.isCompressedArrayTexture){Ht&&ti&&i.texStorage3D(35866,K,$e,Ze[0].width,Ze[0].height,de.depth);for(let fe=0,be=Ze.length;fe<be;fe++)Xe=Ze[fe],B.format!==Wi?Le!==null&&(Ht?i.compressedTexSubImage3D(35866,fe,0,0,0,Xe.width,Xe.height,de.depth,Le,Xe.data,0,0):i.compressedTexImage3D(35866,fe,$e,Xe.width,Xe.height,de.depth,0,Xe.data,0,0)):Ht?i.texSubImage3D(35866,fe,0,0,0,Xe.width,Xe.height,de.depth,Le,We,Xe.data):i.texImage3D(35866,fe,$e,Xe.width,Xe.height,de.depth,0,Le,We,Xe.data)}else{Ht&&ti&&i.texStorage2D(3553,K,$e,Ze[0].width,Ze[0].height);for(let fe=0,be=Ze.length;fe<be;fe++)Xe=Ze[fe],B.format!==Wi?Le!==null&&(Ht?i.compressedTexSubImage2D(3553,fe,0,0,Xe.width,Xe.height,Le,Xe.data):i.compressedTexImage2D(3553,fe,$e,Xe.width,Xe.height,0,Xe.data)):Ht?i.texSubImage2D(3553,fe,0,0,Xe.width,Xe.height,Le,We,Xe.data):i.texImage2D(3553,fe,$e,Xe.width,Xe.height,0,Le,We,Xe.data)}else if(B.isDataArrayTexture)Ht?(ti&&i.texStorage3D(35866,K,$e,de.width,de.height,de.depth),i.texSubImage3D(35866,0,0,0,0,de.width,de.height,de.depth,Le,We,de.data)):i.texImage3D(35866,0,$e,de.width,de.height,de.depth,0,Le,We,de.data);else if(B.isData3DTexture)Ht?(ti&&i.texStorage3D(32879,K,$e,de.width,de.height,de.depth),i.texSubImage3D(32879,0,0,0,0,de.width,de.height,de.depth,Le,We,de.data)):i.texImage3D(32879,0,$e,de.width,de.height,de.depth,0,Le,We,de.data);else if(B.isFramebufferTexture){if(ti)if(Ht)i.texStorage2D(3553,K,$e,de.width,de.height);else{let fe=de.width,be=de.height;for(let Be=0;Be<K;Be++)i.texImage2D(3553,Be,$e,fe,be,0,Le,We,null),fe>>=1,be>>=1}}else if(Ze.length>0&&Ve){Ht&&ti&&i.texStorage2D(3553,K,$e,Ze[0].width,Ze[0].height);for(let fe=0,be=Ze.length;fe<be;fe++)Xe=Ze[fe],Ht?i.texSubImage2D(3553,fe,0,0,Le,We,Xe):i.texImage2D(3553,fe,$e,Le,We,Xe);B.generateMipmaps=!1}else Ht?(ti&&i.texStorage2D(3553,K,$e,de.width,de.height),i.texSubImage2D(3553,0,0,0,Le,We,de)):i.texImage2D(3553,0,$e,Le,We,de);b(B,Ve)&&A(Se),Ue.__version=Ce.version,B.onUpdate&&B.onUpdate(B)}V.__version=B.version}function te(V,B,ae){if(B.image.length!==6)return;let Se=le(V,B),R=B.source;i.bindTexture(34067,V.__webglTexture,33984+ae);let Ce=r.get(R);if(R.version!==Ce.__version||Se===!0){i.activeTexture(33984+ae),e.pixelStorei(37440,B.flipY),e.pixelStorei(37441,B.premultiplyAlpha),e.pixelStorei(3317,B.unpackAlignment),e.pixelStorei(37443,0);let Ue=B.isCompressedTexture||B.image[0].isCompressedTexture,Ie=B.image[0]&&B.image[0].isDataTexture,de=[];for(let fe=0;fe<6;fe++)!Ue&&!Ie?de[fe]=x(B.image[fe],!1,!0,h):de[fe]=Ie?B.image[fe].image:B.image[fe],de[fe]=He(B,de[fe]);let Ve=de[0],Le=w(Ve)||o,We=a.convert(B.format,B.encoding),$e=a.convert(B.type),Xe=S(B.internalFormat,We,$e,B.encoding),Ze=o&&B.isVideoTexture!==!0,Ht=Ce.__version===void 0||Se===!0,ti=M(B,Ve,Le);Q(34067,B,Le);let K;if(Ue){Ze&&Ht&&i.texStorage2D(34067,ti,Xe,Ve.width,Ve.height);for(let fe=0;fe<6;fe++){K=de[fe].mipmaps;for(let be=0;be<K.length;be++){let Be=K[be];B.format!==Wi?We!==null&&(Ze?i.compressedTexSubImage2D(34069+fe,be,0,0,Be.width,Be.height,We,Be.data):i.compressedTexImage2D(34069+fe,be,Xe,Be.width,Be.height,0,Be.data)):Ze?i.texSubImage2D(34069+fe,be,0,0,Be.width,Be.height,We,$e,Be.data):i.texImage2D(34069+fe,be,Xe,Be.width,Be.height,0,We,$e,Be.data)}}}else{K=B.mipmaps,Ze&&Ht&&(K.length>0&&ti++,i.texStorage2D(34067,ti,Xe,de[0].width,de[0].height));for(let fe=0;fe<6;fe++)if(Ie){Ze?i.texSubImage2D(34069+fe,0,0,0,de[fe].width,de[fe].height,We,$e,de[fe].data):i.texImage2D(34069+fe,0,Xe,de[fe].width,de[fe].height,0,We,$e,de[fe].data);for(let be=0;be<K.length;be++){let Be=K[be].image[fe].image;Ze?i.texSubImage2D(34069+fe,be+1,0,0,Be.width,Be.height,We,$e,Be.data):i.texImage2D(34069+fe,be+1,Xe,Be.width,Be.height,0,We,$e,Be.data)}}else{Ze?i.texSubImage2D(34069+fe,0,0,0,We,$e,de[fe]):i.texImage2D(34069+fe,0,Xe,We,$e,de[fe]);for(let be=0;be<K.length;be++){let Be=K[be];Ze?i.texSubImage2D(34069+fe,be+1,0,0,We,$e,Be.image[fe]):i.texImage2D(34069+fe,be+1,Xe,We,$e,Be.image[fe])}}}b(B,Le)&&A(34067),Ce.__version=R.version,B.onUpdate&&B.onUpdate(B)}V.__version=B.version}function ne(V,B,ae,Se,R){let Ce=a.convert(ae.format,ae.encoding),Ue=a.convert(ae.type),Ie=S(ae.internalFormat,Ce,Ue,ae.encoding);r.get(B).__hasExternalTextures||(R===32879||R===35866?i.texImage3D(R,0,Ie,B.width,B.height,B.depth,0,Ce,Ue,null):i.texImage2D(R,0,Ie,B.width,B.height,0,Ce,Ue,null)),i.bindFramebuffer(36160,V),Me(B)?u.framebufferTexture2DMultisampleEXT(36160,Se,R,r.get(ae).__webglTexture,0,Ee(B)):(R===3553||R>=34069&&R<=34074)&&e.framebufferTexture2D(36160,Se,R,r.get(ae).__webglTexture,0),i.bindFramebuffer(36160,null)}function ce(V,B,ae){if(e.bindRenderbuffer(36161,V),B.depthBuffer&&!B.stencilBuffer){let Se=33189;if(ae||Me(B)){let R=B.depthTexture;R&&R.isDepthTexture&&(R.type===_i?Se=36012:R.type===Hs&&(Se=33190));let Ce=Ee(B);Me(B)?u.renderbufferStorageMultisampleEXT(36161,Ce,Se,B.width,B.height):e.renderbufferStorageMultisample(36161,Ce,Se,B.width,B.height)}else e.renderbufferStorage(36161,Se,B.width,B.height);e.framebufferRenderbuffer(36160,36096,36161,V)}else if(B.depthBuffer&&B.stencilBuffer){let Se=Ee(B);ae&&Me(B)===!1?e.renderbufferStorageMultisample(36161,Se,35056,B.width,B.height):Me(B)?u.renderbufferStorageMultisampleEXT(36161,Se,35056,B.width,B.height):e.renderbufferStorage(36161,34041,B.width,B.height),e.framebufferRenderbuffer(36160,33306,36161,V)}else{let Se=B.isWebGLMultipleRenderTargets===!0?B.texture:[B.texture];for(let R=0;R<Se.length;R++){let Ce=Se[R],Ue=a.convert(Ce.format,Ce.encoding),Ie=a.convert(Ce.type),de=S(Ce.internalFormat,Ue,Ie,Ce.encoding),Ve=Ee(B);ae&&Me(B)===!1?e.renderbufferStorageMultisample(36161,Ve,de,B.width,B.height):Me(B)?u.renderbufferStorageMultisampleEXT(36161,Ve,de,B.width,B.height):e.renderbufferStorage(36161,de,B.width,B.height)}}e.bindRenderbuffer(36161,null)}function pe(V,B){if(B&&B.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(36160,V),!(B.depthTexture&&B.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(B.depthTexture).__webglTexture||B.depthTexture.image.width!==B.width||B.depthTexture.image.height!==B.height)&&(B.depthTexture.image.width=B.width,B.depthTexture.image.height=B.height,B.depthTexture.needsUpdate=!0),W(B.depthTexture,0);let ae=r.get(B.depthTexture).__webglTexture,Se=Ee(B);if(B.depthTexture.format===Pn)Me(B)?u.framebufferTexture2DMultisampleEXT(36160,36096,3553,ae,0,Se):e.framebufferTexture2D(36160,36096,3553,ae,0);else if(B.depthTexture.format===zn)Me(B)?u.framebufferTexture2DMultisampleEXT(36160,33306,3553,ae,0,Se):e.framebufferTexture2D(36160,33306,3553,ae,0);else throw new Error("Unknown depthTexture format")}function xe(V){let B=r.get(V),ae=V.isWebGLCubeRenderTarget===!0;if(V.depthTexture&&!B.__autoAllocateDepthBuffer){if(ae)throw new Error("target.depthTexture not supported in Cube render targets");pe(B.__webglFramebuffer,V)}else if(ae){B.__webglDepthbuffer=[];for(let Se=0;Se<6;Se++)i.bindFramebuffer(36160,B.__webglFramebuffer[Se]),B.__webglDepthbuffer[Se]=e.createRenderbuffer(),ce(B.__webglDepthbuffer[Se],V,!1)}else i.bindFramebuffer(36160,B.__webglFramebuffer),B.__webglDepthbuffer=e.createRenderbuffer(),ce(B.__webglDepthbuffer,V,!1);i.bindFramebuffer(36160,null)}function Re(V,B,ae){let Se=r.get(V);B!==void 0&&ne(Se.__webglFramebuffer,V,V.texture,36064,3553),ae!==void 0&&xe(V)}function Ae(V){let B=V.texture,ae=r.get(V),Se=r.get(B);V.addEventListener("dispose",P),V.isWebGLMultipleRenderTargets!==!0&&(Se.__webglTexture===void 0&&(Se.__webglTexture=e.createTexture()),Se.__version=B.version,n.memory.textures++);let R=V.isWebGLCubeRenderTarget===!0,Ce=V.isWebGLMultipleRenderTargets===!0,Ue=w(V)||o;if(R){ae.__webglFramebuffer=[];for(let Ie=0;Ie<6;Ie++)ae.__webglFramebuffer[Ie]=e.createFramebuffer()}else{if(ae.__webglFramebuffer=e.createFramebuffer(),Ce&&s.drawBuffers){let Ie=V.texture;for(let de=0,Ve=Ie.length;de<Ve;de++){let Le=r.get(Ie[de]);Le.__webglTexture===void 0&&(Le.__webglTexture=e.createTexture(),n.memory.textures++)}}if(o&&V.samples>0&&Me(V)===!1){let Ie=Ce?B:[B];ae.__webglMultisampledFramebuffer=e.createFramebuffer(),ae.__webglColorRenderbuffer=[],i.bindFramebuffer(36160,ae.__webglMultisampledFramebuffer);for(let de=0;de<Ie.length;de++){let Ve=Ie[de];ae.__webglColorRenderbuffer[de]=e.createRenderbuffer(),e.bindRenderbuffer(36161,ae.__webglColorRenderbuffer[de]);let Le=a.convert(Ve.format,Ve.encoding),We=a.convert(Ve.type),$e=S(Ve.internalFormat,Le,We,Ve.encoding,V.isXRRenderTarget===!0),Xe=Ee(V);e.renderbufferStorageMultisample(36161,Xe,$e,V.width,V.height),e.framebufferRenderbuffer(36160,36064+de,36161,ae.__webglColorRenderbuffer[de])}e.bindRenderbuffer(36161,null),V.depthBuffer&&(ae.__webglDepthRenderbuffer=e.createRenderbuffer(),ce(ae.__webglDepthRenderbuffer,V,!0)),i.bindFramebuffer(36160,null)}}if(R){i.bindTexture(34067,Se.__webglTexture),Q(34067,B,Ue);for(let Ie=0;Ie<6;Ie++)ne(ae.__webglFramebuffer[Ie],V,B,36064,34069+Ie);b(B,Ue)&&A(34067),i.unbindTexture()}else if(Ce){let Ie=V.texture;for(let de=0,Ve=Ie.length;de<Ve;de++){let Le=Ie[de],We=r.get(Le);i.bindTexture(3553,We.__webglTexture),Q(3553,Le,Ue),ne(ae.__webglFramebuffer,V,Le,36064+de,3553),b(Le,Ue)&&A(3553)}i.unbindTexture()}else{let Ie=3553;(V.isWebGL3DRenderTarget||V.isWebGLArrayRenderTarget)&&(o&&(Ie=V.isWebGL3DRenderTarget?32879:35866)),i.bindTexture(Ie,Se.__webglTexture),Q(Ie,B,Ue),ne(ae.__webglFramebuffer,V,B,36064,Ie),b(B,Ue)&&A(Ie),i.unbindTexture()}V.depthBuffer&&xe(V)}function Ne(V){let B=w(V)||o,ae=V.isWebGLMultipleRenderTargets===!0?V.texture:[V.texture];for(let Se=0,R=ae.length;Se<R;Se++){let Ce=ae[Se];if(b(Ce,B)){let Ue=V.isWebGLCubeRenderTarget?34067:3553,Ie=r.get(Ce).__webglTexture;i.bindTexture(Ue,Ie),A(Ue),i.unbindTexture()}}}function Fe(V){if(o&&V.samples>0&&Me(V)===!1){let B=V.isWebGLMultipleRenderTargets?V.texture:[V.texture],ae=V.width,Se=V.height,R=16384,Ce=[],Ue=V.stencilBuffer?33306:36096,Ie=r.get(V),de=V.isWebGLMultipleRenderTargets===!0;if(de)for(let Ve=0;Ve<B.length;Ve++)i.bindFramebuffer(36160,Ie.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+Ve,36161,null),i.bindFramebuffer(36160,Ie.__webglFramebuffer),e.framebufferTexture2D(36009,36064+Ve,3553,null,0);i.bindFramebuffer(36008,Ie.__webglMultisampledFramebuffer),i.bindFramebuffer(36009,Ie.__webglFramebuffer);for(let Ve=0;Ve<B.length;Ve++){Ce.push(36064+Ve),V.depthBuffer&&Ce.push(Ue);let Le=Ie.__ignoreDepthValues!==void 0?Ie.__ignoreDepthValues:!1;if(Le===!1&&(V.depthBuffer&&(R|=256),V.stencilBuffer&&(R|=1024)),de&&e.framebufferRenderbuffer(36008,36064,36161,Ie.__webglColorRenderbuffer[Ve]),Le===!0&&(e.invalidateFramebuffer(36008,[Ue]),e.invalidateFramebuffer(36009,[Ue])),de){let We=r.get(B[Ve]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,We,0)}e.blitFramebuffer(0,0,ae,Se,0,0,ae,Se,R,9728),p&&e.invalidateFramebuffer(36008,Ce)}if(i.bindFramebuffer(36008,null),i.bindFramebuffer(36009,null),de)for(let Ve=0;Ve<B.length;Ve++){i.bindFramebuffer(36160,Ie.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+Ve,36161,Ie.__webglColorRenderbuffer[Ve]);let Le=r.get(B[Ve]).__webglTexture;i.bindFramebuffer(36160,Ie.__webglFramebuffer),e.framebufferTexture2D(36009,36064+Ve,3553,Le,0)}i.bindFramebuffer(36009,Ie.__webglMultisampledFramebuffer)}}function Ee(V){return Math.min(d,V.samples)}function Me(V){let B=r.get(V);return o&&V.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&B.__useRenderToTexture!==!1}function Ye(V){let B=n.render.frame;f.get(V)!==B&&(f.set(V,B),V.update())}function He(V,B){let ae=V.encoding,Se=V.format,R=V.type;return V.isCompressedTexture===!0||V.isVideoTexture===!0||V.format===t3||ae!==Rr&&(ae===ft&&o===!1&&(t.has("EXT_sRGB")===!0&&Se===Wi?(V.format=t3,V.minFilter=gt,V.generateMipmaps=!1):B=cv.sRGBToLinear(B))),B}this.allocateTextureUnit=F,this.resetTextureUnits=U,this.setTexture2D=W,this.setTexture2DArray=G,this.setTexture3D=X,this.setTextureCube=ee,this.rebindTextures=Re,this.setupRenderTarget=Ae,this.updateRenderTargetMipmap=Ne,this.updateMultisampleRenderTarget=Fe,this.setupDepthRenderbuffer=xe,this.setupFrameBufferTexture=ne,this.useMultisampledRTT=Me}function gT(e,t,i){let r=i.isWebGL2;function s(a,n=null){let o;if(a===y1)return 5121;if(a===JS)return 32819;if(a===$S)return 32820;if(a===QS)return 5120;if(a===ZS)return 5122;if(a===iv)return 5123;if(a===KS)return 5124;if(a===Hs)return 5125;if(a===_i)return 5126;if(a===Ks)return r?5131:(o=t.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(a===e_)return 6406;if(a===Wi)return 6408;if(a===t_)return 6409;if(a===i_)return 6410;if(a===Pn)return 6402;if(a===zn)return 34041;if(a===t3)return o=t.get("EXT_sRGB"),o!==null?o.SRGB_ALPHA_EXT:null;if(a===r_)return 6403;if(a===s_)return 36244;if(a===lc)return 33319;if(a===a_)return 33320;if(a===rv)return 36249;if(a===Wd||a===qd||a===Yd||a===Xd)if(n===ft)if(o=t.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(a===Wd)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(a===qd)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(a===Yd)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(a===Xd)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=t.get("WEBGL_compressed_texture_s3tc"),o!==null){if(a===Wd)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===qd)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===Yd)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===Xd)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(a===G5||a===H5||a===W5||a===q5)if(o=t.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(a===G5)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===H5)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===W5)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===q5)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(a===n_)return o=t.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(a===Y5||a===X5)if(o=t.get("WEBGL_compressed_texture_etc"),o!==null){if(a===Y5)return n===ft?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(a===X5)return n===ft?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(a===Q5||a===Z5||a===K5||a===J5||a===$5||a===em||a===tm||a===im||a===rm||a===sm||a===am||a===nm||a===om||a===lm)if(o=t.get("WEBGL_compressed_texture_astc"),o!==null){if(a===Q5)return n===ft?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(a===Z5)return n===ft?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(a===K5)return n===ft?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(a===J5)return n===ft?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(a===$5)return n===ft?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(a===em)return n===ft?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(a===tm)return n===ft?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(a===im)return n===ft?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(a===rm)return n===ft?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(a===sm)return n===ft?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(a===am)return n===ft?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(a===nm)return n===ft?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(a===om)return n===ft?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(a===lm)return n===ft?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(a===Qd)if(o=t.get("EXT_texture_compression_bptc"),o!==null){if(a===Qd)return n===ft?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(a===o_||a===hm||a===cm||a===dm)if(o=t.get("EXT_texture_compression_rgtc"),o!==null){if(a===Qd)return o.COMPRESSED_RED_RGTC1_EXT;if(a===hm)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(a===cm)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(a===dm)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return a===Tn?r?34042:(o=t.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):e[a]!==void 0?e[a]:null}return{convert:s}}var vT=class extends u1{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},qs=class extends kt{constructor(){super(),this.isGroup=!0,this.type="Group"}},yT={type:"move"},wu=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new qs,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new qs,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new E,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new E),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new qs,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new E,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new E),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,a=null,n=this._targetRay,o=this._grip,l=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(l&&e.hand){a=!0;for(let f of e.hand.values()){let g=t.getJointPose(f,i),m=this._getHandJoint(l,f);g!==null&&(m.matrix.fromArray(g.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.jointRadius=g.radius),m.visible=g!==null}let h=l.joints["index-finger-tip"],c=l.joints["thumb-tip"],d=h.position.distanceTo(c.position),u=.02,p=.005;l.inputState.pinching&&d>u+p?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&d<=u-p&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else o!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),s!==null&&(o.matrix.fromArray(s.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),s.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(s.linearVelocity)):o.hasLinearVelocity=!1,s.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(s.angularVelocity)):o.hasAngularVelocity=!1));n!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(n.matrix.fromArray(r.transform.matrix),n.matrix.decompose(n.position,n.rotation,n.scale),r.linearVelocity?(n.hasLinearVelocity=!0,n.linearVelocity.copy(r.linearVelocity)):n.hasLinearVelocity=!1,r.angularVelocity?(n.hasAngularVelocity=!0,n.angularVelocity.copy(r.angularVelocity)):n.hasAngularVelocity=!1,this.dispatchEvent(yT)))}return n!==null&&(n.visible=r!==null),o!==null&&(o.visible=s!==null),l!==null&&(l.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let i=new qs;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}},rl=class extends ai{constructor(e,t,i,r,s,a,n,o,l,h){if(h=h!==void 0?h:Pn,h!==Pn&&h!==zn)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&h===Pn&&(i=Hs),i===void 0&&h===zn&&(i=Tn),super(null,r,s,a,n,o,h,i,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=n!==void 0?n:Bt,this.minFilter=o!==void 0?o:Bt,this.flipY=!1,this.generateMipmaps=!1}},xT=class extends l1{constructor(e,t){super();let i=this,r=null,s=1,a=null,n="local-floor",o=1,l=null,h=null,c=null,d=null,u=null,p=null,f=t.getContextAttributes(),g=null,m=null,v=[],y=[],x=new Set,w=new Map,_=new u1;_.layers.enable(1),_.viewport=new ht;let b=new u1;b.layers.enable(2),b.viewport=new ht;let A=[_,b],S=new vT;S.layers.enable(1),S.layers.enable(2);let M=null,C=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(G){let X=v[G];return X===void 0&&(X=new wu,v[G]=X),X.getTargetRaySpace()},this.getControllerGrip=function(G){let X=v[G];return X===void 0&&(X=new wu,v[G]=X),X.getGripSpace()},this.getHand=function(G){let X=v[G];return X===void 0&&(X=new wu,v[G]=X),X.getHandSpace()};function T(G){let X=y.indexOf(G.inputSource);if(X===-1)return;let ee=v[X];ee!==void 0&&ee.dispatchEvent({type:G.type,data:G.inputSource})}function P(){r.removeEventListener("select",T),r.removeEventListener("selectstart",T),r.removeEventListener("selectend",T),r.removeEventListener("squeeze",T),r.removeEventListener("squeezestart",T),r.removeEventListener("squeezeend",T),r.removeEventListener("end",P),r.removeEventListener("inputsourceschange",I);for(let G=0;G<v.length;G++){let X=y[G];X!==null&&(y[G]=null,v[G].disconnect(X))}M=null,C=null,e.setRenderTarget(g),u=null,d=null,c=null,r=null,m=null,W.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(G){s=G,i.isPresenting},this.setReferenceSpaceType=function(G){n=G,i.isPresenting},this.getReferenceSpace=function(){return l||a},this.setReferenceSpace=function(G){l=G},this.getBaseLayer=function(){return d!==null?d:u},this.getBinding=function(){return c},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(G){if(r=G,r!==null){if(g=e.getRenderTarget(),r.addEventListener("select",T),r.addEventListener("selectstart",T),r.addEventListener("selectend",T),r.addEventListener("squeeze",T),r.addEventListener("squeezestart",T),r.addEventListener("squeezeend",T),r.addEventListener("end",P),r.addEventListener("inputsourceschange",I),f.xrCompatible!==!0&&await t.makeXRCompatible(),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let X={antialias:r.renderState.layers===void 0?f.antialias:!0,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:s};u=new XRWebGLLayer(r,t,X),r.updateRenderState({baseLayer:u}),m=new Rt(u.framebufferWidth,u.framebufferHeight,{format:Wi,type:y1,encoding:e.outputEncoding,stencilBuffer:f.stencil})}else{let X=null,ee=null,Y=null;f.depth&&(Y=f.stencil?35056:33190,X=f.stencil?zn:Pn,ee=f.stencil?Tn:Hs);let $={colorFormat:32856,depthFormat:Y,scaleFactor:s};c=new XRWebGLBinding(r,t),d=c.createProjectionLayer($),r.updateRenderState({layers:[d]}),m=new Rt(d.textureWidth,d.textureHeight,{format:Wi,type:y1,depthTexture:new rl(d.textureWidth,d.textureHeight,ee,void 0,void 0,void 0,void 0,void 0,void 0,X),stencilBuffer:f.stencil,encoding:e.outputEncoding,samples:f.antialias?4:0});let Q=e.properties.get(m);Q.__ignoreDepthValues=d.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(o),l=null,a=await r.requestReferenceSpace(n),W.setContext(r),W.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}};function I(G){for(let X=0;X<G.removed.length;X++){let ee=G.removed[X],Y=y.indexOf(ee);Y>=0&&(y[Y]=null,v[Y].disconnect(ee))}for(let X=0;X<G.added.length;X++){let ee=G.added[X],Y=y.indexOf(ee);if(Y===-1){for(let Q=0;Q<v.length;Q++)if(Q>=y.length){y.push(ee),Y=Q;break}else if(y[Q]===null){y[Q]=ee,Y=Q;break}if(Y===-1)break}let $=v[Y];$&&$.connect(ee)}}let D=new E,k=new E;function H(G,X,ee){D.setFromMatrixPosition(X.matrixWorld),k.setFromMatrixPosition(ee.matrixWorld);let Y=D.distanceTo(k),$=X.projectionMatrix.elements,Q=ee.projectionMatrix.elements,le=$[14]/($[10]-1),re=$[14]/($[10]+1),te=($[9]+1)/$[5],ne=($[9]-1)/$[5],ce=($[8]-1)/$[0],pe=(Q[8]+1)/Q[0],xe=le*ce,Re=le*pe,Ae=Y/(-ce+pe),Ne=Ae*-ce;X.matrixWorld.decompose(G.position,G.quaternion,G.scale),G.translateX(Ne),G.translateZ(Ae),G.matrixWorld.compose(G.position,G.quaternion,G.scale),G.matrixWorldInverse.copy(G.matrixWorld).invert();let Fe=le+Ae,Ee=re+Ae,Me=xe-Ne,Ye=Re+(Y-Ne),He=te*re/Ee*Fe,V=ne*re/Ee*Fe;G.projectionMatrix.makePerspective(Me,Ye,He,V,Fe,Ee)}function U(G,X){X===null?G.matrixWorld.copy(G.matrix):G.matrixWorld.multiplyMatrices(X.matrixWorld,G.matrix),G.matrixWorldInverse.copy(G.matrixWorld).invert()}this.updateCamera=function(G){if(r===null)return;S.near=b.near=_.near=G.near,S.far=b.far=_.far=G.far,(M!==S.near||C!==S.far)&&(r.updateRenderState({depthNear:S.near,depthFar:S.far}),M=S.near,C=S.far);let X=G.parent,ee=S.cameras;U(S,X);for(let $=0;$<ee.length;$++)U(ee[$],X);S.matrixWorld.decompose(S.position,S.quaternion,S.scale),G.matrix.copy(S.matrix),G.matrix.decompose(G.position,G.quaternion,G.scale);let Y=G.children;for(let $=0,Q=Y.length;$<Q;$++)Y[$].updateMatrixWorld(!0);ee.length===2?H(S,_,b):S.projectionMatrix.copy(_.projectionMatrix)},this.getCamera=function(){return S},this.getFoveation=function(){if(!(d===null&&u===null))return o},this.setFoveation=function(G){o=G,d!==null&&(d.fixedFoveation=G),u!==null&&u.fixedFoveation!==void 0&&(u.fixedFoveation=G)},this.getPlanes=function(){return x};let F=null;function Z(G,X){if(h=X.getViewerPose(l||a),p=X,h!==null){let ee=h.views;u!==null&&(e.setRenderTargetFramebuffer(m,u.framebuffer),e.setRenderTarget(m));let Y=!1;ee.length!==S.cameras.length&&(S.cameras.length=0,Y=!0);for(let $=0;$<ee.length;$++){let Q=ee[$],le=null;if(u!==null)le=u.getViewport(Q);else{let te=c.getViewSubImage(d,Q);le=te.viewport,$===0&&(e.setRenderTargetTextures(m,te.colorTexture,d.ignoreDepthValues?void 0:te.depthStencilTexture),e.setRenderTarget(m))}let re=A[$];re===void 0&&(re=new u1,re.layers.enable($),re.viewport=new ht,A[$]=re),re.matrix.fromArray(Q.transform.matrix),re.projectionMatrix.fromArray(Q.projectionMatrix),re.viewport.set(le.x,le.y,le.width,le.height),$===0&&S.matrix.copy(re.matrix),Y===!0&&S.cameras.push(re)}}for(let ee=0;ee<v.length;ee++){let Y=y[ee],$=v[ee];Y!==null&&$!==void 0&&$.update(Y,X,l||a)}if(F&&F(G,X),X.detectedPlanes){i.dispatchEvent({type:"planesdetected",data:X.detectedPlanes});let ee=null;for(let Y of x)X.detectedPlanes.has(Y)||(ee===null&&(ee=[]),ee.push(Y));if(ee!==null)for(let Y of ee)x.delete(Y),w.delete(Y),i.dispatchEvent({type:"planeremoved",data:Y});for(let Y of X.detectedPlanes)if(!x.has(Y))x.add(Y),w.set(Y,X.lastChangedTime),i.dispatchEvent({type:"planeadded",data:Y});else{let $=w.get(Y);Y.lastChangedTime>$&&(w.set(Y,Y.lastChangedTime),i.dispatchEvent({type:"planechanged",data:Y}))}}p=null}let W=new mv;W.setAnimationLoop(Z),this.setAnimationLoop=function(G){F=G},this.dispose=function(){}}};function bT(e,t){function i(g,m){m.color.getRGB(g.fogColor.value,fv(e)),m.isFog?(g.fogNear.value=m.near,g.fogFar.value=m.far):m.isFogExp2&&(g.fogDensity.value=m.density)}function r(g,m,v,y,x){m.isMeshBasicMaterial||m.isMeshLambertMaterial?s(g,m):m.isMeshToonMaterial?(s(g,m),c(g,m)):m.isMeshPhongMaterial?(s(g,m),h(g,m)):m.isMeshStandardMaterial?(s(g,m),d(g,m),m.isMeshPhysicalMaterial&&u(g,m,x)):m.isMeshMatcapMaterial?(s(g,m),p(g,m)):m.isMeshDepthMaterial?s(g,m):m.isMeshDistanceMaterial?(s(g,m),f(g,m)):m.isMeshNormalMaterial?s(g,m):m.isLineBasicMaterial?(a(g,m),m.isLineDashedMaterial&&n(g,m)):m.isPointsMaterial?o(g,m,v,y):m.isSpriteMaterial?l(g,m):m.isShadowMaterial?(g.color.value.copy(m.color),g.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}function s(g,m){g.opacity.value=m.opacity,m.color&&g.diffuse.value.copy(m.color),m.emissive&&g.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(g.map.value=m.map),m.alphaMap&&(g.alphaMap.value=m.alphaMap),m.bumpMap&&(g.bumpMap.value=m.bumpMap,g.bumpScale.value=m.bumpScale,m.side===Yi&&(g.bumpScale.value*=-1)),m.displacementMap&&(g.displacementMap.value=m.displacementMap,g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias),m.emissiveMap&&(g.emissiveMap.value=m.emissiveMap),m.normalMap&&(g.normalMap.value=m.normalMap,g.normalScale.value.copy(m.normalScale),m.side===Yi&&g.normalScale.value.negate()),m.specularMap&&(g.specularMap.value=m.specularMap),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);let v=t.get(m).envMap;if(v&&(g.envMap.value=v,g.flipEnvMap.value=v.isCubeTexture&&v.isRenderTargetTexture===!1?-1:1,g.reflectivity.value=m.reflectivity,g.ior.value=m.ior,g.refractionRatio.value=m.refractionRatio),m.lightMap){g.lightMap.value=m.lightMap;let w=e.physicallyCorrectLights!==!0?Math.PI:1;g.lightMapIntensity.value=m.lightMapIntensity*w}m.aoMap&&(g.aoMap.value=m.aoMap,g.aoMapIntensity.value=m.aoMapIntensity);let y;m.map?y=m.map:m.specularMap?y=m.specularMap:m.displacementMap?y=m.displacementMap:m.normalMap?y=m.normalMap:m.bumpMap?y=m.bumpMap:m.roughnessMap?y=m.roughnessMap:m.metalnessMap?y=m.metalnessMap:m.alphaMap?y=m.alphaMap:m.emissiveMap?y=m.emissiveMap:m.clearcoatMap?y=m.clearcoatMap:m.clearcoatNormalMap?y=m.clearcoatNormalMap:m.clearcoatRoughnessMap?y=m.clearcoatRoughnessMap:m.iridescenceMap?y=m.iridescenceMap:m.iridescenceThicknessMap?y=m.iridescenceThicknessMap:m.specularIntensityMap?y=m.specularIntensityMap:m.specularColorMap?y=m.specularColorMap:m.transmissionMap?y=m.transmissionMap:m.thicknessMap?y=m.thicknessMap:m.sheenColorMap?y=m.sheenColorMap:m.sheenRoughnessMap&&(y=m.sheenRoughnessMap),y!==void 0&&(y.isWebGLRenderTarget&&(y=y.texture),y.matrixAutoUpdate===!0&&y.updateMatrix(),g.uvTransform.value.copy(y.matrix));let x;m.aoMap?x=m.aoMap:m.lightMap&&(x=m.lightMap),x!==void 0&&(x.isWebGLRenderTarget&&(x=x.texture),x.matrixAutoUpdate===!0&&x.updateMatrix(),g.uv2Transform.value.copy(x.matrix))}function a(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity}function n(g,m){g.dashSize.value=m.dashSize,g.totalSize.value=m.dashSize+m.gapSize,g.scale.value=m.scale}function o(g,m,v,y){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.size.value=m.size*v,g.scale.value=y*.5,m.map&&(g.map.value=m.map),m.alphaMap&&(g.alphaMap.value=m.alphaMap),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);let x;m.map?x=m.map:m.alphaMap&&(x=m.alphaMap),x!==void 0&&(x.matrixAutoUpdate===!0&&x.updateMatrix(),g.uvTransform.value.copy(x.matrix))}function l(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.rotation.value=m.rotation,m.map&&(g.map.value=m.map),m.alphaMap&&(g.alphaMap.value=m.alphaMap),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);let v;m.map?v=m.map:m.alphaMap&&(v=m.alphaMap),v!==void 0&&(v.matrixAutoUpdate===!0&&v.updateMatrix(),g.uvTransform.value.copy(v.matrix))}function h(g,m){g.specular.value.copy(m.specular),g.shininess.value=Math.max(m.shininess,1e-4)}function c(g,m){m.gradientMap&&(g.gradientMap.value=m.gradientMap)}function d(g,m){g.roughness.value=m.roughness,g.metalness.value=m.metalness,m.roughnessMap&&(g.roughnessMap.value=m.roughnessMap),m.metalnessMap&&(g.metalnessMap.value=m.metalnessMap),t.get(m).envMap&&(g.envMapIntensity.value=m.envMapIntensity)}function u(g,m,v){g.ior.value=m.ior,m.sheen>0&&(g.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),g.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(g.sheenColorMap.value=m.sheenColorMap),m.sheenRoughnessMap&&(g.sheenRoughnessMap.value=m.sheenRoughnessMap)),m.clearcoat>0&&(g.clearcoat.value=m.clearcoat,g.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(g.clearcoatMap.value=m.clearcoatMap),m.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap),m.clearcoatNormalMap&&(g.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),g.clearcoatNormalMap.value=m.clearcoatNormalMap,m.side===Yi&&g.clearcoatNormalScale.value.negate())),m.iridescence>0&&(g.iridescence.value=m.iridescence,g.iridescenceIOR.value=m.iridescenceIOR,g.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(g.iridescenceMap.value=m.iridescenceMap),m.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=m.iridescenceThicknessMap)),m.transmission>0&&(g.transmission.value=m.transmission,g.transmissionSamplerMap.value=v.texture,g.transmissionSamplerSize.value.set(v.width,v.height),m.transmissionMap&&(g.transmissionMap.value=m.transmissionMap),g.thickness.value=m.thickness,m.thicknessMap&&(g.thicknessMap.value=m.thicknessMap),g.attenuationDistance.value=m.attenuationDistance,g.attenuationColor.value.copy(m.attenuationColor)),g.specularIntensity.value=m.specularIntensity,g.specularColor.value.copy(m.specularColor),m.specularIntensityMap&&(g.specularIntensityMap.value=m.specularIntensityMap),m.specularColorMap&&(g.specularColorMap.value=m.specularColorMap)}function p(g,m){m.matcap&&(g.matcap.value=m.matcap)}function f(g,m){g.referencePosition.value.copy(m.referencePosition),g.nearDistance.value=m.nearDistance,g.farDistance.value=m.farDistance}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function wT(e,t,i,r){let s={},a={},n=[],o=i.isWebGL2?e.getParameter(35375):0;function l(y,x){let w=x.program;r.uniformBlockBinding(y,w)}function h(y,x){let w=s[y.id];w===void 0&&(f(y),w=c(y),s[y.id]=w,y.addEventListener("dispose",m));let _=x.program;r.updateUBOMapping(y,_);let b=t.render.frame;a[y.id]!==b&&(u(y),a[y.id]=b)}function c(y){let x=d();y.__bindingPointIndex=x;let w=e.createBuffer(),_=y.__size,b=y.usage;return e.bindBuffer(35345,w),e.bufferData(35345,_,b),e.bindBuffer(35345,null),e.bindBufferBase(35345,x,w),w}function d(){for(let y=0;y<o;y++)if(n.indexOf(y)===-1)return n.push(y),y;return 0}function u(y){let x=s[y.id],w=y.uniforms,_=y.__cache;e.bindBuffer(35345,x);for(let b=0,A=w.length;b<A;b++){let S=w[b];if(p(S,b,_)===!0){let M=S.__offset,C=Array.isArray(S.value)?S.value:[S.value],T=0;for(let P=0;P<C.length;P++){let I=C[P],D=g(I);typeof I=="number"?(S.__data[0]=I,e.bufferSubData(35345,M+T,S.__data)):I.isMatrix3?(S.__data[0]=I.elements[0],S.__data[1]=I.elements[1],S.__data[2]=I.elements[2],S.__data[3]=I.elements[0],S.__data[4]=I.elements[3],S.__data[5]=I.elements[4],S.__data[6]=I.elements[5],S.__data[7]=I.elements[0],S.__data[8]=I.elements[6],S.__data[9]=I.elements[7],S.__data[10]=I.elements[8],S.__data[11]=I.elements[0]):(I.toArray(S.__data,T),T+=D.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(35345,M,S.__data)}}e.bindBuffer(35345,null)}function p(y,x,w){let _=y.value;if(w[x]===void 0){if(typeof _=="number")w[x]=_;else{let b=Array.isArray(_)?_:[_],A=[];for(let S=0;S<b.length;S++)A.push(b[S].clone());w[x]=A}return!0}else if(typeof _=="number"){if(w[x]!==_)return w[x]=_,!0}else{let b=Array.isArray(w[x])?w[x]:[w[x]],A=Array.isArray(_)?_:[_];for(let S=0;S<b.length;S++){let M=b[S];if(M.equals(A[S])===!1)return M.copy(A[S]),!0}}return!1}function f(y){let x=y.uniforms,w=0,_=16,b=0;for(let A=0,S=x.length;A<S;A++){let M=x[A],C={boundary:0,storage:0},T=Array.isArray(M.value)?M.value:[M.value];for(let P=0,I=T.length;P<I;P++){let D=T[P],k=g(D);C.boundary+=k.boundary,C.storage+=k.storage}if(M.__data=new Float32Array(C.storage/Float32Array.BYTES_PER_ELEMENT),M.__offset=w,A>0){b=w%_;let P=_-b;b!==0&&P-C.boundary<0&&(w+=_-b,M.__offset=w)}w+=C.storage}return b=w%_,b>0&&(w+=_-b),y.__size=w,y.__cache={},this}function g(y){let x={boundary:0,storage:0};return typeof y=="number"?(x.boundary=4,x.storage=4):y.isVector2?(x.boundary=8,x.storage=8):y.isVector3||y.isColor?(x.boundary=16,x.storage=12):y.isVector4?(x.boundary=16,x.storage=16):y.isMatrix3?(x.boundary=48,x.storage=48):y.isMatrix4?(x.boundary=64,x.storage=64):y.isTexture,x}function m(y){let x=y.target;x.removeEventListener("dispose",m);let w=n.indexOf(x.__bindingPointIndex);n.splice(w,1),e.deleteBuffer(s[x.id]),delete s[x.id],delete a[x.id]}function v(){for(let y in s)e.deleteBuffer(s[y]);n=[],s={},a={}}return{bind:l,update:h,dispose:v}}function ST(){let e=R2("canvas");return e.style.display="block",e}function wv(e={}){this.isWebGLRenderer=!0;let t=e.canvas!==void 0?e.canvas:ST(),i=e.context!==void 0?e.context:null,r=e.depth!==void 0?e.depth:!0,s=e.stencil!==void 0?e.stencil:!0,a=e.antialias!==void 0?e.antialias:!1,n=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,o=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,l=e.powerPreference!==void 0?e.powerPreference:"default",h=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,c;i!==null?c=i.getContextAttributes().alpha:c=e.alpha!==void 0?e.alpha:!1;let d=null,u=null,p=[],f=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Rr,this.physicallyCorrectLights=!1,this.toneMapping=os,this.toneMappingExposure=1;let g=this,m=!1,v=0,y=0,x=null,w=-1,_=null,b=new ht,A=new ht,S=null,M=t.width,C=t.height,T=1,P=null,I=null,D=new ht(0,0,M,C),k=new ht(0,0,M,C),H=!1,U=new r4,F=!1,Z=!1,W=null,G=new we,X=new j,ee=new E,Y={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function $(){return x===null?T:1}let Q=i;function le(N,oe){for(let me=0;me<N.length;me++){let se=N[me],ge=t.getContext(se,oe);if(ge!==null)return ge}return null}try{let N={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:n,preserveDrawingBuffer:o,powerPreference:l,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${gl}`),t.addEventListener("webglcontextlost",$e,!1),t.addEventListener("webglcontextrestored",Xe,!1),t.addEventListener("webglcontextcreationerror",Ze,!1),Q===null){let oe=["webgl2","webgl","experimental-webgl"];if(g.isWebGL1Renderer===!0&&oe.shift(),Q=le(oe,N),Q===null)throw le(oe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}Q.getShaderPrecisionFormat===void 0&&(Q.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(N){throw""+N.message,N}let re,te,ne,ce,pe,xe,Re,Ae,Ne,Fe,Ee,Me,Ye,He,V,B,ae,Se,R,Ce,Ue,Ie,de,Ve;function Le(){re=new BE(Q),te=new PE(Q,re,e),re.init(te),Ie=new gT(Q,re,te),ne=new fT(Q,re,te),ce=new kE,pe=new tT,xe=new mT(Q,re,ne,pe,te,Ie,ce),Re=new IE(g),Ae=new LE(g),Ne=new Y_(Q,te),de=new CE(Q,re,Ne,te),Fe=new zE(Q,Ne,ce,de),Ee=new jE(Q,Fe,Ne,ce),R=new VE(Q,te,xe),B=new DE(pe),Me=new eT(g,Re,Ae,re,te,de,B),Ye=new bT(g,pe),He=new rT,V=new hT(re,te),Se=new EE(g,Re,Ae,ne,Ee,c,n),ae=new pT(g,Ee,te),Ve=new wT(Q,ce,te,ne),Ce=new TE(Q,re,ce,te),Ue=new FE(Q,re,ce,te),ce.programs=Me.programs,g.capabilities=te,g.extensions=re,g.properties=pe,g.renderLists=He,g.shadowMap=ae,g.state=ne,g.info=ce}Le();let We=new xT(g,Q);this.xr=We,this.getContext=function(){return Q},this.getContextAttributes=function(){return Q.getContextAttributes()},this.forceContextLoss=function(){let N=re.get("WEBGL_lose_context");N&&N.loseContext()},this.forceContextRestore=function(){let N=re.get("WEBGL_lose_context");N&&N.restoreContext()},this.getPixelRatio=function(){return T},this.setPixelRatio=function(N){N!==void 0&&(T=N,this.setSize(M,C,!1))},this.getSize=function(N){return N.set(M,C)},this.setSize=function(N,oe,me){We.isPresenting||(M=N,C=oe,t.width=Math.floor(N*T),t.height=Math.floor(oe*T),me!==!1&&(t.style.width=N+"px",t.style.height=oe+"px"),this.setViewport(0,0,N,oe))},this.getDrawingBufferSize=function(N){return N.set(M*T,C*T).floor()},this.setDrawingBufferSize=function(N,oe,me){M=N,C=oe,T=me,t.width=Math.floor(N*me),t.height=Math.floor(oe*me),this.setViewport(0,0,N,oe)},this.getCurrentViewport=function(N){return N.copy(b)},this.getViewport=function(N){return N.copy(D)},this.setViewport=function(N,oe,me,se){N.isVector4?D.set(N.x,N.y,N.z,N.w):D.set(N,oe,me,se),ne.viewport(b.copy(D).multiplyScalar(T).floor())},this.getScissor=function(N){return N.copy(k)},this.setScissor=function(N,oe,me,se){N.isVector4?k.set(N.x,N.y,N.z,N.w):k.set(N,oe,me,se),ne.scissor(A.copy(k).multiplyScalar(T).floor())},this.getScissorTest=function(){return H},this.setScissorTest=function(N){ne.setScissorTest(H=N)},this.setOpaqueSort=function(N){P=N},this.setTransparentSort=function(N){I=N},this.getClearColor=function(N){return N.copy(Se.getClearColor())},this.setClearColor=function(){Se.setClearColor.apply(Se,arguments)},this.getClearAlpha=function(){return Se.getClearAlpha()},this.setClearAlpha=function(){Se.setClearAlpha.apply(Se,arguments)},this.clear=function(N=!0,oe=!0,me=!0){let se=0;N&&(se|=16384),oe&&(se|=256),me&&(se|=1024),Q.clear(se)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",$e,!1),t.removeEventListener("webglcontextrestored",Xe,!1),t.removeEventListener("webglcontextcreationerror",Ze,!1),He.dispose(),V.dispose(),pe.dispose(),Re.dispose(),Ae.dispose(),Ee.dispose(),de.dispose(),Ve.dispose(),Me.dispose(),We.dispose(),We.removeEventListener("sessionstart",Be),We.removeEventListener("sessionend",rt),W&&(W.dispose(),W=null),At.stop()};function $e(N){N.preventDefault(),m=!0}function Xe(){m=!1;let N=ce.autoReset,oe=ae.enabled,me=ae.autoUpdate,se=ae.needsUpdate,ge=ae.type;Le(),ce.autoReset=N,ae.enabled=oe,ae.autoUpdate=me,ae.needsUpdate=se,ae.type=ge}function Ze(N){N.statusMessage}function Ht(N){let oe=N.target;oe.removeEventListener("dispose",Ht),ti(oe)}function ti(N){K(N),pe.remove(N)}function K(N){let oe=pe.get(N).programs;oe!==void 0&&(oe.forEach(function(me){Me.releaseProgram(me)}),N.isShaderMaterial&&Me.releaseShaderCache(N))}this.renderBufferDirect=function(N,oe,me,se,ge,qe){oe===null&&(oe=Y);let ut=ge.isMesh&&ge.matrixWorld.determinant()<0,vt=Ud(N,oe,me,se,ge);ne.setMaterial(se,ut);let st=me.index,zt=1;se.wireframe===!0&&(st=Fe.getWireframeAttribute(me),zt=2);let wt=me.drawRange,Mt=me.attributes.position,yt=wt.start*zt,h1=(wt.start+wt.count)*zt;qe!==null&&(yt=Math.max(yt,qe.start*zt),h1=Math.min(h1,(qe.start+qe.count)*zt)),st!==null?(yt=Math.max(yt,0),h1=Math.min(h1,st.count)):Mt!=null&&(yt=Math.max(yt,0),h1=Math.min(h1,Mt.count));let X1=h1-yt;if(X1<0||X1===1/0)return;de.setup(ge,se,vt,me,st);let ys,ii=Ce;if(st!==null&&(ys=Ne.get(st),ii=Ue,ii.setIndex(ys)),ge.isMesh)se.wireframe===!0?(ne.setLineWidth(se.wireframeLinewidth*$()),ii.setMode(1)):ii.setMode(4);else if(ge.isLine){let St=se.linewidth;St===void 0&&(St=1),ne.setLineWidth(St*$()),ge.isLineSegments?ii.setMode(1):ge.isLineLoop?ii.setMode(2):ii.setMode(3)}else ge.isPoints?ii.setMode(0):ge.isSprite&&ii.setMode(4);if(ge.isInstancedMesh)ii.renderInstances(yt,X1,ge.count);else if(me.isInstancedBufferGeometry){let St=me._maxInstanceCount!==void 0?me._maxInstanceCount:1/0,fr=Math.min(me.instanceCount,St);ii.renderInstances(yt,X1,fr)}else ii.render(yt,X1)},this.compile=function(N,oe){function me(se,ge,qe){se.transparent===!0&&se.side===f1&&se.forceSinglePass===!1?(se.side=Yi,se.needsUpdate=!0,O1(se,ge,qe),se.side=Or,se.needsUpdate=!0,O1(se,ge,qe),se.side=f1):O1(se,ge,qe)}u=V.get(N),u.init(),f.push(u),N.traverseVisible(function(se){se.isLight&&se.layers.test(oe.layers)&&(u.pushLight(se),se.castShadow&&u.pushShadow(se))}),u.setupLights(g.physicallyCorrectLights),N.traverse(function(se){let ge=se.material;if(ge)if(Array.isArray(ge))for(let qe=0;qe<ge.length;qe++){let ut=ge[qe];me(ut,N,se)}else me(ge,N,se)}),f.pop(),u=null};let fe=null;function be(N){fe&&fe(N)}function Be(){At.stop()}function rt(){At.start()}let At=new mv;At.setAnimationLoop(be),typeof self<"u"&&At.setContext(self),this.setAnimationLoop=function(N){fe=N,We.setAnimationLoop(N),N===null?At.stop():At.start()},We.addEventListener("sessionstart",Be),We.addEventListener("sessionend",rt),this.render=function(N,oe){if(oe!==void 0&&oe.isCamera!==!0||m===!0)return;N.matrixWorldAutoUpdate===!0&&N.updateMatrixWorld(),oe.parent===null&&oe.matrixWorldAutoUpdate===!0&&oe.updateMatrixWorld(),We.enabled===!0&&We.isPresenting===!0&&(We.cameraAutoUpdate===!0&&We.updateCamera(oe),oe=We.getCamera()),N.isScene===!0&&N.onBeforeRender(g,N,oe,x),u=V.get(N,f.length),u.init(),f.push(u),G.multiplyMatrices(oe.projectionMatrix,oe.matrixWorldInverse),U.setFromProjectionMatrix(G),Z=this.localClippingEnabled,F=B.init(this.clippingPlanes,Z),d=He.get(N,p.length),d.init(),p.push(d),di(N,oe,0,g.sortObjects),d.finish(),g.sortObjects===!0&&d.sort(P,I),F===!0&&B.beginShadows();let me=u.state.shadowsArray;if(ae.render(me,N,oe),F===!0&&B.endShadows(),this.info.autoReset===!0&&this.info.reset(),Se.render(d,N),u.setupLights(g.physicallyCorrectLights),oe.isArrayCamera){let se=oe.cameras;for(let ge=0,qe=se.length;ge<qe;ge++){let ut=se[ge];ki(d,N,ut,ut.viewport)}}else ki(d,N,oe);x!==null&&(xe.updateMultisampleRenderTarget(x),xe.updateRenderTargetMipmap(x)),N.isScene===!0&&N.onAfterRender(g,N,oe),de.resetDefaultState(),w=-1,_=null,f.pop(),f.length>0?u=f[f.length-1]:u=null,p.pop(),p.length>0?d=p[p.length-1]:d=null};function di(N,oe,me,se){if(N.visible===!1)return;if(N.layers.test(oe.layers)){if(N.isGroup)me=N.renderOrder;else if(N.isLOD)N.autoUpdate===!0&&N.update(oe);else if(N.isLight)u.pushLight(N),N.castShadow&&u.pushShadow(N);else if(N.isSprite){if(!N.frustumCulled||U.intersectsSprite(N)){se&&ee.setFromMatrixPosition(N.matrixWorld).applyMatrix4(G);let qe=Ee.update(N),ut=N.material;ut.visible&&d.push(N,qe,ut,me,ee.z,null)}}else if((N.isMesh||N.isLine||N.isPoints)&&(N.isSkinnedMesh&&N.skeleton.frame!==ce.render.frame&&(N.skeleton.update(),N.skeleton.frame=ce.render.frame),!N.frustumCulled||U.intersectsObject(N))){se&&ee.setFromMatrixPosition(N.matrixWorld).applyMatrix4(G);let qe=Ee.update(N),ut=N.material;if(Array.isArray(ut)){let vt=qe.groups;for(let st=0,zt=vt.length;st<zt;st++){let wt=vt[st],Mt=ut[wt.materialIndex];Mt&&Mt.visible&&d.push(N,qe,Mt,me,ee.z,wt)}}else ut.visible&&d.push(N,qe,ut,me,ee.z,null)}}let ge=N.children;for(let qe=0,ut=ge.length;qe<ut;qe++)di(ge[qe],oe,me,se)}function ki(N,oe,me,se){let ge=N.opaque,qe=N.transmissive,ut=N.transparent;u.setupLightsView(me),F===!0&&B.setGlobalState(g.clippingPlanes,me),qe.length>0&&kr(ge,oe,me),se&&ne.viewport(b.copy(se)),ge.length>0&&Qt(ge,oe,me),qe.length>0&&Qt(qe,oe,me),ut.length>0&&Qt(ut,oe,me),ne.buffers.depth.setTest(!0),ne.buffers.depth.setMask(!0),ne.buffers.color.setMask(!0),ne.setPolygonOffset(!1)}function kr(N,oe,me){let se=te.isWebGL2;W===null&&(W=new Rt(1,1,{generateMipmaps:!0,type:re.has("EXT_color_buffer_half_float")?Ks:y1,minFilter:tl,samples:se&&a===!0?4:0})),g.getDrawingBufferSize(X),se?W.setSize(X.x,X.y):W.setSize(pc(X.x),pc(X.y));let ge=g.getRenderTarget();g.setRenderTarget(W),g.clear();let qe=g.toneMapping;g.toneMapping=os,Qt(N,oe,me),g.toneMapping=qe,xe.updateMultisampleRenderTarget(W),xe.updateRenderTargetMipmap(W),g.setRenderTarget(ge)}function Qt(N,oe,me){let se=oe.isScene===!0?oe.overrideMaterial:null;for(let ge=0,qe=N.length;ge<qe;ge++){let ut=N[ge],vt=ut.object,st=ut.geometry,zt=se===null?ut.material:se,wt=ut.group;vt.layers.test(me.layers)&&pr(vt,oe,me,st,zt,wt)}}function pr(N,oe,me,se,ge,qe){N.onBeforeRender(g,oe,me,se,ge,qe),N.modelViewMatrix.multiplyMatrices(me.matrixWorldInverse,N.matrixWorld),N.normalMatrix.getNormalMatrix(N.modelViewMatrix),ge.onBeforeRender(g,oe,me,se,N,qe),ge.transparent===!0&&ge.side===f1&&ge.forceSinglePass===!1?(ge.side=Yi,ge.needsUpdate=!0,g.renderBufferDirect(me,oe,se,ge,N,qe),ge.side=Or,ge.needsUpdate=!0,g.renderBufferDirect(me,oe,se,ge,N,qe),ge.side=f1):g.renderBufferDirect(me,oe,se,ge,N,qe),N.onAfterRender(g,oe,me,se,ge,qe)}function O1(N,oe,me){oe.isScene!==!0&&(oe=Y);let se=pe.get(N),ge=u.state.lights,qe=u.state.shadowsArray,ut=ge.state.version,vt=Me.getParameters(N,ge.state,qe,oe,me),st=Me.getProgramCacheKey(vt),zt=se.programs;se.environment=N.isMeshStandardMaterial?oe.environment:null,se.fog=oe.fog,se.envMap=(N.isMeshStandardMaterial?Ae:Re).get(N.envMap||se.environment),zt===void 0&&(N.addEventListener("dispose",Ht),zt=new Map,se.programs=zt);let wt=zt.get(st);if(wt!==void 0){if(se.currentProgram===wt&&se.lightsStateVersion===ut)return Yn(N,vt),wt}else vt.uniforms=Me.getUniforms(N),N.onBuild(me,vt,g),N.onBeforeCompile(vt,g),wt=Me.acquireProgram(vt,st),zt.set(st,wt),se.uniforms=vt.uniforms;let Mt=se.uniforms;(!N.isShaderMaterial&&!N.isRawShaderMaterial||N.clipping===!0)&&(Mt.clippingPlanes=B.uniform),Yn(N,vt),se.needsLights=Rl(N),se.lightsStateVersion=ut,se.needsLights&&(Mt.ambientLightColor.value=ge.state.ambient,Mt.lightProbe.value=ge.state.probe,Mt.directionalLights.value=ge.state.directional,Mt.directionalLightShadows.value=ge.state.directionalShadow,Mt.spotLights.value=ge.state.spot,Mt.spotLightShadows.value=ge.state.spotShadow,Mt.rectAreaLights.value=ge.state.rectArea,Mt.ltc_1.value=ge.state.rectAreaLTC1,Mt.ltc_2.value=ge.state.rectAreaLTC2,Mt.pointLights.value=ge.state.point,Mt.pointLightShadows.value=ge.state.pointShadow,Mt.hemisphereLights.value=ge.state.hemi,Mt.directionalShadowMap.value=ge.state.directionalShadowMap,Mt.directionalShadowMatrix.value=ge.state.directionalShadowMatrix,Mt.spotShadowMap.value=ge.state.spotShadowMap,Mt.spotLightMatrix.value=ge.state.spotLightMatrix,Mt.spotLightMap.value=ge.state.spotLightMap,Mt.pointShadowMap.value=ge.state.pointShadowMap,Mt.pointShadowMatrix.value=ge.state.pointShadowMatrix);let yt=wt.getUniforms(),h1=W0.seqWithValue(yt.seq,Mt);return se.currentProgram=wt,se.uniformsList=h1,wt}function Yn(N,oe){let me=pe.get(N);me.outputEncoding=oe.outputEncoding,me.instancing=oe.instancing,me.skinning=oe.skinning,me.morphTargets=oe.morphTargets,me.morphNormals=oe.morphNormals,me.morphColors=oe.morphColors,me.morphTargetsCount=oe.morphTargetsCount,me.numClippingPlanes=oe.numClippingPlanes,me.numIntersection=oe.numClipIntersection,me.vertexAlphas=oe.vertexAlphas,me.vertexTangents=oe.vertexTangents,me.toneMapping=oe.toneMapping}function Ud(N,oe,me,se,ge){oe.isScene!==!0&&(oe=Y),xe.resetTextureUnits();let qe=oe.fog,ut=se.isMeshStandardMaterial?oe.environment:null,vt=x===null?g.outputEncoding:x.isXRRenderTarget===!0?x.texture.encoding:Rr,st=(se.isMeshStandardMaterial?Ae:Re).get(se.envMap||ut),zt=se.vertexColors===!0&&!!me.attributes.color&&me.attributes.color.itemSize===4,wt=!!se.normalMap&&!!me.attributes.tangent,Mt=!!me.morphAttributes.position,yt=!!me.morphAttributes.normal,h1=!!me.morphAttributes.color,X1=se.toneMapped?g.toneMapping:os,ys=me.morphAttributes.position||me.morphAttributes.normal||me.morphAttributes.color,ii=ys!==void 0?ys.length:0,St=pe.get(se),fr=u.state.lights;if(F===!0&&(Z===!0||N!==_)){let z=N===_&&se.id===w;B.setState(se,N,z)}let xt=!1;se.version===St.__version?(St.needsLights&&St.lightsStateVersion!==fr.state.version||St.outputEncoding!==vt||ge.isInstancedMesh&&St.instancing===!1||!ge.isInstancedMesh&&St.instancing===!0||ge.isSkinnedMesh&&St.skinning===!1||!ge.isSkinnedMesh&&St.skinning===!0||St.envMap!==st||se.fog===!0&&St.fog!==qe||St.numClippingPlanes!==void 0&&(St.numClippingPlanes!==B.numPlanes||St.numIntersection!==B.numIntersection)||St.vertexAlphas!==zt||St.vertexTangents!==wt||St.morphTargets!==Mt||St.morphNormals!==yt||St.morphColors!==h1||St.toneMapping!==X1||te.isWebGL2===!0&&St.morphTargetsCount!==ii)&&(xt=!0):(xt=!0,St.__version=se.version);let xs=St.currentProgram;xt===!0&&(xs=O1(se,oe,ge));let Za=!1,la=!1,Ur=!1,O=xs.getUniforms(),L=St.uniforms;if(ne.useProgram(xs.program)&&(Za=!0,la=!0,Ur=!0),se.id!==w&&(w=se.id,la=!0),Za||_!==N){if(O.setValue(Q,"projectionMatrix",N.projectionMatrix),te.logarithmicDepthBuffer&&O.setValue(Q,"logDepthBufFC",2/(Math.log(N.far+1)/Math.LN2)),_!==N&&(_=N,la=!0,Ur=!0),se.isShaderMaterial||se.isMeshPhongMaterial||se.isMeshToonMaterial||se.isMeshStandardMaterial||se.envMap){let z=O.map.cameraPosition;z!==void 0&&z.setValue(Q,ee.setFromMatrixPosition(N.matrixWorld))}(se.isMeshPhongMaterial||se.isMeshToonMaterial||se.isMeshLambertMaterial||se.isMeshBasicMaterial||se.isMeshStandardMaterial||se.isShaderMaterial)&&O.setValue(Q,"isOrthographic",N.isOrthographicCamera===!0),(se.isMeshPhongMaterial||se.isMeshToonMaterial||se.isMeshLambertMaterial||se.isMeshBasicMaterial||se.isMeshStandardMaterial||se.isShaderMaterial||se.isShadowMaterial||ge.isSkinnedMesh)&&O.setValue(Q,"viewMatrix",N.matrixWorldInverse)}if(ge.isSkinnedMesh){O.setOptional(Q,ge,"bindMatrix"),O.setOptional(Q,ge,"bindMatrixInverse");let z=ge.skeleton;z&&(te.floatVertexTextures&&(z.boneTexture===null&&z.computeBoneTexture(),O.setValue(Q,"boneTexture",z.boneTexture,xe),O.setValue(Q,"boneTextureSize",z.boneTextureSize)))}let q=me.morphAttributes;if((q.position!==void 0||q.normal!==void 0||q.color!==void 0&&te.isWebGL2===!0)&&R.update(ge,me,se,xs),(la||St.receiveShadow!==ge.receiveShadow)&&(St.receiveShadow=ge.receiveShadow,O.setValue(Q,"receiveShadow",ge.receiveShadow)),se.isMeshGouraudMaterial&&se.envMap!==null&&(L.envMap.value=st,L.flipEnvMap.value=st.isCubeTexture&&st.isRenderTargetTexture===!1?-1:1),la&&(O.setValue(Q,"toneMappingExposure",g.toneMappingExposure),St.needsLights&&Nd(L,Ur),qe&&se.fog===!0&&Ye.refreshFogUniforms(L,qe),Ye.refreshMaterialUniforms(L,se,T,C,W),W0.upload(Q,St.uniformsList,L,xe)),se.isShaderMaterial&&se.uniformsNeedUpdate===!0&&(W0.upload(Q,St.uniformsList,L,xe),se.uniformsNeedUpdate=!1),se.isSpriteMaterial&&O.setValue(Q,"center",ge.center),O.setValue(Q,"modelViewMatrix",ge.modelViewMatrix),O.setValue(Q,"normalMatrix",ge.normalMatrix),O.setValue(Q,"modelMatrix",ge.matrixWorld),ge.previousModelViewMatrix&&O.setValue(Q,"previousModelViewMatrix",ge.previousModelViewMatrix),N.previousProjectionMatrix&&O.setValue(Q,"previousProjectionMatrix",N.previousProjectionMatrix),se.isShaderMaterial||se.isRawShaderMaterial){let z=se.uniformsGroups;for(let J=0,_e=z.length;J<_e;J++)if(te.isWebGL2){let bs=z[J];Ve.update(bs,xs),Ve.bind(bs,xs)}}return xs}function Nd(N,oe){N.ambientLightColor.needsUpdate=oe,N.lightProbe.needsUpdate=oe,N.directionalLights.needsUpdate=oe,N.directionalLightShadows.needsUpdate=oe,N.pointLights.needsUpdate=oe,N.pointLightShadows.needsUpdate=oe,N.spotLights.needsUpdate=oe,N.spotLightShadows.needsUpdate=oe,N.rectAreaLights.needsUpdate=oe,N.hemisphereLights.needsUpdate=oe}function Rl(N){return N.isMeshLambertMaterial||N.isMeshToonMaterial||N.isMeshPhongMaterial||N.isMeshStandardMaterial||N.isShadowMaterial||N.isShaderMaterial&&N.lights===!0}this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return x},this.setRenderTargetTextures=function(N,oe,me){pe.get(N.texture).__webglTexture=oe,pe.get(N.depthTexture).__webglTexture=me;let se=pe.get(N);se.__hasExternalTextures=!0,se.__hasExternalTextures&&(se.__autoAllocateDepthBuffer=me===void 0,se.__autoAllocateDepthBuffer||re.has("WEBGL_multisampled_render_to_texture")===!0&&(se.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(N,oe){let me=pe.get(N);me.__webglFramebuffer=oe,me.__useDefaultFramebuffer=oe===void 0},this.setRenderTarget=function(N,oe=0,me=0){x=N,v=oe,y=me;let se=!0,ge=null,qe=!1,ut=!1;if(N){let vt=pe.get(N);vt.__useDefaultFramebuffer!==void 0?(ne.bindFramebuffer(36160,null),se=!1):vt.__webglFramebuffer===void 0?xe.setupRenderTarget(N):vt.__hasExternalTextures&&xe.rebindTextures(N,pe.get(N.texture).__webglTexture,pe.get(N.depthTexture).__webglTexture);let st=N.texture;(st.isData3DTexture||st.isDataArrayTexture||st.isCompressedArrayTexture)&&(ut=!0);let zt=pe.get(N).__webglFramebuffer;N.isWebGLCubeRenderTarget?(ge=zt[oe],qe=!0):te.isWebGL2&&N.samples>0&&xe.useMultisampledRTT(N)===!1?ge=pe.get(N).__webglMultisampledFramebuffer:ge=zt,b.copy(N.viewport),A.copy(N.scissor),S=N.scissorTest}else b.copy(D).multiplyScalar(T).floor(),A.copy(k).multiplyScalar(T).floor(),S=H;if(ne.bindFramebuffer(36160,ge)&&te.drawBuffers&&se&&ne.drawBuffers(N,ge),ne.viewport(b),ne.scissor(A),ne.setScissorTest(S),qe){let vt=pe.get(N.texture);Q.framebufferTexture2D(36160,36064,34069+oe,vt.__webglTexture,me)}else if(ut){let vt=pe.get(N.texture),st=oe||0;Q.framebufferTextureLayer(36160,36064,vt.__webglTexture,me||0,st)}w=-1},this.readRenderTargetPixels=function(N,oe,me,se,ge,qe,ut){if(!(N&&N.isWebGLRenderTarget))return;let vt=pe.get(N).__webglFramebuffer;if(N.isWebGLCubeRenderTarget&&ut!==void 0&&(vt=vt[ut]),vt){ne.bindFramebuffer(36160,vt);try{let st=N.texture,zt=st.format,wt=st.type;if(zt!==Wi&&Ie.convert(zt)!==Q.getParameter(35739))return;let Mt=wt===Ks&&(re.has("EXT_color_buffer_half_float")||te.isWebGL2&&re.has("EXT_color_buffer_float"));if(wt!==y1&&Ie.convert(wt)!==Q.getParameter(35738)&&!(wt===_i&&(te.isWebGL2||re.has("OES_texture_float")||re.has("WEBGL_color_buffer_float")))&&!Mt)return;oe>=0&&oe<=N.width-se&&me>=0&&me<=N.height-ge&&Q.readPixels(oe,me,se,ge,Ie.convert(zt),Ie.convert(wt),qe)}finally{let st=x!==null?pe.get(x).__webglFramebuffer:null;ne.bindFramebuffer(36160,st)}}},this.copyFramebufferToTexture=function(N,oe,me=0){let se=Math.pow(2,-me),ge=Math.floor(oe.image.width*se),qe=Math.floor(oe.image.height*se);xe.setTexture2D(oe,0),Q.copyTexSubImage2D(3553,me,0,0,N.x,N.y,ge,qe),ne.unbindTexture()},this.copyTextureToTexture=function(N,oe,me,se=0){let ge=oe.image.width,qe=oe.image.height,ut=Ie.convert(me.format),vt=Ie.convert(me.type);xe.setTexture2D(me,0),Q.pixelStorei(37440,me.flipY),Q.pixelStorei(37441,me.premultiplyAlpha),Q.pixelStorei(3317,me.unpackAlignment),oe.isDataTexture?Q.texSubImage2D(3553,se,N.x,N.y,ge,qe,ut,vt,oe.image.data):oe.isCompressedTexture?Q.compressedTexSubImage2D(3553,se,N.x,N.y,oe.mipmaps[0].width,oe.mipmaps[0].height,ut,oe.mipmaps[0].data):Q.texSubImage2D(3553,se,N.x,N.y,ut,vt,oe.image),se===0&&me.generateMipmaps&&Q.generateMipmap(3553),ne.unbindTexture()},this.copyTextureToTexture3D=function(N,oe,me,se,ge=0){if(g.isWebGL1Renderer)return;let qe=N.max.x-N.min.x+1,ut=N.max.y-N.min.y+1,vt=N.max.z-N.min.z+1,st=Ie.convert(se.format),zt=Ie.convert(se.type),wt;if(se.isData3DTexture)xe.setTexture3D(se,0),wt=32879;else if(se.isDataArrayTexture)xe.setTexture2DArray(se,0),wt=35866;else return;Q.pixelStorei(37440,se.flipY),Q.pixelStorei(37441,se.premultiplyAlpha),Q.pixelStorei(3317,se.unpackAlignment);let Mt=Q.getParameter(3314),yt=Q.getParameter(32878),h1=Q.getParameter(3316),X1=Q.getParameter(3315),ys=Q.getParameter(32877),ii=me.isCompressedTexture?me.mipmaps[0]:me.image;Q.pixelStorei(3314,ii.width),Q.pixelStorei(32878,ii.height),Q.pixelStorei(3316,N.min.x),Q.pixelStorei(3315,N.min.y),Q.pixelStorei(32877,N.min.z),me.isDataTexture||me.isData3DTexture?Q.texSubImage3D(wt,ge,oe.x,oe.y,oe.z,qe,ut,vt,st,zt,ii.data):me.isCompressedArrayTexture?Q.compressedTexSubImage3D(wt,ge,oe.x,oe.y,oe.z,qe,ut,vt,st,ii.data):Q.texSubImage3D(wt,ge,oe.x,oe.y,oe.z,qe,ut,vt,st,zt,ii),Q.pixelStorei(3314,Mt),Q.pixelStorei(32878,yt),Q.pixelStorei(3316,h1),Q.pixelStorei(3315,X1),Q.pixelStorei(32877,ys),ge===0&&se.generateMipmaps&&Q.generateMipmap(wt),ne.unbindTexture()},this.initTexture=function(N){N.isCubeTexture?xe.setTextureCube(N,0):N.isData3DTexture?xe.setTexture3D(N,0):N.isDataArrayTexture||N.isCompressedArrayTexture?xe.setTexture2DArray(N,0):xe.setTexture2D(N,0),ne.unbindTexture()},this.resetState=function(){v=0,y=0,x=null,ne.reset(),de.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var _T=class extends wv{};_T.prototype.isWebGL1Renderer=!0;var Sv=class{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new Je(e),this.near=t,this.far=i}clone(){return new Sv(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},ls=class extends kt{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return this.matrixWorldAutoUpdate}set autoUpdate(e){this.matrixWorldAutoUpdate=e}},AT=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=e3,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=lr()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=lr()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=lr()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},w1=new E,s3=class{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)w1.fromBufferAttribute(this,t),w1.applyMatrix4(e),this.setXYZ(t,w1.x,w1.y,w1.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)w1.fromBufferAttribute(this,t),w1.applyNormalMatrix(e),this.setXYZ(t,w1.x,w1.y,w1.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)w1.fromBufferAttribute(this,t),w1.transformDirection(e),this.setXYZ(t,w1.x,w1.y,w1.z);return this}setX(e,t){return this.normalized&&(t=Xt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Xt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Xt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Xt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Ws(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Ws(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Ws(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Ws(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Xt(t,this.array),i=Xt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Xt(t,this.array),i=Xt(i,this.array),r=Xt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Xt(t,this.array),i=Xt(i,this.array),r=Xt(r,this.array),s=Xt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){let t=[];for(let i=0;i<this.count;i++){let r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new ot(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new s3(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){let t=[];for(let i=0;i<this.count;i++){let r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},_v=class extends kt{constructor(){super(),this.isBone=!0,this.type="Bone"}},or=class extends ai{constructor(e=null,t=1,i=1,r,s,a,n,o,l=Bt,h=Bt,c,d){super(null,a,n,o,l,h,r,s,c,d),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},qm=new we,MT=new we,a4=class{constructor(e=[],t=[]){this.uuid=lr(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new we)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let i=new we;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){let e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,a=e.length;s<a;s++){let n=e[s]?e[s].matrixWorld:MT;qm.multiplyMatrices(n,t[s]),qm.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new a4(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=ov(e),e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let i=new or(t,e,e,Wi,_i);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){let r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){let s=e.bones[i],a=t[s];a===void 0&&(a=new _v),this.bones.push(a),this.boneInverses.push(new we().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){let e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++){let a=t[r];e.bones.push(a.uuid);let n=i[r];e.boneInverses.push(n.toArray())}return e}},L2=class extends ot{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},Ym=new we,Xm=new we,Nh=[],ET=new we,Vl=new si,CT=class extends si{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new L2(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1;for(let r=0;r<i;r++)this.setMatrixAt(r,ET)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){let i=this.matrixWorld,r=this.count;if(Vl.geometry=this.geometry,Vl.material=this.material,Vl.material!==void 0)for(let s=0;s<r;s++){this.getMatrixAt(s,Ym),Xm.multiplyMatrices(i,Ym),Vl.matrixWorld=Xm,Vl.raycast(e,Nh);for(let a=0,n=Nh.length;a<n;a++){let o=Nh[a];o.instanceId=s,o.object=this,t.push(o)}Nh.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new L2(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}},Xa=class extends rh{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Je(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},Qm=new E,Zm=new E,Km=new we,Su=new vl,Vh=new V1,fc=class extends kt{constructor(e=new Ge,t=new Xa){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)Qm.fromBufferAttribute(t,r-1),Zm.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=Qm.distanceTo(Zm);e.setAttribute("lineDistance",new De(i,1))}return this}raycast(e,t){let i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,a=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Vh.copy(i.boundingSphere),Vh.applyMatrix4(r),Vh.radius+=s,e.ray.intersectsSphere(Vh)===!1)return;Km.copy(r).invert(),Su.copy(e.ray).applyMatrix4(Km);let n=s/((this.scale.x+this.scale.y+this.scale.z)/3),o=n*n,l=new E,h=new E,c=new E,d=new E,u=this.isLineSegments?2:1,p=i.index,f=i.attributes.position;if(p!==null){let g=Math.max(0,a.start),m=Math.min(p.count,a.start+a.count);for(let v=g,y=m-1;v<y;v+=u){let x=p.getX(v),w=p.getX(v+1);if(l.fromBufferAttribute(f,x),h.fromBufferAttribute(f,w),Su.distanceSqToSegment(l,h,d,c)>o)continue;d.applyMatrix4(this.matrixWorld);let _=e.ray.origin.distanceTo(d);_<e.near||_>e.far||t.push({distance:_,point:c.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else{let g=Math.max(0,a.start),m=Math.min(f.count,a.start+a.count);for(let v=g,y=m-1;v<y;v+=u){if(l.fromBufferAttribute(f,v),h.fromBufferAttribute(f,v+1),Su.distanceSqToSegment(l,h,d,c)>o)continue;d.applyMatrix4(this.matrixWorld);let x=e.ray.origin.distanceTo(d);x<e.near||x>e.far||t.push({distance:x,point:c.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let i=e[t[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,s=i.length;r<s;r++){let a=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}},Jm=new E,$m=new E,sh=class extends fc{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)Jm.fromBufferAttribute(t,r),$m.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+Jm.distanceTo($m);e.setAttribute("lineDistance",new De(i,1))}return this}},TT=class extends ai{constructor(e,t,i,r,s,a,n,o,l){super(e,t,i,r,s,a,n,o,l),this.isVideoTexture=!0,this.minFilter=a!==void 0?a:gt,this.magFilter=s!==void 0?s:gt,this.generateMipmaps=!1;let h=this;function c(){h.needsUpdate=!0,e.requestVideoFrameCallback(c)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(c)}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},PT=class extends ai{constructor(e,t,i,r,s,a,n,o,l){super(e,t,i,r,s,a,n,o,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},ms=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return null}getPointAt(e,t){let i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){let t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){let t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],i,r=this.getPoint(0),s=0;t.push(0);for(let a=1;a<=e;a++)i=this.getPoint(a/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let i=this.getLengths(),r=0,s=i.length,a;t?a=t:a=e*i[s-1];let n=0,o=s-1,l;for(;n<=o;)if(r=Math.floor(n+(o-n)/2),l=i[r]-a,l<0)n=r+1;else if(l>0)o=r-1;else{o=r;break}if(r=o,i[r]===a)return r/(s-1);let h=i[r],c=i[r+1]-h,d=(a-h)/c;return(r+d)/(s-1)}getTangent(e,t){let i=e-1e-4,r=e+1e-4;i<0&&(i=0),r>1&&(r=1);let s=this.getPoint(i),a=this.getPoint(r),n=t||(s.isVector2?new j:new E);return n.copy(a).sub(s).normalize(),n}getTangentAt(e,t){let i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){let i=new E,r=[],s=[],a=[],n=new E,o=new we;for(let u=0;u<=e;u++){let p=u/e;r[u]=this.getTangentAt(p,new E)}s[0]=new E,a[0]=new E;let l=Number.MAX_VALUE,h=Math.abs(r[0].x),c=Math.abs(r[0].y),d=Math.abs(r[0].z);h<=l&&(l=h,i.set(1,0,0)),c<=l&&(l=c,i.set(0,1,0)),d<=l&&i.set(0,0,1),n.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],n),a[0].crossVectors(r[0],s[0]);for(let u=1;u<=e;u++){if(s[u]=s[u-1].clone(),a[u]=a[u-1].clone(),n.crossVectors(r[u-1],r[u]),n.length()>Number.EPSILON){n.normalize();let p=Math.acos(wi(r[u-1].dot(r[u]),-1,1));s[u].applyMatrix4(o.makeRotationAxis(n,p))}a[u].crossVectors(r[u],s[u])}if(t===!0){let u=Math.acos(wi(s[0].dot(s[e]),-1,1));u/=e,r[0].dot(n.crossVectors(s[0],s[e]))>0&&(u=-u);for(let p=1;p<=e;p++)s[p].applyMatrix4(o.makeRotationAxis(r[p],u*p)),a[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},md=class extends ms{constructor(e=0,t=0,i=1,r=1,s=0,a=Math.PI*2,n=!1,o=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=n,this.aRotation=o}getPoint(e,t){let i=t||new j,r=Math.PI*2,s=this.aEndAngle-this.aStartAngle,a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(a?s=0:s=r),this.aClockwise===!0&&!a&&(s===r?s=-r:s=s-r);let n=this.aStartAngle+e*s,o=this.aX+this.xRadius*Math.cos(n),l=this.aY+this.yRadius*Math.sin(n);if(this.aRotation!==0){let h=Math.cos(this.aRotation),c=Math.sin(this.aRotation),d=o-this.aX,u=l-this.aY;o=d*h-u*c+this.aX,l=d*c+u*h+this.aY}return i.set(o,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},DT=class extends md{constructor(e,t,i,r,s,a){super(e,t,i,i,r,s,a),this.isArcCurve=!0,this.type="ArcCurve"}};function n4(){let e=0,t=0,i=0,r=0;function s(a,n,o,l){e=a,t=o,i=-3*a+3*n-2*o-l,r=2*a-2*n+o+l}return{initCatmullRom:function(a,n,o,l,h){s(n,o,h*(o-a),h*(l-n))},initNonuniformCatmullRom:function(a,n,o,l,h,c,d){let u=(n-a)/h-(o-a)/(h+c)+(o-n)/c,p=(o-n)/c-(l-n)/(c+d)+(l-o)/d;u*=c,p*=c,s(n,o,u,p)},calc:function(a){let n=a*a,o=n*a;return e+t*a+i*n+r*o}}}var jh=new E,_u=new n4,Au=new n4,Mu=new n4,IT=class extends ms{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new E){let i=t,r=this.points,s=r.length,a=(s-(this.closed?0:1))*e,n=Math.floor(a),o=a-n;this.closed?n+=n>0?0:(Math.floor(Math.abs(n)/s)+1)*s:o===0&&n===s-1&&(n=s-2,o=1);let l,h;this.closed||n>0?l=r[(n-1)%s]:(jh.subVectors(r[0],r[1]).add(r[0]),l=jh);let c=r[n%s],d=r[(n+1)%s];if(this.closed||n+2<s?h=r[(n+2)%s]:(jh.subVectors(r[s-1],r[s-2]).add(r[s-1]),h=jh),this.curveType==="centripetal"||this.curveType==="chordal"){let u=this.curveType==="chordal"?.5:.25,p=Math.pow(l.distanceToSquared(c),u),f=Math.pow(c.distanceToSquared(d),u),g=Math.pow(d.distanceToSquared(h),u);f<1e-4&&(f=1),p<1e-4&&(p=f),g<1e-4&&(g=f),_u.initNonuniformCatmullRom(l.x,c.x,d.x,h.x,p,f,g),Au.initNonuniformCatmullRom(l.y,c.y,d.y,h.y,p,f,g),Mu.initNonuniformCatmullRom(l.z,c.z,d.z,h.z,p,f,g)}else this.curveType==="catmullrom"&&(_u.initCatmullRom(l.x,c.x,d.x,h.x,this.tension),Au.initCatmullRom(l.y,c.y,d.y,h.y,this.tension),Mu.initCatmullRom(l.z,c.z,d.z,h.z,this.tension));return i.set(_u.calc(o),Au.calc(o),Mu.calc(o)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){let r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let r=e.points[t];this.points.push(new E().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};function e6(e,t,i,r,s){let a=(r-t)*.5,n=(s-i)*.5,o=e*e,l=e*o;return(2*i-2*r+a+n)*l+(-3*i+3*r-2*a-n)*o+a*e+i}function OT(e,t){let i=1-e;return i*i*t}function RT(e,t){return 2*(1-e)*e*t}function LT(e,t){return e*e*t}function w2(e,t,i,r){return OT(e,t)+RT(e,i)+LT(e,r)}function BT(e,t){let i=1-e;return i*i*i*t}function zT(e,t){let i=1-e;return 3*i*i*e*t}function FT(e,t){return 3*(1-e)*e*e*t}function kT(e,t){return e*e*e*t}function S2(e,t,i,r,s){return BT(e,t)+zT(e,i)+FT(e,r)+kT(e,s)}var Cr=class extends ms{constructor(e=new j,t=new j,i=new j,r=new j){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new j){let i=t,r=this.v0,s=this.v1,a=this.v2,n=this.v3;return i.set(S2(e,r.x,s.x,a.x,n.x),S2(e,r.y,s.y,a.y,n.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},q0=class extends ms{constructor(e=new E,t=new E,i=new E,r=new E){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new E){let i=t,r=this.v0,s=this.v1,a=this.v2,n=this.v3;return i.set(S2(e,r.x,s.x,a.x,n.x),S2(e,r.y,s.y,a.y,n.y),S2(e,r.z,s.z,a.z,n.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},Ir=class extends ms{constructor(e=new j,t=new j){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new j){let i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){let i=t||new j;return i.copy(this.v2).sub(this.v1).normalize(),i}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Av=class extends ms{constructor(e=new E,t=new E){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new E){let i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Ga=class extends ms{constructor(e=new j,t=new j,i=new j){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new j){let i=t,r=this.v0,s=this.v1,a=this.v2;return i.set(w2(e,r.x,s.x,a.x),w2(e,r.y,s.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},UT=class extends ms{constructor(e=new E,t=new E,i=new E){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new E){let i=t,r=this.v0,s=this.v1,a=this.v2;return i.set(w2(e,r.x,s.x,a.x),w2(e,r.y,s.y,a.y),w2(e,r.z,s.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},o4=class extends ms{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new j){let i=t,r=this.points,s=(r.length-1)*e,a=Math.floor(s),n=s-a,o=r[a===0?a:a-1],l=r[a],h=r[a>r.length-2?r.length-1:a+1],c=r[a>r.length-3?r.length-1:a+2];return i.set(e6(n,o.x,l.x,h.x,c.x),e6(n,o.y,l.y,h.y,c.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let r=e.points[t];this.points.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){let r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let r=e.points[t];this.points.push(new j().fromArray(r))}return this}},NT=Object.freeze({__proto__:null,ArcCurve:DT,CatmullRomCurve3:IT,CubicBezierCurve:Cr,CubicBezierCurve3:q0,EllipseCurve:md,LineCurve:Ir,LineCurve3:Av,QuadraticBezierCurve:Ga,QuadraticBezierCurve3:UT,SplineCurve:o4}),Mv=class extends ms{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Ir(t,e))}getPoint(e,t){let i=e*this.getLength(),r=this.getCurveLengths(),s=0;for(;s<r.length;){if(r[s]>=i){let a=r[s]-i,n=this.curves[s],o=n.getLength(),l=o===0?0:1-a/o;return n.getPointAt(l,t)}s++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],i;for(let r=0,s=this.curves;r<s.length;r++){let a=s[r],n=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,o=a.getPoints(n);for(let l=0;l<o.length;l++){let h=o[l];i&&i.equals(h)||(t.push(h),i=h)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){let r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){let r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){let r=e.curves[t];this.curves.push(new NT[r.type]().fromJSON(r))}return this}},mc=class extends Mv{constructor(e){super(),this.type="Path",this.currentPoint=new j,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let i=new Ir(this.currentPoint.clone(),new j(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){let s=new Ga(this.currentPoint.clone(),new j(e,t),new j(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,a){let n=new Cr(this.currentPoint.clone(),new j(e,t),new j(i,r),new j(s,a));return this.curves.push(n),this.currentPoint.set(s,a),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),i=new o4(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,a){let n=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+n,t+o,i,r,s,a),this}absarc(e,t,i,r,s,a){return this.absellipse(e,t,i,i,r,s,a),this}ellipse(e,t,i,r,s,a,n,o){let l=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(e+l,t+h,i,r,s,a,n,o),this}absellipse(e,t,i,r,s,a,n,o){let l=new md(e,t,i,r,s,a,n,o);if(this.curves.length>0){let c=l.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(l);let h=l.getPoint(1);return this.currentPoint.copy(h),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},Ev=class extends Ge{constructor(e=[new j(0,-.5),new j(.5,0),new j(0,.5)],t=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:r},t=Math.floor(t),r=wi(r,0,Math.PI*2);let s=[],a=[],n=[],o=[],l=[],h=1/t,c=new E,d=new j,u=new E,p=new E,f=new E,g=0,m=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:g=e[v+1].x-e[v].x,m=e[v+1].y-e[v].y,u.x=m*1,u.y=-g,u.z=m*0,f.copy(u),u.normalize(),o.push(u.x,u.y,u.z);break;case e.length-1:o.push(f.x,f.y,f.z);break;default:g=e[v+1].x-e[v].x,m=e[v+1].y-e[v].y,u.x=m*1,u.y=-g,u.z=m*0,p.copy(u),u.x+=f.x,u.y+=f.y,u.z+=f.z,u.normalize(),o.push(u.x,u.y,u.z),f.copy(p)}for(let v=0;v<=t;v++){let y=i+v*h*r,x=Math.sin(y),w=Math.cos(y);for(let _=0;_<=e.length-1;_++){c.x=e[_].x*x,c.y=e[_].y,c.z=e[_].x*w,a.push(c.x,c.y,c.z),d.x=v/t,d.y=_/(e.length-1),n.push(d.x,d.y);let b=o[3*_+0]*x,A=o[3*_+1],S=o[3*_+0]*w;l.push(b,A,S)}}for(let v=0;v<t;v++)for(let y=0;y<e.length-1;y++){let x=y+v*e.length,w=x,_=x+e.length,b=x+e.length+1,A=x+1;s.push(w,_,A),s.push(b,A,_)}this.setIndex(s),this.setAttribute("position",new De(a,3)),this.setAttribute("uv",new De(n,2)),this.setAttribute("normal",new De(l,3))}static fromJSON(e){return new Ev(e.points,e.segments,e.phiStart,e.phiLength)}},l4=class extends Ge{constructor(e=1,t=1,i=1,r=32,s=1,a=!1,n=0,o=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:a,thetaStart:n,thetaLength:o};let l=this;r=Math.floor(r),s=Math.floor(s);let h=[],c=[],d=[],u=[],p=0,f=[],g=i/2,m=0;v(),a===!1&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(h),this.setAttribute("position",new De(c,3)),this.setAttribute("normal",new De(d,3)),this.setAttribute("uv",new De(u,2));function v(){let x=new E,w=new E,_=0,b=(t-e)/i;for(let A=0;A<=s;A++){let S=[],M=A/s,C=M*(t-e)+e;for(let T=0;T<=r;T++){let P=T/r,I=P*o+n,D=Math.sin(I),k=Math.cos(I);w.x=C*D,w.y=-M*i+g,w.z=C*k,c.push(w.x,w.y,w.z),x.set(D,b,k).normalize(),d.push(x.x,x.y,x.z),u.push(P,1-M),S.push(p++)}f.push(S)}for(let A=0;A<r;A++)for(let S=0;S<s;S++){let M=f[S][A],C=f[S+1][A],T=f[S+1][A+1],P=f[S][A+1];h.push(M,C,P),h.push(C,T,P),_+=6}l.addGroup(m,_,0),m+=_}function y(x){let w=p,_=new j,b=new E,A=0,S=x===!0?e:t,M=x===!0?1:-1;for(let T=1;T<=r;T++)c.push(0,g*M,0),d.push(0,M,0),u.push(.5,.5),p++;let C=p;for(let T=0;T<=r;T++){let P=T/r*o+n,I=Math.cos(P),D=Math.sin(P);b.x=S*D,b.y=g*M,b.z=S*I,c.push(b.x,b.y,b.z),d.push(0,M,0),_.x=I*.5+.5,_.y=D*.5*M+.5,u.push(_.x,_.y),p++}for(let T=0;T<r;T++){let P=w+T,I=C+T;x===!0?h.push(I,I+1,P):h.push(I+1,I,P),A+=3}l.addGroup(m,A,x===!0?1:2),m+=A}}static fromJSON(e){return new l4(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},h4=class extends l4{constructor(e=1,t=1,i=32,r=1,s=!1,a=0,n=Math.PI*2){super(0,e,t,i,r,s,a,n),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:a,thetaLength:n}}static fromJSON(e){return new h4(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},c4=class extends Ge{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};let s=[],a=[];n(r),l(i),h(),this.setAttribute("position",new De(s,3)),this.setAttribute("normal",new De(s.slice(),3)),this.setAttribute("uv",new De(a,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function n(v){let y=new E,x=new E,w=new E;for(let _=0;_<t.length;_+=3)u(t[_+0],y),u(t[_+1],x),u(t[_+2],w),o(y,x,w,v)}function o(v,y,x,w){let _=w+1,b=[];for(let A=0;A<=_;A++){b[A]=[];let S=v.clone().lerp(x,A/_),M=y.clone().lerp(x,A/_),C=_-A;for(let T=0;T<=C;T++)T===0&&A===_?b[A][T]=S:b[A][T]=S.clone().lerp(M,T/C)}for(let A=0;A<_;A++)for(let S=0;S<2*(_-A)-1;S++){let M=Math.floor(S/2);S%2===0?(d(b[A][M+1]),d(b[A+1][M]),d(b[A][M])):(d(b[A][M+1]),d(b[A+1][M+1]),d(b[A+1][M]))}}function l(v){let y=new E;for(let x=0;x<s.length;x+=3)y.x=s[x+0],y.y=s[x+1],y.z=s[x+2],y.normalize().multiplyScalar(v),s[x+0]=y.x,s[x+1]=y.y,s[x+2]=y.z}function h(){let v=new E;for(let y=0;y<s.length;y+=3){v.x=s[y+0],v.y=s[y+1],v.z=s[y+2];let x=g(v)/2/Math.PI+.5,w=m(v)/Math.PI+.5;a.push(x,1-w)}p(),c()}function c(){for(let v=0;v<a.length;v+=6){let y=a[v+0],x=a[v+2],w=a[v+4],_=Math.max(y,x,w),b=Math.min(y,x,w);_>.9&&b<.1&&(y<.2&&(a[v+0]+=1),x<.2&&(a[v+2]+=1),w<.2&&(a[v+4]+=1))}}function d(v){s.push(v.x,v.y,v.z)}function u(v,y){let x=v*3;y.x=e[x+0],y.y=e[x+1],y.z=e[x+2]}function p(){let v=new E,y=new E,x=new E,w=new E,_=new j,b=new j,A=new j;for(let S=0,M=0;S<s.length;S+=9,M+=6){v.set(s[S+0],s[S+1],s[S+2]),y.set(s[S+3],s[S+4],s[S+5]),x.set(s[S+6],s[S+7],s[S+8]),_.set(a[M+0],a[M+1]),b.set(a[M+2],a[M+3]),A.set(a[M+4],a[M+5]),w.copy(v).add(y).add(x).divideScalar(3);let C=g(w);f(_,M+0,v,C),f(b,M+2,y,C),f(A,M+4,x,C)}}function f(v,y,x,w){w<0&&v.x===1&&(a[y]=v.x-1),x.x===0&&x.z===0&&(a[y]=w/2/Math.PI+.5)}function g(v){return Math.atan2(v.z,-v.x)}function m(v){return Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))}}static fromJSON(e){return new c4(e.vertices,e.indices,e.radius,e.details)}},Cv=class extends c4{constructor(e=1,t=0){let i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,a,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Cv(e.radius,e.detail)}},gc=class extends mc{constructor(e){super(e),this.uuid=lr(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){let r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){let r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){let r=e.holes[t];this.holes.push(new mc().fromJSON(r))}return this}},VT={triangulate:function(e,t,i=2){let r=t&&t.length,s=r?t[0]*i:e.length,a=Tv(e,0,s,i,!0),n=[];if(!a||a.next===a.prev)return n;let o,l,h,c,d,u,p;if(r&&(a=qT(e,t,a,i)),e.length>80*i){o=h=e[0],l=c=e[1];for(let f=i;f<s;f+=i)d=e[f],u=e[f+1],d<o&&(o=d),u<l&&(l=u),d>h&&(h=d),u>c&&(c=u);p=Math.max(h-o,c-l),p=p!==0?32767/p:0}return B2(a,n,i,o,l,p,0),n}};function Tv(e,t,i,r,s){let a,n;if(s===rP(e,t,i,r)>0)for(a=t;a<i;a+=r)n=t6(a,e[a],e[a+1],n);else for(a=i-r;a>=t;a-=r)n=t6(a,e[a],e[a+1],n);return n&&gd(n,n.next)&&(F2(n),n=n.next),n}function Fn(e,t){if(!e)return e;t||(t=e);let i=e,r;do if(r=!1,!i.steiner&&(gd(i,i.next)||ri(i.prev,i,i.next)===0)){if(F2(i),i=t=i.prev,i===i.next)break;r=!0}else i=i.next;while(r||i!==t);return t}function B2(e,t,i,r,s,a,n){if(!e)return;!n&&a&&KT(e,r,s,a);let o=e,l,h;for(;e.prev!==e.next;){if(l=e.prev,h=e.next,a?GT(e,r,s,a):jT(e)){t.push(l.i/i|0),t.push(e.i/i|0),t.push(h.i/i|0),F2(e),e=h.next,o=h.next;continue}if(e=h,e===o){n?n===1?(e=HT(Fn(e),t,i),B2(e,t,i,r,s,a,2)):n===2&&WT(e,t,i,r,s,a):B2(Fn(e),t,i,r,s,a,1);break}}}function jT(e){let t=e.prev,i=e,r=e.next;if(ri(t,i,r)>=0)return!1;let s=t.x,a=i.x,n=r.x,o=t.y,l=i.y,h=r.y,c=s<a?s<n?s:n:a<n?a:n,d=o<l?o<h?o:h:l<h?l:h,u=s>a?s>n?s:n:a>n?a:n,p=o>l?o>h?o:h:l>h?l:h,f=r.next;for(;f!==t;){if(f.x>=c&&f.x<=u&&f.y>=d&&f.y<=p&&Fo(s,o,a,l,n,h,f.x,f.y)&&ri(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function GT(e,t,i,r){let s=e.prev,a=e,n=e.next;if(ri(s,a,n)>=0)return!1;let o=s.x,l=a.x,h=n.x,c=s.y,d=a.y,u=n.y,p=o<l?o<h?o:h:l<h?l:h,f=c<d?c<u?c:u:d<u?d:u,g=o>l?o>h?o:h:l>h?l:h,m=c>d?c>u?c:u:d>u?d:u,v=a3(p,f,t,i,r),y=a3(g,m,t,i,r),x=e.prevZ,w=e.nextZ;for(;x&&x.z>=v&&w&&w.z<=y;){if(x.x>=p&&x.x<=g&&x.y>=f&&x.y<=m&&x!==s&&x!==n&&Fo(o,c,l,d,h,u,x.x,x.y)&&ri(x.prev,x,x.next)>=0||(x=x.prevZ,w.x>=p&&w.x<=g&&w.y>=f&&w.y<=m&&w!==s&&w!==n&&Fo(o,c,l,d,h,u,w.x,w.y)&&ri(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;x&&x.z>=v;){if(x.x>=p&&x.x<=g&&x.y>=f&&x.y<=m&&x!==s&&x!==n&&Fo(o,c,l,d,h,u,x.x,x.y)&&ri(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;w&&w.z<=y;){if(w.x>=p&&w.x<=g&&w.y>=f&&w.y<=m&&w!==s&&w!==n&&Fo(o,c,l,d,h,u,w.x,w.y)&&ri(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function HT(e,t,i){let r=e;do{let s=r.prev,a=r.next.next;!gd(s,a)&&Pv(s,r,r.next,a)&&z2(s,a)&&z2(a,s)&&(t.push(s.i/i|0),t.push(r.i/i|0),t.push(a.i/i|0),F2(r),F2(r.next),r=e=a),r=r.next}while(r!==e);return Fn(r)}function WT(e,t,i,r,s,a){let n=e;do{let o=n.next.next;for(;o!==n.prev;){if(n.i!==o.i&&eP(n,o)){let l=Dv(n,o);n=Fn(n,n.next),l=Fn(l,l.next),B2(n,t,i,r,s,a,0),B2(l,t,i,r,s,a,0);return}o=o.next}n=n.next}while(n!==e)}function qT(e,t,i,r){let s=[],a,n,o,l,h;for(a=0,n=t.length;a<n;a++)o=t[a]*r,l=a<n-1?t[a+1]*r:e.length,h=Tv(e,o,l,r,!1),h===h.next&&(h.steiner=!0),s.push($T(h));for(s.sort(YT),a=0;a<s.length;a++)i=XT(s[a],i);return i}function YT(e,t){return e.x-t.x}function XT(e,t){let i=QT(e,t);if(!i)return t;let r=Dv(i,e);return Fn(r,r.next),Fn(i,i.next)}function QT(e,t){let i=t,r=-1/0,s,a=e.x,n=e.y;do{if(n<=i.y&&n>=i.next.y&&i.next.y!==i.y){let u=i.x+(n-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(u<=a&&u>r&&(r=u,s=i.x<i.next.x?i:i.next,u===a))return s}i=i.next}while(i!==t);if(!s)return null;let o=s,l=s.x,h=s.y,c=1/0,d;i=s;do a>=i.x&&i.x>=l&&a!==i.x&&Fo(n<h?a:r,n,l,h,n<h?r:a,n,i.x,i.y)&&(d=Math.abs(n-i.y)/(a-i.x),z2(i,e)&&(d<c||d===c&&(i.x>s.x||i.x===s.x&&ZT(s,i)))&&(s=i,c=d)),i=i.next;while(i!==o);return s}function ZT(e,t){return ri(e.prev,e,t.prev)<0&&ri(t.next,e,e.next)<0}function KT(e,t,i,r){let s=e;do s.z===0&&(s.z=a3(s.x,s.y,t,i,r)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==e);s.prevZ.nextZ=null,s.prevZ=null,JT(s)}function JT(e){let t,i,r,s,a,n,o,l,h=1;do{for(i=e,e=null,a=null,n=0;i;){for(n++,r=i,o=0,t=0;t<h&&(o++,r=r.nextZ,!!r);t++);for(l=h;o>0||l>0&&r;)o!==0&&(l===0||!r||i.z<=r.z)?(s=i,i=i.nextZ,o--):(s=r,r=r.nextZ,l--),a?a.nextZ=s:e=s,s.prevZ=a,a=s;i=r}a.nextZ=null,h*=2}while(n>1);return e}function a3(e,t,i,r,s){return e=(e-i)*s|0,t=(t-r)*s|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function $T(e){let t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function Fo(e,t,i,r,s,a,n,o){return(s-n)*(t-o)>=(e-n)*(a-o)&&(e-n)*(r-o)>=(i-n)*(t-o)&&(i-n)*(a-o)>=(s-n)*(r-o)}function eP(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!tP(e,t)&&(z2(e,t)&&z2(t,e)&&iP(e,t)&&(ri(e.prev,e,t.prev)||ri(e,t.prev,t))||gd(e,t)&&ri(e.prev,e,e.next)>0&&ri(t.prev,t,t.next)>0)}function ri(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function gd(e,t){return e.x===t.x&&e.y===t.y}function Pv(e,t,i,r){let s=Hh(ri(e,t,i)),a=Hh(ri(e,t,r)),n=Hh(ri(i,r,e)),o=Hh(ri(i,r,t));return!!(s!==a&&n!==o||s===0&&Gh(e,i,t)||a===0&&Gh(e,r,t)||n===0&&Gh(i,e,r)||o===0&&Gh(i,t,r))}function Gh(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function Hh(e){return e>0?1:e<0?-1:0}function tP(e,t){let i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&Pv(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}function z2(e,t){return ri(e.prev,e,e.next)<0?ri(e,t,e.next)>=0&&ri(e,e.prev,t)>=0:ri(e,t,e.prev)<0||ri(e,e.next,t)<0}function iP(e,t){let i=e,r=!1,s=(e.x+t.x)/2,a=(e.y+t.y)/2;do i.y>a!=i.next.y>a&&i.next.y!==i.y&&s<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next;while(i!==e);return r}function Dv(e,t){let i=new n3(e.i,e.x,e.y),r=new n3(t.i,t.x,t.y),s=e.next,a=t.prev;return e.next=t,t.prev=e,i.next=s,s.prev=i,r.next=i,i.prev=r,a.next=r,r.prev=a,r}function t6(e,t,i,r){let s=new n3(e,t,i);return r?(s.next=r.next,s.prev=r,r.next.prev=s,r.next=s):(s.prev=s,s.next=s),s}function F2(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function n3(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function rP(e,t,i,r){let s=0;for(let a=t,n=i-r;a<i;a+=r)s+=(e[n]-e[a])*(e[a+1]+e[n+1]),n=a;return s}var Iv=class{static area(e){let t=e.length,i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return Iv.area(e)<0}static triangulateShape(e,t){let i=[],r=[],s=[];i6(e),r6(i,e);let a=e.length;t.forEach(i6);for(let o=0;o<t.length;o++)r.push(a),a+=t[o].length,r6(i,t[o]);let n=VT.triangulate(i,r);for(let o=0;o<n.length;o+=3)s.push(n.slice(o,o+3));return s}};function i6(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function r6(e,t){for(let i=0;i<t.length;i++)e.push(t[i].x),e.push(t[i].y)}var Ov=class extends c4{constructor(e=1,t=0){let i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Ov(e.radius,e.detail)}},jo=class extends Ge{constructor(e=1,t=32,i=16,r=0,s=Math.PI*2,a=0,n=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:a,thetaLength:n},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));let o=Math.min(a+n,Math.PI),l=0,h=[],c=new E,d=new E,u=[],p=[],f=[],g=[];for(let m=0;m<=i;m++){let v=[],y=m/i,x=0;m==0&&a==0?x=.5/t:m==i&&o==Math.PI&&(x=-.5/t);for(let w=0;w<=t;w++){let _=w/t;c.x=-e*Math.cos(r+_*s)*Math.sin(a+y*n),c.y=e*Math.cos(a+y*n),c.z=e*Math.sin(r+_*s)*Math.sin(a+y*n),p.push(c.x,c.y,c.z),d.copy(c).normalize(),f.push(d.x,d.y,d.z),g.push(_+x,1-y),v.push(l++)}h.push(v)}for(let m=0;m<i;m++)for(let v=0;v<t;v++){let y=h[m][v+1],x=h[m][v],w=h[m+1][v],_=h[m+1][v+1];(m!==0||a>0)&&u.push(y,x,_),(m!==i-1||o<Math.PI)&&u.push(x,w,_)}this.setIndex(u),this.setAttribute("position",new De(p,3)),this.setAttribute("normal",new De(f,3)),this.setAttribute("uv",new De(g,2))}static fromJSON(e){return new jo(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}},Rv=class extends Ge{constructor(e=1,t=.4,i=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);let a=[],n=[],o=[],l=[],h=new E,c=new E,d=new E;for(let u=0;u<=i;u++)for(let p=0;p<=r;p++){let f=p/r*s,g=u/i*Math.PI*2;c.x=(e+t*Math.cos(g))*Math.cos(f),c.y=(e+t*Math.cos(g))*Math.sin(f),c.z=t*Math.sin(g),n.push(c.x,c.y,c.z),h.x=e*Math.cos(f),h.y=e*Math.sin(f),d.subVectors(c,h).normalize(),o.push(d.x,d.y,d.z),l.push(p/r),l.push(u/i)}for(let u=1;u<=i;u++)for(let p=1;p<=r;p++){let f=(r+1)*u+p-1,g=(r+1)*(u-1)+p-1,m=(r+1)*(u-1)+p,v=(r+1)*u+p;a.push(f,g,v),a.push(g,m,v)}this.setIndex(a),this.setAttribute("position",new De(n,3)),this.setAttribute("normal",new De(o,3)),this.setAttribute("uv",new De(l,2))}static fromJSON(e){return new Rv(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}},Lv=class extends Ge{constructor(e=1,t=.4,i=64,r=8,s=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:r,p:s,q:a},i=Math.floor(i),r=Math.floor(r);let n=[],o=[],l=[],h=[],c=new E,d=new E,u=new E,p=new E,f=new E,g=new E,m=new E;for(let y=0;y<=i;++y){let x=y/i*s*Math.PI*2;v(x,s,a,e,u),v(x+.01,s,a,e,p),g.subVectors(p,u),m.addVectors(p,u),f.crossVectors(g,m),m.crossVectors(f,g),f.normalize(),m.normalize();for(let w=0;w<=r;++w){let _=w/r*Math.PI*2,b=-t*Math.cos(_),A=t*Math.sin(_);c.x=u.x+(b*m.x+A*f.x),c.y=u.y+(b*m.y+A*f.y),c.z=u.z+(b*m.z+A*f.z),o.push(c.x,c.y,c.z),d.subVectors(c,u).normalize(),l.push(d.x,d.y,d.z),h.push(y/i),h.push(w/r)}}for(let y=1;y<=i;y++)for(let x=1;x<=r;x++){let w=(r+1)*(y-1)+(x-1),_=(r+1)*y+(x-1),b=(r+1)*y+x,A=(r+1)*(y-1)+x;n.push(w,_,A),n.push(_,b,A)}this.setIndex(n),this.setAttribute("position",new De(o,3)),this.setAttribute("normal",new De(l,3)),this.setAttribute("uv",new De(h,2));function v(y,x,w,_,b){let A=Math.cos(y),S=Math.sin(y),M=w/x*y,C=Math.cos(M);b.x=_*(2+C)*.5*A,b.y=_*(2+C)*S*.5,b.z=_*Math.sin(M)*.5}}static fromJSON(e){return new Lv(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}};function pa(e,t,i){return Bv(e)?new e.constructor(e.subarray(t,i!==void 0?i:e.length)):e.slice(t,i)}function Wh(e,t,i){return!e||e.constructor===t?e:typeof t.BYTES_PER_ELEMENT=="number"?new t(e):Array.prototype.slice.call(e)}function Bv(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function sP(e){function t(s,a){return e[s]-e[a]}let i=e.length,r=new Array(i);for(let s=0;s!==i;++s)r[s]=s;return r.sort(t),r}function s6(e,t,i){let r=e.length,s=new e.constructor(r);for(let a=0,n=0;n!==r;++a){let o=i[a]*t;for(let l=0;l!==t;++l)s[n++]=e[o+l]}return s}function zv(e,t,i,r){let s=1,a=e[0];for(;a!==void 0&&a[r]===void 0;)a=e[s++];if(a===void 0)return;let n=a[r];if(n!==void 0)if(Array.isArray(n))do n=a[r],n!==void 0&&(t.push(a.time),i.push.apply(i,n)),a=e[s++];while(a!==void 0);else if(n.toArray!==void 0)do n=a[r],n!==void 0&&(t.push(a.time),n.toArray(i,i.length)),a=e[s++];while(a!==void 0);else do n=a[r],n!==void 0&&(t.push(a.time),i.push(n)),a=e[s++];while(a!==void 0)}var vd=class{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let a;i:{r:if(!(e<r)){for(let n=i+2;;){if(r===void 0){if(e<s)break r;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===n)break;if(s=r,r=t[++i],e<r)break t}a=t.length;break i}if(!(e>=s)){let n=t[1];e<n&&(i=2,s=n);for(let o=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===o)break;if(r=s,s=t[--i-1],e>=s)break t}a=i,i=0;break i}break e}for(;i<a;){let n=i+a>>>1;e<t[n]?a=n:i=n+1}if(r=t[i],s=t[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let a=0;a!==r;++a)t[a]=i[s+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},aP=class extends vd{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Lo,endingEnd:Lo}}intervalChanged_(e,t,i){let r=this.parameterPositions,s=e-2,a=e+1,n=r[s],o=r[a];if(n===void 0)switch(this.getSettings_().endingStart){case Bo:s=e,n=2*t-i;break;case dc:s=r.length-2,n=t+r[s]-r[s+1];break;default:s=e,n=i}if(o===void 0)switch(this.getSettings_().endingEnd){case Bo:a=e,o=2*i-t;break;case dc:a=1,o=i+r[1]-r[0];break;default:a=e-1,o=t}let l=(i-t)*.5,h=this.valueSize;this._weightPrev=l/(t-n),this._weightNext=l/(o-i),this._offsetPrev=s*h,this._offsetNext=a*h}interpolate_(e,t,i,r){let s=this.resultBuffer,a=this.sampleValues,n=this.valueSize,o=e*n,l=o-n,h=this._offsetPrev,c=this._offsetNext,d=this._weightPrev,u=this._weightNext,p=(i-t)/(r-t),f=p*p,g=f*p,m=-d*g+2*d*f-d*p,v=(1+d)*g+(-1.5-2*d)*f+(-.5+d)*p+1,y=(-1-u)*g+(1.5+u)*f+.5*p,x=u*g-u*f;for(let w=0;w!==n;++w)s[w]=m*a[h+w]+v*a[l+w]+y*a[o+w]+x*a[c+w];return s}},Fv=class extends vd{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){let s=this.resultBuffer,a=this.sampleValues,n=this.valueSize,o=e*n,l=o-n,h=(i-t)/(r-t),c=1-h;for(let d=0;d!==n;++d)s[d]=a[l+d]*c+a[o+d]*h;return s}},nP=class extends vd{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}},gs=class{constructor(e,t,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Wh(t,this.TimeBufferType),this.values=Wh(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Wh(e.times,Array),values:Wh(e.values,Array)};let r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new nP(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Fv(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new aP(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case hc:t=this.InterpolantFactoryMethodDiscrete;break;case cc:t=this.InterpolantFactoryMethodLinear;break;case Zd:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return hc;case this.InterpolantFactoryMethodLinear:return cc;case this.InterpolantFactoryMethodSmooth:return Zd}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){let i=this.times,r=i.length,s=0,a=r-1;for(;s!==r&&i[s]<e;)++s;for(;a!==-1&&i[a]>t;)--a;if(++a,s!==0||a!==r){s>=a&&(a=Math.max(a,1),s=a-1);let n=this.getValueSize();this.times=pa(i,s,a),this.values=pa(this.values,s*n,a*n)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(e=!1);let i=this.times,r=this.values,s=i.length;s===0&&(e=!1);let a=null;for(let n=0;n!==s;n++){let o=i[n];if(typeof o=="number"&&isNaN(o)){e=!1;break}if(a!==null&&a>o){e=!1;break}a=o}if(r!==void 0&&Bv(r))for(let n=0,o=r.length;n!==o;++n){let l=r[n];if(isNaN(l)){e=!1;break}}return e}optimize(){let e=pa(this.times),t=pa(this.values),i=this.getValueSize(),r=this.getInterpolation()===Zd,s=e.length-1,a=1;for(let n=1;n<s;++n){let o=!1,l=e[n],h=e[n+1];if(l!==h&&(n!==1||l!==e[0]))if(r)o=!0;else{let c=n*i,d=c-i,u=c+i;for(let p=0;p!==i;++p){let f=t[c+p];if(f!==t[d+p]||f!==t[u+p]){o=!0;break}}}if(o){if(n!==a){e[a]=e[n];let c=n*i,d=a*i;for(let u=0;u!==i;++u)t[d+u]=t[c+u]}++a}}if(s>0){e[a]=e[s];for(let n=s*i,o=a*i,l=0;l!==i;++l)t[o+l]=t[n+l];++a}return a!==e.length?(this.times=pa(e,0,a),this.values=pa(t,0,a*i)):(this.times=e,this.values=t),this}clone(){let e=pa(this.times,0),t=pa(this.values,0),i=this.constructor,r=new i(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}};gs.prototype.TimeBufferType=Float32Array;gs.prototype.ValueBufferType=Float32Array;gs.prototype.DefaultInterpolation=cc;var bl=class extends gs{};bl.prototype.ValueTypeName="bool";bl.prototype.ValueBufferType=Array;bl.prototype.DefaultInterpolation=hc;bl.prototype.InterpolantFactoryMethodLinear=void 0;bl.prototype.InterpolantFactoryMethodSmooth=void 0;var kv=class extends gs{};kv.prototype.ValueTypeName="color";var vc=class extends gs{};vc.prototype.ValueTypeName="number";var oP=class extends vd{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){let s=this.resultBuffer,a=this.sampleValues,n=this.valueSize,o=(i-t)/(r-t),l=e*n;for(let h=l+n;l!==h;l+=4)lt.slerpFlat(s,0,a,l-n,a,l,o);return s}},ah=class extends gs{InterpolantFactoryMethodLinear(e){return new oP(this.times,this.values,this.getValueSize(),e)}};ah.prototype.ValueTypeName="quaternion";ah.prototype.DefaultInterpolation=cc;ah.prototype.InterpolantFactoryMethodSmooth=void 0;var wl=class extends gs{};wl.prototype.ValueTypeName="string";wl.prototype.ValueBufferType=Array;wl.prototype.DefaultInterpolation=hc;wl.prototype.InterpolantFactoryMethodLinear=void 0;wl.prototype.InterpolantFactoryMethodSmooth=void 0;var yc=class extends gs{};yc.prototype.ValueTypeName="vector";var o3=class{constructor(e,t=-1,i,r=$f){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=lr(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],i=e.tracks,r=1/(e.fps||1);for(let a=0,n=i.length;a!==n;++a)t.push(hP(i[a]).scale(r));let s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){let t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,a=i.length;s!==a;++s)t.push(gs.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){let s=t.length,a=[];for(let n=0;n<s;n++){let o=[],l=[];o.push((n+s-1)%s,n,(n+1)%s),l.push(0,1,0);let h=sP(o);o=s6(o,1,h),l=s6(l,1,h),!r&&o[0]===0&&(o.push(s),l.push(l[0])),a.push(new vc(".morphTargetInfluences["+t[n].name+"]",o,l).scale(1/i))}return new this(e,-1,a)}static findByName(e,t){let i=e;if(!Array.isArray(e)){let r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){let r={},s=/^([\w-]*?)([\d]+)$/;for(let n=0,o=e.length;n<o;n++){let l=e[n],h=l.name.match(s);if(h&&h.length>1){let c=h[1],d=r[c];d||(r[c]=d=[]),d.push(l)}}let a=[];for(let n in r)a.push(this.CreateFromMorphTargetSequence(n,r[n],t,i));return a}static parseAnimation(e,t){if(!e)return null;let i=function(h,c,d,u,p){if(d.length!==0){let f=[],g=[];zv(d,f,g,u),f.length!==0&&p.push(new h(c,f,g))}},r=[],s=e.name||"default",a=e.fps||30,n=e.blendMode,o=e.length||-1,l=e.hierarchy||[];for(let h=0;h<l.length;h++){let c=l[h].keys;if(!(!c||c.length===0))if(c[0].morphTargets){let d={},u;for(u=0;u<c.length;u++)if(c[u].morphTargets)for(let p=0;p<c[u].morphTargets.length;p++)d[c[u].morphTargets[p]]=-1;for(let p in d){let f=[],g=[];for(let m=0;m!==c[u].morphTargets.length;++m){let v=c[u];f.push(v.time),g.push(v.morphTarget===p?1:0)}r.push(new vc(".morphTargetInfluence["+p+"]",f,g))}o=d.length*a}else{let d=".bones["+t[h].name+"]";i(yc,d+".position",c,"pos",r),i(ah,d+".quaternion",c,"rot",r),i(yc,d+".scale",c,"scl",r)}}return r.length===0?null:new this(s,o,r,n)}resetDuration(){let e=this.tracks,t=0;for(let i=0,r=e.length;i!==r;++i){let s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function lP(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return vc;case"vector":case"vector2":case"vector3":case"vector4":return yc;case"color":return kv;case"quaternion":return ah;case"bool":case"boolean":return bl;case"string":return wl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function hP(e){if(e.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let t=lP(e.type);if(e.times===void 0){let i=[],r=[];zv(e.keys,i,r,"value"),e.times=i,e.values=r}return t.parse!==void 0?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var xc={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},Uv=class{constructor(e,t,i){let r=this,s=!1,a=0,n=0,o,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(h){n++,s===!1&&r.onStart!==void 0&&r.onStart(h,a,n),s=!0},this.itemEnd=function(h){a++,r.onProgress!==void 0&&r.onProgress(h,a,n),a===n&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(h){r.onError!==void 0&&r.onError(h)},this.resolveURL=function(h){return o?o(h):h},this.setURLModifier=function(h){return o=h,this},this.addHandler=function(h,c){return l.push(h,c),this},this.removeHandler=function(h){let c=l.indexOf(h);return c!==-1&&l.splice(c,2),this},this.getHandler=function(h){for(let c=0,d=l.length;c<d;c+=2){let u=l[c],p=l[c+1];if(u.global&&(u.lastIndex=0),u.test(h))return p}return null}}},cP=new Uv,nh=class{constructor(e){this.manager=e!==void 0?e:cP,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}},Es={},dP=class extends Error{constructor(e,t){super(e),this.response=t}},l3=class extends nh{constructor(e){super(e)}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let s=xc.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(Es[e]!==void 0){Es[e].push({onLoad:t,onProgress:i,onError:r});return}Es[e]=[],Es[e].push({onLoad:t,onProgress:i,onError:r});let a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),n=this.mimeType,o=this.responseType;fetch(a).then(l=>{if(l.status===200||l.status===0){if(l.status,typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;let h=Es[e],c=l.body.getReader(),d=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),u=d?parseInt(d):0,p=u!==0,f=0,g=new ReadableStream({start(m){v();function v(){c.read().then(({done:y,value:x})=>{if(y)m.close();else{f+=x.byteLength;let w=new ProgressEvent("progress",{lengthComputable:p,loaded:f,total:u});for(let _=0,b=h.length;_<b;_++){let A=h[_];A.onProgress&&A.onProgress(w)}m.enqueue(x),v()}})}}});return new Response(g)}else throw new dP(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(o){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(h=>new DOMParser().parseFromString(h,n));case"json":return l.json();default:if(n===void 0)return l.text();{let h=/charset="?([^;"\s]*)"?/i.exec(n),c=h&&h[1]?h[1].toLowerCase():void 0,d=new TextDecoder(c);return l.arrayBuffer().then(u=>d.decode(u))}}}).then(l=>{xc.add(e,l);let h=Es[e];delete Es[e];for(let c=0,d=h.length;c<d;c++){let u=h[c];u.onLoad&&u.onLoad(l)}}).catch(l=>{let h=Es[e];if(h===void 0)throw this.manager.itemError(e),l;delete Es[e];for(let c=0,d=h.length;c<d;c++){let u=h[c];u.onError&&u.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},uP=class extends nh{constructor(e){super(e)}load(e,t,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let s=this,a=xc.get(e);if(a!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a;let n=R2("img");function o(){h(),xc.add(e,this),t&&t(this),s.manager.itemEnd(e)}function l(c){h(),r&&r(c),s.manager.itemError(e),s.manager.itemEnd(e)}function h(){n.removeEventListener("load",o,!1),n.removeEventListener("error",l,!1)}return n.addEventListener("load",o,!1),n.addEventListener("error",l,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(n.crossOrigin=this.crossOrigin),s.manager.itemStart(e),n.src=e,n}},pP=class extends nh{constructor(e){super(e)}load(e,t,i,r){let s=new ai,a=new uP(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(n){s.image=n,s.needsUpdate=!0,t!==void 0&&t(s)},i,r),s}},oh=class extends kt{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Je(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}},fP=class extends oh{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(kt.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Je(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}},Eu=new we,a6=new E,n6=new E,d4=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new j(512,512),this.map=null,this.mapPass=null,this.matrix=new we,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new r4,this._frameExtents=new j(1,1),this._viewportCount=1,this._viewports=[new ht(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,i=this.matrix;a6.setFromMatrixPosition(e.matrixWorld),t.position.copy(a6),n6.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(n6),t.updateMatrixWorld(),Eu.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Eu),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(Eu)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},mP=class extends d4{constructor(){super(new u1(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,i=O2*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},gP=class extends oh{constructor(e,t,i=0,r=Math.PI/3,s=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(kt.DEFAULT_UP),this.updateMatrix(),this.target=new kt,this.distance=i,this.angle=r,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new mP}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},o6=new we,jl=new E,Cu=new E,vP=class extends d4{constructor(){super(new u1(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new j(4,2),this._viewportCount=6,this._viewports=[new ht(2,1,1,1),new ht(0,1,1,1),new ht(3,1,1,1),new ht(1,1,1,1),new ht(3,0,1,1),new ht(1,0,1,1)],this._cubeDirections=[new E(1,0,0),new E(-1,0,0),new E(0,0,1),new E(0,0,-1),new E(0,1,0),new E(0,-1,0)],this._cubeUps=[new E(0,1,0),new E(0,1,0),new E(0,1,0),new E(0,1,0),new E(0,0,1),new E(0,0,-1)]}updateMatrices(e,t=0){let i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),jl.setFromMatrixPosition(e.matrixWorld),i.position.copy(jl),Cu.copy(i.position),Cu.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(Cu),i.updateMatrixWorld(),r.makeTranslation(-jl.x,-jl.y,-jl.z),o6.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o6)}},yP=class extends oh{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new vP}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},xP=class extends d4{constructor(){super(new pd(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},bP=class extends oh{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(kt.DEFAULT_UP),this.updateMatrix(),this.target=new kt,this.shadow=new xP}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},Nv=class extends Ge{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},Vv=class extends nh{constructor(e){super(e)}load(e,t,i,r){let s=this,a=new l3(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(n){try{t(s.parse(JSON.parse(n)))}catch(o){r&&r(o),s.manager.itemError(e)}},i,r)}parse(e){let t={},i={};function r(d,u){if(t[u]!==void 0)return t[u];let p=d.interleavedBuffers[u],f=s(d,p.buffer),g=wh(p.type,f),m=new AT(g,p.stride);return m.uuid=p.uuid,t[u]=m,m}function s(d,u){if(i[u]!==void 0)return i[u];let p=d.arrayBuffers[u],f=new Uint32Array(p).buffer;return i[u]=f,f}let a=e.isInstancedBufferGeometry?new Nv:new Ge,n=e.data.index;if(n!==void 0){let d=wh(n.type,n.array);a.setIndex(new ot(d,1))}let o=e.data.attributes;for(let d in o){let u=o[d],p;if(u.isInterleavedBufferAttribute){let f=r(e.data,u.data);p=new s3(f,u.itemSize,u.offset,u.normalized)}else{let f=wh(u.type,u.array),g=u.isInstancedBufferAttribute?L2:ot;p=new g(f,u.itemSize,u.normalized)}u.name!==void 0&&(p.name=u.name),u.usage!==void 0&&p.setUsage(u.usage),u.updateRange!==void 0&&(p.updateRange.offset=u.updateRange.offset,p.updateRange.count=u.updateRange.count),a.setAttribute(d,p)}let l=e.data.morphAttributes;if(l)for(let d in l){let u=l[d],p=[];for(let f=0,g=u.length;f<g;f++){let m=u[f],v;if(m.isInterleavedBufferAttribute){let y=r(e.data,m.data);v=new s3(y,m.itemSize,m.offset,m.normalized)}else{let y=wh(m.type,m.array);v=new ot(y,m.itemSize,m.normalized)}m.name!==void 0&&(v.name=m.name),p.push(v)}a.morphAttributes[d]=p}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);let h=e.data.groups||e.data.drawcalls||e.data.offsets;if(h!==void 0)for(let d=0,u=h.length;d!==u;++d){let p=h[d];a.addGroup(p.start,p.count,p.materialIndex)}let c=e.data.boundingSphere;if(c!==void 0){let d=new E;c.center!==void 0&&d.fromArray(c.center),a.boundingSphere=new V1(d,c.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}},wP=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=l6(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=l6();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function l6(){return(typeof performance>"u"?Date:performance).now()}var SP=class{constructor(e,t,i){this.binding=e,this.valueSize=i;let r,s,a;switch(t){case"quaternion":r=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){let i=this.buffer,r=this.valueSize,s=e*r+r,a=this.cumulativeWeight;if(a===0){for(let n=0;n!==r;++n)i[s+n]=i[n];a=t}else{a+=t;let n=t/a;this._mixBufferRegion(i,s,0,n,r)}this.cumulativeWeight=a}accumulateAdditive(e){let t=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,i=this.buffer,r=e*t+t,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,n=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){let o=t*this._origIndex;this._mixBufferRegion(i,r,o,1-s,t)}a>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let o=t,l=t+t;o!==l;++o)if(i[o]!==i[o+t]){n.setValue(i,r);break}}saveOriginalState(){let e=this.binding,t=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(t,r);for(let s=i,a=r;s!==a;++s)t[s]=t[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,s){if(r>=.5)for(let a=0;a!==s;++a)e[t+a]=e[i+a]}_slerp(e,t,i,r){lt.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,s){let a=this._workIndex*s;lt.multiplyQuaternionsFlat(e,a,e,t,e,i),lt.slerpFlat(e,t,e,t,e,a,r)}_lerp(e,t,i,r,s){let a=1-r;for(let n=0;n!==s;++n){let o=t+n;e[o]=e[o]*a+e[i+n]*r}}_lerpAdditive(e,t,i,r,s){for(let a=0;a!==s;++a){let n=t+a;e[n]=e[n]+e[i+a]*r}}},u4="\\[\\]\\.:\\/",_P=new RegExp("["+u4+"]","g"),p4="[^"+u4+"]",AP="[^"+u4.replace("\\.","")+"]",MP=/((?:WC+[\/:])*)/.source.replace("WC",p4),EP=/(WCOD+)?/.source.replace("WCOD",AP),CP=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",p4),TP=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",p4),PP=new RegExp("^"+MP+EP+CP+TP+"$"),DP=["material","materials","bones","map"],IP=class{constructor(e,t,i){let r=i||Wt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();let i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,t)}setValue(e,t){let i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}},Wt=class{constructor(e,t,i){this.path=t,this.parsedPath=i||Wt.parseTrackName(t),this.node=Wt.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new Wt.Composite(e,t,i):new Wt(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(_P,"")}static parseTrackName(e){let t=PP.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){let s=i.nodeName.substring(r+1);DP.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){let i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){let i=function(s){for(let a=0;a<s.length;a++){let n=s[a];if(n.name===t||n.uuid===t)return n;let o=i(n.children);if(o)return o}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[t++]=i[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,i=t.objectName,r=t.propertyName,s=t.propertyIndex;if(e||(e=Wt.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){""+this.path;return}if(i){let l=t.objectIndex;switch(i){case"materials":if(!e.material||!e.material.materials)return;e=e.material.materials;break;case"bones":if(!e.skeleton)return;e=e.skeleton.bones;for(let h=0;h<e.length;h++)if(e[h].name===l){l=h;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material||!e.material.map)return;e=e.material.map;break;default:if(e[i]===void 0)return;e=e[i]}if(l!==void 0){if(e[l]===void 0)return;e=e[l]}}let a=e[r];if(a===void 0){""+t.nodeName+r;return}let n=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?n=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(n=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry||!e.geometry.morphAttributes)return;e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}o=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(o=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(o=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][n]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};Wt.Composite=IP;Wt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Wt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Wt.prototype.GetterByBindingType=[Wt.prototype._getValue_direct,Wt.prototype._getValue_array,Wt.prototype._getValue_arrayElement,Wt.prototype._getValue_toArray];Wt.prototype.SetterByBindingTypeAndVersioning=[[Wt.prototype._setValue_direct,Wt.prototype._setValue_direct_setNeedsUpdate,Wt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Wt.prototype._setValue_array,Wt.prototype._setValue_array_setNeedsUpdate,Wt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Wt.prototype._setValue_arrayElement,Wt.prototype._setValue_arrayElement_setNeedsUpdate,Wt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Wt.prototype._setValue_fromArray,Wt.prototype._setValue_fromArray_setNeedsUpdate,Wt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var OP=class{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;let s=t.tracks,a=s.length,n=new Array(a),o={endingStart:Lo,endingEnd:Lo};for(let l=0;l!==a;++l){let h=s[l].createInterpolant(null);n[l]=h,h.settings=o}this._interpolantSettings=o,this._interpolants=n,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=av,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){let r=this._clip.duration,s=e._clip.duration,a=s/r,n=r/s;e.warp(1,a,t),this.warp(n,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){let e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){let r=this._mixer,s=r.time,a=this.timeScale,n=this._timeScaleInterpolant;n===null&&(n=r._lendControlInterpolant(),this._timeScaleInterpolant=n);let o=n.parameterPositions,l=n.sampleValues;return o[0]=s,o[1]=s+i,l[0]=e/a,l[1]=t/a,this}stopWarping(){let e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled){this._updateWeight(e);return}let s=this._startTime;if(s!==null){let o=(e-s)*i;o<0||i===0?t=0:(this._startTime=null,t=i*o)}t*=this._updateTimeScale(e);let a=this._updateTime(t),n=this._updateWeight(e);if(n>0){let o=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case l_:for(let h=0,c=o.length;h!==c;++h)o[h].evaluate(a),l[h].accumulateAdditive(n);break;case $f:default:for(let h=0,c=o.length;h!==c;++h)o[h].evaluate(a),l[h].accumulate(r,n)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let i=this._weightInterpolant;if(i!==null){let r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let i=this._timeScaleInterpolant;if(i!==null){let r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,i=this.loop,r=this.time+e,s=this._loopCount,a=i===Jf;if(e===0)return s===-1?r:a&&(s&1)===1?t-r:r;if(i===sv){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),r>=t||r<0){let n=Math.floor(r/t);r-=t*n,s+=Math.abs(n);let o=this.repetitions-s;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(o===1){let l=e<0;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=r;if(a&&(s&1)===1)return t-r}return r}_setEndings(e,t,i){let r=this._interpolantSettings;i?(r.endingStart=Bo,r.endingEnd=Bo):(e?r.endingStart=this.zeroSlopeAtStart?Bo:Lo:r.endingStart=dc,t?r.endingEnd=this.zeroSlopeAtEnd?Bo:Lo:r.endingEnd=dc)}_scheduleFading(e,t,i){let r=this._mixer,s=r.time,a=this._weightInterpolant;a===null&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);let n=a.parameterPositions,o=a.sampleValues;return n[0]=s,o[0]=t,n[1]=s+e,o[1]=i,this}},RP=new Float32Array(1),LP=class extends l1{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){let i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,a=e._propertyBindings,n=e._interpolants,o=i.uuid,l=this._bindingsByRootAndName,h=l[o];h===void 0&&(h={},l[o]=h);for(let c=0;c!==s;++c){let d=r[c],u=d.name,p=h[u];if(p!==void 0)++p.referenceCount,a[c]=p;else{if(p=a[c],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,o,u));continue}let f=t&&t._propertyBindings[c].binding.parsedPath;p=new SP(Wt.create(i,u,f),d.ValueTypeName,d.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,o,u),a[c]=p}n[c].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){let i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}let t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){let s=t[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){let s=t[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,i){let r=this._actions,s=this._actionsByClip,a=s[t];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=a;else{let n=a.knownActions;e._byClipCacheIndex=n.length,n.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[i]=e}_removeInactiveAction(e){let t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;let s=e._clip.uuid,a=this._actionsByClip,n=a[s],o=n.knownActions,l=o[o.length-1],h=e._byClipCacheIndex;l._byClipCacheIndex=h,o[h]=l,o.pop(),e._byClipCacheIndex=null;let c=n.actionByRoot,d=(e._localRoot||this._root).uuid;delete c[d],o.length===0&&delete a[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){let s=t[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){let t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackAction(e){let t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_addInactiveBinding(e,t,i){let r=this._bindingsByRootAndName,s=this._bindings,a=r[t];a===void 0&&(a={},r[t]=a),a[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){let t=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,a=this._bindingsByRootAndName,n=a[r],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete n[s],Object.keys(n).length===0&&delete a[r]}_lendBinding(e){let t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackBinding(e){let t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,i=e[t];return i===void 0&&(i=new Fv(new Float32Array(2),new Float32Array(2),1,RP),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){let t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=i,t[i]=s}clipAction(e,t,i){let r=t||this._root,s=r.uuid,a=typeof e=="string"?o3.findByName(r,e):e,n=a!==null?a.uuid:e,o=this._actionsByClip[n],l=null;if(i===void 0&&(a!==null?i=a.blendMode:i=$f),o!==void 0){let c=o.actionByRoot[s];if(c!==void 0&&c.blendMode===i)return c;l=o.knownActions[0],a===null&&(a=l._clip)}if(a===null)return null;let h=new OP(this,a,t,i);return this._bindAction(h,l),this._addInactiveAction(h,n,s),h}existingAction(e,t){let i=t||this._root,r=i.uuid,s=typeof e=="string"?o3.findByName(i,e):e,a=s?s.uuid:e,n=this._actionsByClip[a];return n!==void 0&&n.actionByRoot[r]||null}stopAllAction(){let e=this._actions,t=this._nActiveActions;for(let i=t-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;let t=this._actions,i=this._nActiveActions,r=this.time+=e,s=Math.sign(e),a=this._accuIndex^=1;for(let l=0;l!==i;++l)t[l]._update(r,e,s,a);let n=this._bindings,o=this._nActiveBindings;for(let l=0;l!==o;++l)n[l].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(s!==void 0){let a=s.knownActions;for(let n=0,o=a.length;n!==o;++n){let l=a[n];this._deactivateAction(l);let h=l._cacheIndex,c=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,c._cacheIndex=h,t[h]=c,t.pop(),this._removeInactiveBindingsForAction(l)}delete r[i]}}uncacheRoot(e){let t=e.uuid,i=this._actionsByClip;for(let a in i){let n=i[a].actionByRoot,o=n[t];o!==void 0&&(this._deactivateAction(o),this._removeInactiveAction(o))}let r=this._bindingsByRootAndName,s=r[t];if(s!==void 0)for(let a in s){let n=s[a];n.restoreOriginalState(),this._removeInactiveBinding(n)}}uncacheAction(e,t){let i=this.existingAction(e,t);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}},ve=class{constructor(e){this.value=e}clone(){return new ve(this.value.clone===void 0?this.value:this.value.clone())}},jv=class{constructor(e,t,i=0,r=1/0){this.ray=new vl(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new t4,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):""+t.type}intersectObject(e,t=!0,i=[]){return h3(e,this,i,t),i.sort(h6),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)h3(e[r],this,i,t);return i.sort(h6),i}};function h6(e,t){return e.distance-t.distance}function h3(e,t,i,r){if(e.layers.test(t.layers)&&e.raycast(t,i),r===!0){let s=e.children;for(let a=0,n=s.length;a<n;a++)h3(s[a],t,i,!0)}}var c6=class{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(wi(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},d6=new j,Gv=class{constructor(e=new j(1/0,1/0),t=new j(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let i=d6.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return d6.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},u6=new E,qh=new E,hr=class{constructor(e=new E,t=new E){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){u6.subVectors(e,this.start),qh.subVectors(this.end,this.start);let i=qh.dot(qh),r=qh.dot(u6)/i;return t&&(r=wi(r,0,1)),r}closestPointToPoint(e,t,i){let r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},p6=new E,BP=class extends kt{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let i=new Ge,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,n=1,o=32;a<o;a++,n++){let l=a/o*Math.PI*2,h=n/o*Math.PI*2;r.push(Math.cos(l),Math.sin(l),1,Math.cos(h),Math.sin(h),1)}i.setAttribute("position",new De(r,3));let s=new Xa({fog:!1,toneMapped:!1});this.cone=new sh(i,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),p6.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(p6),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},zP=class extends si{constructor(e,t,i){let r=new jo(t,4,2),s=new Js({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},f6=new E,Yh=new E,m6=new E,FP=class extends kt{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new Ge;r.setAttribute("position",new De([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let s=new Xa({fog:!1,toneMapped:!1});this.lightPlane=new fc(r,s),this.add(this.lightPlane),r=new Ge,r.setAttribute("position",new De([0,0,0,0,0,1],3)),this.targetLine=new fc(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),f6.setFromMatrixPosition(this.light.matrixWorld),Yh.setFromMatrixPosition(this.light.target.matrixWorld),m6.subVectors(Yh,f6),this.lightPlane.lookAt(Yh),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Yh),this.targetLine.scale.z=m6.length()}},Xh=new E,ni=new Vn,bc=class extends sh{constructor(e){let t=new Ge,i=new Xa({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],a={};n("n1","n2"),n("n2","n4"),n("n4","n3"),n("n3","n1"),n("f1","f2"),n("f2","f4"),n("f4","f3"),n("f3","f1"),n("n1","f1"),n("n2","f2"),n("n3","f3"),n("n4","f4"),n("p","n1"),n("p","n2"),n("p","n3"),n("p","n4"),n("u1","u2"),n("u2","u3"),n("u3","u1"),n("c","t"),n("p","c"),n("cn1","cn2"),n("cn3","cn4"),n("cf1","cf2"),n("cf3","cf4");function n(p,f){o(p),o(f)}function o(p){r.push(0,0,0),s.push(0,0,0),a[p]===void 0&&(a[p]=[]),a[p].push(r.length/3-1)}t.setAttribute("position",new De(r,3)),t.setAttribute("color",new De(s,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();let l=new Je(16755200),h=new Je(16711680),c=new Je(43775),d=new Je(16777215),u=new Je(3355443);this.setColors(l,h,c,d,u)}setColors(e,t,i,r,s){let a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,i.r,i.g,i.b),a.setXYZ(33,i.r,i.g,i.b),a.setXYZ(34,i.r,i.g,i.b),a.setXYZ(35,i.r,i.g,i.b),a.setXYZ(36,i.r,i.g,i.b),a.setXYZ(37,i.r,i.g,i.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){let e=this.geometry,t=this.pointMap,i=1,r=1;ni.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),ui("c",t,e,ni,0,0,-1),ui("t",t,e,ni,0,0,1),ui("n1",t,e,ni,-i,-r,-1),ui("n2",t,e,ni,i,-r,-1),ui("n3",t,e,ni,-i,r,-1),ui("n4",t,e,ni,i,r,-1),ui("f1",t,e,ni,-i,-r,1),ui("f2",t,e,ni,i,-r,1),ui("f3",t,e,ni,-i,r,1),ui("f4",t,e,ni,i,r,1),ui("u1",t,e,ni,i*.7,r*1.1,-1),ui("u2",t,e,ni,-i*.7,r*1.1,-1),ui("u3",t,e,ni,0,r*2,-1),ui("cf1",t,e,ni,-i,0,1),ui("cf2",t,e,ni,i,0,1),ui("cf3",t,e,ni,0,-r,1),ui("cf4",t,e,ni,0,r,1),ui("cn1",t,e,ni,-i,0,-1),ui("cn2",t,e,ni,i,0,-1),ui("cn3",t,e,ni,0,-r,-1),ui("cn4",t,e,ni,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function ui(e,t,i,r,s,a,n){Xh.set(s,a,n).unproject(r);let o=t[e];if(o!==void 0){let l=i.getAttribute("position");for(let h=0,c=o.length;h<c;h++)l.setXYZ(o[h],Xh.x,Xh.y,Xh.z)}}var wc=class extends sh{constructor(e,t=16776960){let i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Ge;s.setIndex(new ot(i,1)),s.setAttribute("position",new De(r,3)),super(s,new Xa({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},kP=class extends sh{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Ge;r.setAttribute("position",new De(t,3)),r.setAttribute("color",new De(i,3));let s=new Xa({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,t,i){let r=new Je,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},Vs=UP();function UP(){let e=new ArrayBuffer(4),t=new Float32Array(e),i=new Uint32Array(e),r=new Uint32Array(512),s=new Uint32Array(512);for(let l=0;l<256;++l){let h=l-127;h<-27?(r[l]=0,r[l|256]=32768,s[l]=24,s[l|256]=24):h<-14?(r[l]=1024>>-h-14,r[l|256]=1024>>-h-14|32768,s[l]=-h-1,s[l|256]=-h-1):h<=15?(r[l]=h+15<<10,r[l|256]=h+15<<10|32768,s[l]=13,s[l|256]=13):h<128?(r[l]=31744,r[l|256]=64512,s[l]=24,s[l|256]=24):(r[l]=31744,r[l|256]=64512,s[l]=13,s[l|256]=13)}let a=new Uint32Array(2048),n=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let h=l<<13,c=0;for(;!(h&8388608);)h<<=1,c-=8388608;h&=-8388609,c+=947912704,a[l]=h|c}for(let l=1024;l<2048;++l)a[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)n[l]=l<<23;n[31]=1199570944,n[32]=2147483648;for(let l=33;l<63;++l)n[l]=2147483648+(l-32<<23);n[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(o[l]=1024);return{floatView:t,uint32View:i,baseTable:r,shiftTable:s,mantissaTable:a,exponentTable:n,offsetTable:o}}function NP(e){Math.abs(e)>65504,e=wi(e,-65504,65504),Vs.floatView[0]=e;let t=Vs.uint32View[0],i=t>>23&511;return Vs.baseTable[i]+((t&8388607)>>Vs.shiftTable[i])}function VP(e){let t=e>>10;return Vs.uint32View[0]=Vs.mantissaTable[Vs.offsetTable[t]+(e&1023)]+Vs.exponentTable[t],Vs.floatView[0]}var jP=Object.freeze({__proto__:null,fromHalfFloat:VP,toHalfFloat:NP});typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:gl}}));typeof window<"u"&&(window.__THREE__||(window.__THREE__=gl));var Gl=".",f4=Symbol("target"),Hv=Symbol("unsubscribe");function c3(e){return e instanceof Date||e instanceof Set||e instanceof Map||e instanceof WeakSet||e instanceof WeakMap||ArrayBuffer.isView(e)}function GP(e){return(typeof e=="object"?e===null:typeof e!="function")||e instanceof RegExp}var is=Array.isArray;function m4(e){return typeof e=="symbol"}var HP={after:(e,t)=>is(e)?e.slice(t.length):t===""?e:e.slice(t.length+1),concat:(e,t)=>is(e)?(e=[...e],t&&e.push(t),e):t&&t.toString!==void 0?(e!==""&&(e+=Gl),m4(t)?e+t.toString():e+t):e,initial:e=>{if(is(e))return e.slice(0,-1);if(e==="")return e;let t=e.lastIndexOf(Gl);return t===-1?"":e.slice(0,t)},last:e=>{if(is(e))return e[e.length-1]||"";if(e==="")return e;let t=e.lastIndexOf(Gl);return t===-1?e:e.slice(t+1)},walk:(e,t)=>{if(is(e))for(let i of e)t(i);else if(e!==""){let i=0,r=e.indexOf(Gl);if(r===-1)t(e);else for(;i<e.length;)r===-1&&(r=e.length),t(e.slice(i,r)),i=r+1,r=e.indexOf(Gl,i)}},get(e,t){return this.walk(t,i=>{e&&(e=e[i])}),e}},ir=HP;function WP(e){return typeof e=="object"&&typeof e.next=="function"}function qP(e,t,i,r,s){let a=e.next;if(t.name==="entries")e.next=function(){let n=a.call(this);return n.done===!1&&(n.value[0]=s(n.value[0],t,n.value[0],r),n.value[1]=s(n.value[1],t,n.value[0],r)),n};else if(t.name==="values"){let n=i[f4].keys();e.next=function(){let o=a.call(this);return o.done===!1&&(o.value=s(o.value,t,n.next().value,r)),o}}else e.next=function(){let n=a.call(this);return n.done===!1&&(n.value=s(n.value,t,n.value,r)),n};return e}function g6(e,t,i){return e.isUnsubscribed||t.ignoreSymbols&&m4(i)||t.ignoreUnderscores&&i.charAt(0)==="_"||"ignoreKeys"in t&&t.ignoreKeys.includes(i)}var YP=class{constructor(e){this._equals=e,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return this._descriptorCache===void 0&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(e){let t=this._getDescriptorCache(),i=t.get(e);return i===void 0&&(i={},t.set(e,i)),i}_getOwnPropertyDescriptor(e,t){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(e,t);let i=this._getProperties(e),r=i[t];return r===void 0&&(r=Reflect.getOwnPropertyDescriptor(e,t),i[t]=r),r}getProxy(e,t,i,r){if(this.isUnsubscribed)return e;let s=e[r],a=s||e;this._pathCache.set(a,t);let n=this._proxyCache.get(a);return n===void 0&&(n=s===void 0?new Proxy(e,i):e,this._proxyCache.set(a,n)),n}getPath(e){return this.isUnsubscribed?void 0:this._pathCache.get(e)}isDetached(e,t){return!Object.is(e,ir.get(t,this.getPath(e)))}defineProperty(e,t,i){return Reflect.defineProperty(e,t,i)?(this.isUnsubscribed||(this._getProperties(e)[t]=i),!0):!1}setProperty(e,t,i,r,s){if(!this._equals(s,i)||!(t in e)){let a=this._getOwnPropertyDescriptor(e,t);return a!==void 0&&"set"in a?Reflect.set(e,t,i,r):Reflect.set(e,t,i)}return!0}deleteProperty(e,t,i){if(Reflect.deleteProperty(e,t)){if(!this.isUnsubscribed){let r=this._getDescriptorCache().get(e);r&&(delete r[t],this._pathCache.delete(i))}return!0}return!1}isSameDescriptor(e,t,i){let r=this._getOwnPropertyDescriptor(t,i);return e!==void 0&&r!==void 0&&Object.is(e.value,r.value)&&(e.writable||!1)===(r.writable||!1)&&(e.enumerable||!1)===(r.enumerable||!1)&&(e.configurable||!1)===(r.configurable||!1)&&e.get===r.get&&e.set===r.set}isGetInvariant(e,t){let i=this._getOwnPropertyDescriptor(e,t);return i!==void 0&&i.configurable!==!0&&i.writable!==!0}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function d3(e){return toString.call(e)==="[object Object]"}function Qh(){return!0}function lo(e,t){return e.length!==t.length||e.some((i,r)=>t[r]!==i)}var Wv=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),XP=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),qv={push:Qh,pop:Qh,shift:Qh,unshift:Qh,copyWithin:lo,reverse:lo,sort:lo,splice:lo,flat:lo,fill:lo},QP=new Set([...Wv,...XP,...Object.keys(qv)]);function Zh(e,t){if(e.size!==t.size)return!0;for(let i of e)if(!t.has(i))return!0;return!1}var Yv=["keys","values","entries"],Xv=new Set(["has","toString"]),Qv={add:Zh,clear:Zh,delete:Zh,forEach:Zh},ZP=new Set([...Xv,...Object.keys(Qv),...Yv]);function Kh(e,t){if(e.size!==t.size)return!0;let i;for(let[r,s]of e)if(i=t.get(r),i!==s||i===void 0&&!t.has(r))return!0;return!1}var KP=new Set([...Xv,"get"]),Zv={set:Kh,clear:Kh,delete:Kh,forEach:Kh},JP=new Set([...KP,...Object.keys(Zv),...Yv]),Ha=class{constructor(e,t,i,r){this._path=t,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=r,this._changes=r?[]:null,this.clone=t===void 0?e:this._shallowClone(e)}static isHandledMethod(e){return Wv.has(e)}_shallowClone(e){let t=e;if(d3(e))t={...e};else if(is(e))t=[...e];else if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set([...e].map(i=>this._shallowClone(i)));else if(e instanceof Map){t=new Map;for(let[i,r]of e.entries())t.set(i,this._shallowClone(r))}return this._clonedCache.add(t),t}preferredThisArg(e,t,i,r){return e?(is(r)?this._onIsChanged=qv[t]:r instanceof Set?this._onIsChanged=Qv[t]:r instanceof Map&&(this._onIsChanged=Zv[t]),r):i}update(e,t,i){let r=ir.after(e,this._path);if(t!=="length"){let s=this.clone;ir.walk(r,a=>{s&&s[a]&&(this._clonedCache.has(s[a])||(s[a]=this._shallowClone(s[a])),s=s[a])}),this._hasOnValidate&&this._changes.push({path:r,property:t,previous:i}),s&&s[t]&&(s[t]=i)}this._isChanged=!0}undo(e){let t;for(let i=this._changes.length-1;i!==-1;i--)t=this._changes[i],ir.get(e,t.path)[t.property]=t.previous}isChanged(e){return this._onIsChanged===void 0?this._isChanged:this._onIsChanged(this.clone,e)}},v6=class extends Ha{static isHandledMethod(e){return QP.has(e)}},$P=class extends Ha{undo(e){e.setTime(this.clone.getTime())}isChanged(e,t){return!t(this.clone.valueOf(),e.valueOf())}},y6=class extends Ha{static isHandledMethod(e){return ZP.has(e)}undo(e){for(let t of this.clone)e.add(t);for(let t of e)this.clone.has(t)||e.delete(t)}},x6=class extends Ha{static isHandledMethod(e){return JP.has(e)}undo(e){for(let[t,i]of this.clone.entries())e.set(t,i);for(let t of e.keys())this.clone.has(t)||e.delete(t)}},eD=class extends Ha{constructor(e,t,i,r){super(void 0,t,i,r),this._arg1=i[0],this._weakValue=e.has(this._arg1)}isChanged(e){return this._weakValue!==e.has(this._arg1)}undo(e){this._weakValue&&!e.has(this._arg1)?e.add(this._arg1):e.delete(this._arg1)}},tD=class extends Ha{constructor(e,t,i,r){super(void 0,t,i,r),this._weakKey=i[0],this._weakHas=e.has(this._weakKey),this._weakValue=e.get(this._weakKey)}isChanged(e){return this._weakValue!==e.get(this._weakKey)}undo(e){let t=e.has(this._weakKey);this._weakHas&&!t?e.set(this._weakKey,this._weakValue):!this._weakHas&&t?e.delete(this._weakKey):this._weakValue!==e.get(this._weakKey)&&e.set(this._weakKey,this._weakValue)}},To=class{constructor(e){this._stack=[],this._hasOnValidate=e}static isHandledType(e){return d3(e)||is(e)||c3(e)}static isHandledMethod(e,t){return d3(e)?Ha.isHandledMethod(t):is(e)?v6.isHandledMethod(t):e instanceof Set?y6.isHandledMethod(t):e instanceof Map?x6.isHandledMethod(t):c3(e)}get isCloning(){return this._stack.length>0}start(e,t,i){let r=Ha;is(e)?r=v6:e instanceof Date?r=$P:e instanceof Set?r=y6:e instanceof Map?r=x6:e instanceof WeakSet?r=eD:e instanceof WeakMap&&(r=tD),this._stack.push(new r(e,t,i,this._hasOnValidate))}update(e,t,i){this._stack[this._stack.length-1].update(e,t,i)}preferredThisArg(e,t,i){let{name:r}=e,s=To.isHandledMethod(i,r);return this._stack[this._stack.length-1].preferredThisArg(s,r,t,i)}isChanged(e,t,i){return this._stack[this._stack.length-1].isChanged(e,t,i)}undo(e){this._previousClone!==void 0&&this._previousClone.undo(e)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},iD={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},g4=(e,t,i={})=>{i={...iD,...i};let r=Symbol("ProxyTarget"),{equals:s,isShallow:a,ignoreDetached:n,details:o}=i,l=new YP(s),h=typeof i.onValidate=="function",c=new To(h),d=(y,x,w,_,b)=>!h||c.isCloning||i.onValidate(ir.concat(l.getPath(y),x),w,_,b)===!0,u=(y,x,w,_)=>{!g6(l,i,x)&&!(n&&l.isDetached(y,e))&&p(l.getPath(y),x,w,_)},p=(y,x,w,_,b)=>{c.isCloning?c.update(y,x,_):t(ir.concat(y,x),w,_,b)},f=y=>y&&(y[r]||y),g=(y,x,w,_)=>GP(y)||w==="constructor"||a&&!To.isHandledMethod(x,w)||g6(l,i,w)||l.isGetInvariant(x,w)||n&&l.isDetached(x,e)?y:(_===void 0&&(_=l.getPath(x)),l.getProxy(y,ir.concat(_,w),m,r)),m={get(y,x,w){if(m4(x)){if(x===r||x===f4)return y;if(x===Hv&&!l.isUnsubscribed&&l.getPath(y).length===0)return l.unsubscribe(),y}let _=c3(y)?Reflect.get(y,x):Reflect.get(y,x,w);return g(_,y,x)},set(y,x,w,_){w=f(w);let b=y[r]||y,A=b[x];if(s(A,w)&&x in y)return!0;let S=d(y,x,w,A);return S&&l.setProperty(b,x,w,_,A)?(u(y,x,y[x],A),!0):!S},defineProperty(y,x,w){if(!l.isSameDescriptor(w,y,x)){let _=y[x];d(y,x,w.value,_)&&l.defineProperty(y,x,w,_)&&u(y,x,w.value,_)}return!0},deleteProperty(y,x){if(!Reflect.has(y,x))return!0;let w=Reflect.get(y,x),_=d(y,x,void 0,w);return _&&l.deleteProperty(y,x,w)?(u(y,x,void 0,w),!0):!_},apply(y,x,w){let _=x[r]||x;if(l.isUnsubscribed)return Reflect.apply(y,_,w);if((o===!1||o!==!0&&!o.includes(y.name))&&To.isHandledType(_)){let b=ir.initial(l.getPath(y)),A=To.isHandledMethod(_,y.name);c.start(_,b,w);let S=Reflect.apply(y,c.preferredThisArg(y,x,_),A?w.map(T=>f(T)):w),M=c.isChanged(_,s),C=c.stop();if(To.isHandledType(S)&&A&&(x instanceof Map&&y.name==="get"&&(b=ir.concat(b,w[0])),S=l.getProxy(S,b,m)),M){let T={name:y.name,args:w,result:S},P=c.isCloning?ir.initial(b):b,I=c.isCloning?ir.last(b):"";d(ir.get(e,P),I,_,C,T)?p(P,I,_,C,T):c.undo(_)}return(x instanceof Map||x instanceof Set)&&WP(S)?qP(S,y,x,b,g):S}return Reflect.apply(y,x,w)}},v=l.getProxy(e,i.pathAsArray?[]:"",m);return t=t.bind(v),h&&(i.onValidate=i.onValidate.bind(v)),v};g4.target=e=>e&&e[f4]||e;g4.unsubscribe=e=>e[Hv]||e;var b6=g4,rD=typeof global=="object"&&global&&global.Object===Object&&global,Kv=rD,sD=typeof self=="object"&&self&&self.Object===Object&&self,aD=Kv||sD||Function("return this")(),zr=aD,nD=zr.Symbol,dr=nD,Jv=Object.prototype,oD=Jv.hasOwnProperty,lD=Jv.toString,Hl=dr?dr.toStringTag:void 0;function hD(e){var t=oD.call(e,Hl),i=e[Hl];try{e[Hl]=void 0;var r=!0}catch{}var s=lD.call(e);return r&&(t?e[Hl]=i:delete e[Hl]),s}var cD=hD,dD=Object.prototype,uD=dD.toString;function pD(e){return uD.call(e)}var fD=pD,mD="[object Null]",gD="[object Undefined]",w6=dr?dr.toStringTag:void 0;function vD(e){return e==null?e===void 0?gD:mD:w6&&w6 in Object(e)?cD(e):fD(e)}var jn=vD;function yD(e){return e!=null&&typeof e=="object"}var ea=yD,xD="[object Symbol]";function bD(e){return typeof e=="symbol"||ea(e)&&jn(e)==xD}var lh=bD;function wD(e,t){for(var i=-1,r=e==null?0:e.length,s=Array(r);++i<r;)s[i]=t(e[i],i,e);return s}var $v=wD,SD=Array.isArray,us=SD,_D=1/0,S6=dr?dr.prototype:void 0,_6=S6?S6.toString:void 0;function ey(e){if(typeof e=="string")return e;if(us(e))return $v(e,ey)+"";if(lh(e))return _6?_6.call(e):"";var t=e+"";return t=="0"&&1/e==-_D?"-0":t}var AD=ey,MD=/\s/;function ED(e){for(var t=e.length;t--&&MD.test(e.charAt(t)););return t}var CD=ED,TD=/^\s+/;function PD(e){return e&&e.slice(0,CD(e)+1).replace(TD,"")}var DD=PD;function ID(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Br=ID,A6=NaN,OD=/^[-+]0x[0-9a-f]+$/i,RD=/^0b[01]+$/i,LD=/^0o[0-7]+$/i,BD=parseInt;function zD(e){if(typeof e=="number")return e;if(lh(e))return A6;if(Br(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Br(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=DD(e);var i=RD.test(e);return i||LD.test(e)?BD(e.slice(2),i?2:8):OD.test(e)?A6:+e}var M6=zD;function FD(e){return e}var ty=FD,kD="[object AsyncFunction]",UD="[object Function]",ND="[object GeneratorFunction]",VD="[object Proxy]";function jD(e){if(!Br(e))return!1;var t=jn(e);return t==UD||t==ND||t==kD||t==VD}var iy=jD,GD=zr["__core-js_shared__"],Tu=GD,E6=function(){var e=/[^.]+$/.exec(Tu&&Tu.keys&&Tu.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function HD(e){return!!E6&&E6 in e}var WD=HD,qD=Function.prototype,YD=qD.toString;function XD(e){if(e!=null){try{return YD.call(e)}catch{}try{return e+""}catch{}}return""}var Gn=XD,QD=/[\\^$.*+?()[\]{}|]/g,ZD=/^\[object .+?Constructor\]$/,KD=Function.prototype,JD=Object.prototype,$D=KD.toString,eI=JD.hasOwnProperty,tI=RegExp("^"+$D.call(eI).replace(QD,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function iI(e){if(!Br(e)||WD(e))return!1;var t=iy(e)?tI:ZD;return t.test(Gn(e))}var rI=iI;function sI(e,t){return e==null?void 0:e[t]}var aI=sI;function nI(e,t){var i=aI(e,t);return rI(i)?i:void 0}var Hn=nI,oI=Hn(zr,"WeakMap"),u3=oI,C6=Object.create,lI=function(){function e(){}return function(t){if(!Br(t))return{};if(C6)return C6(t);e.prototype=t;var i=new e;return e.prototype=void 0,i}}(),hI=lI;function cI(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}var dI=cI;function uI(e,t){var i=-1,r=e.length;for(t||(t=Array(r));++i<r;)t[i]=e[i];return t}var pI=uI,fI=800,mI=16,gI=Date.now;function vI(e){var t=0,i=0;return function(){var r=gI(),s=mI-(r-i);if(i=r,s>0){if(++t>=fI)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var yI=vI;function xI(e){return function(){return e}}var bI=xI,wI=function(){try{var e=Hn(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Sc=wI,SI=Sc?function(e,t){return Sc(e,"toString",{configurable:!0,enumerable:!1,value:bI(t),writable:!0})}:ty,_I=SI,AI=yI(_I),MI=AI;function EI(e,t){for(var i=-1,r=e==null?0:e.length;++i<r&&t(e[i],i,e)!==!1;);return e}var CI=EI,TI=9007199254740991,PI=/^(?:0|[1-9]\d*)$/;function DI(e,t){var i=typeof e;return t=t??TI,!!t&&(i=="number"||i!="symbol"&&PI.test(e))&&e>-1&&e%1==0&&e<t}var v4=DI;function II(e,t,i){t=="__proto__"&&Sc?Sc(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}var ry=II;function OI(e,t){return e===t||e!==e&&t!==t}var y4=OI,RI=Object.prototype,LI=RI.hasOwnProperty;function BI(e,t,i){var r=e[t];(!(LI.call(e,t)&&y4(r,i))||i===void 0&&!(t in e))&&ry(e,t,i)}var x4=BI;function zI(e,t,i,r){var s=!i;i||(i={});for(var a=-1,n=t.length;++a<n;){var o=t[a],l=r?r(i[o],e[o],o,i,e):void 0;l===void 0&&(l=e[o]),s?ry(i,o,l):x4(i,o,l)}return i}var hh=zI,T6=Math.max;function FI(e,t,i){return t=T6(t===void 0?e.length-1:t,0),function(){for(var r=arguments,s=-1,a=T6(r.length-t,0),n=Array(a);++s<a;)n[s]=r[t+s];s=-1;for(var o=Array(t+1);++s<t;)o[s]=r[s];return o[t]=i(n),dI(e,this,o)}}var kI=FI,UI=9007199254740991;function NI(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=UI}var b4=NI;function VI(e){return e!=null&&b4(e.length)&&!iy(e)}var sy=VI,jI=Object.prototype;function GI(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||jI;return e===i}var w4=GI;function HI(e,t){for(var i=-1,r=Array(e);++i<e;)r[i]=t(i);return r}var WI=HI,qI="[object Arguments]";function YI(e){return ea(e)&&jn(e)==qI}var P6=YI,ay=Object.prototype,XI=ay.hasOwnProperty,QI=ay.propertyIsEnumerable,ZI=P6(function(){return arguments}())?P6:function(e){return ea(e)&&XI.call(e,"callee")&&!QI.call(e,"callee")},S4=ZI;function KI(){return!1}var JI=KI,ny=typeof exports=="object"&&exports&&!exports.nodeType&&exports,D6=ny&&typeof module=="object"&&module&&!module.nodeType&&module,$I=D6&&D6.exports===ny,I6=$I?zr.Buffer:void 0,eO=I6?I6.isBuffer:void 0,tO=eO||JI,_c=tO,iO="[object Arguments]",rO="[object Array]",sO="[object Boolean]",aO="[object Date]",nO="[object Error]",oO="[object Function]",lO="[object Map]",hO="[object Number]",cO="[object Object]",dO="[object RegExp]",uO="[object Set]",pO="[object String]",fO="[object WeakMap]",mO="[object ArrayBuffer]",gO="[object DataView]",vO="[object Float32Array]",yO="[object Float64Array]",xO="[object Int8Array]",bO="[object Int16Array]",wO="[object Int32Array]",SO="[object Uint8Array]",_O="[object Uint8ClampedArray]",AO="[object Uint16Array]",MO="[object Uint32Array]",$t={};$t[vO]=$t[yO]=$t[xO]=$t[bO]=$t[wO]=$t[SO]=$t[_O]=$t[AO]=$t[MO]=!0;$t[iO]=$t[rO]=$t[mO]=$t[sO]=$t[gO]=$t[aO]=$t[nO]=$t[oO]=$t[lO]=$t[hO]=$t[cO]=$t[dO]=$t[uO]=$t[pO]=$t[fO]=!1;function EO(e){return ea(e)&&b4(e.length)&&!!$t[jn(e)]}var CO=EO;function TO(e){return function(t){return e(t)}}var _4=TO,oy=typeof exports=="object"&&exports&&!exports.nodeType&&exports,_2=oy&&typeof module=="object"&&module&&!module.nodeType&&module,PO=_2&&_2.exports===oy,Pu=PO&&Kv.process,DO=function(){try{var e=_2&&_2.require&&_2.require("util").types;return e||Pu&&Pu.binding&&Pu.binding("util")}catch{}}(),sl=DO,O6=sl&&sl.isTypedArray,IO=O6?_4(O6):CO,ly=IO,OO=Object.prototype,RO=OO.hasOwnProperty;function LO(e,t){var i=us(e),r=!i&&S4(e),s=!i&&!r&&_c(e),a=!i&&!r&&!s&&ly(e),n=i||r||s||a,o=n?WI(e.length,String):[],l=o.length;for(var h in e)(t||RO.call(e,h))&&!(n&&(h=="length"||s&&(h=="offset"||h=="parent")||a&&(h=="buffer"||h=="byteLength"||h=="byteOffset")||v4(h,l)))&&o.push(h);return o}var hy=LO;function BO(e,t){return function(i){return e(t(i))}}var cy=BO,zO=cy(Object.keys,Object),FO=zO,kO=Object.prototype,UO=kO.hasOwnProperty;function NO(e){if(!w4(e))return FO(e);var t=[];for(var i in Object(e))UO.call(e,i)&&i!="constructor"&&t.push(i);return t}var VO=NO;function jO(e){return sy(e)?hy(e):VO(e)}var A4=jO;function GO(e){var t=[];if(e!=null)for(var i in Object(e))t.push(i);return t}var HO=GO,WO=Object.prototype,qO=WO.hasOwnProperty;function YO(e){if(!Br(e))return HO(e);var t=w4(e),i=[];for(var r in e)r=="constructor"&&(t||!qO.call(e,r))||i.push(r);return i}var XO=YO;function QO(e){return sy(e)?hy(e,!0):XO(e)}var vn=QO,ZO=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,KO=/^\w*$/;function JO(e,t){if(us(e))return!1;var i=typeof e;return i=="number"||i=="symbol"||i=="boolean"||e==null||lh(e)?!0:KO.test(e)||!ZO.test(e)||t!=null&&e in Object(t)}var $O=JO,eR=Hn(Object,"create"),k2=eR;function tR(){this.__data__=k2?k2(null):{},this.size=0}var iR=tR;function rR(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var sR=rR,aR="__lodash_hash_undefined__",nR=Object.prototype,oR=nR.hasOwnProperty;function lR(e){var t=this.__data__;if(k2){var i=t[e];return i===aR?void 0:i}return oR.call(t,e)?t[e]:void 0}var hR=lR,cR=Object.prototype,dR=cR.hasOwnProperty;function uR(e){var t=this.__data__;return k2?t[e]!==void 0:dR.call(t,e)}var pR=uR,fR="__lodash_hash_undefined__";function mR(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=k2&&t===void 0?fR:t,this}var gR=mR;function Sl(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}Sl.prototype.clear=iR;Sl.prototype.delete=sR;Sl.prototype.get=hR;Sl.prototype.has=pR;Sl.prototype.set=gR;var R6=Sl;function vR(){this.__data__=[],this.size=0}var yR=vR;function xR(e,t){for(var i=e.length;i--;)if(y4(e[i][0],t))return i;return-1}var yd=xR,bR=Array.prototype,wR=bR.splice;function SR(e){var t=this.__data__,i=yd(t,e);if(i<0)return!1;var r=t.length-1;return i==r?t.pop():wR.call(t,i,1),--this.size,!0}var _R=SR;function AR(e){var t=this.__data__,i=yd(t,e);return i<0?void 0:t[i][1]}var MR=AR;function ER(e){return yd(this.__data__,e)>-1}var CR=ER;function TR(e,t){var i=this.__data__,r=yd(i,e);return r<0?(++this.size,i.push([e,t])):i[r][1]=t,this}var PR=TR;function _l(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}_l.prototype.clear=yR;_l.prototype.delete=_R;_l.prototype.get=MR;_l.prototype.has=CR;_l.prototype.set=PR;var xd=_l,DR=Hn(zr,"Map"),U2=DR;function IR(){this.size=0,this.__data__={hash:new R6,map:new(U2||xd),string:new R6}}var OR=IR;function RR(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var LR=RR;function BR(e,t){var i=e.__data__;return LR(t)?i[typeof t=="string"?"string":"hash"]:i.map}var bd=BR;function zR(e){var t=bd(this,e).delete(e);return this.size-=t?1:0,t}var FR=zR;function kR(e){return bd(this,e).get(e)}var UR=kR;function NR(e){return bd(this,e).has(e)}var VR=NR;function jR(e,t){var i=bd(this,e),r=i.size;return i.set(e,t),this.size+=i.size==r?0:1,this}var GR=jR;function Al(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}Al.prototype.clear=OR;Al.prototype.delete=FR;Al.prototype.get=UR;Al.prototype.has=VR;Al.prototype.set=GR;var wd=Al,HR="Expected a function";function M4(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(HR);var i=function(){var r=arguments,s=t?t.apply(this,r):r[0],a=i.cache;if(a.has(s))return a.get(s);var n=e.apply(this,r);return i.cache=a.set(s,n)||a,n};return i.cache=new(M4.Cache||wd),i}M4.Cache=wd;var WR=M4,qR=500;function YR(e){var t=WR(e,function(r){return i.size===qR&&i.clear(),r}),i=t.cache;return t}var XR=YR,QR=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ZR=/\\(\\)?/g,KR=XR(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(QR,function(i,r,s,a){t.push(s?a.replace(ZR,"$1"):r||i)}),t}),JR=KR;function $R(e){return e==null?"":AD(e)}var eL=$R;function tL(e,t){return us(e)?e:$O(e,t)?[e]:JR(eL(e))}var Ml=tL,iL=1/0;function rL(e){if(typeof e=="string"||lh(e))return e;var t=e+"";return t=="0"&&1/e==-iL?"-0":t}var Sd=rL;function sL(e,t){t=Ml(t,e);for(var i=0,r=t.length;e!=null&&i<r;)e=e[Sd(t[i++])];return i&&i==r?e:void 0}var dy=sL;function aL(e,t){for(var i=-1,r=t.length,s=e.length;++i<r;)e[s+i]=t[i];return e}var E4=aL,L6=dr?dr.isConcatSpreadable:void 0;function nL(e){return us(e)||S4(e)||!!(L6&&e&&e[L6])}var oL=nL;function uy(e,t,i,r,s){var a=-1,n=e.length;for(i||(i=oL),s||(s=[]);++a<n;){var o=e[a];t>0&&i(o)?t>1?uy(o,t-1,i,r,s):E4(s,o):r||(s[s.length]=o)}return s}var lL=uy;function hL(e){var t=e==null?0:e.length;return t?lL(e,1):[]}var cL=hL;function dL(e){return MI(kI(e,void 0,cL),e+"")}var py=dL,uL=cy(Object.getPrototypeOf,Object),C4=uL,pL="[object Object]",fL=Function.prototype,mL=Object.prototype,fy=fL.toString,gL=mL.hasOwnProperty,vL=fy.call(Object);function yL(e){if(!ea(e)||jn(e)!=pL)return!1;var t=C4(e);if(t===null)return!0;var i=gL.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i instanceof i&&fy.call(i)==vL}var xL=yL;function bL(e,t,i){var r=-1,s=e.length;t<0&&(t=-t>s?0:s+t),i=i>s?s:i,i<0&&(i+=s),s=t>i?0:i-t>>>0,t>>>=0;for(var a=Array(s);++r<s;)a[r]=e[r+t];return a}var wL=bL;function SL(){this.__data__=new xd,this.size=0}var _L=SL;function AL(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}var ML=AL;function EL(e){return this.__data__.get(e)}var CL=EL;function TL(e){return this.__data__.has(e)}var PL=TL,DL=200;function IL(e,t){var i=this.__data__;if(i instanceof xd){var r=i.__data__;if(!U2||r.length<DL-1)return r.push([e,t]),this.size=++i.size,this;i=this.__data__=new wd(r)}return i.set(e,t),this.size=i.size,this}var OL=IL;function El(e){var t=this.__data__=new xd(e);this.size=t.size}El.prototype.clear=_L;El.prototype.delete=ML;El.prototype.get=CL;El.prototype.has=PL;El.prototype.set=OL;var Y0=El;function RL(e,t){return e&&hh(t,A4(t),e)}var LL=RL;function BL(e,t){return e&&hh(t,vn(t),e)}var zL=BL,my=typeof exports=="object"&&exports&&!exports.nodeType&&exports,B6=my&&typeof module=="object"&&module&&!module.nodeType&&module,FL=B6&&B6.exports===my,z6=FL?zr.Buffer:void 0,F6=z6?z6.allocUnsafe:void 0;function kL(e,t){if(t)return e.slice();var i=e.length,r=F6?F6(i):new e.constructor(i);return e.copy(r),r}var UL=kL;function NL(e,t){for(var i=-1,r=e==null?0:e.length,s=0,a=[];++i<r;){var n=e[i];t(n,i,e)&&(a[s++]=n)}return a}var VL=NL;function jL(){return[]}var gy=jL,GL=Object.prototype,HL=GL.propertyIsEnumerable,k6=Object.getOwnPropertySymbols,WL=k6?function(e){return e==null?[]:(e=Object(e),VL(k6(e),function(t){return HL.call(e,t)}))}:gy,T4=WL;function qL(e,t){return hh(e,T4(e),t)}var YL=qL,XL=Object.getOwnPropertySymbols,QL=XL?function(e){for(var t=[];e;)E4(t,T4(e)),e=C4(e);return t}:gy,vy=QL;function ZL(e,t){return hh(e,vy(e),t)}var KL=ZL;function JL(e,t,i){var r=t(e);return us(e)?r:E4(r,i(e))}var yy=JL;function $L(e){return yy(e,A4,T4)}var p3=$L;function eB(e){return yy(e,vn,vy)}var xy=eB,tB=Hn(zr,"DataView"),f3=tB,iB=Hn(zr,"Promise"),m3=iB,rB=Hn(zr,"Set"),g3=rB,U6="[object Map]",sB="[object Object]",N6="[object Promise]",V6="[object Set]",j6="[object WeakMap]",G6="[object DataView]",aB=Gn(f3),nB=Gn(U2),oB=Gn(m3),lB=Gn(g3),hB=Gn(u3),ln=jn;(f3&&ln(new f3(new ArrayBuffer(1)))!=G6||U2&&ln(new U2)!=U6||m3&&ln(m3.resolve())!=N6||g3&&ln(new g3)!=V6||u3&&ln(new u3)!=j6)&&(ln=function(e){var t=jn(e),i=t==sB?e.constructor:void 0,r=i?Gn(i):"";if(r)switch(r){case aB:return G6;case nB:return U6;case oB:return N6;case lB:return V6;case hB:return j6}return t});var N2=ln,cB=Object.prototype,dB=cB.hasOwnProperty;function uB(e){var t=e.length,i=new e.constructor(t);return t&&typeof e[0]=="string"&&dB.call(e,"index")&&(i.index=e.index,i.input=e.input),i}var pB=uB,fB=zr.Uint8Array,Ac=fB;function mB(e){var t=new e.constructor(e.byteLength);return new Ac(t).set(new Ac(e)),t}var P4=mB;function gB(e,t){var i=t?P4(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}var vB=gB,yB=/\w*$/;function xB(e){var t=new e.constructor(e.source,yB.exec(e));return t.lastIndex=e.lastIndex,t}var bB=xB,H6=dr?dr.prototype:void 0,W6=H6?H6.valueOf:void 0;function wB(e){return W6?Object(W6.call(e)):{}}var SB=wB;function _B(e,t){var i=t?P4(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}var AB=_B,MB="[object Boolean]",EB="[object Date]",CB="[object Map]",TB="[object Number]",PB="[object RegExp]",DB="[object Set]",IB="[object String]",OB="[object Symbol]",RB="[object ArrayBuffer]",LB="[object DataView]",BB="[object Float32Array]",zB="[object Float64Array]",FB="[object Int8Array]",kB="[object Int16Array]",UB="[object Int32Array]",NB="[object Uint8Array]",VB="[object Uint8ClampedArray]",jB="[object Uint16Array]",GB="[object Uint32Array]";function HB(e,t,i){var r=e.constructor;switch(t){case RB:return P4(e);case MB:case EB:return new r(+e);case LB:return vB(e,i);case BB:case zB:case FB:case kB:case UB:case NB:case VB:case jB:case GB:return AB(e,i);case CB:return new r;case TB:case IB:return new r(e);case PB:return bB(e);case DB:return new r;case OB:return SB(e)}}var WB=HB;function qB(e){return typeof e.constructor=="function"&&!w4(e)?hI(C4(e)):{}}var YB=qB,XB="[object Map]";function QB(e){return ea(e)&&N2(e)==XB}var ZB=QB,q6=sl&&sl.isMap,KB=q6?_4(q6):ZB,JB=KB,$B="[object Set]";function ez(e){return ea(e)&&N2(e)==$B}var tz=ez,Y6=sl&&sl.isSet,iz=Y6?_4(Y6):tz,rz=iz,sz=1,az=2,nz=4,by="[object Arguments]",oz="[object Array]",lz="[object Boolean]",hz="[object Date]",cz="[object Error]",wy="[object Function]",dz="[object GeneratorFunction]",uz="[object Map]",pz="[object Number]",Sy="[object Object]",fz="[object RegExp]",mz="[object Set]",gz="[object String]",vz="[object Symbol]",yz="[object WeakMap]",xz="[object ArrayBuffer]",bz="[object DataView]",wz="[object Float32Array]",Sz="[object Float64Array]",_z="[object Int8Array]",Az="[object Int16Array]",Mz="[object Int32Array]",Ez="[object Uint8Array]",Cz="[object Uint8ClampedArray]",Tz="[object Uint16Array]",Pz="[object Uint32Array]",Zt={};Zt[by]=Zt[oz]=Zt[xz]=Zt[bz]=Zt[lz]=Zt[hz]=Zt[wz]=Zt[Sz]=Zt[_z]=Zt[Az]=Zt[Mz]=Zt[uz]=Zt[pz]=Zt[Sy]=Zt[fz]=Zt[mz]=Zt[gz]=Zt[vz]=Zt[Ez]=Zt[Cz]=Zt[Tz]=Zt[Pz]=!0;Zt[cz]=Zt[wy]=Zt[yz]=!1;function X0(e,t,i,r,s,a){var n,o=t&sz,l=t&az,h=t&nz;if(i&&(n=s?i(e,r,s,a):i(e)),n!==void 0)return n;if(!Br(e))return e;var c=us(e);if(c){if(n=pB(e),!o)return pI(e,n)}else{var d=N2(e),u=d==wy||d==dz;if(_c(e))return UL(e,o);if(d==Sy||d==by||u&&!s){if(n=l||u?{}:YB(e),!o)return l?KL(e,zL(n,e)):YL(e,LL(n,e))}else{if(!Zt[d])return s?e:{};n=WB(e,d,o)}}a||(a=new Y0);var p=a.get(e);if(p)return p;a.set(e,n),rz(e)?e.forEach(function(m){n.add(X0(m,t,i,m,e,a))}):JB(e)&&e.forEach(function(m,v){n.set(v,X0(m,t,i,v,e,a))});var f=h?l?xy:p3:l?vn:A4,g=c?void 0:f(e);return CI(g||e,function(m,v){g&&(v=m,m=e[v]),x4(n,v,X0(m,t,i,v,e,a))}),n}var _y=X0,Dz=1,Iz=4;function Oz(e){return _y(e,Dz|Iz)}var _d=Oz,Rz="__lodash_hash_undefined__";function Lz(e){return this.__data__.set(e,Rz),this}var Bz=Lz;function zz(e){return this.__data__.has(e)}var Fz=zz;function Mc(e){var t=-1,i=e==null?0:e.length;for(this.__data__=new wd;++t<i;)this.add(e[t])}Mc.prototype.add=Mc.prototype.push=Bz;Mc.prototype.has=Fz;var kz=Mc;function Uz(e,t){for(var i=-1,r=e==null?0:e.length;++i<r;)if(t(e[i],i,e))return!0;return!1}var Nz=Uz;function Vz(e,t){return e.has(t)}var jz=Vz,Gz=1,Hz=2;function Wz(e,t,i,r,s,a){var n=i&Gz,o=e.length,l=t.length;if(o!=l&&!(n&&l>o))return!1;var h=a.get(e),c=a.get(t);if(h&&c)return h==t&&c==e;var d=-1,u=!0,p=i&Hz?new kz:void 0;for(a.set(e,t),a.set(t,e);++d<o;){var f=e[d],g=t[d];if(r)var m=n?r(g,f,d,t,e,a):r(f,g,d,e,t,a);if(m!==void 0){if(m)continue;u=!1;break}if(p){if(!Nz(t,function(v,y){if(!jz(p,y)&&(f===v||s(f,v,i,r,a)))return p.push(y)})){u=!1;break}}else if(!(f===g||s(f,g,i,r,a))){u=!1;break}}return a.delete(e),a.delete(t),u}var Ay=Wz;function qz(e){var t=-1,i=Array(e.size);return e.forEach(function(r,s){i[++t]=[s,r]}),i}var Yz=qz;function Xz(e){var t=-1,i=Array(e.size);return e.forEach(function(r){i[++t]=r}),i}var Qz=Xz,Zz=1,Kz=2,Jz="[object Boolean]",$z="[object Date]",eF="[object Error]",tF="[object Map]",iF="[object Number]",rF="[object RegExp]",sF="[object Set]",aF="[object String]",nF="[object Symbol]",oF="[object ArrayBuffer]",lF="[object DataView]",X6=dr?dr.prototype:void 0,Du=X6?X6.valueOf:void 0;function hF(e,t,i,r,s,a,n){switch(i){case lF:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case oF:return!(e.byteLength!=t.byteLength||!a(new Ac(e),new Ac(t)));case Jz:case $z:case iF:return y4(+e,+t);case eF:return e.name==t.name&&e.message==t.message;case rF:case aF:return e==t+"";case tF:var o=Yz;case sF:var l=r&Zz;if(o||(o=Qz),e.size!=t.size&&!l)return!1;var h=n.get(e);if(h)return h==t;r|=Kz,n.set(e,t);var c=Ay(o(e),o(t),r,s,a,n);return n.delete(e),c;case nF:if(Du)return Du.call(e)==Du.call(t)}return!1}var cF=hF,dF=1,uF=Object.prototype,pF=uF.hasOwnProperty;function fF(e,t,i,r,s,a){var n=i&dF,o=p3(e),l=o.length,h=p3(t),c=h.length;if(l!=c&&!n)return!1;for(var d=l;d--;){var u=o[d];if(!(n?u in t:pF.call(t,u)))return!1}var p=a.get(e),f=a.get(t);if(p&&f)return p==t&&f==e;var g=!0;a.set(e,t),a.set(t,e);for(var m=n;++d<l;){u=o[d];var v=e[u],y=t[u];if(r)var x=n?r(y,v,u,t,e,a):r(v,y,u,e,t,a);if(!(x===void 0?v===y||s(v,y,i,r,a):x)){g=!1;break}m||(m=u=="constructor")}if(g&&!m){var w=e.constructor,_=t.constructor;w!=_&&"constructor"in e&&"constructor"in t&&!(typeof w=="function"&&w instanceof w&&typeof _=="function"&&_ instanceof _)&&(g=!1)}return a.delete(e),a.delete(t),g}var mF=fF,gF=1,Q6="[object Arguments]",Z6="[object Array]",Jh="[object Object]",vF=Object.prototype,K6=vF.hasOwnProperty;function yF(e,t,i,r,s,a){var n=us(e),o=us(t),l=n?Z6:N2(e),h=o?Z6:N2(t);l=l==Q6?Jh:l,h=h==Q6?Jh:h;var c=l==Jh,d=h==Jh,u=l==h;if(u&&_c(e)){if(!_c(t))return!1;n=!0,c=!1}if(u&&!c)return a||(a=new Y0),n||ly(e)?Ay(e,t,i,r,s,a):cF(e,t,l,i,r,s,a);if(!(i&gF)){var p=c&&K6.call(e,"__wrapped__"),f=d&&K6.call(t,"__wrapped__");if(p||f){var g=p?e.value():e,m=f?t.value():t;return a||(a=new Y0),s(g,m,i,r,a)}}return u?(a||(a=new Y0),mF(e,t,i,r,s,a)):!1}var xF=yF;function My(e,t,i,r,s){return e===t?!0:e==null||t==null||!ea(e)&&!ea(t)?e!==e&&t!==t:xF(e,t,i,r,My,s)}var bF=My;function wF(e,t){return e!=null&&t in Object(e)}var SF=wF;function _F(e,t,i){t=Ml(t,e);for(var r=-1,s=t.length,a=!1;++r<s;){var n=Sd(t[r]);if(!(a=e!=null&&i(e,n)))break;e=e[n]}return a||++r!=s?a:(s=e==null?0:e.length,!!s&&b4(s)&&v4(n,s)&&(us(e)||S4(e)))}var AF=_F;function MF(e,t){return e!=null&&AF(e,t,SF)}var EF=MF,CF=function(){return zr.Date.now()},Iu=CF,TF="Expected a function",PF=Math.max,DF=Math.min;function IF(e,t,i){var r,s,a,n,o,l,h=0,c=!1,d=!1,u=!0;if(typeof e!="function")throw new TypeError(TF);t=M6(t)||0,Br(i)&&(c=!!i.leading,d="maxWait"in i,a=d?PF(M6(i.maxWait)||0,t):a,u="trailing"in i?!!i.trailing:u);function p(b){var A=r,S=s;return r=s=void 0,h=b,n=e.apply(S,A),n}function f(b){return h=b,o=setTimeout(v,t),c?p(b):n}function g(b){var A=b-l,S=b-h,M=t-A;return d?DF(M,a-S):M}function m(b){var A=b-l,S=b-h;return l===void 0||A>=t||A<0||d&&S>=a}function v(){var b=Iu();if(m(b))return y(b);o=setTimeout(v,g(b))}function y(b){return o=void 0,u&&r?p(b):(r=s=void 0,n)}function x(){o!==void 0&&clearTimeout(o),h=0,r=l=s=o=void 0}function w(){return o===void 0?n:y(Iu())}function _(){var b=Iu(),A=m(b);if(r=arguments,s=this,l=b,A){if(o===void 0)return f(l);if(d)return clearTimeout(o),o=setTimeout(v,t),p(l)}return o===void 0&&(o=setTimeout(v,t)),n}return _.cancel=x,_.flush=w,_}var V2=IF;function OF(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var RF=OF;function LF(e,t){return e>t}var BF=LF;function zF(e,t){return t.length<2?e:dy(e,wL(t,0,-1))}var FF=zF;function kF(e,t){return bF(e,t)}var D4=kF;function UF(e,t,i){for(var r=-1,s=e.length;++r<s;){var a=e[r],n=t(a);if(n!=null&&(o===void 0?n===n&&!lh(n):i(n,o)))var o=n,l=a}return l}var NF=UF;function VF(e){return e&&e.length?NF(e,ty,BF):void 0}var jF=VF;function GF(e,t){return t=Ml(t,e),e=FF(e,t),e==null||delete e[Sd(RF(t))]}var HF=GF;function WF(e){return xL(e)?void 0:e}var qF=WF,YF=1,XF=2,QF=4,ZF=py(function(e,t){var i={};if(e==null)return i;var r=!1;t=$v(t,function(a){return a=Ml(a,e),r||(r=a.length>1),a}),hh(e,xy(e),i),r&&(i=_y(i,YF|XF|QF,qF));for(var s=t.length;s--;)HF(i,t[s]);return i}),v3=ZF;function KF(e,t,i,r){if(!Br(e))return e;t=Ml(t,e);for(var s=-1,a=t.length,n=a-1,o=e;o!=null&&++s<a;){var l=Sd(t[s]),h=i;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(s!=n){var c=o[l];h=r?r(c,l,o):void 0,h===void 0&&(h=Br(c)?c:v4(t[s+1])?[]:{})}x4(o,l,h),o=o[l]}return e}var JF=KF;function $F(e,t,i){for(var r=-1,s=t.length,a={};++r<s;){var n=t[r],o=dy(e,n);i(o,n)&&JF(a,Ml(n,e),o)}return a}var ek=$F;function tk(e,t){return ek(e,t,function(i,r){return EF(e,r)})}var ik=tk,rk=py(function(e,t){return e==null?{}:ik(e,t)}),hs=rk,sk="Expected a function";function ak(e,t,i){var r=!0,s=!0;if(typeof e!="function")throw new TypeError(sk);return Br(i)&&(r="leading"in i?!!i.leading:r,s="trailing"in i?!!i.trailing:s),V2(e,t,{leading:r,maxWait:t,trailing:s})}var nk=ak;function Ey(e){for(let t of Object.keys(e))e[t]===void 0&&delete e[t];return e}function ur(e,t){return Object.setPrototypeOf(e,t),e}var ok=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes(" electron/"),lk=()=>typeof window>"u"?!1:window.navigator.platform.toUpperCase().includes("MAC"),hk=()=>typeof window>"u"?!1:/iPad|iPhone|iPod/.test(window.navigator.userAgent)||Ad&&"ontouchend"in document,ck=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,dk=()=>typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0,uk=()=>{if(typeof window>"u")return!1;let e=navigator.userAgent,t=navigator.vendor;return/Safari/i.test(e)&&/Apple Computer/.test(t)},pk=()=>{if(typeof window>"u")return null;let e=navigator.userAgent.match(/Version\/(\d+\.\d)/);return e&&e[1]},fk=()=>{if(typeof window>"u")return;let e=new URLSearchParams(window.location.search).get("desktop-app-version");return e?(window.localStorage.setItem("desktop-app-version",e),e):window.localStorage.getItem("desktop-app-version")??"0.0.6"},Cy=ok();Cy&&fk();var Ad=lk(),ch=hk(),mk=ck(),q1=dk(),J6=uk(),gk=Number(pk());function Ty(e){return Array.isArray(e)?e:[e]}function Py(e,t){let i=0;for(;i<e.length&&i<t.length;){if(e[i]<t[i])return-1;if(e[i]>t[i])return 1;i+=1}return i!==t.length?-1:i!==e.length?1:0}function $h(e){return Ad?e.metaKey:e.ctrlKey}function vk(e){return e.wheelDeltaY===0||e.deltaY===0?Ad&&e.shiftKey&&Math.abs(e.wheelDeltaX)>=120?!1:e.wheelDeltaX?e.wheelDeltaX===-3*e.deltaX||e.wheelDeltaX===-3*window.devicePixelRatio*e.deltaX:e.deltaMode===0:e.wheelDeltaY?e.wheelDeltaY===-3*e.deltaY||e.wheelDeltaY===-3*window.devicePixelRatio*e.deltaY:e.deltaMode===0}var it=[],Ec={},u2={},Q0={};function Dy(e){it.includes(e)||it.push(e)}function Go(e){delete Ec[e.pointerId];for(let t=0;t<it.length;t++)if(it[t].pointerId===e.pointerId){it.splice(t,1);break}}function yk(){it.splice(0,it.length)}function Cc(e){if(e.pointerType!=="touch")return;let t=Ec[e.pointerId];t===void 0&&(t={x:0,y:0},Ec[e.pointerId]=t),t.x=e.pageX,t.y=e.pageY}function Ou(e){let t=e.pointerId===it[0].pointerId?it[1]:it[0];return Ec[t.pointerId]}function Iy(e){u2[e.key]=!0,Q0[e.key]=Q0[e.key]===void 0?1:Q0[e.key]+1}function Oy(e){if(Ad&&u2.Meta)for(let t in u2)u2[t]=!1;else u2[e.key]=!1;Q0={}}function xk(e){e.addEventListener("pointerdown",Dy,!0),e.addEventListener("pointerdown",Cc,!0),e.addEventListener("pointermove",Cc,!0),e.addEventListener("pointerup",Go,!0),e.addEventListener("pointercancel",Go,!0),e.addEventListener("pointerleave",Go,!0),window.addEventListener("keydown",Iy,!0),window.addEventListener("keyup",Oy,!0)}function bk(e){e.removeEventListener("pointerdown",Dy,!0),e.removeEventListener("pointerdown",Cc,!0),e.removeEventListener("pointermove",Cc,!0),e.removeEventListener("pointerup",Go,!0),e.removeEventListener("pointercancel",Go,!0),e.removeEventListener("pointerleave",Go,!0),window.removeEventListener("keydown",Iy,!0),window.removeEventListener("keyup",Oy,!0)}var Ry,wk=new Promise(e=>{Ry=e}),e0;function Sk(){if(e0)return e0;async function e(){let t="https://unpkg.com/@splinetool/navmesh-wasm@1.9.37/build",i=Ya(()=>import("./BFd9Mv4x.js"),[],import.meta.url),[r,s]=await Promise.all([i,fetch(`${t}/navmesh.wasm`).then(o=>o.arrayBuffer())]),a=r.default,n=await a({wasmBinary:s});Ry(n)}return e0=e(),e0}var Ly,_k=new Promise(e=>{Ly=e}),t0;function Ak(){if(t0)return t0;async function e(){let t=await Ya(()=>import("./BR8rmkuh.js"),[],import.meta.url);await t.init(),Ly(t)}return t0=e(),t0}var Ke=class{modifyById(e,t){let i=this;if(i[e]===void 0)throw new Error("not expected");{let r={...i,[e]:t};return Object.setPrototypeOf(r,Ke.prototype),r}}add(e,t){var i;return((i=this.runOp({type:1,id:e,data:t}))==null?void 0:i.data)??this}runOp(e){let t=this;if(e.type===1){let i=t[e.id],r;i===void 0?r={type:2,id:e.id}:r={type:1,id:e.id,data:i};let{id:s,data:a}=e,n={...t,[s]:a};return Object.setPrototypeOf(n,Ke.prototype),{data:n,actual:e,reverse:r}}else if(e.type===2){let{id:i}=e,r=t[i];if(r===void 0)return null;{let s={...t};return Object.setPrototypeOf(s,Ke.prototype),delete s[i],{data:s,actual:e,reverse:{type:1,id:i,data:r}}}}return null}};function I4(e){if(e.deepFreeze!==void 0){e.deepFreeze(e);return}let t=Object.getOwnPropertyNames(e);for(let i of t){let r=e[i];r&&typeof r=="object"&&I4(r)}return Object.freeze(e)}function Mk(e,t){let i=0;for(;i<e.length&&i<t.length;){if(e[i]<t[i])return-1;if(e[i]>t[i])return 1;i+=1}return i!==t.length?-1:i!==e.length?1:0}var By=class extends Error{};function Ru(e){let t={...e};return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}function Pa(e,t,i){if(e===void 0?t===void 0?(e=0,t=10):e=t-10:t===void 0&&(t=e+10),e>t){let a=e;e=t,t=a}let r=[],s=1/(i+1);for(let a=0;a<i;a++){let n=e+(t-e)*(a+.75+Math.random()*.5)*s;r.push(n)}return r}function O4(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array}function Ek(){return typeof process<"u"}function zy(e,t){for(let i of e)t(i.id,i.data)!==!0&&zy(i.children,t)}function Fy(e,t){if(t(e.id,e.data)!==!0)for(let i of e.children)Fy(i,t)}var s1=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,s1.prototype)}deepFreeze(){let e=0;for(;e<this.length;)I4(this[e]),e++}fillCaches0(e,t){this.objCaches.set(e.id,e),this.parentCaches.set(e.id,t);for(let i of e.children)this.fillCaches0(i,e.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let e of this)this.fillCaches0(e,null)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}nonExistOrDescendantOf(e,t){if(!this.has(e))return!0;for(;e;){let i=this.parent(e);if(i===t)return!0;e=i}return!1}rootAcestor(e){for(;e;){let t=this.parent(e);if(t)e=t;else return e}return e}isDescendantOf(e,t){for(;e;){let i=this.parent(e);if(i===t)return!0;e=i}return!1}data(e){var t;return(t=this.get(e))==null?void 0:t.data}has(e){return this.childrenOf(e)!==void 0}get(e){return this.fillCaches(),this.objCaches.get(e)}childrenOf(e){var t;return e===null?this:(t=this.get(e))==null?void 0:t.children}traverseFrom(e,t){if(e===null)this.traverse(t);else{let i=this.get(e);i&&Fy(i,t)}}traverse(e){zy(this,e)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(e){return this.fillCaches(),this.parentCaches.get(e)}childrenArray(e){return e===null?this:this.get(e).children}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let i=this.parent(e),r=this.childrenArray(i),s=r.findIndex(n=>n.id===e);if(s<0)throw new Error("not expected");let a=r[s];return r=[...r],r[s]={...a,data:t},this.modifyArrayBy(i,r)}}modifyArrayBy(e,t){let i=e,r=t;for(;i!==null;){let a=r,n=i;if(i=this.parent(i),i===void 0)throw new Error;r=this.childrenArray(i);let o=r.findIndex(l=>l.id===n);if(o<0)throw new Error;r=[...r],r[o]={...r[o],children:a}}Object.setPrototypeOf(r,s1.prototype);let s=r;return s.fillCaches(),s}runOp(e){switch(e.type){case 7:return this.addOp(e);case 8:return this.deleteOp(e);case 9:return this.moveOp(e)}return null}checkDuplicatedIdRec({id:e,children:t}){if(this.get(e)!==void 0)return!0;for(let i of t)if(this.checkDuplicatedIdRec(i))return!0;return!1}addOp(e){let{parent:t,fi:i,id:r,data:s,children:a}=e;if(t!==null&&this.get(t)===void 0||this.checkDuplicatedIdRec(e))return null;{let n=t,o=this.childrenArray(n),l={fi:i,id:r,data:s,children:a};return o=[...o,l],o.sort((h,c)=>h.fi-c.fi),e.localIndex=o.indexOf(l),{data:this.modifyArrayBy(n,o),actual:e,reverse:{type:8,id:r}}}}deleteOp(e){let{id:t}=e;if(this.get(t)===null)return null;{let i=this.parent(t);if(i===void 0)return null;let r=this.childrenArray(i),s=r.findIndex(n=>n.id===t);e.localIndex=s,r=[...r];let a=r.splice(s,1)[0];return{data:this.modifyArrayBy(i,r),actual:e,reverse:{type:7,...a,parent:i}}}}moveOp(e){let{parent:t,fi:i,id:r}=e;if(t!==null&&this.get(t)===void 0)return this.deleteOp({type:8,id:r});if(t!==null){let d=t;for(;d!==null;){if(d===void 0)throw new Error;if(d===r)throw new By("cyclic tree");d=this.parent(d)}}let s=this.parent(r);if(s===void 0)return null;let a=s,n=this.childrenArray(s),o=n.findIndex(d=>d.id===r);n=[...n];let l=n.splice(o,1)[0],h=this.modifyArrayBy(s,n);s=t,n=h.childrenArray(s);let c=l.fi;return l={...l,fi:i},n=[...n,l],n.sort((d,u)=>d.fi-u.fi),e.localIndex=n.indexOf(l),h=h.modifyArrayBy(s,n),{data:h,actual:e,reverse:{type:9,parent:a,fi:c,id:r}}}previous(e,t){if(t===null){let r=this.childrenArray(e);return r.length===0?null:r[r.length-1].id}let i=null;for(let r of this.childrenArray(e)){if(r.id===t)return i;i=r.id}return null}traverseSortNext(e){let t=this.parent(e);if(t!==void 0){let i=this.childrenArray(t),r=i.findIndex(s=>s.id===e)+1;if(r<i.length)return i[r].id;if(t)return this.traverseSortNext(t)}}sortNext(e){let t=this.childrenArray(e);return t.length>0?t[0].id:this.traverseSortNext(e)}traverseSortPrevious(e){let t=this.childrenArray(e);return t.length>0?this.traverseSortPrevious(t[t.length-1].id):e}sortPrevious(e){let t=this.parent(e);if(t!==void 0){let i=this.childrenArray(t),r=i.findIndex(s=>s.id===e)-1;return r>=0?this.traverseSortPrevious(i[r].id):t}}getAllSorted(e){let t=[];for(let i of e){let r=this.getWithSortKey(i.id);r!==void 0&&t.push({...i,...r})}t.sort((i,r)=>Mk(i.sortKey,r.sortKey));for(let i of t)delete i.sortKey;return t}getWithSortKey(e){var t=e;let i=[],r=this.get(t),s=r;if(r!==void 0){for(;t;)i.splice(0,0,r.fi),t=this.parent(t),t!==null&&(r=this.get(t));return{...s,sortKey:i}}}insertBeforeHelper(e,t,i){return this.insertAfterHelper(e,this.previous(e,t),i)}insertAfterHelper(e,t,i){let r=this.childrenArray(e);if(t===null){if(r.length===0)return Pa(0,i,i);{let s=r[0].fi;return Pa(s-i,s,i)}}else{let s=this.get(t);if(s===void 0||this.parent(t)!==e)throw new Error("illegal args");let a=r.find(n=>n.fi>s.fi);if(a===void 0){let n=r[r.length-1].fi;return Pa(n,n+i,i)}else return Pa(s.fi,a.fi,i)}}},Tc;(e=>{function t(i,r){if(r.type!==0)return null;if(Array.isArray(i)){let s=r.props,a={},n=[...i],o=!1;if(s)for(let l of Object.keys(s)){let h=parseInt(l);if(isNaN(h))throw new Error("wrong index");a[l]=n[h],n[h]=s[l],o=!0}return o?{data:n,actual:r,reverse:{type:0,props:a}}:null}else{let s=r.props,a={},n={...i},o=!1;if(s)for(let l of Object.keys(s)){a[l]=n[l];let h=s[l];h===void 0?delete n[l]:n[l]=h,o=!0}return o?{data:n,actual:r,reverse:{type:0,props:a}}:null}}e.runOp=t})(Tc||(Tc={}));var je=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,je.prototype)}deepFreeze(){let e=0;for(;e<this.length;)I4(this[e]),e++}fillCaches0(e){this.objCaches.set(e.id,e)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let e of this)this.fillCaches0(e)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}data(e){var t;return(t=this.get(e))==null?void 0:t.data}get(e){return this.fillCaches(),this.objCaches.get(e)}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let i=this,r=i.findIndex(a=>a.id===e);if(r<0)throw new Error("not expected");let s=i[r];return i=[...i],i[r]={...s,data:t},this.modifyArrayBy(i)}}modifyArrayBy(e){Object.setPrototypeOf(e,je.prototype);let t=e;return Ek()||t.fillCaches(),t}runOp(e){switch(e.type){case 4:return this.addOp(e);case 5:return this.deleteOp(e);case 6:return this.moveOp(e)}return null}addOp(e){let{fi:t,id:i,data:r}=e,s=this,a={fi:t,id:i,data:r};return s=[...s,a],s.sort((n,o)=>n.fi-o.fi),e.localIndex=s.indexOf(a),{data:this.modifyArrayBy(s),actual:e,reverse:{type:5,id:i}}}deleteOp(e){let{id:t}=e,i=this,r=i.findIndex(a=>a.id===t);if(r===-1)return null;e.localIndex=r,i=[...i];let s=i.splice(r,1)[0];return{data:this.modifyArrayBy(i),actual:e,reverse:{type:4,...s}}}moveOp(e){let{fi:t,id:i}=e,r=this;r=[...r];let s=r.findIndex(o=>o.id===i);if(s===-1)return null;let a=r[s].fi,n={...r[s],fi:t};return r[s]=n,r.sort((o,l)=>o.fi-l.fi),e.localIndex=r.indexOf(n),{data:this.modifyArrayBy(r),actual:e,reverse:{type:6,fi:a,id:i}}}previous(e){if(e===null)return this.length===0?null:this[this.length-1].id;let t=null;for(let i of this){if(i.id===e)return t;t=i.id}return null}insertBeforeHelper(e,t){return this.insertAfterHelper(this.previous(e),t)}insertAfterHelper(e,t){let i=this;if(e===null){if(i.length===0)return Pa(0,t,t);{let r=i[0].fi;return Pa(r-t,r,t)}}else{let r=this.get(e);if(r===void 0)throw new Error("illegal args");let s=i.find(a=>a.fi>r.fi);if(s===void 0){let a=i[i.length-1].fi;return Pa(a,a+t,t)}else return Pa(r.fi,s.fi,t)}}};function al(e){return e&&typeof e=="object"&&e instanceof Ei}var Ei=class{unusedFunOverridesTable(e){}runOp(e){let t=[],i=this,r=0,s={};for(;r<e.path.length;){if(t.push(i),i=i===void 0?void 0:i[e.path[r]],i!==void 0&&!al(i))return null;r+=1}i=i?Ru(i):new Ei;for(let[o,l]of Object.entries(e.props)){let h=i[o];s[o]=h,l===void 0?delete i[o]:i[o]=l}for(;r>0;){if(Object.keys(i).length===0){let o=t[r-1];o&&(i=Ru(o),delete i[e.path[r-1]])}else{let o=t[r-1];if(o){let l=Ru(o);l[e.path[r-1]]=i,i=l}else{let l=new Ei;l[e.path[r-1]]=i,i=l}}r-=1}let a=Object.setPrototypeOf(i,Ei.prototype),n={...e,props:s};return{data:a,actual:e,reverse:n}}},ka;(e=>{function t(s,a){return j2(s,a)??s}e.apply=t;function i(s,a){return L4(s,a)}e.merge=i;function r(s,a){let n=0,o=a.path,l=s;for(;n<o.length&&l!==void 0;){if(l=Li.zoomOnce(l,o[n]),l===void 0)return a;if(!al(l))return;n+=1}if(l===void 0)return a;if(al(l))if(a.type===0){let h={...a.props};for(let c of Object.keys(l))delete h[c];return{...a,props:h}}else if(a.type===1||a.type===4||a.type===7){let h=R4([a],l);return h||a}else return a}e.filterOp=r})(ka||(ka={}));function R4(e,t){if(t===void 0)return;let i=!1,r=e.map(s=>{let a=s.id,n=j2(s.data,t[a]);if(i=i||n!==void 0,n===void 0&&(n=s.data),s.children){let o=R4(s.children,t);return o!==void 0?i=!0:o=s.children,{...s,id:a,data:n,children:o}}else return{...s,id:a,data:n}});if(i)return r}function Ck(e,t){if(t===void 0)return;let i=!1,r=e.map(s=>{let a=s.id,n=j2(s.data,t[a]);return i=i||n!==void 0,n===void 0&&(n=s.data),{...s,id:a,data:n}});if(i)return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r}function j2(e,t){if(!al(t))return t;if(e instanceof s1){let i=R4(e,t);return i!==void 0&&Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}else{if(e instanceof je)return Ck(e,t);if(Array.isArray(e)){let i=!1,r=e.map((s,a)=>{let n=j2(s,t[a]);return i=i||n!==void 0,n===void 0&&(n=s),n});return i?(Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r):void 0}else{if(e instanceof Ei)return L4(e,t);if(e&&typeof e=="object"){let i={},r=!1;for(let[s,a]of Object.entries(e)){let n=j2(a,t[s]);r=r||n!==void 0,n===void 0&&(n=a),i[s]=n}return r?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}}}}function L4(e,t){if(e===void 0)return t;if(t===void 0)return e;if(!al(t))return t;if(!al(e))return ka.apply(e,t);let i=new Set;for(let s of Object.keys(e))i.add(s);for(let s of Object.keys(t))i.add(s);let r=new Ei;for(let s of i){let a=L4(e===void 0?void 0:e[s],t===void 0?void 0:t[s]);r[s]=a}return r}function Tk(e,t){let i={cur:[],result:[],len:0};return e=G2(e,t,i)??e,[e,i.result]}function Pc(e,t){return e===null?null:(e.cur[e.len]=t,e.len+=1,e)}function Dc(e){e&&(e.len-=1)}function Pk(e){if(e===null)return null;e.result.push(e.cur.slice(0,e.len))}function ky(e,t,i){let r=!1,s=e.map(a=>{let n=a.id,o=t[n];if(o!==void 0&&typeof o=="string"&&(r=!0,n=o,i!==null))throw new Error("not supported");let l=G2(a.data,t,Pc(i,n));Dc(i),r=r||l!==void 0,l===void 0&&(l=a.data);let h=ky(a.children,t,i);return h!==void 0?r=!0:h=a.children,{...a,id:n,data:l,children:h}});if(r)return s}function Dk(e,t,i){let r=!1,s=e.map(a=>{let n=a.id,o=t[n];if(o!==void 0&&typeof o=="string"&&(r=!0,n=o,i!==null))throw new Error("not supported");let l=G2(a.data,t,Pc(i,n));return Dc(i),r=r||l!==void 0,l===void 0&&(l=a.data),{...a,id:n,data:l}});if(r)return Object.setPrototypeOf(s,Object.getPrototypeOf(e)),s}function G2(e,t,i){if(e instanceof s1){let r=ky(e,t,i);return r!==void 0&&Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r}else{if(e instanceof je)return Dk(e,t,i);if(Array.isArray(e)){let r=!1,s=e.map((a,n)=>{let o=G2(a,t,Pc(i,n));return Dc(i),r=r||o!==void 0,o===void 0&&(o=a),o});return r?(Object.setPrototypeOf(s,Object.getPrototypeOf(e)),s):void 0}else if(e&&typeof e=="object"&&!O4(e)){let r={},s=!1;for(let[a,n]of Object.entries(e))if(a!=="name"&&a!=="variableId"){let o=t[a];if(typeof o=="string"){if(i!==null)throw new Error("not supported");s=!0,a=o}let l=G2(n,t,Pc(i,a));Dc(i),s=s||l!==void 0,l===void 0&&(l=n),r[a]=l}else r[a]=n;return s?(Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r):void 0}else if(typeof e=="string"){let r=t[e];return r!==void 0&&Pk(i),r}else return}}var Ic;(e=>{function t(i,r){let s=Li.zoom(r,i.path);if(typeof s=="object"){let a={};for(let n of Object.keys(i.props))a[n]=s[n];return{...i,props:a}}else return{...i,props:{}}}e.replaceProps=t})(Ic||(Ic={}));var qi;(e=>{function t(l,h){return{...l,path:l.path.slice(h)}}e.drop=t;function i(l,h){var c;return((c=r(l,h))==null?void 0:c.data)??l}e.applySimple=i;function r(l,h){var u,p;let c=h.path;for(var d=[];;){let f;if(l instanceof Ei&&h.type===0&&(f=l.runOp({...h,path:c.slice(d.length)}),f===null&&(f=void 0)),f===void 0&&d.length===c.length&&(l instanceof s1||l instanceof je||l instanceof Ke?f=l.runOp(h):f=Tc.runOp(l,h)),f!==void 0)if(f!==null){let v=f.data;for(let y=d.length-1;y>=0;y--){let x=c[y],w=d[y];if(w instanceof s1){if(typeof x=="number")throw new Error("illegal arg");v=w.modifyById(x,v)}else if(w instanceof je){if(typeof x=="number")throw new Error("illegal arg");v=w.modifyById(x,v)}else if(w instanceof Ke){if(typeof x=="number")throw new Error("illegal arg");v=w.modifyById(x,v)}else if(w instanceof Ei){let _={...w,[x]:v};v=Object.setPrototypeOf(_,Ei.prototype)}else if(typeof w=="object")if(Array.isArray(w)){if(typeof x=="string"&&(x=parseInt(x),isNaN(x)))throw new Error("Invalid path");let _=v;v=[...w],v[x]=_}else v={...w,[x]:v};else return null}return{data:v,actual:{...f.actual,path:c},reverse:{...f.reverse,path:c}}}else return null;let g=c[d.length],m;if(l instanceof s1){if(typeof g=="number")throw new Error("");m=(u=l.get(g))==null?void 0:u.data}else if(l instanceof je){if(typeof g=="number")throw new Error("");m=(p=l.get(g))==null?void 0:p.data}else l!==null&&(m=l[g]);if(m!==void 0)d.push(l),l=m;else return null}}e.apply=r;function s(l,h){for(let c=0;c<l.length&&c<h.length;c++)if(l[c]!==h[c])return!0;return!1}e.pathDisjoint=s;function a(l,h){if(l.length!==h.length)return!1;for(let c=0;c<l.length;c++)if(l[c]!==h[c])return!1;return!0}e.pathEq=a;function n(l,h){return s(l.path,h.path)}e.commutative=n;function o(l,h){return l.type===0&&h.type===0&&a(l.path,h.path)?Object.keys(l.props).every(c=>h.props[c]!==void 0):!1}e.subsumed=o})(qi||(qi={}));var y3;(e=>{function t(){return[]}e.empty=t;function i(h,c){let d=[];for(let u of h){let[p,...f]=u.path;p===c&&d.push({...u,path:f})}return d}e.removePrefix=i;function r(h,c){return h.map(d=>({...d,path:[c,...d.path]}))}e.addPrefix=r;function s(h,c){return[...h,...c]}e.concat=s;function a(h,c){return[...h.filter(d=>!c.some(u=>qi.subsumed(d,u))),...c]}e.compress=a;function n(h,c){return h.every(d=>c.every(u=>qi.commutative(d,u)))}e.commutative=n;function o(h,c){for(let d of c){let u=l(h,d);u!==null&&(h=u.data)}return h}e.applyAll=o;function l(h,c){var d=h;let u=[],p=[];for(let f of c)try{if(f.type===3||f.type===5&&f.path[f.path.length-1]==="variables"){let g,m,v;if(f.type===3?(g=Li.zoom(d,[...f.path,f.id]),v=qi.apply(d,{...f,type:2})):(g=Li.zoom(d,[...f.path,f.id,"value"]),v=qi.apply(d,f)),v!==null){d=v.data;let[y,x]=Tk(d,{[f.id]:g});d=y;for(let w=0;w<x.length;w++){let _=x[w],b=_.pop();if(typeof b=="number"){let A=[b];for(let M=w+1;M<x.length;M++){let C=x[M],T=C[C.length-1];if(typeof T=="number"&&Li.equal(_,C.slice(0,C.length-1)))A.push(T),x.splice(M,1);else break}let S=Li.zoom(d,_);m=S.map((M,C)=>A.includes(C)?f.id:M),g=S,b=_.pop()}else{if(b==="alphaOverride"||b==="alpha"){g/=100;let A=g,S=Li.zoom(d,_.slice(0,_.length-2)),M=S.layers.map(C=>C.id===_[_.length-1]?{...C,data:{...C.data,[b]:A}}:C);Object.setPrototypeOf(M,Object.getPrototypeOf(S.layers)),S.layers=M}m=f.id}u.push({type:0,path:_,props:{[b]:g}}),p.push({type:0,path:_,props:{[b]:m}})}p.push(v.reverse),u.push(v.actual)}}else{let g=qi.apply(d,f);g!==null&&(u.push(g.actual),d=g.data,p.push(g.reverse))}}catch(g){if(g instanceof By)return null;throw g}return{data:d,actual:u,reverse:p.reverse()}}e.apply=l})(y3||(y3={}));var Uy=Symbol(),Ik=Symbol(),Md=Symbol(),dh=class{reportOp(e,t,i=[]){let r=this;if(t===null)return;r._current=t.data;let s=i;for(;!(r instanceof Vy);){let a=r._path,n=r._current;if(a!==""&&s.splice(0,0,a),r=r._parent,r===null)return;r.update(a,n)}r.push(s,e,t.actual,t.reverse)}deleteChildren(e){if(this._children){let t=this._children[e];if(t){let i=t[Md];i&&i(),delete this._children[e]}}}},Ok=class extends dh{constructor(e,t,i){super(),this._parent=e,this._path=t,this._current=i}update(e,t){if(Array.isArray(this._current)){if(typeof e=="string"&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid path");this._current=[...this._current],this._current[e]=t}else this._current={...this._current,[e]:t}}runOp(e){this.reportOp(e,Tc.runOp(this._current,e),e.path)}},Rk=class extends dh{constructor(e,t,i){super(),this._parent=e,this._path=t,this._current=i}update(e,t){this._current={...this._current,[e]:t},Object.setPrototypeOf(this._current,Ke.prototype)}runOp(e){this.reportOp(e,this._current.runOp(e))}},Ny={get(e,t){if(t===Md)return()=>{e._parent=null};if(t===Uy)return e._current;if(t===Ik)return e;let{_current:i,_children:r}=e;if(t==="push"&&Array.isArray(i))throw new Error("not supported to expand array");let s=r===void 0?void 0:r[t];if(s!==void 0)return s;let a=i[t],n=Ed(e,t,a);return n!==a?(r===void 0&&(r={},e._children=r),r[t]=n,n):a},has(e,t){return t in e._current},ownKeys(e){return Reflect.ownKeys(e._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(e){return Object.getPrototypeOf(e._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(e,t){let i=e._current,r=Reflect.getOwnPropertyDescriptor(i,t);return r&&{writable:!0,configurable:!0,enumerable:r.enumerable,value:i[t]}}},Lk={...Ny,set(e,t,i){let r={type:0,props:{[t]:mi(i)??i}};return e.deleteChildren(t),e.runOp(r),!0},deleteProperty(e,t){let i={type:0,props:{[t]:void 0}};return e.deleteChildren(t),e.runOp(i),!0}},Bk={...Ny,set(e,t,i){return i===void 0?this.deleteProperty(e,t):(e.deleteChildren(t),e.runOp({type:1,id:t,data:i})),!0},deleteProperty(e,t){return e.runOp({type:2,id:t}),!0}},B4=class extends dh{constructor(e,t,i){super(),this._children={},this._parent=e,this._path=t,this._current=i,this[Md]=()=>{this._parent=null}}unproxy(){return this._current}update(e,t){this._current=this._current.modifyById(e,t)}runOp(e){this.reportOp(e,this._current.runOp(e))}randomId(){return this._current.randomId()}isDescendantOf(e,t){return this._current.isDescendantOf(e,t)}childrenOf(e){return this._current.childrenOf(e)}traverse(e){return this._current.traverse(e)}get(e){return this._current.get(e)}parent(e){return this._current.parent(e)}traverse(e){this._current.traverse((t,i)=>{e(t,this.data(t))})}data(e){var n;let{_current:t,_children:i}=this,r=i===void 0?void 0:i[e];if(r!==void 0)return r;let s=(n=t.get(e))==null?void 0:n.data,a=Ed(this,e,s);return a!==s?(i===void 0&&(i={},this._children=i),i[e]=a,a):s}add(e,t,i,r,s){this.runOp({type:7,parent:e,fi:t,id:i,data:r,children:s})}move(e,t,i){this.runOp({type:9,parent:e,fi:t,id:i})}insertAfter(e,t,i){let r=this._current.insertAfterHelper(e,t,i.length);for(let s=0;s<i.length;s++){let a=i[s];this.add(e,r[s],a.id,a.data,a.children)}}insertBefore(e,t,i){let r=this._current.insertBeforeHelper(e,t,i.length);for(let s=0;s<i.length;s++){let a=i[s];this.add(e,r[s],a.id,a.data,a.children)}}moveAfter(e,t,i){let r=this._current.insertAfterHelper(e,t,i.length);for(let s=0;s<i.length;s++){let a=i[s];this.move(e,r[s],a)}}moveBefore(e,t,i){let r=this._current.insertBeforeHelper(e,t,i.length);for(let s=0;s<i.length;s++){let a=i[s];this.move(e,r[s],a)}}delete(e){this.deleteChildren(e),this.runOp({type:8,id:e})}sortNext(e){return this._current.sortNext(e)}sortPrevious(e){return this._current.sortPrevious(e)}getAllSorted(e){return this._current.getAllSorted(e)}},z4=class extends dh{constructor(e,t,i){super(),this._children={},this._parent=e,this._path=t,this._current=i,this[Md]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(e){let t=this.length;for(let i=0;i<t;i++){let r=this._current[i].id,s=this._current[i].fi;e(this.data(this._current[i].id),r,s)}}find(e){let t=this.length;for(let i=0;i<t;i++){let r=this._current[i].id;if(e(this.data(r),r))return this.get(r)}}update(e,t){this._current=this._current.modifyById(e,t)}randomId(){return this._current.randomId()}get(e){return{...this._current.get(e),data:this.data(e)}}data(e){var n;let{_current:t,_children:i}=this,r=i===void 0?void 0:i[e];if(r!==void 0)return r;let s=(n=t.get(e))==null?void 0:n.data,a=Ed(this,e,s);return a!==s?(i===void 0&&(i={},this._children=i),i[e]=a,a):s}runOp(e){this.reportOp(e,this._current.runOp(e))}add(e,t,i){this.runOp({type:4,fi:e,id:t,data:i})}move(e,t){this.runOp({type:6,fi:e,id:t})}insertAfter(e,t){let i=this._current.insertAfterHelper(e,t.length);for(let r=0;r<t.length;r++){let s=t[r];this.add(i[r],s.id,s.data)}}insertBefore(e,t){let i=this._current.insertBeforeHelper(e,t.length);for(let r=0;r<t.length;r++){let s=t[r];this.add(i[r],s.id,s.data)}}moveAfter(e,t){let i=this._current.insertAfterHelper(e,t.length);for(let r=0;r<t.length;r++){let s=t[r];this.move(i[r],s)}}moveBefore(e,t){let i=this._current.insertBeforeHelper(e,t.length);for(let r=0;r<t.length;r++){let s=t[r];this.move(i[r],s)}}delete(e){this.deleteChildren(e),this.runOp({type:5,id:e})}};function Lu(e,t,i){if(e.length>0){let r=e[e.length-1];if(r.type===0&&t.type===0&&Li.equal(r.path,i)){Object.assign(r.props,t.props);return}}e.push({...t,path:i})}var Vy=class extends dh{constructor(e){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=e}update(e,t){if(e!=="")throw new Error("");this._current=t}push(e,t,i,r){Lu(this.ts,t,e),Lu(this.actual,i,e),Lu(this.reverse,r,e)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function Ed(e,t,i){return i instanceof s1?new B4(e,t,i):i instanceof je?new z4(e,t,i):i instanceof Ke?new Proxy(new Rk(e,t,i),Bk):i!==null&&typeof i=="object"?O4(i)?i:new Proxy(new Ok(e,t,i),Lk):i}function jy(e){let t=new Vy(e);return[Ed(t,"",e),t]}function H2(e,t){let[i,r]=jy(e);return t(i),r.result()}function mi(e){return e instanceof B4||e instanceof z4?e._current:e!==null&&typeof e=="object"?e[Uy]:e}var Li;(e=>{function t(a,n){if(n.length===a.length)for(var o=0;o<a.length;){if(a[o]!==n[o])return!1;o+=1}else return!1;return!0}e.equal=t;function i(a,n,o){let l=s(o,a);if(l!==void 0&&typeof l=="object"&&l!==null){let h={...n};return Object.keys(l).forEach(c=>{delete h[c]}),h}else return n}e.removeOverridden=i;function r(a,n){if((a instanceof s1||a instanceof B4)&&typeof n=="string"||(a instanceof je||a instanceof z4)&&typeof n=="string")return a.data(n);if(typeof n=="number"&&Array.isArray(a)||typeof n=="string"&&typeof a=="object"&&a!==null)return a[n]}e.zoomOnce=r;function s(a,n,o=0){for(;o<n.length&&a!==void 0;)a=r(a,n[o]),o+=1;return a}e.zoom=s})(Li||(Li={}));function zk(e,t){let i=[];if(t.length===e.length)for(var r=0;r<e.length;){if(t[r]==="*")i.push(e[r]);else if(e[r]!==t[r])return null;r+=1}else return null;return i}function Yt(e,t){let i=[];if(t.length<=e.length)for(var r=0;r<t.length;){if(t[r]==="*")i.push(e[r]);else if(e[r]!==t[r])return null;r+=1}else return null;return i}var Gy=class{},$6=class extends Gy{constructor(e){super(),this.id=e}},e9=class extends Gy{constructor(e){super(),this.data=e}},x3;try{x3=new TextDecoder}catch{}var ke,Ua,ie=0,F1={},Ot,Da,rr=0,rs=0,W1,Qs,P1=[],Ft,t9={useRecords:!1,mapsAsObjects:!0},Hy=class{},Wy=new Hy;Wy.name="MessagePack 0xC1";var nl=!1,Oc=class{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0)),Object.assign(this,e)}unpack(e,t){if(ke)return Ky(()=>(w3(),this?this.unpack(e,t):Oc.prototype.unpack.call(t9,e,t)));Ua=t>-1?t:e.length,ie=0,rs=0,Da=null,W1=null,ke=e;try{Ft=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(i){throw ke=null,e instanceof Uint8Array?i:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof Oc){if(F1=this,this.structures)return Ot=this.structures,i0();(!Ot||Ot.length>0)&&(Ot=[])}else F1=t9,(!Ot||Ot.length>0)&&(Ot=[]);return i0()}unpackMultiple(e,t){let i,r=0;try{nl=!0;let s=e.length,a=this?this.unpack(e,s):Td.unpack(e,s);if(t){for(t(a);ie<s;)if(r=ie,t(i0())===!1)return}else{for(i=[a];ie<s;)r=ie,i.push(i0());return i}}catch(s){throw s.lastPosition=r,s.values=i,s}finally{nl=!1,w3()}}_mergeStructures(e,t){e=e||[];for(let i=0,r=e.length;i<r;i++){let s=e[i];s&&(s.isShared=!0,i>=32&&(s.highByte=i-32>>5))}e.sharedLength=e.length;for(let i in t||[])if(i>=0){let r=e[i],s=t[i];s&&(r&&((e.restoreStructures||(e.restoreStructures=[]))[i]=r),e[i]=s)}return this.structures=e}decode(e,t){return this.unpack(e,t)}};function i0(){try{if(!F1.trusted&&!nl){let t=Ot.sharedLength||0;t<Ot.length&&(Ot.length=t)}let e=li();if(ie==Ua)Ot.restoreStructures&&i9(),Ot=null,ke=null,Qs&&(Qs=null);else if(ie>Ua){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}else if(!nl)throw new Error("Data read, but end of buffer not reached");return e}catch(e){throw Ot.restoreStructures&&i9(),w3(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer"))&&(e.incomplete=!0),e}}function i9(){for(let e in Ot.restoreStructures)Ot[e]=Ot.restoreStructures[e];Ot.restoreStructures=null}function li(){let e=ke[ie++];if(e<160)if(e<128){if(e<64)return e;{let t=Ot[e&63]||F1.getStructures&&qy()[e&63];return t?(t.read||(t.read=F4(t,e&63)),t.read()):e}}else if(e<144)if(e-=128,F1.mapsAsObjects){let t={};for(let i=0;i<e;i++)t[Xy()]=li();return t}else{let t=new Map;for(let i=0;i<e;i++)t.set(li(),li());return t}else{e-=144;let t=new Array(e);for(let i=0;i<e;i++)t[i]=li();return t}else if(e<192){let t=e-160;if(rs>=ie)return Da.slice(ie-rr,(ie+=t)-rr);if(rs==0&&Ua<140){let i=t<16?k4(t):Yy(t);if(i!=null)return i}return b3(t)}else{let t;switch(e){case 192:return null;case 193:return W1?(t=li(),t>0?W1[1].slice(W1.position1,W1.position1+=t):W1[0].slice(W1.position0,W1.position0-=t)):Wy;case 194:return!1;case 195:return!0;case 196:return Bu(ke[ie++]);case 197:return t=Ft.getUint16(ie),ie+=2,Bu(t);case 198:return t=Ft.getUint32(ie),ie+=4,Bu(t);case 199:return en(ke[ie++]);case 200:return t=Ft.getUint16(ie),ie+=2,en(t);case 201:return t=Ft.getUint32(ie),ie+=4,en(t);case 202:if(t=Ft.getFloat32(ie),F1.useFloat32>2){let i=U4[(ke[ie]&127)<<1|ke[ie+1]>>7];return ie+=4,(i*t+(t>0?.5:-.5)>>0)/i}return ie+=4,t;case 203:return t=Ft.getFloat64(ie),ie+=8,t;case 204:return ke[ie++];case 205:return t=Ft.getUint16(ie),ie+=2,t;case 206:return t=Ft.getUint32(ie),ie+=4,t;case 207:return F1.int64AsNumber?(t=Ft.getUint32(ie)*4294967296,t+=Ft.getUint32(ie+4)):t=Ft.getBigUint64(ie),ie+=8,t;case 208:return Ft.getInt8(ie++);case 209:return t=Ft.getInt16(ie),ie+=2,t;case 210:return t=Ft.getInt32(ie),ie+=4,t;case 211:return F1.int64AsNumber?(t=Ft.getInt32(ie)*4294967296,t+=Ft.getUint32(ie+4)):t=Ft.getBigInt64(ie),ie+=8,t;case 212:if(t=ke[ie++],t==114)return o9(ke[ie++]&63);{let i=P1[t];if(i)return i.read?(ie++,i.read(li())):i.noBuffer?(ie++,i()):i(ke.subarray(ie,++ie));throw new Error("Unknown extension "+t)}case 213:return t=ke[ie],t==114?(ie++,o9(ke[ie++]&63,ke[ie++])):en(2);case 214:return en(4);case 215:return en(8);case 216:return en(16);case 217:return t=ke[ie++],rs>=ie?Da.slice(ie-rr,(ie+=t)-rr):kk(t);case 218:return t=Ft.getUint16(ie),ie+=2,rs>=ie?Da.slice(ie-rr,(ie+=t)-rr):Uk(t);case 219:return t=Ft.getUint32(ie),ie+=4,rs>=ie?Da.slice(ie-rr,(ie+=t)-rr):Nk(t);case 220:return t=Ft.getUint16(ie),ie+=2,s9(t);case 221:return t=Ft.getUint32(ie),ie+=4,s9(t);case 222:return t=Ft.getUint16(ie),ie+=2,a9(t);case 223:return t=Ft.getUint32(ie),ie+=4,a9(t);default:if(e>=224)return e-256;if(e===void 0){let i=new Error("Unexpected end of MessagePack data");throw i.incomplete=!0,i}throw new Error("Unknown MessagePack token "+e)}}}var Fk=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function F4(e,t){function i(){if(i.count++>2){let s=e.read=new Function("r","return function(){return {"+e.map(a=>Fk.test(a)?a+":r()":"["+JSON.stringify(a)+"]:r()").join(",")+"}}")(li);return e.highByte===0&&(e.read=r9(t,e.read)),s()}let r={};for(let s=0,a=e.length;s<a;s++){let n=e[s];r[n]=li()}return r}return i.count=0,e.highByte===0?r9(t,i):i}var r9=(e,t)=>function(){let i=ke[ie++];if(i===0)return t();let r=e<32?-(e+(i<<5)):e+(i<<5),s=Ot[r]||qy()[r];if(!s)throw new Error("Record id is not defined for "+r);return s.read||(s.read=F4(s,e)),s.read()};function qy(){let e=Ky(()=>(ke=null,F1.getStructures()));return Ot=F1._mergeStructures(e,Ot)}var b3=Cd,kk=Cd,Uk=Cd,Nk=Cd;function Cd(e){let t;if(e<16&&(t=k4(e)))return t;if(e>64&&x3)return x3.decode(ke.subarray(ie,ie+=e));let i=ie+e,r=[];for(t="";ie<i;){let s=ke[ie++];if(!(s&128))r.push(s);else if((s&224)===192){let a=ke[ie++]&63;r.push((s&31)<<6|a)}else if((s&240)===224){let a=ke[ie++]&63,n=ke[ie++]&63;r.push((s&31)<<12|a<<6|n)}else if((s&248)===240){let a=ke[ie++]&63,n=ke[ie++]&63,o=ke[ie++]&63,l=(s&7)<<18|a<<12|n<<6|o;l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|l&1023),r.push(l)}else r.push(s);r.length>=4096&&(t+=Vi.apply(String,r),r.length=0)}return r.length>0&&(t+=Vi.apply(String,r)),t}function s9(e){let t=new Array(e);for(let i=0;i<e;i++)t[i]=li();return t}function a9(e){if(F1.mapsAsObjects){let t={};for(let i=0;i<e;i++)t[Xy()]=li();return t}else{let t=new Map;for(let i=0;i<e;i++)t.set(li(),li());return t}}var Vi=String.fromCharCode;function Yy(e){let t=ie,i=new Array(e);for(let r=0;r<e;r++){let s=ke[ie++];if((s&128)>0){ie=t;return}i[r]=s}return Vi.apply(String,i)}function k4(e){if(e<4)if(e<2){if(e===0)return"";{let t=ke[ie++];if((t&128)>1){ie-=1;return}return Vi(t)}}else{let t=ke[ie++],i=ke[ie++];if((t&128)>0||(i&128)>0){ie-=2;return}if(e<3)return Vi(t,i);let r=ke[ie++];if((r&128)>0){ie-=3;return}return Vi(t,i,r)}else{let t=ke[ie++],i=ke[ie++],r=ke[ie++],s=ke[ie++];if((t&128)>0||(i&128)>0||(r&128)>0||(s&128)>0){ie-=4;return}if(e<6){if(e===4)return Vi(t,i,r,s);{let a=ke[ie++];if((a&128)>0){ie-=5;return}return Vi(t,i,r,s,a)}}else if(e<8){let a=ke[ie++],n=ke[ie++];if((a&128)>0||(n&128)>0){ie-=6;return}if(e<7)return Vi(t,i,r,s,a,n);let o=ke[ie++];if((o&128)>0){ie-=7;return}return Vi(t,i,r,s,a,n,o)}else{let a=ke[ie++],n=ke[ie++],o=ke[ie++],l=ke[ie++];if((a&128)>0||(n&128)>0||(o&128)>0||(l&128)>0){ie-=8;return}if(e<10){if(e===8)return Vi(t,i,r,s,a,n,o,l);{let h=ke[ie++];if((h&128)>0){ie-=9;return}return Vi(t,i,r,s,a,n,o,l,h)}}else if(e<12){let h=ke[ie++],c=ke[ie++];if((h&128)>0||(c&128)>0){ie-=10;return}if(e<11)return Vi(t,i,r,s,a,n,o,l,h,c);let d=ke[ie++];if((d&128)>0){ie-=11;return}return Vi(t,i,r,s,a,n,o,l,h,c,d)}else{let h=ke[ie++],c=ke[ie++],d=ke[ie++],u=ke[ie++];if((h&128)>0||(c&128)>0||(d&128)>0||(u&128)>0){ie-=12;return}if(e<14){if(e===12)return Vi(t,i,r,s,a,n,o,l,h,c,d,u);{let p=ke[ie++];if((p&128)>0){ie-=13;return}return Vi(t,i,r,s,a,n,o,l,h,c,d,u,p)}}else{let p=ke[ie++],f=ke[ie++];if((p&128)>0||(f&128)>0){ie-=14;return}if(e<15)return Vi(t,i,r,s,a,n,o,l,h,c,d,u,p,f);let g=ke[ie++];if((g&128)>0){ie-=15;return}return Vi(t,i,r,s,a,n,o,l,h,c,d,u,p,f,g)}}}}}function Bu(e){return F1.copyBuffers?Uint8Array.prototype.slice.call(ke,ie,ie+=e):ke.subarray(ie,ie+=e)}function en(e){let t=ke[ie++];if(P1[t])return P1[t](ke.subarray(ie,ie+=e));throw new Error("Unknown extension type "+t)}var n9=new Array(4096);function Xy(){let e=ke[ie++];if(e>=160&&e<192){if(e=e-160,rs>=ie)return Da.slice(ie-rr,(ie+=e)-rr);if(!(rs==0&&Ua<180))return b3(e)}else return ie--,li();let t=(e<<5^(e>1?Ft.getUint16(ie):e>0?ke[ie]:0))&4095,i=n9[t],r=ie,s=ie+e-3,a,n=0;if(i&&i.bytes==e){for(;r<s;){if(a=Ft.getUint32(r),a!=i[n++]){r=1879048192;break}r+=4}for(s+=3;r<s;)if(a=ke[r++],a!=i[n++]){r=1879048192;break}if(r===s)return ie=r,i.string;s-=3,r=ie}for(i=[],n9[t]=i,i.bytes=e;r<s;)a=Ft.getUint32(r),i.push(a),r+=4;for(s+=3;r<s;)a=ke[r++],i.push(a);let o=e<16?k4(e):Yy(e);return o!=null?i.string=o:i.string=b3(e)}var o9=(e,t)=>{var i=li();let r=e;t!==void 0&&(e=e<32?-((t<<5)+e):(t<<5)+e,i.highByte=t);let s=Ot[e];return s&&s.isShared&&((Ot.restoreStructures||(Ot.restoreStructures=[]))[e]=s),Ot[e]=i,i.read=F4(i,r),i.read()},Qy=typeof self=="object"?self:global;P1[0]=()=>{};P1[0].noBuffer=!0;P1[101]=()=>{let e=li();return(Qy[e[0]]||Error)(e[1])};P1[105]=e=>{let t=Ft.getUint32(ie-4);Qs||(Qs=new Map);let i=ke[ie],r;i>=144&&i<160||i==220||i==221?r=[]:r={};let s={target:r};Qs.set(t,s);let a=li();return s.used?Object.assign(r,a):(s.target=a,a)};P1[112]=e=>{let t=Ft.getUint32(ie-4),i=Qs.get(t);return i.used=!0,i.target};P1[115]=()=>new Set(li());var Zy=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(e=>e+"Array");P1[116]=e=>{let t=e[0],i=Zy[t];if(!i)throw new Error("Could not find typed array for code "+t);return new Qy[i](Uint8Array.prototype.slice.call(e,1).buffer)};P1[120]=()=>{let e=li();return new RegExp(e[0],e[1])};P1[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],i=ie;ie+=t-4,W1=[li(),li()],W1.position0=0,W1.position1=0;let r=ie;ie=i;try{return li()}finally{ie=r}};P1[255]=e=>e.length==4?new Date((e[0]*16777216+(e[1]<<16)+(e[2]<<8)+e[3])*1e3):e.length==8?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+((e[3]&3)*4294967296+e[4]*16777216+(e[5]<<16)+(e[6]<<8)+e[7])*1e3):e.length==12?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+((e[4]&128?-281474976710656:0)+e[6]*1099511627776+e[7]*4294967296+e[8]*16777216+(e[9]<<16)+(e[10]<<8)+e[11])*1e3):new Date("invalid");function Ky(e){let t=Ua,i=ie,r=rr,s=rs,a=Da,n=Qs,o=W1,l=new Uint8Array(ke.slice(0,Ua)),h=Ot,c=Ot.slice(0,Ot.length),d=F1,u=nl,p=e();return Ua=t,ie=i,rr=r,rs=s,Da=a,Qs=n,W1=o,ke=l,nl=u,Ot=h,Ot.splice(0,Ot.length,...c),F1=d,Ft=new DataView(ke.buffer,ke.byteOffset,ke.byteLength),p}function w3(){ke=null,Qs=null,Ot=null}function Vk(e){e.unpack?P1[e.type]=e.unpack:P1[e.type]=e}var U4=new Array(147);for(let e=0;e<256;e++)U4[e]=+("1e"+Math.floor(45.15-e*.30103));var Td=new Oc({useRecords:!1});Td.unpack;Td.unpackMultiple;Td.unpack;var jk=new Float32Array(1);new Uint8Array(jk.buffer,0,4);var Z0;try{Z0=new TextEncoder}catch{}var Rc,N4,Pd=typeof Buffer<"u",zu=Pd?Buffer.allocUnsafeSlow:Uint8Array,Jy=Pd?Buffer:Uint8Array,l9=Pd?4294967296:2144337920,ye,pi,he=0,Nr,Vr=null,Gk=/[\u0080-\uFFFF]/,Wl=Symbol("record-id"),$y=class extends Oc{constructor(e){super(e),this.offset=0;let t,i,r,s,a,n=0,o=Jy.prototype.utf8Write?function(b,A,S){return ye.utf8Write(b,A,S)}:Z0&&Z0.encodeInto?function(b,A){return Z0.encodeInto(b,ye.subarray(A)).written}:!1,l=this;e||(e={});let h=e&&e.sequential,c=e.structures||e.saveStructures,d=e.maxSharedStructures;if(d==null&&(d=c?32:0),d>8160)throw new Error("Maximum maxSharedStructure is 8160");let u=e.maxOwnStructures;u==null&&(u=c?32:64),h&&!e.saveStructures&&(this.structures=[]);let p=d>32||u+d>64,f=d+64,g=d+u+64;if(g>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let m=[],v=0,y=0;this.pack=this.encode=function(b,A){if(ye||(ye=new zu(8192),pi=new DataView(ye.buffer,0,8192),he=0),Nr=ye.length-10,Nr-he<2048?(ye=new zu(ye.length),pi=new DataView(ye.buffer,0,ye.length),Nr=ye.length-10,he=0):he=he+7&2147483640,t=he,a=l.structuredClone?new Map:null,l.bundleStrings?(Vr=["",""],ye[he++]=214,ye[he++]=98,Vr.position=he-t,he+=4):Vr=null,i=l.structures,i){i.uninitialized&&(i=l._mergeStructures(l.getStructures()));let S=i.sharedLength||0;if(S>d)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+i.sharedLength);if(!i.transitions){i.transitions=Object.create(null);for(let M=0;M<S;M++){let C=i[M];if(!C)continue;let T,P=i.transitions;for(let I=0,D=C.length;I<D;I++){let k=C[I];T=P[k],T||(T=P[k]=Object.create(null)),P=T}P[Wl]=M+64}n=S}h||(i.nextId=S+64)}r&&(r=!1),s=i||[];try{if(x(b),Vr){pi.setUint32(Vr.position+t,he-Vr.position-t);let S=Vr;Vr=null,x(S[0]),x(S[1])}if(l.offset=he,a&&a.idsToInsert){he+=a.idsToInsert.length*6,he>Nr&&_(he),l.offset=he;let S=Wk(ye.subarray(t,he),a.idsToInsert);return a=null,S}return A&qk?(ye.start=t,ye.end=he,ye):ye.subarray(t,he)}finally{if(i){if(y<10&&y++,v>1e4)i.transitions=null,y=0,v=0,m.length>0&&(m=[]);else if(m.length>0&&!h){for(let S=0,M=m.length;S<M;S++)m[S][Wl]=0;m=[]}if(r&&l.saveStructures){let S=i.sharedLength||d;i.length>S&&(i=i.slice(0,S));let M=ye.subarray(t,he);return l.saveStructures(i,n)===!1?(l._mergeStructures(l.getStructures()),l.pack(b)):(n=S,M)}}A&Yk&&(he=t)}};let x=b=>{he>Nr&&(ye=_(he));var A=typeof b,S;if(A==="string"){let M=b.length;if(Vr&&M>=8&&M<4096){let P=Gk.test(b);Vr[P?0:1]+=b,ye[he++]=193,x(P?-M:M);return}let C;M<32?C=1:M<256?C=2:M<65536?C=3:C=5;let T=M*3;if(he+T>Nr&&(ye=_(he+T)),M<64||!o){let P,I,D,k=he+C;for(P=0;P<M;P++)I=b.charCodeAt(P),I<128?ye[k++]=I:I<2048?(ye[k++]=I>>6|192,ye[k++]=I&63|128):(I&64512)===55296&&((D=b.charCodeAt(P+1))&64512)===56320?(I=65536+((I&1023)<<10)+(D&1023),P++,ye[k++]=I>>18|240,ye[k++]=I>>12&63|128,ye[k++]=I>>6&63|128,ye[k++]=I&63|128):(ye[k++]=I>>12|224,ye[k++]=I>>6&63|128,ye[k++]=I&63|128);S=k-he-C}else S=o(b,he+C,T);S<32?ye[he++]=160|S:S<256?(C<2&&ye.copyWithin(he+2,he+1,he+1+S),ye[he++]=217,ye[he++]=S):S<65536?(C<3&&ye.copyWithin(he+3,he+2,he+2+S),ye[he++]=218,ye[he++]=S>>8,ye[he++]=S&255):(C<5&&ye.copyWithin(he+5,he+3,he+3+S),ye[he++]=219,pi.setUint32(he,S),he+=4),he+=S}else if(A==="number")if(b>>>0===b)b<64?ye[he++]=b:b<256?(ye[he++]=204,ye[he++]=b):b<65536?(ye[he++]=205,ye[he++]=b>>8,ye[he++]=b&255):(ye[he++]=206,pi.setUint32(he,b),he+=4);else if(b>>0===b)b>=-32?ye[he++]=256+b:b>=-128?(ye[he++]=208,ye[he++]=b+256):b>=-32768?(ye[he++]=209,pi.setInt16(he,b),he+=2):(ye[he++]=210,pi.setInt32(he,b),he+=4);else{let M;if((M=this.useFloat32)>0&&b<4294967296&&b>=-2147483648){ye[he++]=202,pi.setFloat32(he,b);let C;if(M<4||(C=b*U4[(ye[he]&127)<<1|ye[he+1]>>7])>>0===C){he+=4;return}else he--}ye[he++]=203,pi.setFloat64(he,b),he+=8}else if(A==="object")if(!b)ye[he++]=192;else{if(a){let C=a.get(b);if(C){if(!C.id){let T=a.idsToInsert||(a.idsToInsert=[]);C.id=T.push(C)}ye[he++]=214,ye[he++]=112,pi.setUint32(he,C.id),he+=4;return}else a.set(b,{offset:he-t})}let M=b.constructor;if(M===Object)w(b,!0);else if(M===Array){S=b.length,S<16?ye[he++]=144|S:S<65536?(ye[he++]=220,ye[he++]=S>>8,ye[he++]=S&255):(ye[he++]=221,pi.setUint32(he,S),he+=4);for(let C=0;C<S;C++)x(b[C])}else if(M===Map){S=b.size,S<16?ye[he++]=128|S:S<65536?(ye[he++]=222,ye[he++]=S>>8,ye[he++]=S&255):(ye[he++]=223,pi.setUint32(he,S),he+=4);for(let[C,T]of b)x(C),x(T)}else{for(let C=0,T=Rc.length;C<T;C++){let P=N4[C];if(b instanceof P){let I=Rc[C];if(I.write){I.type&&(ye[he++]=212,ye[he++]=I.type,ye[he++]=0),x(I.write.call(this,b));return}let D=ye,k=pi,H=he;ye=null;let U;try{U=I.pack.call(this,b,F=>(ye=D,D=null,he+=F,he>Nr&&_(he),{target:ye,targetView:pi,position:he-F}),x)}finally{D&&(ye=D,pi=k,he=H,Nr=ye.length-10)}U&&(U.length+he>Nr&&_(U.length+he),he=Hk(U,ye,he,I.type));return}}w(b,!b.hasOwnProperty)}}else if(A==="boolean")ye[he++]=b?195:194;else if(A==="bigint"){if(b<BigInt(1)<<BigInt(63)&&b>=-(BigInt(1)<<BigInt(63)))ye[he++]=211,pi.setBigInt64(he,b);else if(b<BigInt(1)<<BigInt(64)&&b>0)ye[he++]=207,pi.setBigUint64(he,b);else if(this.largeBigIntToFloat)ye[he++]=203,pi.setFloat64(he,Number(b));else throw new RangeError(b+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");he+=8}else if(A==="undefined")this.encodeUndefinedAsNil?ye[he++]=192:(ye[he++]=212,ye[he++]=0,ye[he++]=0);else if(A==="function")x(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+A)},w=this.useRecords===!1?this.variableMapSize?b=>{let A=Object.keys(b),S=A.length;S<16?ye[he++]=128|S:S<65536?(ye[he++]=222,ye[he++]=S>>8,ye[he++]=S&255):(ye[he++]=223,pi.setUint32(he,S),he+=4);let M;for(let C=0;C<S;C++)x(M=A[C]),x(b[M])}:(b,A)=>{ye[he++]=222;let S=he-t;he+=2;let M=0;for(let C in b)(A||b.hasOwnProperty(C))&&(x(C),x(b[C]),M++);ye[S+++t]=M>>8,ye[S+t]=M&255}:b=>{let A=Object.keys(b),S,M=s.transitions||(s.transitions=Object.create(null)),C=0;for(let P=0,I=A.length;P<I;P++){let D=A[P];S=M[D],S||(S=M[D]=Object.create(null),C++),M=S}let T=M[Wl];if(T)T>=96&&p?(ye[he++]=((T-=96)&31)+96,ye[he++]=T>>5):ye[he++]=T;else{T=s.nextId,T||(T=64),T<f&&this.shouldShareStructure&&!this.shouldShareStructure(A)?(T=s.nextOwnId,T<g||(T=f),s.nextOwnId=T+1):(T>=g&&(T=f),s.nextId=T+1);let P=A.highByte=T>=96&&p?T-96>>5:-1;M[Wl]=T,s[T-64]=A,T<f?(A.isShared=!0,s.sharedLength=T-63,r=!0,P>=0?(ye[he++]=(T&31)+96,ye[he++]=P):ye[he++]=T):(P>=0?(ye[he++]=213,ye[he++]=114,ye[he++]=(T&31)+96,ye[he++]=P):(ye[he++]=212,ye[he++]=114,ye[he++]=T),C&&(v+=y*C),m.length>=u&&(m.shift()[Wl]=0),m.push(M),x(A))}for(let P=0,I=A.length;P<I;P++)x(b[A[P]])},_=b=>{let A;if(b>16777216){if(b-t>l9)throw new Error("Packed buffer would be larger than maximum buffer size");A=Math.min(l9,Math.round(Math.max((b-t)*(b>67108864?1.25:2),4194304)/4096)*4096)}else A=(Math.max(b-t<<2,ye.length-1)>>12)+1<<12;let S=new zu(A);return pi=new DataView(S.buffer,0,A),ye.copy?ye.copy(S,0,t,b):S.set(ye.slice(t,b)),he-=t,t=0,Nr=S.length-10,ye=S}}useBuffer(e){ye=e,pi=new DataView(ye.buffer,ye.byteOffset,ye.byteLength),he=0}};N4=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,Hy];Rc=[{pack(e,t,i){let r=e.getTime()/1e3;if((this.useTimestamp32||e.getMilliseconds()===0)&&r>=0&&r<4294967296){let{target:s,targetView:a,position:n}=t(6);s[n++]=214,s[n++]=255,a.setUint32(n,r)}else if(r>0&&r<17179869184){let{target:s,targetView:a,position:n}=t(10);s[n++]=215,s[n++]=255,a.setUint32(n,e.getMilliseconds()*4e6+(r/1e3/4294967296>>0)),a.setUint32(n+4,r)}else if(isNaN(r)){if(this.onInvalidDate)return t(0),i(this.onInvalidDate());let{target:s,targetView:a,position:n}=t(3);s[n++]=212,s[n++]=255,s[n++]=255}else{let{target:s,targetView:a,position:n}=t(15);s[n++]=199,s[n++]=12,s[n++]=255,a.setUint32(n,e.getMilliseconds()*1e6),a.setBigInt64(n+4,BigInt(Math.floor(r)))}}},{pack(e,t,i){let r=Array.from(e),{target:s,position:a}=t(this.structuredClone?3:0);this.structuredClone&&(s[a++]=212,s[a++]=115,s[a++]=0),i(r)}},{pack(e,t,i){let{target:r,position:s}=t(this.structuredClone?3:0);this.structuredClone&&(r[s++]=212,r[s++]=101,r[s++]=0),i([e.name,e.message])}},{pack(e,t,i){let{target:r,position:s}=t(this.structuredClone?3:0);this.structuredClone&&(r[s++]=212,r[s++]=120,r[s++]=0),i([e.source,e.flags])}},{pack(e,t){this.structuredClone?h9(e,16,t):c9(Pd?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let i=e.constructor;i!==Jy&&this.structuredClone?h9(e,Zy.indexOf(i.name),t):c9(e,t)}},{pack(e,t){let{target:i,position:r}=t(1);i[r]=193}}];function h9(e,t,i,r){let s=e.byteLength;if(s+1<256){var{target:a,position:n}=i(4+s);a[n++]=199,a[n++]=s+1}else if(s+1<65536){var{target:a,position:n}=i(5+s);a[n++]=200,a[n++]=s+1>>8,a[n++]=s+1&255}else{var{target:a,position:n,targetView:o}=i(7+s);a[n++]=201,o.setUint32(n,s+1),n+=4}a[n++]=116,a[n++]=t,a.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n)}function c9(e,t){let i=e.byteLength;var r,s;if(i<256){var{target:r,position:s}=t(i+2);r[s++]=196,r[s++]=i}else if(i<65536){var{target:r,position:s}=t(i+3);r[s++]=197,r[s++]=i>>8,r[s++]=i&255}else{var{target:r,position:s,targetView:a}=t(i+5);r[s++]=198,a.setUint32(s,i),s+=4}r.set(e,s)}function Hk(e,t,i,r){let s=e.length;switch(s){case 1:t[i++]=212;break;case 2:t[i++]=213;break;case 4:t[i++]=214;break;case 8:t[i++]=215;break;case 16:t[i++]=216;break;default:s<256?(t[i++]=199,t[i++]=s):s<65536?(t[i++]=200,t[i++]=s>>8,t[i++]=s&255):(t[i++]=201,t[i++]=s>>24,t[i++]=s>>16&255,t[i++]=s>>8&255,t[i++]=s&255)}return t[i++]=r,t.set(e,i),i+=s,i}function Wk(e,t){let i,r=t.length*6,s=e.length-r;for(t.sort((a,n)=>a.offset>n.offset?1:-1);i=t.pop();){let a=i.offset,n=i.id;e.copyWithin(a+r,a,s),r-=6;let o=a+r;e[o++]=214,e[o++]=105,e[o++]=n>>24,e[o++]=n>>16&255,e[o++]=n>>8&255,e[o++]=n&255,s=a}return e}function Cl(e){if(e.Class){if(!e.pack&&!e.write)throw new Error("Extension has no pack or write function");if(e.pack&&!e.type)throw new Error("Extension has no type (numeric code to identify the extension)");N4.unshift(e.Class),Rc.unshift(e)}Vk(e)}var ex=new $y({useRecords:!1});ex.pack;ex.pack;var qk=512,Yk=1024,d9=new $y({structuredClone:!0});Cl({Class:Ke.prototype.constructor,type:1,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,Ke.prototype),e}});Cl({Class:je.prototype.constructor,type:2,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,je.prototype),e}});Cl({Class:s1.prototype.constructor,type:3,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,s1.prototype),e}});Cl({Class:$6.prototype.constructor,type:4,write(e){return e.id},read(e){return new $6(e)}});Cl({Class:e9.prototype.constructor,type:5,write(e){return e.data},read(e){return new e9(e)}});Cl({Class:Ei.prototype.constructor,type:6,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,Ei.prototype),e}});function Xk(e){var t=0;if(e.length===0)return t;for(let i=0;i<e.length;i++){let r=e[i];t=(t<<5)-t+r,t=t&t}return t}function S3(e){if(O4(e))return e;if(Array.isArray(e))return e.map(S3);if(typeof e=="object"&&e!==null){let t={};for(let i of Object.keys(e).sort())t[i]=S3(e[i]);return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}else return e}var _3;(e=>{function t(s){return d9.pack(s)}e.serialize=t;function i(s){return d9.unpack(s)}e.deserialize=i;function r(s){return Xk(t(S3(s))).toString()}e.checksum=r})(_3||(_3={}));var u9;(e=>{function t(r){return r.type==="Conditional"?r.condition.type==="Distance"?"Distance":"StateChange":r.type}e.toEventUIType=t;function i(r){return r==="Distance"||r==="StateChange"?"Conditional":r}e.fromEventUIType=i})(u9||(u9={}));function p9(e){return e==="MouseDown"||e==="MouseUp"||e==="KeyDown"||e==="KeyUp"||e==="Collision"||e==="Trigger"}var d1={LookAt:[],Follow:["Create"],DragDrop:["Transition","Animation","Audio","Particles","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseHover:["Transition","Animation","Particles","Create","Destroy","SwitchCamera","SceneTransition","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Scroll:["Transition","Animation","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Start:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Conditional:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MousePress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyPress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],GameControl:["Transition","Animation","Audio","Particles","Create","Conditional"],Collision:["Transition","Animation","Audio","Particles","Video","Create","Destroy","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Trigger:["Transition","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Resize:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],VariableChange:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],API:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],WEBHOOK:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],AIAssistantListener:["SetVariable"],AIAssistantTrigger:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"]},f9;(e=>{function t(r){return r.type==="MouseDown"||r.type==="MouseUp"||r.type==="MousePress"||r.type==="KeyDown"||r.type==="KeyUp"||r.type==="KeyPress"}e.is=t;function i(r){return r==="MouseDown"||r==="MouseUp"||r==="MousePress"?{type:r,mode:"Object",disabled:!1,actions:new je}:{type:r,disabled:!1,key:void 0,actions:new je}}e.defaultData=i})(f9||(f9={}));var Lc;(e=>{function t(i){return{type:"Property",value:[i??null,"position","x"]}}e.propertyDefaultData=t,e.valueDefaultData={type:"Literal",value:0}})(Lc||(Lc={}));var A3;(e=>{function t(s){return{type:"Comparison",operator:"==",lOperand:Lc.propertyDefaultData(s),rOperand:{...Lc.valueDefaultData}}}e.comparisonDefaultData=t;function i(s){return{type:"Distance",toObject:s??null,fromObject:s??null,distance:200}}e.distanceDefaultData=i;function r(s,a){return{type:"State",object:s??null,state:a??null}}e.stateDefaultData=r})(A3||(A3={}));var m9;(e=>{function t(i){return i.find(r=>r==="ifActions"||r==="elseActions")!==void 0}e.isConditionalSubActions=t})(m9||(m9={}));var g9;(e=>{function t(r){return r.type==="Conditional"}e.is=t;function i(r){return{type:"Conditional",disabled:!1,inActions:new je,outActions:new je,condition:A3.distanceDefaultData(r)}}e.defaultData=i})(g9||(g9={}));var v9;(e=>e.defaultData={type:"DragDrop",cursor:"hand",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",limits:[-1/0,1/0,-1/0,1/0,-1/0,1/0],drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new je,drop:new je}})(v9||(v9={}));var M3;(e=>e.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new je})(M3||(M3={}));var E3;(e=>e.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5})(E3||(E3={}));var y9;(e=>{function t(r){return r.type==="MouseHover"}e.is=t;function i(){return{type:"MouseHover",disabled:!1,actions:new je}}e.defaultData=i})(y9||(y9={}));var x9;(e=>{function t(r){return r.type==="Scroll"}e.is=t;function i(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new je}}e.defaultData=i})(x9||(x9={}));var b9;(e=>{function t(r){return r.type==="Start"}e.is=t;function i(){return{type:"Start",disabled:!1,actions:new je}}e.defaultData=i})(b9||(b9={}));var w9;(e=>{function t(r){return r.type==="Collision"}e.is=t;function i(){return{type:"Collision",disabled:!1,target:"character",actions:new je}}e.defaultData=i})(w9||(w9={}));var S9;(e=>{function t(r){return r.type==="Trigger"}e.is=t;function i(r,s){return{type:"Trigger",disabled:!1,target:"all",triggeringObjects:[],actions:new je,triggerZone:"box",position:s.toArray(),rotation:[0,0,0],size:r.toArray(),radius:r.length()/2,helperVisible:!0}}e.defaultData=i})(S9||(S9={}));var C3;(e=>{e.defaultSizes={mobile:[480,480],tablet:[768,768],desktop:[1200,1200],custom:[769,1200]};function t(n){return n.type==="Resize"}e.is=t;function i(n){return typeof n=="string"?n:"custom"}e.sizeToDevice=i;function r(n){return typeof n=="string"?[...e.defaultSizes[n]]:[...n]}e.deviceToSize=r;function s(){let n={size:"mobile",operator:"<",actions:new je},o={size:"tablet",operator:"<",actions:new je},l={size:[...e.defaultSizes.custom],operator:"<>",actions:new je},h=new je;return h.push({id:Oe.generateUUID(),fi:0,data:n},{id:Oe.generateUUID(),fi:1,data:o},{id:Oe.generateUUID(),fi:2,data:l}),{type:"Resize",disabled:!1,orientation:"horizontal",breakpoints:h}}e.defaultData=s;function a(){return{size:[...e.defaultSizes.custom],operator:"<>",actions:new je}}e.defaultBreakpointData=a})(C3||(C3={}));var T3;(e=>{e.propertyPaths={Position:["position"],"Position X":["position","x"],"Position Y":["position","y"],"Position Z":["position","z"],Rotation:["rotation"],"Rotation X":["rotation","x"],"Rotation Y":["rotation","y"],"Rotation Z":["rotation","z"],Scale:["scale"],"Scale X":["scale","x"],"Scale Y":["scale","y"],"Scale Z":["scale","z"],Width:["width"],Height:["height"],Depth:["depth"],"Mouse Position X":["mouse","x"],"Mouse Position Y":["mouse","y"],"Mouse Pressed":["mouse","pressed"],"Screen Width":["mouse","width"],"Screen Height":["mouse","height"],"Hit Position X":["raycast","x"],"Hit Position Y":["raycast","y"],"Hit Position Z":["raycast","z"],"Hit Object Position X":["raycast","objX"],"Hit Object Position Y":["raycast","objY"],"Hit Object Position Z":["raycast","objZ"]};function t(r){return r.type==="VariableChange"}e.is=t;function i(){return{disabled:!1,type:"VariableChange",actions:new je,variableId:"",objectId:null,property:"Position X"}}e.defaultData=i})(T3||(T3={}));var _9;(e=>{function t(r){return r.type==="API"}e.is=t;function i(){return{disabled:!1,type:"API",successActions:new je,errorActions:new je,userAPIId:""}}e.defaultData=i})(_9||(_9={}));var A9;(e=>{function t(r){return r.type==="WEBHOOK"}e.is=t;function i(){return{disabled:!1,type:"WEBHOOK",actions:new je,userWebhookId:""}}e.defaultData=i})(A9||(A9={}));var M9;(e=>{function t(r){return r.type==="AIAssistantListener"}e.is=t;function i(){return{disabled:!1,type:"AIAssistantListener",actions:new je,analysis:"average",analysisRange:[0,71],analysisSingle:0}}e.defaultData=i})(M9||(M9={}));var E9;(e=>{function t(r){return r.type==="AIAssistantTrigger"}e.is=t;function i(){return{disabled:!1,description:"",type:"AIAssistantTrigger",actions:new je}}e.defaultData=i})(E9||(E9={}));var Tl="personal camera",A2="a218fcc3-276b-49b9-b485-49037fd14f5f",Qk=2960946,Y1=5526619,Ys;(e=>{function t(f,g){return f[0]===g[0]&&f[1]===g[1]}e.isEqual=t;function i(f,g,m){return[f[0]+(g[0]-f[0])*m,f[1]+(g[1]-f[1])*m]}e.lerp=i;function r(f,g){return[f[0]+g[0],f[1]+g[1]]}e.add=r;function s(f,g){return[f[0]-g[0],f[1]-g[1]]}e.sub=s;function a(f,g){return[f[0]*g[0],f[1]*g[1]]}e.multiply=a;function n(f,g){return[f[0]/g[0],f[1]/g[1]]}e.divide=n;function o(f,g){return Math.pow(g[0]-f[0],2)+Math.pow(g[1]-f[1],2)}e.distanceSquared=o;function l(f,g){return Math.sqrt(o(f,g))}e.distance=l;function h(f,g){return f[0]*g[0]+f[1]*g[1]}e.dot=h;function c(f,g){return[f[0]*g,f[1]*g]}e.scalarMultiply=c;function d(f,g,m){let v=e.sub(g,f),y=e.sub(m,f),x=e.dot(v,y)/e.dot(v,v),w=e.scalarMultiply(v,x);return e.add(f,w)}e.projectionOnto=d;function u(f,g,m){return l(f,d(f,g,m))}e.projectionOntoDistance=u;function p(f,g){return[(f[0]+g[0])*.5,(f[1]+g[1])*.5]}e.center=p})(Ys||(Ys={}));var In;(e=>{function t(l,h){return l[0]===h[0]&&l[1]===h[1]&&l[2]===h[2]}e.isEqual=t;function i(l,h){return[l[0]+h[0],l[1]+h[1],l[2]+h[2]]}e.add=i;function r(l,h){return[l[0]-h[0],l[1]-h[1],l[2]-h[2]]}e.sub=r;function s(l,h){return[l[0]/h[0],l[1]/h[1],l[2]/h[2]]}e.div=s;function a(l,h){return[l[0]*h[0],l[1]*h[1],l[2]*h[2]]}e.mul=a;function n(l,h){return Math.hypot(l[0]-h[0],l[1]-h[1],l[2]-h[2])}e.dist=n;function o(l,h,c){return[l[0]+(h[0]-l[0])*c,l[1]+(h[1]-l[1])*c,l[2]+(h[2]-l[2])*c]}e.lerp=o})(In||(In={}));var Bc;(e=>{function t(r,s){return r[0]===s[0]&&r[1]===s[1]&&r[2]===s[2]&&r[3]===s[3]}e.isEqual=t;function i(r,s,a){return[r[0]+(s[0]-r[0])*a,r[1]+(s[1]-r[1])*a,r[2]+(s[2]-r[2])*a,r[3]+(s[3]-r[3])*a]}e.lerp=i})(Bc||(Bc={}));var C9;(e=>{let t=180/Math.PI,i=Math.PI/180;function r(o){return typeof o=="number"?o*t:o}function s(o){return typeof o=="number"?o*i:o}function a(o){return[r(o[0]),r(o[1]),r(o[2])]}e.radToDeg=a;function n(o){return[s(o[0]),s(o[1]),s(o[2])]}e.degToRad=n})(C9||(C9={}));var ol;(e=>{e.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(s,a){for(let n=0;n<16;n++)if(s[n]!==a[n])return!1;return!0}e.isEqual=t;function i(s){return s??e.identity}e.simplify=i;function r(s,a){let n=a.slice(0);for(var o=0,l=a.length;o<l;o+=3){let h=s[3]*a[o]+s[7]*a[o+1]+s[11]*a[o+2]+s[15];n[o]=(s[0]*a[o]+s[4]*a[o+1]+s[8]*a[o+2]+s[12])/h,n[o+1]=(s[1]*a[o]+s[5]*a[o+1]+s[9]*a[o+2]+s[13])/h,n[o+2]=(s[2]*a[o]+s[6]*a[o+1]+s[10]*a[o+2]+s[14])/h}return n}e.applyMatrix4=r})(ol||(ol={}));var i1;(e=>{function t(h){return typeof h=="object"&&typeof h.r=="number"&&typeof h.g=="number"&&typeof h.b=="number"}e.isRGB=t,e.white={r:1,g:1,b:1},e.red={r:1,g:0,b:0},e.black={r:0,g:0,b:0};function i(h){return{r:Math.round(h.r*255),g:Math.round(h.g*255),b:Math.round(h.b*255),a:1}}e.toRgb255a1=i;function r(h){return{r:h.r,g:h.g,b:h.b}}e.clone=r;function s(h){return h=Math.floor(h),{r:(h>>16&255)/255,g:(h>>8&255)/255,b:(h&255)/255}}e.fromHex=s;function a(h){return Math.round(h.r*255)*65536+Math.round(h.g*255)*256+Math.round(h.b*255)}e.toHex=a;function n(h,c){return h.r===c.r&&h.g===c.g&&h.b===c.b}e.equals=n;function o(h,c){return h.r.toFixed(2)===c.r.toFixed(2)&&h.g.toFixed(2)===c.g.toFixed(2)&&h.b.toFixed(2)===c.b.toFixed(2)}e.equalsFixed=o;function l(h,c,d){return{r:h.r+(c.r-h.r)*d,g:h.g+(c.g-h.g)*d,b:h.b+(c.b-h.b)*d}}e.lerp=l})(i1||(i1={}));var jt;(e=>{e.white={...i1.white,a:1},e.transparent={...i1.white,a:0};function t(l){return{r:l[0],g:l[1],b:l[2],a:l[3]}}e.from0to1=t;function i(l,h){return{...i1.fromHex(l),a:h}}e.fromHexAndA=i;function r(l){return{r:Math.round(l.r*255),g:Math.round(l.g*255),b:Math.round(l.b*255),a:l.a}}e.toRgb255a1=r;function s(l,h){return i1.equals(l,h)&&l.a===h.a}e.equals=s;function a(l,h){return i1.equalsFixed(l,h)&&l.a.toFixed(2)===h.a.toFixed(2)}e.equalsFixed=a;function n(l,h,c){return{r:l.r+(h.r-l.r)*c,g:l.g+(h.g-l.g)*c,b:l.b+(h.b-l.b)*c,a:l.a+(h.a-l.a)*c}}e.lerp=n;function o({r:l,g:h,b:c,a:d}=e.white){return`rgba(${l*255}, ${h*255}, ${c*255}, ${d})`}e.toStyle=o})(jt||(jt={}));var P3;(e=>e.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(P3||(P3={}));var T9;(e=>e.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(T9||(T9={}));var P9;(e=>e.defaultData={control1:[.5,0],control2:[.5,1]})(P9||(P9={}));var _a;(e=>(e.linear=[0,0,1,1],e.ease=[.25,.1,.25,1],e.easeIn=[.42,0,1,1],e.easeOut=[0,0,.58,1],e.easeInOut=[.42,0,.58,1]))(_a||(_a={}));function D9(e){return typeof e=="string"&&e.length===36?/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e):!1}var kn;(e=>{e.all=["PerspectiveCamera","OrthographicCamera"];function t(i){return e.all.includes(i)}e.is=t})(kn||(kn={}));var ll;(e=>{e.DefaultUp=[0,1,0],e.DefaultTargetOffset=1e3,e.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:e.DefaultUp,isUpVectorFlipped:!1,targetOffset:e.DefaultTargetOffset};function t(i){var r,s;return i.type==="PerspectiveCamera"?((r=i.perspective)==null?void 0:r.zoom)??1:((s=i.orthographic)==null?void 0:s.zoom)??1}e.getZoom=t})(ll||(ll={}));var Ia;(e=>{function t(r,s=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(r[0],r[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[r[0]+r[0]*s,0,0]},grid:{count:[2,2,2],size:r.map(a=>a*(1+s)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}e.defaultData=t;function i(r,s){let a={...r};if(tx.forEach(n=>{Object.assign(a,{[n]:s[n]??r[n]})}),a.radial={...r.radial},s.radial){let n=r.radial,o=s.radial;ix.forEach(l=>{Object.assign(a.radial,{[l]:o[l]??n[l]})})}if(a.linear={...r.linear},s.linear){let n=r.linear,o=s.linear;rx.forEach(l=>{Object.assign(a.linear,{[l]:o[l]??n[l]})})}if(a.grid={...r.grid},s.grid){let n=r.grid,o=s.grid;sx.forEach(l=>{Object.assign(a.grid,{[l]:o[l]??n[l]})})}if(a.toObject={...r.toObject},s.toObject){let n=r.toObject,o=s.toObject;ax.forEach(l=>{Object.assign(a.toObject,{[l]:o[l]??n[l]})})}if(a.randomnessObject={...r.randomnessObject},s.randomnessObject){let n=r.randomnessObject,o=s.randomnessObject;nx.forEach(l=>{Object.assign(a.randomnessObject,{[l]:o[l]??n[l]})})}return a}e.merge=i})(Ia||(Ia={}));var D3;(e=>{e.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let t=["radial","linear","grid","toObject","randomnessObject"];function i(r,s){let a=[];r.count!==void 0&&a.push({type:0,path:s,props:{count:r.count}});for(let n of t){let o=r[n];o&&Object.keys(o).length>0&&a.push({type:0,path:[...s,n],props:o})}return a}e.toOps=i})(D3||(D3={}));var tx=["count"],ix=["radius","start","end","position","scale","rotation"],rx=["position","scale","rotation"],sx=["count","size"],ax=["count","position","scale","rotation"],nx=["strength","scale","rotation","position","movement","seed","freqScale"],I3;(e=>{e.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function t(i){return e.all.includes(i)}e.is=t})(I3||(I3={}));var O3;(e=>{function t(r){return i(r)}e.defaultData=t;function i(r){if(r==="PointLight")return{type:r,color:jt.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if(r==="SpotLight")return{type:r,color:jt.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if(r==="DirectionalLight")return{type:r,color:jt.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})(O3||(O3={}));var zc;(e=>(e.defaultShapeData={type:"PlaneEmitterShape",size:[100,100,100]},e.defaultCollisionData={colliderEntityId:null,collisionBounce:.75},e.defaultData={renderMaterial:{type:"particleMaterial",color:{r:1,g:.2,b:.545,a:1},color2:{r:.945,g:.714,b:.184,a:1},coloring:"gradient",ease:"linearFadeOut",easeSize:"linearFadeOut",transparent:!0,size:[40,40],texture:"pt_default_particle",spriteRotation:[0,0]},birthRatePerSec:50,gravity:1,noiseStrength:0,noiseScale:0,noiseSeed:1,noiseType:"curl",randomRotation:0,randomScale:.2,randomMass:.5,rootObjectType:"instancedMesh",life:1,direction:[0,0,0],directionMode:"axis",speed:10,shape:e.defaultShapeData,autoPlay:!0,emitTimeDelay:0,emitTimeCycle:"infinity",emitTimeDuration:1,...e.defaultCollisionData}))(zc||(zc={}));var hl;(e=>e.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})(hl||(hl={}));var R3;(e=>{e.defaultData={castShadow:!0,receiveShadow:!0};function t(i,r){return i.castShadow===r.castShadow&&i.receiveShadow===r.receiveShadow}e.equals=t})(R3||(R3={}));var L3;(e=>{e.defaultData={flatShading:!1,wireframe:!1,side:0};function t(i,r){return i.flatShading===r.flatShading&&i.side===r.side&&i.wireframe===r.wireframe}e.equals=t})(L3||(L3={}));var B3;(e=>e.defaultData={...L3.defaultData,...R3.defaultData})(B3||(B3={}));var I9;(e=>{function t(i,r){var a,n;let s=[];if("material"in i){let o=typeof i.material=="string"?r.materials[i.material]??((a=r.lib.materials[i.material])==null?void 0:a.asset):i.material;o&&s.push(o)}else if("materials"in i)for(let o of i.materials){let l=typeof o=="string"?r.materials[o]??((n=r.lib.materials[o])==null?void 0:n.asset):o;l&&s.push(l)}return s}e.getMaterialData=t})(I9||(I9={}));var Fc;(e=>(e.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},e.maxSize=3e7))(Fc||(Fc={}));var O9;(e=>{function t(i){return i==="texture"||i==="video"||i==="color"||i==="depth"||i==="normal"||i==="gradient"||i==="noise"||i==="fresnel"||i==="rainbow"||i==="toon"||i==="outline"||i==="particle"||i==="transmission"||i==="matcap"||i==="displace"||i==="pattern"||i==="light"}e.is=t})(O9||(O9={}));function Zk(e){return e.type!=="displace"}var R9;(e=>{function t(i){return i==="phong"||i==="toon"||i==="lambert"||i==="physical"}e.is=t})(R9||(R9={}));var ox=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],Kk=["wrapping","image","video","name","minFilter","magFilter"],ji;(e=>{function t(a,n){let{texture:o,...l}=n;if(Object.assign(a,l),o){let h=a.texture;h&&Object.assign(h,o)}}e.patch=t;function i(a,n){return a==="light"&&n?r(n):s(a)}e.defaultData=i;function r(a){let n={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(a){case"phong":return{...n,category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6};case"toon":return{...n,category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1};case"lambert":return{...n,category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0};case"physical":return{...n,category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0}}}function s(a){let n={alpha:1,mode:0,isMask:!1,visible:!0};switch(a){case"texture":return{...n,type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1};case"video":return{...n,type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:Fc.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1};case"color":return{...n,type:"color",color:i1.fromHex(Y1)};case"depth":return{...n,type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{...n,type:"normal",cnormal:[1,1,1]};case"gradient":return{...n,type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{...n,type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...i1.fromHex(6710886),a:1},colorB:{...i1.fromHex(6710886),a:1},colorC:{...i1.fromHex(16777215),a:1},colorD:{...i1.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1};case"fresnel":return{...n,type:"fresnel",color:jt.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{...n,type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{...n,type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:jt.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{...n,type:"outline",outlineColor:jt.fromHexAndA(0,1),contourColor:jt.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{...n,type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006}};case"transmission":return{...n,type:"transmission",thickness:10,ior:1.5,roughness:1};case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return{...n,type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:{...i1.fromHex(0),a:1},colorB:{...i1.fromHex(16777215),a:1},frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6}}}})(ji||(ji={}));var a1;(e=>{function t(c){return!c.layers.some(d=>d.data.type==="texture"&&d.data.projection!==0||d.data.type==="depth"&&!d.data.isWorldSpace||d.data.type==="noise"||d.data.type==="displace")}e.isMergable=t;function i(c){let d="";return c.layers.forEach(u=>{Object.entries(u.data).forEach(([p,f])=>{d+=`${p}${f}`,Array.isArray(f)?f.forEach(g=>d+=`${g}`):typeof f=="object"?Object.values(f).forEach(g=>{typeof g=="number"?d+=`${g.toFixed(4)}`:d+=`${g}`}):d+=`${f}`})}),d}e.getHash=i;function r(){return{layers:new je}}e.defaultEmptyData=r;function s(c="layer1",d="layer2"){return n("phong",c,d)}e.defaultData=s;function a(c,d){return{...c,name:d}}e.withName=a;function n(c,d="layer1",u="layer2"){let p=new je;return p.push({fi:0,data:ji.defaultData("light",c),id:d}),p.push({fi:1,data:ji.defaultData("color"),id:u}),{layers:p}}e.defaultTwoLayerData=n;function o(c){let d=ji.defaultData("texture");c&&Object.assign(d.texture,{image:c});let u=new je;return u.push({fi:0,data:d,id:"layer1"}),u.push({fi:1,data:{...ji.defaultData("transmission"),alpha:1},id:"layer2"}),u.push({fi:2,data:{...ji.defaultData("light","lambert"),alpha:0},id:"layer3"}),{layers:u}}e.defaultUIObjectMaterial=o;function l(c,d="phong",u="layer1",p="layer2"){let f=ji.defaultData("texture");Object.assign(f.texture,{image:c});let g=new je;return g.push({fi:0,data:f,id:u}),g.push({fi:1,data:ji.defaultData("light",d),id:p}),{layers:g}}e.defaultTwoLayerTextureData=l;function h(c,d="phong",u="layer1",p="layer2"){let f=ji.defaultData("video");Object.assign(f.texture,{video:c});let g=new je;return g.push({fi:0,data:f,id:u}),g.push({fi:1,data:ji.defaultData("light",d),id:p}),{layers:g}}e.defaultTwoLayerVideoTextureData=h})(a1||(a1={}));var kc;(e=>{function t(){return{points:new je,roundness:0,shapeHoles:[],isClosed:!1}}e.defaultData=t})(kc||(kc={}));var Uc;(e=>{function t(){return{points:new je,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}e.defaultData=t})(Uc||(Uc={}));var lx={type:"Ellipse",width:50,height:50,spikes:16,angle:360,innerRadius:0},z3;(e=>{function t(i,r){let s={...i};return cx.forEach(a=>{Object.assign(s,{[a]:r[a]??i[a]})}),s}e.merge=t})(z3||(z3={}));var hx={shape:lx,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},cx=["depth","offset","angle","twist","startScale","endScale"],Nc;(e=>{function t(r){return r==="PolygonGeometry"||r==="RectangleGeometry"||r==="StarGeometry"||r==="TriangleGeometry"||r==="EllipseGeometry"||r==="UIGeometry"}e.is2DParametricMesh=t;function i(r){return r==="PolygonGeometry"||r==="PolygonGeometry"||r==="RectangleGeometry"||r==="StarGeometry"||r==="TriangleGeometry"||r==="EllipseGeometry"||r==="PathGeometry"||r==="VectorGeometry"||r==="ConeGeometry"||r==="CubeGeometry"||r==="CylinderGeometry"||r==="DodecahedronGeometry"||r==="HelixGeometry"||r==="IcosahedronGeometry"||r==="LatheGeometry"||r==="PyramidGeometry"||r==="SphereGeometry"||r==="PlaneGeometry"||r==="BackdropGeometry"||r==="TorusGeometry"||r==="TorusKnotGeometry"||r==="BooleanGeometry"||r==="TextGeometry"||r==="InputGeometry"}e.isParametricMesh=i})(Nc||(Nc={}));var F3;(e=>{function t(i,r){let s={...i};return Object.assign(s,r),s.type==="PathGeometry"&&"extrusion"in r&&r.extrusion&&(s.extrusion={...i.extrusion},Object.assign(s.extrusion,z3.merge(s.extrusion,r.extrusion))),s}e.merge=t})(F3||(F3={}));var yn;(e=>{function t(i){if(i==="RectangleGeometry")return{width:320,height:320,type:i,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="UIGeometry")return{type:i,frame:"",cornerRadius:[0,0,0,0],cornerType:0,width:1,height:1};if(i==="PathGeometry")return{type:i,width:1,height:1,depth:1,path:Uc.defaultData(),extrusion:hx};if(i==="VectorGeometry")return{width:1,height:1,type:i,subdivisions:12,shape:kc.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="BooleanGeometry")return{type:i,operation:2,width:0,height:0,depth:0,phongAngle:35};if(i==="TextGeometry")return{type:i,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:{textValue:""},textTransform:1,font:"Roboto_regular",editable:!1,extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="InputGeometry")return{...e.defaultData("TextGeometry"),type:i,editable:!0};if(i==="SphereGeometry")return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180};throw new Error("not implemented")}e.defaultData=t})(yn||(yn={}));var Fu=["width","height","depth"],k3;(e=>e.defaultData={enabled:!1,useBackgroundColor:!1,color:i1.white,near:.1,far:2e3})(k3||(k3={}));var Vc;(e=>{let t={opacity:1,blendFunction:13,enabled:!1};e.defaultData={enabled:!1,pixelation:{...t,blendFunction:16,granularity:15},bloom:{...t,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...t,offset:[2,2]},vignette:{...t,darkness:1,offset:0},hueSaturation:{...t,hue:3,saturation:0},brightnessContrast:{...t,brightness:.25,contrast:0},depthOfField:{...t,focusDistance:100,focalLength:20,bokehScale:5},noise:{...t,blendFunction:16}}})(Vc||(Vc={}));var U3;(e=>e.defaultData={softShadowQuality:"low"})(U3||(U3={}));var N3;(e=>e.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75})(N3||(N3={}));var V3;(e=>e.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}})(V3||(V3={}));var cl;(e=>e.defaultData={usePhysics:!1,gravity:-10})(cl||(cl={}));var j3;(e=>e.defaultData={playCamera:Tl,gameControlObject:null})(j3||(j3={}));var G3;(e=>e.defaultData={backgroundColor:jt.fromHexAndA(Qk,1),postprocessing:Vc.defaultData,fog:k3.defaultData,globalPhysics:cl.defaultData,ambient:N3.defaultData,ao:V3.defaultData,shadow:U3.defaultData,publish:j3.defaultData})(G3||(G3={}));var H3;(e=>e.defaultData={colliderType:"box",size:[100,100,100],colliderHelperVisible:!0,forceType:"collider",forceRange:"global",forceIntensity:.5,forceDambing:.95})(H3||(H3={}));var L9;(e=>{function t(r){return r==="Component"||r==="Instance"}e.isComponentRelated=t;function i(r){return r==="Empty"||r==="Instance"}e.isEmptyOrComponent=i})(L9||(L9={}));var dl;(e=>{e.identity={...P3.identity,hiddenMatrix:ol.identity};function t(s){return{position:s.position,rotation:s.rotation,scale:s.scale,hiddenMatrix:s.hiddenMatrix}}e.fromObject=t;function i(s,a){return{position:(a==null?void 0:a.position)||s.position,rotation:(a==null?void 0:a.rotation)||s.rotation,scale:(a==null?void 0:a.scale)||s.scale,hiddenMatrix:(a==null?void 0:a.hiddenMatrix)||s.hiddenMatrix}}e.merge=i;function r(s,a){return Ey({position:In.isEqual(s.position,a.position)?void 0:a.position,rotation:In.isEqual(s.rotation,a.rotation)?void 0:a.rotation,scale:In.isEqual(s.scale,a.scale)?null:a.scale,hiddenMatrix:ol.isEqual(s.hiddenMatrix,a.hiddenMatrix)?void 0:a.hiddenMatrix})}e.diff=r})(dl||(dl={}));var Xi;(e=>e.defaultData={states:new je,events:new je,visible:!0,raycastLock:!1,physics:hl.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...dl.identity,cloner:null})(Xi||(Xi={}));var W3;(e=>e.defaultData={type:"Empty",...Xi.defaultData})(W3||(W3={}));var B9;(e=>e.defaultData={type:"ParticleCollider",...H3.defaultData,...Xi.defaultData})(B9||(B9={}));var z9;(e=>e.defaultData={type:"Component",...Xi.defaultData})(z9||(z9={}));var F9;(e=>e.defaultData={type:"Particle",...Xi.defaultData,...zc.defaultData})(F9||(F9={}));var xn;(e=>e.defaultData={type:"Mesh",...Xi.defaultData,...B3.defaultData})(xn||(xn={}));var W2;(e=>e.defaultData={...Xi.defaultData,...dl.identity,position:[0,0,ll.DefaultTargetOffset],...ll.defaultData})(W2||(W2={}));var q3;(e=>{function t(i){return{...Xi.defaultData,...O3.defaultData(i)}}e.defaultData=t,e.defaultDirectionalLightData={...e.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7}})(q3||(q3={}));var jc;(e=>{function t(r,s,a=0){for(;a<s.length;){let n=r?r[s[a]]:void 0;if(s.length===a+1)return n;if(n)r=n.descendants,a+=1;else return}}e.resolveWithDes=t;function i(r,s,a=0){let n=t(r,s,a);if(n){let o=Object.keys(n);if(o.length===1&&o[0]==="descendants")return}return n}e.resolve=i})(jc||(jc={}));var Oa;(e=>{e.rootOverrideProps=["physics","events"],e.compositeNonOptionalOverrideProps=["geometry"],e.compositeEntireOverrideOverrideProps=["material"];function t(r,s){return{...Xi.defaultData,...s,component:r,overrides:new Ei,physics:void 0,events:void 0,type:"Instance"}}e.ofComponent=t;function i(r){let s=dl.fromObject(r.data);return t(r.id,s)}e.fromComponentData=i})(Oa||(Oa={}));var ul;(e=>{e.defaultData={type:"Page",...Xi.defaultData,physics:{...hl.defaultData,fusedBody:!1},...G3.defaultData,camera:W2.defaultData};function t(i){return i.uiScene!==void 0}e.isUIPage=t})(ul||(ul={}));var Y3;(e=>(e.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:ol.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:hl.defaultData,states:new je,events:new je,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...ll.defaultData},e.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},e.defaultMeshObject={name:"Rectangle",...Xi.defaultData,...xn.defaultData,geometry:yn.defaultData("RectangleGeometry"),material:a1.defaultTwoLayerData("phong","layer1","layer2")},e.defaultBooleanObject={name:"Boolean",...Xi.defaultData,...xn.defaultData,geometry:yn.defaultData("BooleanGeometry"),material:a1.defaultTwoLayerData("phong","layer1","layer2")},e.defaultTextObject={name:"Text",...Xi.defaultData,...xn.defaultData,geometry:yn.defaultData("TextGeometry"),material:a1.defaultTwoLayerData("phong","layer1","layer2")},e.defaultInputObject={name:"Input",...Xi.defaultData,...xn.defaultData,geometry:yn.defaultData("InputGeometry"),material:a1.defaultTwoLayerData("phong","layer1","layer2")}))(Y3||(Y3={}));var bn;(e=>{function t(a,n){let o={name:n};return a.type==="Mesh"?(o.geometry={},"material"in a&&(o.material={layers:new Ei}),"materials"in a&&(o.materials=a.materials.map(l=>({layers:new Ei})))):kn.is(a.type)&&(o.perspective={},o.orthographic={}),o}e.newEmpty=t;function i(a,n){if(n===void 0)return a;let o={...a};return"material"in o&&"material"in n&&n.material&&(o.material=H2(o.material,l=>{if(typeof l!="string")for(let[h,c]of Object.entries(n.material.layers)){let d=l.layers.data(h);d&&ji.patch(d,c)}}).data),o.materials&&n.materials&&(o.materials=H2(o.materials,l=>{var h,c;for(let d=0;d<o.materials.length;d++){let u=n.materials[d];if(typeof u!="string")for(let[p,f]of Object.entries(u.layers)){let g=(c=(h=l[d])==null?void 0:h.layers)==null?void 0:c.data(p);g&&ji.patch(g,f)}}}).data),o}function r(a,n){let o,l=[],h={orthographic:0,perspective:0,geometry:0};function c(d,u){for(let[p,f]of Object.entries(u.layers)){let{texture:g,...m}=f;if(g!==void 0&&Object.keys(g).length>0){let v={path:[...d,"layers",p,"texture"],props:g,type:0};l.push(v)}if(Object.keys(m).length>0){let v={path:[...d,"layers",p],props:m,type:0};l.push(v)}}}for(let[d,u]of Object.entries(n))if(d!=="name")if(d==="cloner")l.push(...D3.toOps(u,["cloner"]));else if(d==="pathSnapping")l.push({path:[d],props:{slide:u.slide,offset:u.offset},type:0});else if(d==="material")c(["material"],u);else if(d==="materials")for(let[p,f]of Object.entries(u))c(["materials",p],f);else if(h[d]===0){if(d==="geometry"&&u.extrusion!==void 0){let p={path:[d,"extrusion"],props:u.extrusion,type:0};l.push(p),u={...u},delete u.extrusion}if(Object.keys(u).length>0){let p={path:[d],props:u,type:0};l.push(p)}}else o===void 0&&(o={path:[],props:{},type:0},l.push(o)),o.props[d]=u;return l}e.toOps=r;function s(a,n){var l,h,c,d,u,p;if(n===void 0)return a;let o={...a};if(Object.assign(o,dl.merge(o,n)),Object.assign(o,{pathSnapping:Object.assign({},o.pathSnapping,{slide:((l=n.pathSnapping)==null?void 0:l.slide)??((h=o.pathSnapping)==null?void 0:h.slide)??0,offset:((c=n.pathSnapping)==null?void 0:c.offset)??((d=o.pathSnapping)==null?void 0:d.offset)??0})}),kn.is(a.type)){o.orthographic={...o.orthographic},o.perspective={...o.perspective};let f=n;((u=f.orthographic)==null?void 0:u.zoom)!==void 0&&(o.orthographic.zoom=f.orthographic.zoom),((p=f.perspective)==null?void 0:p.zoom)!==void 0&&(o.perspective.zoom=f.perspective.zoom),f.isUpVectorFlipped!==void 0&&(o.isUpVectorFlipped=f.isUpVectorFlipped),f.targetOffset!==void 0&&(o.targetOffset=f.targetOffset)}else if(a.type==="Mesh")"geometry"in n&&Object.assign(o,{geometry:F3.merge(o.geometry,n.geometry)}),(n.material||n.materials)&&(o=i(o,n)),o.cloner&&"cloner"in n&&Object.assign(o,{cloner:Ia.merge(o.cloner,n.cloner)});else if(a.type==="Empty")o.cloner&&"cloner"in n&&Object.assign(o,{cloner:Ia.merge(o.cloner,n.cloner)});else if(I3.is(a.type)){let f=n;f.intensity!==void 0&&(o.intensity=f.intensity),f.color!==void 0&&(typeof f.color=="string"?o.color=f.color:o.color=i1.clone(f.color))}return o}e.patch=s})(bn||(bn={}));var Gc;(e=>e.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,hoverRotateDamping:.125,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0})(Gc||(Gc={}));var Ra;(e=>e.defaultData={orbitControls:Gc.defaultData,playPage:A2,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map((t,i)=>{let r=0,s=0;return i<5?s=-30:i<10&&(s=30),i===0||i===10||i===5?r=30:(i===4||i===11||i===9)&&(r=-30),[120,[r,s],"show"]}),settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1,imageQuality:70}},stopRaycast:!0,hdTransmission:!1})(Ra||(Ra={}));var X3;(e=>e.defaultData={id:"basic",label:"Basic",style:"None",prompt:""})(X3||(X3={}));var Q3;(e=>e.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0})(Q3||(Q3={}));var wn;(e=>(e.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:{...X3.defaultData},isRandomSeed:!0,seed:e.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:Q3.defaultData}),e.generateSeed=()=>Math.round(Math.random()*1e5)))(wn||(wn={}));var q2;(e=>{function t(r){return r.find(s=>s.data.type==="Page"&&s.data.globalPhysics.usePhysics)!==void 0}e.physicsEnabled=t;function i(r,s,a){r.scene.objects.traverseFrom(s,(n,o)=>{var l;if(o.type==="Instance"){let h=(l=qc.getComponentData(r,o.component))==null?void 0:l.data;h&&a(n,o,h.events)}else a(n,o,o.events)})}e.traverseModuleInstances=i})(q2||(q2={}));var Sn;(e=>{e.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222",e.defaultLight={fi:-1,data:q3.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]};function t(s=!0,a=[]){let n=[],o=Y3.defaultMeshObject;s&&(n.push({...e.defaultLight}),n.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:o,children:[]})),n.push(...a);let l=new s1;return l.push({fi:1,id:A2,data:{...ul.defaultData,name:"Scene 1"},children:n}),l}e.createDefaultObjectTreeWithPage=t,e.defaultData={objects:t(),publish:Ra.defaultData,styles:wn.defaultData()},e.emptyDataWithoutPage=function(){return{objects:new s1,publish:Ra.defaultData,styles:wn.defaultData()}},e.emptyDataWithPage=function(s=!0){return{objects:t(s),publish:Ra.defaultData,styles:wn.defaultData()}},e.emptyData=function(){return{objects:new s1,publish:{...Ra.defaultData},styles:wn.defaultData()}};function i(s){return{...e.defaultData,objects:ur(s,s1.prototype)}}e.withObjs=i;function r(s,a){return i([{id:s,data:a,children:[],fi:0}])}e.withObj=r})(Sn||(Sn={}));var M2;(e=>e.defaultData={preset:"fullscreen",allowResponsive:!1,size:[512,512],coords:[0,0],sceneScale:1,color:{r:0,g:0,b:0,a:.5}})(M2||(M2={}));var Z3;(e=>(e.defaultData=t=>({url:t,name:"New Webhook",parametersSchemas:new je}),e.defaultParameterValueByType=t=>t==="number"?0:t==="boolean"?!1:""))(Z3||(Z3={}));var k9;(e=>e.defaultData=(t,i="GET")=>({url:t,method:i,name:"New API",headers:new je,queries:new je,autoStart:!0}))(k9||(k9={}));var n1;(e=>{function t(n){return n.textValue!==void 0}e.isTextValue=t;function i(n){return typeof n=="number"}e.isNumber=i;function r(n){return typeof n=="boolean"}e.isBoolean=r;function s(n){return t(n)?"string":r(n)?"boolean":"number"}e.typeOfVariable=s;function a(n){return e.isTextValue(n)?Array.isArray(n.textValue)?n.textValue.map(o=>o.toString().padStart(n.padding??2,"0")).join(n.deliminator??":")+(n.suffix!==void 0?" "+n.suffix:""):n.textValue.toString():e.isBoolean(n)?n?"True":"False":e.isNumber(n)?parseFloat(n.toFixed(3)).toString():n.toString()}e.getDisplayedValue=a})(n1||(n1={}));var K3;(e=>e.all=["images","videos","colors","audios","particles","fonts","materials","variables"])(K3||(K3={}));var U9;(e=>e.all=[...K3.all,"components"])(U9||(U9={}));var N9;(e=>{function t(){return{images:new Ke,videos:new Ke,colors:new Ke,audios:new Ke,particles:new Ke,fonts:new Ke,materials:new Ke,components:new Ke,variables:new Ke,userAPIs:new Ke,userWebhooks:new Ke}}e.defaultData=t})(N9||(N9={}));var ta;(e=>{function t(){return{images:new Ke,videos:new Ke,colors:new Ke,audios:new Ke,particles:new Ke,fonts:new Ke,materials:new Ke,components:new Ke,variables:new Ke,userAPIs:new Ke,userWebhooks:new Ke}}e.defaultData=t})(ta||(ta={}));var sr;(e=>{function t(){let n={};return n["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},ur(n,Ke.prototype)}e.defaultColors=t;function i(){return ur({},Ke.prototype)}e.defaultImages=i;function r(){return{catelogs:new Ke,materials:new Ke,images:new Ke,videos:new Ke,colors:new Ke,audios:new Ke,particles:new Ke,fonts:new Ke,variables:new je,userAPIs:new Ke,userWebhooks:new Ke,lib:ta.defaultData()}}e.emptyData=r;function s(n){switch(n){case"number":return{value:0,name:"Number"};case"boolean":return{value:!1,name:"Boolean"};case"string":return{value:{textValue:"String value"},name:"String"};case"time":let o=[0,0,0];return{name:"Time",value:{textValue:o,deliminator:":",padding:2,suffix:"AM"},dynamicVariableType:"time",format:"HH:mm:ss",format12h24h:"12ampm",timeZone:null,hasEnd:!1,endValue:{textValue:o,deliminator:":",padding:2,suffix:"AM"},autoStart:!0,repeat:!1};case"counter":return{name:"Counter",value:0,dynamicVariableType:"counter",updateInterval:1e3,increment:1,autoStart:!0,hasEnd:!0,endValue:60,repeat:!0,randomStart:!1,range:[0,100],decimals:0};case"random":return{name:"Random",value:0,dynamicVariableType:"random",updateInterval:1e3,increment:1,autoStart:!0,isStatic:!1,hasEnd:!0,endValue:60,repeat:!0,min:0,max:100,decimals:0};default:}}e.defaultVariables=s;function a(n,o){if(o.format==="HH:mm:ss"){let l=Math.floor(n/3600),h=Math.floor((n-l*3600)/60),c=Math.round(n-l*3600-h*60);return{textValue:[l,h,c]}}else if(o.format==="mm:ss"){let l=Math.floor(n/60),h=Math.round(n-l*60);return{textValue:[l,h]}}else return o.format==="number"?n=Math.round(n):n=Math.round(n*1e3)/1e3,n}e.getFormattedTimerTime=a})(sr||(sr={}));var Hc;(e=>e.list=["idle","move","jump","run"])(Hc||(Hc={}));var Wc;(e=>(e.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},e.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX",""],["rotPosY",""],["rotNegX",""],["rotNegY",""],["jump","Space"],["run",""],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:e.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new je,move:new je,jump:new je,run:new je},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:jt.fromHexAndA(3728051,1)}}))(Wc||(Wc={}));function V9(e){e.layers.forEach(t=>{if(t.type==="depth"&&t.colorA!==void 0){let i=t.colorA,r=t.colorB,s=[[i.r,i.g,i.b,i.a],[r.r,r.g,r.b,r.a]],a=[0,1];for(let o=2;o<10;o++)s.push(s[1]),a.push(1);let n={...hs(mi(t),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,t.near),far:Math.max(0,t.far),colors:s,steps:a,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(t,n)}else if(t.type==="depth"&&t.gradientType===1&&(t.near<0||t.far<0)){let i={...mi(t),near:Math.max(t.near,0),far:Math.max(t.far,0)};Object.assign(t,i)}})}function Ma(e,t){Object.values(e.shared.materials).forEach(i=>t(i))}function Ea(e,t){e.scene.objects.traverse((i,r)=>{"materials"in r?r.materials.forEach((s,a)=>{s===void 0&&(r.materials[a]=a1.defaultData(),s=r.materials[a]),typeof s!="string"&&t(s)}):"material"in r?typeof r.material!="string"&&(r.material===void 0&&(r.material=a1.defaultData()),t(r.material)):r.type==="Mesh"&&(r.material===void 0&&(r.material=a1.defaultData()),t(r.material)),"overrides"in r&&Object.values(r.overrides).forEach(s=>{s.material&&typeof s.material!="string"&&Object.getPrototypeOf(s.material)!==Ei.prototype&&t(s.material)})})}function Jk(e){Object.assign(e.scene.publish,{orbitControls:{...Gc.defaultData,...mi(e.scene.publish.orbitControls)}})}function $k(e){Object.assign(e.scene.publish.settings,{video:{...Ra.defaultData.settings.video,...mi(e.scene.publish.settings.video)}})}function eU(e){function t(i){if(i.layers){for(let r of Object.values(i.layers))if(r){for(let[s,a]of Object.entries(r))if((ox.includes(s)||typeof a=="boolean")&&delete r[s],s==="texture")for(let[n,o]of Object.entries(a))(Kk.includes(n)||typeof o=="boolean")&&delete a[n]}}}e.scene.objects.traverse((i,r)=>{r.states.forEach(s=>{let a=s;a.material?t(a.material):a.materials&&a.materials.forEach(n=>{t(n)})})})}function tU(e){e.scene.publish.withBackground=!0}function iU(e){e.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function rU(e){e.scene.objects.traverse((t,i)=>{let r=i.cloner;r&&(r.radial.scale=r.radial.scale.map(s=>s+1),r.linear.scale=r.linear.scale.map(s=>s+1))})}function sU(e){e.scene.objects.traverse((t,i)=>{let r=i.geometry;r&&(r.type==="DodecahedronGeometry"||r.type==="IcosahedronGeometry")&&(r.detail=Math.round(r.detail))})}function aU(e){e.scene.objects.traverse((t,i)=>{let r=e.scene.objects.unproxy().parent(t);if(r){let s=mi(e.scene.objects.data(r));s&&s.type==="Mesh"&&s.geometry.type==="BooleanGeometry"&&i.type==="Mesh"&&(i.visible=mi(i).booleanExclude!==!0)}})}function nU(e){e.scene.objects.traverse((t,i)=>{if(i.type==="Mesh"){let r=i;i.geometry.type==="NonParametricGeometry"?r.material!==void 0&&delete r.material:r.materials!==void 0&&delete r.materials}})}function oU(e){function t(r){Object.setPrototypeOf(r,Ei.prototype),r.texture&&Object.setPrototypeOf(r.texture,Ei.prototype)}function i(r){Object.setPrototypeOf(r,Ei.prototype);for(let s in r)t(r[s])}e.scene.objects.traverse((r,s)=>{s.states.forEach(a=>{let n=a;if(n.material){let o=mi(n.material).layers;i(o),n.material.layers=o}if(n.materials)for(let o=0;o<n.materials.length;o++){let l=n.materials[o],h=mi(l).layers;i(h),l.layers=h}})})}function j9(e){e.layers===void 0&&Object.assign(e,a1.defaultTwoLayerData("lambert"))}function ku(e){!e.layers||e.layers.forEach(t=>{if(t.type==="depth"&&t.colors.length===10){let i=[...t.colors];i.push(t.colors[9]);let r=[...t.steps];r.push(t.steps[9]);let s={...mi(t),colors:i,steps:r};Object.assign(t,s)}})}function lU(e){e.scene.objects.traverse((t,i)=>{i.type==="Mesh"&&(i.geometry.type==="BooleanGeometry"||i.geometry.type==="SubdivGeometry")&&(i.geometry.phongAngle=35)})}function G9(e){e.scene.objects.traverse((t,i)=>{"materials"in i?i.materials.forEach(r=>{typeof r!="string"&&ku(r)}):"material"in i&&typeof i.material!="string"&&ku(i.material)}),Object.values(e.shared.materials).forEach(t=>ku(t))}function hU(e){e.scene.environment.ambientLight.softShadows=!1,e.scene.environment.ambientLight.softShadowQuality="low",e.scene.objects.traverse((t,i)=>{(i.type==="DirectionalLight"||i.type==="SpotLight")&&(i.shadowResolution=1024,i.shadowRadius=1,i.depth=1e5)}),e.shared.penumbraSize=new Array(5).fill(.5)}function cU(e){e.shared.audios=ur({},Ke.prototype)}function dU(e){e.shared.videos=ur({},Ke.prototype)}function uU(e){let t=e.shared.materials;Object.entries(t).forEach(([i,r])=>{if(!r.layers){let s={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(t,{[i]:s})}})}function pU(e){Object.entries(mi(e.shared.images)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.images[t]}),Object.entries(mi(e.shared.audios)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.audios[t]})}function fU(e){e.scene.publish.settings.web.preload=!1}function H9(e){e.layers&&e.layers.forEach(t=>{t.type==="depth"&&t.num!==void 0&&(t.colors=t.colors.slice(0,t.num),t.steps=t.steps.slice(0,t.num),delete t.num)})}function W9(e){e.layers&&e.layers.forEach(t=>{Zk(t)&&t.isMask===void 0&&(t.isMask=!1),(t.type==="texture"||t.type==="video")&&t.blending===void 0&&(t.blending=0),(t.type==="noise"||t.type==="displace"&&t.displacementType==="noise")&&(t.voronoiStyle===void 0&&(t.voronoiStyle=0),t.highCut===void 0&&(t.highCut=1),t.lowCut===void 0&&(t.lowCut=0),t.smoothness===void 0&&(t.smoothness=.3),t.seed===void 0&&(t.seed=0),t.quality===void 0&&(t.quality=1))})}function mU(e){e.shared.fonts=ur({},Ke.prototype)}function gU(e){return e.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function vU(e){let t=[];e.scene.objects.traverse((i,r)=>{let s=r;if(s.type==="TextFrame"){let a=a1.defaultTwoLayerData("phong"),n=typeof s.color=="string"?e.shared.colors[s.color]:s.color;a.layers[1].data.color={r:n.r,g:n.g,b:n.b},a.layers[1].data.alpha=s.alpha;let o=gU(s.font);e.shared.fonts[o]===void 0&&(e.shared.fonts[o]={name:o});let l={name:s.name,...Xi.defaultData,...xn.defaultData,flatShading:!1,wireframe:!1,geometry:{...yn.defaultData("TextGeometry"),width:s.width,height:s.height,font:o,depth:0,horizontalAlign:s.horizontalAlign,verticalAlign:s.verticalAlign,fontSize:s.fontSize*1.40625,lineHeight:s.lineHeight/1.40625,letterSpacing:s.letterSpacing-1,text:s.text,textTransform:s.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:a,states:mi(s.states),events:mi(s.events),visible:s.visible,raycastLock:s.raycastLock,position:s.position,rotation:s.rotation,scale:s.scale,hiddenMatrix:s.hiddenMatrix},h=mi(e.scene.objects).parent(i);e.scene.objects.insertAfter(h??null,i,[{id:i+"new",data:l,children:[]}]),t.push(i)}}),t.forEach(i=>{e.scene.objects.delete(i)})}function yU(e){let t={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};e.scene.objects.traverse((i,r)=>{r.events.forEach(s=>{if(t[Number(s.type)])if(Object.assign(s,{type:t[Number(s.type)]}),s.type==="Audio"&&"audioEvent"in s&&(Object.assign(s,{playAudio:s.audioEvent}),delete s.audioEvent),s.type==="GameControl")Object.assign(s,{gameActions:{idle:new je,move:new je,jump:new je}});else{let a=new je;Object.assign(s,{actions:a}),(s.type==="MouseDown"||s.type==="MouseUp"||s.type==="KeyDown"||s.type==="KeyUp")&&"url"in s&&a.push({fi:0,id:Oe.generateUUID(),data:{type:"Link",url:s.url,delay:0}}),"targets"in s&&(s.targets.forEach((n,o,l)=>{let h={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},c={easing:n.easing,duration:n.duration};n.easing===6?Object.assign(c,hs(n,"mass","stiffness","damping","velocity")):n.easing===5&&Object.assign(c,{control1:{...n.control1},control2:{...n.control2}});let d={repeat:n.repeat?-1:0,delay:n.delay,delayDirection:n.delayDirection,direction:n.cycle&&n.rewind?"pingpong-rewind":n.cycle?"pingpong":"normal"},u={state:n.state,...d,...c},p={allowSlerp:!0,type:"Transition",object:n.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new je({fi:0,id:Oe.generateUUID(),data:h},{fi:1,id:Oe.generateUUID(),data:u})};a.push({fi:l,id:o,data:p})}),delete s.targets)}})})}function xU(e){e.scene.objects.traverse((t,i)=>{function r(s,a){var l;let n=new je,o=[];if(i.events.forEach((h,c,d)=>{if(h.type==="Audio"&&h.trigger===a){let u;o.push(c),h.interaction==="play"?u={...hs(h,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in h?h.after:void 0,toggle:"after"in h?h.toggle:void 0,type:"Audio"}:(h.interaction==="pause"||h.interaction==="stop")&&(u={...hs(h,"interaction","delay","object","playAudio"),type:"Audio"}),u&&n.push({fi:d,id:c,data:u})}}),o.forEach(h=>i.events.delete(h)),n.length){let h=(l=i.events.find(c=>c.type===s))==null?void 0:l.data;h?"actions"in h&&h.actions.insertBefore(null,n):i.events.insertBefore(null,[{id:Oe.generateUUID(),data:{type:s,actions:n}}])}}r("Start","start"),r("MouseDown","mouseDown"),r("MouseUp","mouseUp"),r("KeyDown","keyDown"),r("KeyUp","keyUp")})}function q9(e){var i;let t=(i=e.layers.find(r=>r.type==="light"))==null?void 0:i.data;if((t==null?void 0:t.category)==="basic"){let r=ji.defaultData("light","phong"),s=t;Object.assign(s,r),s.visible=!1}}function Y9(e){Ma(e,q9),Ea(e,q9)}function bU(e){e.scene.objects.traverse((t,i)=>{i.type==="Mesh"&&i.geometry.type==="SubdivGeometry"&&(i.geometry.scaleBaked||(i.geometry.scaleBaked=[1,1,1]))})}function wU(e){e.scene.objects.traverse((t,i)=>{(i.type==="Empty"||i.type==="Mesh")&&i.cloner&&!i.cloner.randomnessObject&&!i.cloner.toObject&&!i.cloner.randomness&&(i.cloner={...i.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function SU(e){e.scene.objects.traverse((t,i)=>{i.type==="Mesh"&&i.geometry.type==="NonParametricGeometry"&&!("material"in i)&&!("materials"in i)&&(i.material=a1.defaultTwoLayerData("phong"))})}function _U(e){e.scene.publish.orbitControls.autoZoom===void 0&&(e.scene.publish.orbitControls.autoZoom=!1),e.scene.objects.traverse((t,i)=>{(i.type==="OrthographicCamera"||i.type==="PerspectiveCamera")&&(i.orthographic.autoZoom===void 0&&(i.orthographic.autoZoom=!1),i.orthographic.autoZoomFrustumSize===void 0&&(i.orthographic.autoZoomFrustumSize=790))})}function AU(e){e.scene.objects.traverse((t,i)=>{i.pathSnapping===void 0&&(i.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),i.pathSnapping.offset===void 0&&(i.pathSnapping.offset=0)})}function MU(e){e.scene.publish.mouseEventTarget===void 0&&(e.scene.publish.mouseEventTarget="canvas"),e.scene.publish.settings.web.hint===void 0&&(e.scene.publish.settings.web.hint=!1)}function EU(e){let{video:t}=e.scene.publish.settings;t.format==="gif"&&t.fps>48&&(t.fps=15)}function CU(e){e.scene.objects.traverse((t,i)=>{i.events.forEach(r=>{r.type==="GameControl"&&(r.resetYPosition=Math.abs(r.resetYPosition-i.position[1]))})})}function TU(e){let t=e.scene.environment.usePhysics;e.scene.objects.traverse((i,r)=>{t&&r.physics===null?r.collision=!1:r.collision="visibility"})}function PU(e){e.scene.objects.traverse((t,i)=>{i.events.forEach(r=>{r.type==="GameControl"&&(r.navmesh=Wc.defaultDataThirdPerson.navmesh)})})}function DU(e){e.scene.styles||(e.scene.styles=wn.defaultData())}function X9(e){e.layers.forEach(t=>{t.type==="light"&&t.category!=="toon"&&t.occlusion===void 0&&(t.occlusion=!0)})}function IU(e){e.scene.environment.ambientLight.occlusion===void 0&&(e.scene.environment.ambientLight.occlusion=!1),e.scene.environment.ambientLight.aoFullRes===void 0&&(e.scene.environment.ambientLight.aoFullRes=!1),e.scene.environment.ambientLight.radius===void 0&&(e.scene.environment.ambientLight.radius=256),e.scene.environment.ambientLight.bias===void 0&&(e.scene.environment.ambientLight.bias=.5),e.scene.environment.ambientLight.aoColor===void 0&&(e.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),Ea(e,X9),Ma(e,X9)}function OU(e){e.scene.objects.traverse((t,i)=>{i.events.forEach(r=>{r.type==="GameControl"&&Object.assign(r.gameActions,{run:new je})})})}function RU(e){e.scene.objects.traverse((t,i)=>{i.events.forEach(r=>{r.type==="GameControl"&&(r.keyAssignments=[...r.keyAssignments,["run",""],["none","Ctrl"]])})})}function Q9(e){e.layers&&e.layers.forEach(t=>{t.type==="light"&&t.bumpMapIntensity===void 0&&(t.bumpMapIntensity=5)})}function LU(e,t){if(t<1&&(Ea(e,V9),Ma(e,V9),e.schema=1),t<2&&(Jk(e),e.schema=2),t<3&&(eU(e),e.schema=3),t<4&&(tU(e),e.schema=4),t<5&&(iU(e),e.schema=5),t<6&&(rU(e),e.schema=6),t<7&&(sU(e),e.schema=7),t<8&&(e.schema=8),t<9&&(G9(e),e.schema=9),t<10&&(lU(e),e.schema=10),t<11&&(hU(e),e.schema=11),t<12&&(G9(e),e.schema=12),t<13&&(cU(e),e.schema=13),t<14&&(uU(e),e.schema=14),t<15&&(pU(e),e.schema=15),t<16&&(fU(e),e.schema=16),t<17&&(Ea(e,H9),Ma(e,H9),e.schema=17),t<18&&(Ea(e,j9),Ma(e,j9),e.schema=18),t<19&&($k(e),e.schema=19),t<20&&(mU(e),vU(e),e.schema=20),t<21&&(yU(e),xU(e),e.schema=21),t<22&&(Y9(e),e.schema=22),t<23&&(bU(e),e.schema=23),t<24&&(wU(e),e.schema=24),(t<25||e.shared.videos===void 0)&&(dU(e),t<25&&(e.schema=25)),t<26&&(aU(e),e.schema=26),t<27&&(nU(e),e.schema=27),t<28&&(Y9(e),e.schema=28),t<29&&(oU(e),e.schema=29),t<30&&(SU(e),e.schema=30),t<31&&(_U(e),e.schema=31),t<33&&(AU(e),e.schema=33),t<34&&(MU(e),e.schema=34),t<35&&(EU(e),e.schema=35),t<36&&(CU(e),e.schema=36),t<37&&(TU(e),e.schema=37),t<38&&(Ea(e,W9),Ma(e,W9),e.schema=38),t<39&&(PU(e),e.schema=39),t<40&&(DU(e),e.schema=40),t<41&&(IU(e),e.schema=41),t<42&&(OU(e),e.schema=42),t<43&&(RU(e),e.schema=43),t<99){Ea(e,Q9),Ma(e,Q9),e.scene.publish.playCamera===null&&(e.scene.publish.playCamera=Tl);let i=mi(e.scene.objects),r=e.scene.objects;e.scene.publish.playPage=A2,r.insertBefore(null,null,[{id:A2,data:{...ul.defaultData,backgroundColor:e.scene.backgroundColor,fog:e.scene.fog,postprocessing:e.scene.postprocessing,ao:hs(e.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:e.scene.publish.playCamera,gameControlObject:e.scene.publish.gameControlObject},shadow:hs(e.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:{...cl.defaultData,...hs(e.scene.environment,"usePhysics","gravity")},camera:mi(e.scene.ownerCamera)??ul.defaultData.camera,name:"Scene"},children:[]}]);for(let n of i)n.id!==Sn.TRASH_CAN_ID&&r.move(A2,n.fi,n.id);let s=0,a=0;e.shared.penumbraSize&&e.scene.objects.traverse((n,o)=>{o.type==="DirectionalLight"?(o.penumbraSize=e.shared.penumbraSize[Math.min(s,2)],s+=1):o.type==="SpotLight"&&(o.penumbraSize=e.shared.penumbraSize[3+Math.min(a,1)],a+=1),(o.physics===void 0||o.physics===null)&&o.type!=="Instance"&&(o.physics={},Object.assign(o.physics,hl.defaultData)),o.physics!==void 0&&o.physics!==null&&(o.physics.enabled=o.collision??"visibility",delete o.collision)}),e.schema=99}}function Z9(e){e.layers&&e.layers.forEach(t=>{t.type==="light"&&t.alphaOverride===void 0&&(t.alphaOverride=1)})}function BU(e){e.scene.objects.traverse((t,i)=>{let r=i.geometry;r&&r.type==="PathGeometry"&&(r.extrusion.capType="flat",r.extrusion.bevel=50,r.extrusion.bevelSides=6,r.extrusion.shape.type==="Custom"&&(r.extrusion.shape.shapeQuality="low"))})}function zU(e){var t;Array.isArray(mi(e.events))&&((t=e.events)==null||t.forEach(i=>{"disabled"in i||(i.disabled=!1),(i.type==="MouseDown"||i.type==="MouseUp"||i.type==="MousePress")&&(i.mode=i.mode||"Object")}))}var Po=180/Math.PI;function K9(e){e.rotation=e.rotation.slice(0,3).map(t=>t*Po)}function dx(e){var i,r;K9(e),e.type==="Page"&&K9(e.camera),(i=e.states)==null||i.forEach(s=>{s.rotation===void 0||s.rotation===null||(s.rotation=s.rotation.slice(0,3).map(a=>a*Po))});let t=e.geometry;t&&t.type==="SphereGeometry"&&(t.thetaLength=(t.thetaLength??180)*Po),t&&t.type==="TorusGeometry"&&(t.arc=t.arc*Po),t&&t.type==="PathGeometry"&&(t.extrusion.angle*=Po,t.extrusion.twist*=Po),e.type==="Mesh"&&e.geometry.type==="TextGeometry"&&(e.geometry.text={textValue:e.geometry.text}),Array.isArray(mi(e.events))&&((r=e.events)==null||r.forEach(s=>{(s.type==="MouseDown"||s.type==="MouseUp"||s.type==="MousePress"||s.type==="KeyDown"||s.type==="KeyUp"||s.type==="KeyPress"||s.type==="Collision"||s.type==="Trigger")&&(s.runMode=s.toggle?"Toggle":"Repeat")}))}function FU(e){e.shared.variables=ur({},Ke.prototype)}function kU(e){let t=mi(e.shared.variables);e.shared.variables=ur(Object.entries(t??{}).map(([i,r],s)=>({fi:s,id:i,data:r})),je.prototype)}var Fs=115;function ux(e,t){t(e.data);for(let i of e.children)ux(i,t)}function UU(e){let t=e.schema??104;t!==Fs&&t<105&&(ux(e.asset,dx),e.schema=105)}function NU(e){e.shared.particles=ur({},Ke.prototype),e.shared.lib&&(e.shared.lib.particles=ta.defaultData().particles)}function VU(e){e.scene.objects.traverse((t,i)=>{i.type==="Particle"&&typeof i.renderMaterial.size=="number"&&Object.assign(i.renderMaterial,{size:[i.renderMaterial.size,i.renderMaterial.size]})})}function jU(e){e.scene.objects.traverse((t,i)=>{i.type==="Page"&&(i.postprocessing.depthOfField.focusDistance=100,i.postprocessing.depthOfField.focalLength=20,i.postprocessing.depthOfField.bokehScale=5)})}function GU(e){e.scene.objects.traverse((t,i)=>{var r;Array.isArray(mi(i.events))!==!1&&((r=i.events)==null||r.forEach(s=>{var n,o,l,h,c,d,u,p,f,g,m;let a=s.runMode;s.type==="MouseDown"||s.type==="MouseUp"||s.type==="KeyDown"||s.type==="KeyUp"||s.type==="Collision"||s.type==="Trigger"?(n=s.actions)==null||n.forEach(v=>{v.type==="Transition"&&(v.runMode=a??"Repeat"),(v.type==="Animation"||v.type==="SwitchCamera")&&(v.runMode=a==="Toggle"?"Toggle":"Normal")}):s.type==="MouseHover"||s.type==="MousePress"||s.type==="KeyPress"?(o=s.actions)==null||o.forEach(v=>{(v.type==="Transition"||v.type==="Animation"||v.type==="SwitchCamera")&&(v.runMode="Toggle")}):s.type==="GameControl"?(delete s.actions,Object.keys(s.gameActions).forEach(v=>{var y;(y=s.gameActions[v])==null||y.forEach(x=>{x.type==="Transition"&&(x.runMode="Repeat"),x.type==="Animation"&&(x.runMode="Normal")})})):s.type==="DragDrop"?(delete s.actions,(h=(l=s.dragDropActions)==null?void 0:l.drag)==null||h.forEach(v=>{(v.type==="Transition"||v.type==="Animation"||v.type==="SwitchCamera")&&(v.runMode="Toggle")}),(d=(c=s.dragDropActions)==null?void 0:c.drop)==null||d.forEach(v=>{(v.type==="Transition"||v.type==="Animation"||v.type==="SwitchCamera")&&(v.runMode="Toggle")})):s.type==="Resize"?(delete s.actions,(u=s.breakpoints)==null||u.forEach(v=>{var y;(y=v.actions)==null||y.forEach(x=>{(x.type==="Transition"||x.type==="Animation"||x.type==="SwitchCamera")&&(x.runMode="Toggle")})})):s.type==="Start"?(p=s.actions)==null||p.forEach(v=>{v.type==="Transition"&&(v.runMode="Once"),(v.type==="Animation"||v.type==="SwitchCamera")&&(v.runMode="Normal")}):s.type==="VariableChange"||s.type==="Scroll"?(f=s.actions)==null||f.forEach(v=>{v.type==="Transition"&&(v.runMode="Repeat"),(v.type==="Animation"||v.type==="SwitchCamera")&&(v.runMode="Normal")}):s.type==="Conditional"&&(delete s.actions,(g=s.inActions)==null||g.forEach(v=>{v.type==="Transition"&&(v.runMode="Repeat"),(v.type==="Animation"||v.type==="SwitchCamera")&&(v.runMode="Normal")}),(m=s.outActions)==null||m.forEach(v=>{v.type==="Transition"&&(v.runMode="Repeat"),(v.type==="Animation"||v.type==="SwitchCamera")&&(v.runMode="Normal")}))}))})}function HU(e){e.shared.userAPIs=ur({},Ke.prototype),e.shared.userWebhooks=ur({},Ke.prototype),e.shared.lib&&(e.shared.lib.userAPIs=ta.defaultData().userAPIs,e.shared.lib.userWebhooks=ta.defaultData().userWebhooks)}function px(e){let t=e.schema??0;if(t!==Fs){LU(e,t),t<100&&(e.scene.publish.joystickSizeAndXYOffset===void 0&&(e.scene.publish.joystickSizeAndXYOffset=Ra.defaultData.joystickSizeAndXYOffset),e.schema=100),t<101&&(Ea(e,Z9),Ma(e,Z9),e.schema=101),t<102&&(BU(e),e.schema=102),t<104&&(e.shared.catelogs=new Ke,e.shared.lib=ta.defaultData(),e.schema=104),t<105&&(FU(e),e.scene.objects.traverse((i,r)=>{dx(r)}),e.schema=105);for(let i of Object.values(e.shared.lib.components))UU(i);t<106&&(kU(e),e.schema=106),t<107&&(e.shared.lib.variables=ta.defaultData().variables,e.schema=107),t<109&&(NU(e),e.schema=109),t<110&&(VU(e),e.schema=110),t<111&&(e.scene.objects.traverse((i,r)=>{zU(r)}),e.schema=111),t<112&&(jU(e),e.schema=112),t<113&&(GU(e),e.schema=113),t<114&&(e.scene.publish.settings.web.imageQuality===void 0&&(e.scene.publish.settings.web.imageQuality=70),e.schema=114),t<115&&(HU(e),e.schema=115)}}var qc;(e=>{e.defaultData={schema:Fs,scene:Sn.defaultData,frames:new Ke().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",M2.defaultData),shared:{...sr.emptyData(),colors:sr.defaultColors()}},e.emptyDataForImports=function(){let a=Sn.emptyDataWithPage();return{schema:Fs,scene:a,frames:new Ke().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",M2.defaultData),shared:{...sr.emptyData(),colors:sr.defaultColors(),images:sr.defaultImages()}}},e.emptyData=function(){return{schema:Fs,scene:Sn.emptyDataWithPage(),frames:new Ke().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",M2.defaultData),shared:sr.emptyData()}},e.clipboard2dData=function(){return{schema:Fs,scene:Sn.emptyData(),frames:new Ke,shared:sr.emptyData()}},e.collabHelper={...y3,updateSchema(a){return(a.schema??0)<Fs?H2(a,px):(a.schema??0)-Fs}};function t(a){let n=e.collabHelper.updateSchema(a);return typeof n=="number"?n===0?a:null:n.data}e.updateSchemaDirectly=t;function i(a){return{...a,shared:{...a.shared,lib:ta.defaultData()}}}e.withoutLib=i;function r(a,n){let o=a.scene.objects.get(n);if(o&&o.data.type==="Component")return o;{let l=a.shared.lib.components[n];if(l)return l.asset}}e.getComponentData=r;function s(a){let n=Object.values(a.shared.userAPIs);for(let o of n){let l=o.headers;for(let h of l)if(h.data.key.toLowerCase()==="authorization"&&h.data.value!=="")return!0}return!1}e.hasSensitiveData=s})(qc||(qc={}));var J3;(e=>e.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"})(J3||(J3={}));var J9;(e=>{function t(i){return!0}e.is=t})(J9||(J9={}));var Yc;(e=>{e.defaultData={position:[0,0],scale:[1,1],rotation:0,shear:[0,0]};function t(r,s){return{position:(s==null?void 0:s.position)??r.position,rotation:(s==null?void 0:s.rotation)??r.rotation,scale:(s==null?void 0:s.scale)??r.scale,shear:(s==null?void 0:s.shear)??r.shear}}e.merge=t;function i(r,s){return Ey({position:Ys.isEqual(r.position,s.position)?void 0:s.position,rotation:r.rotation===s.rotation?void 0:s.rotation,scale:Ys.isEqual(r.scale,s.scale)?void 0:s.scale,shear:r.shear&&s.shear&&Ys.isEqual(r.shear,s.shear)?void 0:s.shear})}e.diff=i})(Yc||(Yc={}));var $3;(e=>e.defaultData={horizontalConstraint:0,verticalConstraint:0})($3||($3={}));var $9;(e=>e.defaultData={direction:"row",wrap:"unwrap",align:"top-left",gap:10,rowGap:10,autoGap:!1,autoRowGap:!1,leftPadding:8,rightPadding:8,topPadding:8,bottomPadding:8})($9||($9={}));var Xc;(e=>e.defaultData={opacity:1,fill:{color:jt.fromHexAndA(Y1,1),enabled:!0},stroke:{color:jt.from0to1([0,0,0,1]),thickness:1,enabled:!1,mode:"inside"},layerBlur:{radius:2,enabled:!1},backgroundBlur:{radius:2,enabled:!1},dropShadow:{offset:[10,10],blurRadius:10,color:jt.from0to1([0,0,0,1]),enabled:!1,spread:0},innerShadow:{offset:[10,10],blurRadius:10,color:jt.from0to1([0,0,0,1]),enabled:!1,spread:0}})(Xc||(Xc={}));var _n;(e=>{function t(n,o){return{name:o}}e.newEmpty=t;function i(n,o){if(o===void 0)return n;let l={...n},h=["width","height","cornerRadius"];for(let c of h)c in l&&c in o&&o[c]!==void 0&&Object.assign(l,{[c]:o[c]});return l}function r(n,o){if(o===void 0)return n;let l={...n};return"fill"in l&&"fill"in o&&o.fill!==void 0&&Object.assign(l,{fill:{...l.fill,...o.fill}}),"stroke"in l&&"stroke"in o&&o.stroke!==void 0&&Object.assign(l,{stroke:{...l.stroke,...o.stroke}}),"layerBlur"in l&&"layerBlur"in o&&o.layerBlur!==void 0&&Object.assign(l,{layerBlur:{...l.layerBlur,...o.layerBlur}}),"backgroundBlur"in l&&"backgroundBlur"in o&&o.backgroundBlur!==void 0&&Object.assign(l,{backgroundBlur:{...l.backgroundBlur,...o.backgroundBlur}}),"dropShadow"in l&&"dropShadow"in o&&o.dropShadow!==void 0&&Object.assign(l,{dropShadow:{...l.dropShadow,...o.dropShadow}}),"innerShadow"in l&&"innerShadow"in o&&o.innerShadow!==void 0&&Object.assign(l,{innerShadow:{...l.innerShadow,...o.innerShadow}}),l}function s(n,o){if(o===void 0)return n;let l={...n};return Object.assign(l,Yc.merge(l,o)),l=i(l,o),l=r(l,o),l}e.patch=s;function a(n,o){let l,h=[];for(let[c,d]of Object.entries(o))c!=="name"&&(l===void 0&&(l={path:[],props:{},type:0},h.push(l)),l.props[c]=d);return h}e.toOps=a})(_n||(_n={}));var Y2;(e=>e.defaultData={...Yc.defaultData,...$3.defaultData,states:new je,events:new je,visible:!0,raycastLock:!1})(Y2||(Y2={}));var pl;(e=>e.defaultData={...Y2.defaultData,...Xc.defaultData})(pl||(pl={}));var Qc;(e=>e.defaultData={cornerRadius:[0,0,0,0]})(Qc||(Qc={}));var ef;(e=>e.defaultData={...pl.defaultData,type:"ellipse2d",width:100,height:100,name:"Ellipse"})(ef||(ef={}));var X2;(e=>e.defaultData={...pl.defaultData,...Qc.defaultData,type:"rectangle2d",width:100,height:100,name:"Rectangle"})(X2||(X2={}));var tf;(e=>e.defaultData={...pl.defaultData,type:"text2d",width:100,height:100,fontSize:12,lineHeight:1.2,letterSpacing:0,text:{textValue:"Hello world"},horizontalAlign:1,verticalAlign:1,textTransform:1,font:"Roboto_regular",name:"Text"})(tf||(tf={}));var rf;(e=>e.defaultData={...pl.defaultData,type:"path2d",path:"",name:"Path"})(rf||(rf={}));var eg;(e=>{function t(i){return i.type==="ellipse2d"||i.type==="rectangle2d"||i.type==="text2d"||i.type==="vector2d"||i.type==="path2d"}e.is=t})(eg||(eg={}));var Zc;(e=>e.defaultData={...Y2.defaultData,name:"Group",type:"group2d"})(Zc||(Zc={}));var sf;(e=>e.defaultData=()=>({...Y2.defaultData,...Qc.defaultData,...Xc.defaultData,name:"Frame",type:"frame2d",clipped:!0,width:200,height:200,fill:{color:jt.fromHexAndA(4737101,1),enabled:!0},stroke:{color:jt.fromHexAndA(0,1),thickness:1,enabled:!1,mode:"inside"},backgroundBlur:{radius:2,enabled:!1},layerBlur:{radius:2,enabled:!1}}))(sf||(sf={}));var On;(e=>{function t(n){switch(n){case"rectangle2d":return{...X2.defaultData};case"ellipse2d":return{...ef.defaultData};case"text2d":return{...tf.defaultData};case"vector2d":return{...X2.defaultData};case"path2d":return{...rf.defaultData};case"frame2d":return{...sf.defaultData()};case"group2d":return{...Zc.defaultData}}}e.defaultData=t;function i(n){return"width"in n&&"height"in n?[typeof n.width=="number"?n.width*.5:0,typeof n.height=="number"?n.height*.5:0]:[0,0]}e.getPivot=i;function r(n){return n.type==="rectangle2d"||n.type==="ellipse2d"||n.type==="text2d"||n.type==="frame2d"}e.isResizeable=r;function s(n){return n.type==="frame2d"&&n.autoLayout!==void 0}e.isAutoLayoutable=s;function a(n){return n.type==="rectangle2d"||n.type==="frame2d"}e.hasCorners=a})(On||(On={}));var af;(e=>(e.defaultData={name:"UI",type:"scene2d",objects:new s1},e.emptyData=function(){return{type:"scene2d",objects:new s1}}))(af||(af={}));function An(e,t=!1){let i=e[0].index!==null,r=new Set(Object.keys(e[0].attributes)),s=new Set(Object.keys(e[0].morphAttributes)),a={},n={},o=e[0].morphTargetsRelative,l=new Ge,h=0;for(let c=0;c<e.length;++c){let d=e[c],u=0;if(i!==(d.index!==null))return""+c,null;for(let p in d.attributes){if(!r.has(p))return""+c+p,null;a[p]===void 0&&(a[p]=[]),a[p].push(d.attributes[p]),u++}if(u!==r.size||o!==d.morphTargetsRelative)return""+c,null;for(let p in d.morphAttributes){if(!s.has(p))return""+c,null;n[p]===void 0&&(n[p]=[]),n[p].push(d.morphAttributes[p])}if(t){let p;if(i)p=d.index.count;else if(d.attributes.position!==void 0)p=d.attributes.position.count;else return""+c,null;l.addGroup(h,p,c),h+=p}}if(i){let c=0,d=[];for(let u=0;u<e.length;++u){let p=e[u].index;for(let f=0;f<p.count;++f)d.push(p.getX(f)+c);c+=e[u].attributes.position.count}l.setIndex(d)}for(let c in a){let d=tg(a[c]);if(!d)return""+c,null;l.setAttribute(c,d)}for(let c in n){let d=n[c][0].length;if(d===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[c]=[];for(let u=0;u<d;++u){let p=[];for(let g=0;g<n[c].length;++g)p.push(n[c][g][u]);let f=tg(p);if(!f)return""+c,null;l.morphAttributes[c].push(f)}}return l}function tg(e){let t,i,r,s=0;for(let o=0;o<e.length;++o){let l=e[o];if(l.isInterleavedBufferAttribute||(t===void 0&&(t=l.array.constructor),t!==l.array.constructor)||(i===void 0&&(i=l.itemSize),i!==l.itemSize)||(r===void 0&&(r=l.normalized),r!==l.normalized))return null;s+=l.array.length}let a=new t(s),n=0;for(let o=0;o<e.length;++o)a.set(e[o].array,n),n+=e[o].array.length;return new ot(a,i,r)}var WU=Math.pow(2,-24),r0=class{constructor(){}};function ss(e,t,i){return i.min.x=t[e],i.min.y=t[e+1],i.min.z=t[e+2],i.max.x=t[e+3],i.max.y=t[e+4],i.max.z=t[e+5],i}function ig(e){let t=-1,i=-1/0;for(let r=0;r<3;r++){let s=e[r+3]-e[r];s>i&&(i=s,t=r)}return t}function rg(e,t){t.set(e)}function sg(e,t,i){let r,s;for(let a=0;a<3;a++){let n=a+3;r=e[a],s=t[a],i[a]=r<s?r:s,r=e[n],s=t[n],i[n]=r>s?r:s}}function s0(e,t,i){for(let r=0;r<3;r++){let s=t[e+2*r],a=t[e+2*r+1],n=s-a,o=s+a;n<i[r]&&(i[r]=n),o>i[r+3]&&(i[r+3]=o)}}function ql(e){let t=e[3]-e[0],i=e[4]-e[1],r=e[5]-e[2];return 2*(t*i+i*r+r*t)}function qU(e,t){if(!e.index){let i=e.attributes.position.count,r=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,s;i>65535?s=new Uint32Array(new r(4*i)):s=new Uint16Array(new r(2*i)),e.setIndex(new ot(s,1));for(let a=0;a<i;a++)s[a]=a}}function YU(e){if(!e.groups||!e.groups.length)return[{offset:0,count:e.index.count/3}];let t=[],i=new Set;for(let s of e.groups)i.add(s.start),i.add(s.start+s.count);let r=Array.from(i.values()).sort((s,a)=>s-a);for(let s=0;s<r.length-1;s++){let a=r[s],n=r[s+1];t.push({offset:a/3,count:(n-a)/3})}return t}function Uu(e,t,i,r,s=null){let a=1/0,n=1/0,o=1/0,l=-1/0,h=-1/0,c=-1/0,d=1/0,u=1/0,p=1/0,f=-1/0,g=-1/0,m=-1/0,v=s!==null;for(let y=t*6,x=(t+i)*6;y<x;y+=6){let w=e[y+0],_=e[y+1],b=w-_,A=w+_;b<a&&(a=b),A>l&&(l=A),v&&w<d&&(d=w),v&&w>f&&(f=w);let S=e[y+2],M=e[y+3],C=S-M,T=S+M;C<n&&(n=C),T>h&&(h=T),v&&S<u&&(u=S),v&&S>g&&(g=S);let P=e[y+4],I=e[y+5],D=P-I,k=P+I;D<o&&(o=D),k>c&&(c=k),v&&P<p&&(p=P),v&&P>m&&(m=P)}r[0]=a,r[1]=n,r[2]=o,r[3]=l,r[4]=h,r[5]=c,v&&(s[0]=d,s[1]=u,s[2]=p,s[3]=f,s[4]=g,s[5]=m)}function XU(e,t,i,r){let s=1/0,a=1/0,n=1/0,o=-1/0,l=-1/0,h=-1/0;for(let c=t*6,d=(t+i)*6;c<d;c+=6){let u=e[c+0];u<s&&(s=u),u>o&&(o=u);let p=e[c+2];p<a&&(a=p),p>l&&(l=p);let f=e[c+4];f<n&&(n=f),f>h&&(h=f)}r[0]=s,r[1]=a,r[2]=n,r[3]=o,r[4]=l,r[5]=h}function QU(e,t,i,r,s){let a=i,n=i+r-1,o=s.pos,l=s.axis*2;for(;;){for(;a<=n&&t[a*6+l]<o;)a++;for(;a<=n&&t[n*6+l]>=o;)n--;if(a<n){for(let h=0;h<3;h++){let c=e[a*3+h];e[a*3+h]=e[n*3+h],e[n*3+h]=c;let d=t[a*6+h*2+0];t[a*6+h*2+0]=t[n*6+h*2+0],t[n*6+h*2+0]=d;let u=t[a*6+h*2+1];t[a*6+h*2+1]=t[n*6+h*2+1],t[n*6+h*2+1]=u}a++,n--}else return a}}var Os=32,ZU=(e,t)=>e.candidate-t.candidate,fa=new Array(Os).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),a0=new Float32Array(6);function KU(e,t,i,r,s,a){let n=-1,o=0;if(a===0)n=ig(t),n!==-1&&(o=(t[n]+t[n+3])/2);else if(a===1)n=ig(e),n!==-1&&(o=JU(i,r,s,n));else if(a===2){let l=ql(e),h=1.25*s,c=r*6,d=(r+s)*6;for(let u=0;u<3;u++){let p=t[u],f=(t[u+3]-p)/Os;if(s<Os/4){let g=[...fa];g.length=s;let m=0;for(let y=c;y<d;y+=6,m++){let x=g[m];x.candidate=i[y+2*u],x.count=0;let{bounds:w,leftCacheBounds:_,rightCacheBounds:b}=x;for(let A=0;A<3;A++)b[A]=1/0,b[A+3]=-1/0,_[A]=1/0,_[A+3]=-1/0,w[A]=1/0,w[A+3]=-1/0;s0(y,i,w)}g.sort(ZU);let v=s;for(let y=0;y<v;y++){let x=g[y];for(;y+1<v&&g[y+1].candidate===x.candidate;)g.splice(y+1,1),v--}for(let y=c;y<d;y+=6){let x=i[y+2*u];for(let w=0;w<v;w++){let _=g[w];x>=_.candidate?s0(y,i,_.rightCacheBounds):(s0(y,i,_.leftCacheBounds),_.count++)}}for(let y=0;y<v;y++){let x=g[y],w=x.count,_=s-x.count,b=x.leftCacheBounds,A=x.rightCacheBounds,S=0;w!==0&&(S=ql(b)/l);let M=0;_!==0&&(M=ql(A)/l);let C=1+1.25*(S*w+M*_);C<h&&(n=u,h=C,o=x.candidate)}}else{for(let v=0;v<Os;v++){let y=fa[v];y.count=0,y.candidate=p+f+v*f;let x=y.bounds;for(let w=0;w<3;w++)x[w]=1/0,x[w+3]=-1/0}for(let v=c;v<d;v+=6){let y=~~((i[v+2*u]-p)/f);y>=Os&&(y=Os-1);let x=fa[y];x.count++,s0(v,i,x.bounds)}let g=fa[Os-1];rg(g.bounds,g.rightCacheBounds);for(let v=Os-2;v>=0;v--){let y=fa[v],x=fa[v+1];sg(y.bounds,x.rightCacheBounds,y.rightCacheBounds)}let m=0;for(let v=0;v<Os-1;v++){let y=fa[v],x=y.count,w=y.bounds,_=fa[v+1].rightCacheBounds;x!==0&&(m===0?rg(w,a0):sg(w,a0,a0)),m+=x;let b=0,A=0;m!==0&&(b=ql(a0)/l);let S=s-m;S!==0&&(A=ql(_)/l);let M=1+1.25*(b*m+A*S);M<h&&(n=u,h=M,o=y.candidate)}}}}else`${a}`;return{axis:n,pos:o}}function JU(e,t,i,r){let s=0;for(let a=t,n=t+i;a<n;a++)s+=e[a*6+r*2];return s/i}function $U(e,t){let i=e.attributes.position,r=e.index.array,s=r.length/3,a=new Float32Array(s*6),n=i.normalized,o=i.array,l=i.offset||0,h=3;i.isInterleavedBufferAttribute&&(h=i.data.stride);let c=["getX","getY","getZ"];for(let d=0;d<s;d++){let u=d*3,p=d*6,f,g,m;n?(f=r[u+0],g=r[u+1],m=r[u+2]):(f=r[u+0]*h+l,g=r[u+1]*h+l,m=r[u+2]*h+l);for(let v=0;v<3;v++){let y,x,w;n?(y=i[c[v]](f),x=i[c[v]](g),w=i[c[v]](m)):(y=o[f+v],x=o[g+v],w=o[m+v]);let _=y;x<_&&(_=x),w<_&&(_=w);let b=y;x>b&&(b=x),w>b&&(b=w);let A=(b-_)/2,S=v*2;a[p+S+0]=_+A,a[p+S+1]=A+(Math.abs(_)+A)*WU,_<t[v]&&(t[v]=_),b>t[v+3]&&(t[v+3]=b)}}return a}function eN(e,t){function i(v){u&&u(v/p)}function r(v,y,x,w=null,_=0){if(!f&&_>=l&&(f=!0,h&&`${l}`),x<=c||_>=l)return i(y+x),v.offset=y,v.count=x,v;let b=KU(v.boundingData,w,n,y,x,d);if(b.axis===-1)return i(y+x),v.offset=y,v.count=x,v;let A=QU(o,n,y,x,b);if(A===y||A===y+x)i(y+x),v.offset=y,v.count=x;else{v.splitAxis=b.axis;let S=new r0,M=y,C=A-y;v.left=S,S.boundingData=new Float32Array(6),Uu(n,M,C,S.boundingData,a),r(S,M,C,a,_+1);let T=new r0,P=A,I=x-C;v.right=T,T.boundingData=new Float32Array(6),Uu(n,P,I,T.boundingData,a),r(T,P,I,a,_+1)}return v}qU(e,t);let s=new Float32Array(6),a=new Float32Array(6),n=$U(e,s),o=e.index.array,l=t.maxDepth,h=t.verbose,c=t.maxLeafTris,d=t.strategy,u=t.onProgress,p=e.index.count/3,f=!1,g=[],m=YU(e);if(m.length===1){let v=m[0],y=new r0;y.boundingData=s,XU(n,v.offset,v.count,a),r(y,v.offset,v.count,a),g.push(y)}else for(let v of m){let y=new r0;y.boundingData=new Float32Array(6),Uu(n,v.offset,v.count,y.boundingData,a),r(y,v.offset,v.count,a),g.push(y)}return g}function tN(e,t){let i=eN(e,t),r,s,a,n=[],o=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let c=0;c<i.length;c++){let d=i[c],u=l(d),p=new o(32*u);r=new Float32Array(p),s=new Uint32Array(p),a=new Uint16Array(p),h(0,d),n.push(p)}return n;function l(c){return c.count?1:1+l(c.left)+l(c.right)}function h(c,d){let u=c/4,p=c/2,f=!!d.count,g=d.boundingData;for(let m=0;m<6;m++)r[u+m]=g[m];if(f){let m=d.offset,v=d.count;return s[u+6]=m,a[p+14]=v,a[p+15]=65535,c+32}else{let m=d.left,v=d.right,y=d.splitAxis,x;if(x=h(c+32,m),x/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return s[u+6]=x/4,x=h(x,v),s[u+7]=y,x}}}var ia=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let i=1/0,r=-1/0;for(let s=0,a=e.length;s<a;s++){let n=e[s][t];i=n<i?n:i,r=n>r?n:r}this.min=i,this.max=r}setFromPoints(e,t){let i=1/0,r=-1/0;for(let s=0,a=t.length;s<a;s++){let n=t[s],o=e.dot(n);i=o<i?o:i,r=o>r?o:r}this.min=i,this.max=r}isSeparated(e){return this.min>e.max||e.min>this.max}};ia.prototype.setFromBox=function(){let e=new E;return function(t,i){let r=i.min,s=i.max,a=1/0,n=-1/0;for(let o=0;o<=1;o++)for(let l=0;l<=1;l++)for(let h=0;h<=1;h++){e.x=r.x*o+s.x*(1-o),e.y=r.y*l+s.y*(1-l),e.z=r.z*h+s.z*(1-h);let c=t.dot(e);a=Math.min(c,a),n=Math.max(c,n)}this.min=a,this.max=n}}();var iN=function(){let e=new E,t=new E,i=new E;return function(r,s,a){let n=r.start,o=e,l=s.start,h=t;i.subVectors(n,l),e.subVectors(r.end,r.start),t.subVectors(s.end,s.start);let c=i.dot(h),d=h.dot(o),u=h.dot(h),p=i.dot(o),f=o.dot(o)*u-d*d,g,m;f!==0?g=(c*d-p*u)/f:g=0,m=(c+g*d)/u,a.x=g,a.y=m}}(),V4=function(){let e=new j,t=new E,i=new E;return function(r,s,a,n){iN(r,s,e);let o=e.x,l=e.y;if(o>=0&&o<=1&&l>=0&&l<=1){r.at(o,a),s.at(l,n);return}else if(o>=0&&o<=1){l<0?s.at(0,n):s.at(1,n),r.closestPointToPoint(n,!0,a);return}else if(l>=0&&l<=1){o<0?r.at(0,a):r.at(1,a),s.closestPointToPoint(a,!0,n);return}else{let h;o<0?h=r.start:h=r.end;let c;l<0?c=s.start:c=s.end;let d=t,u=i;if(r.closestPointToPoint(c,!0,t),s.closestPointToPoint(h,!0,i),d.distanceToSquared(c)<=u.distanceToSquared(h)){a.copy(d),n.copy(c);return}else{a.copy(h),n.copy(u);return}}}}(),rN=function(){let e=new E,t=new E,i=new B1,r=new hr;return function(s,a){let{radius:n,center:o}=s,{a:l,b:h,c}=a;if(r.start=l,r.end=h,r.closestPointToPoint(o,!0,e).distanceTo(o)<=n||(r.start=l,r.end=c,r.closestPointToPoint(o,!0,e).distanceTo(o)<=n)||(r.start=h,r.end=c,r.closestPointToPoint(o,!0,e).distanceTo(o)<=n))return!0;let d=a.getPlane(i);if(Math.abs(d.distanceToPoint(o))<=n){let u=d.projectPoint(o,t);if(a.containsPoint(u))return!0}return!1}}(),sN=1e-15;function ho(e){return Math.abs(e)<sN}var ra=class extends r1{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new E),this.satBounds=new Array(4).fill().map(()=>new ia),this.points=[this.a,this.b,this.c],this.sphere=new V1,this.plane=new B1,this.needsUpdate=!0}intersectsSphere(e){return rN(e,this)}update(){let e=this.a,t=this.b,i=this.c,r=this.points,s=this.satAxes,a=this.satBounds,n=s[0],o=a[0];this.getNormal(n),o.setFromPoints(n,r);let l=s[1],h=a[1];l.subVectors(e,t),h.setFromPoints(l,r);let c=s[2],d=a[2];c.subVectors(t,i),d.setFromPoints(c,r);let u=s[3],p=a[3];u.subVectors(i,e),p.setFromPoints(u,r),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(n,e),this.needsUpdate=!1}};ra.prototype.closestPointToSegment=function(){let e=new E,t=new E,i=new hr;return function(r,s=null,a=null){let{start:n,end:o}=r,l=this.points,h,c=1/0;for(let d=0;d<3;d++){let u=(d+1)%3;i.start.copy(l[d]),i.end.copy(l[u]),V4(i,r,e,t),h=e.distanceToSquared(t),h<c&&(c=h,s&&s.copy(e),a&&a.copy(t))}return this.closestPointToPoint(n,e),h=n.distanceToSquared(e),h<c&&(c=h,s&&s.copy(e),a&&a.copy(n)),this.closestPointToPoint(o,e),h=o.distanceToSquared(e),h<c&&(c=h,s&&s.copy(e),a&&a.copy(o)),Math.sqrt(c)}}();ra.prototype.intersectsTriangle=function(){let e=new ra,t=new Array(3),i=new Array(3),r=new ia,s=new ia,a=new E,n=new E,o=new E,l=new E,h=new hr,c=new hr,d=new hr;return function(u,p=null,f=!1){this.needsUpdate&&this.update(),u.isExtendedTriangle?u.needsUpdate&&u.update():(e.copy(u),e.update(),u=e);let g=this.plane,m=u.plane;if(Math.abs(g.normal.dot(m.normal))>1-1e-10){let v=this.satBounds,y=this.satAxes;i[0]=u.a,i[1]=u.b,i[2]=u.c;for(let _=0;_<4;_++){let b=v[_],A=y[_];if(r.setFromPoints(A,i),b.isSeparated(r))return!1}let x=u.satBounds,w=u.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let _=0;_<4;_++){let b=x[_],A=w[_];if(r.setFromPoints(A,t),b.isSeparated(r))return!1}for(let _=0;_<4;_++){let b=y[_];for(let A=0;A<4;A++){let S=w[A];if(a.crossVectors(b,S),r.setFromPoints(a,t),s.setFromPoints(a,i),r.isSeparated(s))return!1}}return p&&(p.start.set(0,0,0),p.end.set(0,0,0)),!0}else{let v=this.points,y=!1,x=0;for(let I=0;I<3;I++){let D=v[I],k=v[(I+1)%3];h.start.copy(D),h.end.copy(k),h.delta(n);let H=y?c.start:c.end,U=ho(m.distanceToPoint(D));if(ho(m.normal.dot(n))&&U){c.copy(h),x=2;break}if((m.intersectLine(h,H)||U)&&!ho(H.distanceTo(k))){if(x++,y)break;y=!0}}if(x===1&&u.containsPoint(c.end))return p&&(p.start.copy(c.end),p.end.copy(c.end)),!0;if(x!==2)return!1;let w=u.points,_=!1,b=0;for(let I=0;I<3;I++){let D=w[I],k=w[(I+1)%3];h.start.copy(D),h.end.copy(k),h.delta(o);let H=_?d.start:d.end,U=ho(g.distanceToPoint(D));if(ho(g.normal.dot(o))&&U){d.copy(h),b=2;break}if((g.intersectLine(h,H)||U)&&!ho(H.distanceTo(k))){if(b++,_)break;_=!0}}if(b===1&&this.containsPoint(d.end))return p&&(p.start.copy(d.end),p.end.copy(d.end)),!0;if(b!==2)return!1;if(c.delta(n),d.delta(o),n.dot(o)<0){let I=d.start;d.start=d.end,d.end=I}let A=c.start.dot(n),S=c.end.dot(n),M=d.start.dot(n),C=d.end.dot(n),T=S<M,P=A<C;return A!==C&&M!==S&&T===P?!1:(p&&(l.subVectors(c.start,d.start),l.dot(n)>0?p.start.copy(c.start):p.start.copy(d.start),l.subVectors(c.end,d.end),l.dot(n)<0?p.end.copy(c.end):p.end.copy(d.end)),!0)}}}();ra.prototype.distanceToPoint=function(){let e=new E;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();ra.prototype.distanceToTriangle=function(){let e=new E,t=new E,i=["a","b","c"],r=new hr,s=new hr;return function(a,n=null,o=null){let l=n||o?r:null;if(this.intersectsTriangle(a,l))return(n||o)&&(n&&l.getCenter(n),o&&l.getCenter(o)),0;let h=1/0;for(let c=0;c<3;c++){let d,u=i[c],p=a[u];this.closestPointToPoint(p,e),d=p.distanceToSquared(e),d<h&&(h=d,n&&n.copy(e),o&&o.copy(p));let f=this[u];a.closestPointToPoint(f,e),d=f.distanceToSquared(e),d<h&&(h=d,n&&n.copy(f),o&&o.copy(e))}for(let c=0;c<3;c++){let d=i[c],u=i[(c+1)%3];r.set(this[d],this[u]);for(let p=0;p<3;p++){let f=i[p],g=i[(p+1)%3];s.set(a[f],a[g]),V4(r,s,e,t);let m=e.distanceToSquared(t);m<h&&(h=m,n&&n.copy(e),o&&o.copy(t))}}return Math.sqrt(h)}}();var ps=class{constructor(e,t,i){this.isOrientedBox=!0,this.min=new E,this.max=new E,this.matrix=new we,this.invMatrix=new we,this.points=new Array(8).fill().map(()=>new E),this.satAxes=new Array(3).fill().map(()=>new E),this.satBounds=new Array(3).fill().map(()=>new ia),this.alignedSatBounds=new Array(3).fill().map(()=>new ia),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),i&&this.matrix.copy(i)}set(e,t,i){this.min.copy(e),this.max.copy(t),this.matrix.copy(i),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}};ps.prototype.update=function(){return function(){let e=this.matrix,t=this.min,i=this.max,r=this.points;for(let l=0;l<=1;l++)for(let h=0;h<=1;h++)for(let c=0;c<=1;c++){let d=1*l|2*h|4*c,u=r[d];u.x=l?i.x:t.x,u.y=h?i.y:t.y,u.z=c?i.z:t.z,u.applyMatrix4(e)}let s=this.satBounds,a=this.satAxes,n=r[0];for(let l=0;l<3;l++){let h=a[l],c=s[l],d=1<<l,u=r[d];h.subVectors(n,u),c.setFromPoints(h,r)}let o=this.alignedSatBounds;o[0].setFromPointsField(r,"x"),o[1].setFromPointsField(r,"y"),o[2].setFromPointsField(r,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();ps.prototype.intersectsBox=function(){let e=new ia;return function(t){this.needsUpdate&&this.update();let i=t.min,r=t.max,s=this.satBounds,a=this.satAxes,n=this.alignedSatBounds;if(e.min=i.x,e.max=r.x,n[0].isSeparated(e)||(e.min=i.y,e.max=r.y,n[1].isSeparated(e))||(e.min=i.z,e.max=r.z,n[2].isSeparated(e)))return!1;for(let o=0;o<3;o++){let l=a[o],h=s[o];if(e.setFromBox(l,t),h.isSeparated(e))return!1}return!0}}();ps.prototype.intersectsTriangle=function(){let e=new ra,t=new Array(3),i=new ia,r=new ia,s=new E;return function(a){this.needsUpdate&&this.update(),a.isExtendedTriangle?a.needsUpdate&&a.update():(e.copy(a),e.update(),a=e);let n=this.satBounds,o=this.satAxes;t[0]=a.a,t[1]=a.b,t[2]=a.c;for(let d=0;d<3;d++){let u=n[d],p=o[d];if(i.setFromPoints(p,t),u.isSeparated(i))return!1}let l=a.satBounds,h=a.satAxes,c=this.points;for(let d=0;d<3;d++){let u=l[d],p=h[d];if(i.setFromPoints(p,c),u.isSeparated(i))return!1}for(let d=0;d<3;d++){let u=o[d];for(let p=0;p<4;p++){let f=h[p];if(s.crossVectors(u,f),i.setFromPoints(s,t),r.setFromPoints(s,c),i.isSeparated(r))return!1}}return!0}}();ps.prototype.closestPointToPoint=function(){return function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t}}();ps.prototype.distanceToPoint=function(){let e=new E;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();ps.prototype.distanceToBox=function(){let e=["x","y","z"],t=new Array(12).fill().map(()=>new hr),i=new Array(12).fill().map(()=>new hr),r=new E,s=new E;return function(a,n=0,o=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(a))return(o||l)&&(a.getCenter(s),this.closestPointToPoint(s,r),a.closestPointToPoint(r,s),o&&o.copy(r),l&&l.copy(s)),0;let h=n*n,c=a.min,d=a.max,u=this.points,p=1/0;for(let g=0;g<8;g++){let m=u[g];s.copy(m).clamp(c,d);let v=m.distanceToSquared(s);if(v<p&&(p=v,o&&o.copy(m),l&&l.copy(s),v<h))return Math.sqrt(v)}let f=0;for(let g=0;g<3;g++)for(let m=0;m<=1;m++)for(let v=0;v<=1;v++){let y=(g+1)%3,x=(g+2)%3,w=m<<y|v<<x,_=1<<g|m<<y|v<<x,b=u[w],A=u[_];t[f].set(b,A);let S=e[g],M=e[y],C=e[x],T=i[f],P=T.start,I=T.end;P[S]=c[S],P[M]=m?c[M]:d[M],P[C]=v?c[C]:d[M],I[S]=d[S],I[M]=m?c[M]:d[M],I[C]=v?c[C]:d[M],f++}for(let g=0;g<=1;g++)for(let m=0;m<=1;m++)for(let v=0;v<=1;v++){s.x=g?d.x:c.x,s.y=m?d.y:c.y,s.z=v?d.z:c.z,this.closestPointToPoint(s,r);let y=s.distanceToSquared(r);if(y<p&&(p=y,o&&o.copy(r),l&&l.copy(s),y<h))return Math.sqrt(y)}for(let g=0;g<12;g++){let m=t[g];for(let v=0;v<12;v++){let y=i[v];V4(m,y,r,s);let x=r.distanceToSquared(s);if(x<p&&(p=x,o&&o.copy(r),l&&l.copy(s),x<h))return Math.sqrt(x)}}return Math.sqrt(p)}}();var co=new E,uo=new E,po=new E,n0=new j,o0=new j,l0=new j,ag=new E,ng=new E,og=new E,h0=new E;function aN(e,t,i,r,s,a){let n;return a===Yi?n=e.intersectTriangle(r,i,t,!0,s):n=e.intersectTriangle(t,i,r,a!==f1,s),n===null?null:{distance:e.origin.distanceTo(s),point:s.clone()}}function nN(e,t,i,r,s,a,n,o,l){co.fromBufferAttribute(t,a),uo.fromBufferAttribute(t,n),po.fromBufferAttribute(t,o);let h=aN(e,co,uo,po,h0,l);if(h){r&&(n0.fromBufferAttribute(r,a),o0.fromBufferAttribute(r,n),l0.fromBufferAttribute(r,o),h.uv=r1.getInterpolation(h0,co,uo,po,n0,o0,l0,new j)),s&&(n0.fromBufferAttribute(s,a),o0.fromBufferAttribute(s,n),l0.fromBufferAttribute(s,o),h.uv1=r1.getInterpolation(h0,co,uo,po,n0,o0,l0,new j)),i&&(ag.fromBufferAttribute(i,a),ng.fromBufferAttribute(i,n),og.fromBufferAttribute(i,o),h.normal=r1.getInterpolation(h0,co,uo,po,ag,ng,og,new E),h.normal.dot(e.direction)>0&&h.normal.multiplyScalar(-1));let c={a,b:n,c:o,normal:new E,materialIndex:0};r1.getNormal(co,uo,po,c.normal),h.face=c,h.faceIndex=a}return h}function fx(e,t,i,r,s){let a=r*3,n=e.index.getX(a),o=e.index.getX(a+1),l=e.index.getX(a+2),{position:h,normal:c,uv:d,uv1:u}=e.attributes,p=nN(i,h,c,d,u,n,o,l,t);return p?(p.faceIndex=r,s&&s.push(p),p):null}function oN(e,t,i,r,s,a){for(let n=r,o=r+s;n<o;n++)fx(e,t,i,n,a)}function lN(e,t,i,r,s){let a=1/0,n=null;for(let o=r,l=r+s;o<l;o++){let h=fx(e,t,i,o);h&&h.distance<a&&(n=h,a=h.distance)}return n}function ts(e,t,i,r){let s=e.a,a=e.b,n=e.c,o=t,l=t+1,h=t+2;i&&(o=i.getX(t),l=i.getX(t+1),h=i.getX(t+2)),s.x=r.getX(o),s.y=r.getY(o),s.z=r.getZ(o),a.x=r.getX(l),a.y=r.getY(l),a.z=r.getZ(l),n.x=r.getX(h),n.y=r.getY(h),n.z=r.getZ(h)}function lg(e,t,i,r,s,a,n){let o=i.index,l=i.attributes.position;for(let h=e,c=t+e;h<c;h++)if(ts(n,h*3,o,l),n.needsUpdate=!0,r(n,h,s,a))return!0;return!1}var mx=class{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){let e=this._primitives;return e.length===0?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}};function Ca(e,t){return t[e+15]===65535}function Ho(e,t){return t[e+6]}function Q2(e,t){return t[e+14]}function Z2(e){return e+8}function K2(e,t){return t[e+6]}function hN(e,t){return t[e+7]}var ko=new vi,Kc=new E,cN=["x","y","z"];function nf(e,t,i,r,s){let a=e*2,n=Pl,o=Na,l=Va;if(Ca(a,o)){let h=Ho(e,l),c=Q2(a,o);oN(t,i,r,h,c,s)}else{let h=Z2(e);Jc(h,n,r,Kc)&&nf(h,t,i,r,s);let c=K2(e,l);Jc(c,n,r,Kc)&&nf(c,t,i,r,s)}}function of(e,t,i,r){let s=e*2,a=Pl,n=Na,o=Va;if(Ca(s,n)){let l=Ho(e,o),h=Q2(s,n);return lN(t,i,r,l,h)}else{let l=hN(e,o),h=cN[l],c=r.direction[h]>=0,d,u;c?(d=Z2(e),u=K2(e,o)):(d=K2(e,o),u=Z2(e));let p=Jc(d,a,r,Kc)?of(d,t,i,r):null;if(p){let g=p.point[h];if(c?g<=a[u+l]:g>=a[u+l+3])return p}let f=Jc(u,a,r,Kc)?of(u,t,i,r):null;return p&&f?p.distance<=f.distance?p:f:p||f||null}}var dN=function(){let e,t,i=[],r=new mx(()=>new vi);return function(...a){e=r.getPrimitive(),t=r.getPrimitive(),i.push(e,t);let n=s(...a);r.releasePrimitive(e),r.releasePrimitive(t),i.pop(),i.pop();let o=i.length;return o>0&&(t=i[o-1],e=i[o-2]),n};function s(a,n,o,l,h=null,c=0,d=0){function u(y){let x=y*2,w=Na,_=Va;for(;!Ca(x,w);)y=Z2(y),x=y*2;return Ho(y,_)}function p(y){let x=y*2,w=Na,_=Va;for(;!Ca(x,w);)y=K2(y,_),x=y*2;return Ho(y,_)+Q2(x,w)}let f=a*2,g=Pl,m=Na,v=Va;if(Ca(f,m)){let y=Ho(a,v),x=Q2(f,m);return ss(a,g,e),l(y,x,!1,d,c+a,e)}else{let y=Z2(a),x=K2(a,v),w=y,_=x,b,A,S,M;if(h&&(S=e,M=t,ss(w,g,S),ss(_,g,M),b=h(S),A=h(M),A<b)){w=x,_=y;let H=b;b=A,A=H,S=M}S||(S=e,ss(w,g,S));let C=Ca(w*2,m),T=o(S,C,b,d+1,c+w),P;if(T===2){let H=u(w),U=p(w)-H;P=l(H,U,!0,d+1,c+w,S)}else P=T&&s(w,n,o,l,h,c,d+1);if(P)return!0;M=t,ss(_,g,M);let I=Ca(_*2,m),D=o(M,I,A,d+1,c+_),k;if(D===2){let H=u(_),U=p(_)-H;k=l(H,U,!0,d+1,c+_,M)}else k=D&&s(_,n,o,l,h,c,d+1);return!!k}}}(),uN=function(){let e=new ra,t=new ra,i=new we,r=new ps,s=new ps;return function a(n,o,l,h,c=null){let d=n*2,u=Pl,p=Na,f=Va;if(c===null&&(l.boundingBox||l.computeBoundingBox(),r.set(l.boundingBox.min,l.boundingBox.max,h),c=r),Ca(d,p)){let g=o,m=g.index,v=g.attributes.position,y=l.index,x=l.attributes.position,w=Ho(n,f),_=Q2(d,p);if(i.copy(h).invert(),l.boundsTree)return ss(n,u,s),s.matrix.copy(i),s.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:b=>s.intersectsBox(b),intersectsTriangle:b=>{b.a.applyMatrix4(h),b.b.applyMatrix4(h),b.c.applyMatrix4(h),b.needsUpdate=!0;for(let A=w*3,S=(_+w)*3;A<S;A+=3)if(ts(t,A,m,v),t.needsUpdate=!0,b.intersectsTriangle(t))return!0;return!1}});for(let b=w*3,A=_+w*3;b<A;b+=3){ts(e,b,m,v),e.a.applyMatrix4(i),e.b.applyMatrix4(i),e.c.applyMatrix4(i),e.needsUpdate=!0;for(let S=0,M=y.count;S<M;S+=3)if(ts(t,S,y,x),t.needsUpdate=!0,e.intersectsTriangle(t))return!0}}else{let g=n+8,m=f[n+6];return ss(g,u,ko),!!(c.intersectsBox(ko)&&a(g,o,l,h,c)||(ss(m,u,ko),c.intersectsBox(ko)&&a(m,o,l,h,c)))}}}();function Jc(e,t,i,r){return ss(e,t,ko),i.intersectBox(ko,r)}var lf=[],K0,Pl,Na,Va;function p2(e){K0&&lf.push(K0),K0=e,Pl=new Float32Array(e),Na=new Uint16Array(e),Va=new Uint32Array(e)}function c0(){K0=null,Pl=null,Na=null,Va=null,lf.length&&p2(lf.pop())}var Nu=Symbol("skip tree generation"),Vu=new vi,ju=new vi,fo=new we,tn=new ps,Yl=new ps,Xl=new E,d0=new E,pN=new E,fN=new E,mN=new E,hg=new vi,jr=new mx(()=>new ra),E2=class{static serialize(e,t={}){if(t.isBufferGeometry)return E2.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});t={cloneBuffers:!0,...t};let i=e.geometry,r=e._roots,s=i.getIndex(),a;return t.cloneBuffers?a={roots:r.map(n=>n.slice()),index:s.array.slice()}:a={roots:r,index:s.array},a}static deserialize(e,t,i={}){if(typeof i=="boolean")return E2.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});i={setIndex:!0,...i};let{index:r,roots:s}=e,a=new E2(t,{...i,[Nu]:!0});if(a._roots=s,i.setIndex){let n=t.getIndex();if(n===null){let o=new ot(e.index,1,!1);t.setIndex(o)}else n.array!==r&&(n.array.set(r),n.needsUpdate=!0)}return a}constructor(e,t={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[Nu]:!1},t),t.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,t[Nu]||(this._roots=tN(e,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new vi))),this.geometry=e}refit(e=null){e&&Array.isArray(e)&&(e=new Set(e));let t=this.geometry,i=t.index.array,r=t.attributes.position,s,a,n,o,l=0,h=this._roots;for(let d=0,u=h.length;d<u;d++)s=h[d],a=new Uint32Array(s),n=new Uint16Array(s),o=new Float32Array(s),c(0,l),l+=s.byteLength;function c(d,u,p=!1){let f=d*2;if(n[f+15]===65535){let g=a[d+6],m=n[f+14],v=1/0,y=1/0,x=1/0,w=-1/0,_=-1/0,b=-1/0;for(let A=3*g,S=3*(g+m);A<S;A++){let M=i[A],C=r.getX(M),T=r.getY(M),P=r.getZ(M);C<v&&(v=C),C>w&&(w=C),T<y&&(y=T),T>_&&(_=T),P<x&&(x=P),P>b&&(b=P)}return o[d+0]!==v||o[d+1]!==y||o[d+2]!==x||o[d+3]!==w||o[d+4]!==_||o[d+5]!==b?(o[d+0]=v,o[d+1]=y,o[d+2]=x,o[d+3]=w,o[d+4]=_,o[d+5]=b,!0):!1}else{let g=d+8,m=a[d+6],v=g+u,y=m+u,x=p,w=!1,_=!1;e?x||(w=e.has(v),_=e.has(y),x=!w&&!_):(w=!0,_=!0);let b=x||w,A=x||_,S=!1;b&&(S=c(g,u,x));let M=!1;A&&(M=c(m,u,x));let C=S||M;if(C)for(let T=0;T<3;T++){let P=g+T,I=m+T,D=o[P],k=o[P+3],H=o[I],U=o[I+3];o[d+T]=D<H?D:H,o[d+T+3]=k>U?k:U}return C}}}traverse(e,t=0){let i=this._roots[t],r=new Uint32Array(i),s=new Uint16Array(i);a(0);function a(n,o=0){let l=n*2,h=s[l+15]===65535;if(h){let c=r[n+6],d=s[l+14];e(o,h,new Float32Array(i,n*4,6),c,d)}else{let c=n+8,d=r[n+6],u=r[n+7];e(o,h,new Float32Array(i,n*4,6),u)||(a(c,o+1),a(d,o+1))}}}raycast(e,t=Or){let i=this._roots,r=this.geometry,s=[],a=t.isMaterial,n=Array.isArray(t),o=r.groups,l=a?t.side:t;for(let h=0,c=i.length;h<c;h++){let d=n?t[o[h].materialIndex].side:l,u=s.length;if(p2(i[h]),nf(0,r,d,e,s),c0(),n){let p=o[h].materialIndex;for(let f=u,g=s.length;f<g;f++)s[f].face.materialIndex=p}}return s}raycastFirst(e,t=Or){let i=this._roots,r=this.geometry,s=t.isMaterial,a=Array.isArray(t),n=null,o=r.groups,l=s?t.side:t;for(let h=0,c=i.length;h<c;h++){let d=a?t[o[h].materialIndex].side:l;p2(i[h]);let u=of(0,r,d,e);c0(),u!=null&&(n==null||u.distance<n.distance)&&(n=u,a&&(u.face.materialIndex=o[h].materialIndex))}return n}intersectsGeometry(e,t){let i=this.geometry,r=!1;for(let s of this._roots)if(p2(s),r=uN(0,i,e,t),c0(),r)break;return r}shapecast(e,t,i){let r=this.geometry;if(e instanceof Function){if(t){let d=t;t=(u,p,f,g)=>{let m=p*3;return d(u,m,m+1,m+2,f,g)}}e={boundsTraverseOrder:i,intersectsBounds:e,intersectsTriangle:t,intersectsRange:null}}let s=jr.getPrimitive(),{boundsTraverseOrder:a,intersectsBounds:n,intersectsRange:o,intersectsTriangle:l}=e;if(o&&l){let d=o;o=(u,p,f,g,m)=>d(u,p,f,g,m)?!0:lg(u,p,r,l,f,g,s)}else o||(l?o=(d,u,p,f)=>lg(d,u,r,l,p,f,s):o=(d,u,p)=>p);let h=!1,c=0;for(let d of this._roots){if(p2(d),h=dN(0,r,n,o,a,c),c0(),h)break;c+=d.byteLength}return jr.releasePrimitive(s),h}bvhcast(e,t,i){let{intersectsRanges:r,intersectsTriangles:s}=i,a=this.geometry.index,n=this.geometry.attributes.position,o=e.geometry.index,l=e.geometry.attributes.position;fo.copy(t).invert();let h=jr.getPrimitive(),c=jr.getPrimitive();if(s){let u=function(p,f,g,m,v,y,x,w){for(let _=g,b=g+m;_<b;_++){ts(c,_*3,o,l),c.a.applyMatrix4(t),c.b.applyMatrix4(t),c.c.applyMatrix4(t),c.needsUpdate=!0;for(let A=p,S=p+f;A<S;A++)if(ts(h,A*3,a,n),h.needsUpdate=!0,s(h,c,A,_,v,y,x,w))return!0}return!1};if(r){let p=r;r=function(f,g,m,v,y,x,w,_){return p(f,g,m,v,y,x,w,_)?!0:u(f,g,m,v,y,x,w,_)}}else r=u}e.getBoundingBox(ju),ju.applyMatrix4(t);let d=this.shapecast({intersectsBounds:u=>ju.intersectsBox(u),intersectsRange:(u,p,f,g,m,v)=>(Vu.copy(v),Vu.applyMatrix4(fo),e.shapecast({intersectsBounds:y=>Vu.intersectsBox(y),intersectsRange:(y,x,w,_,b)=>r(u,p,y,x,g,m,_,b)}))});return jr.releasePrimitive(h),jr.releasePrimitive(c),d}intersectsBox(e,t){return tn.set(e.min,e.max,t),tn.needsUpdate=!0,this.shapecast({intersectsBounds:i=>tn.intersectsBox(i),intersectsTriangle:i=>tn.intersectsTriangle(i)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,i={},r={},s=0,a=1/0){e.boundingBox||e.computeBoundingBox(),tn.set(e.boundingBox.min,e.boundingBox.max,t),tn.needsUpdate=!0;let n=this.geometry,o=n.attributes.position,l=n.index,h=e.attributes.position,c=e.index,d=jr.getPrimitive(),u=jr.getPrimitive(),p=d0,f=pN,g=null,m=null;r&&(g=fN,m=mN);let v=1/0,y=null,x=null;return fo.copy(t).invert(),Yl.matrix.copy(fo),this.shapecast({boundsTraverseOrder:w=>tn.distanceToBox(w),intersectsBounds:(w,_,b)=>b<v&&b<a?(_&&(Yl.min.copy(w.min),Yl.max.copy(w.max),Yl.needsUpdate=!0),!0):!1,intersectsRange:(w,_)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:b=>Yl.distanceToBox(b),intersectsBounds:(b,A,S)=>S<v&&S<a,intersectsRange:(b,A)=>{for(let S=b*3,M=(b+A)*3;S<M;S+=3){ts(u,S,c,h),u.a.applyMatrix4(t),u.b.applyMatrix4(t),u.c.applyMatrix4(t),u.needsUpdate=!0;for(let C=w*3,T=(w+_)*3;C<T;C+=3){ts(d,C,l,o),d.needsUpdate=!0;let P=d.distanceToTriangle(u,p,g);if(P<v&&(f.copy(p),m&&m.copy(g),v=P,y=C/3,x=S/3),P<s)return!0}}}});{let b=c?c.count:h.count;for(let A=0,S=b;A<S;A+=3){ts(u,A,c,h),u.a.applyMatrix4(t),u.b.applyMatrix4(t),u.c.applyMatrix4(t),u.needsUpdate=!0;for(let M=w*3,C=(w+_)*3;M<C;M+=3){ts(d,M,l,o),d.needsUpdate=!0;let T=d.distanceToTriangle(u,p,g);if(T<v&&(f.copy(p),m&&m.copy(g),v=T,y=M/3,x=A/3),T<s)return!0}}}}}),jr.releasePrimitive(d),jr.releasePrimitive(u),v===1/0?null:(i.point?i.point.copy(f):i.point=f.clone(),i.distance=v,i.faceIndex=y,r&&(r.point?r.point.copy(m):r.point=m.clone(),r.point.applyMatrix4(fo),f.applyMatrix4(fo),r.distance=f.sub(r.point).length(),r.faceIndex=x),i)}closestPointToPoint(e,t={},i=0,r=1/0){let s=i*i,a=r*r,n=1/0,o=null;if(this.shapecast({boundsTraverseOrder:h=>(Xl.copy(e).clamp(h.min,h.max),Xl.distanceToSquared(e)),intersectsBounds:(h,c,d)=>d<n&&d<a,intersectsTriangle:(h,c)=>{h.closestPointToPoint(e,Xl);let d=e.distanceToSquared(Xl);return d<n&&(d0.copy(Xl),n=d,o=c),d<s}}),n===1/0)return null;let l=Math.sqrt(n);return t.point?t.point.copy(d0):t.point=d0.clone(),t.distance=l,t.faceIndex=o,t}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(t=>{ss(0,new Float32Array(t),hg),e.union(hg)}),e}},Ql=aa(uS()),gN=.5*(Math.sqrt(3)-1),Zl=(3-Math.sqrt(3))/6,vN=1/3,Gr=1/6,C2=e=>Math.floor(e)|0,cg=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),Gu=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function Hu(e=Math.random){let t=gx(e),i=new Float64Array(t).map(s=>cg[s%12*2]),r=new Float64Array(t).map(s=>cg[s%12*2+1]);return function(s,a){let n=0,o=0,l=0,h=(s+a)*gN,c=C2(s+h),d=C2(a+h),u=(c+d)*Zl,p=c-u,f=d-u,g=s-p,m=a-f,v,y;g>m?(v=1,y=0):(v=0,y=1);let x=g-v+Zl,w=m-y+Zl,_=g-1+2*Zl,b=m-1+2*Zl,A=c&255,S=d&255,M=.5-g*g-m*m;if(M>=0){let P=A+t[S],I=i[P],D=r[P];M*=M,n=M*M*(I*g+D*m)}let C=.5-x*x-w*w;if(C>=0){let P=A+v+t[S+y],I=i[P],D=r[P];C*=C,o=C*C*(I*x+D*w)}let T=.5-_*_-b*b;if(T>=0){let P=A+1+t[S+1],I=i[P],D=r[P];T*=T,l=T*T*(I*_+D*b)}return 70*(n+o+l)}}function yN(e=Math.random){let t=gx(e),i=new Float64Array(t).map(a=>Gu[a%12*3]),r=new Float64Array(t).map(a=>Gu[a%12*3+1]),s=new Float64Array(t).map(a=>Gu[a%12*3+2]);return function(a,n,o){let l,h,c,d,u=(a+n+o)*vN,p=C2(a+u),f=C2(n+u),g=C2(o+u),m=(p+f+g)*Gr,v=p-m,y=f-m,x=g-m,w=a-v,_=n-y,b=o-x,A,S,M,C,T,P;w>=_?_>=b?(A=1,S=0,M=0,C=1,T=1,P=0):w>=b?(A=1,S=0,M=0,C=1,T=0,P=1):(A=0,S=0,M=1,C=1,T=0,P=1):_<b?(A=0,S=0,M=1,C=0,T=1,P=1):w<b?(A=0,S=1,M=0,C=0,T=1,P=1):(A=0,S=1,M=0,C=1,T=1,P=0);let I=w-A+Gr,D=_-S+Gr,k=b-M+Gr,H=w-C+2*Gr,U=_-T+2*Gr,F=b-P+2*Gr,Z=w-1+3*Gr,W=_-1+3*Gr,G=b-1+3*Gr,X=p&255,ee=f&255,Y=g&255,$=.6-w*w-_*_-b*b;if($<0)l=0;else{let te=X+t[ee+t[Y]];$*=$,l=$*$*(i[te]*w+r[te]*_+s[te]*b)}let Q=.6-I*I-D*D-k*k;if(Q<0)h=0;else{let te=X+A+t[ee+S+t[Y+M]];Q*=Q,h=Q*Q*(i[te]*I+r[te]*D+s[te]*k)}let le=.6-H*H-U*U-F*F;if(le<0)c=0;else{let te=X+C+t[ee+T+t[Y+P]];le*=le,c=le*le*(i[te]*H+r[te]*U+s[te]*F)}let re=.6-Z*Z-W*W-G*G;if(re<0)d=0;else{let te=X+1+t[ee+1+t[Y+1]];re*=re,d=re*re*(i[te]*Z+r[te]*W+s[te]*G)}return 32*(l+h+c+d)}}function gx(e){let t=new Uint8Array(512);for(let i=0;i<512/2;i++)t[i]=i;for(let i=0;i<512/2-1;i++){let r=i+~~(e()*(256-i)),s=t[i];t[i]=t[r],t[r]=s}for(let i=256;i<512;i++)t[i]=t[i-256];return t}var yr=new r1,xN=class{constructor(e){this.weightAttribute=null;let t=e.geometry;if(!t.isBufferGeometry||t.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let e=this.positionAttribute,t=new Float32Array(e.count/3);for(let r=0;r<e.count;r+=3){let s=1;yr.a.fromBufferAttribute(e,r),yr.b.fromBufferAttribute(e,r+1),yr.c.fromBufferAttribute(e,r+2),s*=yr.getArea(),t[r/3]=s}this.distribution=new Float32Array(e.count/3);let i=0;for(let r=0;r<t.length;r++)i+=t[r],this.distribution[r]=i;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t){if(this.distribution){let i=this.distribution[this.distribution.length-1],r=this.binarySearch(this.randomFunction()*i);return this.sampleFace(r,e,t)}}binarySearch(e){if(!this.distribution)return 0;let t=this.distribution,i=0,r=t.length-1,s=-1;for(;i<=r;){let a=Math.ceil((i+r)/2);if(a===0||t[a-1]<=e&&t[a]>e){s=a;break}else e<t[a]?r=a-1:i=a+1}return s}sampleFace(e,t,i){let r=this.randomFunction(),s=this.randomFunction();return r+s>1&&(r=1-r,s=1-s),yr.a.fromBufferAttribute(this.positionAttribute,e*3),yr.b.fromBufferAttribute(this.positionAttribute,e*3+1),yr.c.fromBufferAttribute(this.positionAttribute,e*3+2),t.set(0,0,0).addScaledVector(yr.a,r).addScaledVector(yr.b,s).addScaledVector(yr.c,1-(r+s)),yr.getNormal(i),this}},bN=aa(Z7()),wN=new we,SN=new we,_N=new we,J2;(e=>{function t(i){return i&&i.__isSPEObject}e.is=t})(J2||(J2={}));var j4=e=>class extends e{constructor(){super(...arguments),this.previousModelViewMatrix=new we,this.copyPreviousMatrix=!0,this.hiddenMatrix=new we,this.matrixWorldRigid=new we,this.shearScale=new we,this.shearScaleInv=new we}get __isSPEObject(){return!0}isDescendantOf(t){t instanceof kt&&(t=t.uuid);let i=this;for(;i.parent;){if(i.parent.uuid===t)return!0;i=i.parent}return!1}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);for(let i of this.children)i.updateMatrixWorld(t)}updateWorldMatrix(t,i){let r=this.parent;if(t&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),i)for(let s of this.children)s.updateWorldMatrix(!1,!0)}traverseChildren(t,i=0){for(let r of this.children)J2.is(r)&&r.traverseObject(t,i+1)}traverseObject(t,i=0){if(t(this,i)!==!0)for(let r of this.children)J2.is(r)&&r.traverseObject(t,i+1)}updateMatrixWorldSVD(){let t=this.matrixWorld.elements,i=[[t[0],t[4],t[8]],[t[1],t[5],t[9]],[t[2],t[6],t[10]]],{u:r,v:s,q:a}=(0,bN.SVD)(i),n=wN.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),o=SN.set(s[0][0],s[0][1],s[0][2],0,s[1][0],s[1][1],s[1][2],0,s[2][0],s[2][1],s[2][2],0,0,0,0,1),l=_N.copy(o).transpose();this.shearScale.makeScale(a[0],a[1],a[2]).multiply(l).premultiply(o),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(n,l).copyPosition(this.matrixWorld),a.every(h=>Math.abs(a[0]-h)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(t,i){this.updateWorldMatrix(!0,!1);let r=new we().copy(this.matrixWorld).invert();return t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),r.multiply(t.parent.matrixWorld)),"hiddenMatrix"in t&&t.hiddenMatrix instanceof we?t.hiddenMatrix.premultiply(r):t.applyMatrix4(r),t.updateWorldMatrix(!1,!1),this.add(t),i!==void 0&&(this.children.pop(),this.children.splice(i,0,t)),this}copy(t,i=!1){return super.copy(t,i),this.hasNonUniformScale=t.hasNonUniformScale,this}onAfterRender(t,i,r,s,a,n){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},AN=class extends j4(kt){},MN=e=>e.type==="Mesh",m1=class extends AN{constructor(e){super(),this.object=e,this.matrixAutoUpdate=!1,this.hasNonUniformScale=e.hasNonUniformScale}raycast(e,t){}expand(){let e=0,t=this.object.entityChildren(e);for(;t;){let i=this.children[e];(i==null?void 0:i.object)!==t&&(i&&this.remove(i),i=new m1(t),this.add(i),this.children.splice(e,0,this.children.pop()),i.matrixWorldNeedsUpdate=!0,i.matrixAutoUpdate=!1,i.matrix=t.matrix,i.hiddenMatrix=t.hiddenMatrix),i.expand(),e+=1,t=this.object.entityChildren(e)}for(;this.children.length>e;)this.remove(this.children[e])}get visible(){var e;return this.playModeVisible!==void 0?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&((e=this.object.dataPatched.cloner)==null?void 0:e.hideBase)===!0}set visible(e){}get castShadow(){return this.object.castShadow}set castShadow(e){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(e){}get isMesh(){return MN(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(e){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},un=new E,pn=new E,Wo=new we,vx=[new E(-1,1,1),new E(-1,-1,1),new E(1,-1,1),new E(1,1,1),new E(-1,1,-1),new E(-1,-1,-1),new E(1,-1,-1),new E(1,1,-1)],EN=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],CN=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],dg=(e,t,i)=>{e.updateEntityBoxSize(un,pn),Wo.copy(t).multiply(e.matrixWorld),pn.x===0&&pn.y===0&&pn.z===0?i.push(new E(un.x,un.y,un.z).applyMatrix4(Wo)):vx.forEach(r=>{i.push(r.clone().multiply(pn).add(un).applyMatrix4(Wo))})},ug=class extends vi{constructor(){super(...arguments),this.matrix=new we,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(e){return super.copy(e),this.matrix.copy(e.matrix),this.vertices=e.vertices.map(t=>t.clone()),this.faces=e.faces.map(t=>t.clone()),this.edges=e.edges.map(t=>t.clone()),this.centerEdges=e.centerEdges.map(t=>t.clone()),this}setFromObjectSize(e,t=!1){e.updateWorldMatrix(!1,t),this.makeEmpty(),this.matrix.copy(e.matrixWorld);let i=new we().copy(e.matrixWorld).invert();return this.expandByObjectSize(e,i,t)}expandByObjectSize(e,t,i=!1){let r=[];return i===!0?e.traverseEntity(s=>{if(s.visible||s.cloner&&s.data.visible){if(!("geometry"in s)){r.push(new E);return}dg(s,t,r)}}):dg(e,t,r),this.setFromPoints(r)}getCenter(e){return e=super.getCenter(e),e.applyMatrix4(this.matrix),e}getPositionToCenter(e){return e=super.getCenter(e),e.applyMatrix4(Wo.copy(this.matrix).setPosition(0,0,0)),e}computeVertices(){this.getSize(pn).multiplyScalar(.5),this.getCenter(un),Wo.copy(this.matrix).setPosition(un),this.vertices=vx.map(e=>e.clone().multiply(pn).applyMatrix4(Wo))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=EN.map(([e,t])=>new hr(this.vertices[e],this.vertices[t])),this.centerEdges=this.edges.map(e=>e.getCenter(new E))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=CN.map(([e,t])=>this.vertices[e].clone().add(this.vertices[t]).multiplyScalar(.5))}},La={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},TN=class extends Mv{constructor(){super()}getPoints(e=12){let t=[],i,r=this.getCurveLengths(),s=r[r.length-1]/r.length;for(let a=0,n=this.curves;a<n.length;a++){let o=n[a],l=a===0?r[a]:r[a]-r[a-1],h=Math.ceil(e*l/s),c=o.getPoints(h);for(let d=0;d<c.length;d++){let u=c[d];i&&i.equals(u)||(t.push(u),i=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}},hf=.001;function cf(e,t,i){return t.clone().sub(e).cross(t.clone().sub(i)).length()<=hf}function Wu(e,t){let i=new E(...e.position),r=new E(...e.controlNext.position),s=new E(...t.controlPrevious.position),a=new E(...t.position);return cf(i,r,a)&&cf(i,s,a)}function yx(e){let t=e.points.map(c=>new E(...c.data.position)),i=[e.points[0]],r=new E(...i[0].data.position);for(let c=0;c<e.points.length-1;c++)cf(r,t[c],t[c+1])||(i.push(e.points[c]),r=t[c]);i.push(e.points[e.points.length-1]);let s=e.isClosed,a=i.length-(s?0:1),n=i.length,o=[];for(let c=0;c<n;c++){let d=i[c].data,u=new E(...d.position),p=new E(...d.controlPrevious.position),f=new E(...d.controlNext.position),g={position:u,baseRoundness:d.roundness,controlPrevious:p,controlNext:f};if(d.roundness===0||!e.isClosed&&(c===0||c===n-1)){o[c]={...g,removedLength:0};continue}let m=s&&c==0?n-1:c-1,v=s&&c==n-1?0:c+1,y=i[m].data,x=i[v].data,w=new E(...y.position),_=new E(...x.position),b=w.clone().sub(u).normalize(),A=_.clone().sub(u).normalize();Object.assign(g,{prevDir:b,nextDir:A});let S=Wu(y,d),M=Wu(d,x);if(!S||!M)o[c]={...g,removedLength:0};else{let C=b.clone().add(A).normalize(),T=C.clone().cross(b).length()/b.dot(C);o[c]={...g,tan:T,removedLength:d.roundness/T}}}for(let c=0;c<a;c++){let d=c,u=s&&c===n-1?0:c+1,p=o[d],f=o[u];if(p.removedLength!==0||f.removedLength!==0){let g=p.position.distanceTo(f.position);p.removedLength=Math.min(p.removedLength,g/2),f.removedLength=Math.min(f.removedLength,g/2)}}let l=[];for(let c=0;c<a;c++){let d=c,u=s&&c===n-1?0:c+1,p=o[d],f=o[u],g=null;if(!Wu(i[d].data,i[u].data))p.position.distanceTo(f.position)>hf&&(g=new q0(p.position,p.controlNext,f.controlPrevious,f.position));else{let m=p.position.clone(),v=f.position.clone();(p.removedLength!==0||f.removedLength!==0)&&(p.nextDir&&m.add(p.nextDir.clone().setLength(p.removedLength)),f.prevDir&&v.add(f.prevDir.clone().setLength(f.removedLength))),m.distanceTo(v)>hf&&(g=new q0(m,m.clone().lerp(v,.3),v.clone().lerp(m,.3),v))}l[2*c+1]=g}for(let c=0;c<n;c++){let d=o[c];if(d.removedLength===0){l[2*c]=null;continue}let u=d.position,p=d.prevDir.clone().multiplyScalar(d.removedLength).add(u),f=d.nextDir.clone().multiplyScalar(d.removedLength).add(u),g=d.tan*d.removedLength,m=d.prevDir.clone().add(d.nextDir).normalize(),v=p.clone().lerp(f,.5),y=p.distanceTo(f)/2,x=m.clone().multiplyScalar(Math.sqrt(Math.pow(g,2)-Math.pow(y,2))).add(v),w=m.clone().multiplyScalar(-g).add(x),_=u.distanceTo(w)/u.distanceTo(v),b=d.prevDir.clone().multiplyScalar(_*u.distanceTo(p)).add(u),A=b.clone().lerp(w,2),S=p.clone().lerp(b,4/3),M=f.clone().lerp(A,4/3);l[2*c]=new q0(p,S,M,f)}let h=new TN;return l.forEach(c=>{c&&h.add(c)}),h}var Et;(e=>{function t(i){return i&&i.__isEntity}e.is=t})(Et||(Et={}));var ks=e=>Et.is(e),PN={type:"completeState",isfromEntity:!0},DN=["x","y","z"],qu=new E,IN=new E().set(0,1,0),G4=e=>class extends j4(e){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.destroyedInAction=!1,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new ug,this._recursiveBBox=new ug,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(t){let i=this.children[t];if(Et.is(i))return i}entityChildrenCount(){let t=this.children.length;for(;t--;)if(Et.is(this.children[t]))return t+1;return 0}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let t=this;for(;t.data.type!=="Instance";){let i=t.parent;if(Et.is(i))t=i;else return}return t}forInstancesRec(t){this.instances.forEach(i=>{i.disposed||t(i),i.forInstancesRec(t)})}super_Entity(t,i){typeof t=="string"&&(this.uuid=t),this.identity=t,this.data=i,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(t,i,r=!1){if(!(this.data.states.length===0&&!r)){for(let s of this.data.states)bn.toOps(this.data,s.data).forEach(a=>{let n=Ic.replaceProps(a,this.data);this.dataPatched=this.data,this.updateByPatchedOp(n,this.data,i)});if(t!==null){let s=this.data.states.data(t);s&&(this.dataPatched=bn.patch(this.data,s),bn.toOps(this.data,s).forEach(a=>{this.updateByPatchedOp(a,this.dataPatched,i)}))}r&&this.updateTransformState(this.dataPatched,i),this.stateSelection=t,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(t,i){t.setScalar(0),i.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(t=>{ks(t)&&t.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(t=>{t.resetBBoxNeedsUpdateSelf()})}find(t){let i;return this.traverseEntity(r=>{r.uuid===t&&(i=r)}),i}traverseSortNextHelper(){let t=this.parent;if(t){let i=t.children,r=i.indexOf(this)+1;if(Et.is(i[r]))return i[r];if(Et.is(t))return t.traverseSortNextHelper()}}sortNext(){let t=this.children;return this.children.length>0&&Et.is(this.children[0])?t[0]:this.traverseSortNextHelper()}goUp(t){let i=this;for(;t>0&&i!==null;)i=i.parent,t-=1;return i}hasAnccestorOrSelf(t){return this===t||this.hasAnccestor(t)}hasAnccestor(t){let i=this.parent;for(;i;){if(t===i)return!0;i=i.parent}return!1}countToAccestor(t){let i=0,r=this;for(;r!==t;){if(r===null)return-1;r=r.parent,i+=1}return i}forEachEntity(t){for(let i of this.children)ks(i)&&t(i)}traverseEntityAncestors(t){this.traverseAncestors(i=>{Et.is(i)&&t(i)})}traverseConcreteEntity(t,i=0){if(t(this,i)!==!0)for(let r of this.children)ks(r)&&r.isConcreteEntity&&r.traverseEntity(t,i+1)}traverseEntity(t,i=0){if(t(this,i)!==!0)for(let r of this.children)ks(r)&&r.traverseEntity(t,i+1)}traverseVisibleEntity(t){t(this);for(let i of this.children)ks(i)&&i.visible&&i.traverseVisibleEntity(t)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}updateMatrixWorld(t){super.updateMatrixWorld(t),this.dispatchEvent({type:"updateMatrixWorld"})}copy(t,i=!1){return super.copy(t,i),this.dataPatched=t.dataPatched,this.raycastLock=t.raycastLock,this.scaleLock=t.scaleLock,this.hiddenMatrix.copy(t.hiddenMatrix),this}hasEntityChild(){return this.children.some(t=>ks(t))}isAncestorOf(t){if(this.uuid===t)return!1;let i=!1;return this.traverseEntity(r=>{r.uuid===t&&(i=!0)}),i}toObjectTransformState(t=[]){this.updateWorldMatrix(!0,!1);let i={position:this.position.toArray(),rotation:[this.rotation.x*Oe.RAD2DEG,this.rotation.y*Oe.RAD2DEG,this.rotation.z*Oe.RAD2DEG],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return v3(i,t)}getTransformValues(t,i,r){return i[t].map((s,a)=>(r==null?void 0:r.shared.getVariable(s,[this.uuid,t,DN[a]]))??s)}updateTransformState(t,i){let r=!1;return t.position&&(this.position.fromArray(this.getTransformValues("position",t,i)),r=!0),t.rotation&&(qu.fromArray(this.getTransformValues("rotation",t,i)).multiplyScalar(Oe.DEG2RAD),this.rotation.setFromVector3(qu),r=!0),t.scale&&(this.scale.fromArray(this.getTransformValues("scale",t,i)),r=!0),t.hiddenMatrix!==void 0&&(r=!0,this.hiddenMatrix.fromArray(t.hiddenMatrix??ol.identity)),r&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(s=>{s.invalidateClonerTransform(this)})),t.position&&t.rotation&&t.scale&&t.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),r}onVariableUpdate(t=!1){if(t){this.resetBBoxNeedsUpdate();return}this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(i=>{i.invalidateClonerTransform(this)})}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let t of this.children)Et.is(t)&&t.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(t=>{Et.is(t)&&t.disposeRecursively()})}toState(t=[]){let i={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(t)};return v3(i,t)}updateByObjUpdateOp(t,i){t!==void 0&&this.updateByOp({type:0,props:t,path:[]},{...this.data,...t},i,!1)}updateByOp(t,i,r,s){let a=this.data;this.data=i;let n=t,o=Yt(t.path,["states","*"]);if(o!==null){if(t.type===0){let[l]=o;if((this==null?void 0:this.stateSelection)===l){let h={...t.props};if(delete h.name,Object.values(t.props).some(c=>c===void 0)){let c=this.data;if(c!==void 0){let d=Li.zoom(c,t.path.slice(2));if(d)for(let u in t.props)t.props[u]===void 0&&u in d&&(h[u]=d[u])}}n={...t,props:h,path:t.path.slice(2)}}}}else if(t.type===0){let l=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(l!==void 0){if(t.props.name!==void 0&&l.name){let{name:c,...d}=l;l=d}if(t.props.material!==void 0&&"material"in l){let{material:c,...d}=l;l=d}let h=Li.removeOverridden(t.path,t.props,l);n={...t,props:h}}}if(this.updateByPatchedOpBase(n,bn.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),r),Yt(t.path,["overrides"])){let l=[],h=[...t.path];for(l.push(h[1]),h.splice(0,2);h.length>0&&h[0]==="descendants";)l.push(h[1]),h.splice(0,2);if(l[l.length-1]===void 0){if(t.type===0)for(let c of Object.keys(t.props)){l[l.length-1]=c;let d=r.scene.findInstance([this.uuid,...l]);d&&(d.overrideData=t.props[c],d.updateState(ka.apply(d.component.data,d.overrideData),r))}}else{let c=r.scene.findInstance([this.uuid,...l]);if(c){let d=Li.zoom(c.component.data,h);if(t={...t,path:h},t.type===0){let u=t.props;if(d)for(let[p,f]of Object.entries(t.props))f===void 0&&(u===t.props&&(u={...t.props}),u[p]=d[p]);t={...t,props:u}}c.overrideData=jc.resolve(i.overrides,l),c.updateByOp(t,qi.applySimple(c.data,t),r,!1)}}}else if(this.instances.length>0){let l;if(t.path.length===0&&t.type===0){let h;for(let c of Oa.rootOverrideProps)c in t.props&&(h===void 0&&(h={}),h[c]=t.props[c]);h&&(l={...t,props:h})}else for(let h of Oa.rootOverrideProps)if(Yt(t.path,[h])){l=t;break}l!==void 0&&this.instances.forEach(h=>{if(h.isInstanceRoot){let c=ka.filterOp(h.overrideData,l);c&&h.updateByOp(c,qi.applySimple(h.data,c),r,!0)}}),this.instances.forEach(h=>{if(!h.isInstanceRoot){let c=ka.filterOp(h.overrideData,t);if(c){let d;a===h.data&&t===c?d=i:d=qi.applySimple(h.data,c),h.updateByOp(c,d,r,!0)}}})}}updateByPatchedOpBase(t,i,r){if(this.dataPatched=i,t.path.length===0&&t.type===0)t.props.type!==void 0&&!kn.is(t.props.type)&&La.changeEntityProptotype(this,i,r);else if(t.path.length===1&&t.path[0]==="geometry"&&t.type===0&&"type"in t.props){La.changeEntityProptotype(this,i,r);for(let s of this.children)Et.is(s)&&s.updateVisible(r.scene)}this.updateByPatchedOp(t,i,r)}updateByPatchedOp(t,i,r){var s;if(t.path.length===0&&t.type===0&&this.updateState(t.props,r),t.path[0]==="morphTargetInfluences"&&t.type===0){let a=(s=i.morphTargetInfluences.get(t.path[1]))==null?void 0:s.data.name;a&&this.updateMorphInfluences(a,r.shared.getVariable(t.props.value,[this.uuid,"morphTargetInfluences",a]))}if(Yt(t.path,["pathSnapping"])!==null&&this.updatePathSnapping(i.pathSnapping),Yt(t.path,["cloner"])!==null){let a=qi.drop(t,1);a.path.length===0&&a.type===0&&a.props.disabled===!0?this.setFromClonerState(null,r):this.cloner?this.cloner.updateState(i.cloner,r.scene):(this.setFromClonerState(i.cloner,r),this.expandCloner(r.scene)),this.updateVisible(r.scene)}}updatePathSnapping(t=this.dataPatched.pathSnapping){this._updatedPathSnapping=t,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(t){var f,g,m,v,y;let i=((f=this._updatedPathSnapping)==null?void 0:f.pathId)??this.dataPatched.pathSnapping.pathId,r=((g=this._updatedPathSnapping)==null?void 0:g.slide)??this.dataPatched.pathSnapping.slide??0,s=((m=this._updatedPathSnapping)==null?void 0:m.offset)??this.dataPatched.pathSnapping.offset??0,a=((v=this._updatedPathSnapping)==null?void 0:v.orientation)??this.dataPatched.pathSnapping.orientation;if(i===null)return;let n=t.find(i);if(!n||this._needApplyPathSnapping===!1)return;this._needApplyPathSnapping=!1;let o=n.data;if(o.geometry.path.points.length<=1)return;let l=yx(o.geometry.path),h=(r+s)%1;r+s===1&&h===0&&(h=1);let c=null;try{c=l.curves.length?l.getPointAt(h):null}catch{}if(c===null)return;let d=this.parent?(y=this.parent)==null?void 0:y.matrixWorld:new we;n.updateMatrixWorld();let u=new we().multiplyMatrices(d.clone().invert(),n.matrixWorld);c.applyMatrix4(u);let p={position:c.toArray(),rotation:o.rotation};if(a==="tangential"){let x=new we().extractRotation(n.matrixWorld),w=l.getTangentAt(h).applyMatrix4(x).add(c),_=new we().lookAt(c,w,IN),b=qu.setFromEuler(new Ri().setFromRotationMatrix(_)).multiplyScalar(Oe.RAD2DEG);p={...p,rotation:b.toArray()}}this.updateTransformState(p),this.traverseEntity(x=>{x._cameraType&&x.dispatchEvent(PN)})}updateVisible(t){var r;if(this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||((r=this.dataPatched.cloner)==null?void 0:r.hideBase)!==!0),!t)return;let i=!1;this.traverseEntity(s=>{if(s.data.type==="Splat")return i=!0,!0}),i&&t.reloadSplats()}updateState_Entity(t,i){t.name!==void 0&&(this.name=t.name),t.raycastLock!==void 0&&(this.raycastLock=t.raycastLock),t.visible!==void 0&&(this.updateVisible(i==null?void 0:i.scene),this.resetBBoxNeedsUpdate()),i&&"cloner"in t&&t.cloner!==void 0&&(this.setFromClonerState(t.cloner,i),this.updateVisible(i.scene)),this.updateTransformState(t,i)}get attachedSurfaceCloners(){return this.children.filter(t=>t instanceof La.Cloner&&t.parameters.type==="toObject")}setFromClonerState(t,i){this.disposed||(t===null||t.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):this.cloner===void 0?(this.cloner=new La.Cloner(this,t),i.scene.addPendingExpandCloner(this)):this.cloner.updateState(t,i.scene))}expandCloner(t){!this.disposed&&this.cloner&&this.cloner.expandClones(t)}invalidateClonerTransform(t){this.cloner&&this.cloner.invalidateTransform(t)}requestRender(){this.dispatchEvent({type:"requestRender"})}},xx=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},e.parameters);i.thetaLength=Oe.clamp(i.thetaLength,0,360);let r=i.width/2,s=i.radiusTop??r,a=i.radiusBottom??r;return s===a?(s=r,a=r):s>a?(s=r,a=a*r/s):(s=s*r/a,a=r),{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width),radiusTop:s,radiusBottom:a})}}static build(e){let{width:t,depth:i,height:r,radialSegments:s,heightSegments:a,openEnded:n,thetaStart:o,thetaLength:l,radiusTop:h,radiusBottom:c,cornerRadius:d,cornerSegments:u,hollow:p}=e.parameters,f;return l===0?(f=new Ge,f.setAttribute("position",new De([],3))):d||p?f=new bx(h,c,r,s,a,n,o,l*Math.PI/180,d,d,u,p):f=new l4(h,c,r,s,a,n,o,l*Math.PI/180),f.scale(1,1,i/t),Object.assign(f,{userData:{...e,type:"CylinderGeometry"}})}};function ma(e,t,i){i.x=e.x*t.x,i.y=e.y,i.z=e.x*t.y}function pg(e){return new j(e.y,-e.x)}var bx=class extends Ge{constructor(e,t,i,r,s,a,n,o,l,h,c,d,u=!1){super(),this.type="RoundedCylinderBufferGeometry",e=e!==void 0?e:1,t=t!==void 0?t:1,i=i||1,r=Math.floor(r)||8,s=Math.floor(s)||1,a=a!==void 0?a:!1,n=n!==void 0?n:0,o=o!==void 0?o:Math.PI*2,a&&(l=0,h=0);let p=[],f=[],g=[],m=[],v=0,y=i/2,x=new E,w=new E;u&&e==0&&(e=l),u&&t==0&&(t=h);let _=new j(e,y),b=new j(t,-y),A=null,S=null,M=null,C=null,T=_.clone().sub(b),P=0,I=0,D=0;d>0&&(P=Math.min(e,t)*(1-d),I=e-P,D=t-P);let k=_.clone();k.x-=P;let H=Math.PI-T.angle(),U=T.angle(),F=Math.tan(U/2),Z=Math.tan(H/2),W=F+Z,G=d?W:Z,X=d?W:F;if(l=Math.min(l,(e-I)/G,T.length()/W),h=Math.min(h,(t-D)/X,T.length()/W),l>0){let re=l/F;A=_.clone().sub(new j(re,l)),d&&(M=A.clone(),M.x-=P-W*l),_.sub(T.clone().setLength(re))}if(h>0){let re=h/Z;S=b.clone().sub(new j(re,-h)),b.add(T.clone().setLength(re)),d&&(C=S.clone(),C.x-=P-W*h,k.sub(T.clone().setLength(re)))}T=_.clone().sub(b);let ee=T.length()<.5,Y=[];for(let re=0;re<=r;re++){let te=[],ne=re/r,ce=ne*o+n,pe=new j(Math.sin(ce),Math.cos(ce));C&&S?($(te,ne,pe,H,h,C,-1,!0),$(te,ne,pe,U,h,S,-1,!1)):S?(Q(te,pe,S.x,0,-1),$(te,ne,pe,U,h,S,-1,!1)):a||Q(te,pe,t,D,-1);let xe=pg(T).normalize();if(ma(xe,pe,x),!ee)for(let Re=0;Re<=s;Re++){let Ae=Re/s,Ne=T.clone().multiplyScalar(Ae).add(b);ma(Ne,pe,w),f.push(w.x,w.y,w.z),g.push(x.x,x.y,x.z),m.push(ne,.5+w.y/i),te.push(v++)}if(M&&A?($(te,ne,pe,H,l,A,1,!1),$(te,ne,pe,U,l,M,1,!0)):A?($(te,ne,pe,H,l,A,1,!1),Q(te,pe,A.x,0,1)):a||Q(te,pe,e,I,1),d&&!ee){let Re=pg(T).multiplyScalar(-1).normalize();ma(Re,pe,x);for(let Ae=0;Ae<=s;Ae++){let Ne=Ae/s,Fe=T.clone().multiplyScalar(-Ne).add(k);ma(Fe,pe,w),f.push(w.x,w.y,w.z),g.push(x.x,x.y,x.z),m.push(ne,.5+w.y/i),te.push(v++)}}d&&!a&&te.push(te[0]),Y.push(te)}for(let re=0;re<Y.length-1;re++)for(let te=0;te<Y[0].length-1;te++){if(a&&d&&te==s)continue;let ne=Y[re][te],ce=Y[re+1][te],pe=Y[re+1][te+1],xe=Y[re][te+1],Re=f[pe*3+0],Ae=f[pe*3+2];p.push(ne,ce,xe),(Re!=0||Ae!=0)&&p.push(ce,pe,xe)}o<Math.PI*2&&(le(-1,Y[0],n),le(1,Y[Y.length-1],n+o)),this.setIndex(p),this.setAttribute("position",new De(f,3)),this.setAttribute("normal",new De(g,3)),this.setAttribute("uv",new De(m,2));function $(re,te,ne,ce,pe,xe,Re,Ae){for(let Ne=0;Ne<c+1;Ne++){let Fe=Ne/c,Ee=Re<0?Fe:1-Fe;Ae&&(Ee-=1),Ee*=ce;let Me=new j(Math.sin(Ee),Math.cos(Ee)*Re),Ye=Me.clone().multiplyScalar(pe).add(xe);ma(Ye,ne,w),f.push(w.x,w.y,w.z),ma(Me,ne,x),g.push(x.x,x.y,x.z),m.push(te,.5+w.y/i),re.push(v++)}}function Q(re,te,ne,ce,pe){let xe=new E,Re=new j,Ae=[ne,ce];pe<0&&Ae.reverse();for(let Ne of Ae)Re.set(Ne,y*pe),ma(Re,te,xe),f.push(xe.x,xe.y,xe.z),g.push(0,pe,0),m.push(.5,.5),re.push(v++)}function le(re,te,ne){let ce=new j(Math.sin(ne),Math.cos(ne)),pe=new j(-Math.cos(ne),Math.sin(ne)),xe=new E,Re=re<0?(Fe,Ee,Me)=>p.push(Fe,Ee,Me):(Fe,Ee,Me)=>p.push(Fe,Me,Ee),Ae=new j((e+t+I+D)/4,0);ma(Ae,ce,xe),f.push(xe.x,xe.y,xe.z),g.push(pe.x,0,pe.y),m.push(.5,.5);let Ne=v++;for(let Fe of te){let Ee=f.slice(Fe*3,Fe*3+3);f.push(...Ee),g.push(pe.x,0,pe.y);let Me=m.slice(Fe*2,Fe*2+2);m.push(...Me),v++}for(let Fe=Ne+1;Fe<v-1;Fe++)Re(Ne,Fe,Fe+1);Re(Ne,v-1,Ne+1)}}},ON=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},e.parameters);return i.thetaLength=Oe.clamp(i.thetaLength,0,360),{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,depth:i,height:r,radialSegments:s,heightSegments:a,openEnded:n,thetaStart:o,thetaLength:l,cornerRadiusTop:h,cornerRadiusBottom:c,cornerSegments:d}=e.parameters,u;return l===0?(u=new Ge,u.setAttribute("position",new De([],3))):h>0||c>0||l<360?u=new bx(0,t/2,r,s,a,n,o,l*Math.PI/180,h,c,d,0,!0):u=new h4(t/2,r,s,a,n),u.scale(1,1,i/t),Object.assign(u,{userData:{...e,type:"ConeGeometry"}})}},RN=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,height:i,depth:r,widthSegments:s,heightSegments:a,depthSegments:n,cornerRadius:o,cornerSegments:l}=e.parameters,h;return o===0?h=new Lr(t,i,r,s,a,n):h=new LN(t,i,r,s,a,n,o,l),Object.assign(h,{userData:{...e,type:"CubeGeometry"}})}},Yu=Math.PI/2,LN=class extends Ge{constructor(e=1,t=1,i=1,r=1,s=1,a=1,n=0,o=4){super(),this.type="BoxGeometry",r=Math.floor(r),s=Math.floor(s),a=Math.floor(a),o=Math.floor(o),n=Math.min(n,e/2,t/2,i/2);let l=[],h=[],c=[],d=[],u=0;p("z","y","x",-1,-1,i,t,e,a,s),p("z","y","x",1,-1,i,t,-e,a,s),p("x","z","y",1,1,e,i,t,r,a),p("x","z","y",1,-1,e,i,-t,r,a),p("x","y","z",1,-1,e,t,i,r,s),p("x","y","z",-1,-1,e,t,-i,r,s),n>0&&(f("z","y","x",-1,-1,1,i,t,e,a),f("z","y","x",1,-1,-1,i,t,e,a),f("z","y","x",-1,1,-1,i,t,e,a),f("z","y","x",1,1,1,i,t,e,a),f("x","y","z",-1,-1,-1,e,t,i,r),f("x","y","z",1,-1,1,e,t,i,r),f("x","y","z",-1,1,1,e,t,i,r),f("x","y","z",1,1,-1,e,t,i,r),f("y","x","z",-1,-1,1,t,e,i,s),f("y","x","z",1,-1,-1,t,e,i,s),f("y","x","z",1,1,1,t,e,i,s),f("y","x","z",-1,1,-1,t,e,i,s),g(1,1,1),g(-1,1,1),g(1,-1,1),g(-1,-1,1),g(1,1,-1),g(-1,1,-1),g(1,-1,-1),g(-1,-1,-1)),this.setIndex(l),this.setAttribute("position",new De(h,3)),this.setAttribute("normal",new De(c,3)),this.setAttribute("uv",new De(d,2));function p(m,v,y,x,w,_,b,A,S,M){let C=(_-2*n)/S,T=(b-2*n)/M,P=_/2-n,I=b/2-n,D=A/2,k=S+1,H=M+1,U=0,F=new E;for(let Z=0;Z<H;Z++){let W=Z*T-I;for(let G=0;G<k;G++){let X=G*C-P;F[m]=X*x,F[v]=W*w,F[y]=D,h.push(F.x,F.y,F.z),F[m]=0,F[v]=0,F[y]=A>0?1:-1,c.push(F.x,F.y,F.z),d.push(G/S),d.push(1-Z/M),U+=1}}for(let Z=0;Z<M;Z++)for(let W=0;W<S;W++){let G=u+W+k*Z,X=u+W+k*(Z+1),ee=u+(W+1)+k*(Z+1),Y=u+(W+1)+k*Z;l.push(G,X,Y),l.push(X,ee,Y)}u+=U}function f(m,v,y,x,w,_,b,A,S,M){let C=(b-2*n)/M,T=b/2-n,P=A/2-n,I=S/2,D=M+1,k=0,H=new E,U=new E;for(let F=0;F<o+1;F++){let Z=F/o*Yu,W=Math.sin(Z)*n,G=(1-Math.cos(Z))*n,X=Math.sin(Z),ee=Math.cos(Z);H[v]=(P+W)*w,H[y]=(I-G)*_,U[m]=0,U[v]=X*Math.sign(H[v]),U[y]=ee*Math.sign(H[y]);for(let Y=0;Y<D;Y++){let $=Y*C-T;H[m]=$*x,h.push(H.x,H.y,H.z),c.push(U.x,U.y,U.z),d.push(Y/M),d.push(0),k+=1}}for(let F=0;F<o;F++)for(let Z=0;Z<M;Z++){let W=u+Z+D*F,G=u+Z+D*(F+1),X=u+(Z+1)+D*(F+1),ee=u+(Z+1)+D*F;l.push(W,G,ee),l.push(G,X,ee)}u+=k}function g(m,v,y){let x=new E,w=new E(e/2,t/2,i/2);w.subScalar(n);let _=[],b=m*v*y>0?(S,M,C)=>l.push(S,M,C):(S,M,C)=>l.push(S,C,M);for(let S=0;S<=o;S++){let M=[],C=Yu*(1-S/o),T=Math.cos(C),P=Math.sin(C),I=0;for(let D=0;D<=S;D++){let k=Math.cos(I),H=Math.sin(I);x.x=T*k,x.y=P,x.z=T*H;let U=w.clone().addScaledVector(x,n);h.push(m*U.x,v*U.y,y*U.z),c.push(m*x.x,v*x.y,y*x.z),d.push(0,0),M.push(u++),I+=Yu/S}_.push(M)}let A=_.length-1;for(let S=0;S<A;S++){let M=_[S],C=_[S+1],T=M.length-1;b(M[0],C[1],C[0]);for(let P=1;P<=T;P++)b(M[P-1],M[P],C[P]),b(M[P],C[P+1],C[P])}}}},H4=class extends Ge{constructor(e=[],t=[],i="",r=1,s=.2,a=4){super(),this.type="PolyhedronGeometryRound";let n=[],o=[],l=[];h(),c(),this.setAttribute("position",new De(n,3)),this.setAttribute("normal",new De(l,3)),this.setAttribute("uv",new De(o,2));return;function h(){var U;s=Math.min(1-1e-5,s),s==0&&(a=0);let d={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[i],u=new E,p=u.clone(),f=new r1,g=s*r,m=r-g,v=a+1,y=new E,x=(F,Z)=>y.subVectors(F,Z).normalize(),w=(F,Z)=>Array(F).fill(void 0).map(Z),_=w(e.length/3,(F,Z)=>new E().fromArray(e,Z*3).setLength(r)),b=[],A=1e6;for(let F=0;F<_.length;F++){let Z=_[F],W=[],G,X,ee,Y=1e10,$=-1;for(;($=t.indexOf(F,$+1))!=-1;){let te=$-$%3;G=t[te+($+1)%3],X=t[te+($+2)%3],ee=Z.distanceToSquared(_[G]),Y=Math.min(Y,ee),W.push([G,X,ee])}Y+=1e-6;let Q=[],le=0,re=W.length;for(let te=0;te<re;te++){[G,X,ee]=W[le];let ne=((U=b[G])==null?void 0:U.includes(F))==!0;ee<=Y&&Q.push(G+ +ne*A),le=W.findIndex(ce=>ce[0]==X)}b.push(Q)}let S=[];{let F=0,Z=0,W,G,X=d==3;for(let ee=0;ee<=a;ee++){W=ee*(ee+1)/2,G=(ee+1)*(ee+2)/2;for(let Y=0;Y<a-ee;Y++)[F,Z]=[W+Y+ee+2,G+Y+ee+3],S.push(W,G,...X?[Z,W]:[F,G],Z,F),[W,G]=[F,Z];S.push(W,G,W+a+2)}}let M=u.clone(),C=u.clone(),T=u.clone(),P=u.clone(),I=u.clone(),D=[],k=w(_.length,()=>w(d,()=>u.clone()));for(let F=0;F<_.length;F++){u.copy(_[F]).normalize(),M.copy(u).multiplyScalar(m);let Z=b[F];for(let Q=0;Q<Z.length;Q++){let le=Z[Q],re=Z[(Q+1)%d];f.setFromPointsAndIndices(_,F,le%A,re%A),f.b.sub(f.a).setLength(1e10).add(f.a),f.c.sub(f.a).setLength(1e10).add(f.a),f.closestPointToPoint(M,k[F][Q])}let W=[],G=[],X=[],ee=new E;a==0&&[...k[F]].reduce((Q,le)=>Q.add(le),ee).multiplyScalar(1/d);for(let Q=0;Q<d;Q++){let le=[],re=(Q-1+d)%d,te=k[F][re],ne=k[F][Q];u.copy(te).sub(M),p.copy(ne).sub(M);let ce=M.angleTo(u),pe=u.angleTo(p),xe=Math.cos(ce)*g;a==0?C.copy(ee):C.copy(M).setLength(m+xe),G.push(xe);let Re=[C,te,ne];for(let Ae=0;Ae<2;Ae++){let Ne=Re[Ae],Fe=Re[Ae+1];P.subVectors(Ne,M),I.subVectors(Fe,M),T.crossVectors(P,I).normalize();for(let Ee=0;Ee<v;Ee++){let Me=[ce,pe][Ae]*Ee/v;u.copy(P).applyAxisAngle(T,Me).add(M),W.push(u.clone()),Ae&&(x(u,M),le.push([Ee==0?Ne:u.clone(),y.clone()]))}Ae&&(x(Fe,M),le.push([Fe,y.clone()]))}X.push(le)}D.push(X);let Y=2*v,$=2;for(let Q=0;Q<d;Q++){let le=Y*Q,re=Y*((Q+1)%d),te=[W[le]];for(let ce=1;ce<v;ce++){P=W[le+ce],I=W[re+ce],te.push(P);for(let pe=1,xe=ce-$+1;pe<=xe;pe++)u.lerpVectors(P,I,pe/(xe+1)),u.sub(M).setLength(G[Q]).add(M),te.push(u.clone());te.push(I)}for(let ce=0;ce<v;ce++)te.push(W[ce+v+le]);te.push(W[re+v]);let ne=S.map(ce=>te[ce]);n.push(...ne.map(ce=>[ce.x,ce.y,ce.z]).flat()),l.push(...ne.map(ce=>(x(ce,M),[y.x,y.y,y.z])).flat())}}let H=[];for(let F=0;F<b.length;F++)for(let Z=0;Z<d;Z++){let W=b[F][Z];if(W<A){let G=b[W].findIndex(Y=>Y%A==F),X=D[F][Z],ee=D[W][G];for(let Y=0;Y<v;Y++){let $=X[Y],Q=ee[v-Y],le=X[Y+1],re=ee[v-(Y+1)];[$,Q,le,le,Q,re].forEach(te=>{n.push(te[0].x,te[0].y,te[0].z),l.push(te[1].x,te[1].y,te[1].z)})}H.push(X[0][0],ee[v][0],X[v][0],ee[0][0])}}for(;H.length;){let F,Z,W,G;[F,Z]=H.splice(0,2);let X=[F];for(;F!=Z;)X.push(Z),W=H.indexOf(Z),G=W%2,Z=H.splice(W-G,2)[1-G];y.subVectors(X[0],X[1]).cross(u.subVectors(X[0],X[2])).normalize();let ee=y.dot(X[0])<0;ee&&y.negate();for(let Y=1;Y<=X.length-2;Y++)[X[Y+ +ee],X[Y+1-+ee],X[0]].forEach($=>{n.push($.x,$.y,$.z),l.push(y.x,y.y,y.z)})}}function c(){let d=new E;for(let b=0;b<n.length;b+=3){d.x=n[b+0],d.y=n[b+1],d.z=n[b+2];let A=w(d)/2/Math.PI+.5,S=_(d)/Math.PI+.5;o.push(A,1-S)}let u=new E,p=new E,f=new E,g=new E,m=new j,v=new j,y=new j,x=(b,A,S,M)=>{M<0&&b.x===1&&(o[A]=b.x-1),S.x===0&&S.z===0&&(o[A]=M/2/Math.PI+.5)};for(let b=0,A=0;b<n.length;b+=9,A+=6){u.set(n[b+0],n[b+1],n[b+2]),p.set(n[b+3],n[b+4],n[b+5]),f.set(n[b+6],n[b+7],n[b+8]),m.set(o[A+0],o[A+1]),v.set(o[A+2],o[A+3]),y.set(o[A+4],o[A+5]),g.copy(u).add(p).add(f).divideScalar(3);let S=w(g);x(m,A+0,u,S),x(v,A+2,p,S),x(y,A+4,f,S)}for(let b=0;b<o.length;b+=6){let A=o[b+0],S=o[b+2],M=o[b+4],C=Math.max(A,S,M),T=Math.min(A,S,M);C>.9&&T<.1&&(A<.2&&(o[b+0]+=1),S<.2&&(o[b+2]+=1),M<.2&&(o[b+4]+=1))}function w(b){return Math.atan2(b.z,-b.x)}function _(b){return Math.atan2(-b.y,Math.sqrt(b.x*b.x+b.z*b.z))}}}static fromJSON(e){return new H4(e.vertices,e.indices,e.radius,e.corner,e.cornerSides)}},BN=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,height:i,depth:r,detail:s,corner:a,cornerSides:n}=e.parameters,o=s===0&&a!==0?new wx(t*.5,a,n):new Cv(t*.5,s);return o.scale(1,i/t,r/t),Object.assign(o,{userData:{...e,type:"DodecahedronGeometry"}})}},wx=class extends H4{constructor(e=1,t=.2,i=4){let r=(1+Math.sqrt(5))/2,s=1/r,a=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-r,0,-s,r,0,s,-r,0,s,r,-s,-r,0,-s,r,0,s,-r,0,s,r,0,-r,0,-s,r,0,-s,-r,0,s,r,0,s],n=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],o="DodecahedronGeometry";super(a,n,o,e,t,i),this.type=o}static fromJSON(e){return new wx(e.radius,e.corner,e.cornerSides)}},Kl=1e-12,W4=class{constructor(e){this.position=new j,this.startPosition=new j,this.uuid=Oe.generateUUID(),this.position=e.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(e){this.position.copy(this.startPosition).add(e)}copy(e){return this.position.copy(e.position),this.startPosition.copy(e.startPosition),this}clone(){return new W4(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},df=class extends W4{constructor(e){super(e.position),this.parent=e}copy(e){return super.copy(e),this}clone(){return new df(this.parent).copy(this)}},qo=class extends W4{constructor(e,t){super(t),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=e,this.controls.push(new df(this),new df(this))}static create(e,t){let i=new qo(e,new j(...t.position));return i.controls[0].position.set(...t.controlPrevious.position),i.controls[1].position.set(...t.controlNext.position),i.roundness=t.roundness,i.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored,i}getOppositeControl(e){let t=this.controls.indexOf(e);return t===0?this.controls[1]:t===1?this.controls[0]:null}applyOffsetToControls(e,t=1){for(let i=0,r=this.controls.length;i<r;i++){let s=this.controls[i];this.position.distanceTo(s.position)<=t?s.position.copy(this.position):s.applyOffset(e)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(e){return super.copy(e),this.controls[0].copy(e.controls[0]),this.controls[1].copy(e.controls[1]),this.roundness=e.roundness,this.uuid=e.uuid,this}clone(){return new qo(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var i,r;let e=(i=this.curveBefore)==null?void 0:i.getTangentAt(1),t=(r=this.curveAfter)==null?void 0:r.getTangentAt(0);return[e,t]}computeNormals(e=new j,t=new j){let[i,r]=this.computeTangents();return i&&r&&(fg(i,e),fg(r,t)),[e,t]}computeTangent(e=new j){let[t,i]=this.computeTangents();return t&&i&&e.copy(t).add(i).normalize(),e}computeNormal(e=new j){let[t,i]=this.computeNormals();return e.copy(t).add(i).normalize(),e}};function fg(e,t=new j){let i=e.length();return t.set(-e.y/i,e.x/i)}var q4=e=>e,Dl=new j,Dd=new j,zN=new j,FN=new j,kN=new j,UN=new j,Sx=new E,_x=new E;function NN(e){let t=new j;t.addVectors(e.v0,Dl.subVectors(e.v1,e.v0).multiplyScalar(2/3));let i=new j;return i.addVectors(e.v2,Dd.subVectors(e.v1,e.v2).multiplyScalar(2/3)),new Cr(e.v0,t,i,e.v2)}function f2(e,t,i=Number.EPSILON){return Math.abs(e-t)<i}function VN(e,t,i=Number.EPSILON){return e.distanceTo(t)<i}function jN(e,t,i=Number.EPSILON){return e.distanceTo(t)<i}function Ax(e,t,i){let r=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),s=Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)),a=Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2));return Math.acos((s*s+r*r-a*a)/(2*s*r))}function GN(e,t,i){return gg(e,t)&&gg(t,i)&&uf(e.position,t.position,i.position)}function uf(e,t,i){return Dl.copy(t).sub(e).cross(Dd.copy(i).sub(e))===0}function HN(e,t,i,r,s){let a=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),n=(e.y+t.y)/2,o=(e.x+t.x)/2,l=Math.sqrt(Math.pow(i,2)-Math.pow(a/2,2))*(e.y-t.y)/a,h=Math.sqrt(Math.pow(i,2)-Math.pow(a/2,2))*(t.x-e.x)/a;return r.set(o+l,n+h),s.set(o-l,n-h),[r,s]}function WN(e,t,i){let r=e.distanceTo(i),s=t.distanceTo(i);return r<s?t:e}function qN(e,t,i,r,s,a){let n=t.x-e.x,o=t.y-e.y,l=i.x-e.x,h=i.y-e.y,c=Math.sqrt((n+l)*(n+l)+(o+h)*(o+h)),d;return Ax(t,e,i)>Math.PI&&(c*=-1),f2(h,o)?d=(o+h)*(r/c-.5)*8/3/(n-l):d=(n+l)*(r/c-.5)*8/3/(h-o),s.set(t.x-d*o,t.y+d*n),a.set(i.x+d*h,i.y-d*l),[s,a]}function mg(e,t){return e.position.equals(e.controls[1].position)&&t.position.equals(t.controls[0].position)}function gg(e,t){return uf(e.position,e.controls[1].position,t.position)&&uf(e.position,t.controls[0].position,t.position)}function YN(e,t,i,r,s=.5){let a=Dl.subVectors(t,e).multiplyScalar(s).add(e),n=Dd.subVectors(i,t).multiplyScalar(s).add(t),o=zN.subVectors(r,i).multiplyScalar(s).add(i),l=a,h=FN.subVectors(n,a).multiplyScalar(s).add(a),c=kN.subVectors(o,n).multiplyScalar(s).add(n),d=o,u=UN.subVectors(c,h).multiplyScalar(s).add(h);return[e.x,e.y,l.x,l.y,h.x,h.y,u.x,u.y,c.x,c.y,d.x,d.y,r.x,r.y]}function XN(e,t,i=12,r=!0){let s=_x.set(0,0,0),a,n=0;for(let o=0;o<t.length;o++){let l=q4(t[o]),h=Dl,c=Rn(l,i);for(let d=0;d<=c;d++)if(l instanceof Cr||l instanceof Ga||l instanceof Ir){if(l.getPoint(d/c,h),s.set(h.x,h.y,0),a!==void 0&&jN(a,s))continue;a===void 0&&(a=Sx),a.copy(s),e.setXYZ(n,s.x,s.y,s.z),n++}}return r&&n>1&&!(e.getX(n-1)===e.getX(0)&&e.getY(n-1)===e.getY(0)&&e.getZ(n-1)===e.getZ(0))&&(e.setXYZ(n,e.getX(0),e.getY(0),e.getZ(0)),n++),e}function QN(e,t,i,r=12,s=!0){let a=_x.set(0,0,0),n=0,o=[];for(let l=0;l<t.length;l++){if(i[l]===!1)continue;let h,c=q4(t[l]),d=Dl,u=Rn(c,r);o.push(u);for(let p=0;p<=u;p++)if(c instanceof Cr||c instanceof Ga||c instanceof Ir){if(c.getPoint(p/u,d),a.set(d.x,d.y,0),h==null?void 0:h.equals(a))continue;h===void 0?h=Sx:(e.setXYZ(n,h.x,h.y,h.z),n++,e.setXYZ(n,a.x,a.y,a.z),n++),h.copy(a)}}return s&&n>1&&!(e.getX(n-1)===e.getX(0)&&e.getY(n-1)===e.getY(0)&&e.getZ(n-1)===e.getZ(0))&&(e.setXYZ(n,e.getX(0),e.getY(0),e.getZ(0)),n++),o}function vg(e,t=12,i=!1){let r=[];for(let s=0,a=e.length;s<a;s++){let n=e[s],o=0;if(i&&n.roundedCurveCorner!==void 0){let l=Rn(n.roundedCurveCorner,t)*.5;s>0&&(r[s-1]+=l),o+=l}n.curveAfter!==void 0&&(o+=Rn(n.curveAfter,t)),r.push(o)}return e.length>0&&i&&e[0].roundedCurveCorner!==void 0&&(r[e.length-1]+=Rn(e[0].roundedCurveCorner,t)*.5),r}function Rn(e,t=12){return e&&e instanceof md?t*2:e&&(e instanceof Ir||e instanceof Av)?1:e&&e instanceof o4?t*e.points.length:t}function ZN(e,t,i=12,r=!0){let s,a=0;for(let n=0;n<t.length;n++){let o=q4(t[n]),l=Rn(o,i),h=Dl;for(let c=0;c<=l;c++)if(o instanceof Cr||o instanceof Ga||o instanceof Ir){if(o.getPoint(c/l,h),s!==void 0&&VN(s,h,Kl))continue;s===void 0&&(s=Dd),s.copy(h),e.push(h.x,h.y),a++}}return f2(e[0],e[e.length-2],Kl)&&f2(e[1],e[e.length-1],Kl)&&(e.pop(),e.pop()),r&&a>1&&!(f2(e[a-1],e[1],Kl)&&f2(e[a-2],e[0],Kl))&&(e.push(e[0],e[1]),a++),e}var Xu=new j,KN=new j,JN=new j,$N=new j,eV=new j,tV=new j,hi=class extends gc{constructor(e=100,t=100){super(),this.points=[],this.shapeHoles=[],this.plane=new B1(new E(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this.isText=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=Oe.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=e,this._height=t}static createFromState(e,t,i){let r=new hi;return r.isClosed=e.isClosed,r.points=e.points.map(s=>qo.create(s.id,s.data)),typeof e.roundness=="number"&&(r.roundness=e.roundness),r.shapeHoles=e.shapeHoles.map(s=>hi.createFromState(s)),t!==void 0&&i!==void 0&&r.applySize(t,i),r.update(),r}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(e){if(this._roundness!==e){this._roundness=e;for(let t=0,i=this.points.length;t<i;t++)this.points[t].roundness=e;this.needsUpdate=!0}}getPointsIndexesByIds(e){return e.map(t=>this.getPointIndexById(t)).filter(t=>t>=0)}getPointIndexById(e){let t=this.points.length,i=this.points.findIndex(r=>r.uuid===e);if(i<0){let r=t;for(let s=0,a=this.shapeHoles.length;s<a;s++){let n=this.shapeHoles[s],o=n.points.length,l=n.getPointIndexById(e);if(l<0)r+=o;else return l+r}}return i}getLineIndexById(e){return this.getPointIndexById(e)}getBezierPoint(e){if(e<=this.points.length-1)return this.points[e];if(this.shapeHoles.length>0){let t=this.points.length;for(let i=0,r=this.shapeHoles.length;i<r;i++){let s=this.shapeHoles[i],a=e-t;if(a<=s.points.length-1)return s.points[a];t+=s.points.length}}throw new Error("This shape does not have a point for this index: "+e)}getBezierPointIndex(e){let t=this.points.indexOf(e);if(t>=0)return t;if(t=this.points.length,this.shapeHoles.length>0)for(let i=0,r=this.shapeHoles.length;i<r;i++){let s=this.shapeHoles[i],a=s.points.indexOf(e);if(a>=0)return t+a;t+=s.points.length}return-1}getAllPoints(){let e=[].concat(...this.shapeHoles.map(t=>t.points));return[...this.points,...e]}applySize(e,t){e===0&&(e=.001),t===0&&(t=.001),this._width=e,this._height=t}applyScale(e,t){let i=Xu.set(e,t);for(let r=0,s=this.points.length;r<s;r++){let a=this.points[r];a.position.multiply(i),a.controls[0].position.multiply(i),a.controls[1].position.multiply(i)}for(let r=0,s=this.shapeHoles.length;r<s;r++)this.shapeHoles[r].applyScale(e,t);this._update()}createPoint(e,t=0,i=Oe.generateUUID()){let r;e instanceof j?r=e:r=new j(e,t);let s=new qo(i,r);return s.roundness=this.roundness,s}addPoint(e){this.points.push(e),this.needsUpdate=!0}addPointAt(e,t){this.points.splice(t,0,e),this.needsUpdate=!0}getPointByUuid(e){for(let t=0,i=this.points.length;t<i;t++){let r=this.points[t];if(r.uuid===e)return r}for(let t=0,i=this.shapeHoles.length;t<i;t++){let r=this.shapeHoles[t].getPointByUuid(e);if(r)return r}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(e){let t=this.points.indexOf(e);t>=0&&this.points.splice(t,1),this.needsUpdate=!0}removePointById(e){let t=this.points.find(i=>i.uuid===e);t&&this.removePoint(t)}update(){for(let e=0,t=this.shapeHoles.length;e<t;e++)this.shapeHoles[e].update();this._update()}extractShapePointsToBuffer(e,t=12,i=!1){this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t);let r=i?this.roundedCurveDivisions:this.curveDivisions;return XN(e,i?this.roundedCurves:this.curves,t,this.autoClose),r.reduce((s,a)=>s+a,0)+1}computeCurveDivisions(e=12){return this.curveDivisions=vg(this.points,e,!1),this.roundedCurveDivisions=vg(this.points,e,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(e,t,i=12){return QN(e,this.curves,t,i,this.autoClose).reduce((r,s)=>r+s,0)*2}extractShapePointsToFlatArray(e,t=12){return this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t),ZN(e,this.roundedCurves,t,this.autoClose)}getCurveIndexFromVertexId(e,t=!1){let i=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let r=t?this.roundedCurveDivisions:this.curveDivisions,s=0;t&&this.points[0].roundedCurveCorner!==void 0&&(s=Rn(this.points[0].roundedCurveCorner,this.subdivision)*.5);let a=e-s;a<0&&(a+=r.reduce((n,o)=>n+o,0));for(let n=0,o=r.length;n<o;n++){let l=r[n];if(a<i+l)return[n,(a-i+1)/l];i+=l}return[0,1]}getCurveT(e,t,i){let r=this.points[e],s=this.points[e>=this.points.length-1?0:e+1],a=this.curveDivisions,n=a[e];if(mg(r,s)){let l=r.position.distanceTo(s.position);return r.position.distanceTo(Xu.set(i.x,i.y))/l}let o=0;for(let l=0;l<e;l++)o+=a[l];return(t-o)/n}dispose(){}_applyCurveForPoint(e,t){mg(t,e)?this.lineTo(e.position.x,e.position.y):this.bezierCurveTo(t.controls[1].position.x,t.controls[1].position.y,e.controls[0].position.x,e.controls[0].position.y,e.position.x,e.position.y);let i=this.curves[this.curves.length-1];e.curveBefore=i,t.curveAfter=i;let r=i.clone();e.roundedCurveBefore=r,t.roundedCurveAfter=r,e.roundedCurveCorner=void 0,this.roundedCurves.push(r)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let t=0,i=this.points.length;t<i;t++){let r=this.points[t];if(t===0)this.moveTo(r.position.x,r.position.y);else{let s=this.points[t-1];this._applyCurveForPoint(r,s)}}let e=this.getLastPoint();if(e!=null&&e.curveAfter&&(e.curveAfter=void 0),this.isClosed){let t=this.points[0],i=this.points[this.points.length-1];this._applyCurveForPoint(t,i)}if(this.points.length>2){let t=0;for(let i=0,r=this.points.length;i<r;i++){let s=this.points[i],a=this.points[i-1]??this.points[this.points.length-1],n=this.points[i+1]??this.points[0],o=s.roundness,l=a&&n&&GN(a,s,n);if(!s.controlsMoved()&&o>0&&!l){let h=s.curveBefore,c=s.curveAfter;if(h===void 0||c===void 0)continue;let d=s.roundedCurveBefore,u=s.roundedCurveAfter,p=h.getLength(),f=c.getLength(),g=Math.min(o,p*.499),m=Math.min(o,f*.499),v=Math.min(g,m),y=1-v/p,x=v/f,w=h.getPointAt(y,Xu),_=c.getPointAt(x,KN);this._subSplitCurve(h,d,y,w,void 0),this._subSplitCurve(c,u,x,void 0,_);let b;if(this.useCubicForRoundedCorners){let A=Ax(w,s.position,_)/2,S=Math.tan(A)*w.distanceTo(s.position),[M,C]=HN(w,_,S,JN,$N),T=WN(M,C,s.position),[P,I]=qN(T,w,_,S,eV,tV);b=new Cr(w.clone(),P.clone(),I.clone(),_.clone())}else b=new Ga(w.clone(),s.position.clone(),_.clone());s.roundedCurveCorner=b,this.roundedCurves.splice(i+t,0,b),t++}}}}_subSplitCurve(e,t,i,r,s){if(e instanceof Ir)r!==void 0&&t.v2.copy(r),s!==void 0&&t.v1.copy(s);else{let a=e,n=t,o=a.getUtoTmapping(i,0),l=YN(a.v0,a.v1,a.v2,a.v3,o);return r!==void 0&&(n.v0.set(l[0],l[1]),n.v1.set(l[2],l[3]),n.v2.set(l[4],l[5]),n.v3.set(l[6],l[7])),s!==void 0&&(n.v0.set(l[6],l[7]),n.v1.set(l[8],l[9]),n.v2.set(l[10],l[11]),n.v3.set(l[12],l[13])),n}return t}clone(){let e=new hi(this._width,this._height);return e.points=this.points.map(t=>t.clone()),e.isClosed=this.isClosed,e.roundness=this.roundness,e.isMesh2D=this.isMesh2D,e.shapeHoles=this.shapeHoles.map(t=>t.clone()),e}toJSON(){return{points:this.points.reduce((e,t)=>e.concat(t.toJSON()),[]),shapeHoles:this.shapeHoles.map(e=>e.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(e){var i;this.points=[],this.pointIDs=0;let t=e.points.length/7;for(let r=0;r<t;r++){let s=r*7,a=e.points[s+0],n=e.points[s+1],o=e.points[s+2],l=e.points[s+3],h=e.points[s+4],c=e.points[s+5],d=e.points[s+6],u=new qo(Oe.generateUUID(),new j(a,n));u.controls[0].position.set(o,l),u.controls[1].position.set(h,c),u.roundness=d,this.points.push(u)}return this.shapeHoles=(i=e.shapeHoles)!=null&&i.length?e.shapeHoles.map(r=>{let s=new hi;return s.fromJSON(r),s}):[],this.isClosed=e.isClosed,this._roundness=e.roundness,this._update(),this}fromShape(e,t=!1){this.isText=t;let i=(s,a)=>{a instanceof Cr&&a.v3.equals(s.position)&&s.controls[0].position.copy(a.v2)},r=s=>{let a=[],n,o;for(n=0,o=s.length;n<o;n++)s[n]instanceof Ga&&(s[n]=NN(s[n]));for(n=0,o=s.length;n<o;n++){let c=s[n],d=n>0?s[n-1]:null,u;c instanceof Cr?(u=this.createPoint(c.v0),u.controls[1].position.copy(c.v1)):c instanceof Ir&&(u=this.createPoint(c.v1)),u!==void 0&&(d!==null&&i(u,d),a.push(u))}let l=s[s.length-1],h=!1;return l instanceof Cr?l.v3.equals(a[0].position)&&(a[0].controls[0].position.copy(l.v2),h=!0):l instanceof Ir&&l.v2.equals(a[0].position)&&(h=!0),this.isClosed=h,a};return this.points=r(e.curves),e instanceof gc&&(this.shapeHoles=e.holes.map(s=>{let a=new hi;return a.fromShape(s),a})),this.update(),this}updatePoint(e,t){let i=this.getPointByUuid(e);i&&(t.position!==void 0&&i.position.fromArray(t.position),t.roundness!==void 0&&(i.roundness=t.roundness),t.areControlsDirectionsMirrored!==void 0&&(i.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(e,t){var r;let i=(r=this.getPointByUuid(e))==null?void 0:r.controls[0];i&&(t.position&&i.position.fromArray(t.position),this.needsUpdate=!0)}updateNextControl(e,t){var r;let i=(r=this.getPointByUuid(e))==null?void 0:r.controls[1];i&&(t.position&&i.position.fromArray(t.position),this.needsUpdate=!0)}},pf=Math.PI*2;function Qu({x:e,y:t},i,r,s,a){return{x:e*i+s,y:t*r+a}}function iV(e,t){let i=t===1.5707963267948966?.551915024494:t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),r=Math.cos(e),s=Math.sin(e),a=Math.cos(e+t),n=Math.sin(e+t);return[{x:r-s*i,y:s+r*i},{x:a+n*i,y:n-a*i},{x:a,y:n}]}function yg(e,t,i,r){let s=e*r-t*i<0?-1:1,a=Math.min(1,Math.max(-1,e*i+t*r));return s*Math.acos(a)}function rV(e,t,i,r,s,a,n,o,l,h){let c=Math.pow(s,2),d=Math.pow(a,2),u=Math.pow(n,2),p=Math.pow(o,2),f=c*d-c*p-d*u;f<0&&(f=0),f/=c*p+d*u,f=Math.sqrt(f)*(l===h?-1:1);let g=f*s/a*o,m=f*-a/s*n,v=g+(e+i)/2,y=m+(t+r)/2,x=(n-g)/s,w=(o-m)/a,_=(-n-g)/s,b=(-o-m)/a,A=yg(1,0,x,w),S=yg(x,w,_,b);return!h&&S>0&&(S-=pf),h&&S<0&&(S+=pf),{centerx:v,centery:y,ang1:A,ang2:S}}function sV({px:e,py:t,cx:i,cy:r,rx:s,ry:a,largeArcFlag:n,sweepFlag:o}){let l=[];if(s===0||a===0)return[];let h=(e-i)/2,c=(t-r)/2;if(h===0&&c===0)return[];s=Math.abs(s),a=Math.abs(a);let d=Math.pow(h,2)/Math.pow(s,2)+Math.pow(c,2)/Math.pow(a,2);d>1&&(s*=Math.sqrt(d),a*=Math.sqrt(d));let u=rV(e,t,i,r,s,a,h,c,n,o),{ang1:p,ang2:f}=u,{centerx:g,centery:m}=u,v=Math.abs(f)/(pf/4);Math.abs(1-v)<1e-7&&(v=1);let y=Math.max(Math.ceil(v),1);f/=y;for(let x=0;x<y;x++)l.push(iV(p,f)),p+=f;return l.map(x=>{let{x:w,y:_}=Qu(x[0],s,a,g,m),{x:b,y:A}=Qu(x[1],s,a,g,m),{x:S,y:M}=Qu(x[2],s,a,g,m);return{x1:w,y1:_,x2:b,y2:A,x:S,y:M}})}var Vt;(function(e){e[e.ODD=0]="ODD",e[e.NONZERO=1]="NONZERO",e[e.POSITIVE=2]="POSITIVE",e[e.NEGATIVE=3]="NEGATIVE",e[e.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(Vt||(Vt={}));var Si;(function(e){e[e.POLYGONS=0]="POLYGONS",e[e.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",e[e.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(Si||(Si={}));function at(e,t){if(!e)throw t||"Assertion Failed!"}var Qe=function(){function e(){}return e.vertEq=function(t,i){return t.s===i.s&&t.t===i.t},e.vertLeq=function(t,i){return t.s<i.s||t.s===i.s&&t.t<=i.t},e.transLeq=function(t,i){return t.t<i.t||t.t===i.t&&t.s<=i.s},e.edgeGoesLeft=function(t){return e.vertLeq(t.Dst,t.Org)},e.edgeGoesRight=function(t){return e.vertLeq(t.Org,t.Dst)},e.vertL1dist=function(t,i){return Math.abs(t.s-i.s)+Math.abs(t.t-i.t)},e.edgeEval=function(t,i,r){at(e.vertLeq(t,i)&&e.vertLeq(i,r));var s=i.s-t.s,a=r.s-i.s;return s+a>0?s<a?i.t-t.t+(t.t-r.t)*(s/(s+a)):i.t-r.t+(r.t-t.t)*(a/(s+a)):0},e.edgeSign=function(t,i,r){at(e.vertLeq(t,i)&&e.vertLeq(i,r));var s=i.s-t.s,a=r.s-i.s;return s+a>0?(i.t-r.t)*s+(i.t-t.t)*a:0},e.transEval=function(t,i,r){at(e.transLeq(t,i)&&e.transLeq(i,r));var s=i.t-t.t,a=r.t-i.t;return s+a>0?s<a?i.s-t.s+(t.s-r.s)*(s/(s+a)):i.s-r.s+(r.s-t.s)*(a/(s+a)):0},e.transSign=function(t,i,r){at(e.transLeq(t,i)&&e.transLeq(i,r));var s=i.t-t.t,a=r.t-i.t;return s+a>0?(i.s-r.s)*s+(i.s-t.s)*a:0},e.vertCCW=function(t,i,r){return t.s*(i.t-r.t)+i.s*(r.t-t.t)+r.s*(t.t-i.t)>=0},e.interpolate=function(t,i,r,s){return t=t<0?0:t,r=r<0?0:r,t<=r?r===0?(i+s)/2:i+(s-i)*(t/(t+r)):s+(i-s)*(r/(t+r))},e.intersect=function(t,i,r,s,a){var n,o,l;e.vertLeq(t,i)||(l=t,t=i,i=l),e.vertLeq(r,s)||(l=r,r=s,s=l),e.vertLeq(t,r)||(l=t,t=r,r=l,l=i,i=s,s=l),e.vertLeq(r,i)?e.vertLeq(i,s)?(n=e.edgeEval(t,r,i),o=e.edgeEval(r,i,s),n+o<0&&(n=-n,o=-o),a.s=e.interpolate(n,r.s,o,i.s)):(n=e.edgeSign(t,r,i),o=-e.edgeSign(t,s,i),n+o<0&&(n=-n,o=-o),a.s=e.interpolate(n,r.s,o,s.s)):a.s=(r.s+i.s)/2,e.transLeq(t,i)||(l=t,t=i,i=l),e.transLeq(r,s)||(l=r,r=s,s=l),e.transLeq(t,r)||(l=t,t=r,r=l,l=i,i=s,s=l),e.transLeq(r,i)?e.transLeq(i,s)?(n=e.transEval(t,r,i),o=e.transEval(r,i,s),n+o<0&&(n=-n,o=-o),a.t=e.interpolate(n,r.t,o,i.t)):(n=e.transSign(t,r,i),o=-e.transSign(t,s,i),n+o<0&&(n=-n,o=-o),a.t=e.interpolate(n,r.t,o,s.t)):a.t=(r.t+i.t)/2},e}(),Jl=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return e}(),u0=function(){function e(t){this.side=t,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(e.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(t){this.Sym.Lface=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(t){this.Sym.Org=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(t){this.Sym.Lnext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(t){this.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(t){this.Lnext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(t){this.Sym.Onext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(t){this.Sym.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(t){this.Sym.Lnext.Sym=t},enumerable:!0,configurable:!0}),e}(),Do=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return e}(),xg=function(){function e(){var t=new Do,i=new Jl,r=new u0(0),s=new u0(1);t.next=t.prev=t,t.anEdge=null,i.next=i.prev=i,r.next=r,r.Sym=s,s.next=s,s.Sym=r,this.vHead=t,this.fHead=i,this.eHead=r,this.eHeadSym=s}return e.prototype.makeEdge_=function(t){var i=new u0(0),r=new u0(1);t.Sym.side<t.side&&(t=t.Sym);var s=t.Sym.next;return r.next=s,s.Sym.next=i,i.next=t,t.Sym.next=r,i.Sym=r,i.Onext=i,i.Lnext=r,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,r.Sym=i,r.Onext=r,r.Lnext=i,r.Org=null,r.Lface=null,r.winding=0,r.activeRegion=null,i},e.prototype.splice_=function(t,i){var r=t.Onext,s=i.Onext;r.Sym.Lnext=i,s.Sym.Lnext=t,t.Onext=s,i.Onext=r},e.prototype.makeVertex_=function(t,i,r){var s=t;at(s,"Vertex can't be null!");var a=r.prev;s.prev=a,a.next=s,s.next=r,r.prev=s,s.anEdge=i;var n=i;do n.Org=s,n=n.Onext;while(n!==i)},e.prototype.makeFace_=function(t,i,r){var s=t;at(s,"Face can't be null");var a=r.prev;s.prev=a,a.next=s,s.next=r,r.prev=s,s.anEdge=i,s.trail=null,s.marked=!1,s.inside=r.inside;var n=i;do n.Lface=s,n=n.Lnext;while(n!==i)},e.prototype.killEdge_=function(t){t.Sym.side<t.side&&(t=t.Sym);var i=t.next,r=t.Sym.next;i.Sym.next=r,r.Sym.next=i},e.prototype.killVertex_=function(t,i){var r=t.anEdge,s=r;do s.Org=i,s=s.Onext;while(s!==r);var a=t.prev,n=t.next;n.prev=a,a.next=n},e.prototype.killFace_=function(t,i){var r=t.anEdge,s=r;do s.Lface=i,s=s.Lnext;while(s!==r);var a=t.prev,n=t.next;n.prev=a,a.next=n},e.prototype.makeEdge=function(){var t=new Do,i=new Do,r=new Jl,s=this.makeEdge_(this.eHead);return this.makeVertex_(t,s,this.vHead),this.makeVertex_(i,s.Sym,this.vHead),this.makeFace_(r,s,this.fHead),s},e.prototype.splice=function(t,i){var r=!1,s=!1;if(t!==i){if(i.Org!==t.Org&&(s=!0,this.killVertex_(i.Org,t.Org)),i.Lface!==t.Lface&&(r=!0,this.killFace_(i.Lface,t.Lface)),this.splice_(i,t),!s){var a=new Do;this.makeVertex_(a,i,t.Org),t.Org.anEdge=t}if(!r){var n=new Jl;this.makeFace_(n,i,t.Lface),t.Lface.anEdge=t}}},e.prototype.delete=function(t){var i=t.Sym,r=!1;if(t.Lface!==t.Rface&&(r=!0,this.killFace_(t.Lface,t.Rface)),t.Onext===t)this.killVertex_(t.Org,null);else if(t.Rface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev),!r){var s=new Jl;this.makeFace_(s,t,t.Lface)}i.Onext===i?(this.killVertex_(i.Org,null),this.killFace_(i.Lface,null)):(t.Lface.anEdge=i.Oprev,i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),this.killEdge_(t)},e.prototype.addEdgeVertex=function(t){var i=this.makeEdge_(t),r=i.Sym;this.splice_(i,t.Lnext),i.Org=t.Dst;var s=new Do;return this.makeVertex_(s,r,i.Org),i.Lface=r.Lface=t.Lface,i},e.prototype.splitEdge=function(t){var i=this.addEdgeVertex(t),r=i.Sym;return this.splice_(t.Sym,t.Sym.Oprev),this.splice_(t.Sym,r),t.Dst=r.Org,r.Dst.anEdge=r.Sym,r.Rface=t.Rface,r.winding=t.winding,r.Sym.winding=t.Sym.winding,r.idx=t.idx,r.Sym.idx=t.Sym.idx,r},e.prototype.connect=function(t,i){var r=!1,s=this.makeEdge_(t),a=s.Sym;if(i.Lface!==t.Lface&&(r=!0,this.killFace_(i.Lface,t.Lface)),this.splice_(s,t.Lnext),this.splice_(a,i),s.Org=t.Dst,a.Org=i.Org,s.Lface=a.Lface=t.Lface,t.Lface.anEdge=a,!r){var n=new Jl;this.makeFace_(n,s,t.Lface)}return s},e.prototype.zapFace=function(t){var i=t.anEdge,r,s,a,n,o;s=i.Lnext;do r=s,s=r.Lnext,r.Lface=null,r.Rface===null&&(r.Onext===r?this.killVertex_(r.Org,null):(r.Org.anEdge=r.Onext,this.splice_(r,r.Oprev)),a=r.Sym,a.Onext===a?this.killVertex_(a.Org,null):(a.Org.anEdge=a.Onext,this.splice_(a,a.Oprev)),this.killEdge_(r));while(r!=i);n=t.prev,o=t.next,o.prev=n,n.next=o},e.prototype.countFaceVerts_=function(t){var i=t.anEdge,r=0;do r++,i=i.Lnext;while(i!==t.anEdge);return r},e.prototype.mergeConvexFaces=function(t){var i,r,s,a,n,o,l;for(i=this.fHead.next;i!==this.fHead;i=i.next)if(i.inside)for(r=i.anEdge,n=r.Org;s=r.Lnext,a=r.Sym,a&&a.Lface&&a.Lface.inside&&(o=this.countFaceVerts_(i),l=this.countFaceVerts_(a.Lface),o+l-2<=t&&Qe.vertCCW(r.Lprev.Org,r.Org,a.Lnext.Lnext.Org)&&Qe.vertCCW(a.Lprev.Org,a.Org,r.Lnext.Lnext.Org)&&(s=a.Lnext,this.delete(a),r=null,a=null)),!(r&&r.Lnext.Org===n);)r=s;return!0},e.prototype.check=function(){var t=this.fHead,i=this.vHead,r=this.eHead,s,a,n,o,l,h;for(a=t,a=t;(s=a.next)!==t;a=s){at(s.prev===a),l=s.anEdge;do at(l.Sym!==l),at(l.Sym.Sym===l),at(l.Lnext.Onext.Sym===l),at(l.Onext.Sym.Lnext===l),at(l.Lface===s),l=l.Lnext;while(l!==s.anEdge)}for(at(s.prev===a&&s.anEdge===null),o=i,o=i;(n=o.next)!==i;o=n){at(n.prev===o),l=n.anEdge;do at(l.Sym!==l),at(l.Sym.Sym===l),at(l.Lnext.Onext.Sym===l),at(l.Onext.Sym.Lnext===l),at(l.Org===n),l=l.Onext;while(l!==n.anEdge)}for(at(n.prev===o&&n.anEdge===null),h=r,h=r;(l=h.next)!==r;h=l)at(l.Sym.next===h.Sym),at(l.Sym!==l),at(l.Sym.Sym===l),at(l.Org!==null),at(l.Dst!==null),at(l.Lnext.Onext.Sym===l),at(l.Onext.Sym.Lnext===l);at(l.Sym.next===h.Sym&&l.Sym===this.eHeadSym&&l.Sym.Sym===l&&l.Org===null&&l.Dst===null&&l.Lface===null&&l.Rface===null)},e}(),bg=function(){function e(){this.handle=null}return e}(),wg=function(){function e(){this.key=null,this.node=0}return e}(),aV=function(){function e(t,i){this.leq=i,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=t,this.nodes=[],this.handles=[];for(var r=0;r<t+1;r++)this.nodes[r]=new bg,this.handles[r]=new wg;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return e.prototype.floatDown_=function(t){var i=this.nodes,r=this.handles,s,a,n;for(s=i[t].handle;;){if(n=t<<1,n<this.size&&this.leq(r[i[n+1].handle].key,r[i[n].handle].key)&&++n,at(n<=this.max),a=i[n].handle,n>this.size||this.leq(r[s].key,r[a].key)){i[t].handle=s,r[s].node=t;break}i[t].handle=a,r[a].node=t,t=n}},e.prototype.floatUp_=function(t){var i=this.nodes,r=this.handles,s,a,n;for(s=i[t].handle;;){if(n=t>>1,a=i[n].handle,n===0||this.leq(r[a].key,r[s].key)){i[t].handle=s,r[s].node=t;break}i[t].handle=a,r[a].node=t,t=n}},e.prototype.init=function(){for(var t=this.size;t>=1;--t)this.floatDown_(t);this.initialized=!0},e.prototype.min=function(){return this.handles[this.nodes[1].handle].key},e.prototype.insert=function(t){var i,r;if(i=++this.size,i*2>this.max){this.max*=2;var s,a;for(a=this.nodes.length,this.nodes.length=this.max+1,s=a;s<this.nodes.length;s++)this.nodes[s]=new bg;for(a=this.handles.length,this.handles.length=this.max+1,s=a;s<this.handles.length;s++)this.handles[s]=new wg}return this.freeList===0?r=i:(r=this.freeList,this.freeList=this.handles[r].node),this.nodes[i].handle=r,this.handles[r].node=i,this.handles[r].key=t,this.initialized&&this.floatUp_(i),r},e.prototype.extractMin=function(){var t=this.nodes,i=this.handles,r=t[1].handle,s=i[r].key;return this.size>0&&(t[1].handle=t[this.size].handle,i[t[1].handle].node=1,i[r].key=null,i[r].node=this.freeList,this.freeList=r,--this.size,this.size>0&&this.floatDown_(1)),s},e.prototype.delete=function(t){var i=this.nodes,r=this.handles,s;at(t>=1&&t<=this.max&&r[t].key!==null),s=r[t].node,i[s].handle=i[this.size].handle,r[i[s].handle].node=s,--this.size,s<=this.size&&(s<=1||this.leq(r[i[s>>1].handle].key,r[i[s].handle].key)?this.floatDown_(s):this.floatUp_(s)),r[t].key=null,r[t].node=this.freeList,this.freeList=t},e}(),Zu=function(){function e(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return e}(),Sg=function(){function e(){this.key=null,this.next=null,this.prev=null}return e}(),nV=function(){function e(t,i){this.frame=t,this.leq=i,this.head=new Sg,this.head.next=this.head,this.head.prev=this.head}return e.prototype.min=function(){return this.head.next},e.prototype.max=function(){return this.head.prev},e.prototype.insert=function(t){return this.insertBefore(this.head,t)},e.prototype.search=function(t){var i=this.head;do i=i.next;while(i.key!==null&&!this.leq(this.frame,t,i.key));return i},e.prototype.insertBefore=function(t,i){do t=t.prev;while(t.key!==null&&!this.leq(this.frame,t.key,i));var r=new Sg;return r.key=i,r.next=t.next,t.next.prev=r,r.prev=t,t.next=r,r},e.prototype.delete=function(t){t.next.prev=t.prev,t.prev.next=t.next},e}(),oV=function(){function e(){}return e.regionBelow=function(t){return t.nodeUp.prev.key},e.regionAbove=function(t){return t.nodeUp.next.key},e.debugEvent=function(t){},e.addWinding=function(t,i){t.winding+=i.winding,t.Sym.winding+=i.Sym.winding},e.edgeLeq=function(t,i,r){var s=t.event,a=i.eUp,n=r.eUp;if(a.Dst===s)return n.Dst===s?Qe.vertLeq(a.Org,n.Org)?Qe.edgeSign(n.Dst,a.Org,n.Org)<=0:Qe.edgeSign(a.Dst,n.Org,a.Org)>=0:Qe.edgeSign(n.Dst,s,n.Org)<=0;if(n.Dst===s)return Qe.edgeSign(a.Dst,s,a.Org)>=0;var o=Qe.edgeEval(a.Dst,s,a.Org),l=Qe.edgeEval(n.Dst,s,n.Org);return o>=l},e.deleteRegion=function(t,i){i.fixUpperEdge&&at(i.eUp.winding===0),i.eUp.activeRegion=null,t.dict.delete(i.nodeUp)},e.fixUpperEdge=function(t,i,r){at(i.fixUpperEdge),t.mesh.delete(i.eUp),i.fixUpperEdge=!1,i.eUp=r,r.activeRegion=i},e.topLeftRegion=function(t,i){var r=i.eUp.Org,s;do i=e.regionAbove(i);while(i.eUp.Org===r);if(i.fixUpperEdge){if(s=t.mesh.connect(e.regionBelow(i).eUp.Sym,i.eUp.Lnext),s===null)return null;e.fixUpperEdge(t,i,s),i=e.regionAbove(i)}return i},e.topRightRegion=function(t){var i=t.eUp.Dst;do t=e.regionAbove(t);while(t.eUp.Dst===i);return t},e.addRegionBelow=function(t,i,r){var s=new Zu;return s.eUp=r,s.nodeUp=t.dict.insertBefore(i.nodeUp,s),s.fixUpperEdge=!1,s.sentinel=!1,s.dirty=!1,r.activeRegion=s,s},e.isWindingInside=function(t,i){switch(t.windingRule){case Vt.ODD:return(i&1)!==0;case Vt.NONZERO:return i!==0;case Vt.POSITIVE:return i>0;case Vt.NEGATIVE:return i<0;case Vt.ABS_GEQ_TWO:return i>=2||i<=-2}throw new Error("Invalid winding rulle")},e.computeWinding=function(t,i){i.windingNumber=e.regionAbove(i).windingNumber+i.eUp.winding,i.inside=e.isWindingInside(t,i.windingNumber)},e.finishRegion=function(t,i){var r=i.eUp,s=r.Lface;s.inside=i.inside,s.anEdge=r,e.deleteRegion(t,i)},e.finishLeftRegions=function(t,i,r){for(var s,a=null,n=i,o=i.eUp;n!==r;){if(n.fixUpperEdge=!1,a=e.regionBelow(n),s=a.eUp,s.Org!=o.Org){if(!a.fixUpperEdge){e.finishRegion(t,n);break}s=t.mesh.connect(o.Lprev,s.Sym),e.fixUpperEdge(t,a,s)}o.Onext!==s&&(t.mesh.splice(s.Oprev,s),t.mesh.splice(o,s)),e.finishRegion(t,n),o=a.eUp,n=a}return o},e.addRightEdges=function(t,i,r,s,a,n){var o,l,h,c,d=!0;h=r;do at(Qe.vertLeq(h.Org,h.Dst)),e.addRegionBelow(t,i,h.Sym),h=h.Onext;while(h!==s);for(a===null&&(a=e.regionBelow(i).eUp.Rprev),l=i,c=a;o=e.regionBelow(l),h=o.eUp.Sym,h.Org===c.Org;)h.Onext!==c&&(t.mesh.splice(h.Oprev,h),t.mesh.splice(c.Oprev,h)),o.windingNumber=l.windingNumber-h.winding,o.inside=e.isWindingInside(t,o.windingNumber),l.dirty=!0,!d&&e.checkForRightSplice(t,l)&&(e.addWinding(h,c),e.deleteRegion(t,l),t.mesh.delete(c)),d=!1,l=o,c=h;l.dirty=!0,at(l.windingNumber-h.winding===o.windingNumber),n&&e.walkDirtyRegions(t,l)},e.spliceMergeVertices=function(t,i,r){t.mesh.splice(i,r)},e.vertexWeights=function(t,i,r){var s=Qe.vertL1dist(i,t),a=Qe.vertL1dist(r,t),n=.5*a/(s+a),o=.5*s/(s+a);t.coords[0]+=n*i.coords[0]+o*r.coords[0],t.coords[1]+=n*i.coords[1]+o*r.coords[1],t.coords[2]+=n*i.coords[2]+o*r.coords[2]},e.getIntersectData=function(t,i,r,s,a,n){i.coords[0]=i.coords[1]=i.coords[2]=0,i.idx=-1,e.vertexWeights(i,r,s),e.vertexWeights(i,a,n)},e.checkForRightSplice=function(t,i){var r=e.regionBelow(i),s=i.eUp,a=r.eUp;if(Qe.vertLeq(s.Org,a.Org)){if(Qe.edgeSign(a.Dst,s.Org,a.Org)>0)return!1;Qe.vertEq(s.Org,a.Org)?s.Org!==a.Org&&(t.pq.delete(s.Org.pqHandle),e.spliceMergeVertices(t,a.Oprev,s)):(t.mesh.splitEdge(a.Sym),t.mesh.splice(s,a.Oprev),i.dirty=r.dirty=!0)}else{if(Qe.edgeSign(s.Dst,a.Org,s.Org)<0)return!1;e.regionAbove(i).dirty=i.dirty=!0,t.mesh.splitEdge(s.Sym),t.mesh.splice(a.Oprev,s)}return!0},e.checkForLeftSplice=function(t,i){var r=e.regionBelow(i),s=i.eUp,a=r.eUp,n;if(at(!Qe.vertEq(s.Dst,a.Dst)),Qe.vertLeq(s.Dst,a.Dst)){if(Qe.edgeSign(s.Dst,a.Dst,s.Org)<0)return!1;e.regionAbove(i).dirty=i.dirty=!0,n=t.mesh.splitEdge(s),t.mesh.splice(a.Sym,n),n.Lface.inside=i.inside}else{if(Qe.edgeSign(a.Dst,s.Dst,a.Org)>0)return!1;i.dirty=r.dirty=!0,n=t.mesh.splitEdge(a),t.mesh.splice(s.Lnext,a.Sym),n.Rface.inside=i.inside}return!0},e.checkForIntersect=function(t,i){var r=e.regionBelow(i),s=i.eUp,a=r.eUp,n=s.Org,o=a.Org,l=s.Dst,h=a.Dst,c,d,u=new Do,p,f;if(at(!Qe.vertEq(h,l)),at(Qe.edgeSign(l,t.event,n)<=0),at(Qe.edgeSign(h,t.event,o)>=0),at(n!==t.event&&o!==t.event),at(!i.fixUpperEdge&&!r.fixUpperEdge),n===o||(c=Math.min(n.t,l.t),d=Math.max(o.t,h.t),c>d))return!1;if(Qe.vertLeq(n,o)){if(Qe.edgeSign(h,n,o)>0)return!1}else if(Qe.edgeSign(l,o,n)<0)return!1;return e.debugEvent(t),Qe.intersect(l,n,h,o,u),at(Math.min(n.t,l.t)<=u.t),at(u.t<=Math.max(o.t,h.t)),at(Math.min(h.s,l.s)<=u.s),at(u.s<=Math.max(o.s,n.s)),Qe.vertLeq(u,t.event)&&(u.s=t.event.s,u.t=t.event.t),p=Qe.vertLeq(n,o)?n:o,Qe.vertLeq(p,u)&&(u.s=p.s,u.t=p.t),Qe.vertEq(u,n)||Qe.vertEq(u,o)?(e.checkForRightSplice(t,i),!1):!Qe.vertEq(l,t.event)&&Qe.edgeSign(l,t.event,u)>=0||!Qe.vertEq(h,t.event)&&Qe.edgeSign(h,t.event,u)<=0?h===t.event?(t.mesh.splitEdge(s.Sym),t.mesh.splice(a.Sym,s),i=e.topLeftRegion(t,i),s=e.regionBelow(i).eUp,e.finishLeftRegions(t,e.regionBelow(i),r),e.addRightEdges(t,i,s.Oprev,s,s,!0),!0):l===t.event?(t.mesh.splitEdge(a.Sym),t.mesh.splice(s.Lnext,a.Oprev),r=i,i=e.topRightRegion(i),f=e.regionBelow(i).eUp.Rprev,r.eUp=a.Oprev,a=e.finishLeftRegions(t,r,null),e.addRightEdges(t,i,a.Onext,s.Rprev,f,!0),!0):(Qe.edgeSign(l,t.event,u)>=0&&(e.regionAbove(i).dirty=i.dirty=!0,t.mesh.splitEdge(s.Sym),s.Org.s=t.event.s,s.Org.t=t.event.t),Qe.edgeSign(h,t.event,u)<=0&&(i.dirty=r.dirty=!0,t.mesh.splitEdge(a.Sym),a.Org.s=t.event.s,a.Org.t=t.event.t),!1):(t.mesh.splitEdge(s.Sym),t.mesh.splitEdge(a.Sym),t.mesh.splice(a.Oprev,s),s.Org.s=u.s,s.Org.t=u.t,s.Org.pqHandle=t.pq.insert(s.Org),e.getIntersectData(t,s.Org,n,l,o,h),e.regionAbove(i).dirty=i.dirty=r.dirty=!0,!1)},e.walkDirtyRegions=function(t,i){for(var r=e.regionBelow(i),s,a;;){for(;r.dirty;)i=r,r=e.regionBelow(r);if(!i.dirty&&(r=i,i=e.regionAbove(i),i===null||!i.dirty))return;if(i.dirty=!1,s=i.eUp,a=r.eUp,s.Dst!==a.Dst&&e.checkForLeftSplice(t,i)&&(r.fixUpperEdge?(e.deleteRegion(t,r),t.mesh.delete(a),r=e.regionBelow(i),a=r.eUp):i.fixUpperEdge&&(e.deleteRegion(t,i),t.mesh.delete(s),i=e.regionAbove(r),s=i.eUp)),s.Org!==a.Org)if(s.Dst!==a.Dst&&!i.fixUpperEdge&&!r.fixUpperEdge&&(s.Dst===t.event||a.Dst===t.event)){if(e.checkForIntersect(t,i))return}else e.checkForRightSplice(t,i);s.Org===a.Org&&s.Dst===a.Dst&&(e.addWinding(a,s),e.deleteRegion(t,i),t.mesh.delete(s),i=e.regionAbove(r))}},e.connectRightVertex=function(t,i,r){var s,a=r.Onext,n=e.regionBelow(i),o=i.eUp,l=n.eUp,h=!1;if(o.Dst!==l.Dst&&e.checkForIntersect(t,i),Qe.vertEq(o.Org,t.event)&&(t.mesh.splice(a.Oprev,o),i=e.topLeftRegion(t,i),a=e.regionBelow(i).eUp,e.finishLeftRegions(t,e.regionBelow(i),n),h=!0),Qe.vertEq(l.Org,t.event)&&(t.mesh.splice(r,l.Oprev),r=e.finishLeftRegions(t,n,null),h=!0),h){e.addRightEdges(t,i,r.Onext,a,a,!0);return}Qe.vertLeq(l.Org,o.Org)?s=l.Oprev:s=o,s=t.mesh.connect(r.Lprev,s),e.addRightEdges(t,i,s,s.Onext,s.Onext,!1),s.Sym.activeRegion.fixUpperEdge=!0,e.walkDirtyRegions(t,i)},e.connectLeftDegenerate=function(t,i,r){var s,a,n,o,l;if(s=i.eUp,Qe.vertEq(s.Org,r)){at(!1),e.spliceMergeVertices(t,s,r.anEdge);return}if(!Qe.vertEq(s.Dst,r)){t.mesh.splitEdge(s.Sym),i.fixUpperEdge&&(t.mesh.delete(s.Onext),i.fixUpperEdge=!1),t.mesh.splice(r.anEdge,s),e.sweepEvent(t,r);return}at(!1),i=e.topRightRegion(i),l=e.regionBelow(i),n=l.eUp.Sym,a=o=n.Onext,l.fixUpperEdge&&(at(a!==n),e.deleteRegion(t,l),t.mesh.delete(n),n=a.Oprev),t.mesh.splice(r.anEdge,n),Qe.edgeGoesLeft(a)||(a=null),e.addRightEdges(t,i,n.Onext,o,a,!0)},e.connectLeftVertex=function(t,i){var r,s,a,n,o,l,h=new Zu;if(h.eUp=i.anEdge.Sym,r=t.dict.search(h).key,s=e.regionBelow(r),!!s){if(n=r.eUp,o=s.eUp,Qe.edgeSign(n.Dst,i,n.Org)===0){e.connectLeftDegenerate(t,r,i);return}if(a=Qe.vertLeq(o.Dst,n.Dst)?r:s,r.inside||a.fixUpperEdge){if(a===r)l=t.mesh.connect(i.anEdge.Sym,n.Lnext);else{var c=t.mesh.connect(o.Dnext,i.anEdge);l=c.Sym}a.fixUpperEdge?e.fixUpperEdge(t,a,l):e.computeWinding(t,e.addRegionBelow(t,r,l)),e.sweepEvent(t,i)}else e.addRightEdges(t,r,i.anEdge,i.anEdge,null,!0)}},e.sweepEvent=function(t,i){t.event=i,e.debugEvent(t);for(var r=i.anEdge;r.activeRegion===null;)if(r=r.Onext,r===i.anEdge){e.connectLeftVertex(t,i);return}var s=e.topLeftRegion(t,r.activeRegion);at(s!==null);var a=e.regionBelow(s),n=a.eUp,o=e.finishLeftRegions(t,a,null);o.Onext===n?e.connectRightVertex(t,s,o):e.addRightEdges(t,s,o.Onext,n,n,!0)},e.addSentinel=function(t,i,r,s){var a=new Zu,n=t.mesh.makeEdge();n.Org.s=r,n.Org.t=s,n.Dst.s=i,n.Dst.t=s,t.event=n.Dst,a.eUp=n,a.windingNumber=0,a.inside=!1,a.fixUpperEdge=!1,a.sentinel=!0,a.dirty=!1,a.nodeUp=t.dict.insert(a)},e.initEdgeDict=function(t){t.dict=new nV(t,e.edgeLeq);var i=t.bmax[0]-t.bmin[0],r=t.bmax[1]-t.bmin[1],s=t.bmin[0]-i,a=t.bmax[0]+i,n=t.bmin[1]-r,o=t.bmax[1]+r;e.addSentinel(t,s,a,n),e.addSentinel(t,s,a,o)},e.doneEdgeDict=function(t){for(var i,r=0;(i=t.dict.min().key)!==null;)i.sentinel||(at(i.fixUpperEdge),at(++r===1)),at(i.windingNumber===0),e.deleteRegion(t,i)},e.removeDegenerateEdges=function(t){var i,r,s,a=t.mesh.eHead;for(i=a.next;i!==a;i=r)r=i.next,s=i.Lnext,Qe.vertEq(i.Org,i.Dst)&&i.Lnext.Lnext!==i&&(e.spliceMergeVertices(t,s,i),t.mesh.delete(i),i=s,s=i.Lnext),s.Lnext===i&&(s!==i&&((s===r||s===r.Sym)&&(r=r.next),t.mesh.delete(s)),(i===r||i===r.Sym)&&(r=r.next),t.mesh.delete(i))},e.initPriorityQ=function(t){var i,r,s,a=0;for(s=t.mesh.vHead,r=s.next;r!==s;r=r.next)a++;for(a+=8,i=t.pq=new aV(a,Qe.vertLeq),s=t.mesh.vHead,r=s.next;r!==s;r=r.next)r.pqHandle=i.insert(r);return r!==s?!1:(i.init(),!0)},e.donePriorityQ=function(t){t.pq=null},e.removeDegenerateFaces=function(t,i){var r,s,a;for(r=i.fHead.next;r!==i.fHead;r=s)s=r.next,a=r.anEdge,at(a.Lnext!==a),a.Lnext.Lnext===a&&(e.addWinding(a.Onext,a),t.mesh.delete(a));return!0},e.computeInterior=function(t,i){i===void 0&&(i=!0);var r,s;if(e.removeDegenerateEdges(t),!e.initPriorityQ(t))return!1;for(e.initEdgeDict(t);(r=t.pq.extractMin())!==null;){for(;s=t.pq.min(),!(s===null||!Qe.vertEq(s,r));)s=t.pq.extractMin(),e.spliceMergeVertices(t,r.anEdge,s.anEdge);e.sweepEvent(t,r)}return t.event=t.dict.min().key.eUp.Org,e.debugEvent(t),e.doneEdgeDict(t),e.donePriorityQ(t),e.removeDegenerateFaces(t,t.mesh)?(i&&t.mesh.check(),!0):!1},e}(),lV=function(){function e(){this.mesh=new xg,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=Vt.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return e.prototype.dot_=function(t,i){return t[0]*i[0]+t[1]*i[1]+t[2]*i[2]},e.prototype.normalize_=function(t){var i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(!i)throw"Zero-size vector!";i=Math.sqrt(i),t[0]/=i,t[1]/=i,t[2]/=i},e.prototype.longAxis_=function(t){var i=0;return Math.abs(t[1])>Math.abs(t[0])&&(i=1),Math.abs(t[2])>Math.abs(t[i])&&(i=2),i},e.prototype.computeNormal_=function(t){var i,r,s,a,n,o,l=[0,0,0],h=[0,0,0],c=[0,0,0],d=[0,0,0],u=[0,0,0],p=[null,null,null],f=[null,null,null],g=this.mesh.vHead;i=g.next;for(var m=0;m<3;++m)a=i.coords[m],h[m]=a,f[m]=i,l[m]=a,p[m]=i;for(i=g.next;i!==g;i=i.next)for(var v=0;v<3;++v)a=i.coords[v],a<h[v]&&(h[v]=a,f[v]=i),a>l[v]&&(l[v]=a,p[v]=i);var y=0;if(l[1]-h[1]>l[0]-h[0]&&(y=1),l[2]-h[2]>l[y]-h[y]&&(y=2),h[y]>=l[y]){t[0]=0,t[1]=0,t[2]=1;return}for(o=0,r=f[y],s=p[y],c[0]=r.coords[0]-s.coords[0],c[1]=r.coords[1]-s.coords[1],c[2]=r.coords[2]-s.coords[2],i=g.next;i!==g;i=i.next)d[0]=i.coords[0]-s.coords[0],d[1]=i.coords[1]-s.coords[1],d[2]=i.coords[2]-s.coords[2],u[0]=c[1]*d[2]-c[2]*d[1],u[1]=c[2]*d[0]-c[0]*d[2],u[2]=c[0]*d[1]-c[1]*d[0],n=u[0]*u[0]+u[1]*u[1]+u[2]*u[2],n>o&&(o=n,t[0]=u[0],t[1]=u[1],t[2]=u[2]);o<=0&&(t[0]=t[1]=t[2]=0,t[this.longAxis_(c)]=1)},e.prototype.checkOrientation_=function(){for(var t=this.mesh.fHead,i,r=this.mesh.vHead,s,a=0,n=t.next;n!==t;n=n.next)if(s=n.anEdge,!(s.winding<=0))do a+=(s.Org.s-s.Dst.s)*(s.Org.t+s.Dst.t),s=s.Lnext;while(s!==n.anEdge);if(a<0){for(i=r.next;i!==r;i=i.next)i.t=-i.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},e.prototype.projectPolygon_=function(){var t=this.mesh.vHead,i=[0,0,0],r,s,a=!1;i[0]=this.normal[0],i[1]=this.normal[1],i[2]=this.normal[2],!i[0]&&!i[1]&&!i[2]&&(this.computeNormal_(i),a=!0),r=this.sUnit,s=this.tUnit;var n=this.longAxis_(i);r[n]=0,r[(n+1)%3]=1,r[(n+2)%3]=0,s[n]=0,s[(n+1)%3]=0,s[(n+2)%3]=i[n]>0?1:-1;for(var o=t.next;o!==t;o=o.next)o.s=this.dot_(o.coords,r),o.t=this.dot_(o.coords,s);a&&this.checkOrientation_();for(var l=!0,h=t.next;h!==t;h=h.next)l?(this.bmin[0]=this.bmax[0]=h.s,this.bmin[1]=this.bmax[1]=h.t,l=!1):(h.s<this.bmin[0]&&(this.bmin[0]=h.s),h.s>this.bmax[0]&&(this.bmax[0]=h.s),h.t<this.bmin[1]&&(this.bmin[1]=h.t),h.t>this.bmax[1]&&(this.bmax[1]=h.t))},e.prototype.addWinding_=function(t,i){t.winding+=i.winding,t.Sym.winding+=i.Sym.winding},e.prototype.tessellateMonoRegion_=function(t,i){var r,s;if(r=i.anEdge,!(r.Lnext!==r&&r.Lnext.Lnext!==r))throw"Mono region invalid";for(;Qe.vertLeq(r.Dst,r.Org);r=r.Lprev);for(;Qe.vertLeq(r.Org,r.Dst);r=r.Lnext);s=r.Lprev;for(var a=void 0;r.Lnext!==s;)if(Qe.vertLeq(r.Dst,s.Org)){for(;s.Lnext!==r&&(Qe.edgeGoesLeft(s.Lnext)||Qe.edgeSign(s.Org,s.Dst,s.Lnext.Dst)<=0);)a=t.connect(s.Lnext,s),s=a.Sym;s=s.Lprev}else{for(;s.Lnext!==r&&(Qe.edgeGoesRight(r.Lprev)||Qe.edgeSign(r.Dst,r.Org,r.Lprev.Org)>=0);)a=t.connect(r,r.Lprev),r=a.Sym;r=r.Lnext}if(s.Lnext===r)throw"Mono region invalid";for(;s.Lnext.Lnext!==r;)a=t.connect(s.Lnext,s),s=a.Sym;return!0},e.prototype.tessellateInterior_=function(t){for(var i,r=t.fHead.next;r!==t.fHead;r=i)if(i=r.next,r.inside&&!this.tessellateMonoRegion_(t,r))return!1;return!0},e.prototype.discardExterior_=function(t){for(var i,r=t.fHead.next;r!==t.fHead;r=i)i=r.next,r.inside||t.zapFace(r)},e.prototype.setWindingNumber_=function(t,i,r){for(var s,a=t.eHead.next;a!==t.eHead;a=s)s=a.next,a.Rface.inside!==a.Lface.inside?a.winding=a.Lface.inside?i:-i:r?t.delete(a):a.winding=0},e.prototype.getNeighbourFace_=function(t){return!t.Rface||!t.Rface.inside?-1:t.Rface.n},e.prototype.outputPolymesh_=function(t,i,r,s){var a,n=0,o=0,l;r>3&&t.mergeConvexFaces(r);for(var h=t.vHead.next;h!==t.vHead;h=h.next)h.n=-1;for(var c=t.fHead.next;c!==t.fHead;c=c.next)if(c.n=-1,!!c.inside){a=c.anEdge,l=0;do{var h=a.Org;h.n===-1&&(h.n=o,o++),l++,a=a.Lnext}while(a!==c.anEdge);if(l>r)throw"Face vertex greater that support polygon";c.n=n,++n}this.elementCount=n,i===Si.CONNECTED_POLYGONS&&(n*=2),this.elements=[],this.elements.length=n*r,this.vertexCount=o,this.vertices=[],this.vertices.length=o*s,this.vertexIndices=[],this.vertexIndices.length=o;for(var h=t.vHead.next;h!==t.vHead;h=h.next)if(h.n!==-1){var d=h.n*s;this.vertices[d+0]=h.coords[0],this.vertices[d+1]=h.coords[1],s>2&&(this.vertices[d+2]=h.coords[2]),this.vertexIndices[h.n]=h.idx}for(var u=0,c=t.fHead.next;c!==t.fHead;c=c.next)if(c.inside){a=c.anEdge,l=0;do{var h=a.Org;this.elements[u++]=h.n,l++,a=a.Lnext}while(a!==c.anEdge);for(var p=l;p<r;++p)this.elements[u++]=-1;if(i===Si.CONNECTED_POLYGONS){a=c.anEdge;do this.elements[u++]=this.getNeighbourFace_(a),a=a.Lnext;while(a!==c.anEdge);for(var f=l;f<r;++f)this.elements[u++]=-1}}},e.prototype.outputContours_=function(t,i){var r,s,a=0,n=0;this.vertexCount=0,this.elementCount=0;for(var o=t.fHead.next;o!==t.fHead;o=o.next)if(o.inside){s=r=o.anEdge;do this.vertexCount++,r=r.Lnext;while(r!==s);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*i,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var l=0,h=0,c=0;a=0;for(var o=t.fHead.next;o!==t.fHead;o=o.next)if(o.inside){n=0,s=r=o.anEdge;do this.vertices[l++]=r.Org.coords[0],this.vertices[l++]=r.Org.coords[1],i>2&&(this.vertices[l++]=r.Org.coords[2]),this.vertexIndices[h++]=this.vertexIdCallback?this.vertexIdCallback(r):r.Org.idx,n++,r=r.Lnext;while(r!==s);this.elements[c++]=a,this.elements[c++]=n,a+=n}},e.prototype.addContour=function(t,i){this.mesh===null&&(this.mesh=new xg),t<2&&(t=2),t>3&&(t=3);for(var r=null,s=0;s<i.length;s+=t)r===null?(r=this.mesh.makeEdge(),this.mesh.splice(r,r.Sym)):(this.mesh.splitEdge(r),r=r.Lnext),r.Org.coords[0]=i[s+0],r.Org.coords[1]=i[s+1],t>2?r.Org.coords[2]=i[s+2]:r.Org.coords[2]=0,r.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(r),r.winding=1,r.Sym.winding=-1},e.prototype.tesselate=function(t,i,r,s,a,n){if(t===void 0&&(t=Vt.ODD),i===void 0&&(i=Si.POLYGONS),n===void 0&&(n=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,a&&(this.normal[0]=a[0],this.normal[1]=a[1],this.normal[2]=a[2]),this.windingRule=t,s<2&&(s=2),s>3&&(s=3),!this.mesh)return!1;this.projectPolygon_(),oV.computeInterior(this,n);var o=this.mesh;return i===Si.BOUNDARY_CONTOURS?this.setWindingNumber_(o,1,!0):this.tessellateInterior_(o),n&&o.check(),i===Si.BOUNDARY_CONTOURS?this.outputContours_(o,s):this.outputPolymesh_(o,i,r,s),!0},e}();function Ba(e){var t=e.windingRule,i=t===void 0?Vt.ODD:t,r=e.elementType,s=r===void 0?Si.POLYGONS:r,a=e.polySize,n=a===void 0?3:a,o=e.vertexSize,l=o===void 0?2:o,h=e.normal,c=h===void 0?[0,0,1]:h,d=e.contours,u=d===void 0?[]:d,p=e.strict,f=p===void 0?!0:p,g=e.debug,m=g===void 0?!1:g;if(!u&&f)throw new Error("Contours can't be empty");if(u){var v=new lV;e.edgeCreateCallback&&(v.edgeCreateCallback=e.edgeCreateCallback),e.vertexIdCallback&&(v.vertexIdCallback=e.vertexIdCallback);for(var y=0;y<u.length;y++)v.addContour(l||2,u[y]);return v.tesselate(i,s,n,l,c,f),{vertices:v.vertices,vertexIndices:v.vertexIndices,vertexCount:v.vertexCount,elements:v.elements,elementCount:v.elementCount,mesh:m?v.mesh:void 0}}}Vt.ODD;Vt.NONZERO;Vt.POSITIVE;Vt.NEGATIVE;Vt.ABS_GEQ_TWO;Si.POLYGONS;Si.CONNECTED_POLYGONS;Si.BOUNDARY_CONTOURS;var ff=class{constructor(e=256,t=!1){this.capacity=e,this.size=0,this.debug=t,this.debug&&`${e}`;let i=e*ff.eSize;this.buffer=new ArrayBuffer(i);let r=Float32Array.BYTES_PER_ELEMENT,s=0;this.positions=new Float32Array(this.buffer,s*r,3*e),s+=3*e,this.normals=new Float32Array(this.buffer,s*r,3*e),s+=3*e,this.uvs=new Float32Array(this.buffer,s*r,2*e)}realloc(e,t=!1){if(e<this.size)throw Error("cannot shrink buffer");if(e<=this.capacity&&!t)return;this.debug&&`${this.capacity}${e}`;let i=e*ff.eSize,r=new ArrayBuffer(i),s=Float32Array.BYTES_PER_ELEMENT,a=0,n=new Float32Array(r,a*s,3*e);a+=3*e;let o=new Float32Array(r,a*s,3*e);a+=3*e;let l=new Float32Array(r,a*s,2*e);t?(n.set(this.positions.subarray(0,this.size*3)),o.set(this.normals.subarray(0,this.size*3)),l.set(this.uvs.subarray(0,this.size*2))):(n.set(this.positions),o.set(this.normals),l.set(this.uvs)),this.buffer=r,this.positions=n,this.normals=o,this.uvs=l,this.capacity=e}get(e=1){let t=this.size+e;if(t>this.capacity){let r=this.capacity;for(;t>r;)r*=2;this.realloc(r)}let i=this.size;return this.size=t,i}reserve(e){let t=this.size+e;t>this.capacity&&this.realloc(t)}shrink(){this.debug&&`${this.capacity}${this.size}`,this.realloc(this.size,!0)}},Mx=ff;Mx.eSize=8*Float32Array.BYTES_PER_ELEMENT;var hV=aa(fS()),Y4={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},Ex={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},Cx={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},Ku=(e,t)=>([i,r])=>(r<i&&(r+=t),(e>=i?e:e+t)<=r),X4=class extends Ge{constructor(e,t,i=0,r=12,s=3,a=Vt.ODD,n=!1){super(),this.forPathBevel=n,this.type="ShapeGeometry",this.vertexCache={},this._shape=e,this._depth=t,this._curveSegments=r,this._bevelSegmentsInput=s;let o=this._shape.extractShapePointsToFlatArray([],r),l=this._shape.shapeHoles.map(M=>{let C=M.extractShapePointsToFlatArray([],r),T=[];for(let P=C.length-1;P>=1;P-=2){let I=C[P-1],D=C[P-0];T.push(I,D)}return T}),h=[],c=[];for(let M=0;M<o.length;M+=2)c.push([o[M],o[M+1]]);h.push(c);for(let M=0;M<l.length;M++){let C=l[M],T=[];for(let P=0;P<C.length;P+=2)T.push([C[P],C[P+1]]);h.push(T)}let d;e.isText?d=new Gv().setFromPoints(e.points.map(M=>M.position)).getSize(new j).length()*.1:h[0].length===0?d=i:d=(0,hV.default)(h).distance,i<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(i,d,t/2),this._bevelSegments=Math.floor(s));let u;try{u=Ba({windingRule:a,elementType:Si.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[o]})}catch{u=Y4}let p;try{p=Ba({windingRule:Vt.ODD,elementType:Si.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...l]})}catch{p=Ex}if(!u)throw new Error("error generating geometry");let f=u.elementCount;if(p){u.elementCount+=p.elementCount;for(let M=0;M<p.elements.length;M++){let C=p.elements[M],T=M%2===0?u.vertexCount:0;u.elements.push(C+T)}for(let M=0;M<p.vertexIndices.length;M++){let C=p.vertexIndices[M],T=u.vertexCount;u.vertexIndices.push(C+T)}for(let M=0;M<p.vertices.length;M++){let C=p.vertices[M];u.vertices.push(C)}}let g=1/0,m=-1/0,v=1/0,y=-1/0;for(let M=0,C=u.vertexCount;M<C;M++){let T=M*2,P=u.vertices[T+0],I=u.vertices[T+1];P<g&&(g=P),P>m&&(m=P),I<v&&(v=I),I>y&&(y=I)}this._minX=g,this._minY=v,this._width=m-g,this._height=y-v,this._buffer=new Mx(this._computeBufferEstimatedSize(u));let x=[],w=[];for(let M=u.elementCount-1;M>=0;M--){let C=M>=f,T=M*2,P=u.elements[T+0],I=u.elements[T+1],D=P+I,k={start:P,count:I,normals:[],continuous:[],concave:[]},H=P,U=D-1,F=P+1,Z=this._shape.roundedCurves.length;do{let Y=H-P,$=u.vertices[U*2+0],Q=u.vertices[U*2+1],le=u.vertices[H*2+0],re=u.vertices[H*2+1],te=u.vertices[F*2+0],ne=u.vertices[F*2+1],ce=le-$,pe=re-Q,xe=Math.sqrt(ce*ce+pe*pe);ce/=xe,pe/=xe;let Re=le-te,Ae=re-ne,Ne=Math.sqrt(Re*Re+Ae*Ae);Re/=Ne,Ae/=Ne,k.normals[Y*2+0]=-Ae,k.normals[Y*2+1]=Re,k.concave[Y]=ce*Ae-pe*Re>0;let Fe=u.vertexIndices[H];if(Array.isArray(Fe))k.continuous[Y]=!1;else{let[Ee,Me]=this._shape.getCurveIndexFromVertexId(Fe-1,!0);if(Me>0&&Me<1)k.continuous[Y]=!0;else{let Ye=Me===1?Ee+1:Ee-1;Ye=(Ye+Z)%Z;let He=Me===1?0:1,V=this._shape.roundedCurves[Ee].getTangent(Me),B=this._shape.roundedCurves[Ye].getTangent(He);k.continuous[Y]=V.dot(B)>.95}}C&&(k.normals[Y*2+0]*=-1,k.normals[Y*2+1]*=-1),[U,H,F]=[H,F,F+1],F>=D&&(F-=I)}while(F!==P+1);let W=[];W.push({bevelI:0,angle:0,size:0,boundary:{vertices:u.vertices.slice(P*2,D*2),vertexCount:I,vertexIndices:new Array(I).fill(!0).map((Y,$)=>[$,$]),elements:[0,I],elementCount:1,mesh:null},reverseMap:[],insetPoints:u.vertices.slice(P*2,D*2)});let G=0;for(let Y=1;Y<=this._bevelSegments;Y++){let $=Y/this._bevelSegments*Math.PI/2,Q=(1-Math.cos($))*this._bevel,le=[],re=[],te=0;for(let ce=0;ce<I;ce++){let pe=ce*2,xe=(ce-1+I)%I*2,Re=u.vertices[k.start*2+pe+0],Ae=u.vertices[k.start*2+pe+1],Ne=-k.normals[xe+0]*Q,Fe=-k.normals[xe+1]*Q,Ee=-k.normals[pe+0]*Q,Me=-k.normals[pe+1]*Q;if(k.concave[ce]||!k.concave[ce]&&C){let Ye=Math.atan2(Fe,Ne),He=Math.atan2(Me,Ee);He>Ye&&(He-=Math.PI*2);let V=He-Ye;if(k.continuous[ce]||C){let B=Ye+V/2,ae=Math.cos(B)*Q,Se=Math.sin(B)*Q;le[2*te+0]=Re+ae*(C?-1:1),le[2*te+1]=Ae+Se*(C?-1:1),re[te]=ce,te++}else{let B=Math.max(1,Math.floor(r/4*Math.abs(V)/Math.PI));for(let ae=0;ae<=B;ae++){let Se=Ye+V*(ae/B),R=Math.cos(Se)*Q,Ce=Math.sin(Se)*Q;le[2*te+0]=Re+R,le[2*te+1]=Ae+Ce,re[te]=ce,te++}}}else le[2*te+0]=Re+Ne,le[2*te+1]=Ae+Fe,re[te]=ce,te++,le[2*te+0]=Re,le[2*te+1]=Ae,re[te]=ce,te++,le[2*te+0]=Re+Ee,le[2*te+1]=Ae+Me,re[te]=ce,te++}let ne=Ba({windingRule:Vt.POSITIVE,elementType:Si.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[le],edgeCreateCallback:ce=>{let pe=ce.Org.idx,xe=re[pe],Re=re[(pe+1)%re.length];ce.idx=[xe,Re],ce.Sym.idx=[Re,xe]},vertexIdCallback:ce=>{let pe=ce.Lprev.idx;return[pe?pe[1]:0,ce.idx?ce.idx[0]:0]}});if(!ne)throw new Error(`error generating bevel geometry for ${Y}'th loop`);if(!ne.vertexCount){let ce=(Y-1)/this._bevelSegments*Math.PI/2;G=(1-Math.sin(ce))*this._bevel;break}for(let ce=0;ce<ne.vertexIndices.length;ce++){let[pe,xe]=ne.vertexIndices[ce];if(pe===xe)continue;let Re=xe;xe<pe&&(Re+=I);for(let Ae=pe;Ae<Re;Ae++){let Ne=Ae%I,Fe=(Ae+1)%I;if(!k.continuous[Ne]||!k.continuous[Fe]){ne.vertexIndices[ce]=[pe,Ne],ne.vertexIndices.splice(ce+1,0,[Fe,xe]),ne.vertices.splice((ce+1)*2,0,ne.vertices[ce*2],ne.vertices[ce*2+1]);break}}}W.push({bevelI:Y,angle:$,size:Q,boundary:ne,reverseMap:re,insetPoints:le})}let X=(Y,$,Q)=>{let le=0,re=Y.boundary.vertexIndices.length;for(;le<re&&Q(Y.boundary.vertexIndices[$]);)$=($+1)%re,le++;return le},ee=x.length;for(let Y=1;Y<W.length;Y++){let $=W[Y-1],Q=W[Y],le=$.boundary.vertexIndices.length,re=Q.boundary.vertexIndices.length;if(!le||!re)break;let te=k.concave.length,ne=0,ce=Ku(ne,I);for(;!$.boundary.vertexIndices.filter(ce).length||!Q.boundary.vertexIndices.filter(ce).length;)ne++,ce=Ku(ne,I);let pe=$.boundary.vertexIndices.findIndex(ce),xe=Q.boundary.vertexIndices.findIndex(ce);do pe=(pe+1)%le;while(ce($.boundary.vertexIndices[pe]));do xe=(xe+1)%re;while(ce(Q.boundary.vertexIndices[xe]));ne=(ne+1)%I;let Re=ne,Ae=0,Ne=this._buildBevelVert(k,$,(pe-1+le)%le,void 0,Ae),Fe=this._buildBevelVert(k,Q,(xe-1+re)%re,void 0,Ae),Ee=Ne,Me=Fe,Ye,He,V=!1;do{Ae=(ne||te)/te,ce=Ku(ne,I);let B=X($,pe,ce),ae=X(Q,xe,ce),Se=V;if(V=!1,B&&!ae){for(let R=0;R<B;R++)Ye=this._buildBevelVert(k,$,(pe+R)%le,R/(B-1),Ae),x.push(Ee.topN,Ye.topP,Me.topN),n===!1&&x.push(Ye.bottomP,Ee.bottomN,Me.bottomN),Ee=Ye;V=!0}else if(!B&&ae)for(let R=0;R<ae;R++)He=this._buildBevelVert(k,Q,(xe+R)%re,R/(ae-1),Ae),x.push(Me.topN,Ee.topP,He.topP),n===!1&&x.push(Ee.bottomP,Me.bottomN,He.bottomP),Me=He;else if(B&&ae)if(Ye=this._buildBevelVert(k,$,pe,0,Ae),He=this._buildBevelVert(k,Q,xe,0,Ae),Se?(x.push(Ee.topN,He.topP,Me.topN),x.push(Ee.topN,Ye.topP,He.topP),n===!1&&(x.push(He.bottomP,Ee.bottomN,Me.bottomN),x.push(He.bottomP,Ye.bottomP,Ee.bottomN))):(x.push(Me.topN,Ee.topN,Ye.topP),x.push(Me.topN,Ye.topP,He.topP),n===!1&&(x.push(Ye.bottomP,Ee.bottomN,Me.bottomN),x.push(Ye.bottomP,Me.bottomN,He.bottomP))),Ee=Ye,Me=He,B===ae)for(let R=1;R<B;R++)Ye=this._buildBevelVert(k,$,(pe+R)%le,R/(B-1),Ae),He=this._buildBevelVert(k,Q,(xe+R)%re,R/(ae-1),Ae),x.push(Ee.topN,Ye.topP,Me.topN),x.push(Me.topN,Ye.topP,He.topP),n===!1&&(x.push(Ye.bottomP,Ee.bottomN,Me.bottomN),x.push(Ye.bottomP,Me.bottomN,He.bottomP)),Ee=Ye,Me=He;else if(B>ae){let R=B/ae,Ce=0;for(let Ue=1;Ue<B;Ue++)Ye=this._buildBevelVert(k,$,(pe+Ue)%le,Ue/(B-1),Ae),x.push(Ee.topN,Ye.topP,Me.topN),n===!1&&x.push(Ye.bottomP,Ee.bottomN,Me.bottomN),Ee=Ye,Ue>(Ce+1)*R&&(Ce++,He=this._buildBevelVert(k,Q,(xe+Ce)%re,Ce/(ae-1),Ae),x.push(Me.topN,Ye.topP,He.topP),n===!1&&x.push(Ye.bottomP,Me.bottomN,He.bottomP),Me=He)}else{let R=ae/B,Ce=0;for(let Ue=1;Ue<ae;Ue++)He=this._buildBevelVert(k,Q,(xe+Ue)%re,Ue/(ae-1),Ae),x.push(Me.topN,Ye.topP,He.topP),n===!1&&x.push(Ye.bottomP,Me.bottomN,He.bottomP),Me=He,Ue>(Ce+1)*R&&(Ce++,Ye=this._buildBevelVert(k,$,(pe+Ce)%le,Ce/(B-1),Ae),x.push(Ee.topN,Ye.topP,Me.topN),n===!1&&x.push(Ye.bottomP,Ee.bottomN,Me.bottomN),Ee=Ye)}pe=(pe+B)%le,xe=(xe+ae)%re,ne=(ne+1)%te}while(ne!==Re)}if(n===!1&&this._depth>this._bevel*2&&this._buildWall(W,k,x),C){let Y=[];for(let $=x.length-1;$>=ee+2;$-=3){let Q=x[$-2],le=x[$-1],re=x[$-0];Y.push(re,le,Q)}x.splice(ee,x.length-ee,...Y)}if(C){let Y=[];for(let $=W[W.length-1].boundary.vertices.length-1;$>=1;$-=2){let Q=W[W.length-1].boundary.vertices[$-1],le=W[W.length-1].boundary.vertices[$-0];Y.push(Q,le)}w.push(Y)}if(!C){let Y=W[W.length-1],$;try{$=Ba({windingRule:W.length>1?Vt.POSITIVE:Vt.ODD,elementType:Si.POLYGONS,vertexSize:2,strict:!0,contours:[Y.insetPoints,...w]})}catch{$=Cx}if(!$)throw new Error("Error generating geometry for surface");l.length===0&&this._bevel<d&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let Q=0;Q<$.elementCount*3;Q+=3){let le=this._buildSurfaceVert($,$.elements[Q+0],G),re=this._buildSurfaceVert($,$.elements[Q+1],G),te=this._buildSurfaceVert($,$.elements[Q+2],G);x.push(le.top,re.top,te.top),n===!1&&x.push(te.bottom,re.bottom,le.bottom)}}this.vertexCache={}}this._buffer.shrink();let _=new ot(Uint32Array.from(x),1),b=new ot(this._buffer.positions,3),A=new ot(this._buffer.normals,3),S=new ot(this._buffer.uvs,2);b.needsUpdate=!0,A.needsUpdate=!0,S.needsUpdate=!0,_.needsUpdate=!0,this.setAttribute("position",b),this.setAttribute("normal",A),this.setAttribute("uv",S),this.setIndex(_)}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,i){let r=e[0];for(let s=0,a=r.boundary.vertexCount;s<a;s++){let n=this._buildBevelVert(t,r,s),o=this._buildBevelVert(t,r,(s+1)%a);i.push(o.topP,n.topN,n.bottomN),i.push(o.topP,n.bottomN,o.bottomP)}}_buildSurfaceVert(e,t,i){let r=t.toString();if(r in this.vertexCache)return this.vertexCache[r];let s=e.vertices[t*2+0],a=e.vertices[t*2+1],n=(s-this._minX)/this._width,o=(a-this._minY)/this._height;this.forPathBevel&&(o=1);let l=this._buffer.get(this.forPathBevel?1:2),h=l*3,c=l*2,d={top:l+0,bottom:l+1};return this._buffer.positions[h+0]=s,this._buffer.positions[h+1]=a,this._buffer.positions[h+2]=this.forPathBevel?this._bevel:this._depth-i,this._buffer.normals[h+0]=0,this._buffer.normals[h+1]=0,this._buffer.normals[h+2]=1,this._buffer.uvs[c+0]=n,this._buffer.uvs[c+1]=o,this.forPathBevel===!1&&(this._buffer.positions[h+3]=s,this._buffer.positions[h+4]=a,this._buffer.positions[h+5]=i,this._buffer.normals[h+3]=0,this._buffer.normals[h+4]=0,this._buffer.normals[h+5]=-1,this._buffer.uvs[c+2]=n,this._buffer.uvs[c+3]=o),this.vertexCache[r]=d,d}_buildBevelVert(e,t,i,r=1,s){let a=`${t.bevelI}:${i}`;if(a in this.vertexCache&&s!==0&&s!==1&&(!s||s===this.vertexCache[a].pathBevelUCoord))return this.vertexCache[a];let[n,o]=t.boundary.vertexIndices[i],l,h,c,d;n!==o?(h=n,l=o,d=!1,c=e.continuous[h]&&e.continuous[l]):(l=n,h=(l-1+e.count)%e.count,d=e.concave[l]&&t.bevelI>0,c=e.continuous[l]||d);let u=Math.cos(t.angle),p=Math.sin(t.angle),f=i*2,g=l*2,m=h*2,v=t.boundary.vertices[f+0],y=t.boundary.vertices[f+1],x=(1-p)*this._bevel,w=(v-this._minX)/this._width,_=(y-this._minY)/this._height;this.forPathBevel&&(s!==void 0&&(w=s),_=1);let b=e.normals[g+0],A=e.normals[g+1],S=e.normals[m+0],M=e.normals[m+1];if(d){let D=S-b,k=M-A;b=b+D*(1-r),A=A+k*(1-r);let H=Math.sqrt(b*b+A*A);b/=H,A/=H}let C=this.forPathBevel?this._buffer.get(c?1:2):this._buffer.get(c?2:4),T=C*3,P=C*2,I={i,fi:l,topP:C+0,topN:C+0,bottomP:C+1,bottomN:C+1,pathBevelUCoord:s};return this._buffer.positions[T+0]=v,this._buffer.positions[T+1]=y,this._buffer.positions[T+2]=(this.forPathBevel?this._bevel:this._depth)-x,this._buffer.normals[T+0]=b*u,this._buffer.normals[T+1]=A*u,this._buffer.normals[T+2]=p,this._buffer.uvs[P+0]=w,this._buffer.uvs[P+1]=_,this.forPathBevel===!1&&(this._buffer.positions[T+3]=v,this._buffer.positions[T+4]=y,this._buffer.positions[T+5]=x,this._buffer.normals[T+3]=b*u,this._buffer.normals[T+4]=A*u,this._buffer.normals[T+5]=-p,this._buffer.uvs[P+2]=_,this._buffer.uvs[P+3]=w),c||(this.forPathBevel?(C+=1,T+=3,P+=2):(C+=2,T+=6,P+=4),I.topP=C+0,I.bottomP=C+1,this._buffer.positions[T+0]=v,this._buffer.positions[T+1]=y,this._buffer.positions[T+2]=(this.forPathBevel?this._bevel:this._depth)-x,this._buffer.normals[T+0]=S*u,this._buffer.normals[T+1]=M*u,this._buffer.normals[T+2]=p,this._buffer.uvs[P+0]=w,this._buffer.uvs[P+1]=_,this.forPathBevel===!1&&(this._buffer.positions[T+3]=v,this._buffer.positions[T+4]=y,this._buffer.positions[T+5]=x,this._buffer.normals[T+3]=S*u,this._buffer.normals[T+4]=M*u,this._buffer.normals[T+5]=-p,this._buffer.uvs[P+2]=_,this._buffer.uvs[P+3]=w)),this.vertexCache[a]=I,I}clone(){let e=new X4(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=_d(this.userData),e}},Tx=class extends Ge{constructor(e,t=12,i={}){super(),this.type="ShapeGeometry",this.windingRule=Vt.ODD,this.elementType=Si.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=e,this._curveSegments=t,this._triangulationOptions=Object.assign({windingRule:Vt.ODD,elementType:Si.POLYGONS,polySize:3,vertexSize:2,strict:!0},i);let r=this._shape.extractShapePointsToFlatArray([],this._curveSegments),s=this._shape.shapeHoles.map(u=>u.extractShapePointsToFlatArray([],this._curveSegments)),a,n=!0,o=!0,l,h;for(let u=0,p=r.length/2;u<p;u++){let f=u*2,g=r[f+0],m=r[f+1];if(l!==void 0&&g!==l&&(n=!1),h!==void 0&&m!==h&&(o=!1),l=g,h=m,!n&&!o)break}if(!n&&!o)try{a=Ba({contours:[r,...s],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{a=Y4}let c=(a==null?void 0:a.vertexCount)??1,d=(a==null?void 0:a.elementCount)??1;if(this._positionAttribute=new ot(new Float32Array(c*3),3),this._normalAttribute=new ot(new Float32Array(c*3),3),this._uvAttribute=new ot(new Float32Array(c*2),2),this._indexAttribute=new ot(new Uint32Array(d*3),1),a){let u=1/0,p=-1/0,f=1/0,g=-1/0;for(let y=0,x=c;y<x;y++){let w=y*2,_=a.vertices[w+0],b=a.vertices[w+1];_<u&&(u=_),_>p&&(p=_),b<f&&(f=b),b>g&&(g=b)}let m=p-u,v=g-f;for(let y=0,x=c;y<x;y++){let w=y*2,_=a.vertices[w+0],b=a.vertices[w+1],A=(_-u)/m,S=(b-f)/v;this._positionAttribute.setXYZ(y,_,b,0),this._normalAttribute.setXYZ(y,0,0,1),this._uvAttribute.setXY(y,A,S)}for(let y=0,x=d;y<x;y++){let w=y*3,_=a.elements[w+0],b=a.elements[w+1],A=a.elements[w+2];this._indexAttribute.setX(w+0,_),this._indexAttribute.setX(w+1,b),this._indexAttribute.setX(w+2,A)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((a==null?void 0:a.elementCount)??1)*3)}clone(){let e=new Tx(this._shape,this._curveSegments);return e.userData=_d(this.userData),e}},Px=class extends X4{constructor(e,t,i=0,r=12,s=3,a=Vt.ODD){super(e,t,i,r,s,a),this.type="ShapeGeometry"}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,i){let r=e[0];for(let s=0,a=r.boundary.vertexCount;s<a;s++){let n=this._buildBevelVert(t,r,s),o=this._buildBevelVert(t,r,(s+1)%a);i.push(o.topP,n.topN,n.bottomN),i.push(o.topP,n.bottomN,o.bottomP)}}clone(){let e=new Px(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=_d(this.userData),e}},Wn=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var h,c;let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:Vt.ODD},e.parameters),r=Math.abs(i.width),s=Math.abs(i.height??i.width),a=Math.abs(i.depth??0),n=e.shape??(t==null?void 0:t.shape),o=(n==null?void 0:n.roundness)??i.roundness;n!==void 0&&(n instanceof hi?(n.width!==r||n.height!==s)&&n.applySize(r,s):n=new hi(r,s).fromJSON(n),((h=e.parameters)==null?void 0:h.roundness)!==void 0&&((c=e.parameters)==null?void 0:c.roundness)>0&&n.update());let l=n??new hi(r,s);return{parameters:Object.assign(i,{width:r,height:s,depth:a,roundness:o}),shape:l}}static build(e){let{depth:t,extrudeBevelSize:i,extrudeBevelSegments:r,subdivisions:s,roundness:a,windingRule:n}=e.parameters;e.shape.roundness=a;let o;return t<=0?o=new Tx(e.shape,s,{windingRule:n}):o=new Px(e.shape,t,i,s,r,n),Object.assign(o,{userData:{...e,type:"VectorGeometry"}})}},Dx=Math.PI*2,Q4=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return i.angle=Oe.clamp(i.angle,0,360),{shape:e.shape&&e.shape instanceof hi?e.shape:new hi,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(e){let{width:t,height:i,spikes:r,angle:s,innerRadius:a,depth:n,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,h=e.shape,c=t*.5,d=i*.5,u=cV(h,c,d,s*Math.PI/180,r,a);h.isClosed=!0,h.update();let p;return s===0?(p=new Ge,p.setAttribute("position",new De([],3))):p=Wn.create({shape:h,parameters:{subdivisions:u,depth:n,extrudeBevelSize:o,extrudeBevelSegments:l}}),Object.assign(p,{userData:{...e,type:"EllipseGeometry"}})}};function cV(e,t,i,r,s,a){if(r>=Dx)return s>30||s%4===0?(uV(e,t,i,a),Math.round(s/4)):_g(e,r,s,t,i,a);r=Math.max(r,.001);let n={x:0,y:i},o=r+Math.PI*.5,l={x:Math.cos(o)*t,y:Math.sin(o)*i},h=sV({px:n.x,py:n.y,cx:l.x,cy:l.y,rx:t,ry:i,largeArcFlag:r>Math.PI,sweepFlag:!0});return s>30||s%h.length===0?dV(e,n.x,n.y,h,s,t,i,a):_g(e,r,s,t,i,a)}function dV(e,t,i,r,s,a,n,o){let l=Math.round(s/r.length);e.addPoint(Yo(t,i));for(let h=0,c=r.length;h<c;h++){let d=r[h],u=e.points[h],p=Yo(d.x,d.y);u.controls[1].position.set(d.x1,d.y1),p.controls[0].position.set(d.x2,d.y2),e.addPoint(p)}return o>0?Ix(e,a,n,o):e.addPoint(Yo(0,0)),l}function _g(e,t,i,r,s,a){let n=-t/i;for(let o=0;o<=i;o++){let l=n*o,h=Math.sin(l)*r,c=Math.cos(l)*s;e.addPoint(Yo(h,c))}return t<Dx?a>0?Ix(e,r,s,a):e.addPoint(Yo(0,0)):(e.removePoint(e.points[e.points.length-1]),a>0&&Ox(e,r,s,a)),1}function uV(e,t,i,r=0,s=0,a=0){let n=.5522847498,o=t*n,l=i*n;e.addPoint(p0(s-t,a,s-t,a-l,s-t,a+l)),e.addPoint(p0(s,a+i,s-o,a+i,s+o,a+i)),e.addPoint(p0(s+t,a,s+t,a+l,s+t,a-l)),e.addPoint(p0(s,a-i,s+o,a-i,s-o,a-i)),r>0&&Ox(e,t,i,r)}function Yo(e,t){return new qo(Oe.generateUUID(),new j(e,t))}function p0(e,t,i,r,s,a){let n=Yo(e,t);return n.controls[0].position.set(i,r),n.controls[1].position.set(s,a),n}function Ix(e,t,i,r){Rx(e,t,i,r).forEach(s=>e.addPoint(s))}function Ox(e,t,i,r){let s=Rx(e,t,i,r),a=new hi;s.forEach(n=>a.addPoint(n)),a.isClosed=!0,e.shapeHoles.push(a)}function Rx(e,t,i,r){let s=r*t/100,a=s*(Math.abs(i)/Math.abs(t)),n=new j(s/t,a/i),o=e.points.map(l=>{let h=l.clone();return h.uuid=Oe.generateUUID(),h}).reverse();return o.forEach(l=>{l.position.multiply(n);let h=l.controls[0].position.clone().multiply(n),c=l.controls[1].position.clone().multiply(n);l.controls[0].position.copy(c),l.controls[1].position.copy(h)}),o}var pV=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},e.parameters),r=Math.abs(i.width),s=Math.abs(i.height??r),a=Math.abs(i.depth??r),n=Math.abs(Math.min(r,a))/2;return{parameters:Object.assign(i,{width:r,height:s,depth:a,radius:n,segments:Math.round(i.segments),pathSegments:Math.round(i.pathSegments),cornerSegments:Math.round(i.cornerSegments)})}}static build(e){let{width:t,height:i,depth:r,radius:s,revolutions:a,segments:n,pathRadius:o,pathType:l,pathSegments:h,cornerRadius:c,cornerSegments:d}=e.parameters,u=new Lx(!1,t,i,r,s,a,n,o,l,h,c,d);return Object.assign(u,{userData:{...e,type:"HelixGeometry"}})}},Ju=new Vo([0,0,0],1),Lx=class extends Ge{constructor(e=!0,t=1,i=1,r=1,s=1,a=1,n=1,o=1,l=1,h=1,c=1,d=1){if(super(),a===0)return;let u=e&&a===1;u&&(d=0),c>100&&(c=100),c===0&&(d=0);let p=()=>new E,f=new E,g=p(),m=p(),v=p(),y,x,w,_,b,A,S,M,C=p(),T=p(),P=p(),I=p(),D=p(),k=p(),H=p(),U=p(),F=i-2*o+.001,Z=F/a,W=Math.ceil(n*a),G=W+1,X=F/W,ee=-F/2,Y=h+1,$=2*Math.PI/h,Q=Math.PI/2/d,le=.01,re=Math.min((1-c/100)*o,o-le),te=o-re,ne=0,ce=2,pe=d*ce+ce,xe=Y*pe/ce,Re=xe+Y*G,Ae=Math.max(0,Y*(G+pe)),[Ne,Fe,Ee]=[3,3,2].map(de=>Array(Ae*de).fill(0)),Me=[],Ye=s-o;function He(de,Ve){let Le=Math.PI/2;A=Ve*X,M=2*Math.PI*(A%Z)/Z+Le,A+=ee,S=Math.sin(M)*Ye,b=Math.cos(M)*Ye,e?de.set(b,S,A):de.set(b,A,S)}He(f,-1e-10),He(g,0),C.copy(f),He(f,1);let V=f.distanceTo(g),B=u?0:te+re,ae=V*W+2*B,Se=re,R=ae-B;for(let de=0;de<=W;de++){He(m,de),U.subVectors(m,C).normalize(),C.copy(m),k.copy(m).setComponent(+e+1,0).normalize(),H.crossVectors(U,k).normalize();let Ve=de===0,Le=de===W,We=Ve?3*Math.PI/2:Q,$e=Ve?Se:R,Xe=Ve?Y:Re,Ze=Ve?0:Ae-Y,Ht=U.clone().multiplyScalar(Ve?-te:te).add(m),ti=U.clone().multiplyScalar(Ve?-1:1).normalize();for(let K=0;K<Y;K++){let fe=K*$;if(T.addVectors(f.copy(k).multiplyScalar(o*Math.cos(fe)),g.copy(H).multiplyScalar(o*Math.sin(fe))),P.copy(T).normalize(),Ve||Le){u||(ne=Ze+K,[0,1,2].forEach(be=>{Ne[ne*3+be]=Ht.getComponent(be),Fe[ne*3+be]=ti.getComponent(be)}),Ee[ne*2]=+Le,Ee[ne*2+1]=K/h),g.copy(P).multiplyScalar(re),v.addVectors(m,g);for(let be=0;be<d;be++){let Be=be*Q+We;I.addVectors(f.copy(U).multiplyScalar(te*Math.sin(Be)),g.copy(P).multiplyScalar(te*Math.cos(Be))),D.copy(I).normalize(),g.addVectors(v,I),I.normalize(),ne=Xe+be*Y+K,[0,1,2].forEach(At=>{Ne[ne*3+At]=g.getComponent(At),Fe[ne*3+At]=D.getComponent(At)});let rt=+Ve+Math.sin(Be);Ee[ne*2]=($e+te*rt)/ae,Ee[ne*2+1]=K/h}}g.addVectors(m,T),ne=xe+de*Y+K,[0,1,2].forEach(be=>{Ne[ne*3+be]=g.getComponent(be),Fe[ne*3+be]=P.getComponent(be)}),Ee[ne*2]=(B+de*V)/ae,Ee[ne*2+1]=K/h}}let Ce=G+2*d+ce,[Ue,Ie]=[+u,Ce-1];for(let de=Ue;de<=Ie-1;de++){let Ve=u&&de===Ie-1;for(let Le=0;Le<Y-1;Le++)y=de*Y+Le,x=y+1,w=(Ve?Le:y)+Y,_=(Ve?Le+1:x)+Y,de===0?Me.push(x,_,w):de===Ce-2?Me.push(y,x,w):Me.push(y,x,w,x,_,w)}this.setIndex(Me),this.setAttribute("position",new De(Ne,3)),this.setAttribute("normal",new De(Fe,3)),this.setAttribute("uv",new De(Ee,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let e=this.userData.parameters,t=Math.ceil(e.tubularSegments),i=e.radialSegments+1,r=Array.from(this.getIndex().array),s,a,n,o,l=6*(t-1)*e.radialSegments,h=t,c=h===t;for(let d=0;d<e.radialSegments;d++)s=h*i+d,a=s+1,n=(c?d:s)+i,o=(c?d+1:a)+i,r[l++]=s,r[l++]=a,r[l++]=n,r[l++]=a,r[l++]=o,r[l++]=n;return r.length=l,Ju.array=r,Ju.count=r.length,Ju}},fV=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,height:i,depth:r,detail:s,corner:a,cornerSides:n}=e.parameters,o=s===0&&a!==0?new Bx(t*.5,a,n):new Ov(t*.5,s);return o.scale(1,i/t,r/t),Object.assign(o,{userData:{...e,type:"IcosahedronGeometry"}})}},Bx=class extends H4{constructor(e=1,t=.2,i=4){let r=(1+Math.sqrt(5))/2,s=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],a=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],n="IcosahedronGeometry";super(s,a,n,e,t,i),this.type=n}static fromJSON(e){return new Bx(e.radius,e.corner,e.cornerSides)}},mV=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var r;(((r=e.parameters)==null?void 0:r.points)??[]).forEach(s=>{Array.isArray(s)&&(s.x=s[0],s.y=s[1])});let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{points:t,segments:i,verticalSegments:r}=e.parameters,s=new gc;s.moveTo(t[0].x,t[0].y),s.bezierCurveTo(t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y);let a=new Ev(s.extractPoints(r).shape,i);return a.rotateZ(Math.PI),Object.assign(a,{userData:{...e,type:"LatheGeometry"}})}},Hr=new we,$u=new kt,f0=new E,$c=class extends l1{constructor(){super(),this.uuid=Oe.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(e){let t=new Ai().getNormalMatrix(e);for(let i=0,r=this.vertices.length;i<r;i++)this.vertices[i].applyMatrix4(e);for(let i=0,r=this.faces.length;i<r;i++){let s=this.faces[i];s.normal.applyMatrix3(t).normalize();for(let a=0,n=s.vertexNormals.length;a<n;a++)s.vertexNormals[a].applyMatrix3(t).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(e){return Hr.makeRotationX(e),this.applyMatrix4(Hr),this}rotateY(e){return Hr.makeRotationY(e),this.applyMatrix4(Hr),this}rotateZ(e){return Hr.makeRotationZ(e),this.applyMatrix4(Hr),this}translate(e,t,i){return Hr.makeTranslation(e,t,i),this.applyMatrix4(Hr),this}scale(e,t,i){return Hr.makeScale(e,t,i),this.applyMatrix4(Hr),this}lookAt(e){return $u.lookAt(e),$u.updateMatrix(),this.applyMatrix4($u.matrix),this}fromBufferGeometry(e){let t=this,i=e.index!==null?e.index:void 0,r=e.attributes;if(r.position===void 0)return this;let s=r.position,a=r.normal,n=r.color,o=r.uv,l=r.uv2;l!==void 0&&(this.faceVertexUvs[1]=[]);for(let d=0;d<s.count;d++)t.vertices.push(new E().fromBufferAttribute(s,d)),n!==void 0&&t.colors.push(new Je().fromBufferAttribute(n,d));function h(d,u,p,f){let g=n===void 0?[]:[t.colors[d].clone(),t.colors[u].clone(),t.colors[p].clone()],m=a===void 0?[]:[new E().fromBufferAttribute(a,d),new E().fromBufferAttribute(a,u),new E().fromBufferAttribute(a,p)],v=new mf(d,u,p,m,g,f);t.faces.push(v),o!==void 0&&t.faceVertexUvs[0].push([new j().fromBufferAttribute(o,d),new j().fromBufferAttribute(o,u),new j().fromBufferAttribute(o,p)]),l!==void 0&&t.faceVertexUvs[1].push([new j().fromBufferAttribute(l,d),new j().fromBufferAttribute(l,u),new j().fromBufferAttribute(l,p)])}let c=e.groups;if(c.length>0)for(let d=0;d<c.length;d++){let u=c[d],p=u.start,f=u.count;for(let g=p,m=p+f;g<m;g+=3)i!==void 0?h(i.getX(g),i.getX(g+1),i.getX(g+2),u.materialIndex):h(g,g+1,g+2,u.materialIndex)}else if(i!==void 0)for(let d=0;d<i.count;d+=3)h(i.getX(d),i.getX(d+1),i.getX(d+2));else for(let d=0;d<s.count;d+=3)h(d,d+1,d+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(f0).negate(),this.translate(f0.x,f0.y,f0.z),this}normalize(){this.computeBoundingSphere();let e=this.boundingSphere.center,t=this.boundingSphere.radius,i=t===0?1:1/t,r=new we;return r.set(i,0,0,-i*e.x,0,i,0,-i*e.y,0,0,i,-i*e.z,0,0,0,1),this.applyMatrix4(r),this}computeFaceNormals(){let e=new E,t=new E;for(let i=0,r=this.faces.length;i<r;i++){let s=this.faces[i],a=this.vertices[s.a],n=this.vertices[s.b],o=this.vertices[s.c];e.subVectors(o,n),t.subVectors(a,n),e.cross(t),e.normalize(),s.normal.copy(e)}}computeVertexNormals(e=!0){let t=new Array(this.vertices.length);for(let i=0,r=this.vertices.length;i<r;i++)t[i]=new E;if(e){let i=new E,r=new E;for(let s=0,a=this.faces.length;s<a;s++){let n=this.faces[s],o=this.vertices[n.a],l=this.vertices[n.b],h=this.vertices[n.c];i.subVectors(h,l),r.subVectors(o,l),i.cross(r),t[n.a].add(i),t[n.b].add(i),t[n.c].add(i)}}else{this.computeFaceNormals();for(let i=0,r=this.faces.length;i<r;i++){let s=this.faces[i];t[s.a].add(s.normal),t[s.b].add(s.normal),t[s.c].add(s.normal)}}for(let i=0,r=this.vertices.length;i<r;i++)t[i].normalize();for(let i=0,r=this.faces.length;i<r;i++){let s=this.faces[i],a=s.vertexNormals;a.length===3?(a[0].copy(t[s.a]),a[1].copy(t[s.b]),a[2].copy(t[s.c])):(a[0]=t[s.a].clone(),a[1]=t[s.b].clone(),a[2]=t[s.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){let i=this.faces[e],r=i.vertexNormals;r.length===3?(r[0].copy(i.normal),r[1].copy(i.normal),r[2].copy(i.normal)):(r[0]=i.normal.clone(),r[1]=i.normal.clone(),r[2]=i.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let t=0,i=this.faces.length;t<i;t++){let r=this.faces[t];r.__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]);for(let s=0,a=r.vertexNormals.length;s<a;s++)r.__originalVertexNormals[s]?r.__originalVertexNormals[s].copy(r.vertexNormals[s]):r.__originalVertexNormals[s]=r.vertexNormals[s].clone()}let e=new $c;e.faces=this.faces;for(let t=0,i=this.morphTargets.length;t<i;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];let s=this.morphNormals[t].faceNormals,a=this.morphNormals[t].vertexNormals;for(let n=0,o=this.faces.length;n<o;n++){let l=new E,h={a:new E,b:new E,c:new E};s.push(l),a.push(h)}}let r=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let s=0,a=this.faces.length;s<a;s++){let n=this.faces[s],o=r.faceNormals[s],l=r.vertexNormals[s];o.copy(n.normal),l.a.copy(n.vertexNormals[0]),l.b.copy(n.vertexNormals[1]),l.c.copy(n.vertexNormals[2])}}for(let t=0,i=this.faces.length;t<i;t++){let r=this.faces[t];r.normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new vi),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new V1),this.boundingSphere.setFromPoints(this.vertices)}merge(e,t,i=0){if(!(e&&e.isGeometry))return;let r,s=this.vertices.length,a=this.vertices,n=e.vertices,o=this.faces,l=e.faces,h=this.colors,c=e.colors;t!==void 0&&(r=new Ai().getNormalMatrix(t));for(let d=0,u=n.length;d<u;d++){let p=n[d].clone();t!==void 0&&p.applyMatrix4(t),a.push(p)}for(let d=0,u=c.length;d<u;d++)h.push(c[d].clone());for(let d=0,u=l.length;d<u;d++){let p=l[d],f,g,m=p.vertexNormals,v=p.vertexColors,y=new mf(p.a+s,p.b+s,p.c+s);y.normal.copy(p.normal),r!==void 0&&y.normal.applyMatrix3(r).normalize();for(let x=0,w=m.length;x<w;x++)f=m[x].clone(),r!==void 0&&f.applyMatrix3(r).normalize(),y.vertexNormals.push(f);y.color.copy(p.color);for(let x=0,w=v.length;x<w;x++)g=v[x],y.vertexColors.push(g.clone());y.materialIndex=p.materialIndex+i,o.push(y)}for(let d=0,u=e.faceVertexUvs.length;d<u;d++){let p=e.faceVertexUvs[d];this.faceVertexUvs[d]===void 0&&(this.faceVertexUvs[d]=[]);for(let f=0,g=p.length;f<g;f++){let m=p[f],v=[];for(let y=0,x=m.length;y<x;y++)v.push(m[y].clone());this.faceVertexUvs[d].push(v)}}}mergeMesh(e){e&&e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix))}mergeVertices(e=4){let t={},i=[],r=[],s=Math.pow(10,e);for(let o=0,l=this.vertices.length;o<l;o++){let h=this.vertices[o],c=Math.round(h.x*s)+"_"+Math.round(h.y*s)+"_"+Math.round(h.z*s);t[c]===void 0?(t[c]=o,i.push(this.vertices[o]),r[o]=i.length-1):r[o]=r[t[c]]}let a=[];for(let o=0,l=this.faces.length;o<l;o++){let h=this.faces[o];h.a=r[h.a],h.b=r[h.b],h.c=r[h.c];let c=[h.a,h.b,h.c];for(let d=0;d<3;d++)if(c[d]===c[(d+1)%3]){a.push(o);break}}for(let o=a.length-1;o>=0;o--){let l=a[o];this.faces.splice(l,1);for(let h=0,c=this.faceVertexUvs.length;h<c;h++)this.faceVertexUvs[h].splice(l,1)}let n=this.vertices.length-i.length;return this.vertices=i,n}setFromPoints(e){this.vertices=[];for(let t=0,i=e.length;t<i;t++){let r=e[t];this.vertices.push(new E(r.x,r.y,r.z||0))}return this}sortFacesByMaterialIndex(){let e=this.faces,t=e.length;for(let o=0;o<t;o++)e[o]._id=o;function i(o,l){return o.materialIndex-l.materialIndex}e.sort(i);let r=this.faceVertexUvs[0],s=this.faceVertexUvs[1],a,n;r&&r.length===t&&(a=[]),s&&s.length===t&&(n=[]);for(let o=0;o<t;o++){let l=e[o]._id;a&&a.push(r[l]),n&&n.push(s[l])}a&&(this.faceVertexUvs[0]=a),n&&(this.faceVertexUvs[1]=n)}toJSON(){let e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){let p=this.parameters;for(let f in p)p[f]!==void 0&&(e[f]=p[f]);return e}let t=[];for(let p=0;p<this.vertices.length;p++){let f=this.vertices[p];t.push(f.x,f.y,f.z)}let i=[],r=[],s={},a=[],n={},o=[],l={};for(let p=0;p<this.faces.length;p++){let f=this.faces[p],g=!0,m=!1,v=this.faceVertexUvs[0][p]!==void 0,y=f.normal.length()>0,x=f.vertexNormals.length>0,w=f.color.r!==1||f.color.g!==1||f.color.b!==1,_=f.vertexColors.length>0,b=0;if(b=h(b,0,0),b=h(b,1,g),b=h(b,2,m),b=h(b,3,v),b=h(b,4,y),b=h(b,5,x),b=h(b,6,w),b=h(b,7,_),i.push(b),i.push(f.a,f.b,f.c),i.push(f.materialIndex),v){let A=this.faceVertexUvs[0][p];i.push(u(A[0]),u(A[1]),u(A[2]))}if(y&&i.push(c(f.normal)),x){let A=f.vertexNormals;i.push(c(A[0]),c(A[1]),c(A[2]))}if(w&&i.push(d(f.color)),_){let A=f.vertexColors;i.push(d(A[0]),d(A[1]),d(A[2]))}}function h(p,f,g){return g?p|1<<f:p&~(1<<f)}function c(p){let f=p.x.toString()+p.y.toString()+p.z.toString();return s[f]!==void 0||(s[f]=r.length/3,r.push(p.x,p.y,p.z)),s[f]}function d(p){let f=p.r.toString()+p.g.toString()+p.b.toString();return n[f]!==void 0||(n[f]=a.length,a.push(p.getHex())),n[f]}function u(p){let f=p.x.toString()+p.y.toString();return l[f]!==void 0||(l[f]=o.length/2,o.push(p.x,p.y)),l[f]}return e.data={},e.data.vertices=t,e.data.normals=r,a.length>0&&(e.data.colors=a),o.length>0&&(e.data.uvs=[o]),e.data.faces=i,e}clone(){return new $c().copy(this)}copy(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;let t=e.vertices;for(let d=0,u=t.length;d<u;d++)this.vertices.push(t[d].clone());let i=e.colors;for(let d=0,u=i.length;d<u;d++)this.colors.push(i[d].clone());let r=e.faces;for(let d=0,u=r.length;d<u;d++)this.faces.push(r[d].clone());for(let d=0,u=e.faceVertexUvs.length;d<u;d++){let p=e.faceVertexUvs[d];this.faceVertexUvs[d]===void 0&&(this.faceVertexUvs[d]=[]);for(let f=0,g=p.length;f<g;f++){let m=p[f],v=[];for(let y=0,x=m.length;y<x;y++){let w=m[y];v.push(w.clone())}this.faceVertexUvs[d].push(v)}}let s=e.morphTargets;for(let d=0,u=s.length;d<u;d++){let p={};if(p.name=s[d].name,s[d].vertices!==void 0){p.vertices=[];for(let f=0,g=s[d].vertices.length;f<g;f++)p.vertices.push(s[d].vertices[f].clone())}if(s[d].normals!==void 0){p.normals=[];for(let f=0,g=s[d].normals.length;f<g;f++)p.normals.push(s[d].normals[f].clone())}this.morphTargets.push(p)}let a=e.morphNormals;for(let d=0,u=a.length;d<u;d++){let p={};if(a[d].vertexNormals!==void 0){p.vertexNormals=[];for(let f=0,g=a[d].vertexNormals.length;f<g;f++){let m=a[d].vertexNormals[f],v={};v.a=m.a.clone(),v.b=m.b.clone(),v.c=m.c.clone(),p.vertexNormals.push(v)}}if(a[d].faceNormals!==void 0){p.faceNormals=[];for(let f=0,g=a[d].faceNormals.length;f<g;f++)p.faceNormals.push(a[d].faceNormals[f].clone())}this.morphNormals.push(p)}let n=e.skinWeights;for(let d=0,u=n.length;d<u;d++)this.skinWeights.push(n[d].clone());let o=e.skinIndices;for(let d=0,u=o.length;d<u;d++)this.skinIndices.push(o[d].clone());let l=e.lineDistances;for(let d=0,u=l.length;d<u;d++)this.lineDistances.push(l[d]);let h=e.boundingBox;h!==null&&(this.boundingBox=h.clone());let c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}toBufferGeometry(){let e=new gV().fromGeometry(this),t=new Ge,i=new Float32Array(e.vertices.length*3);if(t.setAttribute("position",m0.call(new ot(i,3),e.vertices)),e.normals.length>0){let r=new Float32Array(e.normals.length*3);t.setAttribute("normal",m0.call(new ot(r,3),e.normals))}if(e.colors.length>0){let r=new Float32Array(e.colors.length*3);t.setAttribute("color",Ag.call(new ot(r,3),e.colors))}if(e.uvs.length>0){let r=new Float32Array(e.uvs.length*2);t.setAttribute("uv",Mg.call(new ot(r,2),e.uvs))}if(e.uvs2.length>0){let r=new Float32Array(e.uvs2.length*2);t.setAttribute("uv2",Mg.call(new ot(r,2),e.uvs2))}t.groups=e.groups;for(let r in e.morphTargets){let s=[],a=e.morphTargets[r];for(let n=0,o=a.length;n<o;n++){let l=a[n],h=new De(l.data.length*3,3);h.name=l.name,s.push(m0.call(h,l.data))}t.morphAttributes[r]=s}if(e.skinIndices.length>0){let r=new De(e.skinIndices.length*4,4);t.setAttribute("skinIndex",Eg.call(r,e.skinIndices))}if(e.skinWeights.length>0){let r=new De(e.skinWeights.length*4,4);t.setAttribute("skinWeight",Eg.call(r,e.skinWeights))}return e.boundingSphere!==null&&(t.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(t.boundingBox=e.boundingBox.clone()),t}computeTangents(){}computeLineDistances(){}applyMatrix(e){return this.applyMatrix4(e)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(e){let t=new Ge,i=e.geometry;if(e.isPoints||e.isLine){let r=new De(i.vertices.length*3,3),s=new De(i.colors.length*3,3);if(t.setAttribute("position",m0.call(r,i.vertices)),t.setAttribute("color",Ag.call(s,i.colors)),i.lineDistances&&i.lineDistances.length===i.vertices.length){let a=new De(i.lineDistances.length,1);t.setAttribute("lineDistance",vV.call(a,i.lineDistances))}i.boundingSphere!==null&&(t.boundingSphere=i.boundingSphere.clone()),i.boundingBox!==null&&(t.boundingBox=i.boundingBox.clone())}else e.isMesh&&(t=i.toBufferGeometry());return t}};$c.prototype.isGeometry=!0;var gV=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(e){let t=[],i,r,s,a=e.faces;for(r=0;r<a.length;r++){let n=a[r];n.materialIndex!==s&&(s=n.materialIndex,i!==void 0&&(i.count=r*3-i.start,t.push(i)),i={start:r*3,materialIndex:s})}i!==void 0&&(i.count=r*3-i.start,t.push(i)),this.groups=t}fromGeometry(e){let t=e.faces,i=e.vertices,r=e.faceVertexUvs,s=r[0]&&r[0].length>0,a=r[1]&&r[1].length>0,n=e.morphTargets,o=n.length,l;if(o>0){l=[];for(let m=0;m<o;m++)l[m]={name:n[m].name,data:[]};this.morphTargets.position=l}let h=e.morphNormals,c=h.length,d;if(c>0){d=[];for(let m=0;m<c;m++)d[m]={name:h[m].name,data:[]};this.morphTargets.normal=d}let u=e.skinIndices,p=e.skinWeights,f=u.length===i.length,g=p.length===i.length;i.length>0&&t.length;for(let m=0;m<t.length;m++){let v=t[m];this.vertices.push(i[v.a],i[v.b],i[v.c]);let y=v.vertexNormals;if(y.length===3)this.normals.push(y[0],y[1],y[2]);else{let w=v.normal;this.normals.push(w,w,w)}let x=v.vertexColors;if(x.length===3)this.colors.push(x[0],x[1],x[2]);else{let w=v.color;this.colors.push(w,w,w)}if(s===!0){let w=r[0][m];w!==void 0?this.uvs.push(w[0],w[1],w[2]):this.uvs.push(new j,new j,new j)}if(a===!0){let w=r[1][m];w!==void 0?this.uvs2.push(w[0],w[1],w[2]):this.uvs2.push(new j,new j,new j)}for(let w=0;w<o;w++){let _=n[w].vertices;l[w].data.push(_[v.a],_[v.b],_[v.c])}for(let w=0;w<c;w++){let _=h[w].vertexNormals[m];d[w].data.push(_.a,_.b,_.c)}f&&this.skinIndices.push(u[v.a],u[v.b],u[v.c]),g&&this.skinWeights.push(p[v.a],p[v.b],p[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this}},mf=class{constructor(e,t,i,r,s,a=0){this.a=e,this.b=t,this.c=i,this.normal=r&&r.isVector3?r:new E,this.vertexNormals=Array.isArray(r)?r:[],this.color=s&&s.isColor?s:new Je,this.vertexColors=Array.isArray(s)?s:[],this.materialIndex=a}clone(){return new this.constructor().copy(this)}copy(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,i=e.vertexNormals.length;t<i;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,i=e.vertexColors.length;t<i;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}};function vV(e){return this.array.set(e),this}function Ag(e){let t=this.array,i=0;for(let r=0,s=e.length;r<s;r++){let a=e[r];a===void 0&&(a=new Je),t[i++]=a.r,t[i++]=a.g,t[i++]=a.b}return this}function Mg(e){let t=this.array,i=0;for(let r=0,s=e.length;r<s;r++){let a=e[r];a===void 0&&(a=new j),t[i++]=a.x,t[i++]=a.y}return this}function m0(e){let t=this.array,i=0;for(let r=0,s=e.length;r<s;r++){let a=e[r];a===void 0&&(a=new E),t[i++]=a.x,t[i++]=a.y,t[i++]=a.z}return this}function Eg(e){let t=this.array,i=0;for(let r=0,s=e.length;r<s;r++){let a=e[r];a===void 0&&(a=new ht),t[i++]=a.x,t[i++]=a.y,t[i++]=a.z,t[i++]=a.w}return this}var yV=["a","b","c"];function xV(e,t){switch(t){case"c":return e.c;case"b":return e.b;case"a":default:return e.a}}function ep(e,t,i){let r=Math.min(e,t),s=Math.max(e,t),a=r+"_"+s;return i.get(a)}function tp(e,t,i,r,s,a){let n=Math.min(e,t),o=Math.max(e,t),l=n+"_"+o,h;if(r.has(l))h=r.get(l);else{let c=i[n],d=i[o];h={a:c,b:d,newEdge:null,faces:[]},r.set(l,h)}h.faces.push(s),a[e].edges.push(h),a[t].edges.push(h)}function bV(e,t,i,r){let s,a,n;for(s=0,a=e.length;s<a;s++)i[s]={edges:[]};for(s=0,a=t.length;s<a;s++)n=t[s],tp(n.a,n.b,e,r,n,i),tp(n.b,n.c,e,r,n,i),tp(n.c,n.a,e,r,n,i)}function g0(e,t,i,r,s){e.push(new mf(t,i,r,void 0,void 0,s))}function mo(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function v0(e,t,i,r){e.push([t.clone(),i.clone(),r.clone()])}var wV=class{constructor(e=1){this.subdivisions=e}modify(e){e instanceof Ge?e=new $c().fromBufferGeometry(e):e=e.clone(),e.mergeVertices();let t=this.subdivisions;for(;t-- >0;)this._smooth(e);return e.computeFaceNormals(),e.computeVertexNormals(),e}_smooth(e){let t=new E,i,r,s,a,n,o=e.vertices,l=e.faces,h=e.faceVertexUvs[0],c=h!==void 0&&h.length>0,d=[],u=new Map;bV(o,l,d,u);let p=[],f,g,m,v,y,x,w;for(let le of Array.from(u.keys())){for(g=u.get(le),m=new E,y=3/8,x=1/8,w=g.faces.length,w!=2&&(y=.5,x=0,w!=1),m.addVectors(g.a,g.b).multiplyScalar(y),t.set(0,0,0),a=0;a<w;a++){for(v=g.faces[a],n=0;n<3&&(f=o[xV(v,yV[n])],!(f!==g.a&&f!==g.b));n++);f&&t.add(f)}t.multiplyScalar(x),m.add(t),g.newEdge=p.length,p.push(m)}let _,b,A,S,M,C,T,P=[];for(r=0,s=o.length;r<s;r++){for(C=o[r],M=d[r].edges,i=M.length,i==3?_=3/16:i>3&&(_=3/(8*i)),b=1-i*Number(_),A=_,i<=2&&(i==2?(b=3/4,A=1/8):i==1||i==0),T=C.clone().multiplyScalar(b),t.set(0,0,0),a=0;a<i;a++)S=M[a],f=S.a!==C?S.a:S.b,t.add(f);t.multiplyScalar(Number(A)),T.add(t),P.push(T)}let I=P.concat(p),D=P.length,k,H,U,F=[],Z=[],W,G,X,ee,Y=new j,$=new j,Q=new j;for(r=0,s=l.length;r<s;r++)v=l[r],k=Number(ep(v.a,v.b,u).newEdge)+D,H=Number(ep(v.b,v.c,u).newEdge)+D,U=Number(ep(v.c,v.a,u).newEdge)+D,g0(F,k,H,U,v.materialIndex),g0(F,v.a,k,U,v.materialIndex),g0(F,v.b,H,k,v.materialIndex),g0(F,v.c,U,H,v.materialIndex),c&&(W=h[r],G=W[0],X=W[1],ee=W[2],Y.set(mo(G.x,X.x),mo(G.y,X.y)),$.set(mo(X.x,ee.x),mo(X.y,ee.y)),Q.set(mo(G.x,ee.x),mo(G.y,ee.y)),v0(Z,Y,$,Q),v0(Z,G,Y,Q),v0(Z,X,$,Y),v0(Z,ee,Q,$));e.vertices=I,e.faces=F,c&&(e.faceVertexUvs[0]=Z)}},Pi=new E,SV=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=e.geometry??(t==null?void 0:t.geometry)??new Ge().copy(new Lr(100,100,100)),r;t===void 0?(i.computeBoundingBox(),i.boundingBox.getSize(Pi),r={width:Pi.x,height:Pi.y,depth:Pi.z,subdivisions:0}):r=t.parameters;let s={...r,...e.parameters};return{parameters:{width:Math.abs(s.width),height:Math.abs(s.height),depth:Math.abs(s.depth),subdivisions:Math.abs(s.subdivisions)},geometry:i}}static build(e){let{width:t,height:i,depth:r,subdivisions:s}=e.parameters,a=e.geometry??new Ge().copy(new Lr(100,100,100)),n=a.userData.parameters;n===void 0?(a.computeBoundingBox(),a.boundingBox.getSize(Pi)):Pi.set(n.width,n.height,n.depth),(t!==Pi.x||i!==Pi.y||r!==Pi.z)&&a.scale(Pi.x===0?1:t/Pi.x,Pi.y===0?1:i/Pi.y,Pi.z===0?1:r/Pi.z);let o=a.originalGeometry;try{s>0?(o===void 0||(n==null?void 0:n.subdivisions)!==s)&&(o===void 0&&(o=a),a=new wV(s).modify(o).toBufferGeometry()):(o!==void 0&&(a=o),o=void 0,a.getAttribute("normal")===void 0&&a.computeVertexNormals())}catch{o!==void 0&&(a=o),o=void 0,a.getAttribute("normal")===void 0&&a.computeVertexNormals()}return o!==void 0&&Object.assign(a,{originalGeometry:o}),delete e.geometry,Object.assign(a,{userData:{...e,type:"NonParametricGeometry"}})}static loadFromUrl(e,t,i){new Vv(i).load(e,r=>{let s=this.normalizeInputs({geometry:r});r.boundingBox.getSize(Pi);let a=100/Pi.x;Object.assign(s.parameters,{width:100,height:Pi.y*a,depth:Pi.z*a}),t(this.build(s))})}},zx=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters);return{shape:e.shape&&e.shape instanceof hi?e.shape:new hi,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(e){let{width:t,height:i,spikes:r,cornerRadius:s,depth:a,extrudeBevelSize:n,extrudeBevelSegments:o}=e.parameters,l=e.shape,h=t*.5,c=i*.5,d=0,u=0,p=2*Math.PI/r;for(let g=0;g<r;g++){let m=p*g,v=d+Math.sin(m)*h,y=u+Math.cos(m)*c;l.addPoint(l.createPoint(v,y))}l.isClosed=!0;for(let g=0,m=l.points.length;g<m;g++)l.points[g].roundness=s;l.roundness=s,l.update();let f=Wn.create({shape:l,parameters:{roundness:s,depth:a,extrudeBevelSize:n,extrudeBevelSegments:o}});return Object.assign(f,{userData:{...e,type:"PolygonGeometry"}})}},_V=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,height:i,depth:r,radialSegments:s,heightSegments:a,openEnded:n,cornerRadius:o,cornerSegments:l}=e.parameters,h=new MV(t*.5,i,s,a,n,o,l);return h.scale(1,1,r/t),Object.assign(h,{userData:{...e,type:"PyramidGeometry"}})}};function $l(e,t,i){i.x=e.x*t.x,i.y=e.y,i.z=e.x*t.y}function ip(e,t,i,r,s,a){let n=t.clone().sub(e),o=i.clone().sub(e),l=n.angleTo(o);if(n.normalize(),o.normalize(),r===s){let h=n.add(o).normalize();a.copy(e).addScaledVector(h,r/Math.sin(l/2))}else{let h=n.angleTo(o);a.copy(e),a.addScaledVector(n,s/Math.sin(h)),a.addScaledVector(o,r/Math.sin(h))}}function AV(e,t,i){let r=e.clone().sub(t),s=i.clone().sub(t);return r.projectOnVector(s),r.add(t)}var MV=class extends Ge{constructor(e=.5,t=1,i=4,r=1,s=!1,a=0,n=4){super(),i=Math.floor(Math.max(3,i)),r=Math.floor(r),n=Math.floor(n);let o=[],l=[],h=[],c=[],d=0,u=t/2,p=Math.PI/i,f=e*Math.cos(Math.PI/i),g=2*Math.PI/i,m=(i-2)*Math.PI/i,v=Math.PI-m,y=new E(0,-u,0),x=new E(0,u,0),w=new j(e,-u),_=new j(f,-u),b=new j(0,x.y).sub(_),A=new j(0,x.y).sub(w),S=new j(b.y,-b.x).normalize(),M=new j(A.y,-A.x).normalize(),C=e*Math.cos(Math.PI/i)*Math.tan((Math.PI-b.angle())/2)-1e-8;a=Math.min(a,C);let T;{let U=new E(S.x,S.y,0),F=new E(Math.cos(g)*U.x,U.y,Math.sin(g)*U.x);T=U.angleTo(F)}let P=a/Math.tan((Math.PI-b.angle())/2),I=a/Math.tan((Math.PI-T)/2),D=new E;if(!s){l.push(y.x,y.y,y.z),h.push(0,-1,0),c.push(0,0);let U=d++,F=[],Z=w.clone(),W=P/Math.cos(Math.PI/i);Z.x-=W;for(let G=0;G<i;G++){let X=G/i*Math.PI*2+p,ee=new j(Math.sin(X),Math.cos(X));$l(Z,ee,D),l.push(D.x,D.y,D.z),h.push(0,-1,0),c.push(0,0),F.push(d++)}for(let G=0;G<F.length;G++)o.push(F[G],U,F[(G+1)%F.length])}{let U=new E,F=new E,Z=new E,W=new E,G=new E,X=new E;for(let ee=0;ee<i;ee++){let Y=ee/i*Math.PI*2+p,$=(ee+.5)/i*Math.PI*2+p,Q=(ee+1)/i*Math.PI*2+p,le=new j(Math.sin(Y),Math.cos(Y)),re=new j(Math.sin($),Math.cos($)),te=new j(Math.sin(Q),Math.cos(Q));$l(w,le,F),$l(w,te,Z),$l(S,re,U),ip(x,F,Z,I,I,W),l.push(W.x,W.y,W.z),ip(F,x,Z,I,P,G),l.push(G.x,G.y,G.z),ip(Z,F,x,P,I,X),l.push(X.x,X.y,X.z),h.push(U.x,U.y,U.z),h.push(U.x,U.y,U.z),h.push(U.x,U.y,U.z),c.push(0,0),c.push(0,0),c.push(0,0);let ne=d++,ce=d++,pe=d++;if(o.push(ne,ce,pe),a>0){{let Ae=F.clone().add(Z).multiplyScalar(.5),Ne=x.clone().sub(Ae).normalize(),Fe=y.clone().sub(Ae).normalize().add(Ne).normalize().multiplyScalar(-1),Ee=X.clone().sub(G);k(Ae,Ee,Fe,b.angle())}let xe,Re;{let Ae=new E;$l(M,te,Ae);let Ne=X.clone().add(W).multiplyScalar(.5);Ne=AV(Ne,Z,x);let Fe=X.clone().sub(W);[xe,Re]=k(Ne,Fe,Ae,T,W.y)}{let Ae=xe,Ne=Ae.clone().setY(0).normalize(),Fe=new E(0,-1,0),Ee=Ne.clone().cross(Fe);H(Ae,Ne,Fe,Ee)}{let Ae=b.angle(),Ne=Math.PI-Ae,Fe=x.clone();Fe.y-=a/Math.sin(Ae-Math.PI/2);let Ee=new E,Me=[];for(let He=0;He<n;He++){let V=[],B=Math.PI/2-Ne*He/n,ae=Math.cos(B),Se=Math.sin(B),R=$;for(let Ce=0;Ce<=He;Ce++){let Ue=Math.cos(R),Ie=Math.sin(R);U.x=ae*Ie,U.y=Se,U.z=ae*Ue,Ee.copy(Fe).addScaledVector(U,a),l.push(Ee.x,Ee.y,Ee.z),h.push(U.x,U.y,U.z),c.push(0,0),V.push(d++),R+=Math.PI*2/He/i}Me.push(V)}Re.reverse(),Me.push(Re);let Ye=Me.length-1;for(let He=0;He<Ye;He++){let V=Me[He],B=Me[He+1],ae=V.length-1;o.push(B[1],V[0],B[0]);for(let Se=1;Se<=ae;Se++)o.push(V[Se],V[Se-1],B[Se]),o.push(B[Se+1],V[Se],B[Se])}}}}}this.setIndex(o),this.setAttribute("position",new De(l,3)),this.setAttribute("normal",new De(h,3)),this.setAttribute("uv",new De(c,2));function k(U,F,Z,W,G){let X=-W/2,ee=(Math.PI-W)/2,Y=F.clone().normalize().cross(Z);U.addScaledVector(Z,-a/Math.sin(ee));let $=new E,Q=new E,le=1,re=d,te=[];for(let ne=0;ne<=n;ne++){let ce=X+ne/n*W;Q.set(0,0,0),Q.addScaledVector(Y,Math.sin(ce)),Q.addScaledVector(Z,Math.cos(ce));for(let pe=0;pe<=le;pe++){let xe=pe/le-.5;if($.copy(U),$.addScaledVector(F,xe),$.addScaledVector(Q,a),G!=null){let Re=Math.max(0,$.y-G);$.addScaledVector(F,-Re/F.y)}l.push($.x,$.y,$.z),h.push(Q.x,Q.y,Q.z),c.push(0,0),pe===0&&te.push(d),d++}}for(let ne=0;ne<n;ne++)for(let ce=0;ce<le;ce++){let pe=re+ce+(le+1)*ne,xe=pe+(le+1),Re=xe+1,Ae=pe+1;o.push(pe,xe,Ae),o.push(xe,Re,Ae)}return[U.clone().addScaledVector(F,.5),te]}function H(U,F,Z,W){let G=Math.PI/2,X=A.angle()-G,ee=[],Y=new E,$=new E;for(let le=0;le<=n;le++){let re=[],te=le/n;for(let ne=0;ne<=le;ne++){let ce=((le?ne/le:0)-.5)*v,pe=Math.cos(ce),xe=Math.sin(ce),Re=Math.atan(Math.tan(X)*pe),Ae=(G+Re)*te,Ne=Math.cos(Ae),Fe=Math.sin(Ae);Y.set(0,0,0),Y.addScaledVector(F,Fe*pe),Y.addScaledVector(Z,Ne),Y.addScaledVector(W,Fe*xe),$.copy(U).addScaledVector(Y,a),l.push($.x,$.y,$.z),h.push(Y.x,Y.y,Y.z),c.push(0,0),re.push(d++)}ee.push(re)}let Q=ee.length-1;for(let le=0;le<Q;le++){let re=ee[le],te=ee[le+1],ne=re.length-1;o.push(re[0],te[1],te[0]);for(let ce=1;ce<=ne;ce++)o.push(re[ce-1],re[ce],te[ce]),o.push(re[ce],te[ce+1],te[ce])}}}},Z4=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters),r=Object.assign((t==null?void 0:t.ui)??{enabledIndieCorners:!1},e.ui);return{shape:e.shape&&e.shape instanceof hi?e.shape:new hi,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)}),ui:r}}static build(e){let t=e.shape,{width:i,height:r,cornerRadius:s,cornerType:a,depth:n,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,h={x:i*.5,y:r*.5},c={x:-h.x,y:-h.y},d={x:h.x,y:h.y};function u(w,_,b){return _>i&&b>r?Math.min(w*i/_,w*r/b):_>i?w*i/_:b>r?w*r/b:w}let p=[];p[0]=s[0]===0?0:u(s[0],s[0]+s[3],s[0]+s[1]),p[1]=s[1]===0?0:u(s[1],s[1]+s[2],s[1]+s[0]),p[2]=s[2]===0?0:u(s[2],s[2]+s[1],s[2]+s[3]),p[3]=s[3]===0?0:u(s[3],s[3]+s[0],s[3]+s[2]);let f=c.x,g=d.x,m=d.y,v=c.y;t.addPoint(t.createPoint(f,m)),t.addPoint(t.createPoint(g,m)),t.addPoint(t.createPoint(g,v)),t.addPoint(t.createPoint(f,v)),t.isClosed=!0;let y=!0;for(let w=0,_=t.points.length;w<_;w++)t.points[w].roundness=p[w],w>0&&p[w]!==p[w-1]&&(y=!1);y&&(t.roundness=p[0]),t.useCubicForRoundedCorners=a!==1,t.update();let x=Wn.create({shape:t,parameters:{depth:n,extrudeBevelSize:o,extrudeBevelSegments:l}});return Object.assign(x,{userData:{...e,type:"RectangleGeometry"}})}},EV=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180},e.parameters);return i.thetaLength=Oe.clamp(i.thetaLength,0,180),{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t=100,height:i=t,depth:r=t,widthSegments:s=64,heightSegments:a=64,phiStart:n,phiLength:o,thetaStart:l,thetaLength:h}=e.parameters,c;return h===0?(c=new Ge,c.setAttribute("position",new De([],3))):c=new jo(.5*t,s,a,n,o,l,h*Oe.DEG2RAD),c.scale(1,i/t,r/t),Object.assign(c,{userData:{...e,type:"SphereGeometry"}})}},CV=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,widthSegments:8,heightSegments:8},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:0})}}static build(e){let{width:t=100,height:i=t,widthSegments:r=8,heightSegments:s=8}=e.parameters,a=new $s(t,i,r,s);return a.scale(1,1,1),Object.assign(a,{userData:{...e,type:"PlaneGeometry"}})}},TV=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,angle:90,cornerRadius:24,cornerSegments:8},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,height:i,depth:r,angle:s,cornerRadius:a,cornerSegments:n}=e.parameters,o=new PV(t,i,r,s,a,n);return Object.assign(o,{userData:{...e,type:"BackdropGeometry"}})}},PV=class extends Ge{constructor(e=1,t=1,i=1,r=90,s=10,a=24){super(),this.type="BackdropGeometry";let n=[],o=[],l=[],h=.001;s==0&&(a=1),a=Math.max(1,Math.floor(a)),s=Math.min(s,100),r=Math.min(180-h,r),r*=Math.PI/180;let c=[],d=Math.PI/2,u=(le=0,re=0,te=0)=>new E(le,re,te),p=u(),f=u(),[g,m,v]=[t/2,e/2,i/2],y=-m,x=+m,[w,_,b]=[u(y,-g,+v),u(y,-g,-v),u(y,+g,-v)],A=(le,re=!1)=>Math.sin(le-Math.PI/(1+ +re)),S=(le,re=!1)=>Math.cos(le-Math.PI/(1+ +re));b.y=Math.sin(r)*t-g;let M=Math.cos(r)*t-v,C=w.z-h;r<=d?(b.z=Math.min(M,C),b.z==C&&(b.y-=(M-C)/Math.tan(d-r))):_.z=Math.min(_.z-M-v,w.z-h),p.subVectors(w,_),f.subVectors(b,_);let T=Math.min(p.length(),f.length())*s/100,P=T*Math.tan(r/2),I=T/Math.cos(r/2),D=p.clone().normalize().add(f.normalize()).setLength(I).add(_);p.set(0,A(r,!0),S(r,!0)),c.push([b,p.clone()]);let k=(Math.PI-r)/a;for(let le=0;le<=a;le++){let re=d+r+le*k;p.set(0,Math.sin(re)*P,Math.cos(re)*P),p.add(D),f.set(0,A(re),S(re)),c.push([p.clone(),f.clone()])}c.push([w,u(0,1,0)]);let H=Math.sin(k/2)*P*2,U=c.length-1,F=c[0][0].distanceTo(c[1][0]),Z=c[U-1][0].distanceTo(c[U][0]),W=F+H*a+Z;c[0].push(1);for(let le=0;le<=a;le++)c[le+1].push(1-(F+le*H)/W);c[U].push(0);let[G,X,ee]=c[0],Y,$,Q;for(let le=1;le<c.length;le++)[Y,$,Q]=c[le],n.push(y,G.y,G.z,y,Y.y,Y.z,x,G.y,G.z,x,G.y,G.z,y,Y.y,Y.z,x,Y.y,Y.z),o.push(0,X.y,X.z,0,$.y,$.z,0,X.y,X.z,0,X.y,X.z,0,$.y,$.z,0,$.y,$.z),l.push(0,ee,0,Q,1,ee,1,ee,0,Q,1,Q),[G,X,ee]=[Y,$,Q];this.setAttribute("position",new De(n,3)),this.setAttribute("normal",new De(o,3)),this.setAttribute("uv",new De(l,2))}},Fx=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof hi?e.shape:new hi,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(e){let{width:t,height:i,innerRadiusPercent:r,spikes:s,cornerRadius:a,angle:n,depth:o,extrudeBevelSize:l,extrudeBevelSegments:h}=e.parameters,c=e.shape,d=t*.5,u=i*.5,p=0,f=0,g=n*Math.PI/360/s,m=Math.PI/2*3*-1,v=d*r/100,y=u*r/100;if(s===3&&r===50){g=2*Math.PI/s;for(let w=0;w<s;w++){let _=g*w,b=p+Math.sin(_)*d,A=f+Math.cos(_)*u;c.addPoint(c.createPoint(b,A))}}else for(let w=0;w<s;w++){let _=p+Math.cos(m)*d,b=f+Math.sin(m)*u;c.addPoint(c.createPoint(_,b)),m+=g,_=p+Math.cos(m)*v,b=f+Math.sin(m)*y,c.addPoint(c.createPoint(_,b)),m+=g}c.isClosed=!0;for(let w=0,_=c.points.length;w<_;w++)c.points[w].roundness=a;c.roundness=a,c.update();let x=Wn.create({shape:c,parameters:{roundness:a,depth:o,extrudeBevelSize:l,extrudeBevelSegments:h}});return Object.assign(x,{userData:{...e,type:"StarGeometry"}})}},DV=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(e){let{width:t,height:i}=e.parameters,r=new $s(t,i);return Object.assign(r,{userData:{...e,type:"TextFrameGeometry"}})}},IV=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:32,tubularSegments:64,arc:360,cornerRadius:30,cornerSegments:8},e.parameters),r=Math.abs(i.width),s=Math.abs(i.height??i.width),a=Math.round(Math.abs(i.depth??i.width*.25));return{parameters:Object.assign(i,{width:r,height:s,depth:a})}}static build(e){let{width:t,height:i,depth:r,radialSegments:s,tubularSegments:a,arc:n,cornerRadius:o,cornerSegments:l}=e.parameters,h=OV(t,i,r,t*.5,n,a,0,0,s,o,l);return h.scale(1,i/t,1),Object.assign(h,{userData:{...e,type:"TorusGeometry"}})}};function OV(e,t,i,r,s,a,n,o,l,h,c){[t,i]=[i,t],n=t/2;let d=Oe.clamp(s/360,0,1);if(d===0){let u=new Ge;return u.setAttribute("position",new De([],3)),u}return d===1&&(h=0),new Lx(!0,e,t,i,r,d,a,n,o,l,h,c)}var RV=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width),tube:i.tube??i.width*.125})}}static build(e){let{width:t,tube:i,tubularSegments:r,radialSegments:s,p:a,q:n}=e.parameters,o=t*.5;o!==i&&(o-=i);let l=new Lv(o,i,r,s,a,n);return Object.assign(l,{userData:{...e,type:"TorusKnotGeometry"}})}},LV=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},e.parameters);return{shape:e.shape&&e.shape instanceof hi?e.shape:new hi,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width*(i.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(i.depth??0)})}}static build(e){let{width:t=100,height:i,cornerRadius:r,depth:s,extrudeBevelSize:a,extrudeBevelSegments:n,isRect:o}=e.parameters,l=e.shape,h=t*.5,c=i*.5;o?(l.addPoint(l.createPoint(-h,c)),l.addPoint(l.createPoint(h,-c)),l.addPoint(l.createPoint(-h,-c))):(l.addPoint(l.createPoint(0,c)),l.addPoint(l.createPoint(h,-c)),l.addPoint(l.createPoint(-h,-c))),l.isClosed=!0;for(let u=0,p=l.points.length;u<p;u++)l.points[u].roundness=r;l.roundness=r,l.update();let d=Wn.create({shape:l,parameters:{roundness:r,depth:s,extrudeBevelSize:a,extrudeBevelSegments:n}});return Object.assign(d,{userData:{...e,type:"TriangleGeometry"}})}};function BV(e,t){let i=2*Math.PI;return(e%i+i)%i===(t%i+i)%i}function zV(e){return/^(rgba)?\(\s*(\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(e.toLowerCase())}function FV(e,t,i){let r,s,a,n=Math.floor(e*6),o=e*6-n,l=i*(1-t),h=i*(1-o*t),c=i*(1-(1-o)*t);switch(n%6){case 0:r=i,s=c,a=l;break;case 1:r=h,s=i,a=l;break;case 2:r=l,s=i,a=c;break;case 3:r=l,s=h,a=i;break;case 4:r=c,s=l,a=i;break;case 5:default:r=i,s=l,a=h;break}return{r:r*255,g:s*255,b:a*255}}function kV(e,t,i){e/=255,t/=255,i/=255;let r=Math.max(e,t,i),s=Math.min(e,t,i),a=r,n=r-s,o=r==0?0:n/r,l;if(r==s)l=0;else{switch(r){case e:l=(t-i)/n+(t<i?6:0);break;case t:l=(i-e)/n+2;break;case i:default:l=(e-t)/n+4;break}l/=6}return{h:l,s:o,v:a}}function UV(e){return e=Math.floor(e),{r:e>>16&255,g:e>>8&255,b:e&255}}function NV(e,t,i){return(e<<16)+(t<<8)+i}function VV(e,t,i){return e=Math.round(e),t=Math.round(t),i=Math.round(i),"#"+[e,t,i].map(r=>r.toString(16).padStart(2,"0")).join("").toUpperCase()}function jV(e){let t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,(r,s,a,n)=>String(s+s+a+a+n+n));let i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null}var GV={parseRgba:zV,hsvToRgb:FV,rgbToHsv:kV,hexToRgb:UV,rgbToHex:NV,rgbToHexString:VV,hexStringToRgb:jV},HV=class{add(e,t,i){if(typeof arguments[0]!="string")for(let r in arguments[0])this.add(r,arguments[0][r],arguments[1]);else(Array.isArray(e)?e:[e]).forEach(function(r){this[r]=this[r]||[],t&&this[r][i?"unshift":"push"](t)},this)}run(e,t){this[e]=this[e]||[],this[e].forEach(function(i){i.call(t&&t.context?t.context:t,t)})}},WV=class{constructor(e){this.jsep=e,this.registered={}}register(...e){e.forEach(t=>{if(typeof t!="object"||!t.name||!t.init)throw new Error("Invalid JSEP plugin format");this.registered[t.name]||(t.init(this.jsep),this.registered[t.name]=t)})}},ue=class{static get version(){return"1.3.8"}static toString(){return"JavaScript Expression Parser (JSEP) v"+ue.version}static addUnaryOp(e){return ue.max_unop_len=Math.max(e.length,ue.max_unop_len),ue.unary_ops[e]=1,ue}static addBinaryOp(e,t,i){return ue.max_binop_len=Math.max(e.length,ue.max_binop_len),ue.binary_ops[e]=t,i?ue.right_associative.add(e):ue.right_associative.delete(e),ue}static addIdentifierChar(e){return ue.additional_identifier_chars.add(e),ue}static addLiteral(e,t){return ue.literals[e]=t,ue}static removeUnaryOp(e){return delete ue.unary_ops[e],e.length===ue.max_unop_len&&(ue.max_unop_len=ue.getMaxKeyLen(ue.unary_ops)),ue}static removeAllUnaryOps(){return ue.unary_ops={},ue.max_unop_len=0,ue}static removeIdentifierChar(e){return ue.additional_identifier_chars.delete(e),ue}static removeBinaryOp(e){return delete ue.binary_ops[e],e.length===ue.max_binop_len&&(ue.max_binop_len=ue.getMaxKeyLen(ue.binary_ops)),ue.right_associative.delete(e),ue}static removeAllBinaryOps(){return ue.binary_ops={},ue.max_binop_len=0,ue}static removeLiteral(e){return delete ue.literals[e],ue}static removeAllLiterals(){return ue.literals={},ue}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(e){this.expr=e,this.index=0}static parse(e){return new ue(e).parse()}static getMaxKeyLen(e){return Math.max(0,...Object.keys(e).map(t=>t.length))}static isDecimalDigit(e){return e>=48&&e<=57}static binaryPrecedence(e){return ue.binary_ops[e]||0}static isIdentifierStart(e){return e>=65&&e<=90||e>=97&&e<=122||e>=128&&!ue.binary_ops[String.fromCharCode(e)]||ue.additional_identifier_chars.has(String.fromCharCode(e))}static isIdentifierPart(e){return ue.isIdentifierStart(e)||ue.isDecimalDigit(e)}throwError(e){let t=new Error(e+" at character "+this.index);throw t.index=this.index,t.description=e,t}runHook(e,t){if(ue.hooks[e]){let i={context:this,node:t};return ue.hooks.run(e,i),i.node}return t}searchHook(e){if(ue.hooks[e]){let t={context:this};return ue.hooks[e].find(function(i){return i.call(t.context,t),t.node}),t.node}}gobbleSpaces(){let e=this.code;for(;e===ue.SPACE_CODE||e===ue.TAB_CODE||e===ue.LF_CODE||e===ue.CR_CODE;)e=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");let e=this.gobbleExpressions(),t=e.length===1?e[0]:{type:ue.COMPOUND,body:e};return this.runHook("after-all",t)}gobbleExpressions(e){let t=[],i,r;for(;this.index<this.expr.length;)if(i=this.code,i===ue.SEMCOL_CODE||i===ue.COMMA_CODE)this.index++;else if(r=this.gobbleExpression())t.push(r);else if(this.index<this.expr.length){if(i===e)break;this.throwError('Unexpected "'+this.char+'"')}return t}gobbleExpression(){let e=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",e)}gobbleBinaryOp(){this.gobbleSpaces();let e=this.expr.substr(this.index,ue.max_binop_len),t=e.length;for(;t>0;){if(ue.binary_ops.hasOwnProperty(e)&&(!ue.isIdentifierStart(this.code)||this.index+e.length<this.expr.length&&!ue.isIdentifierPart(this.expr.charCodeAt(this.index+e.length))))return this.index+=t,e;e=e.substr(0,--t)}return!1}gobbleBinaryExpression(){let e,t,i,r,s,a,n,o,l;if(a=this.gobbleToken(),!a||(t=this.gobbleBinaryOp(),!t))return a;for(s={value:t,prec:ue.binaryPrecedence(t),right_a:ue.right_associative.has(t)},n=this.gobbleToken(),n||this.throwError("Expected expression after "+t),r=[a,s,n];t=this.gobbleBinaryOp();){if(i=ue.binaryPrecedence(t),i===0){this.index-=t.length;break}s={value:t,prec:i,right_a:ue.right_associative.has(t)},l=t;let h=c=>s.right_a&&c.right_a?i>c.prec:i<=c.prec;for(;r.length>2&&h(r[r.length-2]);)n=r.pop(),t=r.pop().value,a=r.pop(),e={type:ue.BINARY_EXP,operator:t,left:a,right:n},r.push(e);e=this.gobbleToken(),e||this.throwError("Expected expression after "+l),r.push(s,e)}for(o=r.length-1,e=r[o];o>1;)e={type:ue.BINARY_EXP,operator:r[o-1].value,left:r[o-2],right:e},o-=2;return e}gobbleToken(){let e,t,i,r;if(this.gobbleSpaces(),r=this.searchHook("gobble-token"),r)return this.runHook("after-token",r);if(e=this.code,ue.isDecimalDigit(e)||e===ue.PERIOD_CODE)return this.gobbleNumericLiteral();if(e===ue.SQUOTE_CODE||e===ue.DQUOTE_CODE)r=this.gobbleStringLiteral();else if(e===ue.OBRACK_CODE)r=this.gobbleArray();else{for(t=this.expr.substr(this.index,ue.max_unop_len),i=t.length;i>0;){if(ue.unary_ops.hasOwnProperty(t)&&(!ue.isIdentifierStart(this.code)||this.index+t.length<this.expr.length&&!ue.isIdentifierPart(this.expr.charCodeAt(this.index+t.length)))){this.index+=i;let s=this.gobbleToken();return s||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:ue.UNARY_EXP,operator:t,argument:s,prefix:!0})}t=t.substr(0,--i)}ue.isIdentifierStart(e)?(r=this.gobbleIdentifier(),ue.literals.hasOwnProperty(r.name)?r={type:ue.LITERAL,value:ue.literals[r.name],raw:r.name}:r.name===ue.this_str&&(r={type:ue.THIS_EXP})):e===ue.OPAREN_CODE&&(r=this.gobbleGroup())}return r?(r=this.gobbleTokenProperty(r),this.runHook("after-token",r)):this.runHook("after-token",!1)}gobbleTokenProperty(e){this.gobbleSpaces();let t=this.code;for(;t===ue.PERIOD_CODE||t===ue.OBRACK_CODE||t===ue.OPAREN_CODE||t===ue.QUMARK_CODE;){let i;if(t===ue.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==ue.PERIOD_CODE)break;i=!0,this.index+=2,this.gobbleSpaces(),t=this.code}this.index++,t===ue.OBRACK_CODE?(e={type:ue.MEMBER_EXP,computed:!0,object:e,property:this.gobbleExpression()},this.gobbleSpaces(),t=this.code,t!==ue.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):t===ue.OPAREN_CODE?e={type:ue.CALL_EXP,arguments:this.gobbleArguments(ue.CPAREN_CODE),callee:e}:(t===ue.PERIOD_CODE||i)&&(i&&this.index--,this.gobbleSpaces(),e={type:ue.MEMBER_EXP,computed:!1,object:e,property:this.gobbleIdentifier()}),i&&(e.optional=!0),this.gobbleSpaces(),t=this.code}return e}gobbleNumericLiteral(){let e="",t,i;for(;ue.isDecimalDigit(this.code);)e+=this.expr.charAt(this.index++);if(this.code===ue.PERIOD_CODE)for(e+=this.expr.charAt(this.index++);ue.isDecimalDigit(this.code);)e+=this.expr.charAt(this.index++);if(t=this.char,t==="e"||t==="E"){for(e+=this.expr.charAt(this.index++),t=this.char,(t==="+"||t==="-")&&(e+=this.expr.charAt(this.index++));ue.isDecimalDigit(this.code);)e+=this.expr.charAt(this.index++);ue.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+e+this.char+")")}return i=this.code,ue.isIdentifierStart(i)?this.throwError("Variable names cannot start with a number ("+e+this.char+")"):(i===ue.PERIOD_CODE||e.length===1&&e.charCodeAt(0)===ue.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:ue.LITERAL,value:parseFloat(e),raw:e}}gobbleStringLiteral(){let e="",t=this.index,i=this.expr.charAt(this.index++),r=!1;for(;this.index<this.expr.length;){let s=this.expr.charAt(this.index++);if(s===i){r=!0;break}else if(s==="\\")switch(s=this.expr.charAt(this.index++),s){case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:e+=s}else e+=s}return r||this.throwError('Unclosed quote after "'+e+'"'),{type:ue.LITERAL,value:e,raw:this.expr.substring(t,this.index)}}gobbleIdentifier(){let e=this.code,t=this.index;for(ue.isIdentifierStart(e)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(e=this.code,ue.isIdentifierPart(e));)this.index++;return{type:ue.IDENTIFIER,name:this.expr.slice(t,this.index)}}gobbleArguments(e){let t=[],i=!1,r=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let s=this.code;if(s===e){i=!0,this.index++,e===ue.CPAREN_CODE&&r&&r>=t.length&&this.throwError("Unexpected token "+String.fromCharCode(e));break}else if(s===ue.COMMA_CODE){if(this.index++,r++,r!==t.length){if(e===ue.CPAREN_CODE)this.throwError("Unexpected token ,");else if(e===ue.CBRACK_CODE)for(let a=t.length;a<r;a++)t.push(null)}}else if(t.length!==r&&r!==0)this.throwError("Expected comma");else{let a=this.gobbleExpression();(!a||a.type===ue.COMPOUND)&&this.throwError("Expected comma"),t.push(a)}}return i||this.throwError("Expected "+String.fromCharCode(e)),t}gobbleGroup(){this.index++;let e=this.gobbleExpressions(ue.CPAREN_CODE);if(this.code===ue.CPAREN_CODE)return this.index++,e.length===1?e[0]:e.length?{type:ue.SEQUENCE_EXP,expressions:e}:!1;this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:ue.ARRAY_EXP,elements:this.gobbleArguments(ue.CBRACK_CODE)}}},qV=new HV;Object.assign(ue,{hooks:qV,plugins:new WV(ue),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},right_associative:new Set,additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"});ue.max_unop_len=ue.getMaxKeyLen(ue.unary_ops);ue.max_binop_len=ue.getMaxKeyLen(ue.binary_ops);var fl=e=>new ue(e).parse(),YV=Object.getOwnPropertyNames(ue);YV.forEach(e=>{fl[e]===void 0&&e!=="prototype"&&(fl[e]=ue[e])});fl.Jsep=ue;var XV="ConditionalExpression",QV={name:"ternary",init(e){e.hooks.add("after-expression",function(t){if(t.node&&this.code===e.QUMARK_CODE){this.index++;let i=t.node,r=this.gobbleExpression();if(r||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===e.COLON_CODE){this.index++;let s=this.gobbleExpression();if(s||this.throwError("Expected expression"),t.node={type:XV,test:i,consequent:r,alternate:s},i.operator&&e.binary_ops[i.operator]<=.9){let a=i;for(;a.right.operator&&e.binary_ops[a.right.operator]<=.9;)a=a.right;t.node.test=a.right,a.right=t.node,t.node=i}}else this.throwError("Expected :")}})}};fl.plugins.register(QV);function Id(e){return{all:e=e||new Map,on:function(t,i){var r=e.get(t);r?r.push(i):e.set(t,[i])},off:function(t,i){var r=e.get(t);r&&(i?r.splice(r.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var r=e.get(t);r&&r.slice().map(function(s){s(i)}),(r=e.get("*"))&&r.slice().map(function(s){s(t,i)})}}}var kx=class{constructor(e,t,i){var r;this.id=e,this.userAPI=t,this.result=void 0,this.error="null",this.isPrefetched=!1,this.isLoading=!1,this.isLoaded=!1,this.prefetchPromise=new Promise(s=>s()),this.emitter=Id(),this._innerCallUserAPI=async s=>{var a,n,o;this.emitter.emit("start",{userAPIId:this.id}),this.isLoading=!0,this.isLoading=!1;try{this.result=await ej(this.userAPI,s),this.error="null",this.emitter.emit("success",{userAPIId:this.id})}catch(l){let h=((o=(n=(a=l.message)==null?void 0:a.split("_:_"))==null?void 0:n[0])==null?void 0:o.replace("status:",""))??"null";this.error=h,this.result=null,this.emitter.emit("error",{userAPIId:this.id})}this.isLoading=!1,this.isPrefetched=!0,this.isLoaded=!0},((r=t==null?void 0:t.integration)==null?void 0:r.type)==="OpenAI"?this.result={content:""}:t.method==="GET"&&t.url!==""&&(this.prefetchPromise=this.prefetch(i)),this._debouncedCallUserAPI=this._innerCallUserAPI,this._updateDebouncedCallUserAPI(),this._debouncedPrefetch=V2(this.prefetch,1e3,{trailing:!0})}_updateDebouncedCallUserAPI(){this._debouncedCallUserAPI=this.userAPI.debounce!==void 0&&this.userAPI.debounce>0?V2(this._innerCallUserAPI,this.userAPI.debounce,{leading:!0,trailing:!0}):this._innerCallUserAPI}async prefetch(e){await this.callUserAPI(e)}async callUserAPI(e){await this._debouncedCallUserAPI(e)}update(e,t,i=!0){this.userAPI=e,this._updateDebouncedCallUserAPI(),this.userAPI.url!==""&&this.userAPI.method==="GET"&&i&&this._debouncedPrefetch(t)}retrieveValue(e){if(this.result)try{return Li.zoom(this.result,e)}catch(t){}}retrieveZoomedKeyValues(e){if(this.result){let t=e&&e.length?Li.zoom(this.result,e):this.result;if($V(t))return Object.entries(t);if(JV(t))return t.map((i,r)=>[r.toString(),i]);throw KV(t)?new Error("This path points to a value, use retrieveValue() instead. "+(e==null?void 0:e.join("."))):new Error("Path error"+(e==null?void 0:e.join(".")))}}dispose(){}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}get autostart(){return this.userAPI.autoStart}};function ZV(e){let t=new Headers;return e.headers.forEach(i=>{i.data.key!==""&&t.append(i.data.key,i.data.value)}),t}function KV(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||e===null}function JV(e){return Array.isArray(e)}function $V(e){return typeof e=="object"&&e!==null}async function ej(e,t,i=new AbortController){var o,l,h;let r,s=e.url,a=((o=e.proxy)==null?void 0:o.enabled)??!1;if(a)s=`https://apis.spline.design/file/${e.proxy.fileId}/external-api/request?uuidexternalapi=${e.proxy.proxyId}`;else if(((l=e.integration)==null?void 0:l.type)==="OpenAI"){let c=J0(e.integration.prompt===""?[]:JSON.parse(e.integration.prompt),t),d=e.integration.behavior===""?[]:J0(JSON.parse(e.integration.behavior),t);r=`{
			"model": "${e.integration.model}",
			"messages": [${e.integration.useBehavior?`
			{
				"role": "system",
				"content": "${d}"
			},`:""}
			{
				"role": "user",
				"content": "${c}"
			}
			]
		}`}else e.method==="POST"&&e.body&&(r=J0(JSON.parse(e.body),t));let n=await fetch(s,{method:a?"GET":e.method,headers:a?void 0:ZV(e),signal:i.signal,body:r});if(!n.ok)throw new Error("status:"+n.status+"_:_"+n.statusText);if(((h=e.integration)==null?void 0:h.type)==="OpenAI"){let c=await n.json();return a&&(c=c.response),{content:c.choices[0].message.content}}else{let c=await n.json();return a&&(c=c.response),c}}var Ux=(e,t)=>{if(typeof e=="string"){let i=t.getVariable(e);if(i)return Ux(i,t)}return n1.isBoolean(e)?n1.getDisplayedValue(e).toLowerCase():n1.getDisplayedValue(e)},J0=(e,t)=>e.map((i,r)=>{if("text"in i)return i.text;if("type"in i){if(i.type==="paragraph")return(r>0?`
`:"")+J0(i.children,t);if(i.type==="variable"){let s=t.getVariable(i.variableId);if(s!==void 0)return Ux(s,t)}}return""}).join(""),tj=["+","-","*","/","(",")","==","!=",">","<",">=","<=","and","or","!","%","^",","],ij=["0","1","2","3","4","5","6","7","8","9","."],rj=["sin","cos","tan","asin","acos","atan","atan2","sqrt","abs","log","exp","floor","ceil","round","min","max","random"];function sj(e){return typeof e!="string"?!1:!isNaN(e)&&!isNaN(parseFloat(e))}fl.addBinaryOp("^",11,!0);function Nx(e,t,i="number"){let r="";for(let n=0;n<e.length;n++){let o=e[n];if("objType"in o&&o.objType==="api"){let l=JSON.parse(o.id),h=l[0],c=t.getUserAPI(h);if(c!==void 0&&c instanceof kx){let d=c.retrieveValue(l.slice(1));d!==void 0&&(r+=d)}continue}if("objType"in o&&o.objType==="webhook"){let l=JSON.parse(o.id),[h,c]=l,d=t.getUserWebhook(h);if(d!==void 0){let u=d.getParameterValue(c);u!==void 0&&(r+=u)}continue}if("objType"in o&&o.objType==="aiAssistant"){let l=t.openAIRealtime;if("objId"in o&&o.objId!==void 0){let h;if(t.scene.data.objects.traverse((c,d)=>{var p;let u=(p=d.events)==null?void 0:p.find(f=>f.id===o.objId);u&&(h=u)}),h!==void 0&&h.data.type==="AIAssistantListener"){let c=l==null?void 0:l.computeAnalysisForListenerEvent(h.data);if(c!==void 0){r+=c;continue}}}r+=(l==null?void 0:l.voice)??0;continue}if("id"in o){let l=e[n-1];if(n>0&&"id"in l)return;let h=t.getVariable(o.id),c=n1.getDisplayedValue(h);i==="number"&&n1.isTextValue(h)&&Array.isArray(h.textValue)&&h.textValue.length===1?c=parseFloat(c).toString():i==="boolean"&&n1.isBoolean(h)?c=h?"true":"false":i==="boolean"&&n1.isTextValue(h)&&!Array.isArray(h.textValue)&&(c='"'+c+'"'),r+=c;continue}else if(i==="string"){o.name!=='"'&&(o.name!=="+"||o.escaped)&&(r+=o.name),o.name==="+"&&!o.escaped&&r[r.length-1]==="\\"&&(r=r.slice(0,-1)+o.name);continue}if(o.name==="and"){r+="&&";continue}if(o.name==="or"){r+="||";continue}if(o.name==="True"){r+="true";continue}if(o.name==="False"){r+="false";continue}if(i==="boolean"&&!sj(o.name)&&!ij.includes(o.name)&&!tj.includes(o.name)&&!rj.includes(o.name.replace(/\($/g,""))){r+='"'+o.name+'"';continue}r+=o.name}if(i==="string")return r;if(e.length===0){if(i==="number")return 0;if(i==="boolean")return!1}let s;try{s=fl(r)}catch(n){return}let a;try{a=Pt(s)}catch(n){}return a}function Pt(e){switch(e.type){case"BinaryExpression":switch(e.operator){case"==":return+(Pt(e.left)===Pt(e.right));case"!=":return+(Pt(e.left)!==Pt(e.right));case">":return+(Pt(e.left)>Pt(e.right));case">=":return+(Pt(e.left)>=Pt(e.right));case"<":return+(Pt(e.left)<Pt(e.right));case"<=":return+(Pt(e.left)<=Pt(e.right));case"+":return Pt(e.left)+Pt(e.right);case"-":return Pt(e.left)-Pt(e.right);case"*":return Pt(e.left)*Pt(e.right);case"/":return Pt(e.left)/Pt(e.right);case"%":return Pt(e.left)%Pt(e.right);case"&&":return Pt(e.left)&&Pt(e.right);case"||":return Pt(e.left)||Pt(e.right);case"^":return Math.pow(Pt(e.left),Pt(e.right));default:throw new Error("Unknown operator: "+e.operator)}case"UnaryExpression":switch(e.operator){case"-":return-Pt(e.argument);case"!":return+!Pt(e.argument);default:throw new Error("Unknown operator: "+e.operator)}case"Identifier":throw new Error("Unknown identifier: "+e.name);case"Literal":return e.value;case"CallExpression":if(e.callee.type==="Identifier"){if(e.callee.name==="random"){let t=0,i=1;if(e.arguments.length>=1)try{t=Pt(e.arguments[0])}catch(r){}if(e.arguments.length>=2)try{i=Pt(e.arguments[1])}catch(r){}return t=Math.min(i,t),i=Math.max(i,t),t+Math.random()*(i-t)}return Math[e.callee.name].apply(null,e.arguments.map(Pt))}else throw new Error("Unknown node");default:throw new Error("Unknown node type: "+e.type)}}var aj=new we,nj=new we;function oj(e,t,i){let r=[new E,new E,new E],s=[new E,new E,new E];return e.extractBasis(r[0],r[1],r[2]),t.extractBasis(s[0],s[1],s[2]),r.forEach((a,n)=>{let o=s[n],l=Oe.lerp(a.length(),o.length(),i);a.lerp(o,i).setLength(l)}),new we().makeBasis(r[0],r[1],r[2])}var lj=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters),r=Math.abs(i.width),s=Math.abs(i.height??i.width),a=Math.abs(i.depth??0),n=(t==null?void 0:t.shapeData)??Q4.create({parameters:lx}).userData.shape;return{path:e.path??Uc.defaultData(),parameters:Object.assign(i,{width:r,height:s,depth:a,extrusion:{...hx,...i.extrusion}}),shapeData:n}}static build(e){if(e.path.points.length>=2){let t=new hj(e);return Object.assign(t,{userData:{...e,type:"PathGeometry"}})}else return Object.assign(new Ge,{userData:{...e,type:"PathGeometry"}})}},hj=class extends Ge{constructor(e){super(),this.type="PathExtrusionGeometry",this.inputs=e,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let e=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&e.depth===1)||!BV(e.twist,0)||e.startScale!==e.endScale}build(){let e=this._extractPathPoints();if(e.length<2)return;let t=this._computeBasisMatrices(e),{depth:i,offset:r}=this.inputs.parameters.extrusion;i=Math.max(0,Math.min(i,1)),r=Math.max(0,Math.min(r,1));let s=this.inputs.path.isClosed?e.length:e.length-1,a=Math.floor(r*s),n=this.inputs.path.isClosed?Math.ceil((i+r)*s):Math.ceil(Math.min(1,i+r)*s),o=Math.min(Math.max(2,n-a+1),s+2),l=[],h=[];for(let U=0;U<o;U++){let F=this.inputs.path.isClosed?(U+a)%e.length:Math.min(U+a,e.length-1);l.push(e[F].clone()),h.push(t[F].clone())}let c=(U,F,Z)=>{l[U]=l[U].clone().lerp(l[F],Z),h[U]=oj(h[U],h[F],Z)},d=0,u=r*s%1;(!this.inputs.path.isClosed||i<=1)&&(u||r===0)&&(d=u,c(0,1,d));let p=0,f=(r+i)*s%1;if((this.inputs.path.isClosed&&i<=1||!this.inputs.path.isClosed&&r+i<1)&&f&&(p=f,c(l.length-1,l.length-2,1-p)),i===0){let U=l.length-1;l[U].copy(l[0]),h[U].copy(h[0])}this._applyPathModifiers(h,d,p);let{bevel:g,bevelSides:m}=this.inputs.parameters.extrusion,v=g>0?this.inputs.parameters.extrusion.capType:"flat",y=5;this.inputs.parameters.extrusion.shape.type==="Custom"&&(y=this.inputs.parameters.extrusion.shape.shapeQuality==="low"?5:12);let{regions:x,infos:w,vertices:_}=this._computeShapePoints(y),b=0,A;v==="round"&&(A=new X4(this.inputs.shapeData,2*g,g,y,m,void 0,!0),b=A.getAttribute("position").count);let S=0,M=0;w.sort((U,F)=>U.start-F.start),w.forEach(U=>{U.verticesStart=S,U.verticesCount=U.continuous.reduce((F,Z,W)=>F+(W===0||!Z?2:1),0),M+=U.verticesCount,S=M});let C=M*o,T,P=0;if(this._isOpenEnded()&&v==="flat"){try{T=Ba({windingRule:Vt.ODD,elementType:Si.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:x})}catch{T=Cx}P=T.vertexCount}let I=C+2*P+b*2,D=C+2*P,k={positions:new Float32Array(I*3),normals:new Float32Array(I*3),uvs:new Float32Array(I*2)},H=[];if(w.forEach(U=>{this._extrudeRegion(U,_,h,l,k,H,this._isGeometryClosed()&&!this._isOpenEnded())}),T&&(this._closeEnd(T,C,H,k,h[0],l[0],!1),this._closeEnd(T,C+P,H,k,h[h.length-1],l[l.length-1],!0)),A){k.positions.set(A.getAttribute("position").array,D*3),k.normals.set(A.getAttribute("normal").array,D*3),k.uvs.set(A.getAttribute("uv").array,D*2);for(let W=D;W<D+b;W++)k.uvs[W*2+1]=1e-4;let U=H.length;H.push(...A.getIndex().array.map(W=>W+D)),D+=b,k.positions.set(A.getAttribute("position").array,D*3),k.normals.set(A.getAttribute("normal").array,D*3),k.uvs.set(A.getAttribute("uv").array,D*2);let F=H.length;H.push(...A.getIndex().array.map(W=>W+D)),this.setAttribute("position",new ot(k.positions,3)),this.setAttribute("normal",new ot(k.normals,3)),this.setAttribute("uv",new ot(k.uvs,2)),this.setIndex(H);let Z=aj;Z.copy(h[h.length-1]).setPosition(l[l.length-1]),this.applyMatrix4OnRange(Z,D,I),Z.copy(h[0]).setPosition(l[0]).multiply(nj.makeScale(1,1,-1)),this.applyMatrix4OnRange(Z,D-b,D),this.reverseIndicesOnRange(U,F)}else this.setAttribute("position",new ot(k.positions,3)),this.setAttribute("normal",new ot(k.normals,3)),this.setAttribute("uv",new ot(k.uvs,2)),this.setIndex(H)}_extractPathPoints(){let e=yx(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(e.length<2)return[];let t=[e[0]];return e.forEach(i=>{t[t.length-1].distanceToSquared(i)>.001&&t.push(i)}),this.inputs.path.isClosed&&t[t.length-1].distanceTo(t[0])<.001&&t.pop(),t}_computeBasisMatrices(e){let t=[],i=e.length,r=this.inputs.path.isClosed,s=new E,a=new E,n=new E,o=new E,l=new E(0,1,0);for(let f=0;f<i;f++){let g=e[f],m;f===0?m=r?e[e.length-2]:g.clone().multiplyScalar(2).sub(e[1]):m=e[f-1];let v;f===i-1?v=r?e[1]:g.clone().multiplyScalar(2).sub(e[f-1]):v=e[f+1];let y=g.clone().sub(m).normalize(),x=v.clone().sub(g).normalize(),w=y.clone().add(x).normalize();n.copy(w),f===0&&(w.equals(l)||w.clone().negate().equals(l))&&l.set(0,0,1);let _=l.clone().cross(w).normalize(),b=w.clone().cross(_).normalize();l.copy(b),o.copy(_),f===0&&(s.copy(b),a.copy(w));let A=new we().makeBasis(_,b,w);t.push(A)}let h=r?a:n,c=r?s:new E(0,1,0),d=h.clone().cross(o).normalize(),u=Math.acos(c.dot(d));if(isNaN(u))return t;let p=c.clone().cross(d);h.dot(p)>0&&(u*=-1);for(let f=1;f<t.length;f++){let g=new we().makeRotationZ(u*f/t.length);t[f].multiply(g)}return t}_applyPathModifiers(e,t,i){let r=e.length,{angle:s,twist:a,startScale:n,endScale:o}=this.inputs.parameters.extrusion,l=new we,h=new we;return e.forEach((c,d)=>{let u=d===0?0:d===r-1?1:(d-t)/(r-(i===0?0:1)-(t+(1-i)));l.makeRotationZ(Oe.lerp(s,s+a,u)*Oe.DEG2RAD);let p=Oe.lerp(n,o,u);h.makeScale(p,p,p),c.multiply(l).multiply(h)}),e}_computeShapePoints(e=12,t=Vt.ODD){let i=this.inputs.shapeData,r=i.extractShapePointsToFlatArray([],e),s=i.shapeHoles.map(h=>{let c=h.extractShapePointsToFlatArray([],e),d=[];for(let u=c.length-1;u>=1;u-=2){let p=c[u-1],f=c[u-0];d.push(p,f)}return d}),a;try{a=Ba({windingRule:t,elementType:Si.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[r]})}catch{a=Y4}let n;try{n=Ba({windingRule:Vt.ODD,elementType:Si.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...s]})}catch{n=Ex}if(!a)throw new Error("error generating geometry");let o=a.elementCount;if(n){a.elementCount+=n.elementCount;for(let h=0;h<n.elements.length;h++){let c=n.elements[h],d=h%2===0?a.vertexCount:0;a.elements.push(c+d)}for(let h=0;h<n.vertexIndices.length;h++){let c=n.vertexIndices[h],d=a.vertexCount;a.vertexIndices.push(c+d)}for(let h=0;h<n.vertices.length;h++){let c=n.vertices[h];a.vertices.push(c)}}for(let h=0,c=a.vertexCount;h<c;h++){let d=h*2;a.vertices[d+0],a.vertices[d+1]}let l=[];for(let h=a.elementCount-1;h>=0;h--){let c=h>=o,d=h*2,u=a.elements[d+0],p=a.elements[d+1],f=u+p,g={start:u,count:p,normals:[],isHole:c,continuous:[],verticesStart:0,verticesCount:0};l.push(g);let m=u,v=f-1,y=u+1,x=i.roundedCurves.length;do{let w=m-u;a.vertices[v*2+0],a.vertices[v*2+1];let _=a.vertices[m*2+0],b=a.vertices[m*2+1],A=a.vertices[y*2+0],S=a.vertices[y*2+1],M=_-A,C=b-S,T=Math.sqrt(M*M+C*C);M/=T,C/=T,g.normals[w*2+0]=-C,g.normals[w*2+1]=M;let P=a.vertexIndices[m];if(Array.isArray(P))g.continuous[w]=!1;else{let[I,D]=i.getCurveIndexFromVertexId(P-1,!0);if(D>0&&D<1)g.continuous[w]=!0;else{let k=D===1?I+1:I-1;k=(k+x)%x;let H=D===1?0:1,U=i.roundedCurves[I].getTangent(D),F=i.roundedCurves[k].getTangent(H);g.continuous[w]=U.dot(F)>.95}}c&&(g.normals[w*2+0]*=-1,g.normals[w*2+1]*=-1),[v,m,y]=[m,y,y+1],y>=f&&(y-=p)}while(y!==u+1)}return{regions:[r,...s],infos:l,vertices:a.vertices}}_insertVertex(e,t,i,r,s){let a=t*2,n=t*3;e.positions[n+0]=i.x,e.positions[n+1]=i.y,e.positions[n+2]=i.z,e.normals[n+0]=r.x,e.normals[n+1]=r.y,e.normals[n+2]=r.z,e.uvs[a+0]=s.x,e.uvs[a+1]=s.y}_extrudeRegion(e,t,i,r,s,a,n){let o=new E,l=new E,h=new E,c=new E,d=new j;i.forEach((p,f)=>{let g=r[f],m=e.verticesStart*i.length+e.verticesCount*f;for(let v=0;v<e.count;v++){let y=(e.start+v)*2;if(o.set(t[y+0],t[y+1],0),h.copy(o).applyMatrix4(p).add(g),e.continuous[v])c.set(e.normals[v*2+0],e.normals[v*2+1],0);else{let x=v===0?(e.start+e.count-1)*2:y-2;l.set(t[x+0],t[x+1],0),c.copy(o).sub(l),c.set(-c.y,c.x,0),e.isHole||c.negate()}if(c.applyMatrix4(p).normalize(),d.set(v===0?1:v/e.count,f/(i.length-1)),this._insertVertex(s,m,h,c,d),m++,!e.continuous[v]||v===0){if(v===0)c.set(e.normals[v*2+0],e.normals[v*2+1],0),d.set(0,f/(i.length-1));else{let x=v===e.count-1?e.start*2:y+2;l.set(t[x+0],t[x+1],0),c.copy(l).sub(o),c.set(-c.y,c.x,0),e.isHole||c.negate()}c.applyMatrix4(p).normalize(),this._insertVertex(s,m,h,c,d),m++}}});let u=i.length-1;for(let p=0;p<u;p++){let f=e.verticesStart*i.length+e.verticesCount*p,g=e.verticesStart*i.length+e.verticesCount*(p+1),m=0;for(let v=0;v<e.count;v++){(!e.continuous[v]||v===0)&&m++;let y=v===e.count-1?0:m+1,x=f+m,w=f+y,_=g+y,b=g+m;e.isHole?a.push(x,_,w,x,b,_):a.push(x,w,_,x,_,b),m++}}}_closeEnd(e,t,i,r,s,a,n){let o=e.vertexCount,l=new E(0,0,n?-1:1).applyMatrix4(s),h=new E,c=new j;for(let u=0;u<o;u++){let p=2*u;h.set(e.vertices[p+0],e.vertices[p+1],0).applyMatrix4(s).add(a),this._insertVertex(r,t+u,h,l,c)}let d=e.elements;for(let u=0;u<e.elementCount;u++){let p=3*u,f=d[p+0]+t,g=d[p+(n?1:2)]+t,m=d[p+(n?2:1)]+t;i.push(f,g,m)}}applyMatrix4OnRange(e,t,i){let r=e.elements,s=new Ai().getNormalMatrix(e).elements,a,n,o,l,h=this.attributes.position,c=this.attributes.normal;if(!h||!c)return;let d=h.array,u=c.array,p=h.itemSize;for(let f=t*p,g=i*p;f<g;f+=p)a=d[f+0],n=d[f+1],o=d[f+2],l=1/(r[3]*a+r[7]*n+r[11]*o+r[15]),d[f+0]=(r[0]*a+r[4]*n+r[8]*o+r[12])*l,d[f+1]=(r[1]*a+r[5]*n+r[9]*o+r[13])*l,d[f+2]=(r[2]*a+r[6]*n+r[10]*o+r[14])*l,a=u[f+0],n=u[f+1],o=u[f+2],u[f+0]=s[0]*a+s[3]*n+s[6]*o,u[f+1]=s[1]*a+s[4]*n+s[7]*o,u[f+2]=s[2]*a+s[5]*n+s[8]*o;h.needsUpdate=!0,c.needsUpdate=!0}reverseIndicesOnRange(e,t){let i=this.index;if(i){for(let r=e;r<t;r+=3){let s=i.getX(r),a=i.getX(r+1),n=i.getX(r+2);i.setXYZ(r,n,a,s)}i.needsUpdate=!0}}};function Vx(){let e=new Ge;return e.setAttribute("position",new ot(new Float32Array([]),3)),e.setIndex(new ot(new Uint16Array([]),1)),e}var cj=Vx().attributes,dj=12,uj=1,gf=class extends Ge{constructor(e,t){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,cj),this.userData={parameters:e,type:"TextGeometry"};let i=t.getFont(e.font);i!=null&&i.isLoaded?(this.font=i,this.update(e)):this.updateFont(e.font,t).then(()=>{this.update(e),t==null||t.requestRender()})}async updateFont(e,t){let i=t.getFont(e);i&&(this.font=i,await i.loadingPromise)}update(e){let t=this.font;if(this.userData={parameters:e,type:"TextGeometry"},!(t!=null&&t.isLoaded))return;let{width:i,height:r,depth:s,extrudeBevelSize:a,extrudeBevelSegments:n,text:o,textTransform:l}=e,h=n1.getDisplayedValue(o),c=l===2?h.toUpperCase():l===3?h.toLowerCase():h,d=pj(e,t,c),{shapes:u,charWidths:p,charCoords:f}=t.generateShapes(d,e),g=(typeof i=="number"?i:1)*.5,m=(typeof r=="number"?r:1)*.5,v=u.map(w=>new hi().fromShape(w,!0));this.vectorShapes=v;let y=v.map(w=>Wn.create({shape:w,parameters:{depth:s,extrudeBevelSegments:n,extrudeBevelSize:a,windingRule:s<=0?Vt.NONZERO:Vt.ODD,subdivisions:this.isLowResolution&&s>0?uj:dj}})),x=y.length?An(y):Vx();x.translate(-g,m,0),this.dispose(),this.wrappedText=d,this.charCoords=f,this.charWidths=p,this.deleteAttribute("extrudeNormal"),Object.entries(x.attributes).forEach(([w,_])=>{this.setAttribute(w,_)}),this.setIndex(x.index),this.computeBoundingSphere()}clone(){let e=ur(new Ge,gf.prototype);return e.copy(this),e}copy(e){return Object.entries(e.attributes).forEach(([t,i])=>{this.setAttribute(t,i)}),this.setIndex(e.index),this.userData={parameters:{...e.userData.parameters},type:"TextGeometry"},this}async setText(e){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:{textValue:e}})}get text(){return this.userData.parameters.text??""}};function pj(e,t,i){let r=[""],s="";for(let a of i)s+=a,a===" "||a===`
`?(r[r.length-1]+=s,s="",a===`
`&&r.push("")):t.getTextWidth(r[r.length-1]+s,e)>e.width&&(r[r.length-1].length&&r.push(""),t.getTextWidth(r[r.length-1]+s,e)>e.width&&(s.length===1?(r[r.length-1]+=s,s=""):(r[r.length-1]+=s.slice(0,-1),s=s[s.length-1],r.push(""))));return r[r.length-1]+=s,r}var jx,Gx=new Promise(e=>{jx=e}),Cg=!1,y0;function fj(){if(Cg)return;if(y0)return y0;async function e(){let t="https://unpkg.com/@splinetool/modelling-wasm@1.9.37/build",i=Ya(()=>import("./B9H0U9ag.js"),[],import.meta.url),[r,s]=await Promise.all([i,fetch(`${t}/process.wasm`).then(o=>o.arrayBuffer())]),a=r.default,n=await a({wasmBinary:s});jx(n),Cg=!0}return y0=e(),y0}var mj=["font"];function $2(e,t,i,r){var h,c;let s,a,n;e.type==="PathGeometry"?(a=JSON.parse(JSON.stringify(e)),n=[[],["extrusion"]]):(a={...e},n=[[]]);for(let d of n){let u=a;for(let p of d)u=u[p];for(s in u){let p=u[s];D9(p)&&!mj.includes(s)&&(u[s]=t.getVariable(p,[r.uuid,"geometry",...d,s]),D9(u[s])&&(u[s]=1))}}let o={parameters:a,type:a.type};if(a.type==="PathGeometry")o.path=a.path;else if(a.type==="VectorGeometry"){let d=hi.createFromState(a.shape,a.width,a.height);o.shape=d}else if(a.type==="NonParametricGeometry"){if(a.data.groups&&((h=a.data.groups)==null||h.forEach(d=>d.materialIndex=Math.max(d.materialIndex??0,0))),o.geometry=new Vv().parse(a),o.geometry.groups.length===0){let d=o.geometry;d.addGroup(0,Math.max(((c=d.getIndex())==null?void 0:c.count)??0,d.getAttribute("position").count),0)}}else if(a.type==="SubdivGeometry"){let d=new M1(a,i);return d.data=e,d}else{if(a.type==="TextGeometry")return new gf(a,t);if(a.type==="InputGeometry")return new gf(a,t);if(a.type==="UIGeometry")return Z4.create({parameters:{width:a.width,height:a.height,cornerRadius:a.cornerRadius,cornerType:a.cornerType}})}let l;try{l=Og(o)}catch(d){}if(!l){let d=hi.createFromState(kc.defaultData(),100,100);o.shape=d,l=Og(o)}return l}var gj=new we;function vf(e,t,i,r){let s=e.position.array,a=e.normal.array,n=gj.makeScale(t,i,r).invert().elements,o,l,h;for(var c=0,d=s.length;c<d;c+=3)s[c]*=t,s[c+1]*=i,s[c+2]*=r,o=a[c],l=a[c+1],h=a[c+2],a[c]=n[0]*o+n[4]*l+n[8]*h,a[c+1]=n[1]*o+n[5]*l+n[9]*h,a[c+2]=n[2]*o+n[6]*l+n[10]*h;e.position.needsUpdate=!0,e.normal.needsUpdate=!0}var x0=new vi,go=new E,et;Gx.then(e=>{et=e});var Tg=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),Pg=new Uint32Array([0,1,2,3]),Dg=new Uint8Array([4]),M1=class extends Ge{constructor(e,t){super(),this.data=e,this.flatShading=t,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(e,t){this.freeSubdivPointer();let i=this.data.scaleBaked,r=In.div(t,i);this.subdividedGeometry&&vf(this.subdividedGeometry.attributes,...r),this.originalGeometry&&vf(this.originalGeometry.attributes,...r),this.data=e;let s=this.userData.parameters;this.userData.parameters={width:s.width*r[0],height:s.height*r[1],depth:s.depth*r[2]},this.originalGeometry.boundingSphere.center.multiply(go.fromArray(r));let a=go.set(s.width,s.height,s.depth).length();this.originalGeometry.boundingSphere.radius=a/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let e,t,i;try{({originalGeometry:e,subdividedGeometry:t,subdivPointer:i}=M1.build(this.data,void 0,!this.flatShading,void 0))}catch{e=new Lr(100,100,100),i=0}this.subdivPointer=i,this.originalGeometry=e,this.subdividedGeometry=t??void 0;let r=this.subdividedGeometry??this.originalGeometry;Object.assign(this,r),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(M1.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new V1,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,i=e.boundingSphere.center;x0.setFromBufferAttribute(t),x0.getCenter(i),e.boundingSphere.radius=i.distanceTo(x0.max),isNaN(e.boundingSphere.radius),x0.getSize(go);let r={width:go.x,height:go.y,depth:go.z};return this.userData.parameters=r,r}static build(e,t,i,r){let s,a,n,o=(e==null?void 0:e.phongAngle)??35;i===!1&&(o=-1),t&&(et.free_bvh(t),et.free_subdivision_surface(t));try{s=M1.allocate(e,r)}catch(l){s=M1.allocate({positionWASM:Tg,indexWASM:Pg,verticesPerFaceWASM:Dg},r)}if(et.set_destination_refinement_level(s,0),a=M1.buildLevel(s,!0,o),e.subdivisions>0)try{et.set_destination_refinement_level(s,e.subdivisions),n=M1.buildLevel(s,!1,o)}catch{try{et.set_destination_refinement_level(s,e.subdivisions-1),n=M1.buildLevel(s,!1,o)}catch{n=null}}else n=null;return{subdivPointer:s,originalGeometry:a,subdividedGeometry:n}}static primitiveToQuads(e,t,i){e.widthSegments>16&&(e.widthSegments=16),e.heightSegments>16&&(e.heightSegments=16),e.depthSegments>16&&(e.depthSegments=16),e.radialSegments>16&&(e.radialSegments=16),e.type==="DodecahedronGeometry"&&(e.detail=0);let r=e.shape!==void 0||e.path!==void 0?t.geometry:$2(e,i,!1),s;e.type==="TorusGeometry"&&e.arc===Math.PI*2?s=r.getClosedTorusIndicesForBooleanOrSubdiv():s=r.getIndex();let a,n,o,l;({positions:a,triIndices:l}=Od(r.getAttribute("position"),s));let h;if(e.type==="CylinderGeometry"&&e.cornerRadius===0&&e.hollow===0&&e.openEnded===!1){let c=e.radialSegments*e.heightSegments*3*2,d=c+e.radialSegments*3;h=[c,d]}return{indices:n,verticesPerFace:o}=Hx(a,l,r,h),{positions:a,indices:n,verticesPerFace:o}}static allocate(e,t){var x;let i,r,s,a=[],n=[];e.positionWASM&&e.positionWASM.length>0?(i=e.positionWASM,r=e.indexWASM,s=e.verticesPerFaceWASM):(i=Tg,r=Pg,s=Dg);let o=i.length,l=r.length,h=s.length,c=i.length+a.length+n.length,d=r.length+s.length,u=c*Float32Array.BYTES_PER_ELEMENT+d*Uint32Array.BYTES_PER_ELEMENT,p=c*Float32Array.BYTES_PER_ELEMENT,f=et._malloc(u),g=new Float32Array(et.HEAPF32.buffer,f,c),m=new Uint32Array(et.HEAPU32.buffer,f+p,d);g.set(i,0),g.set(a,i.length),g.set(n,i.length+a.length),m.set(r,0),m.set(s,r.length);let v;(x=e==null?void 0:e.scaleBaked)!=null&&x.some(w=>w!==1)&&(v=new we().makeScale(...e.scaleBaked)),t&&(v?v.premultiply(t):v=t);let y=v?et.alloc_subdivision_surface2(f,o,f+p,l,f+p+r.length*Uint32Array.BYTES_PER_ELEMENT,h,v.elements):et.alloc_subdivision_surface(f,o,f+p,l,f+p+r.length*Uint32Array.BYTES_PER_ELEMENT,h);return et._free(f),y}static buildLevel(e,t,i,r,s){let a=s?et.get_mesh_data2(e,t?et.Level.CONTROL:et.Level.REFINED,i,s.elements):et.get_mesh_data(e,t?et.Level.CONTROL:et.Level.REFINED,i),n=8,o=et.HEAPU32.subarray(a>>2,(a>>2)+n),l=o.subarray(4,8),h=0,c=et.HEAPU32[o[h]>>2],d=et.HEAPF32.subarray(c>>2,(c>>2)+l[h]);h++;let u=et.HEAPU32[o[h]>>2],p=et.HEAPF32.subarray(u>>2,(u>>2)+l[h]);h++;let f=et.HEAPU32[o[h]>>2],g=et.HEAPU32.subarray(f>>2,(f>>2)+l[h]);h++;let m=et.HEAPU32[o[h]>>2],v=et.HEAPU32.subarray(m>>2,(m>>2)+l[h]);if(h++,r===void 0){let y=new Ge;if(y.setIndex(new Vo(v,1)),y.setAttribute("position",new De(d,3)),y.setAttribute("normal",new De(p,3)),t){y.setAttribute("faceMap",new Vo(g,1));let x=new Float32Array(p.length/3*4).fill(0);y.setAttribute("color",new ot(x,4))}return et.free_mesh_data(a),y.userData.type="SubdivGeometry",y}r.getAttribute("position").copyArray(d),r.getAttribute("normal").copyArray(p),r.attributes.position.needsUpdate=!0,r.attributes.normal.needsUpdate=!0,et.free_mesh_data(a)}static freeSubdivPointer(e){et.free_bvh(e),et.free_subdivision_surface(e)}static buildControlCageWireframe(e,t,i){let r=et.get_wireframe_data_for_base_level(e),s=4,a=et.HEAPU32.subarray(r>>2,(r>>2)+s),n=a.subarray(2,4),o=0,l=et.HEAPU32[a[o]>>2],h=et.HEAPF32.subarray(l>>2,(l>>2)+n[o]);o++;let c=et.HEAPU32[a[o]>>2],d=et.HEAPU32.subarray(c>>2,(c>>2)+n[o]);if(t===void 0){let u=new Ge;u.setAttribute("position",new De(h,3));let p=new Float32Array(h.length);for(let f=0,g=h.length;f<g;)p[f++]=i.r,p[f++]=i.g,p[f++]=i.b;return u.setAttribute("color",new ot(p,3)),u.setIndex(new Vo(d,1)),et.free_wireframe_data_for_base_level(r),u}t.getAttribute("position").copyArray(h),t.attributes.position.needsUpdate=!0,et.free_wireframe_data_for_base_level(r)}static updateCollabMesh(e,t,i){let r=t===0;r||et.set_destination_refinement_level(e,t);let s=i?et.get_topological_data2(e,r?et.Level.CONTROL:et.Level.REFINED,i.elements):et.get_topological_data(e,r?et.Level.CONTROL:et.Level.REFINED),a=6,n=et.HEAPU32.subarray(s>>2,(s>>2)+a),o=n.subarray(3,6),l=0,h=et.HEAPU32[n[l]>>2],c=new Float32Array(et.HEAPF32.subarray(h>>2,(h>>2)+o[l]));l++;let d=et.HEAPU32[n[l]>>2],u=new Uint32Array(et.HEAPU32.subarray(d>>2,(d>>2)+o[l]));l++;let p=et.HEAPU32[n[l]>>2],f=new Uint8Array(et.HEAPU32.subarray(p>>2,(p>>2)+o[l]));return et.free_topological_data(s),{positions:c,indices:u,verticesPerFace:f}}},Ig=["getX","getY","getZ"];function Od(e,t){let i={},r=t?t.count:e.count,s=0,a=[],n=[],o=1e4;for(let h=0;h<r;h++){let c=t?t.getX(h):h,d="";for(let u=0;u<3;u++)d+=`${~~(e[Ig[u]](c)*o)},`;if(d in i)a.push(i[d]);else{for(let u=0;u<3;u++)n.push(e[Ig[u]](c));i[d]=s,a.push(s),s++}}let l=[];for(let h=0;h<a.length;h+=3)a[h]===a[h+1]||a[h]===a[h+2]||a[h+1]===a[h+2]||l.push(a[h],a[h+1],a[h+2]);return{positions:n,triIndices:l}}var b0=new E,rp=new E,sp=new E,ap=new E;function Hx(e,t,i,r){let s=[],a=[];if(i.userData.shape!==void 0&&i.userData.parameters.depth===0&&i.userData.shape.shapeHoles.length===0){let l=i.userData.shape.extractShapePointsToFlatArray([]),h=i.userData.parameters.spikes;if(i.userData.type==="EllipseGeometry"&&h<=24&&h%4===0&&i.userData.parameters.angle>=360){let u=l.length/2/h;l=l.filter((p,f)=>Math.floor(f/2)%u===0)}let c=0;for(let u=0;u<l.length;u+=2)c+=(l[u]-l[(u===0?l.length:u)-2])*(l[u+1]+l[(u===0?l.length:u)-1]);e.length=0;let d=0;if(c<0)for(let u=0;u<l.length;u+=2)e.push(l[u],l[u+1],0),s.push(d++);else for(let u=l.length-2;u>=0;u-=2)e.push(l[u],l[u+1],0),s.push(d++);return a.push(d),{indices:s,verticesPerFace:a}}let n=new Float32Array([i.userData.parameters.depth])[0],o=0;for(;o<t.length;){if(i.useNgonForTopBottomFaceDuringBake){let l=0;if((e[t[o]*3+2]===n||e[t[o]*3+2]===0)&&l++,(e[t[o+1]*3+2]===n||e[t[o+1]*3+2]===0)&&l++,(e[t[o+2]*3+2]===n||e[t[o+2]*3+2]===0)&&l++,l===3)break}if(t[o+1]===t[o+3]&&t[o+2]===t[o+5]||t[o+0]===t[o+3]&&t[o+2]===t[o+4]){b0.set(e[t[o]*3],e[t[o]*3+1],e[t[o]*3+2]),rp.set(e[t[o+1]*3],e[t[o+1]*3+1],e[t[o+1]*3+2]),sp.set(e[t[o+4]*3],e[t[o+4]*3+1],e[t[o+4]*3+2]),ap.set(e[t[o+5]*3],e[t[o+5]*3+1],e[t[o+5]*3+2]),rp.sub(b0).normalize(),sp.sub(b0).normalize(),ap.sub(b0).normalize();let l=rp.cross(sp).dot(ap);Math.abs(l)>.005||r&&r.some((h,c)=>c%2===1?!1:o>=r[c]&&o<r[c+1])?(s.push(t[o],t[o+1],t[o+2]),a.push(3),o+=3):(s.push(t[o],t[o+1],t[o+4],t[o+5]),a.push(4),o+=6)}else s.push(t[o],t[o+1],t[o+2]),a.push(3),o+=3}if(i.useNgonForTopBottomFaceDuringBake){let l=[],h=[],c=0;for(let d=0,u=0;d<e.length;d+=3,u++)e[d+2]===0&&(l.push(u),c++),e[d+2]===n&&h.push(u);if(i.userData.parameters.extrudeBevelSize===0){let d=h[0];h[0]=h[1],h[1]=d}l.reverse(),s.push(...l,...h),a.push(c,c)}return{indices:s,verticesPerFace:a}}var Bs={};cS(Bs,{calcBoolean:()=>wj,calcBooleanTopological:()=>bj,freeMeshSet:()=>Mj,getMeshSet:()=>Sj,hasOpenEdges:()=>_j,transformMeshSet:()=>Aj});var Wx,vj=new Promise(e=>{Wx=e}),w0;function yj(){if(w0)return w0;async function e(){let t="https://unpkg.com/@splinetool/boolean-wasm@1.9.37/build",i=Ya(()=>import("./BpCokwB2.js"),[],import.meta.url),[r,s]=await Promise.all([i,fetch(`${t}/boolean.wasm`).then(o=>o.arrayBuffer())]),a=r.default,n=await a({wasmBinary:s});Wx(n)}return w0=e(),w0}var bt,Xo;vj.then(e=>bt=e);function xj(e,t,i){let r,s;e.userData.parameters.type==="TorusGeometry"&&e.userData.parameters.arc===Math.PI*2?s=e.getClosedTorusIndicesForBooleanOrSubdiv():s=e.getIndex();let{positions:a,triIndices:n}=Od(e.getAttribute("position"),s),o;if(t&&i){let{indices:l,verticesPerFace:h}=Hx(a,n,e);o=h.length,r=[];for(let c=0,d=0;c<o;c++){r.push(h[c]);for(let u=0;u<h[c];u++)r.push(l[d++])}}else{let l=n.length;r=Array(l+l/3),o=0;for(let h=0,c=0;c<r.length;)r[c++]=3,o++,r[c++]=n[h++],r[c++]=n[h++],r[c++]=n[h++]}return{positions:a,faceIndices:r,nFaces:o}}function qx(e){let t=e.length,i=t*Uint32Array.BYTES_PER_ELEMENT,r=t*Float32Array.BYTES_PER_ELEMENT,s=Number.isInteger(e[0])?i:r,a=bt._malloc(s);return(Number.isInteger(e[0])?new Uint32Array(bt.HEAPU32.buffer,a,t):new Float32Array(bt.HEAPF32.buffer,a,t)).set(e,0),a}function Yx(e){switch(e){case 0:return bt.OP.UNION;case 1:return bt.OP.INTERSECTION;case 2:return bt.OP.A_MINUS_B;case 3:return bt.OP.B_MINUS_A;case 4:return bt.OP.SYMMETRIC_DIFFERENCE;case 5:return bt.OP.ALL;default:throw new Error("Unknown boolean operation "+e)}}function bj(e,t){Xo===void 0&&(Xo=bt.init_csg());let i=qx(e),r=bt.csg_calc_topological(Xo,i,e.length,Yx(t));bt._free(i);let s=6,a=bt.HEAPU32.subarray(r>>2,(r>>2)+s),n=a.subarray(3,6),o=0,l=bt.HEAPU32[a[o]>>2],h=new Float32Array(bt.HEAPF32.subarray(l>>2,(l>>2)+n[o]));o++;let c=bt.HEAPU32[a[o]>>2],d=new Uint32Array(bt.HEAPU32.subarray(c>>2,(c>>2)+n[o]));o++;let u=bt.HEAPU32[a[o]>>2],p=new Uint8Array(bt.HEAPU32.subarray(u>>2,(u>>2)+n[o]));return bt.free_mesh_data(r),{positions:h,indices:d,verticesPerFace:p}}function wj(e,t,i,r){Xo===void 0&&(Xo=bt.init_csg());let s=qx(e),a=bt.csg_calc(Xo,s,e.length,r,Yx(t));bt._free(s);let n=5,o=bt.HEAPU32.subarray(a>>2,(a>>2)+n),l=o.subarray(2,5),h=0,c=bt.HEAPU32[o[h]>>2],d=bt.HEAPF32.subarray(c>>2,(c>>2)+l[h]);h++;let u=bt.HEAPU32[o[h]>>2],p=bt.HEAPF32.subarray(u>>2,(u>>2)+l[h]);h++;let f=l[h];i.setAttribute("position",new De(d,3)),i.setAttribute("normal",new De(p,3));let g=bt.HEAPF32.subarray((a>>2)+5,(a>>2)+5+6);return i.boundingSphere===null&&(i.boundingSphere=new V1),i.boundingSphere.center.set(g[0],g[1],g[2]),i.boundingSphere.radius=(g[3]**2+g[4]**2+g[5]**2)**.5,i.userData.parameters={width:g[3]*2,height:g[4]*2,depth:g[5]*2},bt.free_mesh_data(a),f}function Sj(e,t,i){if(bt===void 0)return-1;let r,s,a;if(t&&e.userData.positions!==void 0){let m=e.userData;a=m.verticesPerFace.length,r=m.positions,s=Array(m.verticesPerFace.reduce((v,y)=>v+y,0)+a);for(let v=0,y=0,x=0;v<m.verticesPerFace.length;v++){s[x++]=m.verticesPerFace[v];for(let w=0;w<m.verticesPerFace[v];w++)s[x++]=m.indices[y++]}}else({positions:r,faceIndices:s,nFaces:a}=xj(e,t,i));let n=r.length,o=s.length,l=r.length,h=s.length,c=l*Float32Array.BYTES_PER_ELEMENT+h*Uint32Array.BYTES_PER_ELEMENT,d=l*Float32Array.BYTES_PER_ELEMENT,u=bt._malloc(c),p=new Float32Array(bt.HEAPF32.buffer,u,l),f=new Uint32Array(bt.HEAPU32.buffer,u+d,h);p.set(r,0),f.set(s,0);let g=bt.get_csg_mesh(u,n,u+d,o,a);return bt._free(u),g}function _j(e){return bt.has_open_edges(e)}function Aj(e,t){bt.transform_csg_mesh(e,t.elements)}function Mj(e){bt.free_csg_mesh(e)}var Ej={ConeGeometry:ON,CubeGeometry:RN,CylinderGeometry:xx,DodecahedronGeometry:BN,EllipseGeometry:Q4,HelixGeometry:pV,IcosahedronGeometry:fV,LatheGeometry:mV,NonParametricGeometry:SV,PolygonGeometry:zx,PyramidGeometry:_V,RectangleGeometry:Z4,SphereGeometry:EV,PlaneGeometry:CV,BackdropGeometry:TV,StarGeometry:Fx,TextFrameGeometry:DV,TorusGeometry:IV,TorusKnotGeometry:RV,TriangleGeometry:LV,PathGeometry:lj,VectorGeometry:Wn},Og=e=>Ej[e.type].create(e);function vo(e){return e!==null&&"booleanOp"in e}var Xx=class extends G4(si){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new we}updateVisible(e){super.updateVisible(e),this.visible=!vo(this.parent)&&this.visible,vo(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(Bs.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(e=!1){return e?this.booleanWasTransformed=!0:this.freeBooleanPointer(),vo(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let e of this.children)e instanceof Xx&&(e.freeBooleanPointer(),vo(e)&&e.invalidateUpstreamBooleanData())}updateTransformState(e,t){let i=super.updateTransformState(e,t);return i&&vo(this.parent)&&this.invalidateDownstreamBooleanData(!0),i}onVariableUpdate(e=!1){super.onVariableUpdate(e),vo(this.parent)&&this.invalidateDownstreamBooleanData(!0)}},S0=new vi;function K4(e,t=0,i=e.count,r,s){let a=1/0,n=1/0,o=1/0,l=-1/0,h=-1/0,c=-1/0;for(let d=t;d<i;d++){let u=e.getX(d),p=e.getY(d),f=e.getZ(d);u<a&&(a=u),p<n&&(n=p),f<o&&(o=f),u>l&&(l=u),p>h&&(h=p),f>c&&(c=f)}S0.min.set(a,n,o),S0.max.set(l,h,c),S0.getCenter(r),S0.getSize(s).multiplyScalar(.5)}var Cj=new Ge,Tj=new Js,D1=class extends Xx{constructor(e,t){super(Cj,Tj),this.super_Entity(e,t)}updateState(e,t){this.updateState_Entity(e,t)}updateEntityBoxSize(e,t){let i=this.geometry.getAttribute("position");i!==void 0?K4(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,e,t):super.updateEntityBoxSize(e,t)}},Aa=class{constructor(e){if(this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},Aa.uuidContext===null)throw new Error("plz startContext");Aa.uuidContext===Aa.globalContext?this.uuid="_gid"+Aa.uuidContext.nodeContextUuid++:this.uuid="_uid"+Aa.uuidContext.nodeContextUuid++,this.type=e,this.name=""}static startContext(e){(this.uuidContext===null||this.uuidContext===Aa.globalContext)&&(this.uuidContext=e)}static endContext(e){this.uuidContext,this.uuidContext=null}analyze(e,t){t=t??{},e.analyzing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.analyzing=!1}analyzeAndFlow(e,t,i){return i=i??{},this.analyze(e,i),this.flow(e,t,i)}flow(e,t,i){i=i??{},e.addFlow(i.slot,i.cache,i.context);let r={result:this.build(e,t),code:e.clearNodeCode(),extra:e.context.extra};return e.removeFlow(),r}build(e,t,i){t=t??this.getType(e,t);let r=e.getNodeData(i??this);return e.analyzing&&this.appendDepsNode(e,r,t),e.nodes.indexOf(this)===-1&&e.nodes.push(this),this.updateFrame!==void 0&&e.updaters.indexOf(this)===-1&&e.updaters.push(this),this.generate(e,t,i)}updateFrame(e){}generateReadonly(e,t,i,r,s,a){return""}generate(e,t,i,r,s){return""}parse(e,t,i,r){}appendDepsNode(e,t,i){t.deps=(t.deps||0)+1;let r=e.getTypeLength(i);(r>(t.outputMax||0)||this.getType(e,i))&&(t.outputMax=r,t.output=i)}setName(e){this.name=e}getName(){return this.name}getType(e,t){return t==="sampler2D"||t==="samplerCube"?t:this.type}},Oi=Aa;Oi.globalContext={nodeContextUuid:0},Oi.uuidContext=Aa.globalContext;var Rg=class{constructor(e){e=e??{},this.name=e.name,this.type=e.type,this.node=e.node,this.size=e.size,this.needsUpdate=e.needsUpdate}get value(){return this.node.value}set value(e){this.node.value=e}},Pj=class{constructor(){this.nodes={},this.keywords={}}add(e){this.nodes[e.name]=e}addKeyword(e,t,i){i=i!==void 0?i:!0,this.keywords[e]={callback:t,cache:i}}remove(e){delete this.nodes[e.name]}removeKeyword(e){delete this.keywords[e]}get(e){return this.nodes[e]}getKeyword(e,t){return this.keywords[e].callback(t)}getKeywordData(e){return this.keywords[e]}contains(e){return this.nodes[e]!==void 0}containsKeyword(e){return this.keywords[e]!==void 0}},k1=new Pj,Gt=class extends Oi{constructor(e,t){super(e),this.scope="",t=t??{},this.shared=t.shared!==void 0?t.shared:!0,this.unique=t.unique!==void 0?t.unique:!1}build(e,t,i,r){if(t=t??this.getType(e),this.getShared(e,t)){let s=this.getUnique(e,t);s&&this.uuid===void 0&&(this.uuid=Oe.generateUUID()),i=e.getUUID(i??this.getUUID(),!s);let a=e.getNodeData(i),n=a.output||this.getType(e);if(e.analyzing)return(a.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,a,t),this.generate(e,t,i)):super.build(e,t,i);if(s)return a.name=a.name||super.build(e,t,i),a.name;if(!this.getLabel()&&(!this.getShared(e,n)||e.context.ignoreCache||a.deps===1))return super.build(e,t,i);i=this.getUUID(!1);let o=this.getTemp(e,i);if(o)return e.format(o,n,t);{o=super.generate(e,t,i,a.output,r);let l=this.generate(e,n,i);return e.addNodeCode(o+" = "+l+";"),e.format(o,n,t)}}return super.build(e,t,i)}getShared(e,t){return t!=="sampler2D"&&t!=="samplerCube"&&this.shared}getUnique(e,t){return this.unique}setLabel(e){return this.label=e,this}getLabel(){return this.label}getUUID(e){let t=this.uuid;return typeof this.scope=="string"&&(t=this.scope+"-"+t),t}getTemp(e,t){t=t||this.uuid;let i=e.getVars()[t];return i?i.name:void 0}generate(e,t,i,r,s){return this.getShared(e,t),i=i??this.uuid,e.getTempVar(i,r??this.getType(e),s,this.getLabel()).name}},j1=class extends Gt{constructor(e,t){t=t??{},t.shared=t.shared!==void 0?t.shared:!1,super(e,t),this.readonly=!1}setReadonly(e){return this.readonly=e,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(e,t,i,r,s,a){i=e.getUUID(i??this.getUUID()),r=r??this.getType(e);let n=e.getNodeData(i);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(e,t,i,r,s,a):e.isShader("vertex")?(n.vertex||(n.vertex=e.createVertexUniform(r,this,s,a,this.getLabel())),e.format(n.vertex.name,r,t)):(n.fragment||(n.fragment=e.createFragmentUniform(r,this,s,a,this.getLabel())),e.format(n.fragment.name,r,t))}},e1=class extends j1{constructor(e=0,t){super("v2"),this.nodeType="Vector2",this.value=e instanceof j?e:new j(e,t)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}generateReadonly(e,t,i,r,s,a){return e.format("vec2("+this.value.x+", "+this.value.y+")",r,t)}},tr=class extends j1{constructor(e=0,t,i){super("v3"),this.nodeType="Vector3",this.value=e instanceof E?e:new E(e,t,i)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}get z(){return this.value.z}set z(e){this.value.z=e}generateReadonly(e,t,i,r,s,a){return e.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",r,t)}},o1=class extends Je{constructor(e,t,i,r){super(e,t,i),this.isColorA=!0,this.a=r}setRGBA(e,t,i,r){super.setRGB(e,t,i),this.a=r}copy(e){return super.copy(e),this.a="a"in e?e.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}equals(e){return super.equals(e)&&this.a===e.a}setStyle(e,t="srgb"){let i;if(e==="transparent")return this.setRGBA(0,0,0,0),this;if(i=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(e)){let r,s=i[1],a=i[2];switch(s){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.a=s==="rgba"?parseFloat(r[4]):1,super.setStyle(e,t);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.a=s==="hsla"?parseFloat(r[4]):1,super.setStyle(e,t);break}}return super.setStyle(e,t)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(e){this.r=e}set y(e){this.g=e}set z(e){this.b=e}set w(e){this.a=e}},zs=class extends j1{constructor(e){super("v4"),this.nodeType="Vector4",this.value=e instanceof o1?e:new o1(e.r,e.g,e.b,e.a)}generateReadonly(e,t,i,r,s,a){return e.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",r,t)}},Dj=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,Lg=/[a-z_0-9]+/gi,Pe=class extends Gt{constructor(e,t,i,r,s){super(s),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=s===void 0,this.isInterface=!1,this.parse(e,t,i,r)}getShared(e,t){return!this.isMethod}getType(e){return e.getTypeByFormat(this.type)}getInputByName(e){if(this.inputs){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}}getIncludeByName(e){if(this.includes){let t=this.includes.length;for(;t--;)if(this.includes[t].name===e)return this.includes[t]}}generate(e,t,i,r,s){let a,n=0,o=this.src;if(this.includes)for(let h=0;h<this.includes.length;h++)e.include(this.includes[h],this);for(let h in this.extensions)e.extensions[h]=!0;let l=[];for(;a=Lg.exec(this.src);)l.push(a);for(let h=0;h<l.length;h++){let c=l[h],d=c[0],u=this.isMethod?!this.getInputByName(d):!0,p=d;if(this.keywords[d]||this.useKeywords&&u&&k1.containsKeyword(d)){let f=this.keywords[d];if(!f){let g=k1.getKeywordData(d);g.cache&&(f=e.keywords[d]),f=f||k1.getKeyword(d,e),g.cache&&(e.keywords[d]=f)}p=f.build(e)}d!==p&&o[c.index+n-1]!=="."&&(o=o.substring(0,c.index+n)+p+o.substring(c.index+d.length+n),n+=p.length-d.length),this.getIncludeByName(p)===void 0&&k1.contains(p)&&e.include(k1.get(p))}return t==="source"?o:this.isMethod?(this.isInterface||e.include(this,void 0,o),this.name):e.format("( "+o+" )",this.getType(e),t)}parse(e,t,i,r){if(this.src=e||"",this.includes=t??[],this.extensions=i??{},this.keywords=r??{},this.isMethod){let s=Dj.exec(this.src);if(this.inputs=[],s&&s.length==4){this.type=s[1],this.name=s[2];let a=s[3].match(Lg);if(a){let n=0;for(;n<a.length;){let o=a[n++],l;o==="in"||o==="out"||o==="inout"?l=a[n++]:(l=o,o="");let h=a[n++];this.inputs.push({name:h,type:l,qualifier:o})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},Ij=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,Qx=class extends Gt{constructor(e="",t){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(e||Qx.PI,void 0,void 0,void 0,t)}getType(e){return e.getTypeByFormat(this.type)}parse(e,t,i,r,s){this.src=e||"";let a,n,o="",l=Ij.exec(e);this.useDefine=s??this.src.charAt(0)==="#",l&&l.length>1?(n=l[1],a=l[2],o=l[3]):(a=this.src,n="f"),this.name=a,this.type=n,this.value=o}build(e,t){if(t==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return e.include(this),e.format(this.name,this.getType(e),t)}generate(e,t,i,r,s){return e.format(this.name,this.getType(e),t)}},Nt=Qx;Nt.PI="PI",Nt.PI2="PI2",Nt.RECIPROCAL_PI="RECIPROCAL_PI",Nt.RECIPROCAL_PI2="RECIPROCAL_PI2",Nt.LOG2="LOG2",Nt.EPSILON="EPSILON";var Oj=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),Rj=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),Zx=class extends Gt{constructor(e=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(e)}getType(e){return e.getTypeByFormat(this.name)}getInputByName(e){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}generate(e,t,i,r,s){return t==="source"?this.src+";":e.format("( "+this.src+" )",this.getType(e),t)}parse(e=""){this.src=e,this.inputs=[];let t=Oj.exec(e);if(t){let i=t[2],r;for(;r=Rj.exec(i);)this.inputs.push({type:r[1],name:r[2]});this.name=t[1]}else this.name="";this.type=this.name}},J4=class extends Gt{constructor(e){super("v2",{shared:!1}),this.nodeType="UV",this.index=e??0}generate(e,t){e.requires.uv[this.index]=!0;let i=this.index>0?this.index+1:"",r=e.isShader("vertex")?"uv"+i:"vUv"+i;return e.format(r,this.getType(e),t)}};k1.addKeyword("uv",function(){return new J4});k1.addKeyword("uv2",function(){return new J4(1)});var Io=class extends Gt{constructor(e,t){super("v4"),this.nodeType="ColorSpace",this.input=e,this.method=t??Io.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(e){switch(e){case Rr:return["Linear"];case ft:return["sRGB"];default:return[]}}generate(e,t){var n;let i=this.input.build(e,"v4"),r=this.getType(e),s=Io.Nodes[this.method],a=e.include(s);if(a===Io.LINEAR_TO_LINEAR)return e.format(i,r,t);if(((n=s.inputs)==null?void 0:n.length)===2){let o=this.factor.build(e,"f");return e.format(a+"( "+i+", "+o+" )",r,t)}else return e.format(a+"( "+i+" )",r,t)}fromEncoding(e){let t=Io.getEncodingComponents(e);this.method="LinearTo"+t[0],this.factor=t[1]}fromDecoding(e){let t=Io.getEncodingComponents(e);this.method=t[0]+"ToLinear",this.factor=t[1]}},as=Io;as.Nodes={LinearToLinear:new Pe(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new Pe(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new Pe(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},as.LINEAR_TO_LINEAR="LinearToLinear",as.SRGB_TO_LINEAR="sRGBToLinear",as.LINEAR_TO_SRGB="LinearTosRGB";var Kt=class extends Pe{constructor(e="",t,i,r,s){super(e,s,r,i,t),this.nodeType="Expression"}},js=class extends j1{constructor(e=new ai,t,i,r){super("v4",{shared:!0}),this.nodeType="Texture",this.value=e,this.uv=t??new J4,this.bias=i,this.project=r!==void 0?r:!1}getTexture(e,t){return super.generate(e,t,this.value.uuid,"t")}generate(e,t){if(t==="sampler2D")return this.getTexture(e,t);let i=this.getTexture(e,t),r=this.uv.build(e,this.project?"v4":"v2"),s=this.bias?this.bias.build(e,"f"):void 0;s===void 0&&e.context.bias&&(s=e.context.bias.setTexture(this).build(e,"f"));let a,n;this.project?a="texture2DProj":a=s?"tex2DBias":"tex2D",s?n=a+"( "+i+", "+r+", "+s+" )":n=a+"( "+i+", "+r+" )";let o={include:e.isShader("vertex"),ignoreCache:!0},l=this.getType(e);return e.addContext(o),this.colorSpace=this.colorSpace??new as(new Kt("",l)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(n),n=this.colorSpace.build(e,l),e.removeContext(),e.format(n,l,t)}},ze=class extends j1{constructor(e){super("f"),this.nodeType="Float",this.value=e??0}generateReadonly(e,t,i,r,s,a){return e.format(this.value+(this.value%1?"":".0"),r,t)}},Bg=class extends Gt{constructor(e,t){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=e,this.inputs=t??[]}getFunction(){return this.value}getType(e){return this.value.getType(e)}generate(e,t,i,r,s){r=this.getType(e);let a=this.value,n=a.build(e,t)+"( ",o=[];if(a.inputs){for(let l=0;l<a.inputs.length;l++){let h=a.inputs[l],c=this.inputs[l]||this.inputs[h.name];o.push(c.build(e,e.getTypeByFormat(h.type)))}n+=o.join(", ")+" )"}return e.format(n,r,t)}},Kx=class extends Gt{constructor(e,t,i=Kx.ADD){super(),this.nodeType="Operator",this.type=e.type,this.a=e,this.b=t,this.op=i}getType(e){let t=this.a.getType(e),i=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(i)>e.getTypeLength(t)?i:t}generate(e,t){let i=this.getType(e);this.type=i;let r=this.a.build(e,i),s=this.b.build(e,i);return e.format("( "+r+" "+this.op+" "+s+" )",i,t)}},L1=Kx;L1.ADD="+",L1.SUB="-",L1.MUL="*",L1.DIV="/";var Ut=class extends Gt{constructor(e,t=Ut.ABS,i,r){super(),this.nodeType="Math",this.a=e,typeof t!="string"?this.b=t:r=t,typeof i!="string"?this.c=i:r=i,this.method=r,this.hashProperties=["method"]}getNumInputs(e){switch(this.method){case Ut.MIX:case Ut.CLAMP:case Ut.REFRACT:case Ut.SMOOTHSTEP:case Ut.FACEFORWARD:return 3;case Ut.MIN:case Ut.MAX:case Ut.MOD:case Ut.STEP:case Ut.REFLECT:case Ut.DISTANCE:case Ut.DOT:case Ut.CROSS:case Ut.POW:return 2;default:return 1}}getInputType(e){let t=e.getTypeLength(this.a.getType(e)),i=this.b?e.getTypeLength(this.b.getType(e)):0,r=this.c?e.getTypeLength(this.c.getType(e)):0;return t>i&&t>r?this.a.getType(e):i>r?this.b.getType(e):this.c.getType(e)}getType(e){switch(this.method){case Ut.LENGTH:case Ut.DISTANCE:case Ut.DOT:return"f";case Ut.CROSS:return"v3"}return this.getInputType(e)}generate(e,t){let i,r,s,a=this.a?e.getTypeLength(this.a.getType(e)):0,n=this.b?e.getTypeLength(this.b.getType(e)):0,o=this.c?e.getTypeLength(this.c.getType(e)):0,l=this.getInputType(e),h=this.getType(e);switch(this.type=h,this.method){case Ut.NEGATE:return e.format("( -"+this.a.build(e,l)+" )",l,t);case Ut.INVERT:return e.format("( 1.0 - "+this.a.build(e,l)+" )",l,t);case Ut.CROSS:i=this.a.build(e,"v3"),r=this.b.build(e,"v3");break;case Ut.STEP:i=this.a.build(e,a===1?"f":l),r=this.b.build(e,l);break;case Ut.MIN:case Ut.MAX:case Ut.MOD:i=this.a.build(e,l),r=this.b.build(e,n===1?"f":l);break;case Ut.REFRACT:i=this.a.build(e,l),r=this.b.build(e,l),s=this.c.build(e,"f");break;case Ut.MIX:i=this.a.build(e,l),r=this.b.build(e,l),s=this.c.build(e,o===1?"f":l);break;default:i=this.a.build(e,l),this.b&&(r=this.b.build(e,l)),this.c&&(s=this.c.build(e,l));break}let c=[];c.push(i),r&&c.push(r),s&&c.push(s);let d=this.getNumInputs(e);if(c.length!==d)throw Error(`Arguments not match used in "${this.method}". Require ${d}, currently ${c.length}.`);return e.format(this.method+"( "+c.join(", ")+" )",h,t)}},dt=Ut;dt.RAD="radians",dt.DEG="degrees",dt.EXP="exp",dt.EXP2="exp2",dt.LOG="log",dt.LOG2="log2",dt.SQRT="sqrt",dt.INV_SQRT="inversesqrt",dt.FLOOR="floor",dt.CEIL="ceil",dt.NORMALIZE="normalize",dt.FRACT="fract",dt.SATURATE="saturate",dt.SIN="sin",dt.COS="cos",dt.TAN="tan",dt.ASIN="asin",dt.ACOS="acos",dt.ARCTAN="atan",dt.ABS="abs",dt.SIGN="sign",dt.LENGTH="length",dt.NEGATE="negate",dt.INVERT="invert",dt.MIN="min",dt.MAX="max",dt.MOD="mod",dt.STEP="step",dt.REFLECT="reflect",dt.DISTANCE="distance",dt.DOT="dot",dt.CROSS="cross",dt.POW="pow",dt.MIX="mix",dt.CLAMP="clamp",dt.REFRACT="refract",dt.SMOOTHSTEP="smoothstep",dt.FACEFORWARD="faceforward";var m2=class extends Gt{constructor(e,t,i){super("v4"),this.nodeType="TextureCubeUV",this.value=e,this.uv=t,this.bias=i}bilinearCubeUV(e,t,i,r){let s=new Bg(m2.Nodes.bilinearCubeUV,[t,i,r]);this.colorSpaceTL=this.colorSpaceTL??new as(new Kt("","v4")),this.colorSpaceTL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(s.build(e)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new as(new Kt("","v4")),this.colorSpaceTR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(s.build(e)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new as(new Kt("","v4")),this.colorSpaceBL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(s.build(e)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new as(new Kt("","v4")),this.colorSpaceBR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(s.build(e)+".br");let a={include:e.isShader("vertex"),ignoreCache:!0};e.addContext(a),this.colorSpaceTLExp=new Kt(this.colorSpaceTL.build(e,"v4"),"v4"),this.colorSpaceTRExp=new Kt(this.colorSpaceTR.build(e,"v4"),"v4"),this.colorSpaceBLExp=new Kt(this.colorSpaceBL.build(e,"v4"),"v4"),this.colorSpaceBRExp=new Kt(this.colorSpaceBR.build(e,"v4"),"v4"),e.removeContext();let n=new Kt("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return n.keywords.cubeUV_TL=this.colorSpaceTLExp,n.keywords.cubeUV_TR=this.colorSpaceTRExp,n.keywords.cubeUV_BL=this.colorSpaceBLExp,n.keywords.cubeUV_BR=this.colorSpaceBRExp,n.keywords.cubeUV=s,n}generate(e,t){if(e.isShader("fragment")){let i=this.uv,r=this.bias||e.context.roughness,s=new Bg(m2.Nodes.roughnessToMip,[r]),a=new dt(s,m2.Nodes.m0,m2.Nodes.cubeUV_maxMipLevel,dt.CLAMP),n=new dt(a,dt.FLOOR),o=new dt(a,dt.FRACT),l=this.bilinearCubeUV(e,this.value,i,n),h=this.bilinearCubeUV(e,this.value,i,new L1(n,new ze(1).setReadonly(!0),L1.ADD)),c=new dt(l,h,o,dt.MIX);return e.format(c.build(e),"v4",t)}else return""+e.shader,e.format("vec4( 0.0 )",this.getType(e),t)}},yf=m2;yf.Nodes=function(){let e=new Zx(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),t=new Nt("float cubeUV_maxMipLevel 8.0",!0),i=new Nt("float cubeUV_minMipLevel 4.0",!0),r=new Nt("float cubeUV_maxTileSize 256.0",!0),s=new Nt("float cubeUV_minTileSize 16.0",!0),a=new Pe(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);a.useKeywords=!1;let n=new Pe(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);n.useKeywords=!1;let o=new Pe(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[e,a,n,t,i,r,s]);o.useKeywords=!1;let l=new Nt("float r0 1.0",!0),h=new Nt("float v0 0.339",!0),c=new Nt("float m0 -2.0",!0),d=new Nt("float r1 0.8",!0),u=new Nt("float v1 0.276",!0),p=new Nt("float m1 -1.0",!0),f=new Nt("float r4 0.4",!0),g=new Nt("float v4 0.046",!0),m=new Nt("float m4 2.0",!0),v=new Nt("float r5 0.305",!0),y=new Nt("float v5 0.016",!0),x=new Nt("float m5 3.0",!0),w=new Nt("float r6 0.21",!0),_=new Nt("float v6 0.0038",!0),b=new Nt("float m6 4.0",!0),A=[l,h,c,d,u,p,f,g,m,v,y,x,w,_,b],S=new Pe(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,A);return{bilinearCubeUV:o,roughnessToMip:S,m0:c,cubeUV_maxMipLevel:t}}();var Oo=class extends Gt{constructor(e){super("v3"),this.nodeType="Normal",this.scope=e??Oo.VIEW}getShared(){return this.scope===Oo.WORLD}build(e,t,i,r){let s=e.context[this.scope+"Normal"];return s?s.build(e,t,i,r):super.build(e,t,i)}generate(e,t,i,r,s){let a;switch(this.scope){case Oo.VIEW:e.isShader("vertex")?a="transformedNormal":a="geometryNormal";break;case Oo.LOCAL:e.isShader("vertex")?a="objectNormal":(e.requires.normal=!0,a="vObjectNormal");break;case Oo.WORLD:e.isShader("vertex")?a="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(e.requires.worldNormal=!0,a="vWNormal");break}return e.format(a,this.getType(e),t)}},U1=Oo;U1.LOCAL="local",U1.WORLD="world",U1.VIEW="view",U1.NORMAL="normal";k1.addKeyword("viewNormal",function(){return new U1(U1.VIEW)});k1.addKeyword("localNormal",function(){return new U1(U1.NORMAL)});k1.addKeyword("worldNormal",function(){return new U1(U1.WORLD)});var Rs=class extends Gt{constructor(e){super("v3"),this.nodeType="Position",this.scope=e??Rs.LOCAL}getType(){switch(this.scope){case Rs.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case Rs.LOCAL:case Rs.WORLD:return!1}return!0}generate(e,t,i,r,s){let a;switch(this.scope){case Rs.LOCAL:e.isShader("vertex")?a="transformed":(e.requires.position=!0,a="vPosition");break;case Rs.WORLD:if(e.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";e.requires.worldPosition=!0,a="vWPosition";break;case Rs.VIEW:a=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case Rs.PROJECTION:a=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return e.format(a,this.getType(),t)}},Tr=Rs;Tr.LOCAL="local",Tr.WORLD="world",Tr.VIEW="view",Tr.PROJECTION="projection";k1.addKeyword("position",function(){return new Tr});k1.addKeyword("worldPosition",function(){return new Tr(Tr.WORLD)});k1.addKeyword("viewPosition",function(){return new Tr(Tr.VIEW)});var Kr=class extends Gt{constructor(e){super("v3"),this.nodeType="Reflect",this.scope=e??Kr.CUBE}getUnique(e){return!e.context.viewNormal}getType(){switch(this.scope){case Kr.SPHERE:return"v2"}return this.type}generate(e,t){let i=this.getUnique(e);if(e.isShader("fragment")){let r;switch(this.scope){case Kr.VECTOR:{let s=new U1(U1.VIEW),a=e.context.roughness,n=s.build(e,"v3"),o=new Tr(Tr.VIEW).build(e,"v3"),l=a?a.build(e,"f"):void 0,h=`reflect( -normalize( ${o} ), ${n} )`;l&&(h=`normalize( mix( ${h}, ${n}, ${l} * ${l} ) )`);let c=`inverseTransformDirection( ${h}, viewMatrix )`;i?(e.addNodeCode(`vec3 reflectVec = ${c};`),r="reflectVec"):r=c;break}case Kr.CUBE:{let s=new Kr(Kr.VECTOR).build(e,"v3"),a="vec3( -"+s+".x, "+s+".yz )";i?(e.addNodeCode(`vec3 reflectCubeVec = ${a};`),r="reflectCubeVec"):r=a;break}case Kr.SPHERE:{let s="normalize( ( viewMatrix * vec4( "+new Kr(Kr.VECTOR).build(e,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";i?(e.addNodeCode(`vec2 reflectSphereVec = ${s};`),r="reflectSphereVec"):r=s;break}}return e.format(r,this.getType(),t)}else return""+e.shader,e.format("vec3( 0.0 )",this.type,t)}},Qo=Kr;Qo.CUBE="cube",Qo.SPHERE="sphere",Qo.VECTOR="vector";var Lj=class extends Gt{constructor(e=new js,t,i){super("v4"),this.nodeType="TextureCube",this.value=e,this.radianceNode=new yf(this.value,t??new Qo(Qo.VECTOR),i),this.irradianceNode=new yf(this.value,new U1(U1.WORLD),new ze(1).setReadonly(!0))}generate(e,t){return e.isShader("fragment")?(e.require("irradiance"),e.context.bias&&e.context.bias.setTexture(this.value),(e.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(e,t)):(""+e.shader,e.format("vec4( 0.0 )",this.getType(e),t))}},Bj=class extends j1{constructor(e=new i4,t,i){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=e,this.uv=t??new Qo,this.bias=i}getTexture(e,t){return super.generate(e,t,this.value.uuid,"tc")}generate(e,t){var l;if(t==="samplerCube")return this.getTexture(e,t);let i=this.getTexture(e,t),r=(l=this.uv)==null?void 0:l.build(e,"v3"),s=this.bias?this.bias.build(e,"f"):void 0;s===void 0&&e.context.bias&&(s=e.context.bias.setTexture(this).build(e,"f"));let a;s?a="texCubeBias( "+i+", "+r+", "+s+" )":a="texCube( "+i+", "+r+" )";let n={include:e.isShader("vertex"),ignoreCache:!0},o=this.getType(e);return e.addContext(n),this.colorSpace=this.colorSpace??new as(new Kt("",o)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(a),a=this.colorSpace.build(e,o),e.removeContext(),e.format(a,o,t)}},zj=`
uniform int frameIndex;
uniform vec2 resolution;
uniform mat4 previousModelViewMatrix;
uniform mat4 previousProjectionMatrix;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;
`,Fj=`
layout(location = 1) out vec4 gVelocity;

uniform int frameIndex;
uniform vec2 resolution;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;

const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos) {
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

`,kj=`
// TODO: This could be generated CPU side and passed to the shader every frame
const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

// TODO: Pass correct view size
vec2 offset = haltonSequence[frameIndex];
offset.x /= resolution.x;
offset.y /= resolution.y;

vec4 currentPosition = gl_Position;
vec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);

// We want to calculate the velocity with unjittered positions
// so that things that are not moving get a velocity = 0
vCurrentPosition = currentPosition;
vPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);
#ifdef OUTLINE_COMPENSATION
vPreviousPosition.xy += OUTLINE_COMPENSATION;
#endif
gl_Position = currentPositionJittered;

`,Uj=`
vec2 oldPos = vPreviousPosition.xy;
    oldPos /= vPreviousPosition.w;
    oldPos.xy = (oldPos.xy+1.)/2.0;

vec2 newPos = vCurrentPosition.xy;
    newPos /= vCurrentPosition.w;
    newPos.xy = (newPos.xy+1.)/2.0;

vec2 velocity = (newPos - oldPos);

// Discard fully transparent pixels 
if (gl_FragColor.a <= 0.0) discard;

gVelocity = vec4(velocity, 0.0, 1.0);
`,Nj=`
layout(location = 1) out vec4 gVelocity;
`,Vj=`
    // Discard fully transparent pixels 
    if (gl_FragColor.a <= 0.0) discard;

    gVelocity = vec4(0.0, 0.0, 0.0, 1.0);
`,zg=["x","y","z","w"],jj=["float","vec2","vec3","vec4"],Gj={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},Hj={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},Jx=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function e(t,i){return t.deps.length-i.deps.length}return function(t,i){let r=this.getIncludes(t,i);if(!r)return"";let s="";r=r.sort(e);for(let a=0;a<r.length;a++)r[a].src&&(s+=r[a].src+`
`);return s}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(e,t){this.addVertexParsCode(zj),this.addFragmentParsCode(Fj),this.buildShader("vertex",e),this.buildShader("fragment",t);for(let i=0;i<this.requires.uv.length;i++)if(this.requires.uv[i]){let r=i>0?i+1:"";this.addVaryCode("varying vec2 vUv"+r+";"),i>0&&this.addVertexParsCode("attribute vec2 uv"+r+";"),this.addVertexFinalCode("vUv"+r+" = uv"+r+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode(kj),this.addFragmentFinalCode(Uj)),this}buildShader(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")}setMaterial(e,t){return this.defines={},this}addFlow(e,t,i){return this.addSlot(e).addCache(t).addContext(i)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(e){return this.cache=e??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(e){return this.context=Object.assign({},this.context,e),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(e){return this.slot=e||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(e,t){this.fragmentVariables[e]===void 0&&(this.addFragmentCode(`${t} ${e};`),this.fragmentVariables[e]="")}addFragmentParsVariable(e,t){this.fragmentParsVariables[e]===void 0&&(this.addFragmentParsCode(`${t} ${e};`),this.fragmentParsVariables[e]="")}addVertexParsVariable(e,t){this.vertexParsVariables[e]===void 0&&(this.addVertexParsCode(`${t} ${e};`),this.vertexParsVariables[e]="")}addVertexCode(e){this.addCode(e,"vertex")}addFragmentCode(e){this.addCode(e,"fragment")}addCode(e,t){this.code[t??this.shader]+=e+`
`}addVertexNodeCode(e){this.addNodeCode(e,"vertex")}addFragmentNodeCode(e){this.addNodeCode(e,"fragment")}addNodeCode(e,t){this.nodeCode[t??this.shader]+=e+`
`}clearNodeCode(e){e=e??this.shader;let t=this.nodeCode[e];return this.nodeCode[e]="",t}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(e){this.addFinalCode(e,"vertex")}addFragmentFinalCode(e){this.addFinalCode(e,"fragment")}addFinalCode(e,t){this.finalCode[t??this.shader]+=e+`
`}addVertexParsCode(e){this.addParsCode(e,"vertex")}addFragmentParsCode(e){this.addParsCode(e,"fragment")}addParsCode(e,t){this.parsCode[t??this.shader]+=e+`
`}addVaryCode(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)}isCache(e){return this.caches.indexOf(e)!==-1}isSlot(e){return this.slots.indexOf(e)!==-1}define(e,t){this.defines[e]=t===void 0?1:t}require(e){this.requires[e]=!0}isDefined(e){return this.defines[e]!==void 0}getVar(e,t,i,r="varying",s="V",a=""){let n=this.getVars(r),o=n[e];if(!o){let l=n.length;o={name:i||"node"+s+l+(a?"_"+a:""),type:t},n.push(o),n[e]=o}return o}getTempVar(e,t,i,r){return this.getVar(e,t,i,this.shader,"T",r)}getAttribute(e,t){if(!this.attributes[e]){let i=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(i.name+" = "+e+";"),this.attributes[e]={varying:i,name:e,type:t}}return this.attributes[e]}getCode(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join(`
`)}getVarListCode(e,t){t=t??"";let i="";for(let r=0,s=e.length;r<s;++r){let a=e[r],n=a.type,o=a.name,l=a.size,h=this.getFormatByType(n);if(h===void 0)throw new Error("Node pars "+h+" not found.");h.includes("[]")?i+=t+" "+h.substring(0,h.length-2)+" "+o+`[${l}];
`:i+=t+" "+h+" "+o+`;
`}return i}getVars(e){return this.inputs.vars[e??this.shader]}getNodeData(e){let t=e instanceof Oi?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}}createUniform(e,t,i,r,s,a){if(t.includes("[]")){let n=this.inputs.arrayUniforms,o=n.list.length,l=new Rg({type:t,size:i.size,name:r||"nodeUA"+o+(a?"_"+a:""),node:i,needsUpdate:s});return n.list.push(l),n[e].push(l),n[e][l.name]=l,this.uniforms[l.name]=l,l}else{let n=this.inputs.uniforms,o=n.list.length,l=new Rg({type:t,name:r||"nodeU"+o+(a?"_"+a:""),node:i,needsUpdate:s});return n.list.push(l),n[e].push(l),n[e][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(e,t,i,r,s){return this.createUniform("vertex",e,t,i,r,s)}createFragmentUniform(e,t,i,r,s){return this.createUniform("fragment",e,t,i,r,s)}include(e,t,i){var a;let r;if(e=typeof e=="string"?k1.get(e):e,this.context.include===!1)return e.name;e instanceof Pe?r=this.includes.functions:e instanceof Nt?r=this.includes.consts:e instanceof Zx&&(r=this.includes.structs);let s=r[this.shader]=r[this.shader]||[];if(e){let n=s[e.name];if(n||(n=s[e.name]={node:e,deps:[]},s.push(n),n.src=e.build(this,"source")),e instanceof Pe&&t&&s[t.name]&&s[t.name].deps.indexOf(e)===-1&&(s[t.name].deps.push(e),(a=e.includes)==null?void 0:a.length)){let o=0;do this.include(e.includes[o++],t);while(o<e.includes.length)}return i&&(n.src=i),e.name}else throw new Error("Include not found.")}colorToVectorProperties(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(e){return e.replace(/c/g,"v3")}getIncludes(e,t){return this.includes[e][t||this.shader]}getConstructorFromLength(e){return jj[e-1]}isTypeMatrix(e){return/^m/.test(e)}getTypeLength(e){return e==="f"?1:parseInt(this.colorToVector(e).substr(1))}getTypeFromLength(e){return e===1?"f":"v"+e}findNode(...e){for(let t=0;t<arguments.length;t++){let i=e[t];if(i!=null&&i.isNode)return i}}resolve(...e){for(let t=0;t<arguments.length;t++){let i=e[t];if(i!==void 0){if(i.isNode)return i;if(i.isTexture)switch(i.mapping){case Ln:case Bn:return new Bj(i);case ih:return new Lj(new js(i));default:return new js(i)}else{if(i.isVector2)return new e1(i);if(i.isVector3)return new tr(i);if(i.isVector4)return new zs(i)}}}}format(e,t,i){switch(this.colorToVector(i+" <- "+t)){case"f <- v2":return e+".x";case"f <- v3":return e+".x";case"f <- v4":return e+".x";case"f <- i":case"f <- b":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":return e+".xy";case"v2 <- v4":return e+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+e+" ) )";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+e+" ) )";case"i <- f":case"i <- b":return"int( "+e+" )";case"i <- v2":return"int( "+e+".x )";case"i <- v3":return"int( "+e+".x )";case"i <- v4":return"int( "+e+".x )";case"b <- f":return"( "+e+" != 0.0 )";case"b <- v2":return"( "+e+" != vec2( 0.0 ) )";case"b <- v3":return"( "+e+" != vec3( 0.0 ) )";case"b <- v4":return"( "+e+" != vec4( 0.0 ) )";case"b <- i":return"( "+e+" != 0 )"}return e}getTypeByFormat(e){return Gj[e]||e}getFormatByType(e){return Hj[e]||e}getUUID(e,t){return t=t!==void 0?t:!0,t&&this.cache&&(e=this.cache+"-"+e),e}getElementByIndex(e){return zg[e]}getIndexByElement(e){return zg.indexOf(e)}isShader(e){return this.shader===e}setShader(e){return this.shader=e,this}mergeDefines(e){for(let t in e)this.defines[t]=e[t];return this.defines}mergeUniform(e){for(let t in e)this.uniforms[t]=e[t];return this.uniforms}getTextureEncodingFromMap(e){let t;return e?e.isTexture&&(t=e.encoding):t=Rr,t===Rr&&this.context.gamma&&(t=ft),t}},ci=class extends j1{constructor(e=0,t,i,r){super("c"),this.nodeType="Color",this.value=e instanceof o1?e:new o1(e||0,t,i,r)}setRGBA(e){this.value.setRGBA(e.r,e.g,e.b,e.a)}generate(e,t,i,r,s,a){i=e.getUUID(i??this.getUUID()),r=r??this.getType(e);let n=e.getNodeData(i),o=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let l=this.alpha.build(e,"f");e.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${l};`)}return o?this.generateReadonly(e,t,i,r,s,a):e.isShader("vertex")?(n.vertex||(n.vertex=e.createVertexUniform(r,this,s,a,this.getLabel())),e.format(n.vertex.name,r,t)):(n.fragment||(n.fragment=e.createFragmentUniform(r,this,s,a,this.getLabel())),e.format(n.fragment.name,r,t))}generateReadonly(e,t,i,r,s,a){return e.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",r,t)}},qt=class extends j1{constructor(e){super("i"),this.nodeType="Int",this.value=Math.floor(e??0)}generateReadonly(e,t,i,r,s,a){return e.format(this.value.toString(),r,t)}},E1=class extends j1{constructor(e){super("b"),this.nodeType="Bool",this.value=e??!1}generateReadonly(e,t,i,r){return e.format(this.value?"true":"false",r,t)}},hn=class extends j1{constructor(e=1,t){super("f[]"),this.nodeType="FloatArray",this.size=e,this.value=Array.isArray(t)?t:typeof t=="number"?new Array(e).fill(t):new Array(e).fill(0)}},$4=class extends j1{},Wj=class extends $4{constructor(e){super("v3"),this.image=e,this._value=new E}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},xf=class extends $4{constructor(e,t,i=1008,r=1006){super("t"),this.image=e,this.wrap=t,this.minFilter=i,this.magFilter=r}get value(){return this.image.getTexture(this.wrap,this.minFilter,this.magFilter)}},$x=class extends j1{constructor(e){super("m3"),this.nodeType="Matrix3",this.value=e??new Ai}generateReadonly(e,t,i,r,s,a){return e.format("mat3("+this.value.elements.join(", ")+")",r,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}},fs=class extends j1{constructor(e){super("m4"),this.nodeType="Matrix4",this.value=e??new we}generateReadonly(e,t,i,r,s,a){return e.format("mat4("+this.value.elements.join(", ")+")",r,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}};function Fg(e,t,i,r=0){e.setUvTransform(i[0],i[1],t[0],t[1],0,0,0).premultiply(new Ai().makeRotation(r*Oe.DEG2RAD))}var qj=class extends $x{constructor(e,t,i=0){super(new Ai),this.repeat=e,this.offset=t,this.rotation=i,Fg(this.value,e,t,i)}updateMatrix(){Fg(this.value,this.repeat,this.offset,this.rotation)}},cn=class extends j1{constructor(e=1,t){super("v4[]"),this.nodeType="Vector4Array",this.size=e,this.value=Array.isArray(t)?t:t instanceof ht?new Array(e).fill(t):new Array(e).fill(new ht(0))}},kg=class extends Gt{constructor(e,t,i,r){super("v3"),this.nodeType="Blend",this.a=e,this.b=t,this.alpha=i,this.mode=r}generate(e,t){if(e.isShader("fragment")){let i=[];return i.push(this.a.build(e,"c")),i.push(this.b.build(e,"c")),i.push(this.alpha.build(e,"f")),i.push(this.mode.build(e,"i")),e.format("spe_blend("+i.join(",")+")",this.getType(e),t)}else return""+e.shader,e.format("vec3( 0.0 )",this.getType(e),t)}},eb=class extends Gt{constructor(e,t){super("v3"),this.nodeType="CustomColor",this.color=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let i=e.include(eb.Nodes.customColor);e.addFragmentVariable(this.calpha,"float");let r=[];return r.push(this.color.build(e,"v3")),r.push(this.mask?`luminance(${this.mask.build(e,"v3")})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.calpha),e.format(i+"("+r.join(",")+")",this.getType(e),t)}else return""+e.shader,e.format("vec3( 0.0 )",this.getType(e),t)}},bf=eb;bf.Nodes=function(){return{customColor:new Pe(`vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color;
			}`)}}();var tb=class extends Gt{constructor(e,t){super("v3"),this.nodeType="CustomNormal",this.cnormal=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let i=e.include(tb.Nodes.customNormal);e.addFragmentVariable(this.calpha,"float");let r=[];return r.push(this.cnormal.build(e,"v3")),r.push("normal"),r.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.calpha),e.format(i+"("+r.join(",")+")",this.getType(e),t)}else return""+e.shader,e.format("vec3( 0.0 )",this.getType(e),t)}},ib=tb;ib.Nodes=function(){return{customNormal:new Pe(`vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return normal;
			}`)}}();var g2=class extends Gt{constructor(e,t,i,r,s,a,n,o,l,h,c,d){super("v3"),this.nodeType="CustomTexture",this.texture=e,this.textureSize=t,this.crop=i,this.projection=r,this.axis=s,this.side=a,this.size=n,this.blending=o,this.mat=l,this.isMask=d,this.alpha=h,this.mode=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){e.require("position"),e.require("normal"),e.require("uv"),e.requires.uv=[!0],e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0;let i=`g${this.uuid.toString().replace(/-/g,"")}`,r;switch(this.projection.value){case 3:r=e.include(g2.Nodes.cylindrical);break;case 2:r=e.include(g2.Nodes.spherical);break;case 1:let a=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],n=["zy","xz","xy"][this.axis.value],o=new Pe(`
		vec3 ${i}_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 projected = (1. + (position.${n})) / 2.;
				vec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, ${a}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`);r=e.include(o);break;case 4:r=e.include(g2.Nodes.triplanar);break;default:r=e.include(g2.Nodes.uv);break}e.addFragmentVariable(this.calpha,"float");let s=[];if(s.push("normal"),s.push(this.texture.generate(e,"t")),s.push(this.textureSize.build(e,"v2")),s.push(this.crop.build(e,"f")),s.push(this.mat.build(e,"mat3")),s.push(this.size.build(e,"v2")),s.push(this.blending.build(e,"f")),s.push(this.isMask.build(e,"b")),s.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),s.push(this.alpha.build(e,"f")),s.push(this.mode.build(e,"i")),s.push(this.calpha),this.projection.value===4){let a=`${i}_writeUvs`,n=a+"0",o=a+"1",l=a+"2",h=`${i}_triplanarWeights`;e.addFragmentVariable(n,"vec2"),e.addFragmentVariable(o,"vec2"),e.addFragmentVariable(l,"vec2"),e.addFragmentVariable(h,"vec3"),s.push(n),s.push(o),s.push(l),s.push(h)}else{let a=`${i}_writeUvs`;e.addFragmentVariable(a,"vec2"),s.push(a)}return e.format(r+"("+s.join(",")+")",this.getType(e),t)}},e5=g2;e5.Nodes=function(){let e=new Pe(`
vec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),t=new Pe(`
vec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),i=new Pe(`vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`),r=new Pe(`vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {
				vec3 p = position;
				vec2 uv0 = (1.0 + p.xy) / 2.0;     
				vec2 uv1 = (1.0 + p.zy) / 2.0;		
				vec2 uv2 = (1.0 + p.xz) / 2.0;		
	
				uv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;

				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));

				// Write out all sets of UVs that we generated
				writeUvs0 = uv0;
				writeUvs1 = uv1;
				writeUvs2 = uv2;
				writeWeights = weights;

				// Derivatives for LOD
				vec2 df0 = fwidth(uv0);
				vec2 df1 = fwidth(uv1);
				vec2 df2 = fwidth(uv2);
				if (df0.x > 0.5) df0.x = 0.0;
				if (df1.x > 0.5) df1.x = 0.0;
				if (df2.x > 0.5) df2.x = 0.0;

				#ifdef GL_EXT_shader_texture_lod
                	vec4 tmp = 
						texture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						texture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						texture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#else
                	vec4 tmp = 
						textureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						textureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						textureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;

				// Apply cropping across all 3 planes
				if ( crop > 0.5 ) {
					if ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;//n * 0.5 + 0.5;
			}			
			`);return{cylindrical:e,spherical:t,uv:i,triplanar:r}}();var v2=class extends Gt{constructor(e,t,i,r,s,a,n,o,l,h,c,d){super("v3"),this.nodeType="Depth",this.gradientType=e,this.smooth=t,this.near=i,this.far=r,this.isVector=s,this.isWorldSpace=a,this.origin=n,this.direction=o,this.colors=l,this.steps=h,this.isMask=d,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let i=`g${this.uuid.toString().replace(/-/g,"")}`,r=new Pe(`vec3 ${i}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${i}_MAX_COLORS], float steps[${i}_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${i}_IS_VECTOR
                   #ifdef ${i}_LINEAR
                       #ifdef ${i}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${i}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${i}_SMOOTH
				for ( int i = 1; i < ${i}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${i}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a * mask;
               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
			   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
			   
               return color.rgb;
			}`,[v2.Nodes.vectorLinearWorldSpaceDepth,v2.Nodes.vectorLinearObjectSpaceDepth,v2.Nodes.vectorSphericalObjectSpaceDepth,v2.Nodes.vectorSphericalWorldSpaceDepth]);if(e.isShader("fragment")){e.define(`${i}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&e.define(`${i}_SMOOTH`),this.isVector.value>.5&&e.define(`${i}_IS_VECTOR`),this.gradientType.value===0&&e.define(`${i}_LINEAR`),this.isWorldSpace.value>.5&&e.define(`${i}_WORLDSPACE`),e.require("worldPosition"),e.addFragmentVariable(this.calpha,"float");let s=e.include(r),a=[];return a.push(this.near.build(e,"f")),a.push(this.far.build(e,"f")),a.push(this.origin.build(e,"v3")),a.push(this.direction.build(e,"v3")),a.push(this.colors.build(e,"v4[]")),a.push(this.steps.build(e,"f[]")),a.push(this.isMask.build(e,"b")),a.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),a.push(this.alpha.build(e,"f")),a.push(this.calpha),e.format(s+"("+a.join(",")+")",this.getType(e),t)}else return""+e.shader,e.format("vec3( 0.0 )",this.getType(e),t)}},rb=v2;rb.Nodes=function(){let e=new Pe(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),t=new Pe(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),i=new Pe(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),r=new Pe(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:e,vectorLinearObjectSpaceDepth:t,vectorSphericalWorldSpaceDepth:i,vectorSphericalObjectSpaceDepth:r}}();var Yj=class extends Gt{constructor(e,t,i,r,s,a,n,o){super("v3"),this.nodeType="Fresnel",this.color=e,this.bias=t,this.scale=i,this.intensity=r,this.factor=s,this.isMask=o,this.alpha=a,this.mode=n,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let i=new Pe(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {
					float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

					float lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return color;
				}`),r=e.include(i),s=[];return s.push(this.color.build(e,"c")),s.push(this.bias.build(e,"f")),s.push(this.scale.build(e,"f")),s.push(this.intensity.build(e,"f")),s.push(this.factor.build(e,"f")),s.push(this.isMask.build(e,"b")),s.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),s.push(this.alpha.build(e,"f")),s.push(this.mode.build(e,"i")),s.push(this.calpha),e.format(r+"("+s.join(",")+")",this.getType(e),t)}else return""+e.shader,e.format("vec3( 0.0 )",this.getType(e),t)}},sb=class extends Gt{constructor(e,t,i,r,s,a,n,o,l){super("v3"),this.nodeType="Gradient",this.gradientType=e,this.smooth=t,this.colors=i,this.steps=r,this.offset=s,this.morph=a,this.angle=n,this.isMask=l,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.define("GRAD_MAX",10),e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let i=e.include(sb.Nodes.gradient),r=[];return r.push(this.gradientType.build(e,"i")),r.push(this.smooth.build(e,"b")),r.push(this.colors.build(e,"v4[]")),r.push(this.steps.build(e,"f[]")),r.push(this.offset.build(e,"v2")),r.push(this.morph.build(e,"v2")),r.push(this.angle.build(e,"f")),r.push(this.isMask.build(e,"b")),r.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.calpha),e.format(i+"("+r.join(",")+")",this.getType(e),t)}else return""+e.shader,e.format("vec3( 0.0 )",this.getType(e),t)}},ab=sb;ab.Nodes=function(){return{gradient:new Pe(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
				
				return color.xyz;
			}`)}}();var nb=class extends Gt{constructor(e,t,i,r,s){super("v3"),this.nodeType="Matcap",this.texture=e,this.isMask=r,this.alpha=t,this.mode=i,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`,this.rotation=s}generate(e,t){if(e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let i=e.include(nb.Nodes.matcap);e.require("normal"),e.requires.normal=!0;let r=[];return r.push(this.texture.generate(e,"t")),r.push("normal"),r.push(this.isMask.build(e,"b")),r.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),r.push(this.calpha),r.push(this.rotation.build(e,"f")),e.format(i+"("+r.join(",")+")",this.getType(e),t)}else return""+e.shader,e.format("vec3( 0.0 )",this.getType(e),t)}},ob=nb;ob.Nodes=function(){return{matcap:new Pe(`vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha, float rotation) {
					vec3 viewDir = normalize( vViewPosition );
					vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
					vec3 y = cross( viewDir, x );
					vec2 uv = vec2( dot( x, normal ), dot( y, normal ) );
					uv = mat2( cos(rotation), sin(rotation), -sin(rotation), cos(rotation) ) * uv;
					uv = uv * 0.495 + 0.5;
					vec4 matcapColor = texture2D( matcapTex, uv );

					float lalpha = alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
					
					return matcapColor.rgb;
            	}`)}}();var t5=(e=>(e.SIMPLEX="simplex3d",e.SIMPLEX_FRACTAL="simplex3dFractal",e.ASHIMA="simplexAshima",e.FBM="fbm",e.PERLIN="perlin",e.VORONOI="voronoi",e))(t5||{}),z1=function(){let e=new Pe(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),t=new Pe(`float simplex3d(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[e]);t.keywords.F3=new Nt("float F3 0.3333333"),t.keywords.G3=new Nt("float G3 0.1666667");let i=new Pe(`float simplex3dFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplex3d(m * rot1)
				 + 0.2666667 * simplex3d(2.0 * m * rot2)
				 + 0.1333333 * simplex3d(4.0 * m * rot3)
				 + 0.0666667 * simplex3d(8.0 * m);
		}`,[t]),r=new Pe("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),s=new Pe("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),a=new Pe(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[r,s]),n=new Pe("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),o=new Pe("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[n]),l=new Pe(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[o]),h=new Pe(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[l]);h.keywords.NUM_OCTAVES=new Nt("int NUM_OCTAVES 5");let c=new Pe("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),d=new Pe(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[r,s,c]),u=new Pe(`float hashwithoutsine13(vec3 p3)
		{
			p3  = fract(p3 * .1031);
			p3 += dot(p3, p3.yzx + 33.33);
			return fract((p3.x + p3.y) * p3.z);
		}`),p=new Pe(`vec3 hashwithoutsine33(vec3 p3)
		{
			p3 = fract(p3 * vec3(.1031, .1030, .0973));
			p3 += dot(p3, p3.yxz+33.33);
			return fract((p3.xxy + p3.yxx)*p3.zyx);
		}`),f=new Pe(`float metric(in vec3 p)
		{
			// L2 
			return length(p);

			// Chebyshev 
			// vec3 a = abs(p);
			// return max(a.x, max(a.y, a.z));
		}`),g=new Pe(`float smin( float a, float b, float k )
		{
			float h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);
			float correction = k * h * (1.0 - h);
			return mix(b, a, h) - correction;
		}`),m=new Pe(`float smax( float a, float b, float k )
		{
			float h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);
			float correction = k * h * (1.0 - h);
			return mix(a, b, h) + correction;
		}`),v=new Pe(`float remap(float value, float input_min, float input_max, float output_min, float output_max) {
			// Compute width of each interval
			float input_width = input_max - input_min;
			float output_width = output_max - output_min;
		
			// Convert input range into a 0-1 range 
			float scaled = (value - input_min) / input_width;
		
			// Convert the 0-1 range into a value in output range
			return output_min + (scaled * output_width);
		}`),y=new Pe(`float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) 
		{
			// Integer and fractional parts of this point's coordinates
			ivec3 p = ivec3(floor(x));
			vec3 f = fract(x);

			// Different variables that we will use to construct noise:
			//
			// f1: distance to the closest feature point
			// f2: distance to the second closest feature point
			// e: distance to the closest edge (cell boundary)
			//
			// We also compute "smooth" versions of all of the above quantites, essentially
			// replacing "hard" minimums with "smooth" minimums (described by IQ)
			float f1_smooth = 8.0;
			float f1 = 8.0;
			float f2_smooth = 8.0;
			float f2 = 8.0;
			float e_smooth = 8.0;
			float e = 8.0;

			// Variables stored from closest cell
			ivec3 mb;
			vec3 mr; 

			int steps = quality;
			
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				ivec3 b = ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d = length(r);
				
				f1_smooth = smin(d, f1_smooth, smoothness);

				// Store un-smoothed distances too 
				if (d < f1) 
				{
					f2 = f1;
					f1 = d;

					mb = ivec3(x, y, z);
					mr = r;
				} 
				else if (d < f2) 
				{
					f2 = d;
				}
			}	
			
			float id = hashwithoutsine13(vec3(p + mb) + seed);

			// Second pass for edge distance  
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				// Start search at the cell that contains the closest point to "x" (found in 1st pass)
				ivec3 b = mb + ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d1 = dot(0.5 * (mr + r), (r - mr)); 				// IQ normalizes "r - mr" but that breaks things for the smooth version?
				float d2 = dot(0.5 * (mr + r), normalize(r - mr));

				e_smooth = smin(d1, e_smooth, smoothness);

				e = min(e, d2);

				// Also compute a smooth version of F2 in this pass
				{
					ivec3 b = ivec3(x, y, z);
					if (b != mb) 
					{
						vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
						float d = length(r);

						f2_smooth = smin(d, f2_smooth, smoothness);
					}
				}
			}

			// Different visualization modes 
			if (style == 0) 
			{
				return f1_smooth;
			}
			if (style == 1) 
			{
				return f2_smooth;
			}
			if (style == 2) 
			{
				return f2_smooth - f1_smooth;
				
				// "Pebbles" also cool
				//return step(0.2, f2_smooth - f1_smooth);
			}
			if (style == 3) 
			{
				// This one is really good for rock / stone effects
				float a = f1; 
				float b = f2;
				float k = 3.0;
				float h = max(k - abs(a - b), 0.0) / k;
				float final = min(a, b) - h * h * k * (1.0 / 4.0);
				return final;
			}
			if (style == 4) 
			{
				// Some random adjustments to make this style stand out more 
				return exp(5.0 * e_smooth);
			}
			if (style == 5) 
			{
				return pow(f1_smooth, 3.0);
			}
			if (style == 6) 
			{				
				const float eps = 0.0125;

				// Thicker lines as the user increases the smoothness slider
				float thickness = smoothness * 0.25 + eps;

				// Blurrier lines as the user increases the smoothness slider
				float blur = pow(smoothness, 3.0) * 0.25 + eps;

				return smoothstep(
					thickness - thickness * blur, 
					thickness + thickness * blur, 
					e
				);
			}
			if (style == 7) 
			{
				return hashwithoutsine13(vec3(p + mb) + seed);
			}
		}
	`,[u,p,f,g,m,v]);return{simplex:t,simplexFractal:i,simplexAshima:a,fbm:h,perlin:d,voronoi:y}}(),lb=class extends Gt{constructor(e,t,i,r,s,a,n,o,l,h,c,d,u,p,f,g,m,v,y){super("v3"),this.nodeType="Noise",this.scale=e,this.size=t,this.move=i,this.fA=r,this.fB=s,this.distortion=a,this.colorA=n,this.colorB=o,this.colorC=l,this.colorD=h,this.noiseType=d,this.voronoiStyle=p,this.highCut=f,this.lowCut=g,this.smoothness=m,this.seed=v,this.quality=y,this.isMask=u,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t,i,r,s){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let a=Object.values(t5)[this.noiseType.value],n=a=="voronoi"?`
		float v = ${a}(st + move, voronoiStyle, smoothness, seed, quality);

		// Apply clipping to colors
		v = remap(v, lowCut, highCut, 0.0, 1.0);
		v = smax(v, 0.0, smoothness * 0.25);
		v = smin(v, 1.0, smoothness * 0.25);

		// Note that the voronoi mode only uses colors "A" and "C" from the UI 
		vec4 color = mix(colorA, colorC, v); 
		`:`
		vec3 q = vec3(${a}(st),
					   ${a}(st + vec3(1.0)),
					   ${a}(st + vec3(1.0)));
		vec3 r = vec3(${a}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
					  ${a}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
					  ${a}(st * q));
		float f = ${a}(st + r);
		vec4 color;
		color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
		color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
		color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));
		`,o=new Pe(`vec3 ${a}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) 
			{
                // Prevent scale of zero 
				scale = max(abs(scale), 0.001);

				vec3 st = position / size;
				st /= scale;

				${n}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return clamp(color, 0.0, 1.0).rgb;
			}`,[z1.simplex,z1.simplexFractal,z1.simplexAshima,z1.fbm,z1.perlin,z1.voronoi]),l=e.include(o),h=[];return h.push(this.scale.build(e,"f")),h.push(this.size.build(e,"v3")),h.push(this.move.build(e,"f")),h.push(this.fA.build(e,"v2")),h.push(this.fB.build(e,"v2")),h.push(this.distortion.build(e,"v2")),h.push(this.colorA.build(e,"v4")),h.push(this.colorB.build(e,"v4")),h.push(this.colorC.build(e,"v4")),h.push(this.colorD.build(e,"v4")),h.push(this.voronoiStyle.build(e,"i")),h.push(this.highCut.build(e,"f")),h.push(this.lowCut.build(e,"f")),h.push(this.smoothness.build(e,"f")),h.push(this.seed.build(e,"f")),h.push(this.quality.build(e,"i")),h.push(this.isMask.build(e,"b")),h.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),h.push(this.alpha.build(e,"f")),h.push(this.calpha),e.format(l+"("+h.join(",")+")",this.getType(e),t)}};lb.numOctaves=5;var hb=class extends Gt{constructor(e,t,i,r,s,a,n,o,l,h,c,d,u,p,f,g){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=e,this.contourColor=t,this.outlineWidth=i,this.contourWidth=r,this.contourThreshold=s,this.outlineThreshold=a,this.contourFrequency=n,this.outlineSmoothing=o,this.contourDirection=l,this.positionalLines=h,this.compensation=c,this.resolution=d,this.normalMap=u,this.depthMap=p,this.pixelRatio=f,this.alpha=g,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let i=`g${this.uuid.toString().replace(/-/g,"")}`;if(e.require("vWorldViewDir"),e.require("worldNormal"),e.extensions.derivatives=!0,this.compensation.value&&e.define("OUTLINE_COMPENSATION",`${i}_offset`),this.firstTime){let r=this.outlineWidth.build(e,"f"),s=this.resolution.build(e,"v2"),a=this.compensation.build(e,"b"),n=this.pixelRatio.build(e,"f");e.addVertexParsVariable("randomColor","attribute vec3"),e.addVertexParsVariable("extrudeNormal","attribute vec3"),e.addVertexParsVariable(r,"uniform float"),e.addVertexParsVariable(s,"uniform vec2"),e.addVertexParsVariable(a,"uniform bool"),e.addVertexParsVariable(n,"uniform float"),e.addVertexParsVariable("vID","flat out float"),e.addFragmentParsVariable("vID","flat in float"),e.addVertexFinalCode(`
                vID = randomColor.r;
                vec2 ${i}_offset = vec2(0.0);
                if (${a}) {
                    vec4 ${i}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${i}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    ${i}_offset = normalize(${i}_clipNormal.xy) / ${s} * (${r} / 2.0) * ${i}_clipPosition.w * 2.0 * ${n};
                    ${i}_clipPosition.xy += ${i}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${i}_clipPosition;
                }
            `)}if(e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include(hb.Nodes.outline),s=[];return s.push(this.outlineColor.build(e,"c")),s.push(this.contourColor.build(e,"c")),s.push(this.outlineWidth.build(e,"f")),s.push(this.contourWidth.build(e,"f")),s.push(this.contourThreshold.build(e,"f")),s.push(this.outlineThreshold.build(e,"f")),s.push(this.contourFrequency.build(e,"f")),s.push(this.outlineSmoothing.build(e,"f")),s.push(this.contourDirection.build(e,"v3")),s.push(this.positionalLines.build(e,"b")),s.push(this.resolution.build(e,"v2")),s.push(this.normalMap.getTexture(e,"t")),s.push(this.depthMap.getTexture(e,"t")),s.push(this.pixelRatio.build(e,"f")),s.push(this.compensation.build(e,"b")),s.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),s.push(this.alpha.build(e,"f")),s.push(this.calpha),this.firstTime=!this.firstTime,e.format(r+"("+s.join(",")+")",this.getType(e),t)}else return""+e.shader,""}},cb=hb;cb.Nodes=function(){let e=new Pe(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    vec2 texelSize = (vec2(1.0) / resolution);
    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);
	uvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);
	uvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);
	uvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);
	uvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);
	uvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);
	uvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);
  	vec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new Pe(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                //resultAlpha = 1.0;
                //result = vec3(sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha * mask;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				 
                 return result;
             }`,[e])}}();var Ls=class extends Gt{constructor(e,t,i,r,s,a,n,o,l,h,c,d,u,p,f,g,m,v){super("v3"),this.nodeType="Pattern",this.style=e,this.projection=t,this.axis=i,this.blending=r,this.offset=s,this.colorA=a,this.colorB=n,this.frequency=o,this.size=l,this.variation=h,this.smoothness=c,this.zigzag=d,this.rotation=u,this.vertical=p,this.horizontal=f,this.sides=g,this.isMask=v,this.alpha=m,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.require("position"),e.require("uv"),e.requires.uv=[!0],e.require("normal"),e.requires.normal=!0,e.addFragmentVariable(this.calpha,"float");let i;switch(this.style.value){case 0:i="circle";break;case 1:i="ring";break;case 2:i="polygon";break;case 3:i="xcross";break;case 4:i="diamond";break;case 5:i="checkerboard";break;case 6:i="line";break;case 7:i="wave";break;default:i="circle";break}let r=`g${this.uuid.toString().replace(/-/g,"")}`,s=new Pe(`float hashwithoutsine12(vec2 p)
				{
					vec3 p3 = fract(vec3(p.xyx) * .1031);
					p3 += dot(p3, p3.yzx + 33.33);
					return fract((p3.x + p3.y) * p3.z);
				}`),a=new Pe(`vec2 rotate_uv(in vec2 uv, float a, bool repeat) 
				{
					const float mid = 0.5;
					float radians = a * (PI / 180.0);
					vec2 rotated = vec2(
						cos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,
						cos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid
					);
					return repeat ? fract(rotated): rotated;
				}`),n="";if(this.projection.value===4){let c=this.style.value===2?`${i}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,d=this.style.value===2?`${i}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,u=this.style.value===2?`${i}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)`;n=`
				vec3 p = position;
				float factor = 0.0125;
				vec2 uv0 = fract(p.xy * factor);
				vec2 uv1 = fract(p.zy * factor);
				vec2 uv2 = fract(p.xz * factor);
				
				uv0 = rotate_uv(uv0 + offset, rotation, true);
				uv1 = rotate_uv(uv1 + offset, rotation, true);
				uv2 = rotate_uv(uv2 + offset, rotation, true);
	
				float d0 = ${c};
				float d1 = ${d};
				float d2 = ${u};
				
				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));
				d0 *= weights.z;
				d1 *= weights.x;
				d2 *= weights.y;
				float draw = d0 + d1 + d2;
	
				vec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;
				`}else{let c=this.style.value===2?`${i}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,d="";this.axis.value===0?d=`float radius = length(p);
					float theta = atan(p.y, p.z);
					float phi = acos(p.x / radius);`:this.axis.value===1?d=`float radius = length(p);
					float theta = atan(p.x, p.z);
					float phi = acos(p.y / radius);`:(this.axis.value,d=`float radius = length(p);
					float theta = atan(p.y, p.x);
					float phi = acos(p.z / radius);`);let u="";switch(this.projection.value){case 0:u="custom_uv = vUv.st;";break;case 1:break;case 2:u=`
							vec3 p = position;
							${d}
							custom_uv = vec2(theta, phi);
							custom_uv /= PI;
							`;break}n=`
				vec2 custom_uv;
				${u}
	
				custom_uv += offset;
				custom_uv = fract(custom_uv);
				custom_uv = rotate_uv(custom_uv, rotation, true);
	
				float draw = ${c};
				`}let o=new Pe(`vec3 ${r}_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {
					const float TWO_PI = PI * 2.0;
					float smoothness_remapped = pow(smoothness, 5.0);	

					${n}

					// Construct final output color
					vec4 color = mix(colorA, colorB, draw);
					color.a = clamp(color.a, 0.0, 1.0);

					// Apply cuts
					color.a *= 
						step(vertical.x, custom_uv.y) * 
						step(custom_uv.y, vertical.y);
					color.a *= 
						step(horizontal.x, abs(custom_uv.x)) * 
						step(abs(custom_uv.x), horizontal.y);

					// Accumulate alpha 
					float lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return clamp(color, 0.0, 1.0).rgb;
				}`,[a,s,Ls.DrawFunctions.circle,Ls.DrawFunctions.ring,Ls.DrawFunctions.polygon,Ls.DrawFunctions.cross,Ls.DrawFunctions.diamond,Ls.DrawFunctions.checkerboard,Ls.DrawFunctions.line,Ls.DrawFunctions.wave]),l=e.include(o),h=[];return h.push("normal"),h.push(this.blending.build(e,"f")),h.push(this.style.build(e,"i")),h.push(this.offset.build(e,"v2")),h.push(this.colorA.build(e,"v4")),h.push(this.colorB.build(e,"v4")),h.push(this.frequency.build(e,"v2")),h.push(this.size.build(e,"f")),h.push(this.variation.build(e,"f")),h.push(this.smoothness.build(e,"f")),h.push(this.zigzag.build(e,"f")),h.push(this.rotation.build(e,"f")),h.push(this.vertical.build(e,"v2")),h.push(this.horizontal.build(e,"v2")),h.push(this.sides.build(e,"i")),h.push(this.isMask.build(e,"b")),h.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),h.push(this.alpha.build(e,"f")),h.push(this.calpha),e.format(l+"("+h.join(",")+")",this.getType(e),t)}else return""+e.shader,e.format("vec3(0.0)",this.getType(e),t)}},db=Ls;db.DrawFunctions=function(){let e=new Pe(`float hashwithoutsine12(vec2 p) {
				vec3 p3 = fract(vec3(p.xyx) * 0.1031);
				p3 += dot(p3, p3.yzx + 33.33);
				return fract((p3.x + p3.y) * p3.z);
			}`),t=new Pe(`vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {
                // Create tiles in UV-space
                uv *= frequency;

                // Integer coords
                vec2 i = floor(uv);

                // Offset every other row based on zigzag param, then compute fractional coords
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = fract(uv);

				// Rotate the tile itself:
				// const float mid = 0.5;
				// f = vec2(
				// 	cos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,
				// 	cos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid
				// );
				// f = fract(f);

                f = f * 2.0 - 1.0;

				// Recompute integer coords after shifting - then, random value per tile 
				i = floor(uv);
				float rand = (hashwithoutsine12(i) * 5.0 + 1.0);
				float jitter = mix(1.0, rand, variation);
				f *= jitter;

                return f;
            }`,[e]),i=new Pe(`float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(
                    -smoothness, 
                     smoothness, 
                     length(f) - size
                );
            }`,[t]),r=new Pe(`float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);

				float d = length(f);
                const float inner_width = 0.5;

                float outer = smoothstep(-smoothness, smoothness, d - size);
                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);
				return outer + (1.0 - inner);   
            }`,[t]),s=new Pe(`float sdf_ngon(in vec2 p, in float r, in int n) {
                float an = (PI * 2.0) / float(n);
                float he = r * tan(0.5 * an);
                
                // Rotate to first sector
                p = -p.yx; 
                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);
                vec2  cs = vec2(cos(bn), sin(bn));
                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;
            
                // Side of polygon
                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);
            }
            
            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));
            }`,[t]),a=new Pe(`float sdf_cross(in vec2 p, in vec2 b, float r ) {
                p = abs(p); 
				p = (p.y > p.x) ? p.yx : p.xy;
                vec2  q = p - b;
                float k = max(q.y, q.x);
                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);
                return sign(k) * length(max(w, 0.0)) + r;
            }
            
            // Avoid namespace conflicts 
            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));
            }`,[t]),n=new Pe(`float ndot(vec2 a, vec2 b) { 
                return a.x*b.x - a.y*b.y; 
            }
            
            float sdf_diamond(in vec2 p, in vec2 b) {
                p = abs(p);
                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);
                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));
                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);
            }

            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
	            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));
            }`,[t]),o=new Pe(`float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                uv *= frequency;
                vec2 i = floor(uv);

                float offset = mod(i.y, 2.0);

                uv.x += offset + zigzag * offset;
                float x = floor(uv.x);
                
                return mod(x, 2.0);
            }`),l=new Pe(`float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);
				
				// Different approach for variation param here
				float row = floor(uv * frequency).y;
				float rand = hashwithoutsine12(vec2(row));
				float s = mix(size, size * rand, variation);

				return smoothstep(
					s - smoothness, 
					s + smoothness, 
					abs(f.y)
				);
            }`,[t]),h=new Pe(`// Uses bisection 
            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {
                // Convert all data to a primitive cosine wave
                p = c * (p - vec2(d, a));
                
                const float TWO_PI = PI * 2.0;

                // Reduce to principal half cycle
                p.x = mod(p.x, TWO_PI); 
                if (p.x > PI) {
                    p.x = TWO_PI - p.x;
                }
            
                // Find zero of derivative (minimize distance)
                float xa = 0.0;
                float xb = TWO_PI;

                // 24 bit precision
                for (int i = 0; i < 24; i++) {
                    float x = 0.5 * (xa + xb);
                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));
                    if (y < 0.0) xa = x; 
                    else xb = x;
                }
                float x = 0.5 * (xa + xb);
                
                // Compute distance    
                vec2 q = vec2(x, b * c * cos(x));
                return length(p - q) / c;
            }

            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                float repeat = frequency.x;
                uv *= repeat;
                vec2 i = floor(uv);
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = vec2(uv.x, fract(uv.y));

                // Generalized cosine: y(x) = a + b * cos(cx + d)
                const float amplitude = 0.125;
                float wave_frequency = frequency.y * 0.1;
                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);

				// Different approach for variation param here
				float rand = hashwithoutsine12(vec2(i.y));
				float s = mix(size, size * rand, variation);

                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);
            }`);return{tileAndCenter:t,circle:i,ring:r,polygon:s,cross:a,diamond:n,checkerboard:o,line:l,wave:h}}();var ub=class extends Gt{constructor(e,t,i,r,s,a,n,o){super("v3"),this.nodeType="Rainbow",this.filmThickness=e,this.movement=t,this.wavelengths=i,this.noiseStrength=r,this.noiseScale=s,this.offset=a,this.isMask=o,this.alpha=n,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let i=e.include(ub.Nodes.rainbow),r=[];return r.push(this.filmThickness.build(e,"f")),r.push(this.movement.build(e,"f")),r.push(this.wavelengths.build(e,"v3")),r.push(this.noiseStrength.build(e,"f")),r.push(this.noiseScale.build(e,"f")),r.push(this.offset.build(e,"v3")),r.push(this.isMask.build(e,"b")),r.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.calpha),e.format(i+"("+r.join(",")+")",this.getType(e),t)}else return""+e.shader,e.format("vec3( 0.0 )",this.getType(e),t)}},pb=ub;pb.Nodes=function(){let e=new Pe(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
                 vec3 st = position / noiseScale;
				 vec3 q = vec3(simplex3d(st),
							  simplex3d(st + vec3(1.0)),
							  simplex3d(st + vec3(1.0)));

				 vec3 r = vec3(simplex3d(st + vec3(1.4, 1.3, 1.0) * q + vec3(1.7, 9.2, 1.0)),
							  simplex3d(st + vec3(2.0, 1.2, 1.0) * q + vec3(8.3, 2.8, 1.0)),
							  simplex3d(st * q));

                 float noise = simplex3d(st + r);

                 return .5 + .5 * cos((((filmThickness + (noise * noiseStrength)) / (vec3(wavelengths.r * 1.0, wavelengths.g * 0.8, wavelengths.b * 0.6) + 1.0)) * dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal))) + movement);
             }`,[z1.simplex]);return{rainbow:new Pe(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {
				vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

				float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);

				float lalpha = alpha * rainbowContribution * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return res;
             }`,[e])}}();var fb=class extends Gt{constructor(e,t,i,r,s,a,n,o,l,h){super("v3"),this.nodeType="Toon",this.positioning=e,this.colors=t,this.steps=i,this.source=r,this.isWorldSpace=s,this.noiseStrength=a,this.noiseScale=n,this.shadowColor=o,this.offset=l,this.alpha=h,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("worldNormal"),e.require("worldPosition"),e.isShader("fragment")){e.define("COLORS_MAX",10),e.addFragmentVariable(this.calpha,"float");let i=e.include(fb.Nodes.toon),r=[];return r.push(this.positioning.build(e,"i")),r.push(this.colors.build(e,"v4[]")),r.push(this.steps.build(e,"f[]")),r.push(this.source.build(e,"v3")),r.push(this.isWorldSpace.build(e,"b")),r.push(this.noiseStrength.build(e,"f")),r.push(this.noiseScale.build(e,"f")),r.push(this.shadowColor.build(e,"v4")),r.push(this.offset.build(e,"v3")),r.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.calpha),e.format(i+"("+r.join(",")+")",this.getType(e),t)}else return""+e.shader,e.format("vec3( 0.0 )",this.getType(e),t)}},mb=fb;mb.Nodes=function(){let e=new Pe(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),t=new Pe(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),i=new Pe(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[t]),r=new Pe(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),s=new Pe(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[r]);return{toon:new Pe(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplex3d(st),
					// 	simplex3d(st + vec3(111.1, 143.89, 217.19)),
					// 	simplex3d(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[z1.simplex,e,i,s])}}();var Xj=function(){return{textureBicubic:new Pe(`float w0( float a ) {
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
        }
    
        float w1( float a ) {
            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
        }
    
        float w2( float a ){
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
        }
    
        float w3( float a ) {
            return ( 1.0 / 6.0 ) * ( a * a * a );
        }
    
        // g0 and g1 are the two amplitude functions
        float g0( float a ) {
            return w0( a ) + w1( a );
        }
    
        float g1( float a ) {
            return w2( a ) + w3( a );
        }
    
        // h0 and h1 are the two offset functions
        float h0( float a ) {
            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
        }
    
        float h1( float a ) {
            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
        }
    
        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
            uv = uv * texelSize.zw + 0.5;
    
            vec2 iuv = floor( uv );
            vec2 fuv = fract( uv );
    
            float g0x = g0( fuv.x );
            float g1x = g1( fuv.x );
            float h0x = h0( fuv.x );
            float h1x = h1( fuv.x );
            float h0y = h0( fuv.y );
            float h1y = h1( fuv.y );
    
            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + 
                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
        }

        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
            vec2 fLodSizeInv = 1.0 / fLodSize;
            vec2 cLodSizeInv = 1.0 / cLodSize;
            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
            return mix( fSample, cSample, fract( lod ) );
        }`)}}();function Qj(e,t){return e>=t?new j(t/e,1):new j(1,e/t)}var gb=class extends Gt{constructor(e,t,i,r,s,a,n,o){super("v3"),this.nodeType="Transmission",this.thickness=e,this.ior=t,this.roughness=i,this.transmissionSamplerSize=r,this.transmissionSamplerMap=s,this.transmissionDepthMap=a,this.aspectRatio=n,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0,e.isShader("fragment")){e.define("NUM_SAMPLES",6),e.define("BLUR_SLOD",Math.pow(2,tt.transmissionLod.value)),e.require("worldPosition"),e.requires.worldNormal=!0,e.requires.modelMatrix=!0,e.requires.projectionMatrix=!0,e.addFragmentVariable(this.calpha,"float");let i=e.include(gb.Nodes.transmission),r=[];return r.push(this.thickness.build(e,"f")),r.push(this.ior.build(e,"f")),r.push(this.roughness.build(e,"f")),r.push(this.transmissionSamplerSize.build(e,"v2")),r.push(this.transmissionSamplerMap.getTexture(e,"t")),r.push(this.transmissionDepthMap.getTexture(e,"t")),r.push(this.aspectRatio.build(e,"v2")),r.push("normal"),r.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.calpha),e.format(i+"("+r.join(",")+")",this.getType(e),t)}else return""+e.shader,e.format("vec3( 0.0 )",this.getType(e),t)}},vb=gb;vb.Nodes=function(){let e=new Pe(`vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

				// Special case for blur == 0.0
				if (lod == 0.0) {
					#ifdef TEXTURE_LOD_EXT
					return texture2DLodEXT( sp, U, 0.0).rgb;
					#else
					return textureLod( sp, U, 0.0).rgb;
					#endif
				}
				
				vec2 texelSize = vec2(1.0) / resolution;
                vec2 halton = haltonSequence[frameIndex];
                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
                float temporalAngle  = temporalOffset * PI2;
				vec3 res = vec3(0.0);
                vec2 uv = vec2(0.0);
                vec2 offset = vec2(0.0);
                vec2 vogelSample = vec2(0.0);
                for (int i = 0; i < NUM_SAMPLES; i++) {
                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;
                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20
                    uv = U + offset;
                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    res += textureLod(sp, uv, lod).rgb;
                }
                return res / float(NUM_SAMPLES);
            }`),t=new Pe(`vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        
				// Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		        // The thickness is specified in local space
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),i=new Pe(`float applyIorToRoughness( float roughness, float ior ) {
				// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
				// an IOR of 1.5 results in the default amount of microfacet refraction.
				return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
			}`),r=new Pe(`vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
				// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see
				// also the code in convertTransmission.ts, which runs during export
				#ifdef IS_THREEJS_EXPORT
					float lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);
					return textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;
				#else
					float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
					float lod = applyIorToRoughness(roughness, ior);
					return blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
				#endif
			}`,[Xj.textureBicubic,i,e]),s=new Pe(`vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;

				// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
				vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;

				vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
				vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
				unrefractedCoords += 1.0;
				unrefractedCoords /= 2.0;

				// Sample framebuffer to get pixel the refracted ray hits.
				return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    		}`,[r,t]);return{transmission:new Pe(`vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return transmission;
            }`,[s])}}();var wf=(e=>(e.NOISE="noise",e.MAP="map",e))(wf||{}),yb=class extends Gt{constructor(e,t,i,r,s,a,n,o,l,h,c){super("v3"),this.displacementTypeIndex=new qt(0),this.nodeType="VertexDisplacement",this.intensity=e,this.movementOrTexture=t,Object.values(wf)[this.displacementTypeIndex.value]==="map"&&(this.mat=new $x(this.movementOrTexture.value.matrix)),this.cropOrOffset=i,this.scale=h,this.noiseFunctionIndex=c,this.voronoiStyle=r,this.smoothness=s,this.seed=a,this.highCut=n,this.lowCut=o,this.quality=l}generate(e,t){if(e.isShader("vertex")){e.define("USE_LAYER_DISPLACE");let i,r=[];switch(r.push("displaced_position"),r.push("displaced_normal"),Object.values(wf)[this.displacementTypeIndex.value]){case"map":{i=e.include(yb.Nodes.map),r.push(this.movementOrTexture.getTexture(e,"t")),r.push("uv"),r.push(this.cropOrOffset.build(e,"f")),this.mat&&r.push(this.mat.build(e,"mat3"));break}case"noise":{let s=Object.values(t5)[this.noiseFunctionIndex.value],a=new Pe(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),n=s=="voronoi"?`
					float v = ${s}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);
					v = remap(v, lowCut, highCut, 0.0, 1.0);
					v = smax(v, 0.0, smoothness * 0.25);
					v = smin(v, 1.0, smoothness * 0.25);

					return p + n * v * intensity;
					`:`
					return p + n * ${s}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
					`,o=new Pe(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {
							${n}
						}`,[z1.simplex,z1.simplexFractal,z1.simplexAshima,z1.fbm,z1.perlin,z1.voronoi]),l=new Pe(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[o,a]);i=e.include(l),r.push(this.scale.build(e,"f")),r.push(this.cropOrOffset.build(e,"v3")),r.push(this.movementOrTexture.build(e,"f")),r.push(this.voronoiStyle.build(e,"i")),r.push(this.smoothness.build(e,"f")),r.push(this.seed.build(e,"f")),r.push(this.highCut.build(e,"f")),r.push(this.lowCut.build(e,"f")),r.push(this.quality.build(e,"i"));break}}return r.push(this.intensity.build(e,"f")),r.push("displaced_normal"),e.format(i+"("+r.join(",")+")",this.getType(e),t)}else return""+e.shader,e.format("vec3( 0.0 )",this.getType(e),t)}},xb=yb;xb.Nodes=function(){let e=new Pe(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),t=new Pe(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new Pe(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[e,t])}}();var tt={normalRenderTarget:new js,normalRenderTargetDepth:new js,transmissionRenderTarget:new js,aspectRatio:new e1,transmissionSize:new e1(2048,2048),transmissionRenderTargetDepth:new js,aoRenderTarget:new js,aoEnabled:new E1,pixelRatioNode:new ze(1),resolution:new e1,penumbraSize:new hn(5,.5),frameIndex:new qt(0),transmissionLod:new qt(2)};for(let e of Object.values(tt))e.isRenderGlobal=!0;var bb={skiaWasmUrl:"https://unpkg.com/@splinetool/ui-wasm@1.9.37/build/ui.wasm"},i5=class extends Oi{constructor(){super("basic"),this.nodeType="Basic",this.color=new ci(Y1),this.shadingAlpha=new ze(1),this.shadingBlend=new qt(0),this.previousModelViewMatrix=new fs,this.previouseProjectionMatrix=new fs}get category(){return"phong"}generate(e){let t;if(e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:tt.frameIndex}),e.mergeUniform({resolution:tt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(yl.merge([Te.fog])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>"].join(`
`));let r=["#include <beginnormal_vertex>","#include <morphnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];i&&r.push(i.code,i.result?"displaced_position = "+i.result+";":""),r.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),r.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),r.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=r.join(`
`)}else{this.color===void 0&&(this.color=new ci(Y1)),this.color.analyze(e,{slot:"color"}),this.alpha&&this.alpha.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"});let i=this.color.flow(e,"c",{slot:"color"}),r=this.alpha?this.alpha.flow(e,"f"):void 0,s=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,a=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0;e.requires.transparent=r!==void 0,e.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let n=["#include <normal_fragment_begin>",i.code];r&&n.push(r.code,"#ifdef ALPHATEST"," if ( "+r.result+" <= ALPHATEST ) discard;","#endif"),a?n.push(a.code,`vec3 outgoingLight = ${i.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${a.result}, 1.0, SPE_BLENDING_NORMAL);`):n.push(`vec3 finalColor = ${i.result};`);let o="1.0";this.mask&&(this.mask.analyze(e),o=`luminance(${this.mask.flow(e,"v3").result})`),r?n.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${r.result} * ${o} );`):n.push("gl_FragColor = vec4("+i.result+", 1.0 );"),s&&n.push(`gl_FragColor.a *= ${s.result};`),n.push("#include <fog_fragment>","#include <dithering_fragment>"),t=n.join(`
`)}return t}},Zj=class extends Oi{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new ci(Y1),this.emissive=new ci(0),this.emissiveIntensity=new ze(1),this.previousModelViewMatrix=new fs,this.previouseProjectionMatrix=new fs,this.shadingAlpha=new ze(1),this.shadingBlend=new qt(0),this.occlusion=new E1(!0)}get category(){return"lambert"}build(e){let t;if(e.define("LAMBERT"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:tt.frameIndex}),e.mergeUniform({resolution:tt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(yl.merge([Te.fog,Te.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let r=["#include <beginnormal_vertex>","#include <morphnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&r.push(i.code,i.result?"displaced_position = "+i.result+";":""),r.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),r.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
				`),r.push(`
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),r.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=r.join(`
`)}else{e.mergeUniform({penumbraSize:tt.penumbraSize}),e.mergeUniform({frameIndex:tt.frameIndex}),e.mergeUniform({aoMap:tt.aoRenderTarget}),e.mergeUniform({aoEnabled:tt.aoEnabled}),this.color===void 0&&(this.color=new ci(Y1)),this.color.analyze(e,{slot:"color"}),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let i=this.color.flow(e,"c",{slot:"color"}),r=this.emissive.flow(e,"c",{slot:"emissive"}),s=this.emissiveIntensity.flow(e,"f",{slot:"emissive"}),a=this.occlusion.flow(e,"b",{slot:"occlusion"}),n=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,h=this.alpha?this.alpha.flow(e,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=h!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let d=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];d.push(i.code,"vec3 diffuseColor = "+i.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),h&&d.push(h.code,"#ifdef ALPHATEST","if ( "+h.result+" <= ALPHATEST ) discard;","#endif"),d.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),r&&d.push(r.code,"reflectedLight.directDiffuse += "+r.result+" * "+s.result+";"),d.push("vec3 ao = aoEnabled && "+a.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let u="1.0";this.mask&&(this.mask.analyze(e),u=`luminance(${this.mask.flow(e,"v3").result})`),d.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${n.result} * ${u} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${n.result} * ${u}, ${o.result} );

					outgoingLight *= ao;
				}
				`),l&&d.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),h?d.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${h.result} );`):d.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&d.push(`gl_FragColor.a *= ${c.result};`),d.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=d.join(`
`)}return t}},ml=function(){let e=new Pe(`vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {

            // Gradient of UVs w.r.t. X coordinate (in screen-space)
            vec2 dSTdx = dFdx(bumpMapUv);

            // Gradient of UVs w.r.t. Y coordinate (in screen-space)
            vec2 dSTdy = dFdy(bumpMapUv);
            
            // Forward differencing
            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);
            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;
            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;
            
            return vec2( dBx, dBy );
        }`),t=new Pe(`vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
            vec3 vSigmaX = dFdx( surf_pos.xyz );
            vec3 vSigmaY = dFdy( surf_pos.xyz );
            vec3 vN = surf_norm; // normalized
            
            vN = normalize(vN);

            vec3 R1 = cross( vSigmaY, vN );
            vec3 R2 = cross( vN, vSigmaX );

            R1 = normalize(R1);
            R2 = normalize(R2);
    
            float fDet = dot( vSigmaX, R1 ) * faceDirection;
    
            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
            return normalize( abs( fDet ) * vN - vGrad );
        }`);return{dHdxy:e,perturbNormalArb:t}}(),Kj=class extends Oi{constructor(){super("phong"),this.nodeType="Phong",this.color=new ci(Y1),this.specular=new ci(1118481),this.shininess=new ze(30),this.previousModelViewMatrix=new fs,this.previouseProjectionMatrix=new fs,this.shadingAlpha=new ze(1),this.shadingBlend=new qt(0),this.occlusion=new E1(!0)}get category(){return"phong"}build(e){let t;if(e.define("PHONG"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:tt.frameIndex}),e.mergeUniform({resolution:tt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(yl.merge([Te.fog,Te.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let r=["#include <beginnormal_vertex>","#include <morphnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&r.push(i.code,i.result?"displaced_position = "+i.result+";":""),r.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),r.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),r.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=r.join(`
`)}else{e.mergeUniform({penumbraSize:tt.penumbraSize}),e.mergeUniform({frameIndex:tt.frameIndex}),e.mergeUniform({aoMap:tt.aoRenderTarget}),e.mergeUniform({aoEnabled:tt.aoEnabled}),this.color===void 0&&(this.color=new ci(Y1)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e);let i=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),s=this.specular.flow(e,"c"),a=this.shininess.flow(e,"f"),n=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,h=this.alpha?this.alpha.flow(e,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=h!==void 0,e.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let d=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];if(this.bumpMap){e.include(ml.dHdxy),e.include(ml.perturbNormalArb);let p=this.bumpMap.texture.flow(e,"t"),f=this.bumpMap.flow(e,"v3"),g=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",m="";this.bumpMap.projection.value===4?m=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${p.result}, uv0, ${g});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${p.result}, uv1, ${g});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${p.result}, uv2, ${g});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:m=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${p.result}, bumpMapCachedUv, ${g});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,d.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${f.result};
					${m}
					`)}d.push(r.code,"	vec3 diffuseColor = "+r.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",s.code,"	vec3 specular = "+s.result+";",a.code,"	float shininess = max( 0.0001, "+a.result+" );","	float specularStrength = 1.0;"),h&&d.push(h.code,"#ifdef ALPHATEST","if ( "+h.result+" <= ALPHATEST ) discard;","#endif"),d.push("material.diffuseColor = diffuseColor;"),d.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),d.push("vec3 ao = aoEnabled && "+i.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let u="1.0";this.mask&&(this.mask.analyze(e),u=`luminance(${this.mask.flow(e,"v3").result})`),d.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${n.result} * ${u} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${n.result} * ${u}, ${o.result} );
					
					outgoingLight *= ao;
				}
				`),l&&d.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),h?d.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${h.result});`):d.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&d.push(`gl_FragColor.a *= ${c.result};`),d.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=d.join(`
`)}return t}},Jj=class extends Oi{constructor(){super("standard"),this.nodeType="Standard",this.color=new ci(Y1),this.roughness=new ze(.3),this.metalness=new ze(0),this.reflectivity=new ze(.5),this.previousModelViewMatrix=new fs,this.previouseProjectionMatrix=new fs,this.shadingAlpha=new ze(1),this.shadingBlend=new qt(0),this.occlusion=new E1(!0)}get category(){return"physical"}build(e){let t;if(e.define("STANDARD"),e.requires.lights=!0,e.extensions.derivatives=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:tt.frameIndex}),e.mergeUniform({resolution:tt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(yl.merge([Te.fog,Te.lights])),Te.LTC_1&&(e.uniforms.ltc_1={value:void 0},e.uniforms.ltc_2={value:void 0}),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let r=["#include <beginnormal_vertex>","#include <morphnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];i&&r.push(i.code,i.result?"displaced_position = "+i.result+";":""),r.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),r.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),r.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=r.join(`
`)}else{e.mergeUniform({penumbraSize:tt.penumbraSize}),e.mergeUniform({frameIndex:tt.frameIndex}),e.mergeUniform({aoMap:tt.aoRenderTarget}),e.mergeUniform({aoEnabled:tt.aoEnabled});let i={gamma:!0};this.color===void 0&&(this.color=new ci(Y1)),this.color.analyze(e,{slot:"color",context:i}),this.roughness.analyze(e),this.metalness.analyze(e);let r=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e),this.reflectivity&&this.reflectivity.analyze(e);let s=this.color.flow(e,"c",{slot:"color",context:i}),a=this.roughness.flow(e,"f"),n=this.metalness.flow(e,"f"),o=this.shadingAlpha.flow(e,"f"),l=this.shadingBlend.flow(e,"i"),h=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,d=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,u=this.reflectivity?this.reflectivity.flow(e,"f"):void 0;e.requires.transparent=c!==void 0,e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let p=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){e.include(ml.dHdxy),e.include(ml.perturbNormalArb);let g=this.bumpMap.texture.flow(e,"t"),m=this.bumpMap.flow(e,"v3"),v=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",y="";this.bumpMap.projection.value===4?y=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${g.result}, uv0, ${v});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${g.result}, uv1, ${v});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${g.result}, uv2, ${v});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:y=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${g.result}, bumpMapCachedUv, ${v});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,p.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${m.result};
					${y}
					`)}if(p.push(s.code,"	vec3 diffuseColor = "+s.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",n.code,"	float metalnessFactor = "+n.result+";"),this.roughnessMap){let g=this.roughnessMap.texture.flow(e,"t"),m=this.roughnessMap.flow(e,"v3"),v="";this.roughnessMap.projection.value===4?v=`
					float roughnessChange = 1.0;
					{
						vec2 uv0 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						float r0 = luminance(texture(${g.result}, uv0).rgb) * roughnessScale;
						float r1 = luminance(texture(${g.result}, uv1).rgb) * roughnessScale;
						float r2 = luminance(texture(${g.result}, uv2).rgb) * roughnessScale;

						roughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);
					}
					float roughnessFactor = roughnessChange * ${a.result};
					`:v=`
					vec2 roughnessMapCachedUv = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs;

					vec4 vals = texture(${g.result},  roughnessMapCachedUv);
					float roughnessFactor = luminance(vals.rgb) * ${a.result};
					`,p.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${m.result};

					const float roughnessScale = 1.0;

					${v}
				`)}else p.push(a.code,"	float roughnessFactor = "+a.result+";");c&&p.push(c.code,"#ifdef ALPHATEST","	if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),p.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),p.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),u?p.push(u.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+u.result+" ) ), diffuseColor, metalnessFactor );"):p.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),p.push("#include <lights_fragment_begin>"),p.push("#include <lights_fragment_end>"),p.push("vec3 ao = aoEnabled && "+r.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let f="1.0";this.mask&&(this.mask.analyze(e),f=`luminance(${this.mask.flow(e,"v3").result})`),p.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${f} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${f}, ${l.result} );
					
					outgoingLight *= ao;
				}
				`),h&&p.push(h.code,`outgoingLight = spe_blend(outgoingLight, ${h.result}, 1.0, SPE_BLENDING_NORMAL);`),c?p.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result} );`):p.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),d&&p.push(`gl_FragColor.a *= ${d.result};`),p.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=p.join(`
`)}return t}},$j=class extends Oi{constructor(){super("toon"),this.nodeType="Toon",this.color=new ci(Y1),this.specular=new ci(1118481),this.shininess=new ze(30),this.previousModelViewMatrix=new fs,this.previouseProjectionMatrix=new fs,this.shadingAlpha=new ze(1),this.shadingBlend=new qt(0)}get category(){return"toon"}build(e){let t;if(e.define("TOON"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:tt.frameIndex}),e.mergeUniform({resolution:tt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(yl.merge([Te.fog,Te.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let r=["#include <beginnormal_vertex>","#include <morphnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&r.push(i.code,i.result?"displaced_position = "+i.result+";":""),r.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),r.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),r.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=r.join(`
`)}else{e.mergeUniform({penumbraSize:tt.penumbraSize}),e.mergeUniform({frameIndex:tt.frameIndex}),e.mergeUniform({aoMap:tt.aoRenderTarget}),e.mergeUniform({aoEnabled:tt.aoEnabled}),this.color===void 0&&(this.color=new ci(Y1)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let i=this.color.flow(e,"c",{slot:"color"}),r=this.specular.flow(e,"c"),s=this.shininess.flow(e,"f"),a=this.shadingAlpha.flow(e,"f"),n=this.shadingBlend.flow(e,"i"),o=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(e,"f"):void 0,h=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=l!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let c=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];if(this.bumpMap){e.include(ml.dHdxy),e.include(ml.perturbNormalArb);let u=this.bumpMap.texture.flow(e,"t"),p=this.bumpMap.flow(e,"v3"),f=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",g="";this.bumpMap.projection.value===4?g=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${u.result}, uv0, ${f});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${u.result}, uv1, ${f});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${u.result}, uv2, ${f});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:g=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${u.result}, bumpMapCachedUv, ${f});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,c.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${p.result};
					${g}
					`)}c.push(i.code,"	vec3 diffuseColor = "+i.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",r.code,"	vec3 specular = "+r.result+";",s.code,"	float shininess = max( 0.0001, "+s.result+" );","	float specularStrength = 1.0;"),l&&c.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),c.push("material.diffuseColor = diffuseColor;"),c.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),c.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let d="1.0";this.mask&&(this.mask.analyze(e),d=`luminance(${this.mask.flow(e,"v3").result})`),c.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${d} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${d}, ${n.result} );
				}
				`),o&&c.push(o.code,`outgoingLight = spe_blend(outgoingLight, ${o.result}, 1.0, SPE_BLENDING_NORMAL);`),l?c.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):c.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h&&c.push(`gl_FragColor.a *= ${h.result};`),c.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=c.join(`
`)}return t}},eG=class{constructor(e=1e3*10){this.timeout=e,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...e){}remove(e){let t=this.cache.get(e);t&&(this.dispose(e,t.data),this.cache.delete(e),t.prev.next=t.next,t.next.prev=t.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let e=Date.now(),t=this.head.next;for(;t.time<e-this.timeout;)this.dispose(t.src,t.data),this.cache.delete(t.src),t=t.next,t.prev=this.head,this.head.next=t;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(e){var t;return(t=this.cache.get(e))==null?void 0:t.data}load(e){let t=Date.now(),i=this.cache.get(e);return i===void 0?(i={data:this.create(e),src:e,time:t,next:null,prev:null},this.cache.set(e,i)):(i.time=t,i.prev.next=i.next,i.next.prev=i.prev),i.prev=this.tail.prev,i.next=this.tail,this.tail.prev.next=i,this.tail.prev=i,this.scheduleCleanup(),i.data}},tG=class extends eG{create(e){return URL.createObjectURL(new Blob([e]))}dispose(e,t){URL.revokeObjectURL(t)}},np;function iG(e){return typeof e=="string"?e:(np||(np=new tG),np.load(e))}var rG=class{constructor(e,t){this.data=e,this.cache=t,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},sG=class{constructor(){this.cache=new Map}remove(e){this.cache.delete(e.data)}load(e){let t=this.cache.get(e);return t===void 0&&(t=this.create(e),this.cache.set(e,t)),t.refCount+=1,t}},wb=class extends rG{constructor(e,t){super(e,t.imageHolderCache),this.data=e,this.shared=t,this.loaded=!1,this.isVideo=!1,this.isBuffer=!1,this._cache={1e3:{},1001:{},1002:{}},this.isVideo=e.type==="video",this.isBuffer=e.isWebGLRenderTarget===!0,this.loadPromise=this.updateSrc(this.isBuffer?e:e.data)}async updateSrc(e){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let t=()=>{this.loaded=!0;for(let r of Object.values(this._cache))for(let s of Object.values(r))for(let a of Object.values(s))a&&(a.image=this.img,a.needsUpdate=!0);this.shared.requestRender()};if(this.isBuffer)this.img=e,this.loaded=!0;else if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof e!="string"){var i=new FileReader;i.readAsDataURL(new Blob([e],{type:"video/mp4"}));let r;await new Promise(s=>{i.onloadend=a=>{var n;r=(n=a.target)==null?void 0:n.result,s(null)}}),this.img.src=r}else this.img.src=e;this.img.onloadeddata=()=>{t()}}else this.img=new Image,this.img.src=iG(e),this.img.onload=t,await new Promise(r=>{this.img.onload=()=>{t(),r(null)}})}getTexture(e,t=1008,i=1006){var s,a;let r=(a=(s=this._cache[e])==null?void 0:s[t])==null?void 0:a[i];if(r)return r;{let n;return this.isBuffer?n=this.img.texture:this.isVideo?n=new TT(this.img,void 0,e,e):n=new ai(this.img,void 0,e,e,i,t),this.loaded&&(n.needsUpdate=!0),this._cache[e]===void 0&&(this._cache[e]={}),this._cache[e][t]===void 0&&(this._cache[e][t]={}),this._cache[e][t][i]=n,n}}setNeedsUpdate(e){for(let t of Object.values(this._cache))for(let i of Object.values(t))for(let r of Object.values(i))r&&(r.needsUpdate=e)}disposeTextures(){for(let[e,t]of Object.entries(this._cache))for(let[i,r]of Object.entries(t))for(let[s,a]of Object.entries(r))a==null||a.dispose(),this._cache[e]!==void 0&&this._cache[e][i]!==void 0&&(this._cache[e][i][s]=void 0)}dispose(){super.dispose(),this.disposeTextures()}},Ta=class extends wb{};function aG(e,t){var i=hG(t);return i.formatToParts?oG(i,e):lG(i,e)}var nG={year:0,month:1,day:2,hour:3,minute:4,second:5};function oG(e,t){try{for(var i=e.formatToParts(t),r=[],s=0;s<i.length;s++){var a=nG[i[s].type];a>=0&&(r[a]=parseInt(i[s].value,10))}return r}catch(n){if(n instanceof RangeError)return[NaN];throw n}}function lG(e,t){var i=e.format(t).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(i);return[r[3],r[1],r[2],r[4],r[5],r[6]]}var op={};function hG(e){if(!op[e]){var t=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:"America/New_York",year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),i=t==="06/25/2014, 00:00:00"||t==="06/25/2014 00:00:00";op[e]=i?new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return op[e]}function Sb(e,t,i,r,s,a,n){var o=new Date(0);return o.setUTCFullYear(e,t,i),o.setUTCHours(r,s,a,n),o}var Ug=36e5,cG=6e4,lp={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-]\d{2}):?(\d{2})$/};function _b(e,t,i){var r,s;if(!e||(r=lp.timezoneZ.exec(e),r))return 0;var a;if(r=lp.timezoneHH.exec(e),r)return a=parseInt(r[1],10),Ng(a)?-(a*Ug):NaN;if(r=lp.timezoneHHMM.exec(e),r){a=parseInt(r[1],10);var n=parseInt(r[2],10);return Ng(a,n)?(s=Math.abs(a)*Ug+n*cG,a>0?-s:s):NaN}if(pG(e)){t=new Date(t||Date.now());var o=i?t:dG(t),l=Sf(o,e),h=i?l:uG(t,l,e);return-h}return NaN}function dG(e){return Sb(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function Sf(e,t){var i=aG(e,t),r=Sb(i[0],i[1]-1,i[2],i[3]%24,i[4],i[5],0).getTime(),s=e.getTime(),a=s%1e3;return s-=a>=0?a:1e3+a,r-s}function uG(e,t,i){var r=e.getTime(),s=r-t,a=Sf(new Date(s),i);if(t===a)return t;s-=a-t;var n=Sf(new Date(s),i);return a===n?a:Math.max(a,n)}function Ng(e,t){return-23<=e&&e<=23&&(t==null||0<=t&&t<=59)}var Vg={};function pG(e){if(Vg[e])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:e}),Vg[e]=!0,!0}catch{return!1}}var fG=aa(mS(),1),jg=aa(gS(),1),mG=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,gG=mG,hp=36e5,Gg=6e4,vG=2,C1={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:gG};function yG(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(e===null)return new Date(NaN);var i={},r=i.additionalDigits==null?vG:(0,fG.default)(i.additionalDigits);if(r!==2&&r!==1&&r!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]")return new Date(e.getTime());if(typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]")return new Date(e);if(!(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"))return new Date(NaN);var s=xG(e),a=bG(s.date,r),n=a.year,o=a.restDateString,l=wG(o,n);if(isNaN(l))return new Date(NaN);if(l){var h=l.getTime(),c=0,d;if(s.time&&(c=SG(s.time),isNaN(c)))return new Date(NaN);if(s.timeZone||i.timeZone){if(d=_b(s.timeZone||i.timeZone,new Date(h+c)),isNaN(d))return new Date(NaN)}else d=(0,jg.default)(new Date(h+c)),d=(0,jg.default)(new Date(h+c+d));return new Date(h+c+d)}else return new Date(NaN)}function xG(e){var t={},i=C1.dateTimePattern.exec(e),r;if(i?(t.date=i[1],r=i[3]):(i=C1.datePattern.exec(e),i?(t.date=i[1],r=i[2]):(t.date=null,r=e)),r){var s=C1.timeZone.exec(r);s?(t.time=r.replace(s[1],""),t.timeZone=s[1].trim()):t.time=r}return t}function bG(e,t){var i=C1.YYY[t],r=C1.YYYYY[t],s;if(s=C1.YYYY.exec(e)||r.exec(e),s){var a=s[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(s=C1.YY.exec(e)||i.exec(e),s){var n=s[1];return{year:parseInt(n,10)*100,restDateString:e.slice(n.length)}}return{year:null}}function wG(e,t){if(t===null)return null;var i,r,s,a;if(e.length===0)return r=new Date(0),r.setUTCFullYear(t),r;if(i=C1.MM.exec(e),i)return r=new Date(0),s=parseInt(i[1],10)-1,Wg(t,s)?(r.setUTCFullYear(t,s),r):new Date(NaN);if(i=C1.DDD.exec(e),i){r=new Date(0);var n=parseInt(i[1],10);return MG(t,n)?(r.setUTCFullYear(t,0,n),r):new Date(NaN)}if(i=C1.MMDD.exec(e),i){r=new Date(0),s=parseInt(i[1],10)-1;var o=parseInt(i[2],10);return Wg(t,s,o)?(r.setUTCFullYear(t,s,o),r):new Date(NaN)}if(i=C1.Www.exec(e),i)return a=parseInt(i[1],10)-1,qg(t,a)?Hg(t,a):new Date(NaN);if(i=C1.WwwD.exec(e),i){a=parseInt(i[1],10)-1;var l=parseInt(i[2],10)-1;return qg(t,a,l)?Hg(t,a,l):new Date(NaN)}return null}function SG(e){var t,i,r;if(t=C1.HH.exec(e),t)return i=parseFloat(t[1].replace(",",".")),cp(i)?i%24*hp:NaN;if(t=C1.HHMM.exec(e),t)return i=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),cp(i,r)?i%24*hp+r*Gg:NaN;if(t=C1.HHMMSS.exec(e),t){i=parseInt(t[1],10),r=parseInt(t[2],10);var s=parseFloat(t[3].replace(",","."));return cp(i,r,s)?i%24*hp+r*Gg+s*1e3:NaN}return null}function Hg(e,t,i){t=t||0,i=i||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var s=r.getUTCDay()||7,a=t*7+i+1-s;return r.setUTCDate(r.getUTCDate()+a),r}var _G=[31,28,31,30,31,30,31,31,30,31,30,31],AG=[31,29,31,30,31,30,31,31,30,31,30,31];function Ab(e){return e%400===0||e%4===0&&e%100!==0}function Wg(e,t,i){if(t<0||t>11)return!1;if(i!=null){if(i<1)return!1;var r=Ab(e);if(r&&i>AG[t]||!r&&i>_G[t])return!1}return!0}function MG(e,t){if(t<1)return!1;var i=Ab(e);return!(i&&t>366||!i&&t>365)}function qg(e,t,i){return!(t<0||t>52||i!=null&&(i<0||i>6))}function cp(e,t,i){return!(e!=null&&(e<0||e>=25)||t!=null&&(t<0||t>=60)||i!=null&&(i<0||i>=60))}function EG(e,t,i){var r=yG(e,i),s=_b(t,r,!0),a=new Date(r.getTime()-s),n=new Date(0);return n.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),n.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),n}function T1(e,t){return t.color(e)}function Yg(e=new Date,t){let i=t.format,r=e.getSeconds(),s=e;t&&t.timeZone!==null&&(s=EG(new Date,t.timeZone));let a=s.getHours(),n=s.getMinutes(),o;t.format12h24h==="12ampm"&&(o=a>=12?"PM":"AM");let l=a;t.format12h24h!=="24"&&(l=a%12,l===0&&(l=12));let h,c;switch(i){case"HH:mm:ss":h=[l,n,r];break;case"HH:mm":h=[l,n];break;case"HH":h=[l],o=void 0;break;case"mm":h=[n],o=void 0;break;case"ss":h=[r],o=void 0;break;case"year":c=s.getFullYear();break;case"month":c=s.getMonth()+1;break;case"dayOfYear":c=Math.floor((s.getTime()-new Date(s.getFullYear(),0,0).getTime())/864e5);break;case"dayOfMonth":c=s.getDate();break;case"secondOfDay":c=a*60*60+n*60+r;break;default:c=0;break}return h!==void 0?{textValue:h,suffix:o}:c}function CG(e,t){switch(e.type){case"fresnel":return DG(e,t);case"gradient":return IG(e,t);case"depth":return OG(e,t);case"normal":return RG(e,t);case"noise":return LG(e,t);case"rainbow":return BG(e,t);case"toon":return zG(e,t);case"outline":return FG(e,t);case"transmission":return kG(e,t);case"color":return PG(e,t);case"pattern":return UG(e,t)}}function TG(e){return{type:e.type}}function Fr(e,t){let{alpha:i,mode:r,isMask:s}=e,a=typeof i=="string"?(Number(t.getVariable(i))??100)/100:i;return{...TG(e),alpha:a,mode:r,isMask:s}}function PG(e,t){return{...Fr(e,t),color:T1(e.color,t)}}function DG(e,t){let{bias:i,scale:r,intensity:s,factor:a,color:n}=e;return{...Fr(e,t),color:T1(n,t),bias:i,scale:r,intensity:s,factor:a}}function IG(e,t){let{gradientType:i,smooth:r,colors:s,steps:a,angle:n,offset:o,morph:l}=e;return{...Fr(e,t),gradientType:i,smooth:r,colors:s.map(h=>new ht(h[0],h[1],h[2],h[3])),num:s.length,steps:a,offset:new j(...o),morph:new j(...l),angle:n}}function OG(e,t){let{gradientType:i,near:r,far:s,isVector:a,isWorldSpace:n,origin:o,direction:l,colors:h,steps:c,smooth:d}=e;return{...Fr(e,t),gradientType:i,near:r,far:s,isVector:a,isWorldSpace:n,origin:new E(...o),direction:l?new E(...l):new E(1,0,0),colors:h.map(u=>u!==void 0?new ht(u[0],u[1],u[2],u[3]):new ht(0,0,0,0)),steps:c.slice(0,h.length),smooth:d}}function RG(e,t){let{cnormal:i}=e;return{...Fr(e,t),cnormal:new E(i[0],i[1],i[2])}}function LG(e,t){return{...Fr(e,t),scale:e.scale,move:e.move,fA:new j(...e.fA),fB:new j(...e.fB),size:new E(...e.size),distortion:new j(...e.distortion),colorA:T1(e.colorA,t),colorB:T1(e.colorB,t),colorC:T1(e.colorC,t),colorD:T1(e.colorD,t),noiseType:e.noiseType,voronoiStyle:e.voronoiStyle,highCut:e.highCut,lowCut:e.lowCut,smoothness:e.smoothness,seed:e.seed,quality:e.quality}}function BG(e,t){return{...Fr(e,t),filmThickness:e.filmThickness,movement:e.movement,wavelengths:new E(...e.wavelengths),noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,offset:new E(...e.offset)}}function zG(e,t){return{...Fr(e,t),positioning:e.positioning,colors:e.colors.map(i=>new ht(i[0],i[1],i[2],i[3])),num:e.colors.length,steps:e.steps,source:new E(...e.source),isWorldSpace:e.isWorldSpace,noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,shadowColor:T1(e.shadowColor,t),offset:new E(...e.offset)}}function FG(e,t){return{...Fr(e,t),outlineColor:T1(e.outlineColor,t),contourColor:T1(e.contourColor,t),outlineWidth:e.outlineWidth,contourWidth:e.contourWidth,outlineThreshold:e.outlineThreshold,contourThreshold:e.contourThreshold,outlineSmoothing:e.outlineSmoothing,contourFrequency:e.contourFrequency,contourDirection:new E(...e.contourDirection),positionalLines:e.positionalLines,compensation:e.compensation}}function kG(e,t){return{...Fr(e,t),thickness:e.thickness,ior:e.ior,roughness:e.roughness}}function UG(e,t){return{...Fr(e,t),style:e.style,projection:e.projection,axis:e.axis,blending:e.blending,offset:new j(...e.offset),colorA:T1(e.colorA,t),colorB:T1(e.colorB,t),frequency:new j(...e.frequency),size:e.size,variation:e.variation,smoothness:e.smoothness,zigzag:e.zigzag,rotation:e.rotation,vertical:new j(...e.vertical),horizontal:new j(...e.horizontal),sides:e.sides}}var ed=class extends o1{},NG={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},VG={depth:["colors"]};function jG(e,t,i){var a,n;if(t==="isMask")return!0;let r=NG[e.type],s=VG[e.type];if(s!==void 0){let o=e.color;if(s.includes(t)){let l=(n=(a=o[t])==null?void 0:a.value)==null?void 0:n.length;if(l!==void 0&&l!==i.length)return!0}}return r!==void 0?r.includes(t):!1}function Mb(e,t,i){let r=i.uniforms[`f${i.id}_texture`];if(!r)return!1;let s=!1,a=e;if("image"in a){let n=a.image,o=t.image(n),l=r;l.image instanceof Ta||l.image.deref(),l.image=o}if("video"in a){let n=a.video,o=t.video(n),l=r;l.image instanceof Ta||l.image.deref(),l.image=o}if("wrapping"in a){let n=r;n.wrap=a.wrapping}if("minFilter"in a){let n=r;n.minFilter=a.minFilter}if("magFilter"in a){let n=r;n.magFilter=a.magFilter}if("rotation"in a&&i.uniforms[`f${i.id}_rotation`])return i.uniforms[`f${i.id}_rotation`].value=(a.rotation??0)*Oe.DEG2RAD,s;if("repeat"in a||"offset"in a||"rotation"in a){let n="mat",o=i.uniforms[`f${i.id}_${n}`];"repeat"in a&&(o.repeat=a.repeat),"offset"in a&&(o.offset=a.offset),"rotation"in a&&(o.rotation=a.rotation??0),o.updateMatrix()}return s}function GG(e,t,i,r){let s=!1;for(let[a,n]of Object.entries(e)){if(a==="bumpMap"||a==="roughnessMap"){s=!0;continue}if(!a||n===void 0)continue;if(Cb(a,i,r,t)){a==="visible"&&i.type==="light"&&(s=!0);continue}i.visible=r.visible;let o=i.uniforms[`f${i.id}_${a}`];if(o&&!(o instanceof $4))switch(s=s||jG(i,a,n),o.constructor){case ci:if(typeof n=="string"){let l=t.getColor(n);l&&(o.value=l);break}else{let l=n;o.value instanceof ed?o.value=new o1(l.r,l.g,l.b,l.a):o.setRGBA(l);break}case zs:if(typeof n=="string"){let l=t.getColor(n);l&&(o.value=l);break}else{let l=n;o.value instanceof ed?o.value=new o1(l.r,l.g,l.b,l.a):o.value.setRGBA(l.r,l.g,l.b,l.a);break}case e1:{let l=n;o.value.setX(l[0]),o.value.setY(l[1]);break}case tr:{let l=n;o.value.setX(l[0]),o.value.setY(l[1]),o.value.setZ(l[2]);break}case js:{Mb(n,t,i);break}case cn:{o.value=n.map(l=>new ht(...l));break}default:{o.value=n;break}}}return s}var Un=(e,t,i)=>Math.max(0,Math.min(1,Number(t.getVariable(typeof e=="number"?e*100:e,i)??100)/100))??1,uh=class{constructor(e,t,i,r,s){this.id=e,this.uuid=t,this.data=i,this.uniforms={};for(let a in r)this.uniforms[`f${this.id}_${a}`]=r[a];for(let a in i)Cb(a,this,i,s)}get type(){return this.data.type}static create(e,t,i,r){if(i.type==="light")return $r.createLigherLayer(e,t,i,r);if(i.type==="texture"||i.type==="video"){let s=i.type==="texture"?r.uiBuffer(i.texture.image)??r.image(i.texture.image):r.video(i.texture.video),a=new xf(s,i.texture.wrapping,i.texture.minFilter??1008,i.texture.magFilter??1006),n=new Wj(s),o=new qj(i.texture.repeat,i.texture.offset,i.texture.rotation??0),l=new ze(i.crop?1:0),h=new qt(i.projection??0),c=new qt(["x","y","z"].indexOf(i.axis)??0),d=new qt(i.side??0),u=new e1(i.size?new j(i.size[0],i.size[1]):new j(100,100)),p=new ze(i.blending??0),f=new ze(Un(i.alpha,r)),g=new qt(i.mode??0),m=new E1(i.isMask??!1),v=new e5(a,n,l,h,c,d,u,p,o,f,g,m),y=new Kt(v.calpha,"f");return new oi(e,t,i,{texture:a,textureSize:n,crop:l,projection:h,axis:c,side:d,size:u,blending:p,mat:o,alpha:f,mode:g,isMask:m},v,g,y,m,r)}else if(i.type==="matcap"){let s=r.image(i.texture.image),a=new xf(s,i.texture.wrapping,i.texture.minFilter??1008,i.texture.magFilter??1006),n=new ze(Un(i.alpha,r)),o=new qt(i.mode??0),l=new E1(i.isMask??!1),h=new ze((i.texture.rotation??0)*Oe.DEG2RAD),c=new ob(a,n,o,l,h),d=new Kt(c.calpha,"f");return new oi(e,t,i,{texture:a,alpha:n,mode:o,isMask:l,rotation:h},c,o,d,l,r)}else if(i.type==="displace")if(i.displacementType==="noise"){let s=new tr(new E(...i.offset)),a=new ze(i.scale??10),n=new ze(i.intensity??8),o=new ze(i.movement??1),l=new qt(i.noiseType??0),h=new qt(i.voronoiStyle??0),c=new ze(i.smoothness??.5),d=new ze(i.seed??0),u=new ze(i.highCut??1),p=new ze(i.lowCut??0),f=new qt(i.quality??1),g=new xb(n,o,s,h,c,d,u,p,f,a,l);return new Eb(e,t,i,{offset:s,scale:a,intensity:n,movement:o,noiseType:l,voronoiStyle:h,smoothness:c,seed:d,highCut:u,lowCut:p,quality:f},g,r)}else throw new Error;else return qG(e,t,i,r)}updateByOp(e,t,i){let r=e;if(r.path[0]===void 0){if(r.type===0)return"type"in r.props||"category"in r.props||"visible"in r.props?(i.scene.markNeedsUpdateRendererDirty(),!0):GG(r.props,i.shared,this,t)}else if(r.path[0]==="texture")return"texture"in t||"video"in t?Mb(r.props,i.shared,this):!0;return!1}dispose(){if(HG(this)){let e=this.uniforms[`f${this.id}_texture`];if(!e)return!1;let t=e;t.image instanceof Ta||t.image.deref()}}hasValueByKey(e){return this.uniforms[e]!==void 0}hasValue(e){return this.hasValueByKey(`f${this.id}_${e}`)}setValue(e,t){let i=`f${this.id}_${e}`;this.hasValueByKey(i)&&t!==void 0&&(this.uniforms[i].value=t)}getNode(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t]}getValue(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t].value}getName(e){let t=/f\d+_(.*)/.exec(e);if(t&&t.length>1)return t[1];`${e}`}getNames(){let e=[];for(let t in this.uniforms){let i=this.getName(t);i&&e.push(i)}return e}},oi=class extends uh{constructor(e,t,i,r,s,a,n,o,l){super(e,t,i,r,l),this.params=r,this.color=s,this.mode=a,this.alpha=n,this.isMask=o}},Eb=class extends uh{constructor(e,t,i,r,s,a){super(e,t,i,r,a),this.position=s}},$r=class extends uh{constructor(e,t,i,r,s,a){super(e,t,i,s,a),this.node=r}static createLigherLayer(e,t,i,r){let s,a=new ze(Un(i.alpha,r)),n=new qt(i.mode),o=new ze(i.bumpMapIntensity),l=new ze(Un(i.alphaOverride,r)),h;if(!i.visible)s=new i5,h={};else if(i.category==="lambert"){s=new Zj;let c=new ci(r.color(i.emissive)??0),d=new E1(i.occlusion??!0);h={emissive:c,occlusion:d},s.emissive=c,s.occlusion=d}else if(i.category==="toon"){s=new $j;let c=new ze(i.shininess??30),d=new ci(r.color(i.specular)??1118481);h={shininess:c,specular:d},s.shininess=c,s.specular=d}else if(i.category==="physical"){s=new Jj;let c=new ze(i.roughness??.3),d=new ze(i.metalness??0),u=new ze(i.reflectivity??.5),p=new E1(i.occlusion??!0);h={roughness:c,metalness:d,reflectivity:u,occlusion:p},s.roughness=c,s.metalness=d,s.reflectivity=u,s.occlusion=p}else{s=new Kj;let c=new ze(i.shininess??30),d=new ci(i.specular!==void 0?r.color(i.specular)??1118481:1118481),u=new E1(i.occlusion??!0);h={shininess:c,specular:d,occlusion:u},s.shininess=c,s.specular=d,s.occlusion=u}return s.alpha=new ze(1),s.shadingAlpha=a,s.shadingBlend=n,s.bumpMapIntensity=o,s.alphaOverride=l,h.alpha=s.shadingAlpha,h.mode=s.shadingBlend,h.bumpMapIntensity=s.bumpMapIntensity,h.alphaOverride=s.alphaOverride,new $r(e,t,i,s,h,r)}get category(){return this.node.category}};function HG(e){let t=e instanceof uh?e.type:e;return t==="texture"||t==="video"||t==="displace_map"||t==="matcap"}function K1(e){return{alpha:new ze(e.alpha??1),mode:new qt(e.mode??0),isMask:new E1(e.isMask??!1)}}function WG(e,t,i,r,s){switch(e.type){case"color":{let a=new ci(r.color??Y1),n=K1(r),o=new bf(a,n.alpha),l=new Kt(o.calpha,"f");return new oi(t,i,e,{color:a,...n},o,n.mode,l,n.isMask,s)}case"fresnel":{let a=new ci(r.color??16777215),n=new ze(r.bias??.1),o=new ze(r.scale??1),l=new ze(r.intensity??2),h=new ze(r.factor??1),c=K1(r),d=new Yj(a,n,o,l,h,c.alpha,c.mode,c.isMask),u=new Kt(d.calpha,"f");return new oi(t,i,e,{color:a,bias:n,scale:o,intensity:l,factor:h,...c},d,c.mode,u,c.isMask,s)}case"rainbow":{let a=new ze(r.filmThickness??30),n=new ze(r.movement??0),o=new tr(r.wavelengths??new E(0,0,0)),l=new ze(r.noiseStrength??0),h=new ze(r.noiseScale??1),c=new tr(r.offset??new E(0,0,0)),d=K1(r),u=new pb(a,n,o,l,h,c,d.alpha,d.isMask),p=new Kt(u.calpha,"f");return new oi(t,i,e,{filmThickness:a,movement:n,wavelengths:o,noiseStrength:l,noiseScale:h,offset:c,...d},u,d.mode,p,d.isMask,s)}case"transmission":{let a=new ze(r.thickness??10),n=new ze(r.ior??1.5),o=new ze(r.roughness??.5),l=tt.transmissionSize,h=tt.transmissionRenderTarget,c=tt.transmissionRenderTargetDepth,d=window.innerWidth,u=window.innerHeight,p=d>=u?new e1(u/d,1):new e1(1,d/u),f=K1(r),g=new vb(a,n,o,l,h,c,p,f.alpha),m=new Kt(g.calpha,"f");return new oi(t,i,e,{thickness:a,ior:n,roughness:o,aspectRatio:p,...f},g,f.mode,m,f.isMask,s)}case"toon":{let a=new qt(r.positioning??0),n;r.colors?n=new cn(r.colors.length,r.colors):(n=new cn(10,new ht(0,0,0,1)),n.value[1]=new ht(1,1,1,1));let o;r.steps?o=new hn(r.steps.length,r.steps):(o=new hn(10,1),o.value[0]=0);let l=new tr(r.source??new E(0,0,0)),h=new E1(r.isWorldSpace??!0),c=new ze(r.noiseStrength??0),d=new ze(r.noiseScale??1),u=new zs(r.shadowColor),p=new tr(r.offset??new E(0,0,0)),f=K1(r),g=new mb(a,n,o,l,h,c,d,u,p,f.alpha),m=new Kt(g.calpha,"f");return new oi(t,i,e,{positioning:a,colors:n,steps:o,source:l,isWorldSpace:h,noiseStrength:c,noiseScale:d,shadowColor:u,offset:p,...f},g,f.mode,m,f.isMask,s)}case"outline":{let a=new ci(r.outlineColor??16777215),n=new ci(r.contourColor??16777215),o=new ze(r.outlineWidth??.1),l=new ze(r.contourWidth??.1),h=new ze(r.outlineThreshold??.1),c=new ze(r.contourThreshold??.1),d=new ze(r.outlineSmoothing??.1),u=new ze(r.contourFrequency??.1),p=new tr(r.contourDirection??new E(0,1,0)),f=new E1(r.positionalLines??!1),g=new E1(r.compensation??!0),m=tt.normalRenderTarget,v=tt.normalRenderTargetDepth,y=tt.pixelRatioNode,x=tt.resolution,w=K1(r),_=new cb(a,n,o,l,h,c,d,u,p,f,g,x,m,v,y,w.alpha),b=new Kt(_.calpha,"f");return new oi(t,i,e,{outlineColor:a,contourColor:n,outlineWidth:o,contourWidth:l,outlineThreshold:h,contourThreshold:c,outlineSmoothing:d,contourFrequency:u,contourDirection:p,positionalLines:f,compensation:g,...w},_,w.mode,b,w.isMask,s)}case"depth":{let a=new qt(r.gradientType??0),n=new E1(r.smooth??!1),o=new ze(r.near??50),l=new ze(r.far??200),h=new ze(r.isVector??1),c=new ze(r.isWorldSpace??0),d=new tr(r.origin??new E),u=new tr(r.direction??new E),p;r.colors?p=new cn(r.colors.length,r.colors):(p=new cn(2,new ht(0,0,0,1)),p.value[1]=new ht(1,1,1,1));let f;r.steps?f=new hn(r.steps.length,r.steps):(f=new hn(2,1),f.value[0]=0);let g=K1(r),m=new rb(a,n,o,l,h,c,d,u,p,f,g.alpha,g.isMask),v=new Kt(m.calpha,"f");return new oi(t,i,e,{gradientType:a,smooth:n,near:o,far:l,isVector:h,isWorldSpace:c,origin:d,direction:u,colors:p,steps:f,...g},m,g.mode,v,g.isMask,s)}case"noise":{let a=new ze(r.scale??1),n=new tr(r.size??new E(100,100,100)),o=new ze(r.move??1),l=new e1(r.fA??new j(1.7,9.2)),h=new e1(r.fB??new j(8.3,2.8)),c=new e1(r.distortion??new j(1,1)),d=new zs(r.colorA),u=new zs(r.colorB),p=new zs(r.colorC),f=new zs(r.colorD),g=new qt(r.noiseType??0),m=new qt(r.voronoiStyle??0),v=new ze(r.highCut??1),y=new ze(r.lowCut??0),x=new ze(r.smoothness??.5),w=new ze(r.seed??.5),_=new qt(r.quality??1),b=K1(r),A=new lb(a,n,o,l,h,c,d,u,p,f,b.alpha,g,b.isMask,m,v,y,x,w,_),S=new Kt(A.calpha,"f");return new oi(t,i,e,{scale:a,size:n,move:o,fA:l,fB:h,distortion:c,colorA:d,colorB:u,colorC:p,colorD:f,noiseType:g,...b,voronoiStyle:m,highCut:v,lowCut:y,smoothness:x,seed:w,quality:_},A,b.mode,S,b.isMask,s)}case"normal":{let a=new tr(r.cnormal??new E(1,1,1)),n=K1(r),o=new ib(a,n.alpha),l=new Kt(o.calpha,"f");return new oi(t,i,e,{cnormal:a,...n},o,n.mode,l,n.isMask,s)}case"gradient":{let a=new qt(r.gradientType??0),n=new E1(r.smooth??!1),o;r.colors?o=new cn(r.colors.length,r.colors):(o=new cn(10,new ht(0,0,0,1)),o.value[1]=new ht(1,1,1,1));let l;r.steps?l=new hn(r.steps.length,r.steps):(l=new hn(10,1),l.value[0]=0);let h=new e1(r.offset??new j(0,0)),c=new e1(r.morph??new j(0,0)),d=new ze(r.angle??0),u=K1(r),p=new ab(a,n,o,l,h,c,d,u.alpha,u.isMask),f=new Kt(p.calpha,"f");return new oi(t,i,e,{gradientType:a,smooth:n,colors:o,steps:l,offset:h,morph:c,angle:d,...u},p,u.mode,f,u.isMask,s)}case"pattern":{let a=new qt(r.style??0),n=new qt(r.projection??0),o=new qt(["x","y","z"].indexOf(r.axis)??0),l=new ze(r.blending??0),h=new e1(r.offset??new j(0,0)),c=new zs(r.colorA),d=new zs(r.colorB),u=new e1(r.frequency??new j(10,10)),p=new ze(r.size??.5),f=new ze(r.variation??0),g=new ze(r.smoothness??.5),m=new ze(r.zigzag??0),v=new ze(r.rotation??0),y=new e1(r.vertical??new j(0,1)),x=new e1(r.horizontal??new j(0,1)),w=new qt(r.sides??6),_=K1(r),b=new db(a,n,o,l,h,c,d,u,p,f,g,m,v,y,x,w,_.alpha,_.isMask),A=new Kt(b.calpha,"f");return new oi(t,i,e,{style:a,projection:n,axis:o,blending:l,offset:h,colorA:c,colorB:d,frequency:u,size:p,variation:f,smoothness:g,zigzag:m,rotation:v,vertical:y,horizontal:x,sides:w,..._},b,_.mode,A,_.isMask,s)}default:{let a=new ci(1,0,0,1),n=K1(r),o=new bf(a,n.alpha),l=new Kt(o.calpha,"f");return new oi(t,i,e,{color:a,...n},o,n.mode,l,n.isMask,s)}}}function qG(e,t,i,r){let s=CG(i,r);return WG(i,e,t,s,r)}function Cb(e,t,i,r){if(i.type==="displace"&&(e==="intensity"||e==="visible")){let s=t.uniforms[`f${t.id}_intensity`];return s?(s.value=i.intensity*(i.visible?1:0),s):void 0}if(i.type!=="displace"&&(e==="alpha"||e==="visible")){let s=t.uniforms[`f${t.id}_alpha`];if(!s)return;if(s.value=Un(i.alpha,r)*(i.visible?1:0),i.type==="outline"&&e==="visible"){let a=t.uniforms[`f${t.id}_compensation`];a&&(a.value=i.compensation&&i.visible)}return s}}function Uo(e,t){let i=0,r=e.layers.find(s=>s.data.type==="light");if(r){let s=r.data,a=Number(t.getVariable(s.alphaOverride));if((typeof s.alphaOverride=="string"?a/100:s.alphaOverride)<1)return!0}for(let s of e.layers){if(s.data.type!=="displace"&&s.data.isMask)return!0;if(s.data.type!=="displace"&&"alpha"in s.data&&s.data.type!=="light"&&s.data.type!=="fresnel"&&s.data.type!=="texture"&&s.data.type!=="matcap"&&s.data.type!=="rainbow"&&s.data.type!=="outline"&&s.data.type!=="pattern"){let a=s.data.visible?s.data.alpha:0;if(typeof a=="string"&&(a=Math.max(0,Math.min(1,Number(t.getVariable(a)??100)/100))),a===1&&s.data.type==="depth"||s.data.type==="gradient"){for(let n of s.data.colors)if(n[3]<1){a=n[3];break}}else if(a===1&&s.data.type==="noise"){let n=t.color(s.data.colorA).a,o=t.color(s.data.colorB).a,l=t.color(s.data.colorC).a,h=t.color(s.data.colorD).a,c=Math.min(n,Math.min(o,Math.min(l,h)));c<1&&(a=c)}i+=(1-i)*a}}return i<1}var Wa=class extends It{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.nodeContextUuid=0,this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return""}},YG=class extends Wa{constructor(e,t,i,r){super(),this.flatShading=e,this.side=t,this.wireframe=i,this.root=r}updateAfterBuild(){let e=this.root;this.lights=e.lights,this.vertexShader=e.vertexShader,this.fragmentShader=e.fragmentShader,this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.transparent=e.transparent,this.cacheKey=e.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(e,t){this.root.onBeforeCompile(e)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(e,t,i){return this.root.getFlavor(e,t,i)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(e){return this.root.getLayersOfType(e)}getLayerByUuid(e){return this.root.getLayerByUuid(e)}updateByOp(e,t,i){this.root.updateByOp(e,t,i)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},r5=class extends Wa{constructor(e,t,i=!0){super(),this.data=e,this.allowVariableSaves=i,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.needsJitter=t.shared.needsJitter,Oi.startContext(this),this.reset0(e,t),Oi.endContext(this)}get nodeMaterial(){return this}getFlavor(e,t,i){let r=i?6:(e?3:0)+t;if(r===0)return this;this.flavors===void 0&&(this.flavors=[]),r-=1;let s=this.flavors[r];return s===void 0&&(s=new YG(e,t,i,this),s.needsJitter=this.needsJitter,this.flavors[r]=s,s.flatShading=e,s.side=t,s.updateAfterBuild()),s}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){var e;return((e=this.lightLayer.getNode("occlusion"))==null?void 0:e.value)??!1}reset(e,t,i=!1){Oi.startContext(this),(this.data!==e||i)&&this.reset0(e,t),Oi.endContext(this)}reset0(e,t){this.data=e;let i=e.layers??a1.defaultTwoLayerData("phong").layers;try{this.layers=i.map(r=>uh.create(this.layerIdGen++,r.id,r.data,t.shared))}catch{this.layers=[]}this.layers.reverse(),this.name=e.name??"Untitled Material",this.onUpdate(t.shared),this.transparent=Uo(e,t.shared),this.saveVariableLocations(t)}onVariableUpdate(e,t,i){if(e[0]==="alphaOverride")this.transparent=Uo(this.data,i.shared),this.lightLayer.setValue("alphaOverride",Math.max(0,Math.min(Number(t)/100,1)));else if(e[0]==="layer"){let r=e[1],s=e[2];if(r&&s){let a=this.layers.find(n=>n.uuid===r);a!=null&&a.hasValue(s)&&(s==="alpha"?(this.transparent=Uo(this.data,i.shared),a.setValue(s,Math.max(0,Math.min(Number(t)/100,1)))):a.setValue(s,t))}}}saveVariableLocations(e){if(!this.allowVariableSaves)return;let t=this.data.layers.find(i=>i.data.type==="light");t&&e.shared.getVariable(t.data.alphaOverride,["material",this.uuid,"alphaOverride"]),this.data.layers.forEach(i=>{"alpha"in i.data&&typeof i.data.alpha=="string"&&e.shared.getVariable(i.data.alpha,["material",this.uuid,"layer",i.id,"alpha"])})}getLayersOfType(e){return this.layers.filter(t=>t.type===e)}getLayerByUuid(e){return this.layers.find(t=>t.uuid===e)}onUpdate(e){this.lightLayer=this.layers.find(t=>t instanceof $r),this.lightLayer===void 0&&(this.lightLayer=new $r(0,"",{...ji.defaultData("light","phong"),visible:!1},new i5,{},e)),this.dispose();for(let t of this.flavors)t&&t.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),this.build(),this.nodeContextUuid=0}applyTextureMaps(){let e=this.layers.find(s=>s instanceof $r);if(!e)return;let t=e.data,i=t.bumpMap,r=t.roughnessMap;e.node.bumpMap=void 0,e.node.roughnessMap=void 0;for(let s=0;s<this.layers.length;++s){let a=this.layers[s];a instanceof oi&&a.color instanceof e5&&(a.uuid===i&&(e.node.bumpMap=a.color),a.uuid===r&&(e.node.roughnessMap=a.color))}}updateByOp(e,t,i){if(Oi.startContext(this),t!==void 0?this.data=t:t=this.data,this.transparent=Uo(t,i.shared),e.path[0]==="layers"){let r=i.shared,s=e.path[1];if(s===void 0)i.scene.markNeedsUpdateRendererDirty(),this.reset0(t,i);else{e.type===0&&e.props.occlusion!==void 0&&i.scene.markNeedsUpdateRendererDirty();let a=this.layers.find(n=>n.uuid===s);if(a){let n=t.layers.data(s),o;e.type===0&&("alpha"in e.props||"alphaOverride"in e.props)&&("alpha"in e.props?o={...e.props,alpha:Un(e.props.alpha,r,["material",this.uuid,"layer",s,"alpha"])}:o={...e.props,alphaOverride:Un(e.props.alphaOverride,r,["material",this.uuid,"alphaOverride"])}),a.updateByOp({...e,...o?{props:o}:{},path:e.path.slice(2)},n,i)&&this.reset0(t,i)}}}else this.reset0(t,i);Oi.endContext(this)}applyMasks(){for(let e=0;e<this.layers.length;++e){let t=this.layers[e];t instanceof oi?t.color.mask=void 0:t instanceof $r&&(t.node.mask=void 0)}for(let e=0;e<this.layers.length;++e){let t=this.layers[e];if(t instanceof oi&&t.isMask.value&&t.data.visible&&e>0){let i=e-1,r=this.layers[i];r instanceof $r?r.node.mask=new L1(t.color,t.alpha,L1.MUL):r instanceof oi&&(r.isMask.value||(r.color.mask=new L1(t.color,t.alpha,L1.MUL)))}}}blendColors(){let e=this.layers.findIndex(i=>i instanceof oi),t=this.layers.findIndex(i=>i instanceof $r);if(e!==-1&&e<t){let i=this.layers[e].color;for(let r=e+1;r<t;++r){let s=this.layers[r];if(s instanceof oi){if(s.isMask.value)continue;i=new kg(i,s.color,s.alpha,s.mode)}}this.fragment.color=i}else this.fragment.color=void 0}blendAfterColors(){let e=new Kt("outgoingLight","f"),t=this.layers.findIndex(i=>i instanceof $r);if(this.layers.length>t+1){for(let i=t+1;i<this.layers.length;++i){let r=this.layers[i];if(r instanceof oi){if(r.isMask.value)continue;e=new kg(e,r.color,r.alpha,r.mode)}}this.fragment.afterColor=e}else this.fragment.afterColor=void 0}blendPositions(){let e=this.layers.filter(t=>t instanceof Eb);if(e.length>0){let t=e[0].position;for(let i=1;i<e.length;++i)e[i]&&(t=new L1(t,e[i].position,L1.ADD),t=new L1(t,new ze(.5).setReadonly(!0),L1.MUL));this.fragment.position=t}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(e){e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.extensionDerivatives=this.extensions.derivatives===!0,e.extensionFragDepth=this.extensions.fragDepth===!0,e.extensionDrawBuffers=this.extensions.drawBuffers===!0,e.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(e,t){let i=(r,s,a)=>Math.min(Math.max(r,s),a);for(let r of this.layers)if(r.type==="displace"){let s=i(r.uniforms[`f${r.id}_intensity`].value,e,t);r.uniforms[`f${r.id}_intensity`].value=s}}updateFrame(e){for(let t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])}build(){let e=new Jx;e.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,e.build(this.fragment,this.fragment),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.updaters=e.updaters;for(let t of this.flavors)t&&t.updateAfterBuild();return this}nodeMaterialDispose(){this.layers.forEach(e=>e.dispose()),super.dispose();for(let e of this.flavors)e&&e.dispose()}assetsLoaded(){for(let e of this.layers)if(e instanceof oi){let t=e.params.texture;if(t instanceof xf&&!t.image.loaded)return!1}return!0}};Object.defineProperties(Wa.prototype,{properties:{get:function(){return this.fragment.properties}}});var _f=class extends r5{constructor(e,t,i){super(e,t,!1),this.uuid=i,this.allowVariableSaves=!0,this.saveVariableLocations(t)}},Xg=new Map;function XG(e){if(typeof e=="string")return e;let t=Xg.get(e);return t||(t={url:URL.createObjectURL(new Blob([e]))},Xg.set(e,t)),t.url}var Tb,QG=new Promise(e=>{Tb=e}),Qg=!1,_0;function ZG(){if(Qg)return;if(_0)return _0;async function e(){await Ya(()=>import("./DdXaTUle.js").then(t=>t.h),__vite__mapDeps([0,1,2]),import.meta.url),Tb(window!==void 0?window:global),Qg=!0}return _0=e(),_0}var Pb;QG.then(e=>Pb=e);function KG(e){let t=!1;return e.scene.objects.traverse((i,r)=>{if(r.events===void 0||Array.isArray(r.events)===!1)return!0;let s=[];r.events.forEach(a=>{"dragDropActions"in a.data?(s.push(...a.data.dragDropActions.drag),s.push(...a.data.dragDropActions.drop)):"inActions"in a.data?(s.push(...a.data.inActions),s.push(...a.data.outActions)):"gameActions"in a.data?(s.push(...a.data.gameActions.idle),s.push(...a.data.gameActions.move),s.push(...a.data.gameActions.jump),s.push(...a.data.gameActions.run)):"breakpoints"in a.data?a.data.breakpoints.forEach(n=>{s.push(...n.data.actions)}):"actions"in a.data&&s.push(...a.data.actions),t=t||s.some(n=>n.data.type==="Audio")})}),t}var y2=class{constructor({src:e,volume:t,delay:i,loop:r}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let s;typeof e=="string"?s={src:e}:s={src:XG(e),format:"wav"},this.sound=new Pb.Howl(s),this.sound.on("end",this.onEnd),this.src=e,t!==void 0&&(this.volume=t),i!==void 0&&(this.delay=i),r!==void 0&&(this.loop=r)}get status(){return this._status}get volume(){return this._volume}set volume(e){this._volume=e,this.sound.volume(e)}get loop(){return this._loop}set loop(e){this._loop=e,this.loopsRemaining=e}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(e,t=1e3){e?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,t),this.clearFade()},e)):this.sound.fade(this._volume,0,t)}on(e,t,i){this.sound.on(e,t,i)}off(e,t,i){this.sound.off(e,t,i)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(e=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},JG=class{constructor(){this.type="ShapePath",this.color=new Je,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new mc,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){var i;return(i=this.currentPath)==null||i.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){var s;return(s=this.currentPath)==null||s.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,s,a){var n;return(n=this.currentPath)==null||n.bezierCurveTo(e,t,i,r,s,a),this}splineThru(e){var t;return(t=this.currentPath)==null||t.splineThru(e),this}toShapes(){let e={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},t={loc:e.ORIGIN,t:0};function i(p,f,g,m){let v=p.x,y=f.x,x=g.x,w=m.x,_=p.y,b=f.y,A=g.y,S=m.y,M=(w-x)*(_-A)-(S-A)*(v-x),C=(y-v)*(_-A)-(b-_)*(v-x),T=(S-A)*(y-v)-(w-x)*(b-_),P=M/T,I=C/T;if(T===0&&M!==0||P<=0||P>=1||I<0||I>1)return null;if(M===0&&T===0){for(let D=0;D<2;D++)if(r(D===0?g:m,p,f),t.loc===e.ORIGIN){let k=D===0?g:m;return{x:k.x,y:k.y,t:t.t}}else if(t.loc===e.BETWEEN){let k=+(v+t.t*(y-v)).toPrecision(10),H=+(_+t.t*(b-_)).toPrecision(10);return{x:k,y:H,t:t.t}}return null}else{for(let H=0;H<2;H++)if(r(H===0?g:m,p,f),t.loc===e.ORIGIN){let U=H===0?g:m;return{x:U.x,y:U.y,t:t.t}}let D=+(v+P*(y-v)).toPrecision(10),k=+(_+P*(b-_)).toPrecision(10);return{x:D,y:k,t:P}}}function r(p,f,g){let m=g.x-f.x,v=g.y-f.y,y=p.x-f.x,x=p.y-f.y,w=m*x-y*v;if(p.x===f.x&&p.y===f.y){t.loc=e.ORIGIN,t.t=0;return}if(p.x===g.x&&p.y===g.y){t.loc=e.DESTINATION,t.t=1;return}if(w<-Number.EPSILON){t.loc=e.LEFT;return}if(w>Number.EPSILON){t.loc=e.RIGHT;return}if(m*y<0||v*x<0){t.loc=e.BEHIND;return}if(Math.sqrt(m*m+v*v)<Math.sqrt(y*y+x*x)){t.loc=e.BEYOND;return}let _;m!==0?_=y/m:_=x/v,t.loc=e.BETWEEN,t.t=_}function s(p,f){let g=[],m=[];for(let v=1;v<p.length;v++){let y=p[v-1],x=p[v];for(let w=1;w<f.length;w++){let _=f[w-1],b=f[w],A=i(y,x,_,b);A!==null&&g.find(S=>S.t<=A.t+Number.EPSILON&&S.t>=A.t-Number.EPSILON)===void 0&&(g.push(A),m.push(new j(A.x,A.y)))}}return m}function a(p,f,g){let m=new j;f.getCenter(m);let v=[];return g.forEach(y=>{y.boundingBox.containsPoint(m)&&s(p,y.points).forEach(x=>{v.push({identifier:y.identifier,isCW:y.isCW,point:x})})}),v.sort((y,x)=>y.point.x-x.point.x),v}function n(p,f,g,m,v){(v==null||v==="")&&(v="nonzero");let y=new j;p.boundingBox.getCenter(y);let x=[new j(g,y.y),new j(m,y.y)],w=a(x,p.boundingBox,f);w.sort((C,T)=>C.point.x-T.point.x);let _=[],b=[];w.forEach(C=>{C.identifier===p.identifier?_.push(C):b.push(C)});let A=_[0].point.x,S=[],M=0;for(;M<b.length&&b[M].point.x<A;)S.length>0&&S[S.length-1]===b[M].identifier?S.pop():S.push(b[M].identifier),M++;if(S.push(p.identifier),v==="evenodd"){let C=S.length%2===0,T=S[S.length-2];return{identifier:p.identifier,isHole:C,for:T}}else if(v==="nonzero"){let C=!0,T=null,P=null;for(let I=0;I<S.length;I++){let D=S[I];f[D]&&(C?(P=f[D].isCW,C=!1,T=D):P!==f[D].isCW&&(P=f[D].isCW,C=!0))}return{identifier:p.identifier,isHole:C,for:T}}else""+v}let o=0,l=999999999,h=-999999999,c=[];this.subPaths.forEach(p=>{let f=p.getPoints(),g=-999999999,m=999999999,v=-999999999,y=999999999;for(let x=0;x<f.length;x++){let w=f[x];w.y>g&&(g=w.y),w.y<m&&(m=w.y),w.x>v&&(v=w.x),w.x<y&&(y=w.x)}h<=v&&(h=v+1),l>=y&&(l=y-1),f.length&&c.push({curves:p.curves,points:f,isCW:Iv.isClockWise(f),identifier:o++,boundingBox:new Gv(new j(y,m),new j(v,g))})});let d=c.map(p=>{var f;return n(p,c,l,h,(f=this.userData)==null?void 0:f.style.fillRule)}),u=[];return c.forEach(p=>{let f=d[p.identifier];if(f&&!f.isHole){let g=new gc;g.curves=p.curves,d.filter(m=>(m==null?void 0:m.isHole)&&m.for===p.identifier).forEach(m=>{if(m){let v=c[m.identifier],y=new mc;y.curves=v.curves,g.holes.push(y)}}),u.push(g)}}),u}},Db=!1,Ib,Zg=new Promise(e=>{Ib=e}),Kg=!1,A0;function $G(){if(Db=!0,Kg)return;if(A0)return A0;async function e(){let t=await Ya(()=>import("./BDihiR1K.js"),[],import.meta.url);Ib(t),Kg=!0}return A0=e(),A0}var eH=class{async load(e,t,i=()=>{}){let{load:r}=await Zg;r(e,(s,a)=>{s||!a?i(s??"Something went wrong"):t(a)})}async parse(e){let{parse:t,Bidi:i}=await Zg;try{let r=t(e),s=new i,a=n=>r.charToGlyphIndex(n.char);return s.registerModifier("glyphIndex",null,a),s.applyFeatures(r,r.defaultRenderOptions.features),{font:r,bidi:s}}catch(r){}}};async function tH(e){return await(await fetch(e)).arrayBuffer()}var iH=new eH;async function Jg(e){let t,i,r=!1;if(e.url?(t=await tH(e.url),i=e.url,r=e.url.startsWith("/")):e.data&&(t=e.data.buffer.slice(e.data.byteOffset,e.data.byteOffset+e.data.byteLength)),t)if(Db){let s=await iH.parse(t);if(s)return{font:s.font,url:i,intercepted:r,arr:t,bidi:s.bidi}}else return{font:void 0,url:i,intercepted:r,arr:t,bidi:null}}function rH(e,t){return t.state.glyphIndex===e||t.state.fina===e||t.state.medi===e||t.state.init===e}var sH=class{constructor(e){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=Jg(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}update(e){this._isLoaded=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=Jg(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(e,t,i){if(!this._bidi)return[];let r=this._bidi;r.getTextGlyphs(t);let s=r.tokenizer.tokens,a=[],n=0,o=i.length===s.length;for(let l=0;l<i.length;l++){let h=i[l].index,c=String.fromCharCode(i[l].unicode),d=s[n];if(rH(h,d)||o)a.push({char:c,index:h,replacements:[d.state.glyphIndex],replacementChars:[d.char]}),n++;else{let u=d.char,p="",f=[d.state.glyphIndex],g=[],m=!1;for(;!m;)n++,p=t.charAt(n),u+=p,f.push(e.charToGlyphIndex(p)),g=e.stringToGlyphs(u),g.length===1&&g[0].index===h&&(m=!0),n>t.length&&(m=!0);a.push({char:c,index:h,replacements:f,replacementChars:Array.from(u)}),n++}}return a}generateShapes(e,t){if(!this._isLoaded)return;let i=this.font,r=t.fontSize/this.unitsPerEm,s=t.fontSize*t.lineHeight,a=e.map(v=>this.getTextWidth(v,t)),n=t.width,o=this.getCharWidth(`
`,t),l=t.horizontalAlign===1?o:0,h=this.computeSpaceWidthForLine(e,0,t),c=this.getLineInitialOffsetX(a[0],n,t.horizontalAlign,e[0],o),d=this.getLineInitialOffsetY(s,e.length,t.height,r,t.verticalAlign),u=[],p=e.map(v=>[]),f=e.map(v=>[]),g;for(let v=0;v<e.length;v++){let y=e[v],x={features:{liga:!0}},w=[];try{w=i.stringToGlyphs(y,x)}catch(b){}c=this.getLineInitialOffsetX(a[v],n,t.horizontalAlign,y,o);let _=[];try{_=this.reverseLigaturesTable(i,y,w)}catch(b){}h=this.computeSpaceWidthForLine(e,v,t);for(let b=0;b<w.length;b++){let A=w[b],S=A.index===0?`
`:A.unicode?String.fromCharCode(A.unicode):void 0,M=_[b],C=0,T=0;b===0&&t.horizontalAlign===2&&A.leftSideBearing!==void 0&&(T=-A.leftSideBearing*r),g&&(C=i.getKerningValue(A,g)*r),c+=T+C;let P=0;if(S===`
`)P=l;else if(S===" ")P=h;else{let I=this.createPath(A,r,c,d,t);I&&(P=I.offsetX-(C+T),u.push(I.path))}if(M.replacements.length===1)f[v].push([c,d]),p[v].push(P);else{let I=M.replacements.map(U=>(i.glyphs.get(U).advanceWidth??0)*r),D=I.reduce((U,F)=>U+=F,0),k=I.map(U=>U/D),H=c;for(let U=0;U<k.length;U++){let F=P*k[U];f[v].push([H,d]),p[v].push(F),H+=F}}c+=P,g=A}d-=s}let m=[];for(let v=0,y=u.length;v<y;v++)m.push(...u[v].toShapes());return{shapes:m,charWidths:p,lineWidths:a,charCoords:f}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var e;return((e=this.font)==null?void 0:e.ascender)??0}get descender(){var e;return((e=this.font)==null?void 0:e.descender)??0}get familyName(){var e;return((e=this.font)==null?void 0:e.names.fontFamily)??""}get subfamilyName(){var e;return((e=this.font)==null?void 0:e.names.fontSubfamily)??""}get unitsPerEm(){var e;return((e=this.font)==null?void 0:e.unitsPerEm)??1}getLineInitialOffsetX(e,t,i,r,s){return(i===3||i===2)&&r.indexOf(`
`)>=0&&(e-=s),i===3?t*.5-e*.5:i===2?t-e:0}getLineInitialOffsetY(e,t,i,r,s){let a=t*e,n=Math.abs(this.ascender-this.descender)*r,o=e-n,l=-this.ascender*r-o/2;return s===3?-(i-a-l):s===2?-(i*.5-a*.5-l):l}createPath(e,t,i,r,s){var l;let a=e.getPath(i,-r,s.fontSize,{kerning:!1,letterSpacing:s.letterSpacing});if(!a){""+e+this.familyName;return}let n=new JG,o=(e.advanceWidth??1)*t;if(e)for(let h of a.commands){let c=(l=n.currentPath)==null?void 0:l.currentPoint;if(!(c&&h.type!=="Z"&&c.x===h.x&&-c.y===h.y))switch(h.type){case"M":n.moveTo(h.x,-h.y);break;case"L":n.lineTo(h.x,-h.y);break;case"Q":n.quadraticCurveTo(h.x1,-h.y1,h.x,-h.y);break;case"C":n.bezierCurveTo(h.x1,-h.y1,h.x2,-h.y2,h.x,-h.y);break}}return n.subPaths.forEach(h=>{let c=aH(h.curves);c!==void 0&&h.currentPoint.distanceTo(c)>0&&h.lineTo(c.x,c.y)}),{offsetX:o+s.fontSize*s.letterSpacing,path:n}}getCharWidth(e,t){var i;return((i=this.font)==null?void 0:i.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))??0}getTextWidth(e,t){var i;return((i=this.font)==null?void 0:i.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))??0}computeSpaceWidthForLine(e,t,i){let r=this.getCharWidth(" ",i),s=e[t];if(s){let a=this.countSpaces(s.trimEnd());if(i.horizontalAlign===4&&t<e.length-1&&a){let n=i.width,o=this.getTextWidth(s,i);return(n-(o-a*r))/a}}return r}countSpaces(e){return(e.match(/ /g)||[]).length}};function aH(e){if(e.length){let t=e[0];if(t instanceof Ir)return t.v1;if(t instanceof Cr||t instanceof Ga)return t.v0}}var nH=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(e){return this.objects.get(e)}get size(){return this.objects.size}get(e,t,i){let r=this.objects.get(e);return r===void 0?(r=this.createObject(e,t,i),this.objects.set(e,r)):r.isShared=!0,r}forceDelete(e){let t=this.objects.get(e);t&&(this.disposeObject(t),this.objects.delete(e))}mutateIfUnique(e,t){let i=this.objects.get(e);if(i&&i.isShared!==!0)return this.objects.delete(e),this.objects.set(t,i),i}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(e,t){let i=this.objects.get(e);t===i&&this.unreachable.delete(e)}endGc(){this.unreachable.forEach(e=>{this.disposeObject(this.objects.get(e)),this.objects.delete(e)}),this.unreachable.clear()}dispose(){this.objects.forEach(e=>{this.disposeObject(e)}),this.objects.clear()}},$g=class extends nH{constructor(e){super(),this.flatShading=e}disposeObject(e){e.dispose()}createObject(e,t,i){let r=$2(e,t,this.flatShading,i);return r.computeBoundingSphere(),r}},oH={markNeedsUpdateRendererDirty:()=>{}},$0=1e3,e8=512*$0;function lH(e,t){let i=typeof e;return!!((t==="string"||t==="number")&&i===t||t==="boolean"&&(e==="true"||e==="false"||e===!0||e===!1)||t==="image"&&i==="string"&&e.startsWith("http"))}var hH="https://hooks.spline.design",cH=`${hH}/events?hashFile=`,dH=class{constructor(e,t){this.id=e,this.userWebhook=t,this.result=void 0,this._connected=!1,this.emitter=Id(),this.reconnectWaitFor=$0,this._onError=i=>{var r,s,a;(r=this.eventSource)==null||r.removeEventListener("message",this._onMessage),(s=this.eventSource)==null||s.removeEventListener("error",this._onError),(a=this.eventSource)==null||a.removeEventListener("open",this._onConnected),this._scheduleReconnect()},this._onConnected=i=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=$0,this._connected=!0},this._onDisconnected=()=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=$0,this._connected=!1},this._onMessage=i=>{let r=i.data,s;try{s=JSON.parse(r)}catch(a){}if(s){let a=!1;this.userWebhook.parametersSchemas.forEach(({data:n})=>{s[n.name]!==void 0&&lH(s[n.name],n.type)&&(this.result===void 0&&(this.result={}),this.result[n.name]=s[n.name],a=!0)}),a&&this.emitter.emit("message",{userWebhookId:this.id})}}}connect(){clearTimeout(this.scheduledReconnectHandle),this.userWebhook.url&&(this.eventSource=new EventSource(cH+this.userWebhook.url),this.eventSource.addEventListener("message",this._onMessage),this.eventSource.addEventListener("error",this._onError),this.eventSource.addEventListener("open",this._onConnected))}disconnect(){var e,t,i,r;(e=this.eventSource)==null||e.removeEventListener("message",this._onMessage),(t=this.eventSource)==null||t.removeEventListener("error",this._onError),(i=this.eventSource)==null||i.removeEventListener("open",this._onConnected),(r=this.eventSource)==null||r.close(),this._onDisconnected(),clearTimeout(this.scheduledReconnectHandle)}_scheduleReconnect(){this.reconnectWaitFor*=2,this.reconnectWaitFor>e8&&(this.reconnectWaitFor=e8),clearTimeout(this.scheduledReconnectHandle),this.scheduledReconnectHandle=setTimeout(()=>{this.scheduledReconnectHandle=void 0,this.connect()},this.reconnectWaitFor)}update(e){this.userWebhook=e}dispose(){this._connected&&this.disconnect()}get connected(){return this._connected}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}getParametersKeys(){return this.userWebhook.parametersSchemas.map(e=>e.data.name)}getParameterValue(e){var t;if(this.getParametersKeys().includes(e)){if(this.result)return(t=this.result)==null?void 0:t[e];for(let i of this.userWebhook.parametersSchemas)if(i.data.name===e)return Z3.defaultParameterValueByType(i.data.type)}}},uH=globalThis.atob,pH=globalThis.btoa,Zo=class{static floatTo16BitPCM(e){let t=new ArrayBuffer(e.length*2),i=new DataView(t),r=0;for(let s=0;s<e.length;s++,r+=2){let a=Math.max(-1,Math.min(1,e[s]));i.setInt16(r,a<0?a*32768:a*32767,!0)}return t}static base64ToArrayBuffer(e){let t=uH(e),i=t.length,r=new Uint8Array(i);for(let s=0;s<i;s++)r[s]=t.charCodeAt(s);return r.buffer}static arrayBufferToBase64(e){e instanceof Float32Array?e=this.floatTo16BitPCM(e):e instanceof Int16Array&&(e=e.buffer);let t="",i=new Uint8Array(e),r=32768;for(let s=0;s<i.length;s+=r){let a=i.subarray(s,s+r);t+=String.fromCharCode.apply(null,a)}return pH(t)}static mergeInt16Arrays(e,t){if(e instanceof ArrayBuffer&&(e=new Int16Array(e)),t instanceof ArrayBuffer&&(t=new Int16Array(t)),!(e instanceof Int16Array)||!(t instanceof Int16Array))throw new Error("Both items must be Int16Array");let i=new Int16Array(e.length+t.length);for(let r=0;r<e.length;r++)i[r]=e[r];for(let r=0;r<t.length;r++)i[e.length+r]=t[r];return i}static generateId(e,t=21){let i="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",r=Array(t-e.length).fill(0).map(s=>i[Math.floor(Math.random()*i.length)]).join("");return`${e}${r}`}},fH=e=>new Promise(t=>setTimeout(()=>t(),e)),Ob=class{constructor(){this.eventHandlers={},this.nextEventHandlers={}}clearEventHandlers(){return this.eventHandlers={},this.nextEventHandlers={},!0}on(e,t){return this.eventHandlers[e]=this.eventHandlers[e]||[],this.eventHandlers[e].push(t),t}onNext(e,t){return this.nextEventHandlers[e]=this.nextEventHandlers[e]||[],this.nextEventHandlers[e].push(t),t}off(e,t){let i=this.eventHandlers[e]||[];if(t){let r=i.indexOf(t);if(r===-1)throw new Error(`Could not turn off specified event listener for "${e}": not found as a listener`);i.splice(r,1)}else delete this.eventHandlers[e];return!0}offNext(e,t){let i=this.nextEventHandlers[e]||[];if(t){let r=i.indexOf(t);if(r===-1)throw new Error(`Could not turn off specified next event listener for "${e}": not found as a listener`);i.splice(r,1)}else delete this.nextEventHandlers[e];return!0}async waitForNext(e,t=null){let i=Date.now(),r;for(this.onNext(e,s=>r=s);!r;){if(t&&Date.now()-i>t)return null;await fH(1)}return r}dispatch(e,t){let i=[].concat(this.eventHandlers[e]||[]);for(let s of i)s(t);let r=[].concat(this.nextEventHandlers[e]||[]);for(let s of r)s(t);return delete this.nextEventHandlers[e],!0}},mH=class extends Ob{constructor({url:e,apiKey:t,dangerouslyAllowAPIKeyInBrowser:i,debug:r}={}){if(super(),this.defaultUrl="wss://api.openai.com/v1/realtime",this.url=e||this.defaultUrl,this.apiKey=t||null,this.debug=!!r,this.ws=null,globalThis.document&&this.apiKey&&!i)throw new Error('Can not provide API key in the browser without "dangerouslyAllowAPIKeyInBrowser" set to true')}isConnected(){return!!this.ws}log(...e){let t=[`[Websocket/${new Date().toISOString()}]`].concat(e).map(i=>typeof i=="object"&&i!==null?JSON.stringify(i,null,2):i);return this.debug&&[...t],!0}async connect({model:e}={model:"gpt-4o-realtime-preview-2024-10-01"}){if(!this.apiKey&&this.url===this.defaultUrl&&`${this.url}`,this.isConnected())throw new Error("Already connected");if(globalThis.document){this.apiKey;let t=globalThis.WebSocket,i=new t(`${this.url}${e?`?model=${e}`:""}`,["realtime",`openai-insecure-api-key.${this.apiKey}`,"openai-beta.realtime-v1"]);return i.addEventListener("message",r=>{let s=JSON.parse(r.data);this.receive(s.type,s)}),new Promise((r,s)=>{let a=()=>{this.disconnect(i),s(new Error(`Could not connect to "${this.url}"`))};i.addEventListener("error",a),i.addEventListener("open",()=>{this.log(`Connected to "${this.url}"`),i.removeEventListener("error",a),i.addEventListener("error",()=>{this.disconnect(i),this.log(`Error, disconnected from "${this.url}"`),this.dispatch("close",{error:!0})}),i.addEventListener("close",()=>{this.disconnect(i),this.log(`Disconnected from "${this.url}"`),this.dispatch("close",{error:!1})}),this.ws=i,r(!0)})})}}disconnect(e){if(!e||this.ws===e)return this.ws&&this.ws.close(),this.ws=null,!0}receive(e,t){return this.log("received:",e,t),this.dispatch(`server.${e}`,t),this.dispatch("server.*",t),!0}send(e,t){if(!this.isConnected())throw new Error("RealtimeAPI is not connected");if(t=t||{},typeof t!="object")throw new Error("data must be an object");let i={event_id:Zo.generateId("evt_"),type:e,...t};return this.dispatch(`client.${e}`,i),this.dispatch("client.*",i),this.log("sent:",e,i),this.ws.send(JSON.stringify(i)),!0}},gH=class{constructor(){gn(this,"defaultFrequency",24e3),gn(this,"EventProcessors",{"conversation.item.created":e=>{let{item:t}=e,i=JSON.parse(JSON.stringify(t));if(this.itemLookup[i.id]||(this.itemLookup[i.id]=i,this.items.push(i)),i.formatted={},i.formatted.audio=new Int16Array(0),i.formatted.text="",i.formatted.transcript="",this.queuedSpeechItems[i.id]&&(i.formatted.audio=this.queuedSpeechItems[i.id].audio,delete this.queuedSpeechItems[i.id]),i.content){let r=i.content.filter(s=>["text","input_text"].includes(s.type));for(let s of r)i.formatted.text+=s.text}return this.queuedTranscriptItems[i.id]&&(i.formatted.transcript=this.queuedTranscriptItems.transcript,delete this.queuedTranscriptItems[i.id]),i.type==="message"?i.role==="user"?(i.status="completed",this.queuedInputAudio&&(i.formatted.audio=this.queuedInputAudio,this.queuedInputAudio=null)):i.status="in_progress":i.type==="function_call"?(i.formatted.tool={type:"function",name:i.name,call_id:i.call_id,arguments:""},i.status="in_progress"):i.type==="function_call_output"&&(i.status="completed",i.formatted.output=i.output),{item:i,delta:null}},"conversation.item.truncated":e=>{let{item_id:t,audio_end_ms:i}=e,r=this.itemLookup[t];if(!r)throw new Error(`item.truncated: Item "${t}" not found`);let s=Math.floor(i*this.defaultFrequency/1e3);return r.formatted.transcript="",r.formatted.audio=r.formatted.audio.slice(0,s),{item:r,delta:null}},"conversation.item.deleted":e=>{let{item_id:t}=e,i=this.itemLookup[t];if(!i)throw new Error(`item.deleted: Item "${t}" not found`);delete this.itemLookup[i.id];let r=this.items.indexOf(i);return r>-1&&this.items.splice(r,1),{item:i,delta:null}},"conversation.item.input_audio_transcription.completed":e=>{let{item_id:t,content_index:i,transcript:r}=e,s=this.itemLookup[t],a=r||" ";return s?(s.content[i].transcript=r,s.formatted.transcript=a,{item:s,delta:{transcript:r}}):(this.queuedTranscriptItems[t]={transcript:a},{item:null,delta:null})},"input_audio_buffer.speech_started":e=>{let{item_id:t,audio_start_ms:i}=e;return this.queuedSpeechItems[t]={audio_start_ms:i},{item:null,delta:null}},"input_audio_buffer.speech_stopped":(e,t)=>{let{item_id:i,audio_end_ms:r}=e;this.queuedSpeechItems[i]||(this.queuedSpeechItems[i]={audio_start_ms:r});let s=this.queuedSpeechItems[i];if(s.audio_end_ms=r,t){let a=Math.floor(s.audio_start_ms*this.defaultFrequency/1e3),n=Math.floor(s.audio_end_ms*this.defaultFrequency/1e3);s.audio=t.slice(a,n)}return{item:null,delta:null}},"response.created":e=>{let{response:t}=e;return this.responseLookup[t.id]||(this.responseLookup[t.id]=t,this.responses.push(t)),{item:null,delta:null}},"response.output_item.added":e=>{let{response_id:t,item:i}=e,r=this.responseLookup[t];if(!r)throw new Error(`response.output_item.added: Response "${t}" not found`);return r.output.push(i.id),{item:null,delta:null}},"response.output_item.done":e=>{let{item:t}=e;if(!t)throw new Error('response.output_item.done: Missing "item"');let i=this.itemLookup[t.id];if(!i)throw new Error(`response.output_item.done: Item "${t.id}" not found`);return i.status=t.status,{item:i,delta:null}},"response.content_part.added":e=>{let{item_id:t,part:i}=e,r=this.itemLookup[t];if(!r)throw new Error(`response.content_part.added: Item "${t}" not found`);return r.content.push(i),{item:r,delta:null}},"response.audio_transcript.delta":e=>{let{item_id:t,content_index:i,delta:r}=e,s=this.itemLookup[t];if(!s)throw new Error(`response.audio_transcript.delta: Item "${t}" not found`);return s.content[i].transcript+=r,s.formatted.transcript+=r,{item:s,delta:{transcript:r}}},"response.audio.delta":e=>{let{item_id:t,content_index:i,delta:r}=e,s=this.itemLookup[t];if(!s)throw new Error(`response.audio.delta: Item "${t}" not found`);let a=Zo.base64ToArrayBuffer(r),n=new Int16Array(a);return s.formatted.audio=Zo.mergeInt16Arrays(s.formatted.audio,n),{item:s,delta:{audio:n}}},"response.text.delta":e=>{let{item_id:t,content_index:i,delta:r}=e,s=this.itemLookup[t];if(!s)throw new Error(`response.text.delta: Item "${t}" not found`);return s.content[i].text+=r,s.formatted.text+=r,{item:s,delta:{text:r}}},"response.function_call_arguments.delta":e=>{let{item_id:t,delta:i}=e,r=this.itemLookup[t];if(!r)throw new Error(`response.function_call_arguments.delta: Item "${t}" not found`);return r.arguments+=i,r.formatted.tool.arguments+=i,{item:r,delta:{arguments:i}}}}),this.clear()}clear(){return this.itemLookup={},this.items=[],this.responseLookup={},this.responses=[],this.queuedSpeechItems={},this.queuedTranscriptItems={},this.queuedInputAudio=null,!0}queueInputAudio(e){return this.queuedInputAudio=e,e}processEvent(e,...t){if(!e.event_id)throw new Error('Missing "event_id" on event');if(!e.type)throw new Error('Missing "type" on event');let i=this.EventProcessors[e.type];if(!i)throw new Error(`Missing conversation event processor for "${e.type}"`);return i.call(this,e,...t)}getItem(e){return this.itemLookup[e]||null}getItems(){return this.items.slice()}},t8=class extends Ob{constructor({url:e,apiKey:t,dangerouslyAllowAPIKeyInBrowser:i,debug:r}={}){super(),this.defaultSessionConfig={modalities:["text","audio"],instructions:"",voice:"alloy",input_audio_format:"pcm16",output_audio_format:"pcm16",input_audio_transcription:null,turn_detection:null,tools:[],tool_choice:"auto",temperature:.8,max_response_output_tokens:4096},this.sessionConfig={},this.transcriptionModels=[{model:"whisper-1"}],this.defaultServerVadConfig={type:"server_vad",threshold:.5,prefix_padding_ms:300,silence_duration_ms:200},this.realtime=new mH({url:e,apiKey:t,dangerouslyAllowAPIKeyInBrowser:i,debug:r}),this.conversation=new gH,this._resetConfig(),this._addAPIEventHandlers()}_resetConfig(){return this.sessionCreated=!1,this.tools={},this.sessionConfig=JSON.parse(JSON.stringify(this.defaultSessionConfig)),this.inputAudioBuffer=new Int16Array(0),!0}_addAPIEventHandlers(){this.realtime.on("client.*",r=>{let s={time:new Date().toISOString(),source:"client",event:r};this.dispatch("realtime.event",s)}),this.realtime.on("server.*",r=>{let s={time:new Date().toISOString(),source:"server",event:r};this.dispatch("realtime.event",s)}),this.realtime.on("server.session.created",()=>this.sessionCreated=!0);let e=(r,...s)=>{let{item:a,delta:n}=this.conversation.processEvent(r,...s);return{item:a,delta:n}},t=(r,...s)=>{let{item:a,delta:n}=e(r,...s);return a&&this.dispatch("conversation.updated",{item:a,delta:n}),{item:a,delta:n}},i=async r=>{try{let s=JSON.parse(r.arguments),a=this.tools[r.name];if(!a)throw new Error(`Tool "${r.name}" has not been added`);let n=await a.handler(s);this.realtime.send("conversation.item.create",{item:{type:"function_call_output",call_id:r.call_id,output:JSON.stringify(n)}})}catch(s){this.realtime.send("conversation.item.create",{item:{type:"function_call_output",call_id:r.call_id,output:JSON.stringify({error:s.message})}})}this.createResponse()};return this.realtime.on("server.response.created",e),this.realtime.on("server.response.output_item.added",e),this.realtime.on("server.response.content_part.added",e),this.realtime.on("server.input_audio_buffer.speech_started",r=>{e(r),this.dispatch("conversation.interrupted")}),this.realtime.on("server.input_audio_buffer.speech_stopped",r=>e(r,this.inputAudioBuffer)),this.realtime.on("server.conversation.item.created",r=>{let{item:s}=t(r);this.dispatch("conversation.item.appended",{item:s}),s.status==="completed"&&this.dispatch("conversation.item.completed",{item:s})}),this.realtime.on("server.conversation.item.truncated",t),this.realtime.on("server.conversation.item.deleted",t),this.realtime.on("server.conversation.item.input_audio_transcription.completed",t),this.realtime.on("server.response.audio_transcript.delta",t),this.realtime.on("server.response.audio.delta",t),this.realtime.on("server.response.text.delta",t),this.realtime.on("server.response.function_call_arguments.delta",t),this.realtime.on("server.response.output_item.done",async r=>{let{item:s}=t(r);s.status==="completed"&&this.dispatch("conversation.item.completed",{item:s}),s.formatted.tool&&i(s.formatted.tool)}),!0}isConnected(){return this.realtime.isConnected()}reset(){return this.disconnect(),this.clearEventHandlers(),this.realtime.clearEventHandlers(),this._resetConfig(),this._addAPIEventHandlers(),!0}async connect(){if(this.isConnected())throw new Error("Already connected, use .disconnect() first");return await this.realtime.connect(),this.updateSession(),!0}async waitForSessionCreated(){if(!this.isConnected())throw new Error("Not connected, use .connect() first");for(;!this.sessionCreated;)await new Promise(e=>setTimeout(()=>e(),1));return!0}disconnect(){this.sessionCreated=!1,this.realtime.isConnected()&&this.realtime.disconnect(),this.conversation.clear()}getTurnDetectionType(){var e;return((e=this.sessionConfig.turn_detection)==null?void 0:e.type)||null}addTool(e,t){if(!(e!=null&&e.name))throw new Error("Missing tool name in definition");let i=e==null?void 0:e.name;if(this.tools[i])throw new Error(`Tool "${i}" already added. Please use .removeTool("${i}") before trying to add again.`);if(typeof t!="function")throw new Error(`Tool "${i}" handler must be a function`);return this.tools[i]={definition:e,handler:t},this.updateSession(),this.tools[i]}removeTool(e){if(!this.tools[e])throw new Error(`Tool "${e}" does not exist, can not be removed.`);return delete this.tools[e],!0}deleteItem(e){return this.realtime.send("conversation.item.delete",{item_id:e}),!0}updateSession({modalities:e=void 0,instructions:t=void 0,voice:i=void 0,input_audio_format:r=void 0,output_audio_format:s=void 0,input_audio_transcription:a=void 0,turn_detection:n=void 0,tools:o=void 0,tool_choice:l=void 0,temperature:h=void 0,max_response_output_tokens:c=void 0}={}){e!==void 0&&(this.sessionConfig.modalities=e),t!==void 0&&(this.sessionConfig.instructions=t),i!==void 0&&(this.sessionConfig.voice=i),r!==void 0&&(this.sessionConfig.input_audio_format=r),s!==void 0&&(this.sessionConfig.output_audio_format=s),a!==void 0&&(this.sessionConfig.input_audio_transcription=a),n!==void 0&&(this.sessionConfig.turn_detection=n),o!==void 0&&(this.sessionConfig.tools=o),l!==void 0&&(this.sessionConfig.tool_choice=l),h!==void 0&&(this.sessionConfig.temperature=h),c!==void 0&&(this.sessionConfig.max_response_output_tokens=c);let d=[].concat((o||[]).map(p=>{let f={type:"function",...p};if(this.tools[f==null?void 0:f.name])throw new Error(`Tool "${f==null?void 0:f.name}" has already been defined`);return f}),Object.keys(this.tools).map(p=>({type:"function",...this.tools[p].definition}))),u={...this.sessionConfig};return u.tools=d,this.realtime.isConnected()&&this.realtime.send("session.update",{session:u}),!0}sendUserMessageContent(e=[]){if(e.length){for(let t of e)t.type==="input_audio"&&(t.audio instanceof ArrayBuffer||t.audio instanceof Int16Array)&&(t.audio=Zo.arrayBufferToBase64(t.audio));this.realtime.send("conversation.item.create",{item:{type:"message",role:"user",content:e}})}return this.createResponse(),!0}appendInputAudio(e){return e.byteLength>0&&(this.realtime.send("input_audio_buffer.append",{audio:Zo.arrayBufferToBase64(e)}),this.inputAudioBuffer=Zo.mergeInt16Arrays(this.inputAudioBuffer,e)),!0}createResponse(){return this.getTurnDetectionType()===null&&this.inputAudioBuffer.byteLength>0&&(this.realtime.send("input_audio_buffer.commit"),this.conversation.queueInputAudio(this.inputAudioBuffer),this.inputAudioBuffer=new Int16Array(0)),this.realtime.send("response.create"),!0}cancelResponse(e,t=0){if(e){if(e){let i=this.conversation.getItem(e);if(!i)throw new Error(`Could not find item "${e}"`);if(i.type!=="message")throw new Error('Can only cancelResponse messages with type "message"');if(i.role!=="assistant")throw new Error('Can only cancelResponse messages with role "assistant"');this.realtime.send("response.cancel");let r=i.content.findIndex(s=>s.type==="audio");if(r===-1)throw new Error("Could not find audio on item to cancel");return this.realtime.send("conversation.item.truncate",{item_id:e,content_index:r,audio_end_ms:Math.floor(t/this.conversation.defaultFrequency*1e3)}),{item:i}}}else return this.realtime.send("response.cancel"),{item:null}}async waitForNextItem(){let e=await this.waitForNext("conversation.item.appended"),{item:t}=e;return{item:t}}async waitForNextCompletedItem(){let e=await this.waitForNext("conversation.item.completed"),{item:t}=e;return{item:t}}},vH=`
class AudioProcessor extends AudioWorkletProcessor {

  constructor() {
    super();
    this.port.onmessage = this.receive.bind(this);
    this.initialize();
  }

  initialize() {
    this.foundAudio = false;
    this.recording = false;
    this.chunks = [];
  }

  /**
   * Concatenates sampled chunks into channels
   * Format is chunk[Left[], Right[]]
   */
  readChannelData(chunks, channel = -1, maxChannels = 9) {
    let channelLimit;
    if (channel !== -1) {
      if (chunks[0] && chunks[0].length - 1 < channel) {
        throw new Error(
          \`Channel \${channel} out of range: max \${chunks[0].length}\`
        );
      }
      channelLimit = channel + 1;
    } else {
      channel = 0;
      channelLimit = Math.min(chunks[0] ? chunks[0].length : 1, maxChannels);
    }
    const channels = [];
    for (let n = channel; n < channelLimit; n++) {
      const length = chunks.reduce((sum, chunk) => {
        return sum + chunk[n].length;
      }, 0);
      const buffers = chunks.map((chunk) => chunk[n]);
      const result = new Float32Array(length);
      let offset = 0;
      for (let i = 0; i < buffers.length; i++) {
        result.set(buffers[i], offset);
        offset += buffers[i].length;
      }
      channels[n] = result;
    }
    return channels;
  }

  /**
   * Combines parallel audio data into correct format,
   * channels[Left[], Right[]] to float32Array[LRLRLRLR...]
   */
  formatAudioData(channels) {
    if (channels.length === 1) {
      // Simple case is only one channel
      const float32Array = channels[0].slice();
      const meanValues = channels[0].slice();
      return { float32Array, meanValues };
    } else {
      const float32Array = new Float32Array(
        channels[0].length * channels.length
      );
      const meanValues = new Float32Array(channels[0].length);
      for (let i = 0; i < channels[0].length; i++) {
        const offset = i * channels.length;
        let meanValue = 0;
        for (let n = 0; n < channels.length; n++) {
          float32Array[offset + n] = channels[n][i];
          meanValue += channels[n][i];
        }
        meanValues[i] = meanValue / channels.length;
      }
      return { float32Array, meanValues };
    }
  }

  /**
   * Converts 32-bit float data to 16-bit integers
   */
  floatTo16BitPCM(float32Array) {
    const buffer = new ArrayBuffer(float32Array.length * 2);
    const view = new DataView(buffer);
    let offset = 0;
    for (let i = 0; i < float32Array.length; i++, offset += 2) {
      let s = Math.max(-1, Math.min(1, float32Array[i]));
      view.setInt16(offset, s < 0 ? s * 0x8000 : s * 0x7fff, true);
    }
    return buffer;
  }

  /**
   * Retrieves the most recent amplitude values from the audio stream
   * @param {number} channel
   */
  getValues(channel = -1) {
    const channels = this.readChannelData(this.chunks, channel);
    const { meanValues } = this.formatAudioData(channels);
    return { meanValues, channels };
  }

  /**
   * Exports chunks as an audio/wav file
   */
  export() {
    const channels = this.readChannelData(this.chunks);
    const { float32Array, meanValues } = this.formatAudioData(channels);
    const audioData = this.floatTo16BitPCM(float32Array);
    return {
      meanValues: meanValues,
      audio: {
        bitsPerSample: 16,
        channels: channels,
        data: audioData,
      },
    };
  }

  receive(e) {
    const { event, id } = e.data;
    let receiptData = {};
    switch (event) {
      case 'start':
        this.recording = true;
        break;
      case 'stop':
        this.recording = false;
        break;
      case 'clear':
        this.initialize();
        break;
      case 'export':
        receiptData = this.export();
        break;
      case 'read':
        receiptData = this.getValues();
        break;
      default:
        break;
    }
    // Always send back receipt
    this.port.postMessage({ event: 'receipt', id, data: receiptData });
  }

  sendChunk(chunk) {
    const channels = this.readChannelData([chunk]);
    const { float32Array, meanValues } = this.formatAudioData(channels);
    const rawAudioData = this.floatTo16BitPCM(float32Array);
    const monoAudioData = this.floatTo16BitPCM(meanValues);
    this.port.postMessage({
      event: 'chunk',
      data: {
        mono: monoAudioData,
        raw: rawAudioData,
      },
    });
  }

  process(inputList, outputList, parameters) {
    // Copy input to output (e.g. speakers)
    // Note that this creates choppy sounds with Mac products
    const sourceLimit = Math.min(inputList.length, outputList.length);
    for (let inputNum = 0; inputNum < sourceLimit; inputNum++) {
      const input = inputList[inputNum];
      const output = outputList[inputNum];
      const channelCount = Math.min(input.length, output.length);
      for (let channelNum = 0; channelNum < channelCount; channelNum++) {
        input[channelNum].forEach((sample, i) => {
          output[channelNum][i] = sample;
        });
      }
    }
    const inputs = inputList[0];
    // There's latency at the beginning of a stream before recording starts
    // Make sure we actually receive audio data before we start storing chunks
    let sliceIndex = 0;
    if (!this.foundAudio) {
      for (const channel of inputs) {
        sliceIndex = 0; // reset for each channel
        if (this.foundAudio) {
          break;
        }
        if (channel) {
          for (const value of channel) {
            if (value !== 0) {
              // find only one non-zero entry in any channel
              this.foundAudio = true;
              break;
            } else {
              sliceIndex++;
            }
          }
        }
      }
    }
    if (inputs && inputs[0] && this.foundAudio && this.recording) {
      // We need to copy the TypedArray, because the \`process\`
      // internals will reuse the same buffer to hold each input
      const chunk = inputs.map((input) => input.slice(sliceIndex));
      this.chunks.push(chunk);
      this.sendChunk(chunk);
    }
    return true;
  }
}

registerProcessor('audio_processor', AudioProcessor);
`,yH=new Blob([vH],{type:"application/javascript"}),xH=URL.createObjectURL(yH),bH=xH,i8=[4186.01,4434.92,4698.63,4978.03,5274.04,5587.65,5919.91,6271.93,6644.88,7040,7458.62,7902.13],wH=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],ja=[],s5=[];for(let e=1;e<=8;e++)for(let t=0;t<i8.length;t++){let i=i8[t];ja.push(i/Math.pow(2,8-e)),s5.push(wH[t]+e)}var td=[32,2e3],r8=ja.filter((e,t)=>ja[t]>td[0]&&ja[t]<td[1]),SH=s5.filter((e,t)=>ja[t]>td[0]&&ja[t]<td[1]),a5=class{static getFrequencies(e,t,i,r="frequency",s=-100,a=-30){i||(i=new Float32Array(e.frequencyBinCount),e.getFloatFrequencyData(i));let n=t/2,o=1/i.length*n,l,h,c;if(r==="music"||r==="voice"){let u=r==="voice"?r8:ja,p=Array(u.length).fill(s);for(let f=0;f<i.length;f++){let g=f*o,m=i[f];for(let v=u.length-1;v>=0;v--)if(g>u[v]){p[v]=Math.max(p[v],m);break}}l=p,h=r==="voice"?r8:ja,c=r==="voice"?SH:s5}else l=Array.from(i),h=l.map((u,p)=>o*p),c=h.map(u=>`${u.toFixed(2)} Hz`);let d=l.map(u=>Math.max(0,Math.min((u-s)/(a-s),1)));return{values:new Float32Array(d),frequencies:h,labels:c}}constructor(e,t=null){if(this.fftResults=[],t){let{length:i,sampleRate:r}=t,s=new OfflineAudioContext({length:i,sampleRate:r}),a=s.createBufferSource();a.buffer=t;let n=s.createAnalyser();n.fftSize=8192,n.smoothingTimeConstant=.1,a.connect(n);let o=1/60,l=i/r,h=c=>{let d=o*c;d<l&&s.suspend(d).then(()=>{let u=new Float32Array(n.frequencyBinCount);n.getFloatFrequencyData(u),this.fftResults.push(u),h(c+1)}),c===1?s.startRendering():s.resume()};a.start(0),h(1),this.audio=e,this.context=s,this.analyser=n,this.sampleRate=r,this.audioBuffer=t}else{let i=new AudioContext,r=i.createMediaElementSource(e),s=i.createAnalyser();s.fftSize=8192,s.smoothingTimeConstant=.1,r.connect(s),s.connect(i.destination),this.audio=e,this.context=i,this.analyser=s,this.sampleRate=this.context.sampleRate,this.audioBuffer=null}}getFrequencies(e="frequency",t=-100,i=-30){let r=null;if(this.audioBuffer&&this.fftResults.length){let s=this.audio.currentTime/this.audio.duration,a=Math.min(s*this.fftResults.length|0,this.fftResults.length-1);r=this.fftResults[a]}return a5.getFrequencies(this.analyser,this.sampleRate,r,e,t,i)}async resumeIfSuspended(){return this.context.state==="suspended"&&await this.context.resume(),!0}},yo=class{static floatTo16BitPCM(e){let t=new ArrayBuffer(e.length*2),i=new DataView(t),r=0;for(let s=0;s<e.length;s++,r+=2){let a=Math.max(-1,Math.min(1,e[s]));i.setInt16(r,a<0?a*32768:a*32767,!0)}return t}static mergeBuffers(e,t){let i=new Uint8Array(e.byteLength+t.byteLength);return i.set(new Uint8Array(e),0),i.set(new Uint8Array(t),e.byteLength),i.buffer}_packData(e,t){return[new Uint8Array([t,t>>8]),new Uint8Array([t,t>>8,t>>16,t>>24])][e]}pack(e,t){if(t!=null&&t.bitsPerSample)if(t!=null&&t.channels){if(!(t!=null&&t.data))throw new Error('Missing "data"')}else throw new Error('Missing "channels"');else throw new Error('Missing "bitsPerSample"');let{bitsPerSample:i,channels:r,data:s}=t,a=["RIFF",this._packData(1,52),"WAVE","fmt ",this._packData(1,16),this._packData(0,1),this._packData(0,r.length),this._packData(1,e),this._packData(1,e*r.length*i/8),this._packData(0,r.length*i/8),this._packData(0,i),"data",this._packData(1,r[0].length*r.length*i/8),s],n=new Blob(a,{type:"audio/mpeg"}),o=URL.createObjectURL(n);return{blob:n,url:o,channelCount:r.length,sampleRate:e,duration:s.byteLength/(r.length*e*2)}}},s8=class{constructor({sampleRate:e=44100,outputToSpeakers:t=!1,debug:i=!1}={}){this.scriptSrc=bH,this.sampleRate=e,this.outputToSpeakers=t,this.debug=!!i,this._deviceChangeCallback=null,this._devices=[],this.stream=null,this.processor=null,this.source=null,this.node=null,this.recording=!1,this._lastEventId=0,this.eventReceipts={},this.eventTimeout=5e3,this._chunkProcessor=()=>{},this._chunkProcessorSize=void 0,this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)}}static async decode(e,t=44100,i=-1){let r=new AudioContext({sampleRate:t}),s,a;if(e instanceof Blob){if(i!==-1)throw new Error('Can not specify "fromSampleRate" when reading from Blob');a=e,s=await a.arrayBuffer()}else if(e instanceof ArrayBuffer){if(i!==-1)throw new Error('Can not specify "fromSampleRate" when reading from ArrayBuffer');s=e,a=new Blob([s],{type:"audio/wav"})}else{let h,c;if(e instanceof Int16Array){c=e,h=new Float32Array(e.length);for(let u=0;u<e.length;u++)h[u]=e[u]/32768}else if(e instanceof Float32Array)h=e;else if(e instanceof Array)h=new Float32Array(e);else throw new Error('"audioData" must be one of: Blob, Float32Arrray, Int16Array, ArrayBuffer, Array<number>');if(i===-1)throw new Error('Must specify "fromSampleRate" when reading from Float32Array, In16Array or Array');if(i<3e3)throw new Error('Minimum "fromSampleRate" is 3000 (3kHz)');c||(c=yo.floatTo16BitPCM(h));let d={bitsPerSample:16,channels:[h],data:c};a=new yo().pack(i,d).blob,s=await a.arrayBuffer()}let n=await r.decodeAudioData(s),o=n.getChannelData(0),l=URL.createObjectURL(a);return{blob:a,url:l,values:o,audioBuffer:n}}log(){return this.debug&&this.log(...arguments),!0}getSampleRate(){return this.sampleRate}getStatus(){return this.processor?this.recording?"recording":"paused":"ended"}async _event(e,t={},i=null){if(i=i||this.processor,!i)throw new Error("Can not send events without recording first");let r={event:e,id:this._lastEventId++,data:t};i.port.postMessage(r);let s=new Date().valueOf();for(;!this.eventReceipts[r.id];){if(new Date().valueOf()-s>this.eventTimeout)throw new Error(`Timeout waiting for "${e}" event`);await new Promise(n=>setTimeout(()=>n(!0),1))}let a=this.eventReceipts[r.id];return delete this.eventReceipts[r.id],a}listenForDeviceChange(e){if(e===null&&this._deviceChangeCallback)navigator.mediaDevices.removeEventListener("devicechange",this._deviceChangeCallback),this._deviceChangeCallback=null;else if(e!==null){let t=0,i=[],r=a=>a.map(n=>n.deviceId).sort().join(","),s=async()=>{let a=++t,n=await this.listDevices();a===t&&r(i)!==r(n)&&(i=n,e(n.slice()))};navigator.mediaDevices.addEventListener("devicechange",s),s(),this._deviceChangeCallback=s}return!0}async requestPermission(){let e=await navigator.permissions.query({name:"microphone"});if(e.state==="denied")window.alert("You must grant microphone access to use this feature.");else if(e.state==="prompt")try{(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(t=>t.stop())}catch{window.alert("You must grant microphone access to use this feature.")}return!0}async listDevices(){if(!navigator.mediaDevices||!("enumerateDevices"in navigator.mediaDevices))throw new Error("Could not request user devices");await this.requestPermission();let e=(await navigator.mediaDevices.enumerateDevices()).filter(r=>r.kind==="audioinput"),t=e.findIndex(r=>r.deviceId==="default"),i=[];if(t!==-1){let r=e.splice(t,1)[0],s=e.findIndex(a=>a.groupId===r.groupId);s!==-1&&(r=e.splice(s,1)[0]),r.default=!0,i.push(r)}return i.concat(e)}async begin(e){if(this.processor)throw new Error("Already connected: please call .end() to start a new session");if(!navigator.mediaDevices||!("getUserMedia"in navigator.mediaDevices))throw new Error("Could not request user media");try{let n={audio:!0};e&&(n.audio={deviceId:{exact:e}}),this.stream=await navigator.mediaDevices.getUserMedia(n)}catch{throw new Error("Could not start media stream")}let t=new AudioContext({sampleRate:this.sampleRate}),i=t.createMediaStreamSource(this.stream);try{await t.audioWorklet.addModule(this.scriptSrc)}catch(n){throw new Error(`Could not add audioWorklet module: ${this.scriptSrc}`)}let r=new AudioWorkletNode(t,"audio_processor");r.port.onmessage=n=>{let{event:o,id:l,data:h}=n.data;if(o==="receipt")this.eventReceipts[l]=h;else if(o==="chunk")if(this._chunkProcessorSize){let c=this._chunkProcessorBuffer;this._chunkProcessorBuffer={raw:yo.mergeBuffers(c.raw,h.raw),mono:yo.mergeBuffers(c.mono,h.mono)},this._chunkProcessorBuffer.mono.byteLength>=this._chunkProcessorSize&&(this._chunkProcessor(this._chunkProcessorBuffer),this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)})}else this._chunkProcessor(h)};let s=i.connect(r),a=t.createAnalyser();return a.fftSize=8192,a.smoothingTimeConstant=.1,s.connect(a),this.outputToSpeakers&&a.connect(t.destination),this.source=i,this.node=s,this.analyser=a,this.processor=r,!0}getFrequencies(e="frequency",t=-100,i=-30){if(!this.processor)throw new Error("Session ended: please call .begin() first");return a5.getFrequencies(this.analyser,this.sampleRate,null,e,t,i)}async pause(){if(this.processor){if(!this.recording)throw new Error("Already paused: please call .record() first")}else throw new Error("Session ended: please call .begin() first");return this._chunkProcessorBuffer.raw.byteLength&&this._chunkProcessor(this._chunkProcessorBuffer),this.log("Pausing ..."),await this._event("stop"),this.recording=!1,!0}async record(e=()=>{},t=8192){if(this.processor){if(this.recording)throw new Error("Already recording: please call .pause() first");if(typeof e!="function")throw new Error("chunkProcessor must be a function")}else throw new Error("Session ended: please call .begin() first");return this._chunkProcessor=e,this._chunkProcessorSize=t,this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)},this.log("Recording ..."),await this._event("start"),this.recording=!0,!0}async clear(){if(!this.processor)throw new Error("Session ended: please call .begin() first");return await this._event("clear"),!0}async read(){if(!this.processor)throw new Error("Session ended: please call .begin() first");return this.log("Reading ..."),await this._event("read")}async save(e=!1){if(!this.processor)throw new Error("Session ended: please call .begin() first");if(!e&&this.recording)throw new Error("Currently recording: please call .pause() first, or call .save(true) to force");this.log("Exporting ...");let t=await this._event("export");return new yo().pack(this.sampleRate,t.audio)}async end(){if(!this.processor)throw new Error("Session ended: please call .begin() first");let e=this.processor;this.log("Stopping ..."),await this._event("stop"),this.recording=!1,this.stream.getTracks().forEach(i=>i.stop()),this.log("Exporting ...");let t=await this._event("export",{},e);return this.processor.disconnect(),this.source.disconnect(),this.node.disconnect(),this.analyser.disconnect(),this.stream=null,this.processor=null,this.source=null,this.node=null,new yo().pack(this.sampleRate,t.audio)}async quit(){return this.listenForDeviceChange(null),this.processor&&await this.end(),!0}},_H=`
class StreamProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.hasStarted = false;
    this.hasInterrupted = false;
    this.outputBuffers = [];
    this.bufferLength = 128;
    this.write = { buffer: new Float32Array(this.bufferLength), trackId: null };
    this.writeOffset = 0;
    this.trackSampleOffsets = {};
    this.port.onmessage = (event) => {
      if (event.data) {
        const payload = event.data;
        if (payload.event === 'write') {
          const int16Array = payload.buffer;
          const float32Array = new Float32Array(int16Array.length);
          for (let i = 0; i < int16Array.length; i++) {
            float32Array[i] = int16Array[i] / 0x8000; // Convert Int16 to Float32
          }
          this.writeData(float32Array, payload.trackId);
        } else if (
          payload.event === 'offset' ||
          payload.event === 'interrupt'
        ) {
          const requestId = payload.requestId;
          const trackId = this.write.trackId;
          const offset = this.trackSampleOffsets[trackId] || 0;
          this.port.postMessage({
            event: 'offset',
            requestId,
            trackId,
            offset,
          });
          if (payload.event === 'interrupt') {
            this.hasInterrupted = true;
          }
        } else {
          throw new Error(\`Unhandled event "\${payload.event}"\`);
        }
      }
    };
  }

  writeData(float32Array, trackId = null) {
    let { buffer } = this.write;
    let offset = this.writeOffset;
    for (let i = 0; i < float32Array.length; i++) {
      buffer[offset++] = float32Array[i];
      if (offset >= buffer.length) {
        this.outputBuffers.push(this.write);
        this.write = { buffer: new Float32Array(this.bufferLength), trackId };
        buffer = this.write.buffer;
        offset = 0;
      }
    }
    this.writeOffset = offset;
    return true;
  }

  process(inputs, outputs, parameters) {
    const output = outputs[0];
    const outputChannelData = output[0];
    const outputBuffers = this.outputBuffers;
    if (this.hasInterrupted) {
      this.port.postMessage({ event: 'stop' });
      return false;
    } else if (outputBuffers.length) {
      this.hasStarted = true;
      const { buffer, trackId } = outputBuffers.shift();
      for (let i = 0; i < outputChannelData.length; i++) {
        outputChannelData[i] = buffer[i] || 0;
      }
      if (trackId) {
        this.trackSampleOffsets[trackId] =
          this.trackSampleOffsets[trackId] || 0;
        this.trackSampleOffsets[trackId] += buffer.length;
      }
      return true;
    } else if (this.hasStarted) {
      this.port.postMessage({ event: 'stop' });
      return false;
    } else {
      return true;
    }
  }
}

registerProcessor('stream_processor', StreamProcessor);
`,AH=new Blob([_H],{type:"application/javascript"}),MH=URL.createObjectURL(AH),EH=MH,CH=class{constructor({sampleRate:e=44100}={}){this.scriptSrc=EH,this.sampleRate=e,this.context=null,this.stream=null,this.analyser=null,this.trackSampleOffsets={},this.interruptedTrackIds={}}async connect(){this.context=new AudioContext({sampleRate:this.sampleRate}),this.context.state==="suspended"&&await this.context.resume();try{await this.context.audioWorklet.addModule(this.scriptSrc)}catch(t){throw new Error(`Could not add audioWorklet module: ${this.scriptSrc}`)}let e=this.context.createAnalyser();return e.fftSize=8192,e.smoothingTimeConstant=.1,this.analyser=e,!0}getFrequencies(e="frequency",t=-100,i=-30){if(!this.analyser)throw new Error("Not connected, please call .connect() first");return a5.getFrequencies(this.analyser,this.sampleRate,null,e,t,i)}_start(){let e=new AudioWorkletNode(this.context,"stream_processor");return e.connect(this.context.destination),e.port.onmessage=t=>{let{event:i}=t.data;if(i==="stop")e.disconnect(),this.stream=null;else if(i==="offset"){let{requestId:r,trackId:s,offset:a}=t.data,n=a/this.sampleRate;this.trackSampleOffsets[r]={trackId:s,offset:a,currentTime:n}}},this.analyser.disconnect(),e.connect(this.analyser),this.stream=e,!0}add16BitPCM(e,t="default"){if(typeof t!="string")throw new Error("trackId must be a string");if(this.interruptedTrackIds[t])return;this.stream||this._start();let i;if(e instanceof Int16Array)i=e;else if(e instanceof ArrayBuffer)i=new Int16Array(e);else throw new Error("argument must be Int16Array or ArrayBuffer");return this.stream.port.postMessage({event:"write",buffer:i,trackId:t}),i}async getTrackSampleOffset(e=!1){if(!this.stream)return null;let t=crypto.randomUUID();this.stream.port.postMessage({event:e?"interrupt":"offset",requestId:t});let i;for(;!i;)i=this.trackSampleOffsets[t],await new Promise(s=>setTimeout(()=>s(),1));let{trackId:r}=i;return e&&r&&(this.interruptedTrackIds[r]=!0),i}async interrupt(){return this.getTrackSampleOffset(!0)}},a8=()=>"https://relayserver.spline.design/",n8=class{constructor(e,t,i){this.data=e,this.id=t,this.shared=i,this.items=[],this.isConnected=!1,this.rafId=0,this.emitter=Id(),this.voice=0,this.frequencies=new Float32Array([0]),this.onRealTimeEvent=({time:r,source:s,event:a})=>{s==="server"&&a.type==="spline.ready"?this.onSessionCreated(a):s==="server"&&a.type==="session.created"&&(this.client.createResponse(),this.client.on("realtime.event",this.onRealTimeEvent))},this.onSessionCreated=async r=>{let s=Object.values(this.client.tools).map(a=>({type:"function",...a.definition}));this.client.realtime.send("spline.tools",{tools:s}),this.client.realtime.send("spline.connect",{}),await this.wavRecorder.record(a=>this.client.isConnected()&&this.client.appendInputAudio(a.mono))},this.animate=()=>{if(this.rafId=requestAnimationFrame(this.animate),this.isConnected){let r=this.wavStreamPlayer.analyser?this.wavStreamPlayer.getFrequencies("voice"):{values:new Float32Array([0])},s=r.values.reduce((a,n)=>a+n,0)/r.values.length;this.voice=s,this.frequencies=r.values,this.emitter.emit("voice",{value:s,frequencies:r.values})}},this.client=new t8({url:a8()+"?uuidfile="+e.integration.hash}),this.wavRecorder=new s8({sampleRate:24e3}),this.wavStreamPlayer=new CH({sampleRate:24e3})}update(e){this.data=e,this.client=new t8({url:a8()+"?uuidfile="+e.integration.hash})}setColorByName(e,t){let i=this.shared.getColorByName(e);if(i){let{id:r}=i,{r:s,g:a,b:n}=GV.hexStringToRgb(t)??{r:0,g:0,b:0};this.shared.updateColor(r,{r:s/255,g:a/255,b:n/255})}}connect(){if(this.isConnected)return;this.isConnected=!0,this.client.updateSession({turn_detection:{type:"server_vad"}}),this.client.addTool({name:"set_personality_color",description:"returns a color based on the voice personality of the ai assistant. This should be called by the voice assistant each time it is asks to speak differently. If a color cannot be associated to the personality, the color should be a neutral color.",parameters:{type:"object",properties:{color:{type:"string",description:"css hex color string, reflecting the personality"},personality:{type:"string",description:"the personality of the voice assistant"}},required:["color","personality"]}},({color:s})=>{this.setColorByName("Voice Assistant Color",s)});let e=this.shared.getVariablesNames().join(", ");this.client.addTool({name:"set_variable",description:"Sets a Spline variable value when asked by the user.",parameters:{type:"object",properties:{name:{type:"string",description:`The name of the variable that needs to be set. Here's a list of available variables: ${e}. It the variable does not exist, don't call the function and warn the user about it.`},value:{type:"string",description:"The new value for this variable, should always be a string even for number and boolean variables, assume that the value will be cast to the proper type afterwards."}},required:["name","value","type"]}},({name:s,value:a})=>{let n=this.shared.getVariableByName(s);if(n){let o=this.shared.getVariable(n.id),l;typeof o=="number"?l=parseFloat(a):typeof o=="boolean"?l=a.toLowerCase()==="true":l={textValue:a},this.shared.updateVariable(n.id,l)}});let t=this.shared.getColorNames().join(", ");this.client.addTool({name:"set_color",description:"Sets a Spline color asset value when asked by the user.",parameters:{type:"object",properties:{name:{type:"string",description:`The name of the color asset that needs to be set. Here's a list of available color assets: ${t}. It the color asset does not exist, don't call the function and warn the user about it.`},value:{type:"string",description:"css hex color string"}},required:["name","value"]}},({name:s,value:a})=>{this.setColorByName(s,a)});let i=this.shared.scene,r=[];i.traverseEntity(s=>{s.data.events.forEach(a=>{if(a.data.type==="AIAssistantTrigger"){let{description:n}=a.data;r.push(n)}})}),this.client.addTool({name:"trigger_event",description:"Trigger an event by name, here are the available events, please match what the user is asking for to one of these if it applies, otherwise don't call the function and warn the user.",parameters:{type:"object",properties:{description:{type:"string",description:`The name of the event that needs to be triggered. Here's a list of available events: ${JSON.stringify(r)}.`},direction:{type:"string",description:"default is forward, but can be forward or backward. Always set to forward unless the user ask to reverse or cancel the event, then set to backward."}},required:["description","direction"]}},({description:s,direction:a})=>{this.emitter.emit("trigger_event",{description:s,direction:a})}),this.client.on("error",s=>console.error(s)),this.client.on("conversation.interrupted",async()=>{let s=await this.wavStreamPlayer.interrupt();if(s!=null&&s.trackId){let{trackId:a,offset:n}=s;await this.client.cancelResponse(a,n)}}),this.client.on("conversation.updated",async({item:s,delta:a})=>{var o;let n=this.client.conversation.getItems();if(a!=null&&a.audio&&this.wavStreamPlayer.add16BitPCM(a.audio,s.id),s.status==="completed"&&((o=s.formatted.audio)==null?void 0:o.length)){let l=await s8.decode(s.formatted.audio,24e3,24e3);s.formatted.file=l}this.items=n}),this.animate()}disconnect(){cancelAnimationFrame(this.rafId),this.voice=0,this.isConnected=!1}async start(){try{await this.wavRecorder.end()}catch{}await this.wavRecorder.begin(),this.client.on("realtime.event",this.onRealTimeEvent),await this.wavStreamPlayer.connect(),await this.client.connect()}async stop(){try{this.client.off("realtime.event",this.onRealTimeEvent)}catch(e){}this.client.disconnect(),await this.wavRecorder.end(),await this.wavStreamPlayer.interrupt()}computeAnalysisForListenerEvent(e){if(e.analysis==="range"){let t=this.frequencies.slice(...e.analysisRange);return t.reduce((i,r)=>i+r,0)/t.length}return e.analysis==="single"?this.frequencies[e.analysisSingle]:this.voice}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}};function Af(e){return"variable_"+e}var TH=class extends sG{constructor(e){super(),this.shared=e}create(e){return new wb(e,this.shared)}},n5=class{constructor(e,t={},i=!0,r=!1){if(this.data=e,this.needsJitter=i,this.enableLocalStorageForPersistentVariables=r,this.geometryCache=new $g(!0),this.geometryCache2=new $g(!1),this.imageHolderCache=new TH(this),this.thisContext={scene:oH,shared:this},this.deletedMaterial=new _f(a1.defaultTwoLayerData("phong"),this.thisContext,""),this.deletedImage=new Ta(J3.emptyImage,this),this.deletedVideo=new Ta(Fc.defaultVideo,this),this.materials={},this.images={},this.uiBuffers={},this.videos={},this.colors={},this.audios={},this.particles={},this.fonts={},this.variables={},this.userAPIs={},this.userWebhooks={},this.mouseProperty=null,this.raycastProperty=null,this.requestRender=()=>{this._requestRender&&this._requestRender()},t.images)for(let[s,a]of Object.entries(t.images))this.addImage(s,a);if(t.videos)for(let[s,a]of Object.entries(t.videos))this.addVideo(s,a);if(t.audios)for(let[s,a]of Object.entries(t.audios))this.addAudio(s,a);if(t.particles)for(let[s,a]of Object.entries(t.particles))this.addParticle(s,a);this.reset(e)}setRequestRender(e){this._requestRender=e}getImageLoadPromises(){return Object.values(this.images).map(e=>e.loadPromise)}setEntityOpContext(e){this.entityOpContext=e}reset(e,t=!1){this.data=e,this.resetLib(e.lib);for(let{id:i,data:r}of e.variables)this.addVariableHolder(i,r),t&&this.updateVariableHolder(i,r);for(let[i,r]of Object.entries(e.userAPIs))this.addUserAPI(i,r);for(let[i,r]of Object.entries(e.userWebhooks))this.addUserWebhook(i,r);for(let[i,r]of Object.entries(e.images))this.addImage(i,r);for(let[i,r]of Object.entries(e.videos))this.addVideo(i,r);for(let[i,r]of Object.entries(e.colors))this.addColor(i,r);for(let[i,r]of Object.entries(e.materials))this.addMaterial(i,r);for(let[i,r]of Object.entries(e.audios))this.addAudio(i,r);for(let[i,r]of Object.entries(e.particles))this.addParticle(i,r);for(let[i,r]of Object.entries(e.fonts))this.addFont(i,r)}addMaterial(e,t){if(this.materials[e]){let i=this.materials[e];i.reset(t,this.thisContext),i.dispose()}else{let i=new _f(t,this.thisContext,e);this.materials[e]=i}}deleteMaterial(e){this.materials[e]&&(this.materials[e].nodeMaterialDispose(),delete this.materials[e])}getMaterial(e){return this.materials[e]}getMaterialOrDeletedPlaceholder(e){return this.materials[e]??this.deletedMaterial}material(e){return typeof e=="string"?this.getMaterialOrDeletedPlaceholder(e):e==null?this.deletedMaterial:new r5(e,this.thisContext)}getMaterials(){return this.materials}addImage(e,t){return this.images[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[e].updateSrc(t.data),!0):(this.images[e]=new Ta(t,this),!1)}deleteImage(e){let t=this.images[e];t&&(t.dispose(),delete this.images[e])}getDefaultImage(){return this.images.image_0}getImage(e){return this.images[e]??this.deletedImage}image(e){return typeof e=="string"?this.getImage(e):this.imageHolderCache.load(e)}addUIBuffer(e,t){return this.uiBuffers[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.uiBuffers[e].updateSrc(t),!0):(this.uiBuffers[e]=new Ta(t,this),!1)}uiBuffer(e){return this.uiBuffers[e]}addVideo(e,t){return this.videos[e]?(this.videos[e].updateSrc(t.data),!0):(this.videos[e]=new Ta(t,this),!1)}deleteVideo(e){let t=this.videos[e];t&&(t.dispose(),delete this.videos[e])}getVideo(e){return this.videos[e]??this.deletedVideo}video(e){return typeof e=="string"?this.getVideo(e):this.imageHolderCache.load(e)}addColor(e,t){return this.colors[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in t?this.colors[e].setRGBA(t.r,t.g,t.b,t.a):this.colors[e].setRGBA(t.r,t.g,t.b,1),!0):("a"in t?this.colors[e]=new ed(t.r,t.g,t.b,t.a):this.colors[e]=new ed(t.r,t.g,t.b,1),!1)}updateColor(e,t){if(this.colors[e]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let i=this.colors[e];return this.colors[e].r=t.r??i.r,this.colors[e].g=t.g??i.g,this.colors[e].b=t.b??i.b,this.colors[e].a=t.a??i.a,!0}return!1}deleteColor(e){this.colors[e]&&delete this.colors[e]}getColor(e){return this.colors[e]}getColorNames(){return Object.values(this.data.colors).map(e=>e.name)}getColorByName(e){for(let t in this.data.colors)if(this.data.colors[t].name===e)return{color:this.colors[t],id:t}}color(e){let t;if(typeof e=="string"){let i=this.getColor(e);i?t=i:t=new o1(0,0,0,0)}else return"a"in e?new o1(e.r,e.g,e.b,e.a):new o1(e.r,e.g,e.b,1);return t}addAudio(e,t){this.audios[e]=t}getAudio(e){let t=this.audios[e];if(t instanceof y2)return t;{let i=new y2({src:t.data});return this.audios[e]=i,i}}addParticle(e,t){this.particles[e]=t}getParticle(e){return this.particles[e]}deleteParticle(e){this.particles[e]&&delete this.particles[e]}deleteAudio(e){let t=this.audios[e];t&&(t instanceof y2&&t.dispose(),delete this.audios[e])}addFont(e,t){this.fonts[e]=new sH(t),this.fonts[e].loadingPromise.then(()=>this.requestRender())}getFont(e){return this.fonts[e]}deleteFont(e){this.fonts[e]&&delete this.fonts[e]}dispose(){Object.keys(this.materials).forEach(e=>this.deleteMaterial(e)),this._requestRender=void 0,Object.values(this.audios).forEach(e=>{e instanceof y2&&e.dispose()}),this.audios={},this.particles={},this.geometryCache.dispose(),this.geometryCache2.dispose()}addVariableHolder(e,t){if(this.variables[e]===void 0){let i=t.value;if(this.enableLocalStorageForPersistentVariables&&t.persistent){let r=localStorage.getItem(Af(e));i=r!==null?JSON.parse(r):t.value}return this.variables[e]={value:i,locations:[],persistent:t.persistent},"dynamicVariableType"in t&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0),!0}return this.variables[e].value=t.value,!1}resetDynamicVariablePlayState(){for(let e in this.variables)this.variables[e].dynamicVariablePlayState!==void 0&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0)}updateVariableHolder(e,t){this.updateVariable(e,t.value)}updateVariable(e,t){if(this.variables[e]===void 0)return!1;this.variables[e].value=t,this.enableLocalStorageForPersistentVariables&&this.variables[e].persistent&&localStorage.setItem(Af(e),JSON.stringify(t));let i=t;for(;typeof i=="string";)i=this.variables[i].value;let r=this.entityOpContext.scene;for(let s=this.variables[e].locations.length-1;s>=0;s--){let a=this.variables[e].locations[s];if(a[0]==="material"){let n=a[1],o=i,l={scene:r,shared:this},h=a.slice(2);r.traverseMaterial(d=>{let u=d.root??d;u.uuid===n&&u.onVariableUpdate(h,o,l)});let c=this.materials[n];c&&c.onVariableUpdate(h,o,l)}else{let n=r.find(a[0]);if(n===void 0){this.variables[e].locations.splice(s,1);continue}if(a[1]!=="geometry"&&a[1]!=="particles"){for(let o=1;o<a.length-1;o++)n=n[a[o]];a[1]==="rotation"?n[a[a.length-1]]=i*Oe.DEG2RAD:n[a[a.length-1]]=i}if(n=r.find(a[0]),n.type==="ParticleEmitter"&&n.updateVariableState(i,a),Et.is(n))if(a[1]==="position"||a[1]==="rotation"||a[1]==="scale")n.onVariableUpdate();else if(a[1]==="geometry"){let o=n;n.component&&(o=n.component);let l=o.dataPatched;o.chooseGeoemtryCache(this).forceDelete(l.geometry),o.createGeometryDelayed(this.entityOpContext),o.onVariableUpdate(!0),o.invalidateDownstreamBooleanData(),o.instances.forEach(h=>{let c=h.dataPatched;h.chooseGeoemtryCache(this).forceDelete(c.geometry),h.createGeometryDelayed(this.entityOpContext),h.onVariableUpdate(!0),h.invalidateDownstreamBooleanData()})}else a[1]==="morphTargetInfluences"&&n.updateMorphInfluences(a[2],i)}}return this.requestRender(),!0}deleteVariable(e){this.variables[e]&&delete this.variables[e]}getVariable(e,t){var i,r,s;if(Array.isArray(e)){if(e[0]==="mouse")return((i=this.mouseProperty)==null?void 0:i[e[1]])??0;if(e[0]==="raycast")return((r=this.raycastProperty)==null?void 0:r[e[1]])??0;let a=this.entityOpContext.scene.find(e[0]);if(e[1]==="width"||e[1]==="height"||e[1]==="depth")return a.geometry.userData.parameters[e[1]];for(let n=1;n<e.length;n++)a=a[e[n]];return e[1]==="rotation"&&(a*=Oe.RAD2DEG),a}for(let a in this.variables){if(t===void 0)break;let n=this.variables[a],o=(s=n.locations)==null?void 0:s.findIndex(l=>Li.equal(l,t));o!==void 0&&o!==-1&&n.locations.splice(o,1)}if(typeof e=="string"){let a=e,n=e;do{if(n=a,this.variables[a]===void 0)break;let o=this.variables[a].value;t&&this.variables[n]!==void 0&&this.variables[n].locations.push(t),a=o}while(typeof a=="string");return a}else return e}getVariables(){return this.variables}getVariablesNames(){return this.data.variables.map(e=>e.data.name)}getVariableByName(e){for(let t of this.data.variables)if(t.data.name===e)return{variable:t.data,id:t.id}}getDynamicVariablePlayState(e){var t;return(t=this.variables[e])==null?void 0:t.dynamicVariablePlayState}setDynamicVariablePlayState(e,t){this.variables[e]!==void 0&&(this.variables[e].dynamicVariablePlayState=t)}getDynamicVariableToggleIsForward(e){var t;return(t=this.variables[e])==null?void 0:t.dynamicVariableToggleIsForward}setDynamicVariableToggleIsForward(e,t){this.variables[e]!==void 0&&(this.variables[e].dynamicVariableToggleIsForward=t)}resetLib(e){for(let[t,i]of Object.entries(e.images))this.addImage(t,i.asset);for(let[t,i]of Object.entries(e.audios))this.addAudio(t,i.asset);for(let[t,i]of Object.entries(e.particles))this.addParticle(t,i.asset);for(let[t,i]of Object.entries(e.colors))this.addColor(t,i.asset);for(let[t,i]of Object.entries(e.fonts))this.addFont(t,i.asset);for(let[t,i]of Object.entries(e.materials))this.addMaterial(t,i.asset);for(let[t,i]of Object.entries(e.videos))this.addVideo(t,i.asset);for(let[t,i]of Object.entries(e.variables))this.addVariableHolder(t,i.asset)}updateLibByOp(e,t){e.path[0]==="images"?e.path.length===1&&e.type===1?this.addImage(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteImage(e.id):e.path[0]==="videos"?e.path.length===1&&e.type===1?this.addVideo(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteVideo(e.id):e.path[0]==="audios"?e.path.length===1&&e.type===1?this.addAudio(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteAudio(e.id):e.path[0]==="particles"?e.path.length===1&&e.type===1?this.addParticle(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteParticle(e.id):e.path[0]==="colors"?e.path.length===1&&e.type===1?this.addColor(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteColor(e.id):e.path[0]==="materials"?e.path.length===1&&e.type===1?this.addMaterial(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteMaterial(e.id):e.path[0]==="fonts"?e.path.length===1&&e.type===1?this.addFont(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteFont(e.id):e.path[0]==="variables"?e.path.length===1&&e.type===1?this.addVariableHolder(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteVariable(e.id):e.path[0]==="components"&&t.updateByLibOp(e,this)}updateByOp(e,t,i){var r;if(this.data=t,e.path[0]==="images")e.path.length===2&&e.type===0?e.props.data&&this.getImage(e.path[1]).updateSrc(e.props.data):e.path.length===1&&e.type===1?this.addImage(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteImage(e.id);else if(e.path[0]==="videos")e.path.length===2&&e.type===0?e.props.data&&this.getVideo(e.path[1]).updateSrc(e.props.data):e.path.length===1&&e.type===1?this.addVideo(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteVideo(e.id);else if(e.path[0]==="audios")e.path.length===2&&e.type===0?e.props.data&&this.addAudio(e.path[1],t.audios[e.path[1]]):e.path.length===1&&e.type===1?this.addAudio(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteAudio(e.id);else if(e.path[0]==="particles")e.path.length===2&&e.type===0?e.props.data&&this.addParticle(e.path[1],t.particles[e.path[1]]):e.path.length===1&&e.type===1?this.addParticle(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteParticle(e.id);else if(e.path[0]==="colors")e.path.length===2&&e.type===0?this.updateColor(e.path[1],e.props):e.path.length===1&&e.type===1?this.addColor(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteColor(e.id);else if(e.path[0]==="materials")e.path.length===1&&e.type===1?this.addMaterial(e.id,e.data):e.path.length===1&&e.type===2?this.deleteMaterial(e.id):e.path.length>1&&this.getMaterial(e.path[1]).updateByOp(qi.drop(e,2),t.materials[e.path[1]],{shared:this,scene:i});else if(e.path[0]==="fonts")e.path.length===2&&e.type===0?this.updateFont(e.path[1],e,i):e.path.length===1&&e.type===1?this.addFont(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteFont(e.id);else if(e.path[0]==="variables")e.path.length===2&&e.type===0?"value"in e.props?this.updateVariable(e.path[1],e.props.value):"persistent"in e.props&&(this.variables[e.path[1]].persistent=e.props.persistent):e.path.length===1&&e.type===4?this.addVariableHolder(e.id,e.data):e.path.length===1&&e.type===5&&this.deleteVariable(e.id);else if(e.path[0]==="userAPIs"){if(e.path.length===1&&e.type===1)this.addUserAPI(e.id,e.data);else if(e.path.length===1&&e.type===2)this.deleteUserAPI(e.id);else if(typeof e.path[1]=="string"){let s=t.userAPIs[e.path[1]];if(s){let a=e.type===0&&e.props.debounce===void 0,n=this.getUserAPI(e.path[1]);n instanceof n8?n.update(s):n==null||n.update(s,this,a)}}}else if(e.path[0]==="userWebhooks"){if(e.path.length===1&&e.type===1)this.addUserWebhook(e.id,e.data);else if(e.path.length===1&&e.type===2)this.deleteUserWebhook(e.id);else if(typeof e.path[1]=="string"){let s=t.userWebhooks[e.path[1]];s&&((r=this.getUserWebhook(e.path[1]))==null||r.update(s))}}else e.path[0]==="lib"&&this.updateLibByOp(qi.drop(e,1),i)}updateFont(e,t,i){if(t.props.url){let r=this.getFont(e),s={...this.data.fonts[e],url:t.props.url};r.update(s),r.loadingPromise.then(()=>this.requestRender()),i.updateFont(e,this)}}addUserAPI(e,t){var i,r;return this.userAPIs[e]?(this.userAPIs[e].update(t,this),!0):((i=this.openAIRealtime)==null?void 0:i.id)===e?(this.openAIRealtime.update(t),!0):((r=t.integration)==null?void 0:r.type)==="VoiceAssistant"?(this.openAIRealtime=new n8(t,e,this),!1):(this.userAPIs[e]=new kx(e,t,this),!1)}getUserAPI(e){var t;return((t=this.openAIRealtime)==null?void 0:t.id)===e?this.openAIRealtime:this.userAPIs[e]}getUserAPIs(){return this.userAPIs}deleteUserAPI(e){let t=this.userAPIs[e];t&&(t.dispose(),delete this.userAPIs[e])}addUserWebhook(e,t){return this.userWebhooks[e]?(this.userWebhooks[e].update(t),!0):(this.userWebhooks[e]=new dH(e,t),!1)}getUserWebhook(e){return this.userWebhooks[e]}getUserWebhooks(){return this.userWebhooks}deleteUserWebhook(e){let t=this.userWebhooks[e];t&&(t.dispose(),delete this.userWebhooks[e])}get scene(){return this.entityOpContext.scene}};new n5(sr.emptyData());var Il=class extends D1{updateByPatchedOp(e,t,i){if(super.updateByPatchedOp(e,t,i),zk(e.path,["materials"])!==null&&e.type===0&&Array.isArray(this.material))for(let[r,s]of Object.entries(e.props)){let a=i.shared.material(s);this.material[Number(r)]=a}else if(Yt(e.path,["material"])&&this.material instanceof Wa)"material"in t&&typeof t.material!="string"&&this.material.updateByOp(qi.drop(e,1),t.material,i);else if(Yt(e.path,["materials","*"])&&Array.isArray(this.material)){let r=e.path[1];if("materials"in t&&r<this.material.length){let s=t.materials[r];typeof s!="string"&&this.material[r].updateByOp(qi.drop(e,2),s,i)}}}get needsAO(){return this.material!==void 0?(Array.isArray(this.material)?this.material[0]:this.material).hasAO:!1}updateState(e,t){var r,s;super.updateState(e,t),e.castShadow!==void 0&&(this.castShadow=e.castShadow),e.receiveShadow!==void 0&&(this.receiveShadow=e.receiveShadow);let i=this.dataPatched;if(((r=e.geometry)==null?void 0:r.type)!=="NonParametricGeometry"&&"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=t.shared.material(e.material).getFlavor(i.flatShading,i.side,i.wireframe),t.scene.markNeedsUpdateRendererDirty()),(((s=e.geometry)==null?void 0:s.type)==="NonParametricGeometry"||"materials"in e)&&("materials"in e&&e.materials!==void 0?(this.disposeMaterial(),this.material=e.materials.map(a=>t.shared.material(a).getFlavor(i.flatShading,i.side,i.wireframe)),t.scene.markNeedsUpdateRendererDirty()):"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=[t.shared.material(e.material).getFlavor(i.flatShading,i.side,i.wireframe)],t.scene.markNeedsUpdateRendererDirty())),e.flatShading!==void 0||e.wireframe!==void 0||e.side!==void 0)if(Array.isArray(this.material))for(let a=0;a<this.material.length;a++)this.material[a]=this.material[a].getFlavor(i.flatShading,i.side,i.wireframe);else this.material=this.material.getFlavor(i.flatShading,i.side,i.wireframe)}disposeMaterial(){this.material&&Ty(this.material).forEach(e=>{e instanceof Wa&&(e instanceof _f||e.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},o8=new E,l8=new ht,h8=new ht,PH=new E,c8=new we,g1=class extends Il{constructor(e,t,i){super(e,t),this.data=t,this.isSkinnedMesh=!1,this.localGeometry=void 0,t.bindMode&&t.bindMatrix&&(this.bindMode=t.bindMode,this.bindMatrix=new we().fromArray(t.bindMatrix),this.bindMatrixInverse=new we)}chooseGeoemtryCache(e){return e.geometryCache}markGeometryAsReachable(e){this.geometryCreateDeleyed instanceof Ge&&this.chooseGeoemtryCache(e).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof n5){let e=this.geometryCreateDeleyed,t=this.chooseGeoemtryCache(e);this.geometryCreateDeleyed=t.get(this.dataPatched.geometry,e,this)}return this.geometryCreateDeleyed}set geometry(e){this.localGeometry=e}get is2DAndNoDepth(){let e=this.dataPatched.geometry;return Nc.is2DParametricMesh(e.type)&&e.depth===0}get is2DType(){return Nc.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),Yt(e.path,["geometry"])&&this.updateByPatchedOpGeometry(qi.drop(e,1),t.geometry,i)}removeInteractionGeometry(e){var t;(t=this.localGeometry)==null||t.dispose(),this.localGeometry=void 0}updateGeometryInteractions(e,t){var r;this.invalidateDownstreamBooleanData();let i=this.data.geometry.type;if(i==="NonParametricGeometry"||i==="SubdivGeometry"){let s=e;if(this.localGeometry===void 0){let h={...this.data.geometry,...s};this.localGeometry=$2(h,t,this.data.flatShading,this)}let a,n,o;s.scaleBaked?[a,n,o]=s.scaleBaked:{width:a,height:n,depth:o}=s;let l=this.localGeometry.userData;l.sxPrev!==void 0&&vf(this.localGeometry.attributes,a/l.sxPrev,n/l.syPrev,o/l.szPrev),l.sxPrev=a,l.syPrev=n,l.szPrev=o}else{let s={...this.data.geometry,...e};(r=this.localGeometry)==null||r.dispose(),this.localGeometry=$2(s,t,this.data.flatShading,this)}}refreshAttachedClonersInteractions(){for(let e of this.attachedSurfaceCloners)e.update()}refreshAttachedCloners(e){for(let t of this.attachedSurfaceCloners)e.scene.addPendingUpdateCloner(t.object)}refreshAttachedPaths(e){for(let t of this.attachedPaths)e.scene.addPendingCommand(()=>t.updateShape())}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.refreshAttachedCloners(e),this.refreshAttachedPaths(e)}updateByPatchedOpGeometry(e,t,i){var s;let r=!1;e.type===0&&e.path.length===0&&Object.keys(e.props).includes("scaleBaked")&&this.geometryCreateDeleyed instanceof M1&&this.chooseGeoemtryCache(i.shared).mutateIfUnique(this.geometryCreateDeleyed.data,t)===this.geometryCreateDeleyed&&(r=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(t,e.props.scaleBaked),this.refreshAttachedCloners(i),this.refreshAttachedPaths(i)),r||((s=i.scene)==null||s.markGeometryCacheDirty(),this.createGeometryDelayed(i)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(e,t){this.createGeometryDelayed(t)}updateState(e,t){e.geometry!==void 0&&this.updateGeometryOnStateUpdate(e.geometry,t);let i=e.morphTargetInfluences;if(i){this.updateMorphTargets(),this.geometry.morphTargetsRelative=!0;for(let{data:{name:r,value:s}}of i)this.updateMorphInfluences(r,t.shared.getVariable(s,[this.uuid,"morphTargetInfluences",r]))}super.updateState(e,t)}updateMorphInfluences(e,t){if(this.morphTargetDictionary===void 0)return;let i=this.morphTargetDictionary[e];i!==void 0&&(this.morphTargetInfluences[i]=t)}updateGeometryGroupsIfNeeded(){var e;Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(((e=this.geometry.getIndex())==null?void 0:e.count)??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(e,t){let i=this.geometry.userData.parameters;this.is2DType?e.set(0,0,i.depth*.5):this.isNonParametric?(e.setScalar(0),this.geometry.boundingSphere&&e.copy(this.geometry.boundingSphere.center),t.set(i.width,i.height,i.depth??0).multiplyScalar(.5)):e.setScalar(0),t.set(i.width,i.height,i.depth??0).multiplyScalar(.5)}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(e,t){this.skeleton=e,this.isSkinnedMesh=!0,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(e){let t=new ht,i=this.geometry.attributes.skinWeight;for(let r=0,s=i.count;r<s;r++){t.fromBufferAttribute(i,r);let a=1/t.manhattanLength();a!==1/0?t.multiplyScalar(a):t.set(1,0,0,0),i.setXYZW(r,t.x,t.y,t.z,t.w)}}boneTransform(e,t){let i=this.skeleton;if(i===void 0)return;let r=this.geometry;l8.fromBufferAttribute(r.attributes.skinIndex,e),h8.fromBufferAttribute(r.attributes.skinWeight,e),o8.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){let a=h8.getComponent(s);if(a!==0){let n=l8.getComponent(s);c8.multiplyMatrices(i.bones[n].matrixWorld,i.boneInverses[n]),t.addScaledVector(PH.copy(o8).applyMatrix4(c8),a)}}return t.applyMatrix4(this.bindMatrixInverse)}};function DH(e){var n,o;if(e.geometry.attributes.extrudeNormal||!e.geometry.attributes.position||!e.geometry.attributes.normal)return;let t=new Map,i=e.geometry.attributes,r=i.position.array,s=i.normal.array,a=new Float32Array(r.length);for(let l=0;l<r.length;l+=3){let h=`${r[l]}_${r[l+1]}_${r[l+2]}`,c=new E(s[l],s[l+1],s[l+2]);t.has(h)?(n=t.get(h))==null||n.normals.push(c):t.set(h,{normals:[c],result:new E})}t.forEach((l,h)=>{for(let c of l.normals)l.result.add(c);l.result.divideScalar(l.normals.length)});for(let l=0;l<r.length;l+=3){let h=`${r[l]}_${r[l+1]}_${r[l+2]}`,c=(o=t.get(h))==null?void 0:o.result;c&&(a[l]=c.x,a[l+1]=c.y,a[l+2]=c.z)}e.geometry.setAttribute("extrudeNormal",new De(a,3))}function IH(e){if(e.geometry.attributes.extrudeNormals||!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,i=new Float32Array(t.length),r=new E;for(let s=0;s<t.length;s+=3)r.set(t[s],t[s+1],t[s+2]).normalize(),i[s]=r.x,i[s+1]=r.y,i[s+2]=r.z;e.geometry.setAttribute("extrudeNormal",new De(i,3))}function o5(e){if(Array.isArray(e.material)){for(let t of e.material)if(t.getLayersOfType("outline").length===0)return}else if(!(e.material instanceof Wa)||e.material.getLayersOfType("outline").length===0)return;e instanceof g1&&e.is2DAndNoDepth?IH(e):DH(e)}function l5(e){if(!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,i=new Float32Array(t.length),r=parseInt(e.uuid.replace(/\D/g,"")),s=[Oe.seededRandom(r),Oe.seededRandom(r+1e4),Oe.seededRandom(r+2e4)];for(let a=0;a<t.length;a++)i[a]=s[a%3];e.geometry.setAttribute("randomColor",new ot(i,3))}var Wr=new vi,e2=new E;function OH(e){let t=!1;return e.scene.objects.traverse((i,r)=>{r.type==="Mesh"&&r.geometry.type==="SubdivGeometry"&&(t=!0)}),t}var eh=class extends g1{constructor(e,t,i){super(e,t,i),this.data=t,this.hiddenMatrixOld=new we,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(e){return this.dataPatched.flatShading?e.geometryCache:e.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(e,t){let i=this.geometry.userData.parameters;e.copy(this.originalGeometryNew.boundingSphere.center),t.set(i.width,i.height,i.depth??0).multiplyScalar(.5)}createGeometryByControls(e){var a,n,o;if(this.skipReactionUpdate===!0)return;let t=(a=this.localGeometry)==null?void 0:a.uuid,{originalGeometry:i,subdividedGeometry:r,subdivPointer:s}=M1.build(e,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=s,i!==void 0&&((n=this.originalGeometry)==null||n.dispose(),this.originalGeometry=i),r!==void 0&&((o=this.subdividedGeometry)==null||o.dispose(),this.subdividedGeometry=r??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,o5(this),l5(this),this.calcBoundingBox(),t&&(this.localGeometry.uuid=t)}updateState(e,t){if(super.updateState(e,t),e.flatShading!==void 0){let i=this.material;this.material=Array.isArray(i)?i.map(r=>r.getFlavor(!1,r.side,r.wireframe)):i.getFlavor(!1,i.side,i.wireframe),this.smoothShading=!e.flatShading,this.createGeometryDelayed(t)}}updateMesh(e=!1){M1.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&M1.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=M1.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=M1.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(e,t){let i=this.localGeometry;this.localGeometry=this.originalGeometryNew,D1.prototype.raycast.call(this,e,t),this.localGeometry=i}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new V1,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,i=e.boundingSphere.center;Wr.setFromBufferAttribute(t),Wr.getCenter(i),e.boundingSphere.radius=i.distanceTo(Wr.max),isNaN(e.boundingSphere.radius),Wr.getSize(e2),this.hasNonUniformScale&&e2.divide(this.scale);let r={width:e2.x,height:e2.y,depth:e2.z};return this.geometry.userData.parameters=r,r}updateBoundingSphere(e){let t=this.originalGeometry;Wr.min.set(e[0],e[2],e[4]),Wr.max.set(e[1],e[3],e[5]),this.hasNonUniformScale&&(Wr.min.applyMatrix4(this.shearScaleInv),Wr.max.applyMatrix4(this.shearScaleInv)),t.boundingSphere===null&&(t.boundingSphere=new V1);let i=t.boundingSphere.center;Wr.getCenter(i),t.boundingSphere.radius=i.distanceTo(Wr.max)}freeSubdivPointer(){var e,t;this.subdivPointer&&(M1.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,(e=this.originalGeometry)==null||e.dispose(),(t=this.subdividedGeometry)==null||t.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(e,t,i){super.updateByPatchedOpGeometry(e,t,i),this.localGeometry&&this.createGeometryByControls(t)}},d8=-1,RH=1,LH={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},BH={polygon_center:0,edge:1,vertex:2},M0=(e,t)=>(i,r)=>!t||i===0||e===0?0:e*r/100,pt=(e,t)=>{let i=Math.abs(t),r=i*-1;return(e-d8)*(i-r)/(RH-d8)+r};function zH(e){let t=[],i={};for(var r=0,s=e.length;r<s;r++){var a=JSON.stringify(e[r].pos.map(n=>Math.round(n*1e4)/1e4));i[a]||(t.push(e[r]),i[a]=!0)}return t}var FH=new E,E0=new E,kH=new E,UH=new E;function Ko(e,t){let i=kH.fromArray(e),r=UH.fromArray(t);E0.copy(r).sub(i);let s=E0.length();return E0.normalize().multiplyScalar(s*.5),FH.copy(i).add(E0).toArray()}var ar=new r1,C0=new E,id=new E,fn=new E;function NH(e){let t=[];for(let i=0;i<=e.index.count;i++)if(C0.fromArray(e.index.array,i*3),ar.setFromAttributeAndIndices(e.attributes.position,C0.x,C0.y,C0.z),ar.getNormal(id),ar.getMidpoint(fn),!(isNaN(fn.x)||isNaN(fn.y)||isNaN(fn.z))){let{a:r,b:s,c:a}=ar,n=r.toArray(),o=s.toArray(),l=a.toArray(),h=r.distanceTo(s),c=s.distanceTo(a),d=a.distanceTo(r),u=Ko(n,o),p=Ko(o,l),f=Ko(l,n),g=[h,c,d],m=Math.max(...g),v=g.filter(w=>Math.round(w)===Math.round(m)).length>1,y=[],x=ar.getMidpoint(fn).toArray();m===h&&!v&&(y=[p,f,f],x=u),m===c&&!v&&(y=[u,f,f],x=p),m===d&&!v&&(y=[u,p,p],x=f),v&&(y=[u,p,f]),t.push({vertices:[n,o,l],faceCenters:y,midpoint:x,norm:ar.getNormal(id).toArray()})}return t}function VH(e){let t=[],{position:i}=e.attributes;for(let r=0;r<i.count;r++){ar.setFromAttributeAndIndices(i,r*3,r*3+1,r*3+2),ar.getNormal(id),ar.getMidpoint(fn);let s=ar.a.toArray(),a=ar.b.toArray(),n=ar.c.toArray();t.push({vertices:[s,a,n],faceCenters:[Ko(s,a),Ko(a,n),Ko(n,s)],midpoint:fn.toArray(),norm:id.toArray()})}return t}var jH=4,GH=.5,dp=e=>.5*(1-Math.cos(e*Math.PI)),HH=class{constructor(){this.perlin=new Array(4096)}noise(e,t=0,i=0){if(this.perlin==null){this.perlin=new Array(4096);for(let m=0;m<4096;m++)this.perlin[m]=Math.random()}e<0&&(e=-e),t<0&&(t=-t),i<0&&(i=-i);let r=Math.floor(e),s=Math.floor(t),a=Math.floor(i),n=e-r,o=t-s,l=i-a,h,c,d=0,u=.5,p,f,g;for(let m=0;m<jH;m++){let v=r+(s<<4)+(a<<8);h=dp(n),c=dp(o),p=this.perlin[v&4095],p+=h*(this.perlin[v+1&4095]-p),f=this.perlin[v+16&4095],f+=h*(this.perlin[v+16+1&4095]-f),p+=c*(f-p),v+=256,f=this.perlin[v&4095],f+=h*(this.perlin[v+1&4095]-f),g=this.perlin[v+16&4095],g+=h*(this.perlin[v+16+1&4095]-g),f+=c*(g-f),p+=dp(l)*(f-p),d+=p*u,u*=GH,r<<=1,n*=2,s<<=1,o*=2,a<<=1,l*=2,n>=1&&(r++,n--),o>=1&&(s++,o--),l>=1&&(a++,l--)}return d}noiseSeed(e){let t=(()=>{let i,r;return{setSeed(s){r=i=(s??Math.random()*4294967296)>>>0},getSeed(){return i},rand(){return r=(1664525*r+1013904223)%4294967296,r/4294967296}}})();t.setSeed(e),this.perlin=new Array(4096);for(let i=0;i<4096;i++)this.perlin[i]=t.rand()}},WH=HH,u8=new E,p8=new we,f8=new vl;function m8(e){let t=!1;return e.scene.objects.traverse((i,r)=>{r.type==="Mesh"&&(r.geometry.type==="TextGeometry"||r.geometry.type==="InputGeometry")&&(t=!0)}),t}var h5=class extends g1{constructor(e,t,i){super(e,t,i),this.data=t}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var t;let e=this.dataPatched;return((t=this.font)==null?void 0:t.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,e.geometry.height,this.fontScale,e.geometry.verticalAlign))??0}get fontScale(){let e=this.dataPatched;return this.font?e.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var e;return(((e=this.font)==null?void 0:e.ascender)??1)*this.fontScale}get descender(){var e;return(((e=this.font)==null?void 0:e.descender)??1)*this.fontScale}get lineHeight(){let e=this.dataPatched;return e.geometry.fontSize*e.geometry.lineHeight}raycast(e,t){let{matrixWorld:i}=this;if(!(isNaN(e.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(p8.copy(i).invert(),f8.copy(e.ray).applyMatrix4(p8),f8.intersectBox(this.singleBBox,u8))){let r=u8.applyMatrix4(i),s=e.ray.origin.distanceTo(r);t.push({distance:s,point:r.clone(),object:this})}}},S1=1e-4,qr,Rb,Lb,Bb,g8=new E,v8=new E;Gx.then(e=>{qr=e,Rb=[qr.get_face_center,qr.get_edge_midpoint,qr.get_vertex_position],Lb=[qr.get_face_normal,qr.get_edge_normal,qr.get_vertex_normal],Bb=[qr.face_count,qr.edge_count,qr.vertex_count]});var qH=new we,YH=new we,ga=new E,T0=new E,t2=new E,up=new E,XH=new E,QH=new E,Cs=new WH,Pr=class extends j4(kt){constructor(e,t){super(),this.parameters=t,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.object=e}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(e){if(this.parent===null)this.updateState(this.parameters,e);else for(let t of this.children)t instanceof m1&&t.expand()}invalidateTransform(e){this.matrixWorldNeedsUpdate=!0,this.traverse(t=>{t instanceof m1&&t.object===e&&(t.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let e of this.children)e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD())}_updateCount(e){let t;if(e!==void 0?t=e:t=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"&&!this.parameters.toObject.object&&(t=0),this.parameters.type==="toObject"&&this.objectForSample){for(let r=0,s=this.children.length;r<s;++r)this.remove(this.children[0]);let i=this.children;if(i.length===t)return;if(i.length<t)for(let r=0,s=t-i.length;r<s;++r){let a=new m1(this.object);a.expand(),this.add(a)}else for(let r=0,s=i.length-t;r<s;++r)this.remove(i[r])}else{if(this.children.length===t)return;if(this.children.length<t)for(let i=0,r=t-this.children.length;i<r;++i){let s=new m1(this.object);s.expand(),this.add(s)}else for(let i=0,r=this.children.length-t;i<r;++i)this.remove(this.children[0])}}_updateRadial(e){let t=e.radial,i=t.start*Oe.DEG2RAD,r=t.end*Oe.DEG2RAD,s=i-r,a=new Ri(t.rotation[0],t.rotation[1],t.rotation[2]),n;switch(t.axis){case"z":n=new E(0,0,1);break;case"y":n=new E(0,1,0);break;default:case"x":n=new E(1,0,0);break}let o=e.randomnessObject??Ia.defaultData([1,1,1]).randomnessObject,l=o.noiseType==="perlin";Cs.noiseSeed(o.seed);let h=Hu((0,Ql.default)(o.seed)),c=M0(o.strength,this.parameters.randomness);for(let[d,u]of this.children.entries()){let p=d*(o.freqScale/10)+o.movement,f=l?Cs.noise(p):h(p,p),g=d+1;u.scale.x=t.scale[0]+c(g,pt(f,o.scale[0]))||S1,u.scale.y=t.scale[1]+c(g,pt(f,o.scale[1]))||S1,u.scale.z=t.scale[2]+c(g,pt(f,o.scale[2]))||S1,u.position.setScalar(0);let m=s/e.count*d-i;switch(t.axis){case"x":u.rotation.set(0,m,0);break;case"y":u.rotation.set(0,0,m);break;case"z":u.rotation.set(m,0,0);break}u.translateOnAxis(n,t.radius),u.position.x+=t.position[0]+c(g,pt(f,o.position[0])),u.position.y+=t.position[1]+c(g,pt(f,o.position[1])),u.position.z+=t.position[2]+c(g,pt(f,o.position[2]));let v=c(g,pt(f,o.rotation[0])),y=c(g,pt(f,o.rotation[1])),x=c(g,pt(f,o.rotation[2]));t.alignment===!0?(u.rotation.x+=a.x+v,u.rotation.y+=a.y+y,u.rotation.z+=a.z+x):u.rotation.set(a.x+v,a.y+y,a.z+x)}}_updateLinear(e){if(e.type!=="linear")throw new Error;let t=e.linear,i=new Ri(t.rotation[0],t.rotation[1],t.rotation[2]),r=e.randomnessObject??Ia.defaultData([1,1,1]).randomnessObject,s=r.noiseType==="perlin";Cs.noiseSeed(r.seed);let a=Hu((0,Ql.default)(r.seed)),n=M0(r.strength,this.parameters.randomness);for(let[o,l]of this.children.entries()){let h=o*(r.freqScale/10)+r.movement,c=s?Cs.noise(h):a(h,h),d=o+1,u=n(d,pt(c,r.rotation[0])),p=n(d,pt(c,r.rotation[1])),f=n(d,pt(c,r.rotation[2]));l.scale.x=1+(t.scale[0]-1)*o+n(d,pt(c,r.scale[0]))||S1,l.scale.y=1+(t.scale[1]-1)*o+n(d,pt(c,r.scale[1]))||S1,l.scale.z=1+(t.scale[2]-1)*o+n(d,pt(c,r.scale[2]))||S1,l.rotation.x=i.x*o+u,l.rotation.y=i.y*o+p,l.rotation.z=i.z*o+f,l.position.x=t.position[0]*o+n(d,pt(c,r.position[0])),l.position.y=t.position[1]*o+n(d,pt(c,r.position[1])),l.position.z=t.position[2]*o+n(d,pt(c,r.position[2]))}}_updateGrid(e){let t=0,i=e.grid,r=e.randomnessObject??Ia.defaultData([1,1,1]).randomnessObject,s=M0(r.strength,this.parameters.randomness),a=r.noiseType==="perlin";Cs.noiseSeed(r.seed);let n=yN((0,Ql.default)(r.seed));if(i.useCenter===!0){let o={x:i.count[0]%2===0?2:1,y:i.count[1]%2===0?2:1,z:i.count[2]%2===0?2:1},l=new E(i.size[0]*(i.count[0]-o.x)*.5,i.size[1]*(i.count[1]-o.y)*.5,i.size[2]*(i.count[2]-o.z)*.5);for(let h=0;h<i.count[0];h++)for(let c=0;c<i.count[1];c++)for(let d=0;d<i.count[2];d++){let u=[(h+1)*(r.freqScale/10)+r.movement,(c+1)*(r.freqScale/10)+r.movement,(d+1)*(r.freqScale/10)+r.movement],p=a?Cs.noise(...u):n(...u),f=this.children[t++];f.scale.x=1+s(t,pt(p,r.scale[0]))||S1,f.scale.y=1+s(t,pt(p,r.scale[1]))||S1,f.scale.z=1+s(t,pt(p,r.scale[2]))||S1;let g=s(t,pt(p,r.rotation[0])),m=s(t,pt(p,r.rotation[1])),v=s(t,pt(p,r.rotation[2]));f.rotation.set(g,m,v),f.position.x=i.size[0]*h-l.x+s(t,pt(p,r.position[0])),f.position.y=i.size[1]*c-l.y+s(t,pt(p,r.position[1])),f.position.z=i.size[2]*d-l.z+s(t,pt(p,r.position[2]))}}else for(let o=0;o<i.count[0];o++)for(let l=0;l<i.count[1];l++)for(let h=0;h<i.count[2];h++){let c=[(o+1)*(r.freqScale/10)+r.movement,(l+1)*(r.freqScale/10)+r.movement,(h+1)*(r.freqScale/10)+r.movement],d=a?Cs.noise(...c):n(...c),u=this.children[t++];u.scale.x=1+s(t,pt(d,r.scale[0]))||S1,u.scale.y=1+s(t,pt(d,r.scale[1]))||S1,u.scale.z=1+s(t,pt(d,r.scale[2]))||S1;let p=s(t,pt(d,r.rotation[0])),f=s(t,pt(d,r.rotation[1])),g=s(t,pt(d,r.rotation[2]));u.rotation.set(p,f,g),u.position.x=i.size[0]*o+s(t,pt(d,r.position[0])),u.position.y=-i.size[1]*l+s(t,pt(d,r.position[1])),u.position.z=-i.size[2]*h+s(t,pt(d,r.position[2]))}}_updateToObject(e){var g;if(e.type!=="toObject")throw new Error;let{toObject:t}=e,i=new Ri(t.rotation[0],t.rotation[1],t.rotation[2]),r=e.randomnessObject??Ia.defaultData([1,1,1]).randomnessObject,s=r.noiseType==="perlin";Cs.noiseSeed(r.seed);let a=Hu((0,Ql.default)(r.seed)),n=M0(r.strength,this.parameters.randomness);if(!t.object){for(let[,m]of this.children.entries())m.position.set(0,0,0),m.scale.setScalar(1),m.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof h5)if(!((g=this.objectForSample.font)!=null&&g.isLoaded)||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){`${this.object.name}${this.object.uuid}`;return}let o=this.getSubdivData(),l=[],h=m=>{let v=m.length,y=m.map(_=>_[0]).reduce((_,b)=>_+b,0),x=m.map(_=>_[1]).reduce((_,b)=>_+b,0),w=m.map(_=>_[2]).reduce((_,b)=>_+b,0);return[y/v,x/v,w/v]},c=m=>Math.round(m*1e6)/1e6;o.forEach(m=>{let v=o.filter(y=>c(m.pos[0])===c(y.pos[0])&&c(m.pos[1])===c(y.pos[1])&&c(m.pos[2])===c(y.pos[2]));v.length>1?l.push({pos:m.pos,norm:h(v.map(y=>y.norm))}):l.push(m)});let d=zH(l);if(d.length>0){let m=Math.round(d.length*t.count/100);this._updateCount(m)}else{let m=this.objectForSample.geometry.getAttribute("position");if(!m||isNaN(m.count)||m.count===0){`${this.object.name}${this.object.uuid}${this.objectForSample.name}${this.objectForSample.uuid}`;return}}this.objectForSample.updateMatrixWorld();let u=new xN(this.objectForSample).build(),p=LH[t.axis],f=this.children;u.setRandomGenerator((0,Ql.default)(this.object.uuid+t.seed));for(let[m,v]of f.entries()){let y=m*(r.freqScale/10)+r.movement,x=s?Cs.noise(y):a(y,y),w=m+1,_=n(w,pt(x,r.rotation[0])),b=n(w,pt(x,r.rotation[1])),A=n(w,pt(x,r.rotation[2]));t.spreadType==="random"?u.sample(t2,up):(d.length&&(t2.fromArray(d[m].pos),up.fromArray(d[m].norm)),this.objectForSample instanceof eh&&t2.applyMatrix4(qH.copy(this.objectForSample.matrixWorld).invert())),t2.applyMatrix4(this.object.hiddenMatrix.clone().invert()),v.position.copy(t2),ga.fromArray(p);let S=t.align==="normal"?up:this.object.getWorldDirection(QH),M=T0.fromArray(t.position);T0.x+=n(w,pt(x,r.position[0])),T0.y+=n(w,pt(x,r.position[1])),T0.z+=n(w,pt(x,r.position[2]));let C=Math.acos(S.dot(ga)),T=XH.crossVectors(ga,S).normalize(),P=YH.makeRotationAxis(T,C),I=S.clone().cross(this.object.up).normalize(),D=I.clone().cross(S).normalize(),k=new we().makeBasis(I,S,D),H=new E(ga.y,ga.z,ga.x).normalize(),U=H.clone().cross(ga).normalize(),F=new we().makeBasis(H,ga,U).invert(),Z=new we().multiplyMatrices(k,F);v.rotation.setFromRotationMatrix(Z),M.applyMatrix4(P),v.position.add(M),v.rotation.x=v.rotation.x+i.x+_,v.rotation.y=v.rotation.y+i.y+b,v.rotation.z=v.rotation.z+i.z+A,v.scale.setScalar(1),v.scale.x=v.scale.x+t.scale[0]+n(w,pt(x,r.scale[0]))||S1,v.scale.y=v.scale.y+t.scale[1]+n(w,pt(x,r.scale[1]))||S1,v.scale.z=v.scale.z+t.scale[2]+n(w,pt(x,r.scale[2]))||S1,v.scale.multiply(this.object.scale),v.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let e=this.parameters.toObject.spreadType;if(e==="random")return[];if(this.objectForSample instanceof eh){let t=this.objectForSample,i=BH[e],r=Bb[i],s=Rb[i],a=Lb[i],n=[],o=r(t.subdivPointerNew);for(let l=0;l<=o-1;l++){let h=s(t.subdivPointerNew,l),c=a(t.subdivPointerNew,l);g8.fromArray(h).applyMatrix4(t.matrixWorld),v8.fromArray(c),n.push({pos:g8.toArray(),norm:v8.toArray()})}return n}else return(this.objectForSample.geometry.index?NH(this.objectForSample.geometry):VH(this.objectForSample.geometry)).map((t,i)=>e==="polygon_center"?{pos:t.midpoint,norm:t.norm}:e==="vertex"?[{pos:t.vertices[0],norm:t.norm},{pos:t.vertices[1],norm:t.norm},{pos:t.vertices[2],norm:t.norm}]:e==="edge"?[{pos:t.faceCenters[0],norm:t.norm},{pos:t.faceCenters[1],norm:t.norm},{pos:t.faceCenters[2],norm:t.norm}]:[]).flat()}updateState(e,t){var i;if(this.parameters=_d(e),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),(i=this.object.parent)==null||i.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let r=t.find(this.parameters.toObject.object);r instanceof D1?this.objectForSample=r:this.objectForSample=void 0,this.matrix=new we,this.hiddenMatrix=new we,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,r&&r.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},ph=e=>{var t;return t=class extends e{},t.geometryHelper=new Lr(30,30,30),t},P0=new vl,pp=new V1,y8=new we,fh=(e,t,i,r,s=!1,a=e)=>{let n=t,o=a.matrixWorld;if(n.boundingSphere===null&&n.computeBoundingSphere(),pp.copy(n.boundingSphere),pp.applyMatrix4(o),i.ray.intersectsSphere(pp)===!1||(y8.copy(o).invert(),P0.copy(i.ray).applyMatrix4(y8),n.boundingBox!==null&&P0.intersectsBox(n.boundingBox)===!1))return;let l,h,c,d,u=n.index,p=n.attributes.position,f=n.drawRange,g,m;if(s===!1){let y=Math.max(0,f.start),x=Math.min(u.count,f.start+f.count);for(g=y,m=x;g<m;g+=3)if(h=u.getX(g),c=u.getX(g+1),d=u.getX(g+2),l=v(e,i,P0,p,h,c,d),l){l.faceIndex=Math.floor(g/3),r.push(l);return}}else{let y=n.attributes.position,x=new E,w=new E,_=new E,b=new E,A=2,S=1/((a.scale.x+a.scale.y+a.scale.z)/3),M=S*S,C=Math.max(0,f.start),T=Math.min(y.count,f.start+f.count);for(let P=C,I=T-1;P<I;P+=A){if(x.fromBufferAttribute(y,P),w.fromBufferAttribute(y,P+1),P0.distanceSqToSegment(x,w,b,_)>M)continue;b.applyMatrix4(a.matrixWorld);let D=i.ray.origin.distanceTo(b);D<i.near||D>i.far||r.push({distance:D,point:_.clone().applyMatrix4(a.matrixWorld),object:e})}}function v(y,x,w,_,b,A,S){let M=new E,C=new E,T=new E,P=new E,I=new E;if(M.fromBufferAttribute(_,b),C.fromBufferAttribute(_,A),T.fromBufferAttribute(_,S),w.intersectTriangle(M,C,T,!1,P)===null)return null;I.copy(P),I.applyMatrix4(y.matrixWorld);let D=x.ray.origin.distanceTo(I);return D<x.near||D>x.far?null:{faceIndex:1,distance:D,point:I.clone(),object:y}}},D0=new E,J1=new Vn,ZH=class extends sh{constructor(e){let t=new Ge,i=new Xa({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],a={},n=new Je(15711266),o=new Je(15711266),l=new Je(2857471);h("n1","n2",n),h("n2","n4",n),h("n4","n3",n),h("n3","n1",n),h("f1","f2",n),h("f2","f4",n),h("f4","f3",n),h("f3","f1",n),h("n1","f1",n),h("n2","f2",n),h("n3","f3",n),h("n4","f4",n),h("p","n1",o),h("p","n2",o),h("p","n3",o),h("p","n4",o),h("u1","u2",l),h("u2","u3",l),h("u3","u1",l);function h(d,u,p){c(d,p),c(u,p)}function c(d,u){r.push(0,0,0),s.push(u.r,u.g,u.b),a[d]===void 0&&(a[d]=[]),a[d].push(r.length/3-1)}t.setAttribute("position",new De(r,3)),t.setAttribute("color",new De(s,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}update(){let e=this.geometry,t=this.pointMap;J1.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let i=1,r=1,s=.8;xr("n1",t,e,J1,-i,-r,s),xr("n2",t,e,J1,i,-r,s),xr("n3",t,e,J1,-i,r,s),xr("n4",t,e,J1,i,r,s);let a=s;xr("f1",t,e,J1,-i,-r,a),xr("f2",t,e,J1,i,-r,a),xr("f3",t,e,J1,-i,r,a),xr("f4",t,e,J1,i,r,a);let n=a,o=.5;xr("u1",t,e,J1,i*.7*o,r*1.1,n),xr("u2",t,e,J1,-i*.7*o,r*1.1,n),xr("u3",t,e,J1,0,r*(1.1+.9*o),n),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function xr(e,t,i,r,s,a,n){D0.set(s,a,n).unproject(r);let o=t[e];if(o!==void 0){let l=i.getAttribute("position");for(let h=0,c=o.length;h<c;h++)l.setXYZ(o[h],D0.x,D0.y,D0.z)}}var KH=class extends ph(ZH){constructor(e){super(e),this.object=e,this.object=e,this.name=`CombinedCameraHelper: ${e.uuid}`}updateMatrixWorld(e){super.updateMatrixWorld(e),this.updateTarget()}updateTarget(){let e=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(e)}raycast(e,t){fh(this.object,this.geometry,e,t,!0)}},Mf;(e=>e.is=t=>"objectHelper"in t)(Mf||(Mf={}));var Ol=(e,t)=>class extends G4(e){constructor(){super(...arguments),this.objectHelper=new t(this),this.gizmos={}}get geometryHelper(){return t.geometryHelper}raycast(i,r){this.objectHelper.raycast(i,r)}showGizmos(){for(let i in this.gizmos){let r=this.gizmos[i];r instanceof wc&&(r.visible=!0)}}updateEntityBoxSize(i,r){this.objectHelper.visible&&this.geometryHelper instanceof Lr?(i.setScalar(0),r.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(i,r)}hideGizmos(){for(let i in this.gizmos){let r=this.gizmos[i];r instanceof wc&&(r.visible=!1)}}},I0=790,xo=new E,fp=new E,mp=new lt,gp=new E,i2=new E,vp=new E,v1=class extends Ol(Vn,KH){constructor(e="",t={...W2.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=ll.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(e,t),this.previousProjectionMatrix=new we,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let i=this.width,r=this.height;this.orthoCamera=new pd(i*-.5,i*.5,r*.5,r*-.5,-5e4,1e4),this.perspCamera=new u1(45,i/r,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(e){this.perspCamera.fov=e}get fov(){return this.perspCamera.fov}setNear(e,t){e==="PerspectiveCamera"?this.perspCamera.near=t:this.orthoCamera.near=t}setZoom(e,t){t>=0&&(e==="PerspectiveCamera"?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}set cameraType(e){e==="PerspectiveCamera"?this.toPerspective():e==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(e){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=e:this.orthoCamera.near=e}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(e){e>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}lookAt(e,t,i){typeof e=="number"&&(e=new E(e,t,i)),super.lookAt(e),this.getWorldPosition(xo),this.targetOffset=xo.distanceTo(e)}getTarget(e=new E){return this.getWorldDirection(fp),this.getWorldPosition(xo),fp.multiplyScalar(this.targetOffset),e.copy(xo).add(fp),e}getDistanceToTarget(){let e=this.getTarget();return this.getWorldPosition(xo),xo.distanceTo(e)}updateUp(){this.getWorldQuaternion(mp),gp.set(0,0,1).applyQuaternion(mp),i2.copy(kt.DEFAULT_UP),this.isUpVectorFlipped&&i2.negate(),i2.applyQuaternion(mp),vp.copy(kt.DEFAULT_UP).projectOnPlane(gp),this.angleOffsetFromUp=vp.angleTo(i2),this.angleOffsetFromUp*=vp.cross(i2).dot(gp)>=0?1:-1}updateTransformState(e,t){let i=super.updateTransformState(e,t);return e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateUp(),i}getViewFrontToObject(e){let t=e.getWorldPosition(new E),i=e.getWorldDirection(new E).multiplyScalar(this.targetOffset);return{position:t.clone().add(i),target:t}}getViewToTarget(e){let t=this.getWorldDirection(new E).multiplyScalar(this.targetOffset);return{position:e.clone().sub(t),target:e}}getViewToObject(e){let t=new E;return e.getWorldPosition(t),this.getViewToTarget(t)}setViewplaneSize(e,t,i=!1){if(this.aspect=e/t,i){let r=e>t?this.aspect:1,s=e>t?1:this.aspect;this.left=-I0*.5*r,this.right=I0*.5*r,this.top=I0*.5*(1/s),this.bottom=-I0*.5*(1/s)}else this.left=-e*.5,this.right=e*.5,this.top=t*.5,this.bottom=-t*.5;this.updateProjectionMatrix()}copyViewPlaneSize(e){this.aspect=e.aspect,this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(e){this.perspCamera.setFocalLength(e),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(e,t,i,r,s,a){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(e,t,i,r,s,a):this.orthoCamera.setViewOffset(e,t,i,r,s,a)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(e,t){return super.copy(e,t),this.parent=e.parent,this.orthoCamera.copy(e.orthoCamera),this.perspCamera.copy(e.perspCamera),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.far=e.far,this.view=e.view===null?null:Object.assign({},e.view),this._cameraType=e._cameraType,this.aspect=e.aspect,this.fov=e.fov,this.focus=e.focus,this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this.targetOffset=e.targetOffset,this.updateProjectionMatrix(),this}toCameraState(e=[]){let t={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return v3(t,e)}updateCameraSubtype(e,t){let i=e==="perspective"?"PerspectiveCamera":"OrthographicCamera";t.zoom!==void 0&&this.setZoom(i,t.zoom),t.near!==void 0&&this.setNear(i,t.near),t.fov!==void 0&&i==="PerspectiveCamera"&&(this.fov=t.fov)}updateState(e,t){this.updateCameraState(e,t)}updateCameraState(e,t){this.updateState_Entity(e,t),e.far!==void 0&&(this.far=e.far),e.orthographic!==void 0&&this.updateCameraSubtype("orthographic",e.orthographic),e.perspective!==void 0&&this.updateCameraSubtype("perspective",e.perspective),e.type!==void 0&&(this.cameraType=e.type),e.up!==void 0&&this.up.fromArray(e.up),e.targetOffset!==void 0&&(this.targetOffset=e.targetOffset),e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),e.path.length===1&&e.type===0&&this.updateCameraSubtype(e.path[0],e.props)}toState(e){return{...super.toState(e),...this.toCameraState(e),type:this.cameraType}}},bo=new we,JH=new we;function x8(e){let t=!1;return e.scene.objects.traverse((i,r)=>{var s;((s=r.geometry)==null?void 0:s.type)==="BooleanGeometry"&&(t=!0)}),t}var Nn=class extends Il{constructor(e,t,i){super(e,t),this.data=t,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new Ge,this.onAfterRender=(r,s,a,n,o,l)=>{super.onAfterRender(r,s,a,n,o,l),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),e.path.length===1&&e.path[0]==="geometry"&&e.type===0&&e.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(e,t=!0){var r;if(this.booleanMeshSetAddress!==-1&&!e)return;for(let s=0;s<this.children.length;s++){let a=this.children[s];a instanceof Nn&&a.dataPatched.visible===!0&&a.recomputeBoolean(e===!0,t)}this.meshSetAddresses=[];for(let s=0;s<this.children.length;s++){let a=this.children[s];if(a instanceof D1&&a.dataPatched.visible===!0&&((r=a.geometry.attributes.position)==null?void 0:r.count)>0&&a.geometry.drawRange.count>0&&a.booleanMeshSetAddress!==0){bo.multiplyMatrices(a.hiddenMatrix,a.matrix);try{if(a.booleanMeshSetAddress===-1){if((a.geometry.index??a.geometry.getAttribute("position")).count/3<15e5&&(a.booleanMeshSetAddress=Bs.getMeshSet(a.geometry,e===!0,t)),a.booleanMeshSetAddress===-1)return;Bs.transformMeshSet(a.booleanMeshSetAddress,bo),a.booleanMatrixInvOld.copy(bo).invert(),a.booleanWasTransformed=!1}else a instanceof Nn&&a.needsTransformForDownstream===!0?(Bs.transformMeshSet(a.booleanMeshSetAddress,bo),a.needsTransformForDownstream=!1):a.booleanWasTransformed===!0&&(Bs.transformMeshSet(a.booleanMeshSetAddress,JH.multiplyMatrices(bo,a.booleanMatrixInvOld)),a.booleanMatrixInvOld.copy(bo).invert(),a.booleanWasTransformed=!1)}catch(n){a.booleanMeshSetAddress=0,a.geometry.userData.booleanOperationDidFail=!0;continue}Bs.hasOpenEdges(a.booleanMeshSetAddress)===!1||s===this.children.length-1&&this.booleanOp===2?(this.meshSetAddresses.push(a.booleanMeshSetAddress),a.geometry.userData.booleanOperationDidFail=!1):a.geometry.userData.booleanOperationDidFail="openEdges"}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new De([],0)),this.geometry.setDrawRange(0,0);return}if(e===!0)return Bs.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let i=this.geometry;i.dispose(),this.geometry=new Ge,this.geometry.userData=i.userData,this.geometry.boundingSphere=i.boundingSphere;try{this.booleanMeshSetAddress=Bs.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(s){this.booleanMeshSetAddress=0,this.geometry.userData.booleanOperationDidFail=!0}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,o5(this),l5(this)}dispose(){super.dispose(),this.geometry.dispose()}},Ef;(e=>{function t(i){return Et.is(i)&&i instanceof oh}e.is=t})(Ef||(Ef={}));var c5=(e,t)=>class extends Ol(e,t){updateState_Light(i,r){this.updateState_Entity(i,r),i.color!==void 0&&(this.color=r.shared.color(i.color)),i.intensity!==void 0&&(this.intensity=i.intensity),i.depth!==void 0&&(this.shadow.camera.far=i.depth,this.shadow.needsUpdate=!0),i.shadows!==void 0&&(this.castShadow=i.shadows)}},Mr=e=>e instanceof D1,Xs=e=>e!==null&&e instanceof Nn,$H=e=>e instanceof v1,eW=e=>Ef.is(e),Cf=e=>Mf.is(e),tW=new E(1,1,1),b8=new E,iW=new E,w8=new lt,mh=class extends ph(kP){constructor(e,t=15){super(t),this.object=e,this.dummy=new qs,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${e.uuid}`,this.matrix=this.dummy.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(e,t){fh(this.object,mh.geometryHelper,e,t,!1,this.dummy)}update(){}updateMatrix(){}updateMatrixWorld(e){this.object.matrixWorld.decompose(b8,w8,iW),this.matrix.compose(b8,w8,tW),super.updateMatrixWorld(e)}updateWorldMatrix(e,t){}},Jo=class extends Ol(qs,mh){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t),"buffer"in e&&Object.keys(e).length===1&&t.scene.reloadSplats()}},ec=class extends Ol(qs,mh){constructor(e,t,i){super(),this.super_Entity(e,t),this.context=i,this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t)}},zb={RED:0,GREEN:1,BLUE:2,ALPHA:3},gh="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",rW=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;uniform vec4 kernel64[32];varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;
#else
float CoC=texture2D(cocBuffer,vUv).g*scale;
#endif
if(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(CoC,CoCNearFar.g*scale);
#else
vec2 step=texelSize*CoC;
#endif
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;}}`,O0=class extends It{constructor(e=!1,t=!1){super({name:"BokehMaterial",defines:{PASS:e?"2":"1"},uniforms:{kernel64:new ve(null),kernel16:new ve(null),inputBuffer:new ve(null),cocBuffer:new ve(null),texelSize:new ve(new j),scale:new ve(1)},blending:Mi,depthWrite:!1,depthTest:!1,fragmentShader:rW,vertexShader:gh}),this.toneMapped=!1,t&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set cocBuffer(e){this.uniforms.cocBuffer.value=e}setCoCBuffer(e){this.uniforms.cocBuffer.value=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(e){return this.uniforms.scale.value=e}setScale(e){this.uniforms.scale.value=e}generateKernel(){let e=2.39996323,t=new Float32Array(128),i=new Float32Array(32),r=0,s=0;for(let o=0;o<80;++o){let l=o*e,h=Math.sqrt(o)/Math.sqrt(80),c=h*Math.cos(l),d=h*Math.sin(l);o%5===0?(i[s++]=c,i[s++]=d):(t[r++]=c,t[r++]=d)}let a=[],n=[];for(let o=0;o<128;)a.push(new ht(t[o++],t[o++],t[o++],t[o++]));for(let o=0;o<32;)n.push(new ht(i[o++],i[o++],i[o++],i[o++]));this.uniforms.kernel64.value=a,this.uniforms.kernel16.value=n}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}};function S8(e,t,i){return e*(t-i)-t}function Tf(e,t,i){return Math.min(Math.max((e+t)/(t-i),0),1)}var sW=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,aW=class extends It{constructor(e){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new ve(null),focusDistance:new ve(0),focusRange:new ve(0),cameraNear:new ve(.3),cameraFar:new ve(1e3)},blending:Mi,depthWrite:!1,depthTest:!1,fragmentShader:sW,vertexShader:gh}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(e)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=na){this.depthBuffer=e,this.depthPacking=t}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(e){this.uniforms.focusDistance.value=e}get worldFocusDistance(){return-S8(this.focusDistance,this.near,this.far)}set worldFocusDistance(e){this.focusDistance=Tf(-e,this.near,this.far)}getFocusDistance(e){this.uniforms.focusDistance.value=e}setFocusDistance(e){this.uniforms.focusDistance.value=e}get focalLength(){return this.focusRange}set focalLength(e){this.focusRange=e}get focusRange(){return this.uniforms.focusRange.value}set focusRange(e){this.uniforms.focusRange.value=e}get worldFocusRange(){return-S8(this.focusRange,this.near,this.far)}set worldFocusRange(e){this.focusRange=Tf(-e,this.near,this.far)}getFocalLength(e){return this.focusRange}setFocalLength(e){this.focusRange=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof u1?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},nW=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <encodings_fragment>
#include <dithering_fragment>
}`,oW="uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",_8=class extends It{constructor(e=new j){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new ve(null),texelSize:new ve(new j),halfTexelSize:new ve(new j),kernel:new ve(0),scale:new ve(1)},blending:Mi,depthWrite:!1,depthTest:!1,fragmentShader:nW,vertexShader:oW}),this.toneMapped=!1,this.setTexelSize(e.x,e.y)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setSize(e,t){let i=this.uniforms;i.texelSize.value.set(1/e,1/t),i.halfTexelSize.value.copy(i.texelSize.value).multiplyScalar(.5)}},lW=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <encodings_fragment>
}`,hW=class extends It{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new ve(null),opacity:new ve(1)},blending:Mi,depthWrite:!1,depthTest:!1,fragmentShader:lW,vertexShader:gh}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},cW=`varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
#if EDGE_DETECTION_MODE == 1
#include <common>
#endif
#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}
#elif PREDICATION_MODE == 2
uniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}
#endif
#if PREDICATION_MODE != 0
vec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}
#endif
#if EDGE_DETECTION_MODE != 0
uniform sampler2D inputBuffer;
#endif
void main(){
#if EDGE_DETECTION_MODE == 0
const vec2 threshold=vec2(DEPTH_THRESHOLD);
#elif PREDICATION_MODE != 0
vec2 threshold=calculatePredicatedThreshold();
#else
const vec2 threshold=vec2(EDGE_THRESHOLD);
#endif
#if EDGE_DETECTION_MODE == 0
vec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 1
float l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 2
vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#endif
}`,dW=`uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);
#if EDGE_DETECTION_MODE != 0
vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);
#endif
gl_Position=vec4(position.xy,1.0,1.0);}`,Rd={DEPTH:0,LUMA:1,COLOR:2},uW={DISABLED:0,DEPTH:1,CUSTOM:2},pW=class extends It{constructor(e=new j,t=Rd.COLOR){super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:gl.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new ve(null),depthBuffer:new ve(null),predicationBuffer:new ve(null),texelSize:new ve(e)},blending:Mi,depthWrite:!1,depthTest:!1,fragmentShader:cW,vertexShader:dW}),this.toneMapped=!1,this.edgeDetectionMode=t}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=na){this.depthBuffer=e,this.depthPacking=t}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(e){this.defines.EDGE_DETECTION_MODE=e.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(e){this.edgeDetectionMode=e}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(e){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=e.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(e){this.localContrastAdaptationFactor=e}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(e){this.defines.EDGE_THRESHOLD=e.toFixed("6"),this.defines.DEPTH_THRESHOLD=(e*.1).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(e){this.edgeDetectionThreshold=e}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(e){this.defines.PREDICATION_MODE=e.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(e){this.predicationMode=e}set predicationBuffer(e){this.uniforms.predicationBuffer.value=e}setPredicationBuffer(e){this.uniforms.predicationBuffer.value=e}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(e){this.defines.PREDICATION_THRESHOLD=e.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(e){this.predicationThreshold=e}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(e){this.defines.PREDICATION_SCALE=e.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(e){this.predicationScale=e}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(e){this.defines.PREDICATION_STRENGTH=e.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(e){this.predicationStrength=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},fW=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <encodings_fragment>
#endif
#include <dithering_fragment>
}`,mW="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}",br={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},Pf=class extends It{constructor(e,t,i,r,s=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:gl.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new ve(null),depthBuffer:new ve(null),resolution:new ve(new j),texelSize:new ve(new j),cameraNear:new ve(.3),cameraFar:new ve(1e3),aspect:new ve(1),time:new ve(0)},blending:Mi,depthWrite:!1,depthTest:!1,dithering:s}),this.toneMapped=!1,e&&this.setShaderParts(e),t&&this.setDefines(t),i&&this.setUniforms(i),this.adoptCameraSettings(r)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=na){this.depthBuffer=e,this.depthPacking=t}setShaderParts(e){return this.fragmentShader=fW.replace(br.FRAGMENT_HEAD,e.get(br.FRAGMENT_HEAD)).replace(br.FRAGMENT_MAIN_UV,e.get(br.FRAGMENT_MAIN_UV)).replace(br.FRAGMENT_MAIN_IMAGE,e.get(br.FRAGMENT_MAIN_IMAGE)),this.vertexShader=mW.replace(br.VERTEX_HEAD,e.get(br.VERTEX_HEAD)).replace(br.VERTEX_MAIN_SUPPORT,e.get(br.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(e){for(let t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(let t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(let t of e)this.extensions[t]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof u1?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){let i=this.uniforms;i.resolution.value.set(e,t),i.texelSize.value.set(1/e,1/t),i.aspect.value=e/t}static get Section(){return br}},gW=`#include <common>
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,vW=class extends It{constructor(e=!1,t=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:gl.replace(/\D+/g,"")},uniforms:{inputBuffer:new ve(null),threshold:new ve(0),smoothing:new ve(1),range:new ve(null)},blending:Mi,depthWrite:!1,depthTest:!1,fragmentShader:gW,vertexShader:gh}),this.toneMapped=!1,this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return this.luminanceRange!==null}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){e!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},yW=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,Fb={DISCARD:0,MULTIPLY:1,MULTIPLY_RGB_SET_ALPHA:2},xW=class extends It{constructor(e=null){super({name:"MaskMaterial",uniforms:{maskTexture:new ve(e),inputBuffer:new ve(null),strength:new ve(1)},blending:Mi,depthWrite:!1,depthTest:!1,fragmentShader:yW,vertexShader:gh}),this.toneMapped=!1,this.setColorChannel(zb.RED),this.setMaskFunction(Fb.DISCARD)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set maskTexture(e){this.uniforms.maskTexture.value=e,delete this.defines.MASK_PRECISION_HIGH,e.type!==y1&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(e){this.maskTexture=e}set colorChannel(e){this.defines.COLOR_CHANNEL=e.toFixed(0),this.needsUpdate=!0}setColorChannel(e){this.colorChannel=e}set maskFunction(e){this.defines.MASK_FUNCTION=e.toFixed(0),this.needsUpdate=!0}setMaskFunction(e){this.maskFunction=e}get inverted(){return this.defines.INVERTED!==void 0}set inverted(e){this.inverted&&!e?delete this.defines.INVERTED:e&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get strength(){return this.uniforms.strength.value}set strength(e){this.uniforms.strength.value=e}getStrength(){return this.strength}setStrength(e){this.strength=e}},bW=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,wW="uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",SW=class extends It{constructor(e=new j,t=new j){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new ve(null),searchTexture:new ve(null),areaTexture:new ve(null),resolution:new ve(t),texelSize:new ve(e)},blending:Mi,depthWrite:!1,depthTest:!1,fragmentShader:bW,vertexShader:wW}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(e){this.uniforms.searchTexture.value=e}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(e){this.uniforms.areaTexture.value=e}setLookupTextures(e,t){this.searchTexture=e,this.areaTexture=t}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(e){let t=Math.min(Math.max(e,0),112);this.defines.MAX_SEARCH_STEPS_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(e){this.orthogonalSearchSteps=e}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(e){let t=Math.min(Math.max(e,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(e){this.diagonalSearchSteps=e}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(e){e?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(e){this.diagonalDetection=e}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(e){let t=Math.min(Math.max(e,0),100);this.defines.CORNER_ROUNDING=t.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(t/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(e){this.cornerRounding=e}get cornerDetection(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerDetection(e){e?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(e){this.cornerDetection=e}setSize(e,t){let i=this.uniforms;i.texelSize.value.set(1/e,1/t),i.resolution.value.set(e,t)}},_W=new Vn,va=null;function AW(){if(va===null){let e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);va=new Ge,va.setAttribute!==void 0?(va.setAttribute("position",new ot(e,3)),va.setAttribute("uv",new ot(t,2))):(va.addAttribute("position",new ot(e,3)),va.addAttribute("uv",new ot(t,2)))}return va}var I1=class{constructor(e="Pass",t=new ls,i=_W){this.name=e,this.renderer=null,this.scene=t,this.camera=i,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){let t=this.getFullscreenMaterial();t!==null&&(t.needsUpdate=!0),this.rtt=!e}}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new si(AW(),e),t.frustumCulled=!1,this.scene===null&&(this.scene=new ls),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=na){}render(e,t,i,r,s){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,i){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t=="object"&&typeof t.dispose=="function"){if(t instanceof ls||t===this.renderer)continue;this[e].dispose()}}}},Df=class extends I1{constructor(e,t=!0){super("CopyPass"),this.fullscreenMaterial=new hW,this.needsSwap=!1,this.renderTarget=e,e===void 0&&(this.renderTarget=new Rt(1,1,{minFilter:gt,magFilter:gt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,i,r,s){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,i){i!==void 0&&(this.renderTarget.texture.type=i,i!==y1?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e.outputEncoding===ft&&(this.renderTarget.texture.encoding=ft))}},MW=class extends I1{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,i,r,s){let a=e.state.buffers.stencil;a.setLocked(!1),a.setTest(!1)}},yp=new Je,d5=class extends I1{constructor(e=!0,t=!0,i=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=i,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,i){this.color=e,this.depth=t,this.stencil=i}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,i,r,s){let a=this.overrideClearColor,n=this.overrideClearAlpha,o=e.getClearAlpha(),l=a!==null,h=n>=0;l?(yp.copy(e.getClearColor(yp)),e.setClearColor(a,h?n:o)):h&&e.setClearAlpha(n),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),l?e.setClearColor(yp,o):h&&e.setClearAlpha(o)}},ya=-1,N1=class extends l1{constructor(e,t=ya,i=ya,r=1){super(),this.resizable=e,this.base=new j(1,1),this.preferred=new j(t,i),this.target=this.preferred,this.s=r}get width(){let{base:e,preferred:t,scale:i}=this,r;return t.width!==ya?r=t.width:t.height!==ya?r=Math.round(t.height*(e.width/Math.max(e.height,1))):r=Math.round(e.width*i),r}set width(e){this.preferredWidth=e}get height(){let{base:e,preferred:t,scale:i}=this,r;return t.height!==ya?r=t.height:t.width!==ya?r=Math.round(t.width/Math.max(e.width/Math.max(e.height,1),1)):r=Math.round(e.height*i),r}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferred.setScalar(ya),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.base.width}set baseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(e){this.base.height!==e&&(this.base.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.base.width!==e||this.base.height!==t)&&(this.base.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(e){this.preferred.width!==e&&(this.preferred.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferred.height}set preferredHeight(e){this.preferred.height!==e&&(this.preferred.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferred.width!==e||this.preferred.height!==t)&&(this.preferred.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(e){this.base.set(e.getBaseWidth(),e.getBaseHeight()),this.preferred.set(e.getPreferredWidth(),e.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return ya}},xp=!1,A8=class{constructor(e=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=t=>{if(t.isMesh){let i;if(t.material.flatShading)switch(t.material.side){case f1:i=this.materialsFlatShadedDoubleSide;break;case Yi:i=this.materialsFlatShadedBackSide;break;default:i=this.materialsFlatShaded;break}else switch(t.material.side){case f1:i=this.materialsDoubleSide;break;case Yi:i=this.materialsBackSide;break;default:i=this.materials;break}this.originalMaterials.set(t,t.material),t.isSkinnedMesh?t.material=i[2]:t.isInstancedMesh?t.material=i[1]:t.material=i[0],++this.meshCount}}}setMaterial(e){if(this.disposeMaterials(),this.material=e,e!==null){let t=this.materials=[e.clone(),e.clone(),e.clone()];for(let i of t)i.uniforms=Object.assign({},e.uniforms),i.side=Or;t[2].skinning=!0,this.materialsBackSide=t.map(i=>{let r=i.clone();return r.uniforms=Object.assign({},e.uniforms),r.side=Yi,r}),this.materialsDoubleSide=t.map(i=>{let r=i.clone();return r.uniforms=Object.assign({},e.uniforms),r.side=f1,r}),this.materialsFlatShaded=t.map(i=>{let r=i.clone();return r.uniforms=Object.assign({},e.uniforms),r.flatShading=!0,r}),this.materialsFlatShadedBackSide=t.map(i=>{let r=i.clone();return r.uniforms=Object.assign({},e.uniforms),r.flatShading=!0,r.side=Yi,r}),this.materialsFlatShadedDoubleSide=t.map(i=>{let r=i.clone();return r.uniforms=Object.assign({},e.uniforms),r.flatShading=!0,r.side=f1,r})}}render(e,t,i){let r=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,xp){let s=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,i);for(let a of s)a[0].material=a[1];this.meshCount!==s.size&&s.clear()}else{let s=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,i),t.overrideMaterial=s}e.shadowMap.enabled=r}disposeMaterials(){if(this.material!==null){let e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return xp}static set workaroundEnabled(e){xp=e}},EW=class extends I1{constructor(e,t,i=null){super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new d5,this.overrideMaterialManager=i===null?null:new A8(i),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){let e=this.overrideMaterialManager;return e!==null?e.material:null}set overrideMaterial(e){let t=this.overrideMaterialManager;e!==null?t!==null?t.setMaterial(e):this.overrideMaterialManager=new A8(e):t!==null&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,i,r,s){let a=this.scene,n=this.camera,o=this.selection,l=n.layers.mask,h=a.background,c=e.shadowMap.autoUpdate,d=this.renderToScreen?null:t;o!==null&&n.layers.set(o.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(a.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(d),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(e,a,n):e.render(a,n),n.layers.mask=l,a.background=h,e.shadowMap.autoUpdate=c}},M8=class extends I1{constructor(e,t,{resolutionScale:i=1,width:r=N1.AUTO_SIZE,height:s=N1.AUTO_SIZE,renderTarget:a}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new EW(e,t,new bv({depthPacking:nv}));let n=this.renderPass;n.skipShadowMapUpdate=!0,n.ignoreBackground=!0;let o=n.getClearPass();o.overrideClearColor=new Je(16777215),o.overrideClearAlpha=1,this.renderTarget=a,this.renderTarget===void 0&&(this.renderTarget=new Rt(1,1,{minFilter:Bt,magFilter:Bt,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let l=this.resolution=new N1(this,r,s,i);l.addEventListener("change",h=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,i,r,s){let a=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,a)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t),this.renderTarget.setSize(i.width,i.height)}},Tt={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},CW="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}",TW="vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}",PW="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}",DW="float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",IW="float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",OW="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}",RW="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}",LW="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}",BW="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}",zW="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}",FW="float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",kW="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}",UW="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}",NW="float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",VW="float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",jW="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}",GW="float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",HW="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}",WW=new Map([[Tt.SKIP,null],[Tt.ADD,CW],[Tt.ALPHA,TW],[Tt.AVERAGE,PW],[Tt.COLOR_BURN,DW],[Tt.COLOR_DODGE,IW],[Tt.DARKEN,OW],[Tt.DIFFERENCE,RW],[Tt.EXCLUSION,LW],[Tt.LIGHTEN,BW],[Tt.MULTIPLY,zW],[Tt.DIVIDE,FW],[Tt.NEGATION,kW],[Tt.NORMAL,UW],[Tt.OVERLAY,NW],[Tt.REFLECT,VW],[Tt.SCREEN,jW],[Tt.SOFT_LIGHT,GW],[Tt.SUBTRACT,HW]]),qW=class extends l1{constructor(e,t=1){super(),this.f=e,this.opacity=new ve(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this.f}set blendFunction(e){this.f=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return WW.get(this.blendFunction)}},cs={NONE:0,DEPTH:1,CONVOLUTION:2},vs=class extends l1{constructor(e,t,{attributes:i=cs.NONE,blendFunction:r=Tt.SCREEN,defines:s=new Map,uniforms:a=new Map,extensions:n=null,vertexShader:o=null}={}){super(),this.name=e,this.renderer=null,this.attributes=i,this.fragmentShader=t,this.vertexShader=o,this.defines=s,this.uniforms=a,this.extensions=n,this.blendMode=new qW(r),this.blendMode.addEventListener("change",l=>this.setChanged())}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e,t=na){}update(e,t,i){}setSize(e,t){}initialize(e,t,i){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t=="object"&&typeof t.dispose=="function"){if(t instanceof ls||t===this.renderer)continue;this[e].dispose()}}}};function E8(e,t,i){for(let r of t){let s="$1"+e+r.charAt(0).toUpperCase()+r.slice(1),a=new RegExp("([^\\.])(\\b"+r+"\\b)","g");for(let n of i.entries())n[1]!==null&&i.set(n[0],n[1].replace(a,s))}}function YW(e,t,i,r,s,a,n){let o=new Map([["fragment",t.getFragmentShader()],["vertex",t.getVertexShader()]]),l=o.get("fragment")!==void 0&&/mainImage/.test(o.get("fragment")),h=o.get("fragment")!==void 0&&/mainUv/.test(o.get("fragment")),c=[],d=[],u=!1,p=!1;if(o.get("fragment")!==void 0){if(!(h&&n&cs.CONVOLUTION)){if(!(!l&&!h)){let f=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,g=Pf.Section;if(h){let v=`	${e}MainUv(UV);
`;i.set(g.FRAGMENT_MAIN_UV,i.get(g.FRAGMENT_MAIN_UV)+v),u=!0}if(o.get("vertex")!==null&&/mainSupport/.test(o.get("vertex"))){let v=`	${e}MainSupport(`;v+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(o.get("vertex"))?`vUv);
`:`);
`,i.set(g.VERTEX_MAIN_SUPPORT,i.get(g.VERTEX_MAIN_SUPPORT)+v),c=c.concat([...o.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(y=>y[1])),d=d.concat(c).concat([...o.get("vertex").matchAll(f)].map(y=>y[1]))}d=d.concat([...o.get("fragment").matchAll(f)].map(v=>v[1])),d=d.concat([...t.defines.keys()].map(v=>v.replace(/\([\w\s,]*\)/g,""))),d=d.concat([...t.uniforms.keys()]),t.uniforms.forEach((v,y)=>a.set(e+y.charAt(0).toUpperCase()+y.slice(1),v)),t.defines.forEach((v,y)=>s.set(e+y.charAt(0).toUpperCase()+y.slice(1),v)),E8(e,d,s),E8(e,d,o);let m=t.blendMode;if(r.set(m.blendFunction,m),l){let v=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,y=`${e}MainImage(color0, UV, `;n&cs.DEPTH&&v.test(o.get("fragment"))&&(y+="depth, ",p=!0),y+=`color1);
	`;let x=e+"BlendOpacity";a.set(x,m.opacity),y+=`color0 = blend${m.blendFunction}(color0, color1, ${x});

	`,i.set(g.FRAGMENT_MAIN_IMAGE,i.get(g.FRAGMENT_MAIN_IMAGE)+y),y=`uniform float ${x};

`,i.set(g.FRAGMENT_HEAD,i.get(g.FRAGMENT_HEAD)+y)}i.set(g.FRAGMENT_HEAD,i.get(g.FRAGMENT_HEAD)+o.get("fragment")+`
`),o.get("vertex")!==null&&i.set(g.VERTEX_HEAD,i.get(g.VERTEX_HEAD)+o.get("vertex")+`
`)}}}return{varyings:c,transformedUv:u,readDepth:p}}var rd=class extends I1{constructor(e,...t){super("EffectPass"),this.fullscreenMaterial=new Pf(null,null,null,e),this.effects=t.sort((i,r)=>r.attributes-i.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){let t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}verifyResources(){let e=this.renderer.capabilities,t=Math.min(e.maxFragmentUniforms,e.maxVertexUniforms);this.uniformCount>t&&""+t+this.uniformCount,t=e.maxVaryings,this.varyingCount>t&&""+t+this.varyingCount}updateMaterial(){let e=Pf.Section,t=new Map([[e.FRAGMENT_HEAD,""],[e.FRAGMENT_MAIN_UV,""],[e.FRAGMENT_MAIN_IMAGE,""],[e.VERTEX_HEAD,""],[e.VERTEX_MAIN_SUPPORT,""]]),i=new Map,r=new Map,s=new Map,a=new Set,n=0,o=0,l=0,h=!1,c=!1;for(let u of this.effects)if(u.blendMode.blendFunction===Tt.SKIP)l|=u.getAttributes()&cs.DEPTH;else if(!(l&u.getAttributes()&cs.CONVOLUTION)){l|=u.getAttributes();let p="e"+n++,f=YW(p,u,t,i,r,s,l);if(o+=f.varyings.length,h=h||f.transformedUv,c=c||f.readDepth,u.extensions!==null)for(let g of u.extensions)a.add(g)}let d=/\bblend\b/g;for(let u of i.values()){let p=u.getShaderCode().replace(d,`blend${u.blendFunction}`);t.set(e.FRAGMENT_HEAD,t.get(e.FRAGMENT_HEAD)+p+`
`)}l&cs.DEPTH?(c&&t.set(e.FRAGMENT_MAIN_IMAGE,`float depth = readDepth(UV);

	`+t.get(e.FRAGMENT_MAIN_IMAGE)),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,h?(t.set(e.FRAGMENT_MAIN_UV,`vec2 transformedUv = vUv;
`+t.get(e.FRAGMENT_MAIN_UV)),r.set("UV","transformedUv")):r.set("UV","vUv"),t.forEach((u,p,f)=>f.set(p,u.trim().replace(/^#/,`
#`))),this.uniformCount=s.size,this.varyingCount=o,this.skipRendering=n===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(t).setExtensions(a).setUniforms(s).setDefines(r)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e,t=na){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(let i of this.effects)i.setDepthTexture(e,t)}render(e,t,i,r,s){for(let a of this.effects)a.update(e,t,r);if(!this.skipRendering||this.renderToScreen){let a=this.fullscreenMaterial;a.inputBuffer=t.texture,a.time+=r,e.setRenderTarget(this.renderToScreen?null:i),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(let i of this.effects)i.setSize(e,t)}initialize(e,t,i){this.renderer=e;for(let r of this.effects)r.initialize(e,t,i),r.addEventListener("change",s=>this.handleEvent(s));this.updateMaterial(),this.verifyResources(),i!==void 0&&i!==y1&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let e of this.effects)e.dispose()}handleEvent(e){switch(e.type){case"change":this.recompile();break}}},XW=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],u5=class extends I1{constructor({resolutionScale:e=.5,width:t=N1.AUTO_SIZE,height:i=N1.AUTO_SIZE,kernelSize:r=Ld.LARGE}={}){super("KawaseBlurPass"),this.renderTargetA=new Rt(1,1,{minFilter:gt,magFilter:gt,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let s=this.resolution=new N1(this,t,i,e);s.addEventListener("change",a=>this.setSize(s.baseWidth,s.baseHeight)),this.blurMaterial=new _8,this.ditheredBlurMaterial=new _8,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=r}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,i,r,s){let a=this.scene,n=this.camera,o=this.renderTargetA,l=this.renderTargetB,h=XW[this.kernelSize],c=this.blurMaterial,d=t,u,p;for(this.fullscreenMaterial=c,u=0,p=h.length-1;u<p;++u){let f=u&1?l:o;c.kernel=h[u],c.inputBuffer=d.texture,e.setRenderTarget(f),e.render(a,n),d=f}this.dithering&&(c=this.ditheredBlurMaterial,this.fullscreenMaterial=c),c.kernel=h[u],c.inputBuffer=d.texture,e.setRenderTarget(this.renderToScreen?null:i),e.render(a,n)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t);let r=i.width,s=i.height;this.renderTargetA.setSize(r,s),this.renderTargetB.setSize(r,s),this.blurMaterial.setSize(r,s),this.ditheredBlurMaterial.setSize(r,s)}initialize(e,t,i){i!==void 0&&(this.renderTargetA.texture.type=i,this.renderTargetB.texture.type=i,i!==y1?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):e.outputEncoding===ft&&(this.renderTargetA.texture.encoding=ft,this.renderTargetB.texture.encoding=ft))}static get AUTO_SIZE(){return N1.AUTO_SIZE}},QW=class extends I1{constructor({width:e=N1.AUTO_SIZE,height:t=N1.AUTO_SIZE,renderTarget:i,luminanceRange:r,colorOutput:s}={}){super("LuminancePass"),this.fullscreenMaterial=new vW(s,r),this.needsSwap=!1,this.renderTarget=i,this.renderTarget===void 0&&(this.renderTarget=new Rt(1,1,{minFilter:gt,magFilter:gt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let a=this.resolution=new N1(this,e,t);a.addEventListener("change",n=>this.setSize(a.baseWidth,a.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,i,r,s){let a=this.fullscreenMaterial;a.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t),this.renderTarget.setSize(i.width,i.height)}initialize(e,t,i){i!==void 0&&i!==y1&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},ZW=class extends I1{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new d5(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,i,r,s){let a=e.getContext(),n=e.state.buffers,o=this.scene,l=this.camera,h=this.clearPass,c=this.inverted?0:1,d=1-c;n.color.setMask(!1),n.depth.setMask(!1),n.color.setLocked(!0),n.depth.setLocked(!0),n.stencil.setTest(!0),n.stencil.setOp(a.REPLACE,a.REPLACE,a.REPLACE),n.stencil.setFunc(a.ALWAYS,c,4294967295),n.stencil.setClear(d),n.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?h.render(e,null):(h.render(e,t),h.render(e,i))),this.renderToScreen?(e.setRenderTarget(null),e.render(o,l)):(e.setRenderTarget(t),e.render(o,l),e.setRenderTarget(i),e.render(o,l)),n.color.setLocked(!1),n.depth.setLocked(!1),n.stencil.setLocked(!1),n.stencil.setFunc(a.EQUAL,1,4294967295),n.stencil.setOp(a.KEEP,a.KEEP,a.KEEP),n.stencil.setLocked(!0)}},nr=class extends I1{constructor(e,t="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=e,this.inputBufferUniform=null,this.setInput(t)}setInput(e){if(this.inputBufferUniform=null,this.fullscreenMaterial!==null){let t=this.fullscreenMaterial.uniforms;t!==void 0&&t[e]!==void 0&&(this.inputBufferUniform=t[e])}}render(e,t,i,r,s){this.inputBufferUniform!==null&&t!==null&&(this.inputBufferUniform.value=t.texture),e.setRenderTarget(this.renderToScreen?null:i),e.render(this.scene,this.camera)}initialize(e,t,i){i!==void 0&&i!==y1&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},bp=1/1e3,KW=1e3,JW=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(e){return this.fixedDeltaEnabled=e,this}isAutoResetEnabled(e){return this.autoReset}setAutoResetEnabled(e){return typeof document<"u"&&document.hidden!==void 0&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=e),this}getDelta(){return this.delta*bp}getFixedDelta(){return this.fixedDelta*bp}setFixedDelta(e){return this.fixedDelta=e*KW,this}getElapsed(){return this.elapsed*bp}getTimescale(){return this.timescale}setTimescale(e){return this.timescale=e,this}update(e){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=e!==void 0?e:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(e){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},Ld={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},$W=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}`,eq=class extends vs{constructor({blendFunction:e=Tt.SCREEN,luminanceThreshold:t=.9,luminanceSmoothing:i=.025,resolutionScale:r=.5,intensity:s=1,width:a=N1.AUTO_SIZE,height:n=N1.AUTO_SIZE,kernelSize:o=Ld.LARGE}={}){super("BloomEffect",$W,{blendFunction:e,uniforms:new Map([["map",new ve(null)],["intensity",new ve(s)]])}),this.renderTarget=new Rt(1,1,{minFilter:gt,magFilter:gt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new QW({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothingFactor=i,this.blurPass=new u5({resolutionScale:r,width:a,height:n,kernelSize:o});let l=this.blurPass.getResolution();l.addEventListener("change",h=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return this.name,1}set distinction(e){this.name}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,i){let r=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(e,t,r),this.blurPass.render(e,r,r)):this.blurPass.render(e,t,r)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t),this.renderTarget.setSize(i.width,i.height),this.luminancePass.resolution.copy(i)}initialize(e,t,i){this.blurPass.initialize(e,t,i),i!==void 0&&(this.renderTarget.texture.type=i,e.outputEncoding===ft&&(this.renderTarget.texture.encoding=ft))}},tq="uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",iq=class extends vs{constructor({blendFunction:e=Tt.NORMAL,brightness:t=0,contrast:i=0}={}){super("BrightnessContrastEffect",tq,{blendFunction:e,uniforms:new Map([["brightness",new ve(t)],["contrast",new ve(i)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(e){this.uniforms.get("brightness").value=e}getBrightness(e){return this.brightness}setBrightness(e){this.brightness=e}get contrast(){return this.uniforms.get("contrast").value}set contrast(e){this.uniforms.get("contrast").value=e}getContrast(e){return this.contrast}setContrast(e){this.contrast=e}},rq="void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",sq=class extends vs{constructor(e=Tt.NORMAL){super("ColorAverageEffect",rq,{blendFunction:e})}},aq="varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",nq="uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",oq=class extends vs{constructor({blendFunction:e=Tt.NORMAL,offset:t=new j(.001,5e-4)}={}){super("ChromaticAberrationEffect",aq,{vertexShader:nq,blendFunction:e,attributes:cs.CONVOLUTION,uniforms:new Map([["offset",new ve(t)]])})}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}},lq=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}`,hq=class extends vs{constructor(e,{blendFunction:t=Tt.NORMAL,worldFocusDistance:i,worldFocusRange:r,focusDistance:s=0,focalLength:a=.1,focusRange:n=a,bokehScale:o=1,width:l=N1.AUTO_SIZE,height:h=N1.AUTO_SIZE}={}){super("DepthOfFieldEffect",lq,{blendFunction:t,attributes:cs.DEPTH,uniforms:new Map([["nearColorBuffer",new ve(null)],["farColorBuffer",new ve(null)],["nearCoCBuffer",new ve(null)],["scale",new ve(1)]])}),this.camera=e,this.renderTarget=new Rt(1,1,{minFilter:gt,magFilter:gt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new nr(new aW(e));let c=this.cocMaterial;c.focusDistance=s,c.focusRange=n,i!==void 0&&(c.worldFocusDistance=i),r!==void 0&&(c.worldFocusRange=r),this.blurPass=new u5({kernelSize:Ld.MEDIUM,width:l,height:h});let d=this.blurPass.getResolution();d.addEventListener("change",p=>this.setSize(d.getBaseWidth(),d.getBaseHeight())),this.maskPass=new nr(new xW(this.renderTargetCoC.texture));let u=this.maskPass.fullscreenMaterial;u.maskFunction=Fb.MULTIPLY,u.colorChannel=zb.GREEN,this.bokehNearBasePass=new nr(new O0(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new nr(new O0(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new nr(new O0(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new nr(new O0(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=o}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(e){let t=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let i of t)i.fullscreenMaterial.setScale(e);this.maskPass.fullscreenMaterial.setStrength(e),this.uniforms.get("scale").value=e}getBokehScale(){return this.bokehScale}setBokehScale(e){this.bokehScale=e}getTarget(){return this.target}setTarget(e){this.target=e}calculateFocusDistance(e){let t=this.camera,i=t.position.distanceTo(e);return Tf(-i,t.near,t.far)}setDepthTexture(e,t=na){this.circleOfConfusionMaterial.depthBuffer=e,this.circleOfConfusionMaterial.depthPacking=t}update(e,t,i){let r=this.renderTarget,s=this.renderTargetCoC,a=this.renderTargetCoCBlurred,n=this.renderTargetMasked;if(this.target!==null){let o=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=o}this.cocPass.render(e,null,s),this.blurPass.render(e,s,a),this.maskPass.render(e,t,n),this.bokehFarBasePass.render(e,n,r),this.bokehFarFillPass.render(e,r,this.renderTargetFar),this.bokehNearBasePass.render(e,t,r),this.bokehNearFillPass.render(e,r,this.renderTargetNear)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t);let r=i.width,s=i.height,a=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];a.push(this.renderTargetCoC,this.renderTargetMasked),a.forEach(n=>n.setSize(e,t)),a=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],a.forEach(n=>n.setSize(r,s)),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(n=>n.fullscreenMaterial.setSize(r,s))}initialize(e,t,i){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(r=>r.initialize(e,t,i)),this.blurPass.initialize(e,t,y1),i!==void 0&&(this.renderTarget.texture.type=i,this.renderTargetNear.texture.type=i,this.renderTargetFar.texture.type=i,this.renderTargetMasked.texture.type=i,e.outputEncoding===ft&&(this.renderTarget.texture.encoding=ft,this.renderTargetNear.texture.encoding=ft,this.renderTargetFar.texture.encoding=ft,this.renderTargetMasked.texture.encoding=ft))}};new E;new we;var cq="uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",dq=class extends vs{constructor({blendFunction:e=Tt.NORMAL,hue:t=0,saturation:i=0}={}){super("HueSaturationEffect",cq,{blendFunction:e,uniforms:new Map([["hue",new ve(new E)],["saturation",new ve(i)]])}),this.hue=t}get saturation(){return this.uniforms.get("saturation").value}set saturation(e){this.uniforms.get("saturation").value=e}getSaturation(){return this.saturation}setSaturation(e){this.saturation=e}get hue(){let e=this.uniforms.get("hue").value;return Math.acos((e.x*3-1)/2)}set hue(e){let t=Math.sin(e),i=Math.cos(e);this.uniforms.get("hue").value.set((2*i+1)/3,(-Math.sqrt(3)*t-i+1)/3,(Math.sqrt(3)*t-i+1)/3)}getHue(){return this.hue}setHue(e){this.hue=e}};new Je;var uq=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,pq=class extends vs{constructor({blendFunction:e=Tt.SCREEN,premultiply:t=!1}={}){super("NoiseEffect",uq,{blendFunction:e}),this.premultiply=t}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(e){this.premultiply=e}},fq="uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",mq=class extends vs{constructor(e=30){super("PixelationEffect",fq,{uniforms:new Map([["active",new ve(!1)],["d",new ve(new j)]])}),this.resolution=new j,this.d=0,this.granularity=e}get granularity(){return this.d}set granularity(e){let t=Math.floor(e);t%2>0&&(t+=1),this.d=t,this.uniforms.get("active").value=t>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(e){this.granularity=e}setSize(e,t){this.resolution.set(e,t),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}};new E;new E;var C8="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",T8="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAYAAAABNmBHAAAgAElEQVR4Xuy9CbhlV1ktOvbpq09DkiIkUBI6kxASIH0DlAQiIK1wRfSJTx+i4JX7vKIigs8HXpXvqVcvrcC9agQ7IDTSSWgqCQQliDRBJKkkhDSkqVPNqVOnP+8b//rH3P+eZ+199tlznVTlvVrft7+1T7OaueZY42/m37QALKNk2wHg1pITlB17mC+Pp11W3X/LHyT32vhg48/5SOv+PnwpsHA70JoGlueB1iKApeqzvOzn44GatTB76Xzhd7suBR7+WWADgDEAwwCG/L54b/poDLrHuvvm70Z2Avhsc+PVcxscBU8F8C8ADg5+ipIjD/PlGwfgju8B924E5seARUfLsiNmqQW0IjL8+7L2NYD/7COBzfcCm+aB8SVgdAkYIRCXKyDax4EdAanL5PuNPllNvXDlAHwFgP8AcC2AhRIoDXbsYb48dl5WkVFTE3LGDcC9m4CZCWBuFFgeAZaGAYJQQCRqDHT+McJrVb8zwATUXH02MHYfMHEIGFsAxgjApQqACYQORjtd/B7Axt/z79sC0+cMPgjjlwPwVwHcA+DfAHzTxcVgWBroqMN8+cYBeM71wH0TwKExYHYUWCIAHYRLTlkCYgcIBcAgU/n3qy8GRu4HRgnAOWBkERhddPAJhGJDBxkvw7cqimr+zFM/ZLnZF64cgL8BYD+AWwB8x/dlWuWagHiYL984AJ/0RWBy1AE4AizyM1yxYAcTigW55xMbAkxEiwEdkJ/ZCQxPAiOHgBECcKEC4TBZcKkSv+mTieNcNPNC26mLNsj45QD8LQDTAO4GcJt/7iw2bfoG4WG+vAGwm9ExiEg69zpg/wgwPQLMjgALzn4E4aIzoJjQ9g4024uygkj+pyuAoX0VAIfngOH5NgCHMhAm8Sv2y3XDZeBhNIp8OzJE8OsBzAKYBHAXgDt8/4O+MVT0j4f58o0D8Pxrgf3DwMwIMEPQEYRkNwfgsuuDZLskip0No0gWMD/9HGDoADAkAC4Aw/wsAgZAgs2Z0ABI0GU6IVmKv+f28KDnHxkA/G0A8y6G73N9kOCjXnh/Ebb6OvgwX75xAF5wLTA1VIHPADgMLDj4yIA5AAm6aCUnv4oz46eeDwxNAUMzwJAz4BABSNDFTwSfg7DDKHE23MG5PqIY8A1u/dINs9dBdy8AgnGPM2NfUBrsnw7z5RsH4IXXAAcJviFgluAbygBINnSLWOAjGxJ4pgOKDV0v/OSLKp8iGXBovhLBBOCQM2ACoTOhnYrAdItYbCij5JFzRyIAqRccAnDAQUjg6UNQ7hsMXP0cRQAexss3DsCLCECCLwCQzMcPwUi2MwAScAKbfnY/YRLFQ8DHX+IAJAMSfDkAF13kLvleIjhjQQHxUVS3jjgGpKeeNzYVQEjgUS8k+PghONdhIwAP4+XXBYCHKIJbwJyDTgaIAdCBJx3Q2M8tYAHP9m4df/ylQOsQ0JqtRLCx30K1wtLBggScQOgsKBGcWHAJeOwRC0BSM1mQIKRbhh+Bj98JQP6t4U0APEyXXxcAEnxkQAFwoVUxID9kvQg+c1C7vidRbIDkc24B//hTQGumDcCWA5DgMxASdNIFBUI5pCML8v8API5zfEQx4BudgqiczviSnJhQwCP4BMCGl+wO8+U7AJi/W4O4YS6+pmK/2ciADsAOBhTIIiAJnPB7AvNjP+0AnANaYkAHX2JBAc+tYaJXOqBZv24Vc386XW5dtkHGW+4HFAJonpOe+YYQZAShgKjv3PNvPQaxVoI8zJdfFwASfPzMUwS3Kt1v0UFIlos6oDFdAGFcliMAP/ryAEAGNwQRnDOgLbdlIEwrIs6AZ/QgkMMHQF6ZAKQcJAsSYPwIeAIk9wJgoPK1gi7+PwF4GC/fOAAvIQPSs0URTPBJ/Pp3GSEGRHfBCIQ0xowBtUbcAj7ys5X4Jfu1HIAGQrIgQRXEsAFQIORDFhiDY/rMHmrU4QUgR08AkgUjCAW6CD6CkwBsAIQC4GG6fPMA3OXiNzCg2I9gNCMksmAAoemDzoimFwL48M85AKkiuQVMAAp8CYRRDAt8GQiJ67N6GJODAXAHlsGguscA2AJg1IPGYmxOpBxFWkRN9LsATgIwXnNs/v/5z/9XCf8BO3YAtxbc/46/KDt+5+ea1Yku2VUxHz/z0v24FwMGK1gWsK2OUUxHHdCBeRUB6OxHABr4ZICIBd0QWSF+XRdMTAjgCdTrG9cBNwE4F8CpDkICyYLGsuhFt6zs+gISwUen8zEAjgMw4cfx2H6O/90yAFo84Cbg4ID3/9TfLTt+5+ebnRABkODjx0SwPi5ec/FrYpmqSAxM8Dn60CsqAFI6GfhqAMiDE/gokmvEr0C4PgDkBQm40wE8zMFEUDKEVoxIMLl/KS73mE7H9d+vcKHQQcjwW0Yu9nP8m8sAmOIBuWY6wP2/4s0ezjjg8TuvaR6ABJ70vxUApGrm7EbGE+i472BAB+WHfqHS/eoAaEwY2E9+wLSXTqhI7CXgnB6LCoOJ4BiST+hTnG0HcCwAglCx3ARoZEVFXnBPp/O/A/hXACc7CPs9/i1lAOyIB+RDX+P9/+pbQjjjAMfv/PL6AFDs1wFAgs/9fgKfgdE/ZEpuiQlbwAde6QAMBgiRmsSwA9BY0JfjovGRDBMH4TlcXGhcBOc6HkF0gjPhZgchxTLZMAci/04W/B6Ab3t09EPXcPyflgFwRTwgJ2MN9/8bf5qFM67x+B/aW4XQz42FeL0YrRyikztUFw0704mf9kXgxhOAqc3AAsPyRxxQCs/PdXOFY0W1KHy3QIUGtx+6vdnx1vsB+dsTncm2AogglFgVEAlUWrOMB2RyEmMCGQ/Y7/HvKns6tfGAnJQ+r/9b76oJZ1zD8WdyQjYBh8aBhVEHjELouQ8ukQ7VRSCJAALwkr+sALhnGzDD3JAJYJHg9uhoi4bx8ytkWUtvHT/7+Zc4dw1uZ3612fH2dkQf7yxIEEockwkJQn4IQoq8unhAhmPRKKFx0uv4K8ueTs94wD7u//VX9ghn7OP4c+4G7h8HpseB+dF2AKlFLwuAIZ8jD6NPrOhAffmfA9/ZBuzZCkyRWSeqBCWyoYGQ5yQrBpDbum/ME1HoPo0XEkSD2zlfbna8q6+EUJcTCxKEtHL5EQjP6BEPyIgYAZBvYt3xHyx7OqvGA65y/7/9wVXCGVc5/sl7qxD66dEqiYgRzAqhN1A4CBNAAlDyAFI+iZ9/N3DLJuC+jcDUBmCWyUnOrmTYCMIOkNclLg0B8/RsNLg9+UvNjnd1APLmmQpFHyEBROuWACQT8nN+H/GAvY7/VNnT6SsesMf13/CpahGnZzhjj+PPmwX2MYdDIfQexWyBAwEUOQDrRDN/98p3A7dvAO6fAA5sqHJDBEAyoUVGkwEd6HR12XU4kwzfl6fCXTZzjy57vvnR513X7Hj7AyDvggAUi9EyFgiZqNxPQF6345nOWbD1HQ/Y5fpvuLa/2+82/vNHgAPDFQDnhoF5j2C2qBWCI8bw1eRw5CL5l94L3DEOTI4DB8Y9OWmsEu/zBJ3rgsaybqBob/7A4C7jtWcooRrczr+u2fH2D0AOQgAUCxKEP7aGgLy64+m6KdjWFA9Yc/03/Osa4glrjr+AupqHz1sEs0cxG0BC9HIePLoit9eNkVf9L+DuUWByDJgaq4ybGYLPAWgiXmLedUE7dwC7saL7CqfPKXi4NYdaykCD410bAHlDEsNiwZ9wAPYbkJcfz6T2gm3N8YDZ9d/wHxUA+739fPwXPrSKYGb+BuP3jAFDElFH9HIWwbzCIGkBr/or4J4RYO8oMOW6ZVcAuvi1Cgoha04BCwT5gfMKHm7NoRde2+x41w5A3hQZkADk5+cGiAeMx3+/7AENFA8Yrv/G71cAXFM4Yzj+otOAaQLQA0gZxaIIZtMDFTigKJV8H9Iq6aZ59ZXAvSPAvpEKgBTtBODcSCWCZeRYtpzrmLyeGNCAyFl1v+Hei8qeb370Rdc2O97BAMi7EgB/2QG41nhAHU9LuWAbOB7Qr//GPRUA13r7Gv9FZwIMoVcEswEwfDoimEP0shKKtIphaZQAXv1+YM+wA3DEdcvRKkGJADQQEsQuhi1Tjt95vBsh5nx2IO59SsHDrTmUOStNjndwAAqEry0IyCMICkOyiuIBNwBvPFQQT7gBuPjc9oRYAIHyOEL4vIFEYVNaOou5vCGE/tV/A0wOVcnpzI47NOri3QFIBpSeaSDUdYLOSWvYImSGgftpJDa4MWJbAGxivGUA5MAOc0Be6eVLj7/4Mk+hzCOYPYpZDBiNkLh+G/M3yFyv/ltgL3W3YQfgcFUhgRY2PwY+Z7/EhAR1SFyXCOb57r28QfQBsJQBMn5D4y0HYLPje9Cd7RIC0PM3EiMofF4gVCBp1P840ix/gyz56r+vAMjk9Gl375iB4+CzveuZdLkkEPJ8ZEfX/6R73vOjzT5Si9hucLxHAVg4PwJgRwh9CKOXK8YA4ZEqKZXSQWh5P+5AftXfA/uGKvYjCKn72cctbFrZNECka5L5CPwIPtMH3TVz17MLB5gdLgA2Nd6jACycHwLQxFEUSR5ASvARDB0h9AQb9bXIgCGk6lUfAPYTgEPAITKgg1BObk58srTJgG58WMkWMaAbQQT1nc8rHGANAJsc71EAFs4PAagQestgC1lsBJ4BMCSOK6dDUcwqqaFiQr/0QeAAAdjy+jBiQQeeMSBZT3nCPUDIa9z+/MIB1gCwyfEeBWDh/BCAeQSzgkjFfGLBBD5nxQ4DxN0wv3hVxX5TBGDwL5obxvVA5YqYL5BeMLd66YYxJpRB0gK+96LCAdYAsMnxHgVg4fwIgMrhUPKQ2C+Bz0PmBTqBMQehAbDlIjj4F80KJguSVZ0FuXpjoCOgXawLjALhbT9eOMAuAGxqvEcBWDg/l1IE05Ed0ygZnyHdz0VwCqEPIfNyx0QQvvLDFQCp+8nfZk5und8tXwIgWcHSNX0N2CJmnAl3v6RwgNnhl17T7HiPArBwfghAS7mV/hey2JS9FvM3BLpUUi1YwDRMXvkRYJoAlAh2l0dcZ04s6JUTDIjyBcrl4yDc/dLCAdYAsMnxHgVg4fxwKVwJgGEJNmWtxpQMpX9on2eRhVA+O56AjMfnP+e3Xvf3NwG4xIPTleiY55bpGh6UbafNU0l0z0p+5Jh5HqYJ6b51nP6XP8cx12XNHQVgIQB/bFPVg2OC7Q+WgVFWng/FvtWLI06uWh5oguKEcXVS/9sEAF//VGD7t4ETDgJbF4CNi8CGZWBs2fPL/H6Vwp2KEtVk4fJ+v/EIYPN9wKa5qu+IncfPwXHVZe/aOL3EbwS7xv8A1rQvnO0j8PArTgTGZ4BxFv9mIxhOCGsv+0OPYDRghcLfkWkEuq0+G00x4OtfDGz+d2DbHmDLjL8si8AYP/7CGIAiEEMTG92zXqSbH+d9R2aA0XnvO+JjthiIrOVDHHPOkBrzUQAWAPsZp3oPDpa/Xag6EVkLBK+5rAnJC3/nYk/APD704WiEAV8OTHwX2LQH2DgFbJgFNrBhjd8r79deGoEwsllgNBOzy8CdjweG9wBj08AIAci2D6HafmyAk4/Z7SJ72hGYRwFYAMDLTwOGp4FRFgD3HhzqRGQiyeurqOdG6r0Rm8IEZjzRlkiqCWoEgK8Axm4BJu4HJhyAbFhDxmbDGnZO4j0SgLGDkpibgEq66TJw/1nA0F5gdLpq+zDqFfd5LMeWqu5HNST0uJOIllg+qgMWgI+HPv0xwLA3gWHpW2sC441gCECbmKziaGrnUdMO4aHeh6MxAP4SMHI7ML4HGD8AjHvHJGNAgpDgY/ck3stipRemvVhc+uASMPUEYGh/9dIRgGx8Y+MNbR/00uVtH0wEx94j/v0oAxaA8Ed+GBieAYZZg5kADC0QWGOFzGJlcGPzl1BxNLXD8sk4xftwNAbA/wwM3wGMUmxOOQBnHXzetIYvibonmSiuYTNjriVg7glAiwBk0fNZH6+PmX9P6kfNmCXGpftJ7TgKwBIAnln14BAAYxMYm5C6RjCyCoOyr0qkD/c+HI0B8DXA8N3AyCQwesD1VQKH7EcASm1Q+y4CkN9pUKiVF5nLvy+fBbTUd8QBaH1HvNBROiZvfsNnrF4kcvPwpdsBLBeU18Nf7AB23Dp4ecHC8oBgUlJJecLS+7+WOpE3gbE+HKw+yoevCYkMGKqPJrdEKARutaFYRs1fiEZ0wP8CDN8LDO8FRqYq3W10pgKgfYLaYCzootgA6KXaTA90y374TKB1sBozy77xHFZ536utRgAmEaw6g5kUSFZwSXnA330qsOlfgHMPDlZesLA8IOjoLypPWHj/11EnCiVwkz7kAExtsGraYUWdSDX5TmsagL8KDBGA7Bd30JsW0oWivnEOQNP7yGTSBR101AlZSUtGyfgZDkCWY1HnJdcBVe6325hTvelg2CQjZNDygG/2An0j1wKnL6y9vGBheUC8prQ8YeH9X39OVQSc7Mc6fCaKvAeHdCIVf4yMYCynTpX+nb97NJmlSQb8r8DQHm9YOFUZTKOzoXGhs6AxF0HIexcLBvWBuiHN8s2ne98R3qc6L4Vyb2oBVjfm9MIFHbjDCh6kPOBbQoG+oW8CO5bWVl6wsDwgfr20PGHh/X/1iaEIuDcCTIW/1Q4rFv8OnYiW3c+W2iKwUjKbyjQNwL1uuR6sAEgDgq1brXOmV81PxhNB6DUDBSYzQJwFtz623XcktX1Q1VWKaTF/zZhVazBVYA1tX5MazsGvobwe/jQr0Ne6BTh5uf/ygoXlAfG60vKEhff/rSe1i4DnTWDUACY1guFTDqLYdCBvf6DJYSMYATBfOx1kLfj1v1axH10nQ3Sd0GUkBnTfpemtBJgseIKQAHLQcVxa2TnuMW0Aqui5es8xBIegVdVVE8VhzHnLh65WMB9An+X18K6aAn2tO4ETl6vqbKuVFywsDwhevqg8YeH93/Rk70JE90nowxZbIJjvS3WYNSGUwGHJTpPxwwcbBuBrgRYBeKACn7VtpdUu/c0NJxO9BIxcKu4TTODzbkonPLoaL0vyUQRb2y8HsL1ckfWzMeuFi40Qezqi+yiPhyt7FOjr6/gCFwgP7Xb5vssTFt7/nQRg6MGRWmDRoeyTlpgw68GRTwgZgo1gGmXAX6/8dtaylSKY/koyID9BhzML3q1gAos2AcOrZYSoq/pJp1VtODRm9Z3LS/7WjVkvXOzEtOpKyGrlAT+4SoG+VY8vBGCvy/dVnrDw/vee65NBJiAjBIVcAJQjOm+DkCZEeiGAMw6sAwDZsJrAdhFM9rPGhd4904Co5oVuCZPV6kD40Ec6+9W8dBTBsfdc3nkpvnB82fp2RPcs79dHgb51LA9ofsDV6vut5/3PnxcAmLVBiDqgevDaJLkYrpuQxzcNwN8AWgIgRbB8loEBzXDwl4cGiDGft58SCOWGedgjvOJ+bPvgRkiuA+ZjzhnQQOiFNVbloa7l/fos0LdO5QENgEXlCfs8Qbf7HyMA3QVjYihYhLENgjX9y/qwxQmRU/asfd0ZcLU2CHVGyusJQLKfVi98CS12T5f7iECkHpsMkAhCF8+nshWH2I/jXsOYO144GV/9ApAIrS3vt4YCfetQHtAA2G+/4PW4/2PPbzMgmUMi2NoeSCRxIt2/FvuxWURIWCXg357gfTjEDNIHnTRXRCpH5ugKwGl3HpMBXQc0v6WLYVm/5limj04rG762K2uYY9jBkr9+rI03NL5ZbczS/dJ+LQyoga4o77fGAn0NlwdMAOy3vl/T938KAcj121z8Bn+Y9eWQJRz8Y6kNagDh2ey5EvxjxQD8TWdAuneCCO4An1vw5vdzQMmdktwq7pLZQR+dM34+ZumAxvY1Y04uqOAJ6FsExzeto7zfAAX6GiwPaLWR1lrfr8n7f/Rl3QGzmsis+/uO71V9OFgP2gpPhgr7TGRqRUT6dyvr4aIs/pm/2zVUNbBSv6G8e5pEv0Cvec7Po7+bTtjlBRlkvAMBkDeQyvsNWKCvofKACYBrre/X1P0/oWEAnnFD1YdjhtXxR73mX10FfCHHE9pVWcGAI/S0gKsfA2y+twrFZw6Hxf/F0Pk8Ri/kpGSnMuDx5T0iACgQHioo0NdAecBUHW6QdsV2/cL7v/Cyqr5gnc42CCOcfX1VIZ/V8We9IDmTzVXwPDJiXuKXPxtDBma8+lzP4WAgKkPxCUAPE4v5GzEuMX0PYJPLhB6FJsc7MAMmkVxaYC/K9gG+F1++8AQ7Gwbgk78I7GFpXgIwFiRXOwaJZPUbiR0yCUDRk+cHf+YpwMj9HgfI8ClGPyvsSiH0WSKRuYlitLb/zHM/JOSs5C/YIC9cMQDZr/dwxgOW9gtGYUBi0wA8l304vDQvAchilFbpIBQhZ7Ejq6ZQ0/Yhil8y4j89Axie9DAsD6FX9HOK3QtROTFkviN83kG4felIY8DCeLrSeMDSfsEovAECUFsTjHD+tcB+tkFgcXKvBRir7qtFl9owmO4Xy/1G3bAFfPrZHorFNWBFwHjQAFctIghj2kBarw06If/+MM9ZqTN6DgsDojCerjQesLRfMApvoGkAWh8Ob/tgAPSKWCp8ngNQtadjmTdltvNvn3peFYhgQQgh+iUmEaUAUoXM1yRLmWuFLaE9Z+XIAWBhPF1pPGBpv2AU3kDTALzwmqo6qtVh9kJErAudABia38TC5wJgS2xIhAwBn3yhByL4EhzXfRXxYsDTJ4IvrNN2JFMxZcBzVo4cABbG05XGA5b2C0bhDTQNQLZBYH1AVsQSAAU+imI1obHyblnjG/kJk3U8BHz8xVUQAhnQIl5CyNgKAGp5LKSSCoAySh5Jj79vTagcxUaIBeRNe79g9gq+DXig4wGzy+PONfT7RWFA4noAkGXZVAhcBckJQgNgrLiaNb3paIDo1vHHX+oA9LQBi4DxJcOUPJUnTgU2NJUyROs8irGARxQAC+PpCtsFd40H/AEf0gMQkLgeACT41PiGoLOKqyrJq3K/Ya9mNyr5FusN/uPLPIeDa8Bc+w3rtyl4VFHaMZc3i9RWBM9jjzgAFsbTFbYLRmm/YBTeQNMAtD4cBKDXBTQGdAB2MGBo8SCLmEuS1AFVAJ3A/NhPt0PoCcA8bSDG76XI7aySg6JYuGfKwJHFgH0E5B3ueMCe/Y4L+xVHAOZ+9EHcEgQgwbeiEYx6jwTdz4qfu7EhEJqxGqruf/RnHIAEnxgwBM0aC8aUAYWNBRCmoIll4HTqO122QcZbrgMWxtMVtgvuOx6wa7/jwhtoGoDWh4MBJ16WN4lfr8AqI0TVV1O1fa9BbQzovkAy4Ed+NgCQUSxZCFWvCOaOFREXyUwZOPIA2GdA3uGOB6wPaOz+QPv5S+MA3OXiN9aclghW+d3IgupBF2pPqxcxGenDPxfSRh2ASiKKiVP2PaZScvAKoA0VDc6cOlIB2GdA3uGOB1zR77iwX/F6AFB9ONSOQW0frA50sILVcckWJyIDSgwPAVcJgFbYuZ3FJvAlEHbJ3IsgJLGedeBIA+AAAXmHOx6wo99xYb/i9QKg2iAIfDJEJHqj4SExbEty0gkdhB/6P9oZbBZIGiKYVb9GKaN50lRHBLOvhDxh/5EKwDUG5B3ueMB2QGM/grb7/6wHAPNGMAY+GSGUjC52VX2f2CD4+HO0gqkZfegXKgBaHkcWtS0AWii9xG1ImrLlN5XR8L8fmQD05BVrmEENmpYSP9QX+KHiqj2/82+HqqDWwnbBRfGATdzAegGwru2DpRq7Mzq2fpAf0Nq0Rl2wBXzglZ4yUAPAmDSVWDBPHQjLcgTqOZ6zUvdKHh4ruDCerox/Dnu7YqwXAC1NI/QcEQuK6WK/kdgCTGC0PYAP/KIDMBgglq+hIkrOfsaCviLSofcJgJ5AdM7kkSaCj/HqQKVIGvD4swF8bcBjmzjsaQ2H5D/6acBd9wALB4DFWWB5AVherMp4GKIYEOp7+26UF0aSfT/xYuDG7wDjrIpAERytXf2vajj7ueryQXSFl10K/ON3gIWDwCLvjfGB8Z54O+Ee4ve6513uB2R1yzsqC+twbC8HcNVhfAeaBuDP/TvwtS3A/ePAIfYFVlPq2HHTuyulZCTlhbjhETF5yxTQGgPGhoHhIWC4VSXGD3n0tLkMHXHxu+YyB+MlPwDuZs5K6FlsbCzdVO9DuKfkHM8AEkP7B8fOkwDcD+B7np42+JkGOvKdAL4E4K8P0zvQdET0b14D3DgB3D0B7B8HZka9WzrD88N6sFm+YcUjrn7E1ZDvMtF9DBgeAYaHgSGB0PNHCD4BLwLRsByAyX/ij0/dDUxuqlIG5hix7eFhvLcOVUAtyPSydAFmOQNe6EYGV/9ZESiKgIEgtbaD/gHALQC4ovY5r5KwtjOU/XfTAHzzLuCmIeDuMWDvKHBwpMoN0WQzNtAaYSs0K4ZlOSAjGG9kPjCBRwZ0ABKEBJexYAZEAU3A7Oi1BeDym4EDnjQ1TwCGWMW8MXcKks0YOyZNlQOQjcgYIUHllEzYQ0ktm+r6oz8G4F4AXwXwRd8/kO9A0wB8y65KmPxgGJgcqYJTKYpTv2CCzyddQJRDOjKivn+Deh8BF8BnwBtaCUA+YYEyAU8h+c6Az9gNHHRmrgOgmDA3jHQ+iWupCeUAvNSrA9HNwqx+muk9nJVNg/CTfrmbAPwbgK8D+PcHkIibjob5o13A3XypWsAkG1cPA9PDFQDZM1id0i1KxsWfOrKnAFXlifCFFMMRcASigOcs2MGAIfE9iWXplS6On7UbmPaUUTXQrgsVMzcRj5Folg2V5ayUA5BWYKwOxKUafnosWjcJwk+7W5F2EKvlE3xcXaNYfiCYsGkA/smuqug6hcleAnAImPbO6YwRpMgjCAVAm/yQmKTv5hNsAf/i7SyNBSl2a8Qv/4/M1yF+BZSYlNQCnnVrpbC+mToAACAASURBVJcaI7sOSEY2NpaDXLqpR+vE/OVksDgImgGgghHoYJbTWc7oJtFWc65/cg2AYvh2ALsB3AzgVv95nS/f4QdsIkT9T3cBrGtITWZfC5hqtQHInsEGQn3UDDvEDEY/ICf7SxMOrAg8T+c00JGkvHGd2DABUYZIAONzCUDppCFhSukCBsLQrFtZe/IixYQpSyEoJoqnuPWrVRAubQh83HNlZB23z7j1ywmj6CIIqUPxw2Xeu9bx2jx10wz4Z7sqTYZaDD8EIDuoE3hMVEphWg66JIp90k0sBxBcy+iPIIaT1RtEsHS/yIAqw+VSNPWQfe5tlVEk8auXgVa5BUsEJuT5uoliAbE5AGotmIAjCPnR9xDG3TQernYAUupTdBGEFMf83OkApHG+XlvTAPwfuyrgSZOhas3u6cwTsUBVn2gTwyFMi8wjHZAA1M9fYGHDULJD1m8Cpa8fRxDad+l+Ykf/3XNvd11U+qiL39SxXevSsshdDFvgbI1O2AwAtRZMZzTBRuDFjxe1Xg8QEIB8yyj5yYIUxfQIkfkIRnmHCM712JoG4FsdgHHp3ACoMH2G6jM4lWzoQarSvwQ6MSB/vporVaFkh+mCLlpVR8Z+dqDZLoDOpHSiQeAFDkBjPrlgCHgCUaFifg67H/9uYjn4Ai1vpTERTAASBaoQJBAKeNqHlL6mwPDZYAOROag/EYRkPX34MwHIvzW9rQcA+TLpI22G7EcQKlJGsYIJhC6ClUMiXfBTbFUQAej6nPS/OuAl9pOOqIc2BLzg++3VmWgIEUz82cRuCAtLIHQQm0gO52uOAb22sC3JEWgRfPpZf2sQBQIgLydPEIFGwPEj8MlF2bSbsulghLftqsCXq9HGgHysznrGgi5qzTUTFH8FLhAUn3hIJwCN0HLncw37qaF2zoYvuKNivmQIuUNc7GvWt6sHNs26twA6vhyq8NEMAHlyntFrDCcQehyaPTl+FwAbXDcmAKMRThakEk8Q8kPg8SPL0qzLBl+A9QCgR6uZGs3vfHz8TtBZvkgGQrEPBVAUg2Sij50QAOjiVKI3saADJRm7dSLYWfSFDkCem/dhZeMy9pPY5QvSDYQyUJoDIK8qMezh3wY6fSL49PcGgCAA8pScJLIgAUYQEmz8RPA17StvGoBv39W24eREiBoNQSgWNI1HBkdgxJSw1AI+dFIbgOYmkjimQ1r6XXC3rAbCHycAgytohf8vsB/r2KRaRq7zpZ+D37HMX0s3DDcCUGLYaw53MJ4YUODzusqlGCQAOQCejuxA8UULUkxIwAmMAp8Wa3qkN/R9W+sBwOhIEPjk5SLr8HeKFbTQfb77csPIMHGl/4MPbReslPhNe4+MiTpi9AFGV4nI7MfvagNQLh/pfrYnDAS8aJQ42A2w4em2cAyWQUuJVQTGWLs1uL7DG9J1RjhA+jvYk4t3KXeMqijpzrud4At9z3XtP16yGfjKZmCGooYh1tZzvv8xXPFl4PoJYC97k9FlwZWD+Azi/deMZWeP13eQCGEyoERudChIjbb3mJYwH7V0QIKuCwj/gfMj0asn2I0FXRSHXfL/iRkNgLyeVj8ccMY//J1fyxzTAXT2+xoQViKYD/1hDqLxPiYxTgSvQrphphG97tz4Slqafnj7uk1kIQDZrvWTw8B3jwEW+RLxPgSiCERdPwPR7+wCPg/gulFgfruDkOMQkFc5x84e708JAMmCuRNBXi4TIg5CGRzGiBGE/D4E/C2r2vcAYJoify62i0aJSMhB+2IHoNwu0fkcjQ85pu3ack5nIBREqneYFyWLkAXIJHESe00Cyx5QyeL6F/tyEcDcrOW2n7fX8df0mME+/vQ/PQjhoy3gzo3AISYf80MQaQx1peH9wb7v2mrtmCBkIMMejp3jIJD1MsaxaMZ8v5N/67INAsB3BAYU4JL4DSo1J15AFPAEwuQHZJzkKfUAtOHLJSOQRWndBYQvCQA01cfnNopfsaCJaD2baBn79QjSTiOEP1EcawIpkq2kegBTNgHWEpOKF8Uwq2NRFPM4AqCf46/rA2U9/uVDvurB01zvAJpiiwOl3fEeciCGF+Ij11f+QkbSfMPfIzqw57mEFZ9Dl3Ps5HXWAYByHJAJKV7N+s0cCQQhwSlfm4lGZ0KB8C/rABgZUS6ZHITBSEhCowUYAAksF7cStWREyxRwtuPpOlgw+5s9sq6OaIJIIlUgEhA1edoTgHxa9HVw5jibZNF+j/9yGQA/7pbujZ4bwv2+cWB6tFo0NzYnkxFA+cvEAo43VBoEo2e+48EMXEOmD9F6xhCE8RwZEJ80VblKvDlmzwicfqy93/o+8K8TwB2jVSgW138FrJQTXBNlnJgmrjZwanow9CBP/rL9wF0jwAGWDtFyoN9PHutnIHT05mPXz93dMGQAPniJsjiBXiTbxDZFMF9NLUPQxKR5qezz1Y6/YZDH0D6GkdAkYJIvRalAdHAMmPZoYhb6NhDWvEyf/ma737CXN7R1ZC7hUbPgcFgqt/ZZjADnM1xqEVhYBpb4CUk5UsL7jQvj///5buDrLeCOEeD+YQchYwG9VIfyg1NaZszFiCH6DkRGLze5/dgk8IMWcMCjdCiCzR8od1B8OTwvJM8JEShFut1fzMhi+eRJr6LI7hYP2M/xVLwKNoZjUTwRMAQQmYyhWGQxsSADOflZ4kukj7PhZ75bETjBpkAGahMkcrGgwhsXeCyBHBj1wmOBQwvAwqKzoFeRV8ZaerjKYAuirmPY/o9X7q5Cyr7fAvYMAftCPGAEoYlBiVtFwLjtp2U4irj7yOANbi+crHyrfCbTquJV44O0F1FrwQGIMZFqdQDyP/gGSZ8TC0ZRRsOlVzzgasd/u+zpMByLehAfCgMQCDyGZJHFCCgLZ2f8mgI5qauEcVx9e5vACTgCTwEMWr5TdIpWKJb5MvrnoocDswvAPAG4VLGg6UKeqmi4iuDz4er30oX0FP7u5moMvIf7W8B+jwlUNAzFnlZCIhvGFRCeWzrgXSSIBreXTFZSgVLHAp4UHOFuociEEsn2PJwl/XEk0dzfSojeerFg1IOo5BKAveIBex1P67lgUzgWQaJwLAKRH04i14ItgDKEtGsRnWx49b2Vkk9wUefTGrKCF7R0JxZMqxN8cmPAxWcAcxGABKEAKPA5u9lEaAbCmKMI+sDN1X3z+ro24wEZFc0VEE64ABgT180PF9ZdBcDb6JpqcPtPk+1ACbmKjJnllwyuILunEAWjZHkBsrsRUnfD0qEiC5IJfyisgMhzWhcP2O14Ro4WbASgAMQJ48SJwchmBCDFa8qpyBbSP7OvU4PQ0p2W7+LSnSJUFOrI4V7w5IoBTQQTfJ6oTSYk2mQcpGRyH2syGjIF6EM3V/fM++C1CfwUExhCsmzCaQT43lZC3e1hBpEHh36XEqrB7Scmq5dV0XZxmV8WuDFzAF9iwhow9seAGoBcGtKjqAc+1l9rLb/1igesO55ysmCrC8ei6IxRMAKTWNBi6Xw98xNTFUi0jEcmpYgRAPhddpVi9OIEPP5cYD4CcLkCooHPwaW9kV+iwWrQHT8uA1fd3F7DFvgUHUP2k8jTiogAqLoxFpDgbMj9jXSuN7i9dLIdaxzBp5XVBMIMgFEnFAPKT9qPd6A9BIGI7MfPmf4U+40HzI8nWgq2PBxL4FEkjKJixGRRFyQQPzzd1iAUzCAQas1YOmAEoFjwkecDC/PAwhKw6CxIkCXwOdVJLxTobMjBdyIgfvimNvNJ7Evf4jWtdnRYD1YNGVuG93VWuWs4Jf+mlZCCZxwP/cnJ6mXVKk2+tK8lQQVHRTGc64SDAZB3Ey3JcxyACkToJx4wHl+YwqloGDICmYmTFgMQFBET8yyYzyAG/AfWX8mCGQg0BTRoHwt9KVaPE/HQ890AIfgWK+CRAaMRYnVdxHbhdY8Wslw1V93UDsmPIj9GxgiAioRRMIJNvoti+SW/Ikd0gwAU8+XxJcbGITJPDvI6XdCFREFSknTB83xka40H1PGF9dnycCxFwygkK0bASJQSVAbAYeD98xUAe5U3jKIwBosSgNsuABYogl3/IwgFPrOIg1Xc4ZrpAsSrvruykl2ucykapkMMh4CExD5DwJfWAYAxwk4MKPAJgOIjGSEGwuCakRhemw6Yv0UUwRf7L00L9pnsNx6Qx4feY4O8pDEcixOjsoTKKpMYjSFYYjOC8Eq3Wnnr0YYS+0Tmi2HysrPGLqwASNYzBnT2Mz2QD91laxLB0gs12GAh81cf/o/OcHyJ+qj0S/zxnhUZbSyYWaL8+Rq2S29wowiWkJPan4MvgrDDGAlRe7KIywDIgR3meEDWg9HbJgApNTkXo8o0i7oVgxnEgFr8F7jEdnU5GvqfJQKQKyEOPlsNIQvyvupAGHS/Okv4qv9oh+PHxMLk8ggBCRxvAmEN+AiEzz2iQfQBeNmkh4K52hJBKOaNe/FSLobLRXCz43rQnu2yi9oMSMDxs2jo8303ERz1wsCGZECF4kd3DwEYYwJjhoNlQrgIjlYodbBPrwMAZfEmyzcIv27gs6XDzC/IR1DOgA9a6DRz4wZAsZ+LYXvQYsHoD4ziOFklna6YD3+nnU6dZ7bGDAcBUImIAmEUw/zbJ1i/scGNDJiLXmle3RhQ+l/aq57gUQCWzwwBKPeLsZ/LFrGg/ShRXAe64Ajkv30kALAjF8R11Dy3K7KRwJcsUTaqWScARou3w/INVnCH+A36n8RvM3nB5XP4oD6DATBYwGb5ajlOLOh6X8JaBKRG77+7ygGYp1bn+V25/01AzBnwQ1ypanD7KWfA1QDYC3zJIj7KgOUzc9nFbetX/r+O5biwNhyX5uSEDr5o0xsJwLp8/m4A7GaJUv/j3/5+HQFYJ3oFPPkho/hNeqBcMkcB2BAA6XrxmMBkfFAci/m0JpwzXw0TXvXtzrz+PKc/Ml/ugzM9MDqCAbz/keVjjGcQA/YLvjoguo1mRslRI6RwfsiA5nqhL5D6nscF8gfTdfxpS+/hLzvWfzMQCoB1Fq/8b3VWaPIDZqsRV64DALsZHVHs1gEvsqFAeBSApQC8pHK90Oql4UEAyvCwNeGcBXNLOPMLftgZsI75ouUr9ousp2TEyIJ/sU4AzC1e+WIFshyAHPZREVwItrrD3wGAhibTYBhxVpe/xePyrNBuWaoNp3DgFwC81O+RAepK/a5Lfe51jxr7JwA83nPXYgq1asl0yX5N48+f4VEGLATlK1vAo5YB1gBSRmsM+NFE57lcfPD5pPFWCJImtyvGgGfOAacBYO59zFglgHgPefZsXV6/gPXBYeC0RVgyJNOGYuJjPka9eHWgjL9bWzhWk0/n/wPn+k8bgFNmgYcsVflZnBRmIShtJM/m7JGibGBoOIIez9wKPP4AcNpylfbNlGfdI+9NjBjz8JVzppckZuJ+dBw4aQ44drk6j1LIY9JkPD7P4s2lwVEGLHwJnncscNIh4Nh5YMsSsHm5ndOu1BGFThJ8/K6JrZtoslST2+XHA6ftB05ZAE5crgAups5TfaL6EF+UyIif3gAcOwtsXep82eIYY9JkXpMgMp/AeZQBC2b8OduBYw8C2+aALQvARgJwGZhY7swEzbNa88IRvAVO1qkF91J36DNOBE7eD2yfB45fqphLnevzdGeBKBfL8UX5/CZgyyyweRHYsFwxYHzRNK6oetSBMDLjUQAWTPqPngpsnQK2zgKbCMAlYMMSME4ALrcnR6JYQIwsoUnjpDRstOLy7cBJB4CHUGwuAtuW2nUDVH1EFUhycSwWjGD64mZg0xywcaECoI0z5P3X5P6nWlHdgHgUgAUAfOYOYMtBYNMssHEe2LgITBCADkIzSJZXpCOnIg25uPrhgnupO/TyhwLHHwSOmwW2LVSik2pCrDsQskzNIBGIpBdGI+VfNgMb5oENCxX4yPRjPj4xaJ0+WGeEHRXBDUz2Mx4FbDoIbJypADixUAFwzAFI8KUJChMV2SUaAGc1cE/xFJef3FYRti64nkqWDrqqEhbrsm5zvZCdPCd8nHzJOLZuABRz9hTHZwPL7LnLnoNMIY2VyaKcjtZLHOAbNgNPngKe4BacfGF1pnydD+hphQ/8XV5UiEueLGnDN1tWXj/3/4cTwAUzwGPcRcFJiDpPt3FLmf5vjwE2HAQ2zPrEzDv7OQg5OSM+ScYQy5Xbo8465u/ZfLTJ7fKHAdumKxVh8wKwealSE6inEoSy2MWCdbUHIghv3AqMzwHji9VLZuDzD8cXxxWZs5c7apmW0fMBnIHKn5X7d6I5npvRz94O7LgXuGIReJSb+Xl1tzqflybwRwqf9i97BQRWomWJQ7oZVFtJoqDX/b/oGODsvcBTATB9gsfGqmzdjtVz+G+PAyamgYmZCoDjFE2anCVg1CeJwOMnTRB/DmUINVkkgia3y08BtkwDW+YqAFJFMD1VAAw6XG61R31O9/fdrcDYPDDmY0zjc1UjivBuAMx1QdMB+WAYXU8dhEU16dOSkppbcHFSrng8MHwnsGMPcN5ypURHp2xMIa7zDz2z8Gn/kVe0YomO0wEwBYKujL7v/zHA6C3AxfOVh58g5AsZxx4fZM7sf3h6BcDxWWeGBZ+cMEFiwGEHHRnDzun7ONHs/djkRgBunql0VDOSHIDU3cxSD4aEajhFXS4H4S1bgVGN0V8we7E0Fh9jVDG6Obr1LJMRwn+kOCaTEYT0dsfqZHXl/p7PrLi9wIY7gO0H2yAgCAWCWCowKrYE8nMLn/a7PQn9X7zIJPPkCcK+758y7x7guNsB6l98gZjLLYet3Ay5n0sv4R+fCYxPA2MOwLEAQLIDPyP8uBg2cRYmzFweAYilKkn+OC8/Fdh0CNhEA4nGA40kd6FES13WLO8v1qHKAfh9B+DoYjU2Ak/js/8NAIwg7OUb7LCC+WAfB4CpBJoIiTRNRmS1l13kqWh3Adv2A8cdqqp1MB+aIOSxWv6pq5D2kkIAvt8rF7BLJksN/jMqfa7v+7/Ak4B3A6ceqpasKMq5akAmlLWY37t8ZW97PDB2qALg2BxgAFwANEGcnI5JcrDZRPlkaXL4u1KJUAfAjbTQ59x6dSvdLPXAgGYshZWR6JIRaXB/NwFI8C1WwLMXzMeSwLfcXuKrA2G+wrLCDcN/IIg4ERRn0qvyySAQX6mG1XuA4fuAbTOVwktRRr2MLCoQyvEZ/UY/WwjAj3jtFJZkU79g1ghkgEBf98+0Umb/3A2M3lkBl/fOcdMok2EjkZyv8773LAfgHDDKjwNwxEUw9yailpwdxBAEYhBbAuGzG3aKkQEJwAkCkOCjlb7Y6SYyf2UwlAS+vKYnAXjfNmDEX7DEfA5CjUcsnzvbu1nDtUMmCDkRZEEyGdlAk6G6lQTSa6m0MP6HuY73AxNTlcJLZ6WOJYC5/CNxLpHMgdKIKNl69Qvu6/75AjHOiTU87gKOOViJb748BKCWrnK/maTA+58AjM0Ao7PA6Lx/xBAupoYDC9okBRAmPdBZ47lNA/DhwMRsxX7mPgl+SrmK5EaRNRslXFQ9CKB9DkADn79cZtkHFkysJ103eBbqlh97DpmTQTYgk9VNxu+xYbXKU3lhFoJPOgdFGY+lPkgQxokkgF9Xgj4AvfoFs84eX4Ke9x9fIC+tRfDxvvniif358sSir2LCj5wNjBKAc8CIi2AxxLCzIAGY9L7AhGIKgpATw4l8wToB0JjPrfTkp+SLQbHrOqm5jNyajS6VCMIpApDAWwQ4LrGgXqzIfnq5cv0vN0ZXHTInME5GBNLb1DGdOYQsI7AfGKFjlgqve8wJwG4T+fuFAFytXzCLb+VgWnH/fIGYfc46Hs7iHC8ZkPcdXx4VfVXJw8+cA4wIgM6AHSLKWZCTESfLfg7WsIyRF3ckiRQ+HACXkwHptyP4KHrpJvKVGnOhRF9eBF9wE0mUEogz2wC+WGI/vVxiQQIxAs9+rmHA6E1YFYB8DJwQMZl0OrLZ++i7sfT8zroYHLS9df4RACWKxSZvLXzG/fQLZqk2gqn2/vUCUQ9UZaM9wDaPeSPrC4A5C1KV+NITKwCS/SiCR/jRBDlLmP7nHynsxno1IPwJSyRpbiMADXzuPDYfZfBTEoAmcuVQdiaW0zwXwQsCYDYmMaDA1wG8TBSvaoR0G77EcGSET6hjOvVApfRPAUN0zjr45JzVcSqiTxD+VeGzXku/4Nr7JwDJOkxFIwt6j6+RqUrlkO4bXzp1gCAAv04AzgLDDsBhKugLFUvQUhTwCEKbnKCw14HwJ9cDgGQ9WegRgDI8XEcVEDvAl7lVlglAgi+I4CR+Zf1mLGgMmDFhBGFfDCicRJFERviSABjLS7FC0MFKMU+07wOPE0kGvaoQgGvtF9z1/iODkwn3VWoEXxres5ib9xx1wZufBAwLgAQexbAD0JiQwJOuJBA68/H3Zhk6+3CifqqwWNMKN8wjKgbk6gWJgC+FMaBb5vJVmsUbV2vCqo3cRWZcCIACoax53+ulkqNd7iqOcU1WcC9cxEm5kQBUdZ+sTnSL/jEtTWngi21jhJNJBivZBukXvOL+yYBkcOqxKjJ4AGgxzMrBVwdAMmHrZOAYF2l6y/mwV6xD17zmWo6MbRyeWtOHwxJ91IIhr6rqZS70DPPLXDVUrfBwzHKr1EUp6/h0T/6L/GcCqslt4IhoTcwdAqDSs7I60WQH6R329pHuFyuXDJmEjuOSbdB+wSvuP5bGUjmsA5XoUvcvBXKKAQnApUdXwah0b8jXR2YzJTsC0ZHB33FL+2yiX3h/1YeD1fFZGT81g/H6yqkVa9YEpqMhTADle8erHA6t7Mh6j4ZBXdBGjFyO4CSIm9wGBiBvgqxwIAJQlXIyEJLyI/i0SkAG/FbhaEr6BXfcv+5dLKhCg4z1C1HEBJ8+BODQGZXfk/quAZC6ketAZEQCTWAU8PIJt0fgwHzZvVWNaKqi7JLOmtDWFy42g1FxH/XfqGkII0C+a0tnDkfsGxQjn3VPsk7tXmuy+Xp0JhtoJosAaFcUAJUYKiYJxcqHqKAH9rPlG2cMrmCUbMX9guMLpGTcCMKDlZGhMK8IPnPIn1X5PA2AwegwEEYmDGBMjOI5whGQP3NPBT7VJlRNaKvF4t2IWHbDErtDlSk1p4lJ7/zd246tglGZryIfrFhQ7pU8WCAX0ZENG+57U14Z4YrCeLrSxXdev6TfLwrbxT7znMrfKQXfHLQCnyvmRIv0Q3430ezMmL98P393G3wqz6am1NYzzoGn+svqRmTAU2citctqAX/2EI8F9ACEmLHXLZGoFxtSl2xyK2bAYwrj6Xr12+1noL/jUTCD9vvFrn6u0v1/nvGkaoVBAQi0eummMAuXQHMWJAA7gCixG8U0gFfcXdlBKk4Z6zELgAJfZEKrxpC1xOIl/+Sk7jkcdYlSco90y9+gK6vJrRiADD0piad7RuFo3udNCgft94vCdrGXn+tujgV3QAcHLcFnroelivHkchEL8ue0uQ74S3eubAITS3IQhKkMRjBMokgWG3L//2z3VSnP4VDgQWxUEEUxAZFHL0eR3HDfm3IRbDHkBfF0zy4EIKNhSvr9goGEBdvTz/MIYQLQdVsTwRTFDj5jQmdArRDYJQNDSs961R3tPhx5NXoVgoxleHnarjohgLec3D2HI492yQNvIwvqO9fJm9zKGbAwnu6FhaP5pFuMg/b7tTbpBdvTz68cz/zI8azVj8iAHTqgmFHXDUB89R2dtaC7tUGw4kDOgFb0R2wYRDGZ8g9O8aU4XwPOczhiwGlMjqqLWiFYGu570wADFsbTvaxg8nkow7E8nM/atfKzln6/1mS4YHv6BQ4+Z0BbqHcd0NwwYbVD3+1yWhXJxPBrbq8AqE/XApSqAxiBV2MZ/54DMOZwKE00rnDUWcR5KiV/brjtSAMALIyn+/mCyeehjIYp6fdrvVELth8RAClyHXxmhPi6r1m8FM0ucgk8+y4RHC1kAK/5XgW+2hZYofafWcPq1B5AqDqEYsQ3nepR2gqhV2yiol1COkD0C+aOaoGx4aL7DQCwMJ7uVwomn4fm7VrX2u/XAlELth+5sHPtN+l/Ap6sX2dCsZ/phZkIJgv9l++1wbcq+2WFv2NXIjNKAPzuw7MUAV8DTuynFIEsQy83RgTAhiv+NgBABaQOGE/3mwWTLwAqHnaQfr9GnwUbARgDNBUlkpzQboyYCyYDYdILdf0l4NduW9kGoa4geNdazLElKoA3Prx7DofiETtC6XvE7hGEzJlpcis3Qgrj6d5UOJoYDcMglrX2+y0NPtl5UZUjkfx/Hqbecoe0OZzdF1gHQrln9Bhee4s3f3Zxm4MvAk9VSFdUIw0i+Q2PaBtISiBSSFgCYMjMW00MP7pwvvLDmwFgQTzdHxcOSGvBg/b7ZRZByWYAlOERluKM3Ra9CKWc0q73dTBhMFT4ZwIw9l5Lrpes+HjeBiGCUOKXeuBvPcKTiEIOR0f+RhDBMYi0Lhea4GTaa5NbOQAVDzhgPB1La5RssV3rIP1+7yy5OAADoAchEHBkFbKfGRpiweAPtMs5IFNokyOGk/7rAYC9OhBFwNXVY1at5tftCBHaWVS2AJdEcEinrDNC+Lumiyc1B8AB4+muLARAXTDCWvr93lR4/Z0Xt6ODFQkj8WtumEwHTKDLQejAfN3uds/dfjoQdatGLxb8jQBAYz6/boxiFgAVudzNIc2/s3xLk1szAORoB4yn+2DhaATAGJCtbpkCYq9+v4V+aBgAQ4i66XtaC85YkDog/zdZvzUgfN1N7a633Xqv6fe9msDIHfNaB6Ay2JRE1AHAEDIfI5nzZCLeN4Nbm9yaA+CA8XSsul6yqV0rJ2WQfr+splCyCYBR/HJyKX4phs0PKBZ0lqOYTpvniAiUAmAd+HKjo1cvDjHgr+3wPJQsVCymUZrPMuRsRBDG4AQCsunyJtFGHwAAIABJREFUcc0BUJlxQoH62q8ST8cggpKNAFRGwCD9fkuvbwAkyGgJE3C+Nz1P1q9/T3F1EZBxvZh50s6AEYC5yyUHXt5/Q8zI5/KrAmAIkkipkyGPYwXz1aRT8v5ZO6jJrRyAvKOvNXlLazsXs9bo/ztc29Pohgotp5J49Rcj/pzfIwGS//3OM4CNd1dpntQpFUmjEH4LYIgnyn/OLjL8FeDGhwJbNgFjI8DIEDA8BAy1PFK7FSKf43cNKrvHx+8C/vmxwMgmYHgEaA35J0StpvvzL/nP8RbLAfhyT207TChgDRiu/ZL9DsfWNABvYzbhCDBKoBAk/pEobGWTqp819hzQ1/0k0PoaMDEJbJjxVZFgDad0SaUO5LksWVj+XScDmw5UEUDJ6U4d0nVbC91S3ovfVHp5al64cgC+k7mZAP768KCA0WD3A/ieLz090CDceVmlAuhBljLgrfcAw6PAyDAwPFwBkCAbItM4a/FiNtERjBl76W9ffD2AbwJDdwFj+6syImRXrd5Y2FjIYcnzWPLEqnsfC0zsr6qBMQmfIDR/pyJ6xMhKyMrSDiKD2xja6TADTt0/AGAs1KcAUCFrOLF6tbtiRVFavT/wuMCa7MfVTlH098YBeBcwNAIMEYAUlS4uBULOmK3LCnwOPANlEIOSoF9+C4DvVoWXhvdWZVOYqWgi3vOXDUQhgieB0EElViMYJ08HxqeqnG8D4IIDkAzo51DKQQJvBKUmKACzbM4+5hUivwrgiwC4LzvjmgCh6nBcgiMTcv9Abo0D8E6g5eCjfpUA6AxoQIzgi8ALmWwC4z//DxcPPwBak8DQFDB8yJPpPZHeGCyC0KN5DFCByfh9/+OAsekKgEzCTwD047X0SCPM1IYQjCv2E/MJoGVwUUQoPboq0MdqkWVn7RtDDMahB4g+P6qhXFpjVtkDtRGA2nKjos7IyOyHFUbIrXe0FXsTuzIYfNb4O2M3ATGIYQOmPn6hG6gi3eUkQQAeAIYOAUOzALMVh2pAlESqGFBAXAYOMQVjxll03iO/yYKRAT0FQXkwZkjp1pz51LO2XAT3KtD3AIAwj4Wg05kfiuUHYlsXAJLVnP0INLM0OYFx78AzcRySeTsw2AJueI+Dj2Fne4EWKz5MA0MzDkCCkAByUWqsJzarEanzj2zXwjEGFHuGY+pYsMojzZL1G9EBexXou339IRBrC3lJGmNDuSHX+w7WC4Cm6wWxm8DngLTImgC8pBcGBuTXf/1fXnyTugnFwxTQOgi0CECyIFlsvvJfEnh0mhsYI/s5uxFYi1xZof7oOqSAawwYjRGBzYGXbtWXaCIrlvHUagX6SP/ruMVYCEbEqECXAMjfree2HgA0ESur1/0vtnNwGSsG0RsZME20/+/XWH6Mugk/yngPAGy5GDYALjiIHIgRUIrsZjM7Ax+BSx1S4pfffQVIep8dL7dMDsTGjJB+CvQxTHmdtrw4l0CovFruC2NOe975egDQsCXRK/eK634JhBK90q2C7I1i+Gt0jxF40k1cPJAB7UP2m3MGJAAFQrGei9iUTH9yBUDTHfU3B5+BOIKQ43BWtNtPcWIOzEZE8FoK9K0DCGNxLi3FqaKA9gTgeoFwPQAoI0OulWT11oEwiFz7cwbErzNxWtEYBB+VY76Vh4DWrH8IOoGQ7Ocg1CqMRLPltmxvs1/SHaP4dcAJePYyyUCRIzrTB8tE8FoL9DUMwl61kQQ87Rmy2PS2rgB0a1ci18RudEJH57OsY02y/+83/sZdBKr4FXQTApBvprGgQCg9UEAM+h9F6ugJDkC3gJPBEvRGrYoYCBX9IxEcS5K4i6cZAHIw8oXQ4mLBb35YH5d7OekadtTV1UZSjaEIPH4nQzYNwgjAHNwDuWGYpZc7lzPfX1cQur5oBorfzDf+zi0yVTuSkuxBI2Q+PhQDIUEnMLo1TBCZLufGw/ixbQa0KB8CTODjPohdY78IQmfDjmW7Yo/doAX6GqIiAtDHaYswSmeMubV81kp11L6hy2PdAcgblfslOKC1IiKRmyRxZgV/8++DS8BFrxXi5Hd/U6MeSKdqEsEKhpBRsgRMbAtuG4KU/+9ry5brzP/lPVMv1EPOQegharrVcgZUhVHFxNPcp9VFtlOWkL437C0WABWypFRGsV0sb5Hn2zYBwvUGoKl10v1knDgo0y7XA8Pfv0UACnjaK33Co9gJQAOe64FkNvtZAHQdjz9v2Nz2GSa3jYej2W3KGuZ9ixGdIVSoKT13B2s5AHkGheST6qn0erHv5AIgAAU+LVfw/wq3CEAV7clBKDDGZG9/5oVXx/oyYARczcqH5GyH8eFplTawFvAtrtXLGpNrQDGbejupB3omlIHQGc/ErzOcGSRs8zrhAbbuL1Tco/JfbLlNwHOmi2kIcs3owbdwNpYtynDQhsFcgvuG9/YapGFvYX22zZcAU0/GwA2LJ/4AmGF9mwEbBu98Y3cMF+uAGQCj2HVp3BbPuo3IlqxAy5wHAq4OfARmEBXGfNIBa0BIsG0ecwC67merHgRpZLwocrWaovuTxew/V0txJQ2DWeae3WAGbdhb2DB4+wRw7w5g8Qpv88liyGtoWHzMi4C9fAEHbBi8kwUKu2xNAdBxaGBLbJdZux1LwAGECYAEm6wyfpelJrEgFnRDxESwgyUxIUsVMwjVy5AYO0bG89Auu1/5BF38KqjBHlUAYXsteNCGwTeWNuwtk4JMkrlzGNizA1hm69g1Nix+zDOBW0aBeRZZGqBh8M4emfWNADDT+zqMjQyESdQFHfDbZECCLRgdHeCTe8CBaKJY1rDnBRCIAuGW4TYAZeFG8ZuMkGiQ1IEwGCJtHZBmy1obBsvVMnDD3jIAerti3LEBOMjGcOpa3WfD4ic9t6oveDtLfw7QMHjnH6wPAybW6yaG4+8D4HIQfvtDIVtLejpBFsVvUI7NIBHw3DUjRzL3rDVtsYPOkAScuX3coNDynT2VYJCkn+PjqvUD8hVbS8NgjphGxcANe8sAGNoVY/824BCBtIaGxRe8pLKZdpMkTvXiJ2toGHzSNHDPScAyq3er4qPyGaNc7JCRXWLT2TjwGmCOeQashq6+qSpZmp8vojQpheF58ncdZVjLnjWPHr4VWKTKxrHGUqq97qXu3jp0wPy+eEC/DYNZsZAO6IEb9pY9lNCuGPcNV830ZmkM9dmw+OKfbdcXvJMPdY0Ng0/7GnDXKcDMccBS7MwdKz8KCAKQIgY0MWGCtr4TOHAasMwOkTqf6unyuLykfd254nkb7qsw/iVg7jhgmSX31Vpd9yRHeLx+zRhjEGRbB6wDYT8NdymyubzDzCCGfpMJWfSRYfr9HP/aMgBm7YoxNQHMbQHm+ID6aFh8yS93tAvGQb7da2gYfPoXgbtPAqaPA+a3AEubgGU1RM6B060fgkRoCzj+TcD+04CFE4BldZdRc4/YxlxgjJMewSiwN1zWfsOngdljq3EmY08vm5i/7j5yIMqpvupKyGoNg9lngYosl9wY/0dZdrMzYl8Ne8sAWNOu2MA3zw/F2CoNiy99XbvftrcLriz6PhsGn3U9cM9xMODObQYWCMANwPJ49UliuW6SaqqBn/gGYP8pwPyJwNIxwDK76ahDeN6uXYCuYyABkEza4LbpY5WEWdSLxjF26/dQB0SJ6r4ByAN6NQxmkWcqrnQ00x1DEDJFjR8CcNWGvWVPp6ZdMQ6OVOCb3wAscPJ6NCy+7PerkP5Q3tBY1PrT9tEw+JwbgPu2AlNbgVkCcCOwtAFYcgAuiwWlM/XqDjMEbP9t4MB2YO54YJFMo/5gHIcALV1TRZ17FXOhPtvgtvkqf9H4kvHDlyKK4l6VzvVSBF22uwjOb7pbw+CfcwBSkyeFEHAUx/yw9JTyEbo27C17Ol3aFWNuAlgIn9QxO2tYfNlbK6MvaxeMRYquvL9rTcPgJ30TuH8LcHAzMOugX3QALo21WXBZLEHwRF1OgHS2eOgbgIPHA7PHAezNu7QFWFZ7JnXJ5rnqxHEulvlzwyVNN3+wern5Yovl7SXLGwvn4riLWO4fgMRJXcPd/+pmOymELEhRzBxJAo9gVL4kwVnbsLccgHEpWi3epocCAMeBRU5eTcPiy/6qtl0wpvhA+2gYfO7NwOQm4OBGYGaDs+5ExYDGgqP+ccAkINaVpB8GTv4d4OBxwNw2YGFrxYCmV0YxLNYheCXau7EhV3ga3Lb8g4+R45uoGLADgHWqhsBXA8K1AZADyRvuvtkBSArh+i9DsQhCOtf0UUgW/7aiYW/Z0+nRrhizoxXwFhyAi5y4rGHxU66qAFhT3rDSIVdpGHzencDejcDBDcDsBDBP1uX1CMJRwFiQIBzxieL3KIY1YW5MPOxNwLRb8gs0aghAss1GZ1O+SFHsdRPt0i/PLHu++dFb/x4mXfhcbWxhfCtYMFr/uWvKxfDaAcg7ipPCvFOVpuo3HrCjYW/ZA+rRrti6TS6MVQ+L4NPH2nx698GnXF0BsKa8Iab4dFZpGHz+JLBvApieqAA4J8CPOQuOBBAOV0CUYbIskRkAecrvAdNbXc/aDCxSpyT4CEIyTgRgneiLIp3nP6fs+a4A4N8B8/48CUC+ZGJA29fpuLmxJW+5h5kNFg2jiWHSi0r0Uv4pCoZsxw8DUfnhd4Vk0XGdGvaWPaBV2hVjdjgA0BlpkQ/K9bmn/HOVqtClvKEBqlfD4AtmgP3jDsBxB6DA7tdbcvYzJvQJkii2n4NOeMpbgJktbYPGACiF3wFoEx1ZMNe/4jnPLXu+KwD4t/5SO/iMBcXuesHylyACMBPDgzGg7opM8mEHIGdwrfGA1rC37AH10a64Yr4APvvOSdwEPOVbKxu+K2pdKRTmdI3dqkPPVgbSTBGAY8AsATjWniBdx0QxJylOFCcr6HBiw1P/CDgU3EgEIMW52M8YkLolQRddIN1AyKWiBretf9MJQN6HsaCPxe4rvgDdHOcOxDIAcmDFDXvLnk4f7Yqt63gEIB/Yoj+4p9xaAbBHeUPM8qF2aRh84QQwNQYcGgdmx4C50WqCFngNsgSvQ+Dxu4MuiawhwIAXVk1O+e/A7CZgThY1dcno1nHL2oDIyZULpBsAFTBZ9pjT0QQgn2V6ufRicS8QRgbs5ZYpEsENDejBfpoLrwAOjgIzZMBRZ0AHoUC+SOA56xJwNlEyTFw5FxBPeWvlzpnbANCdQ1eSGTRybMuydgMggVBsKmtYoC6Mt8znZxsZMLzAxoAOvsh+ydDqtXx4FIDl8L/omQ7A0QqA82S/ERdTI22mNfaTuBIIxR4BhKe+y61punQC+MytI/Zz/c9EuvyBeetLAfGZ5WOMZ9j2/gqABB1fMLsHAVBqhfTcyH5d9MByEdzs+B50Z7voGZX+NzNSsd8cwUcG5ASRKYbdHRNYwhhDIHRgGmO0gFP+HJh15jOXjnyKblVT5Cbfoq+yJOszF8P8+VnNPlICkMAzds/YLxlYznrJwIpO6egTPMqA5ZNDAB6iCCYAyYBcBqTRQ0e4630SxZyQJQIvMJ8mSeLrYe+p/GzGfnTpEIBy6US/out+K1wg+brs88rHmDOgAVCMnrEfxxMte1Mt6j7u9zzKgIXzczEBOJIB0BnCJoqgIfDEhM58SWzJEPGJe9hfVH42un/Mfxl9bgSiBySIBWnAJBDGEDAB8QWFA8wO3/a+wH4+rg4RLPYLul8tCI8CsJmJMQAOuwFC9qMI9g9Z0CxhZz65K0wfFBPqu7PEyVdWAOTHVlTcpxhXHZLz1w0ZA6EDLhkCskRf0sw4dRYC0PQ/vVSRAYPo7QCdj7GqVOSMeBSAzUzMxZcDMwLgcKX/zbv45SQlHXDIgagJc+bjZBqAWhUoH/Y+B2D0J7rFa6LYDRmzomsAaOeKqxEvbWacHQB08JkRIteSXiSBLYJOLB+X4xrzAzY7vgfd2S4RAKkDDgPzNEAIxMASSWF38WsgkuXLyXTRSRCe/DduSZMBMwe6ObTd8JBj24Aot07uDObPP9XsIzUGFPs5+JJ/M6oT4buxHv9X7BeY8KgOWDg/Z58GTC9Xq5FxTXOw9c3Cm6k5fPcjgbHbgAlvVG2tH1T3Oavoq6BlniZ+12n5u/2sDbOvasqoFg8x2Lnbcd1GdhSAhXN+7qMrAC4sA8sORJ6yHwD28z+Ft4fdv8UyqUDrDmCEBcpZ39kLS6aq9l4D2rLb/KYsFTPWdfbvh86vQu2s1K/K+zIjTsXIVQ9a59Egs4Y6sZfIA/EcSp/jEXv8BWcAhxaA+SVgSQAkGAMICcwVlNLlqTc9Gbv/HAA7MrL4+f1VlXwrUq7SvCoyGcrrWpGhuur2fNGYwM8YT67hT3s1LaZvqn5MLM0bzmHMmIFSgdFNj/mIBct63NhFZwEzDsBFgpDPeanNgATfCtGsX9TIKwNrg9tuVkhlng7TI/YArX1VkXKrEe1l2SynN1RCsFJsqnQv3UIMxhwIRjU5AGN9QUteVz3BUAvahuNgjC3HxLAND7nBp/cgONXF5wCz8xUDGgCjKPbvevlzcKUHH2ag6cnYzepYBB9Zi2FxDJdjoXJv1WDFiLJ6MKqKZUzoQFTfj2HmwTKcTpVWvcxHKm6kKgoORAEvVclPD6NdzLXpMT8IYNPcLV7yJGB2AVhYrAC4SNA5AxKM9ryDPE5fs6eeVKWGZ2M3S3MQfEyJUKV8L1ZpJXpVJ9pLilmlAxWkVJHKwIhjjD9TtVXVm1HdOy/pJiaMFRWM+bo0rWl4yM1N7oPhTJecC8wRgAttBjQWdBBGESwgSiV0Pb9DRgu0TY19N+M1mRKh8niqFx3rRDsLqjgl9yaGXT80vcL1wnE252PAZCzAHQCoiqoW3yYWFIt664fUpKaREr1NPakH6XkuOQ+YDwy4FMSwgU8GSRSz0UJx3Vx/5vFNbrs/EiLRY+v4ACITww6iJEodQKwBIyBRv9vwhKzUW6z66TUGEwhDS3ezqusAyNxnJn8xa1KRPSFts9YfFB/QDZcAm78CnDBT5U8rCqjfc3yh8Gn/hGd/MsKf1+QzYJ4891Jye13iy1cAE9cDJ+6FpYrEkidxDN3OtXR+FwBGMezoMmxJLOumAuD4J4rxJrfdH/XCoLGFVKiUbw+LAPQqWWaMMLrd6/+JycSIm85w9lOpt1j1MwAwFTiqAWEUxeYH5ENn/jInUVHeMXQ/f/jRePvCa4DhTwLHfBc4frGqqaNJzLPw6iZxV+HTplFGvZrXZT45N39+HW3TujlZv8D6fp8HRq8Dts9XIOR5YtakgBgdrrrt5Qsq8Ssd0BhQ4HMwmVitAWHAY/LbLDQNQDaTVJ8Q6W4qVB51OOqDZDPVB3TLOBepW5jmqaLbec3jGgBGMSxvvemDYkQ9GoKF1ShUCSKCqBeQrvmfVZPC1keBjXcCmw911tTJ8q5XgOLaQgA+x/OdWA2EGZ98gbjleTHdQHQN+2iwls3nK3/Zhj3VeQhovYzdxmArSwQgDRA3QiSCJUrTnjfl4KozRCSCCeYmt90EoJJbVCk/1+FiCwFZxLk4dRfLFia6x8LbYkD9v9cXtLG6+O4AYQRfrgPygVIcqyhTXcWFOJH8fh3rz7EKwnUArq8mcGwK2MCC1i7WY7Zenh56feHT/jE3yliE4TZncd636gPFCKWavGhcRx2J+cvs9MlSw0Ty3cCm+c7n0G0MExdW4BMIbTXE9UCynvyCCX+Ovm4gbByA/xisVgJPpXrzLj4EoRJjJIZrWHArS9iprK+KcefgiyB0XVKGjOmCmW9xhRVMUSyRFnNeFGEdI2q+/HFXclkp9WsAbgTG9wGj08CI64WxRk/OTDcUAvBHXSLQxcVCDMQSWbzv+1e7WVbz+k5w2tJtsbcCYV6WJY7hmAsDA7r1Sz3OgOgoM+KTOJbcjSI5yGIaNE1uuwlAAU/MF+tF5/0sIghVLdVdM2S0bSzHx2Mi+FTxXf8X925NC4BycK8QwfmgVX1LlcFiykEMcL2BndJJ7aQfijKfxLGDwAhByM7aC5U4qwPzNwufNnNuOH4VZaCPlPo2AahqFqoPVFc14ga2m+WEEL0cAz9kdPrOmMu8r1o/rTsXz7f9oswFs+jO6LAqkvC3Ggg5Fg6mwW03CUI6X12h8lyfcz3QHqr3DIl64DbqaQKc9mI87QXACD6vpJqY0EVxz2CEyCI5eMSGX2e7VtI5J4yTRyZhscrvt1nQuivOAaNLlYESwcySgiVbr37Bfd0/u31yEgg2FVaiPCeVOguqAfGov0iR0R9JABJ0bnwk9nMxw+fOh55EbgRhzozrBUA1polN9CLwok5HEEUQBjFMQB7D+j656PW+IrJ8O/bBCo4sGFdGejqiyYCx3mKe9/JtTiBvmI5OFiTisg9LtJFF7gZGDrUbHKs79+hyu5hSaUvh1foFr3r/6vZJCiXgCDwVVFJ7MVmRLsrGltuFCc68yFdACMDAflwR4QM3HPoKgIExt4gz42SuaQb8hBOE2oZmlu+KFlKR3QSssMJxDPWbbjpfLoJrxG8CYT8MKGZSVTCxYFTIb84nkCxCIPLDiby30gXFghaF4c2ReR466Uu2fvoFr3r/fKAEFxvpqMcd9yonIrkuK5LLV7MVCM+/uDJCyIC2J8a0z1iwqyESgMl15Sa33QKgmtPEBnp11mwuXgO70Ud4DHWzfgDYC3zBEOk7HlA6XKyHQzb8HgGoCSQLqsxorIy1Bxie7Wx0rFaf+wr9Xv32C+56/7HbJ5VHtRYT+GJrsehHcya57PyKAQk6+vBkBZPpjPEExlwU59awg3C24W6KBsC6tqHR+MidyVG3i3rdAnAsH2T093XT+zLr197MTA80h3SfsZP2UqpCrPQ46oF317VrpeiKXTJ9MhMLkgGdCacKG/mupV9w1/vnwyGgCDCKWzJe3lqsyzLWZWe6/kc/oKzgKH4jC7oolhdC4jiuzM0WPo+cPQ2AsX1obFCTO5Jzn566PwbReiwnfTWjI4KvDoh1juh+aT+WKSYD3i8Aql2rJk+VsVQly5kkddv2FvHT61icqO7Fr71/IkLNXOi0FQjV0046oBy6wZ922Q95ICqDEaL4XWw3COcf9Mw73DFB9AqE6wZAAS8XuzGQIDKf+oVkqxt00ttAc+YT0PJ9qRFSB8xoye5Xu1ZVeCSgCLbYLVNswoncHxoeLwCzBGjBNki/4BX3z9lXgUCyIIGmhova83cRgO5Te9yLgP3MfmsBS8xs8/U67ePQOqy9umBUruDchqo8sHSd3PMfT5ifo+ack8eFHI6QEcnT5GvdOnVdXof+ptJ+BVPWceiaRHA8Us/nkACo8mzqlqmWrbFDppT5A5UIZm7CPA2Vgm3QfsEd909kKIqB1qJAKCBG8ZstZz3xHOAAiwmpDIdng1maZQAkZzsHZ537YfQrwNyxoQ+HakrnS0h1mUA1C96TdJTmORyhC3oeqdwROi+GDhkFI6bYNrcNDEDeAkXwQizPRpmnIs3OdqZPSaRFUcbchHlgie6agq2kX7Dd/+d8lUJVXuUzk8ERmS+2vfd4uvN2VOV5rSwb0y3JhgIh9wJeN3YMQCIgR78Q+nDEVYBYZUrUpbXFnM7COSdf7N4IPvtDnT2BY/h8Chh10MXQeYGS+7GGjaQiABpuNIFiECnzdWJMIUHcazLptC7YivsF8/7FgLFMqpiQL5TuNbKfA/DC46rqqAbAwIKWK+timRUBEiNGsOQsyQm+Gpjd4n046hbT84KPuYjOmHHyp92gcgDS2OoIuVIeh/xyUkaVwyEWdLrewHE3uBUDcKIwnq40HpDXL+n3CzbaKdguel5VnFJl2awaghLQBTzteZ0cjLq2A2n0M6EPh2pC57Wg41poLzZsAZNso0Hw6eVR/J8bF9YjWGmVCpGKwQLBRCcrbiSxNLgVAxCF8XSl8YDHHFPW7xeFBRwv/rGqOKUBkODzqgdWPYAM53vTASMQu4Bx9J+69OHIF+N71F1O1gUB+AsBfFqKC+4Wi4BWX+CYgOTAU36wdMVNVKka3MoBWBhPxyiuko3xkSX9fvGMkqsDlzzHC1N6SQ4DoINOe7KelWWTheziObeKCdARApD1AdVnRH048gKUAmAEYi6Oh4DJV4VoGDWqjq4XLbO5o1jBoimEPhPJmwu9FvnTLgdgYTwd2wyXbMyRKen3i2eXXB245FlVYUpVxUpGiLtmGBlrTEhVUwV8dEkVKAq3MHJ1uzRbRx+OOgDWFX6MsXJU/36lJoEoA2AKvw8+uwTEDIBbStdOs8ddDsDCeDom7ZdszBIs6fcL9ror2C75US9IxJJsEsHdGFBil4yYuUwknofJgF4XcEUfjrz+X7fKo4EJJ//PkMORO6FrVjQMeL5kJhZMMXzLwNZCt1nzDFgYT8cQwpLt4hDON0i/X7ys5OrAJVe0S/ISgFY7j9ZvnQ7I3+lyqpYaL98CWp/N+nDkZdhi6bW8An1kP3fRTLKVWlwF6RZCH2L4zDDR0k1IqeTNb2OQSYNbOQMWxtMxeqtkY6I+ny9VEz6btfb7xc+XXB249AoXv85+tIBVgJJ6n4lf6oV+mfjdDJNMH0wAVFX90GMk1f5TxlS3Fggh92DyN0IORy5665KIfCktsl+K3VsGtpVOWOMiuDCerlSnjQ2rB+n3C+pIBdulz8wqonrNPLKgwKaC5B3s53qhXVq6oDNg6sOhqvqhEr3V2VNLBjmnSSNdrOLJ1zkAu6VPRjFcFz4fXDJ8i45hG94Gt3IGjOFYA8TTlQZ/qGH1oP1+8ZtlT1MAtHK8mQg25zOZUSCLIliWcbw8wfW5Ln04ssqnHX04euiCk6/3de66MPpuAQVZAEFkw2MKFw6a1wEL4+lSBvmAOMhD8vkOkFX77feLNw14YT/ssmc4A6oOdHBEkwXlgjH2k4Nal6wB4fIuX9LzZjAmorNeHMo5Tc0OewHwDTUh9HXxfGJsYkAbAAAgAElEQVS/uvCpoAcew6zBBrdyBlQwwoDxdLZWXLDFkHyF8xGE/fb7xR8XXByAAVC1oB18HQYIT+8uGfP75SCUs1o64he8v4j6cIQ+IqkPhxrBCHjdjBH6AblQkAeY1ondukSiELmsUPpjbyp7XuvDgAXxdNZVvWCLIfmKg6Bbhrjup98v3lVwcQLw8gqA5v9zC9jErutltg8gMxDWWMBaMVkmANWFyEV6R0uH2I1IzW7ypbkQOTP5f2ch9KsFkwp0kQlDAOmxzHpscGuGAQvi6VD4RgmAg/b7xZVlT5MATNXwqQc6KGwf2U2uGV2uzg3D4ua7fDnPwZcKgIdq9GaIBPZb0YdD7hgyIFWMXiH0eQ5vXS5HcMkc++9lz2t9GLAgns7KxxZsCkgdtN8vWD+vYDMAUpcja7lOR9eLVcIP4tcuob/3AOHCdW02VTX62ApB4Mv1v24gnPy9HiH03fJ366KYHYTHsgBBg1s5AxbG0+HLZaOp65i+ln6/YM5EwdYBwGj1cmUkE7+8THLNdAHhwrUOXtcrO/pwhF4cct2oN68BMDCfmsJM/n6PEPoYPp8bH3kCkbtjji2tJJA962YAWBBPZ0WBCrbYsFoOf9pDAiENk179fkuvf9nTXewKcBSjsn7ldonWbgQpx+26otaLIwAlfi2QQSJY3Yjy5i9dmsFM/oEDMM/Z7Uf0RiYUA7J+ToNbOQC3e0WBBm9qLad6HICG1ZK1XB5PoxnuOOIcxSXe/Of8xHV/P+FpwN47gKUpYHmuSve0pKZgCKSq5wqniWE1WZz/xouBm74KTMwBI17lVBXwtWSs+8/vL45Ff3vhpcAnvwos8d48DZX3M2hx9XIAnu0IIO0chu35AOgLL0yuG/jOmwbg028G/mNz1YWdETbm4I5BrFlov+EtD2wIo7l+Atg8D2xY7iw3V5diEqO54mnj6XdMAYcU+6gon7A3NSO2qFjlyZYDkAX6uD5Iam44YaUfVNDNxaJcLIPXcGGpfi6PnZdVD1wPspQBX/wl4OaNwN6Jqg+xwrxslcVFuYJblehkcYYZGPS3L20BxueBcS8nwg5H5kZkx6TQSbXFZcCQKadx5Cz5mPurAFxrRaa17pAR2PFC+ElSHKQ/0QjQcgCyGyM9v3SnsDBRJgL6msWCf6IfWeUJac8UFlpY8500DcCfvgb43hiwZwyYVhd2D/VSrKGAmIDnBkiafEcN9cprHgKMzgNjS1V7rRjRlceyrqif6KAkMgXIM+6tAnDl+zSL36O9+U8p9jGHQo285/2XA/AnXeNnKAorDXH/AILwbSvLEz6Ql2+cAf/3XcCdw8DkKHBwpOpFbE2wadzIdyh3jjNQirYWEwYq+/zJwMh8pf+xKNSwM6DZMmzNRRbM2K+2Ii6TlFrAWfd5V3i/F7IgT2LBF5LbIdkqxLPWvtzlAGQ3RpU3Y7AiixMxLOUB2t7pKQ8M0qCTnp8HkojJgNqaMEJesQv4AR3Iw8DB4QqAs+6SWRiqgJgY0HVDAdBA4Ba4xN7ndlSFAAjAYX4IPO5dBDMAdS2i+Jx7XTf1eEdTDfgAQnR34p/wQkRmjNAoByDT/ugFphXAmjAEn8qaPQAgZCs0lSckCNmVigEbFMsPBBE3DcBX7gLuawH7hoAD7EM8DMw48AhATrjtQwiXoqkTEwWd7LOneXNCbz6Tiq/TInb2M8ZzIFrTQbGiy92oGz7pXl/7jvdAJnb2470IbB3T77Sai+hyAP5voTqW6sKwFAc/TAdc5+3dvcsTrvPVYSK4SQb8xV3+6IaAqSHg0FDVh3iOIFTIFxtit9orL5Z/LD1Q4s+B8OnHVuXwhhdd5DoLGsgCCJ04q66X/Ju/vSaeAxDPvbdtmdtKDV90gVEPIl/xySkviOhmAEjrlzSkwj40SlQZYZ39I+8JBMx8mZryhOsKwqYB+KpdVSDFvhYwPVR9BD7uyX4SwRS59nNI+bRck/DzJ05v12M0nY8fAk8iWL5BB5qASPGRCi8EVjzv3mqpkC9ACrrwhKukB67GhpqRRowQMqCiYbj8oOoHeUWpdYIBAUj8c8WjrjyhNIJ1unzjDPjqXdUjJAAP8TMEzLYq9uOHICQALe/EwWe+QgddAqCzzD8+vgIgg0qp+5nYjaDzCgjmnCYone0klqP4JSgvvK+6LoFPoFMlkPGh+0rPWta4RHTNJJQz4M8EAGoNTPVU8opS64CC9zoAWTFChcq7lCdch6s3L4J/2QFIEBKA1P9mHIBmhPh3Ai354RyAAmWsR/PRs6vOR8Z8FMPS97yxtIlYgVB/I7jC0rIKSfLXF1EEB+BFFjQ3jCLA49OWsRTTEPzvzQEwry7VrZ5KwzAQAPssT9jw1dcHgCrORQCS/bgn+1HsCYQSveaHkzvGv1scgU/6R55Y1YIxhvOm1EZekQWl8wVDxJgwc88QiJc6AKX/meHDawX9z16M/Em7bO8Q08GBP/jEkAEVjMBoAFWXUjRA3KtNwOBXW3EkAZhrALktpC6lKtTV4OU7RHB+3kHWgv/zrnYZl2kCkF4uF8MGQGc+MqEYUCA0n1tkwxbw4ScHAHr71Q7W4++c8czwcBAmHVB/c7Bcek9b3FuwbdD/kjGWgzJjQ3thGmVA3jhfOyU+RxB6FamOFp8NrhsTgLy8Cpzm5QlVptAU+6CiNgXCaIQ0BcDYV8b0P4pi30vfIxD5+w72C9aliegW8MHzqrmh/meuFhYi0pKbs6D9fsh/n1XFMrYMbPgUByCZz6J+uEknDA9AornWFRb01WZEsACoHhOqyC7wdetT0QAK2KqOb5MCUvPyhLE0oQxzqaYNXL5xBvyVXe12vByLADjXAvgxBvSPGFGMIjCmJbEW8HfntxtQmxT0cmxp9UPAdKAZ1upA6EB7qgDo6oCUxXRtPVSpAwJpnUhuxAqWCCYK1MBExZljY5S8SYr+pxAFAuBayhNG26jw8usCQLX0SAAkwwcAEngyQizaXoziIli+Oe7/9kJvNk1LmBMe9ECO3XRB7aPeF0EYHNVPdT8gj016YBcWtBfBVYJuz7mF7VgGY/pO8f5WdQ1/7U67nIKNS7j0wIbDPFZsyNHHY7od/xdlEHj8CcC3TgCWHgGAPSxiSdt4312u/8SPAl8/Dlh4pDeZW2PD4J1c9+uyDaIDkgEJQKnTfG/N8nUAmu5HUnMW5ARbPfEuIHy/ACjRK7FL5pOR4RaxgTHofKl8r/S1ZWBnAGDKefbn3AFIPRPXB7sFiVQimKVgGdl5ooNwLQ1/1U+DQGSXQ9r5Evy1q9rZbP1lGQDZsPpzI8APHgXgod7qUx11YtBbFzC+/C+BL7SAWwhgdoLkONSLqy5oLogYft3ZI1F7EAC+phsAnekokhP4HIzml/PvthQWmPB9LJ7jxkcSr14jWj4/0wFlgJD5eoDw6fe4DzAYPHokWhHJZ3TFSkn4h7YOSOBwEtiMTv1aY0uktFYTmI2/43EMQmCuAJmUE0gmVD8EFdPpdnxhVhqzDr8F4NMtYM9Jfg98EVTeNu9Q2OFZBX7vr9vtgm/lcezczZ61ZNN8DCvilYCdPXqNDQpAlfGTKm0M6AA0PTAyoMSx64cRfPQHXsniOTI+fEWDFGp+Qb9BeySRBV2kpl0QxxGAlHDmkI56X6z+EP7UDYSdRgh/IouwIZ36lHabBE0GJ0r10Rgb/xA/tt/j/6aMAf+7R4CxzuBXWRGULwBfIrY6UNfpvLae7n0I+LO/reoLMqiVMbW38oUhkNkQIzZO7tIweGePcmWlAFTjAYHPVGwXxWoLYblEDkLuTT8MDPhXLJ4jALpaJB+ggU6xfgJknT7IKXIQXh4Y0FZCog+wxiUTwSkXUbSMV1rB/A31OXWuFpPUda/mRHKi1e6U+hA7Zq7l+A+UAfDtHg/LrptkQpZ727cRWOL9542Pa3rOvuOqagUltgtmJM08j4/PILbIDKz6w5PAHsbraTnMGdZWIwIzxIfeK0rn578J3LAVuH8CODRahV/FFQ/1IumIvXP1QudNfyNT8oVqcHviPcBd48A0g2RDuoDqHdb2SalZAdG9dnfDkAE0gXnH5ijWCDbKCq5/MRiV0QD8HgHQ63jG0hdsLGxA3x9Bw1Asli7hO3BwApgng/Gjvq01IHrXJ7q3Cz7E++YziF2rs1ZLZ+8H9jJsSoECWXj6igmR87aLgfbGq4GvbgLu2gjsHwdmCEIPSI1h+SkCRjpfUC3iNWcpoRrcnrYbuGsUOMBo7QBCxSTG/igxVcBIVGPWM1h1JYQPnyKNExGZMDIJ9b66eEBGxPDY1Y5nv+GCjfGAxD+DDpiawphABWZPjwNzNLAEIH4XCH0M7/5c93bBfI8Yk2cgVAdvdT10ifDkBWC/r9lGH51NhIsnsWHOfPmEUKT94WeAG8eAO8aAfWPAwVEHISNQlKQUglJjJExqC+H6Nq93kOpUg9szbwLuHa66QzFWkaFieXxi6hgVHOMCYGRuJ+5V4jYJIDKI9KlsAvFDq8QDrnb8NWVPh9EwdFkQ79TlSMIsN0Mi5s9MoOGno4U6f3YAvefL7Y7rvdoFLxOANSA8f7xSgWmd0kCQbmZ6mTLEnJ0UqWLhUkxlrBn6n3wWuGkYuGukCsufGq2iojnRFpafsU7MDxErJuZhYCsJosHtWTcBe1oeq+hxigJgXBrMmTBPnJKLrr+VED54ibHYvZos8sO+DNcrHrDX8YVVyglAKud0LtMjFPtNMz6QLDY7VomLJd671AEH4Xu+3g7nWq28ISvX58/hguOBg8vtFQvV/hEzxfqOevuTfpjri8vAWz8L3NYCfjBc6ZYHmBcitnFd06pxyb8W4gPlgonBqffTtdTg9pybqiVNBssyUsdUD7eGO9amnf3sXtxQipl7Wg/sD4A8AwHIyZMYky50Tp/xgN2OL8y051qw2hXzwRCEdT2nmck1RxHG+w5jeO9NFQBpR6ldMIMXlFWgVndqF2dVFsJzuOgRwMElB6DcI6rznemD0RnbwQiSRS3g7Z+tVIl7PC9kahiYZm6IizuLigliT/VoUog+p8P9l3wJ7qGEanB77k3VczroUToWLCsABud4ypaLCUoxf9i/9w9ADiICULrQRWuIB6w7nuZrwaZwLBGwClSqSyz3AhHbaRGEFGOmC44D72UVgjW2C2Z4lIF4ArjodODQcqUGqAxfcpG4mJVuVqcL5tbs2z/veV0tYK/nhTAqesYNHdO5PCJZos+WuzxHJIViuXFyJxupNLg976ZK2lizUKodilGUgzyGhokF8yw5Mf+qRkjdjfuDtwkkm7DTkNaBaQ2ox1q3eMD8+B6O3H6em8Kx1Ccx9ptWl9iYIUAAWrI3I3nHgPdOtsO5eOuxXXBdj0V1vOL/so3Cxef60tlSpYwveKf0pAu6ohfdJ8k4CUqgvr5jV6VGTBKALeCAh+VbZLTnh5gu6D44A6H8cVlkNK95O1WkBrfn31R5HSy+JCwPplAxRegE/2T+AloGncNmbQyogUQx/KwB4gHj8YWNTwRAOW0FIIIndoqNkTAxz/bd09XDGLBdMM6/pLKi5whAX60gCK2ujxzEAqGL2pQ1Jis5AJEAFHvTujYAKjRf+SEugm1d2COQLU/DAwQ44caEw8AtZzSIPgAvuKkdrWMM6M7xCMBoiBn4YpCE2NCfxWAA5MEuwvCCEICwlnhAHV+YORfDsWJGgPpMKwg1b9QpFnzHbD2BK2JGul9s8KkYW17vLALQRTCBpzXZpS4gtCXXMAkduuAy8E7PijPWprXJ5CR38ygw1fJDohh2BlRAgq2OeN7uTWc1D0AFNtmL54ESBsCaJcLkDajxj5ZXRiCIGA0waDwgjy8sk5+HY+X9ppUbJSCp6TnFCMXwny1WAFQ8rUAc2wUrRL6mXTAefWnFfnz3FpbagQKLAqAzoZjAKkkpXkNO5GCEvOMLFXOnnC4xIKOjnQGNdWSM+GqHQGd7JSsxUf+JzQLwhTdV4je1nQvr1MkPGtlf9yP2Dy+gAqZ6rQytfvdHSDxgLwBF8AmAYjHWluEDiKGMiqOVvtejXTBOuRSYJwDJAARgZAGWL9Nk+IM3SzgTydE4eec1nZHbtDaNAf1Dpd/SMx2END6kD0oXtFhBXmcY+OY6AFChnKnzl7NfdMR3qCAae2B+VVMYXASvDs3/X/zHJZcB84vuiqABEo0QPnhnwqQLyRURmZBPytnwHde0M1vN2lR6picoKULaxHDIEdHkW2iWg4/7b5zb7DSQAVd0/griV2JYojfpwRGEYsGBrOBmx/OgP5sAKANkcbFzNWTRnX/GSGImMYH/LYlk+gGvdT+bW+SWH+Ig1GqL5QeTtR2EYj5LVHfjw/ZDwL8yJ6TB7UU3VVoTjTYxYDK+Ivv7dzNAZIxpZSiU8jjKgIWTcykZkBawDBBnQdMr5QeTKI5iWCB09AmEb7+ucnOQ/aTPWn6wuzyS4u+R0Ob6CUGqJpIDA97AdqINbgRgBJ69CG4Jp6q/ckjXqB/RKla4WpkO2ODgHoynigA0JiLwaNiEt95YQKJ4FRC+7brKzRH9jZbN6iJYuSHm9I5iOAOhHNJfZkh+gxsBKPbLu3+JgaWDdojhMO5kkDWSlNTg4B6MpyIAjf3IggJgMD4MCARjFMU9QCgAykhSKnUCYHB9JB0wy5aTRUxmup4h+Q1uAmDs+hpXgFLnB6ULONOn5xACNJqxghsc3IPxVBGAiQG9aLeilWUJW1FvVXEN0TKp1C6At19TMSCBpz1dHtT/JH7N9yaxp6QkF73KBxYIr10nAMproB44qQGTj6sjUrtOFPtLeFQHLES9AdDFrq1E6M13MaxVCTNAXNFThIylLcor40zxtgDAPKuVwDMrOKw+SBTbtR2MND7sZwC7Qvm4wqHa4T/uIrhb+7n0EgbQdTijoyg+agWXT8llDsAFWr/B8qP1K7bT0pvtVwHhW6+t2C/m8svvZlawi2CKe37nhFtapkDnILRqBQA+v04AjMyn79EIkXO/DnzyCBwVweX4wxs9B4rRZgyPVFqykgDd+5JSpBU5r0vHyHz+jsc3ub0KABsZMCyQgeExKyFPVIz3lmcM6OfPAGCADYPE67Jfs6h7G0o+xvi7oyK4cLZfOgpsXwC2Lq9MwuuVERonKn4nSJrcXnQKcM7dwMMXgYcsVxkSebJgzOWPqdB1ad2f3gpsnwK2LXWeR9m3danUIV1lBSCPArBwtp+7DThuBti6UDWDmWA/DvXk8LRptfPtNUlihYZTOPCi04GH3wFsnwGOW6iAs5n3GeJJ+KLoE+9VDClQ8R6vOQHYegDYwuY3S6H/iJ8jb11ck0q9Qhoc9QMWgPBZJwFbpoFN88DGRWBiqQIgWyJY3lPozaGJ1KTEPh36zpTkJrcXPRE44S7g+Cng2DlgyyKwaclfFoIwvCwx9Zn3Q1DmIPx/2/sSaMuusszvjfXq1ZRUElJkKsBEGQyYhJCBSkUqAW1tsBdpuxEVaBzowXZqe1g90G2LotjQdmMjKqtBxQERdAWUAkUlZNBGkQRNyIAEMAkxpFKpqjfUG3t9//m/c/+737njPq9uVeqcte66b7jnnn32/s6///3v//++Tz0dmD0KzC4DM6vAFpd/0L3Gh6yTDgnvLwKzAWDGiH/ThcC2OWDrErB1pRgQisIQhAa+AED+HEEY6uNLyrRnZLSl6tSbrgLOeBQ44yiw8ziwfaV4UGbdegmA5QMTLFlqsfn7XecDW+eAmePAltXiXnkuZSBkRcm4UGXtU2uo3xsAZgz6y54JzMwDWzkgBOAqMMVBCSAUObh8QuN/CiTgcWAuyWhL1amvvBbY+VgxbW477paa7gIBqCnUrbUBiQuhAKDUot13IbBlDtiyBEyvtO5VDxvvVfxW/JkWNFrCeK8NAGsY7BsvKQC4hQCkJNaKy2LRIsg6SJ3IQSe1onKKC2CsOYMeN+0Dtj0ObDsGbFsEZmWp5S74g2Ir2uA22BScAJGA+dJFwPQ8ML0ETAUAkgDTPq9zdK/+sMWpPF19NxYwA4g3PtsHxAE4SQC6FdSgmGWRRIJLZJll8EGKjHiX1jwaN10HzD4BbD0GzC4WrsKMW2pNobZoCu6CLCDfCTqzgg6sr+wFphaAKQfgZHKvpRSYg7HN5XCL2AbAZwPrZGaj6ippXhgn0kqmU1woxnHedg5AATuWHig2FE1uVRwoxoX+Wcbg89S3AqCKPONcCi8oPtVP+9++G3j+oSK2xRBFDElUxbTS+3nvc4FpDsjxllXQoJg8FgdCQoGJJTTicLcQ6vPL6wbg9cDM4cJv27oAzFA5ky9/UOSvmg8oP86n0dICBn25JwjARWDSAUgBHN6vfdbv10AbARh8X91vDM2ss+NvAECKPVLCsHoyUgRqrlbnRwB933OBc+4DXrIC0IEmiLnE75di8HsyAcjzWUVGUi6uICMpVwwJVMXdeOk3XAxc+Hng+vV2esAYw+sWoP31r3eLcLwQBeQUrEHh4Jo2h4vDmJPuAyMLGAeEn7uqbgB+I7DlSWBGCwe31Gb9aL20kGDb/EGRxY6WTz8f2wtM8l4pgL1SgM8esHCvsuylME4nn9cfQLtldg6TZ0kUKorAfij23vAPCmqp3fcCl60XFINid1PlZrf41/dnApB6wSQjutUfIDJR8CGIQOwWEH7DywpKrWc8CFzqRLHkVYrB2jS2FQH5vkuBycXCAlIUUAAkCM2iRBA6+ARCe7DjYmQduLYTleiQ/XTTS4DpI+6nLhZW2nzVCEBaMLd+soIGqjD1ampdugiYWCpeBKA9bBJC9ActAk8LES26SqsftInLZ44dQif4Igdhym5WLrPDyuYH/7HTCNwDnPko8LXrBccjQaioe6BiKad3+QY/MGTH6rS3OBvCnQDuAIyqhiDkQ9RX+29yE3on8IwjxQPI8zkTiApGU3oVkD/4fGDieAuAdMw5MFQjEgg1DYsUku+a3uI0TGBfV7PotwHwaOEmbHEATvuDIutni6UAQoFRIFRYhfe/dhEw7tbe9Of0Si1g8HkrwRcevDajz07gIJ7n05rYyWIpb4ya/7vv8PRdFpj/LXDmkQLAnA4jCCOlTBRN/rFMAJKgkkVHpGUjySSBSFeg7/azqk8EgbSEq8UDRACLKDXSyaQ7Br//DcA4LSCtwnKhTEkQcmAIQhtM+Uaajl0uS9NatITXWzpzfcdNB4DpY+6nBgDaCtanYLN6fCj4u1ay0QIqtML/EYC61wSA9tAJeP6eWsAoDysFpg1eB0HIQRCIIkVeCqQf/05P3WCB+UPA+CPAzvmCaFWDKEuYcl1yMN+Y2dckqGTeHPEvvWDSNhOAfbefX0A6rS8CUw8X9066bFIfdqMHJID++DJgLACQumyc3gyAEYRRKFCLD1eu5ODLF6QvXedx0w3A1BwwxdAJLTXjd8seQnGrZ9bPFxLyA7WIKON63tYtCQBN/sv9QPm6BkLp0vl9t/m6ietR6fbyBA4gnXtORwRRpNnTtPpW6gWLH83lKqcOFTEnDiKtoHwy8RNFhrefyeztbnrBfbWfgttsP+kIyO32ELD1cHHvInrlvWs6TsnB7qAUlg/suFtAWkE55zYQ0QpqcALoNCXTEt7A3KoaDwGQfqoAOEUBa7fUbKctltwCajVbxvSiyvoasM0BaBKwwdKb9fN7NfcqBWGiSWykWXER0umeacUEonQgCKRfIgDFjya5yq8Wfsfs8dYgiuMxgpAg/vnMzu6mF0z6Zj5APdvPQec0TEosnvQosGOhaLuIYvnwEYSithE52F1XFAA0p5yigD4otCqygFKnpHUpLYP0OcKURYv6Mj4MNR433QhM0gL6QongawOg+6rl9CswKoSkEIxPyTsuAPigCYBmAXVfYcVf+n0SRYw6dP1YwNgHsgSajiJP429RrpWOM6cxDiJB6NINM4w7LbUGMQUwB/M9mZ3dSy+YVG0EoBiDBST5ddZ+PkCsAiIlQZDa3LVatJ0WXG2PbL98AB+4omB3oP/HgTUhmGgBfRqWf2TTrUSjExDSP/qWzQDgfAFAWyzR8rkFtDAKX75jo6nUguZxZ8NByHbvvqBQ36T1swcsBaBAGGRg40Ir+rt9WUDhQ5ZAU7Es2e9LLzglqHRxNkbeuW+oQRRls5jaMjnK0a9ecNf2R4LAwO829kQB3LTtEYQPUwzQAWgW0AGo8AQH0ljp/V17pm0KRcEifGuNOnocO1rACQbKPXhs8TtNwVr5uh+n6Zf3wDgu29g2FdMtOc8B6PdpFj08ZFrplw+ZA5FTvAQQ0/BT36FPDkRqBT9Jag7xYlQItY0f88j78sZzCcKPZlrAQfSCK9uvB4h577SCotUiEJ8opq8IQFl/PUBPEoBLxbRE62LSqG4dFB8r5bHcOtiOQSqT5T7RKzYDgJx+BUCCTxZQCwhaQc9oKcEnEBKknj5FsJ1LAPo9xoWWPWDy+6IIoqbeaO0VA+zHB0zxIQDKkn1GgtXiRxMIAx0Vn0Db+lkuFjLRCt5WEwD71Qvu2H5OfekD5FaciQay/GIbFgBXriwAyGmJADR1ck3DwTE3TQ4B0LetzBJErTYAr2BBSI3HTS8tLKBZPo/fWQDZp197Z3scjGb5BDp/L3+njMweB6B83Gj9wj3atOsPWin9WgXCFlVO/3ctf4iD8XkBkH5USlAZlNPZAQqARr5vxu1yjmH0givbX0UQKI63o0Wun/xHuR8E4VnPK5JQLd4VNttTBvK2uoiKOUf/f+GjwMNBh0NMV6J0c0NpcRv7mrYv3kh8/uHxYp+bVpwLp3R7sts2YzouSq3KGa+q7+x7Co4nazAerRKsVlV1QitF59dyyFZaYY0HMu9mWL3gtvZXMbymBIFMZ1ov2h0B+LTLisxgW+Eq5uU92iZ72ud9vvR+4JFp4NjkRh2ONi0OB1/UBCkvEYRhfuNs4OmhhiPKnFQlx6aAjMnSXJUAACAASURBVPjmz1w41nnwO4cCIBvBwZgTAOUHRq3gyDExD4zRGVYEnpm5LqmQc0M5esFt7acFl0SlHiBxuTkYxxdaihUC4QVXFu5FCUD5QtJl85sjGA0ziQxqeu/fem+hw0F2fLLQGxFlYMRvo7v1WmIVtpt1DFkXvOR7LwJ2HSkyoZmEypoVVe8p7b6qEMnidGG/Vl/L2aPOIwuA1pAIQE3DAmFa4j9f7CPaFpCHKujr5xzZesGdHqAqKz5X+FLRAl58le+jui+kTBALMcgZ73CDBkpN2/7+bfcWOhwUyCEAjQTcAVhKdjkPc2RajewKyu/n1//qJcA2uhBMRGXQOcn9U6JIOjXHQqSYOsVoQp1HNgAvz8yny80H5PVz9H6RqVd849WtXQ/zA0Ow2ayGLJ474L0G79vvbulwkJi8BGCg4S01SKqofoNvSIC+5zkhFUupV8rUTpJN06KpaBkFQm5M1HlkA3AyM5/u9Zl38zrk6f0iU6/4hmscgK5ISUtCTowyDqb7UxwsqFJW3fo/vbuIBJEZ1YRgyHwQKNi0KEl1OKTCZJdxtPDn//v8ooaDaVgqFyiTD2IKfcjZS4Fo+7g+HXOPv84jG4DIzKfLzQf8KVfI/FNKrQ6h94tfz+vOA9cGAAbrpylY2SDlVTTt+uCnV3/V3a7DQQAysJAwobZJgUXi78Qayhd812WeiOAZzEyUiAkHMeu5BF5FwZQAWLPwknkLQy9CrPMy8+lIHZFzvN3T+YbV+8X7c64OHHix74V6zIxB+RJ0wQ+UU992tYoFy3fcXcTDxQkoPsCUhFIczKVCegSg5B8A/PILN9ZwxBSxtiKiUAOi7JW0dLTustF8AGbm0/1o3vjjnSGdj+lYlGwdRO8XN+c1wABIoHk6k61yuSCJITq3jDY9Vx0BqK++uwAfX6JkI/hME0SC1EGguiQ+isqcQRLrF6/0jO2w+6FMnZhyZYsQ1W50qOHgPX1NXndtODsfgMwHzMin+0+ZN0S9YOllMzWfLwKQSS396P3iY3kNOLDPM1y065H4gOW3p4uTDkB8zWdb7FgbdDhEgJkCUDRvogTmd/vPv3BVAUBuvylNzAAYi4hisVQnEHoIqWblrxqm4Mx8ujfljT+YjsWBYgIOc0oJPsq1slCpH71fKybJOEoAuuVTRSCnYlmU6P/Z4iSJEcbLv+Yu9/1EAh7JKEXDKxq4ChUiKymRbwjgHdcUWTARgLYXHSr2LOU+BV7MVwzxwOfkOWybYAGZD5iRT0edjpxD6VhcOQ6j94tP51wdOHBdMeXa9OqWRcmWXA1XLUIUH6zyCwlAs3z+YBkfs1u+VIejJEF3ckrjI9T0y/aMA2+/tgAg08VURKT8vbKMUgAMIGzzAcOi5HknHQAz8+l+MW/829KxhtH7tTz+jIMAJPCYMULAWd6fvi+EY9ouoZBM/Kx/4LUBgFLgNC5o16FrE8JJVJgkiFhaQQBv3+dVbMrWVsC8UxFRkjjaVsW2DtRdOJ/vAyohVYK7A+bTvTdj8HlqTMcaRu/XxHkzjgNkIOWuDr8jnYYDKDutgpUhra0uAlAyCCUAK8BXcjBXgLCk/h0D/hcByDxFAdAzoFUqUBYRJTUcMWdPP7ONL6i5bLQeALJRQ+bT/W7G4AuAOXq/lsGdcRgAY+glLkYclJVTsa6ptCX3uQjAKINQstFrAZKIwWxQIhIJuovB/Nx+r2LzFCwlj8Y0evl/MYk0kieVtcvrwGUnHQCVjjVkPl3mItQsIPuElx9G79dOzDgMgGkAWlNyBJn8xKprBRC+zgEo4LWRgcdVcOCjjlNvmx84DrzNAahaFZWLygKWxUNibIhTcPD9BMLLa65bzreAMSGVoXvJ/Cgh1WUfO+XTZS5CDYDs9GH1fnOrIDcAkABTTDCCLYK0Cwi/586WcKJUiEpC8CCBYDsiiSplqUIUmOjf+o2tIiKVUJbgU5uSWl4DWwX4+PcXnrQATBNS+8yny1yEopdcay+930y5YhgAg+9n2OoUeI5TdQer+32fdhmGoOBZanBo+g1yEKU4dYgFSvqB//vZBIBt9RshkTbW8ZZZ2hUgvDL3iU3uux4LSBM0ZD7dPRnTH08VAIfV+2XAOucQAMuVcKfFSD/+IAABsEoGwYAoHZIKEEYxRIHwLS8pUuhjFVs6/ZZhIVWyxVKBBIRXnbQATBNS+8ynI4tBzkEACv+chlUVIKE/5cRGsWmlKfIzudc3APLQSlg3E2OCyVRc1kpU3DgBmKoQsWtlBcswjPu+nfTYtBL+GQdgOf16GCZW6pXlBCqWSgqJypoOAFfXXDifbwFJLvi5HAjlnUsiIe6AjOp4iQNQHRlT2PlgJCUbbc2s+v/hFwFb/q7gm6HlYpBbmTV2sscQyy/qFBj2v0/cAdz/HGD7NDA1AUyOOU+1CwWOewNjKj6/O03F1/WuugW4/XJgfBoYmwDGdH7IxB5kLPIB+I8AfNwZgga5ck2fJbEm8V9zNWPfrasbgMuPAcuseJ8Exsb9FdBhA+7gaQNKB6TfcgCYug+YJT+g89aoBDMmIMScP12uTKj13uDv8zsKig/uJ1uQOsnojm3qB5P5ACRBH3OhPuzzRN9DV88HqQLEWPJnvTy5nm/t/1s4BcuSpRZtGAu4fi+wtBVYEyccrYwn6hF8/FkJp9bKxAKVFsn/d8urgbHPA9NPOEOWl4+2cfoFHhfVrJTZPKHSj5daOtup6JyCpPx8rHWRVQ7WOlrYCMx8AHIzlxkALPD9c0VB+x/A3E/+E2fUYHXdF7KTGwdvTd0AHP9r4PgWYG0KWBdfsBdsMPfPrKKsoL9XAVLAvO2fFylCE4cKliyrDVZNcGS1CqEYhWFiAZV+XntaURdTLmpCEbpchTYLqi6NrkMCzLzt5Xc4HwyJmmkJ+Z73jQOh4NWeDUZiK1K08f0EXt7CMHVawIk7gaVpYJUA9LI1Ao8bzKX1cytoFtFfpdCIWz7rgzHgth8u0oPGDwETc8CEMySUzFaikgtlpW1Ta8JqNba7lVljSRgW+Q6ZP/57WQvj6fydBjXfAjKbgEvMLwWCvhNoipgNpnQshlS4IGFWzIk6ylWwAz93ETLxGWB5ClidLABoIOS7pmGfG+33YAG5mND0G8F4678vkiPJczNOAC4UyQm2N8w94kirFlfIAl7i402d6dbPWWAtrsjOFiuCvAJZOQE0pHTFsckHYDeCvhNgipQNxoAz8/8IPr5nbvH2jd+6AThJAE4AqwTdZKEBLDoDgU4+YVkPHIBoPwareOt/BkDexsMFAFnbzNJYm0IDnVwbt4uyur1kwL7Tp+iZM/08WT9Rc7DHUmuYTr/x+6o4ovvu9fjBbgR9JyA+omwwxvZI5ULg6ZW7y9FPf9QNwKm/CgCcKABovh8ByVy/UCtJq2f+X1yYJPGU27lIZLbuEWDsWBHesZeDz4iURLUWa1TE47LqK12fZmd3OXidFctqm92KatVs1jAEsNv6sdymaa2g8+xUL4I+Pn2beCgbLGWHI/h8G3oTr45iK86POlbBU9yKI/AcfLR+ouQwH9BfmmbLlTHboOnZ/T9+5vaf8FUaAThXsFOQ45mUcgZCWTAxe0UQ+urYMO1/37GtxQmoLCBtRSp30LrDp2SFdzYMgk/R+VNwvwR9mwQDsaspGSfJgYDYNTbp8psCQFJxEIBkQjDrxt8dXCUIY+COH5MVFPi8SOn2n/QYLZ9Gp0cxANIP5IvAkzVzxivRydnKNzBa8fddM84b6AFyAriMF2pajk9kYIeoClXmA3AQgr5NQEHMBqMVFMNaIOayNRL/vhlH3RZwmhbQQUcAasrVVGz4EtjCu/3dfb/ID3PbT7uKAZ/MhcIC0vqRTo4W0IBIEAmEtFwCYqjW03bcmdwBYeoWgetUbrR8snrloiR2drpACf+rD4D9EvTVjIJu7HBV+781X752Czj9lwUZkTEgcPoNPp5Nv4oBRhCG6dd+1DkMz1JIhR1BAHJ7zwqO3fIRRM5tmDK5CoQKsSgOeBYBKFZULTqcB9r6Ni5KYmd3WKDUA0BlhNLM8EbT1QBXBU72aI5ZjUcVOxz7WLkQ8d37vsart/uA6RcPsxNSAtAXHDYNC1AEpf9s01kKwuBwGU7HgVt/1jtD1e60fgQigSe/j5bQp+KYpGB+H62jT7P8/ZypBIC8Dhcx8eY9wF015abhmnoAyJ5WSrKeNgKO9SHxnT/LSasJBim5lRjWBEIVeROInKL1qunybRawLgASdEy74qjaNNzJCgqEEYzBGvK0297mAFSHEIB6ebKDgc8J1ksmV8t29f1en6L5v6cxIK5iK6Xne/5jCTiFcTqVn/r/tWDPWwXnEPTVgIKUHU7ljASawKefIwDpMdRxRB+wFgD+RREDJABpwSzz2c0LfxczVjkVKwaYgtBBezu3SvX08d39P5uO3QKahXMQciourZRAGKZWar/YZ1xXRPe8wQr2AUK7TvbOVTZBXx4MBECRnConUBSFEXT6mf/TK+/qmzAF/0UBOPqBZYF52HrTFCw2LH5G8UCzJEko5nZqmRnPh/uCXmpnVpDTsIPPwKApOaSA2QLDLSHf97iPx0tpISLfz7bl4iFfsUsnj+HZWEeOYDCDnDmCvZkEgedcCjxGseIhBYt3vx049HwMLRh8gA9gh2MoH9ABqKJzxf0McO7XlSAU4HzhYYFq+5D7hwBu/98OQLlIBCKnW39SlXNY+nqeiq2dkQg+gnGPb9/ZpT0lq6MV5D96gLCwgDmCwbdnCvZmCgY/dxy47xxg5SWuUjigYPHFbwA+fyGwfr2rXrMvPB+vp3L3GHCgi9JOHQCkRVPppeUBigXLFymyejYTB4YsgfA20ofRAlYB0FfAlvQqP0/TsX5PLOB5DNu471cmIwiBaRww/F01J+mz2pqChxUMZvpJlmBv3iTocsW4dzewfhkGFix+2febXDAeJO/YEILBB7pU1g8LQFo98QASVGYNQ6DZfEG3fnEqrgLhbf/HV15anbkFNCvohWSl9XPQ2XTM/2s3I4DwPIZwBEDfgitH0Ek6N6x+u/iD7T4g/YdBBYPpWHEaHlqwNw+AQa4Yj54JrJO+aQDB4pt+oCAyYvOPEIQDCgYfeF/9U3AbAMX7ItAlVtAspKZdz5SOlvA2pstxjES3wJ+92NgAGK2gwi78QoVfEhBeQACqNNP1RdoA18kKdgDhxkUI/zKIYDCnqyzB3jwAJnLFOEIW7QEEi1/1Y21ywVglCAcQDD5/Efj7M4CVrZ5AKlkhxeQUaxBI4nvFzxf8IfCVC4HV7cC6ZEX5nen3VX1vAGLZq8ysrvHY+QBwbGfI2E6JpLvdX+ksthpUvQrmX/sVDGZVUJZgb17vJHLFeGQcmCdVb5+Cxd/5xjZ6QzzMLOQBBIOfTV2Ps4HFHQ7CLQUQmUrV0rgKJMsCjsxGAqTn/hzw0EXA4tnAyg5gbTYBorKkUyLnkB9YVhTxu+kT13iccwtwdBewPAus+b2ar9xJAafqfgMQO4dh+J9+BHe5gqZZZzYok1JJUcpaR6bp93P+W/N6p0KuGIemgEWKgPQhWPxdP7NBLhiHKYHUp2DwpZ8rLOD8tmJQVplOLxAqmbRKC6EDYC7/CeCRPcCx3cDSrsISrs04CPm9ArZk55UvKAspYLqPaPdR4/H0g8DRHcDyVr/X6VabLHk2PhjpPVZY7d5xwF6CwS9y/4LbbVyQsEKIufGiKe0p2JvXOx3kinF0GjhOQY+oNRtljji9TQPf/fOV9IZY4Gq4D8Hgy/4W+Oo2YG5bUUy04vUcLCqSJVRWszJbNgxSmMau+q/Ao2cBR88EjtOqbgNWWaTkIFz3YiWrF4nAjtN0nBZrJnU+/8PA3CxwfMYB6LUra3oglL0tps6wlVha5rLiqd9AdDfB4Je6U0s/0BXTDYh80Sr2FOzNA2AXuWIszABL1JaKWq1R+nwGeM17OsoFY5XTVw/B4Cv+Djg0C8xvLYqJCECzgsxmZlq9T8e0XGUyaUizavPtxoFr/zvw2BnA0Z3A8e2FVV3x6c4sqwObckeyhiXAowUSADhD1XhceDMwx37lvU4XxVN2n3rJIocygkr/Vbs7fe+EdBLcfaXXQ3IPWIrpBB6XlnwpR76jYG9e7/SQKzarxM7qJFj8mg8UarMV9IZ4gvNDD8HgKx8HDs8A8zMFAFnPYQPDl0Co2g4fpDZLqKCxT0/7fhJ4fCdwbFvhRiwRgJruCOwUgCpeCvUjZmEFxhfk9W969kW/B8xvKQqnVgg+B6CB0MsI7P70AHgmd2n1NQ0rv7FvALIlVYK73MnQCDLThSGZoDpuP7uCeuX5n8zroB5yxThGnQ0CgyBMxY63Aq/5aBHG6EBviDlOLV0Eg1+0AByZLgbl+HRxnZXJoqqttA4ODovlJZVuSjTQFtq+NwNPbHMAzramdVpVs6wEoPtdNg37wJfvsYiJP9NFqvHY+7vAwjSwxAeNxVO8T6aNVRRRlT6hHrJ0Ovaw0WDJCKng7g86APvNB9wg2JvXO33IFWOBgn8EIf2nRLD4tbe1+AU7yAWbZeskGHwVdd2mgAUCcNKnJgLQrZ/V9/Jnn5JUYmnAE3hCmv3+t8AWQfSzyPK/POOgJgDdsgqA5nfJAvLdLV+bz0kK4RqPZ3wQWJxyAPqDVhZQyQr7gyaXI9axWCFVAGLvRUhV46PgLnUWBs0HbBPszeudPuWKsTRZAJDTo8l8ui/42juL5veQC7ZpsEow+OrZQlqVVuH4FLA8WVyDAOTAmHUQCAWQkOlsQAwDt/9/AE8SgPQpNa07+AhAA6HLXbb5Xr4IaAMfv/eGvP5NzyYA7UGjBWTWjh40v9fSyscHLtaxhJWxFVsNNAXH1khw983+DYPmA5aCvXkdNIBccemfceooAfhAAcA+6A2xLuAGucxrzgKOMexDfV9OwbS2BB/BEoqLSrBoYGgJ3E8qLcIEsP/ngCPuUy7S13L3wb6PU56/m/Xj4Ps0TKCXQA6AXuNeZY3HMz5QANAeND1kwcKXlj6wOZQ+b7R+Pi0PD0DeFAfk590CKg8qncfoFzIRVWVqfFfBhgn25vXOAHLFWCDbvPstBsJZ4LUPt+jdesgFg+qVptWq11bg2gtgfuLiRAAgQeg+oEmsOujsXb5SsAoCIN/3vx04OlNM6Yv0tdx1MKvK7/TFjVmeCD4HQQQhf159eV7/pmc/kwCcKABoeYvR0oept7SEoZQ0Tr1lPuPQFlAtO0nyAcWhpzw/FSjFzGjLx+RGvxzoSeC1hwsA9klvaFN5FAy+9mJgnhaQ0qqagglADo4c9AhCDpJPl5ZommQ8738HcGw6AJBW1VecZv0cePwOY0/wl1lAD/WUCx0mMlDLr8bjmb+Dwp3x4nkDYbD0thIO5aNtfmDi/xGEeRawxhs7Vb/q2huABQJwAlhyy2cC0xoggjAAUCWWAkksOiIY978TmOOqeqqwqAx3WGhHK06n7TDwOcAV/iipPAKjwgrZm2o8nkUA0gKmAHTrp+o9MTrEYvq44o9pZIOtgmu8mafCV72YAKT/RwAy5OPOuVlAAk9Oule6xQRTWUKlWtkU/IvAHAHti5oIwDK841ZPFtCmdr0U8PaC9hVultd4CIC8P2Ztt/m5/qC11TJXlJDGGpfGAmYODgFoCxACkLpuWh3KCgqE8gNVZK4KtxgjJAB/2X1Krao1rfN7CWZf3LSBT4uAEIyWBVpipL7GgwA0AW25GbGENBTRx3rm1M2w39mmrFVwjTd1Kn+VAZALEE5LtIDyMWUBvbLNLGHgd5H/V07BDp7r3uU+Jadgn3ptxekA5MBri0/Wp4wzBjDbCnkMWMqVpE8GJwLQqvfc0pqbkVj5aNk7gbCxgJno30cAjntowtXNaZ1suvSKNhsYTcVKmw9F5xGE+94dfEoP+JYhD/8OC8eIPUsUHokVVKB78XszbzAF4Pvd//PCKVGIpOAr78mn4DZOm8YC1jco+w6EFTDDPJqeCEBZBa5GffVbhmQ8DtZW5TYOvPhXip0GTuu22lTMLSw+aAVl9QhEWjurI/aQiLJkTMLsX9R3r/ymZ73fp1+37OU9hunXSkdl7T3QrhKCtlCM59k2i5CMMSIAGdqxEIwrmptzTsCEut5yilKoJLAcxCq3fe8tLCDBFwO+tKjyuxSCMdYEXoeDrHcHvu0tTwLzmwHA4N/Gh6zNCqqeOSxC2lb8tQSiMwbuqXIqAcjFh2JjBKGJyShQG6ygVbfJegULWBYcMR3rvb6oCRaQwFPgl1M5rR7/JtBZOIZWx/0+s4QeY5z/1/X2tFnAxPpFELaVkdLN8MWGVr4pCBsfMHN8bmTKfCjZ0Ncp456/x58zLzfw6Qf3ABd8pUgEYmqk5bGyek06IQl1bkXScnlN/u8L24Gdx1qVq91KQvrpgwaAAw9p+wnXPw1YjyWMGtDo2ASOFGMU7SIEUzdYD34vMPmXwLbHgdkFYAtlGiim6DpxJtvq9LtlVr/aWKEB8pUXAOOPAFPzwBTZ9r04vdQ9Ts4pAZ3cd+yHxgfMAOH+vcA69/9Uxijmz/AerYpdar1lNSMYzV+vWY/34I8DY58Gph8Bpo8A04vAFEFIknIHohGVR62QhFRSYjQE6qFri2z3iaPAhHNNlxKwArI0Q1IAxwfReacbC5gBPp66/5ICgLKCtqnsrKKlrFZUFPKOr7osMTtdsxzqQRZ93Q1MPARMPllohUxRqkEK6gShOP0S+dY2hlRv99y+ovRi7IiTnTvLqmg6xDPYpqAUgRgsoR7MxgJmgHD/c4E1FXu7FRRbvEgd7evXWlbPpp9EgUjiJpwe6zwOMlvpAWCMVusJYPIYMOlSDZRpoGiNxKzbdIQlXONMWJbGtw4svdgz3El47nzTRvPrrKptAJT6ZrzfintvAJgx4vsvdQvIXK5VYF3sUZxmJUvgA1FOvwF8spKyBtM1y6EepI4LqVMedbEaTp0EIKdPKh5FqYYqSxgo2jgFr13j6XXHnOiSZOeBVSvyC8qC2r05FVvVw9cAMAOA178AWPMp2LJaaekiCPXExwHw660n1oB/niGQazwOkkSepbJ/72I1x4CJ+cJ6lYI1riccrVicUuVSmIW82pkwnHHVOKbFsOozQGkFkwewnBES37ABYMaAX39ZAUCCb82nIlo+40p2gNnvsoKunxH1xGwA/LOzdQOQJPIuHzV2GBg7Cow7AI0l33XfjOsv6oVodes6ISbBsAZMX+kJxU56KY7pkmFVhOciuvTzSt05v0+ryuT/9gDrZNe4wPMsI7VJP3GcP7gUOOdvgL1rRYJ0ZI5IV3hV4/wrGYPPU3/AiRhYusy2K7mU999P+z90ObD7LuBZK0Xdkeq9NSX2+o4HLwfWlopFCC0fgciBMtAFC8CGrYXVoVjnU2G7rTXrzh4kfRzLY1kyGwBoeiGcPiXb5eAzdXWnazPCSScb4j3xfmav8Cx2p50lAMW0VXINitCogl2r9H2dcctWwQxQsn6ZTBbMNtcgdKIbiZj51VcBk38CXPxoQcfCUg8pjcYgZScw/momACnXyr4leBhs5QaBTHpf7X8dMPYJYO8XgAv9e8QJlAZZq8D4xSuANYKPJQn0AR2AHKy1MACKe9nfFI6IEqduEWoHIJ9wlsVKLekoMCa9EAegSTYQeM4TXco2SEMkAHEbBZoj4bbYtdyCVrFqGXgTSxgXYTZeHLi9AMjEQRCVUXP/n4KUaaT8vVTi+Rtg7GPAuYcAWlMCgUVkQfJ2Q12yBvPXMwHImhDWwf81imsTiLSEvHZkr+jY/p9CQRD4p8DOBwteItai05qn31FFdfLlFxYWgCDUIkRkj/TxbCEi/89jfPZ3X2VqYSJQbmUNQY3HQT7hbv2sLoerVwKQHNEEoCsm8R4MhPRjXUGzVEIKIoY7yaEYuY4dgGb5RXruoSgtSCLLarkICQ9f6QNykGjFdjsIBaI4kGlt8W+Rg5g0HJ8qAp47nihAzFpuWtPIMBZJlASILvR6fQ0DCVbJCkJOJCqnk4pGpb99tZ8MopyiKDX7WWDiwYKXiEQOehCrgKh+eJQ+EQHo1Lby/zRlyf8TIbf9XS5ftIb8I92YugH4ay2pLusorl7dAoonWtMwQSTdOFuQSLTGHyIC8kxSIQuA4hwU2WUAoO4/grBcDbsfWElSzg+JCoYDoEGM1ixSkHzgF/wG7y8sIa3J7JPAGWuFJSQIaU01iJHUiYP4e33BrPOHmG/JMaOfTZVYRhwGav87vWKPJ9/rSH4IOGO5sITqg/ggxXs4TOaBAECbeoOsgfl+DrQShFqcEIhyyt0MbMusEkx76iAZXKM8BvXiZAGlF+KaIbaadYpem4aDgpJZQz6YJABV5VcHAJZ0v4FxX6KG5UpYs0KnqjhRuagEVgPglYAl9ciHf8mdUrJh0Qx9vkDBzBywfbkYQIGwahA/kglATsHsDzKA0BATiPyZ4NEDwIeoa/uFYKKXL2f24nQoIgd9R3yQCMTFqwIAfdBWI7+yB5ZLECYLETd85YJl+2YAUNosLIel/xYlu4Jsl6bhNhD6it4WJCvA2Zc4Gxo73RcgJeOqFmGR6rcChLYACyGojmEYdj59KnZ+tIQRhH9IvWA2hiREjDeRI9Cly7fMF3EtWRFawhQIf5IJwE56wdTIYdt7tp9ys1K8JnoJvod9Wn682PNkP4hUy1ndWgstAtBDMLYN5/6PAc5DGNoF4SrZfN+4+IhT8jqwg2Cp8ThIJ5vfSWBXAVCrWN9SMxDK+skaOvhoAc8me654pmUB3f0wyt+E8FyRAGmPlOEoiSD2qgvmAKoOm52fAuiTDHSyIRxx+lI0QxxADubfF5vffMmSajrWlP7nmZ3dSy+4r/ZzAUEHnQ8R70HsXlK+PgJsW68G4XYGZj0EY2EYATCAT6tAhmE0DXcC4faapcwMgAIfLb0kuzT9Qmw5uwAAIABJREFUSi+EfeALkSrpBovbrQDnkm8wAo8/E3i+CCsZ98NCpAp8cUekZyBavI4ET/TnaAk/RQCyAXy6uNSPA0i+wMeB6ePA5HFgZq2wpNGK3FUDAHmv3fSCe7afX8CB4UNEEOolVi/3obastNwJ9cO5BOBKEQMsAcifHWzRAigWWAlCn5K2bQYAOe1KMjTIR2kRUhKVS7IrLia0v+3xwHMZMCbYNP0KfG79zAqK5DxOvyEuWu6VD5KSHy2YAEQAfpaRdl5UkuUctIpBnCIIl4psD03FtIIP1ADAlBuJM47EqqUX3LX9kSBQcuuyftK78xUkHyQ+RLqHZ3Fv1KcgLj5kAQ1s0Qo6IA1nHhNLQzA8ZxvBXuNx8DcS5UYpNnoYxsCnUIqvZo0F3wPTMa7Hv53HOJVbS/l+5bumX7d+5WLE44hxIRJB2NMCqj9ixwuE90svWCaIA6bAp959EKeWChAyA0PTOV2unGMQveCO7bfqHbcS4rJR7Ewqnw5AWhLuImg2uFQAXAVs8RGmntW4+g2hB3P79L/EJ9zGvqrxOPibiVihAOgrWQOf/EBfBcsPNBBqW9Hv6zzGqFzmoXz3B9AePgXiq6bgiv4YOB9QHS8AfpkAFMMjrWAcQA0iO9XJiQyAnos2vV7ESHOOQfWCO7Zf7F40mZFQScRKAYBaSU6vAVcTgN7xXHiUFpDTMK2dFh56912BTiDcvpkATIXzCL4g3WXTZ4jpGfjoF/oihL+fx+0yWUABLwIwtYKKIabgCzHQvi2ggBKn0McEQDaKT5cGkIOo6SuyYzEfjQB0EM5nZgAPoxe8of3sgSqCQM3jkdFLvpRvR13+7UVRuhUFSavNO6otwp88ZZ3+t4M6HLtch6OT9AG/q9cmtf//gV1JDYcnQ2zY6/YakfSrU+Pg1M45NqPt3IEtoM7WFHokyrWKkooglCMWLYjiUXMtK3g8Uzd1WL3gDe3vRRCoUEYCwGtYFxxqgA2E/jI20F5hhmQod98BHNnlxOTig1aGiDanO21yV4DygWuB8YeB6fnC9WEtiKVVKeE0ZGiXWczeJoWMIig5a9V5DA1ANoKDeDylZ9NSXxyAsiKawrQqmCv2HVf5e8aRoxfc1n7xs+khItAUvojvyWryxVcWJZksVSyZoQRA3dcAoHzax4Gj2wtu6FVKM7gMgti02jbV476oUJJs1j/AbA1mQ3Pm8eTRsoZDtR+xZKCiEKmMXTIeXHPGdhYArX8FwG4DGMEnAHIK4yvT58nWC2b73cexaZgWWaEKgU1gjNbPP7PvOYGsUSBkv3hBtmRWNzxjTk9RWktvxp6POj0vARjY9sWkFel8RWxegjIF4RjwAOnZWMPBTGjqvHmszxJOBUD3xyznL2bqROvoP3N3q84jG4C7M/PpcvMBef0cvV9k6hXv+2Yno5QfGArRbaCC0mWv2YtF3ecerNDhkNZIIsXQRv5dlTtGADJSz2gEE1EJQM//026HdIEZLC8B6A0tk0g1Ja8DuzJdphS82QBEZj5dbj7gxZN5er/IZI+67pscgE7QaDOUMyC0Wb8+gXjuR4F5J6YsaXnFhBoAGEVvUhb60jISgCQnoh/OLBgvIrL8v7DdFkEYM5dtNg97tvz5zJqzdfIBmJlPl5sP+DJP5xtW7xffnzeh7H+Z+3+RpkyWT1YxuURJYVtx6T0fCTocouQV85VkHRIGegEuEv/YKpkA/JceVmL8kv6t5/9pu62tfiPWcFQVEa0DZ9WcLJEPwMx8uvfnjT9IgZyj94t/ldeA/S9tMaGa9SNdmsIxbvVscVJ1GScoMt4UPwhAsmMZ0aXzQBsvdGRBjQz0FUpEJRAJQOq4KAnBdz+sfiPJ3bOYn8fsykyVWMfiN3BOzckS+QDMzKe7OW/88aqQzsfE5kH1fvGjeQ0wADodmVGwOeiMsUqHrGOnS4UFy9P/wAEojkEnI+IqOIJQNLgpCXhcmLAtD/D+kgQE235L93tj+YBqgTX9BiCeW/NedT4AmQ+YkU/3sbzxBymQuZhm8g1T+QbV+wWFdjKO/Te2mEFNlCb6gPF708VJ1TXHgKd91GnZpDfi1k/gM2vqU3DUnCuBmNQe3P9vw6pe229KOvB0K1k+ZS+rnrfM2AlA3JMZtah/EZKZT3drxuDz1O/yxAwu9JgJxr3lQfR+8aa8Buy/wdWQZAVl+ZzCrG3q9c/YrkmHy3IRYryAAqAkEBIlopJxNNUbER+fA/H+/+AAdP9PmS9dazicJybm7mlB8nR2dI1HvgVkOlZGPt2nM29GCamcGZjAwlQ+vvrV+8X/zGsAAUiLVPp/wd+zaTMFWw+/kAA0GQQnpCw5mDsAMIrcRB5mC/+MAffTwgfwKY2KfmCZ6ZIkUShrxXxBX4yYaV8Hzmcn13jUA8CMfDqWYeQcSkhVOl8U6uxH7xekrsg49h8oiCENgC5TUG5vKxxT8f2aRtOtcAKQ1s8soPuOVUIwpchNlEEIOyNSIrrvv3hwnckWIZPZsnbcDyzTpvg3lU8mpZQqozyfK74aj3wAKh1LgrsD5tMxiz/nkGD1sHq/YNFOxkEAcuW7oqmXlisuQOT7VV2jwi/kTgj1RkoZhBje8Z83SCAEEJZW0C3gff8tADCt4VASaWIBK0HI9q8BF5yUAMzIp8tNx5Jg9bB6v/jdDPSRns0BWIZeUitIo9IhHmhXTvzCPQddccnZ76U1V/IvC4SBCFyg26DFNg7c++Mhhb6qiCikT7WVUmr6lYn2nRKyrdZ51GMBlZIc07GUBdMjny6XCiUmpA6j94vMZbgBMFo552pu27PXAqXTyAUQcitOQjAm9xX0N9pIwIPmSCmH5QuPqER0L4kDYgp9zOUL6fYxkbZcFceyAreAF3GlV+NRDwAz8uksnT3jiILVSmpWNlhMze+k94vMZfgGAPJeHDjpCrgM01Tdry9OzvmYAzAqLVWIwEShwzbRwwSEn+MqP6bQK5tZlWyhjCCCsC19Xv7gOnBRbgp7cu/5AOyVjqVMmA75dJZ9nHF0yohWNlhMxKnS+0XmMtwAmFq4imnYbrEqNJPc+9kfd62RKh0On8qV9hXZ9askEPgAfI56ziocUgVbzGT28lEtRMoKtg7lBHtznfZNA+CQ+XQWM8k4uglWK/NLYKzS+8U9GReXD0g/Tyvh4Ne17Yb4Zbr6g6y7/aNWcoPpjKRTsJIags5IJwkEAv6en05S6GUBfRWsUExZyVZVQCQwrgN7Wfdd41GPBczIp8ODeXfTSbBa6YYxlY8/p3q/udc3C+jTbtvqt2oadnB2m4oNgMn0W0p+hYWHWbwg9yU/0Kb9EIy+5y2hiCit4UgKyTeAkN8Valk4Le/ldlONRz4AWWBRM6fdIPfHstw/G+SE5rMnVQ/kA5AkLHS0ak7V7reXfhgACaBqDtD3e/nmc5k9kA/A80JReq+U38zGVp3ObJo/BvAOD3dtwiWar9zEHsgHIGlFubqSx7+Jja36anLLcDvvgwA+NDpDfILv+qlzuXwAXuSjrkKemlO2e3U1uWUYnL8dwB/5e2apca9LNv+vsQfyAUheX4VguB+mzIsaG9ntqxhF4Xbe3QD+n7/uHLAW9wQ1tblMRQ/UA0CaHC7plXEh+q4T0OWcfhleYTSHBK0EH/mi+fcRuKQn4I6fWpeoB4AevCz3HOOm9yb3F5mBlZBNclYCj1aRfyfrbgPCTR6AzK+vD4CyglX7jpmN7HY66d1E0ctdIrEEE4wEIMlam+Pk7YF6AMj7EwAVbU82vTerCwhAXopJN9zVI+AYrOeULLZgErY2x8nZA/kAJGWr0naUWdFpy2cT+oCWjpdjLFxE5UzYIBBpEUX5nLnlvAktb76SPVAfAOUHpiAMm96bsVtCAMaKALICMyxDq6cXfycA+b/mOLl6oF4AiqBRIEzBp7/X2Af0+fi1XIioMIlAI+AIPIGPmeROWV3j1Zuvyu2B+gHoFfZiDS2lC0LiY52WUADkQoTTMH1BFSYRdHoRfKSu5v9qrizMHYPT+vx6ARhSuDcAzzmDo5ZGHT1PAKYMwQxME2jiSo/gEwBrrq+u41ZOy++oD4BaCcsXTPiSI3ey8s4KGoG8QwCMFM+0ggQhLR0BF19SXuD/ayakz7uR0/TsMcxg3SjfqWNA0hsrga/ojaq/8WPcC+YIk4Ke4CMSuB2XVht1Oj8zIfXlU8BtU8DhmYRXWdfrdF1fgr3+S8At48CD04DVjXQSDO70PTUnaJ5uOCwsIIFHSSFy1pKPWCDsZxCpw8UVgKSPxLXM937OzxxAljzcPAbcswU4Qh4V3UN8mKoeKm/bu78IfKJQa8VD48CylHQiL3O3/qg5Rf30BKACMtJXjXKQcfBSK8Dfqc3KVCwuN2VFGRnm/yKZtq4Re5ifyQQgM2A+BeB3GHaZBo5MAIue0l7Kt3cC4xhw+5eL7TuCkJk1jBtyerbUfYG5ExjZ/pqrxE5fAOrOq5SmowVIrRp1IyT2R6+fg0bgVYG4CsyZe2UsaiOGKXr4Sfp9k8CxCYAFSKyvXeY1o1BxQux91yMtfsHPutgnnyUuUvhc0ZsgUXib+nVkq6+ZKaABIHsgVZnuwD9sVo66rrR4ImdhLGSQ8zPL/JgBQxeU1ouWkO9PTgDzbgmXxrzMkatl3keivfG5x4r4IRcz5BfkO5vEZ0kgpIfBZ8yKjlL17syy0tMNcOn9dl4Fy6dLFabj1Mpvow9Ify+I4Nlo9Xt+ZqU9VdJpqZh4QDDyxUyYOYJwHDg+DhgI/WUVZl7aSEt93+GO9Ia2iuZKOfA7lhp9JpvAVy61w2mOwO5hmCgMHC1H9O24gu6UD9jP+ZmbtLRaSsei9SL4XDPbAEh/kGQ/pSUcc0lbApFWb67lQUhpVnLBsoKqqZclFMmUtrxPcwxl3X7vOCAtYLSCcugFQmqhdssH7HU+RznjiOlYXA8wqkOfkItTAom+oKygca4ES8jY+N3z7fSG4hfUtp3ihUHruVSsFy1iRvNP+1N7A5BdJACmVpAgZPhGOyCigEjlPLudn7kvFtOxuB4g6OjD8UWLRkCZFRwrLCEXJQQhp2K+37lQeBCRX1A7KPQto1prFEmSYn2mB9EAsO+kYfk8KQhZF8yjVz5gp/MztyOUjiW9bCUhEBhKRCCgSis45uQ/PhX/xfFWMgOnWu2gxB0TF/o0kEZ/kCDM1Ts+3RHYnwVUL6XhDFrAswfIB6w6P1MrTulY0sum1VICglKwCEACqvQFCUK3gHcsFQCM/ILayqP1k9JshVqrncMalOYYvgcGAyCvIwuod8YBJQmZpmGJeyRwkGw4n8jJOJQNw3idLFhMRNB0SgASTJyKoy/4ieXCeFfJBUeV2SoAclFyR0bbm1OHTUiN0/DTAwD7zQeM52dqj8VsGEkVE2jKetG7AEhQ0frJAv6RC0trC1skl+IWlNinGLbSaZg7Mc0xfA8MbgF1LQV1z08A2G8+oM7PVF9Ms2GUE0gQyp+Lwu2yagLgR9ZaYpkSypQ6a6Q2DCqzpkvietXIFdoZfuieGmcOD0DeP0HEbBhNwYPmA/L8zJQsATAKnguEqS+XTqkE4YfWWwCUFZTksYAYwZfIBeN9Tw0cjOwu8gDIZqsoSSvhEeQDiiGYFoyWiSDRypWgi69UP5sc5fIcquSCNeXqe2X9ZAHfM7Khe2pcOB+AT41+aO5iRD3QAHBEHd9ctuiBBoANEkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cvAFgg4GR9kADwJF2f3PxBoANBkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cfOxqYJ2au9RdPtdp/khoEOlglDYT39V1PzQFXLsMXAlgt9PCxJKPbufyf8/KHIPfBPAZABf79Xc5XQ0ZQ1Q7360NbxoHrlsDvs5ZRsgo0une06by6X1mZvtP99PNAp4F4LsBXA5gjw8EGTeqaGF4QhzQF80CX7cAvGIdeDYAfhdZ2sTKUcVrpE7nd31N5gj8e2dIo2osk7NZpMdK0Z19tv+bJ4F9K8D1ACj8yfNSikHeg+5Z969m57Y/8/ZP+dPLKZhP/rcA+AYAF7g1oRUhEMUzFMt6eSJfX78b2DkPfM0i8GIAX+uWlAMppreUUErn8p2gzTl+2flg/sDbTkvIOik+CP20//mzwAXzwDcCuNTPJeFXpEpM6QEjIHm/zTF8D7T5gATYNQCe69aAloRTGulfBESBSYNyxR5g/Bhw7hKwZwl4vk9LnM5JmsBzUyDGAX3B8G23Mz/g9BuUa/0IiutfMkj7zwKmngAuXSvOpUvAWYBtF4BTnspIj/O8zPaf7qdvWITw6eZA0JLQEhKEGgxZhUj/dz3NzSKwbR44exnYvVKcy+mM5Km0JhxInUtrGkmzCPicg3W5LMGkQiZZTm9xS9Z3+4m2o8C5c4X15pTKW2Lb+fCx7WLtjYxzqiql29Icw/dA5SqYf6RTTilg+lYCIXmICKQ4IK9wxfSJY8AZK8CuFWDnanEua9ZTAMsaCog3Dt92O/MvnRGBtGwkqKRmMEkqCaa+2k+0LQDTh4rP88UHj74kF1WaATo9QHQ7mmP4HugYhtEKj4PB6ZQ+FS0hQahpldPya1kXTOqNY8DscgG+HavAttUCvBxInitrkgL4lcO33c7spBdM3kAuSnq2nx9gQfAh4JyVwvrxwel2z3p4aMlzH6DM2z/lT+8aB+Q/OT4EEqckWQSBkGD6EQKQnDCLwBSnYgcf32fXioGUFawC4esyu7CXXnDP9tOCsyD4KLB1rmgvX7zfbu2WG/Jtme0/3U/vKxBNAMoi0KcjkATCN3HOEr3UAjDrwOP71rXixYEkeKMFlSX8ocwR6KUXTJ7AaNE2tF8WfA4Ye7Kw1mwvX/yZn+eKnvcrfzC6IK/ObP/pfnpfAGQnySoISBqUXyAASS1AK0JfagWYcRDOrAF66TxZQU7jBOEbM0egH71gcgXSFZAV54NQtj9YcNIpbONCyh8Ygi8CVospApDuB63g92W2/3Q/vW8AsqM4gLIKBBIH8bcJwMCNMX68BTqBb8s6sGWtsIA6jwDk662ZI9CvXjA5A6NVa2t/IAicnC/aGV+8T74IQPm/AmGuBc+8/VP+9IEAyLslAKMV/LgAyIUInfnjwPQqMOOgI/DstQ5Mr7UAqMF8V2YXDqoXXNl+EQQ6N9v29aKdesUpWJZbAPyPme0/3U8fGIDssDid/pUASCvCaXgJmFguAEfgEXT27gDkuwaUg/nbmSMwjF7whvbLhSDL5TwwvdRqo9oqHzACkCB8U2b7T/fThwIgO01T1IMCoAZxGRhbKoAXQUcQTjkI+a4B5e5FzjGsXvCG9gdqrLGFYrpVG/UuHzBOw2/LaXxzbh43DKeoJwlAHqLndSs4udoCoIBHQE45EPk3DuitmYOQoxdctp8+rFwIWsGFYiFFoLGNchcEQC6e+OJC5J2Z7T/dTx/aApYdJ37AyJK/DIwvFxYvWr0IwEn/H1Opco5sveDUhSAAF4HJpQJkWixp6k2n4IYfMGf0amDHev2I8+l4/UbvNw8Eozw72wJePOJ8und7EkKj9ztKGA1/7WwATo44n45pWI3e7/AAGPWZ2QBkYHCU+XTMfGGQmYIxjd7vqOE0+PXzATjifDrKtTZ6v4MP/MlyRj4AR5xPF+VaqZLJF1UzKdPV6P2eLDDr3I58AI44n07ZMARbo/d78gMubWE+AEecT8e9YOn2Uheu0fs9tUCYD8AR59MpG6bR+z21gKfW1gNAz4geRT5dTEZo9H5PPRDmAzBmRM8BJzqfLiYjSKKr0fs9dYBYDwBHmE9XtRfMsIz04aQZ1+j9npygrA+Akqs8wfl0BCCTWRq935MTYL1aVQ8Ao1zlAnAi8+kEQGZTNXq/vYb75Pt/fQAcUT5dBGCj93vyAaxXi+oDoFLyT3A+3Rcavd9eY3xS/z8fgCQX/LPR3SOzkon55jg1eyAfgD8M4NcAPD6aDmBtB1e4NMDNcer1QD4AbwbwxwDe4UvRE9wHZG1gNSXDLlwLNcep1QP5APxzzwj9IIAPnXhT5ORc5EYCA9HNcWr1QD4AmRH6FQBMTSZZH98ZmD5Bh5g1FopiNns1x6nTA/kAvAfAEwDudnI+EvQxPfkEzYfaCXRSBluQMB7YHKdGD+QDsBNBH/9+AkAobqTADGK7Inw1x8nfA/kA7EXQt8kgrGAGMfBxZ5Cv5ji5eyAfgL0I+r68uR0QmUFoBQU8vfNvzXHy9kA9AORoMw7CdGQCjoUZDwL4kv/+8OZ1gJhBIjGDgMh3vTavBc035/RAPgD7JegjODfhiMwgoqeJwNPPTaB6Ezq/hq+sB4AcXeXEP+ZhGVo9vRimIQD5v5oPAZCupgDI9wg8/qz/1Xz55usyeyAfgMMQ9GU2Op4eAchpOIJQQEz/VuPlm6/K7IH6AMjgGzdl6QtyX5jWjpQFevF3lq3xf6yhrOlIAUgQCojR8gmE+l9Nl2++JrMH6gEgR5UA5KYsc+AZmCbQCDi+IvgEQMob1XBEAHIajgBMLV+0kCdws6aGu3zqfkV9AGTwjftg3JRVVRAtHQEXX/wbAcoXP5d5CID8GoJKvqDAloKOoIz/y7x8c3pmD4zhaqwjRzCYyQg5gr2ZgsFTLweWr8XQgsXjbwLWrnNtMlKgNoLBmZAa7PTCAuYIBlMvlWQswwr2UlUw45jdDSx8HbD+Ctd+HVCwePKbgJV9aASDM8Yg59TWFDysYPBtmYK91IbNOHaPA/M7gUXKXA4hWDz79cA8+W0aweCMURj+1HYfcBjBYO54MMY3tGDv8I3nmWSHOzYOLJ0LLPGXAQWLz3oB8MQUsEa16kYwOG8whjh74yJkUMFgbsNlCfYO0epwissVY34bsHw2sEIRkAEEi/dcU0SP5qhF1ggG5w3GEGdXr4L5134Fg4kAjuDQgr1DtDqcUmZETwArZwAru4BVqsv0KVh8/o3F4v0QXZBGMDhvMIY4u3MYhv95Zh+Cu1xBcxuOU/HfeDIq5cv7FuwdotXhlCBXjOXZAnyrO4BV6in0IVh8wStLuWCsUAyvEQzOG5ABz+4eB+R/ewnu/kOP/3G/l4kJTERlljQtIot2e53/IwO2OPl4FLtcnCqAp9cahT56CBZf+LpSLhhz1N5qBIPzBmTAs/sLRHcTDKbiNHdBGGymOC/3hglEvgjAnoK9A7Y4+XgiV4zVWYDAs/etxaubYPFFP1QkLtCIP8neaASD8wZkwLP7AyC/tJNg8L/xLNBu+YBdBXsHbHEFAINcMVamgdWZAoRrfPdXm8KitLdmgYveWAq+2y7iMqfuRjA4b1AGOLt/APJLqwSD3+y5T1yI0AoSbAxMMzGV1o8/My2ro2DvAK2t+GgiV4zj4+3AIwDXtwBrVJeuECze+9aW4Dut4PxkIhYsdetGMDhvoDqcPRgA+SWp4O4veQ5Uv/mAGwR78+6rQq4Yq9PAOi2fA4/vBkKudKVU7VZw77uKvWFuZbtcMNb5v0YwOG9g+jx7cADyi6Pg7gccgIxlcA5TKhaD01yYKBmVFpBZMfx/m2Bvny3t8LGqoqTliZbVI+gMgHwnMAnCIFi897cLAAZ6QyzFzzSCwXkD1OPs4QDIL5XgLmk5JHk/SD5gKdibd38VcsVYGmuBTaAzEHLHgyCcaokB7/1IkUET5IKxwF5pBIPzBqbPs4cHIC/AaeqvPL9pmHxAE+zts6VdLCD/lcgVY3UyWD0Bj1ZwqgCggXA7sPfWAoAJvaEtZBrB4Lyx6efsPADyCtmCvf00s/NnOsgVY3m8BTRZPZuGBUACdArY+5lWDqGmYbIrLHEx0ggG5w1OH2fnA7CPizQfaXqgUw80AGywMdIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0BxoAjrT7m4s3AGwwMNIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0B8ZYNMbkX+ZekpuIiOQrPar+xs889HJg6jZg5jAwvVZ8B+ll9PlO5/Fc/o+ECjnHfi8zYfkvM5ulmp4qJXVqx5deD4zfAkw/CGxdAZgoHfuh131QkaI5hu8Bs4Ds8B0AWLnIRGCBsFfn87JffDMwdjOw5R5g8giwZa34jnQQUwDo99wBfJ4TM7COiNdlaj2rA/jeV/vfDeATAP4UGH8I2Lrc6gc+SHqY4oMZ74VSKM0xfA+UUzB/oBUUCKMl6zSQ/PsXqZD5KQC/A0w/DEwcAcYXgYnVwppwADuBkefnCim90FmBWXwnK87Uen53BI8sbuwqaz9p5UgnQhBS+ZN1zE8Ak0utviCwq8DI8/nx5hi+Bzb4gJzKZE1SEFZZgS9/2pWR/gTAJ4HJQ8DEMWB8ARhfBsaWCwDquwQKvvNgHXvOcYVbPFJPkw+dDxC/W1Y4tWDpw/Rlgo4lo1T4/KxTihDNpJwj3/UiMLXemprjffC7eWpzDN8DlYsQDiKtVxzEqoHkyX9HRizW+nIgaQnvAiaeBCbmC0s4tgSMu2rMePAR9X252jXklaTFU108K0MHav/nvJ6ZxVVk9OI7GR2IZoGQNc/HgbHgIwqILIVujuF7oOMqWFawCoRxkfEIB5CWgkREBCNf9wMTc8A4QciBWyoGz16rwNgaML5eWKpctYZL3N+TWLX0gvtuP0HHk2n16JDyxXmVhfU0qywbJbr5GSuXKxA/sV5Y9UYWdnjwyS3qKKgarWA69Wg6fjQOIK0HadnIjPVFB+AiME4AuiUkCFnESyCSkmAuU7Cjm15wX+2X2ifBRn9A8mKcW2UFjULVQcgVDl80u40SYh763FfvquhLCxitoBYUsoJfjXKttByMq9CKcHn4sPuCbgXNJwyWkECcz5Q376UX3LNncZyQAAADEklEQVT9fFgIJs6lBBwtn3Tt6FpIz4RWnuQxPh2XIGzm4CwQ9hWIFgBTK0gQHiIAJddKq0ELQh+KL1qUR4MvSEsoENIKrgALHNiMox+94K7tl9qnnMio8MSf6SNwGpYVjCDk/Ju7isq496fCqX0BkDeqlWwKwic1gAQSpzGREnFgREz01eALLvvq2Kfi45m6cf3qBXdsfxRbJMho8dimqOhEK8cXQRr9QVpvPoDNMXQP9A3ACELFxPh+jACkP0fLIKFCCRRqKuPUdqjlC9o07JZwKVNHeBC94DQcZO0XAAkmgotAk9QYrR9f/BvByYfMSATDVMzwTXMM3QMDAVAgVHCZ7/MaQK4QZUHiNCbBQlqUw74YCb7gcmYkelC9YFlwvVv7RRAorTuBkECU9asCID9/x9B935zYzyKkqpfiNHxcA0gLQgvBAaPVkCqm3h2AtC5m/RyEqzw/4xhGL3hD++MmslgqCbgUfLKAcRrmTlBzDN0DA1tAXUlWcDm1IOIIJAjlT/Fd05lbFQFwjdtgGcewesFt7Rc/Gx8iWjUCjGCT1YvWT1MwgUqrf3NG45tTbcu0aximWx9xENcEQHGbcYAEwtSXSqY0gnCdgeuMI0cvuGx/FUGgFhwEYrR80QckWN+X0fjm1DwAWv8RgJFilJZBznz0pQg+AZAAlVWh1GvGka0XzB0cCQi30aSGVa9AF62fLOB7MhrfnJoPwPER59Px+o3e76mL5Kwp2G57xPl0kxc3er+nLvyKtLmhfUC78RHn081ONnq/pzcAR5xPR9mRRu/31IVgvgUccT4dNaobvd/TGYAjzqejumqj93s6A3DE+XRUg2VSCjdaGr3fUw+I+VPwiPPpqJjO8J1Nw43e7ymHwHoAKMFd7QErAeEE5NNJMb3R+z3lsGcNzgfgiPPpomJ6o/d76oGwPgCOKJ8uKqY3er+nKwBHmE+noqRG7/fUA199U/AI8+kEwEbv93QHoEhZTnA+nYqSGr3fBoAtaiqBUImdm5hPJwA2er+nKwBHnE+X1gUzSbnR+z11wPj/AeCpPDD3t7rvAAAAAElFTkSuQmCC",gq="uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",vq="varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",mn={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},kb=class extends vs{constructor({preset:e=mn.MEDIUM,edgeDetectionMode:t=Rd.COLOR,predicationMode:i=uW.DISABLED}={}){super("SMAAEffect",gq,{vertexShader:vq,blendFunction:Tt.NORMAL,attributes:cs.CONVOLUTION|cs.DEPTH,uniforms:new Map([["weightMap",new ve(null)]])});let r,s;arguments.length>1&&(r=arguments[0],s=arguments[1],arguments.length>2&&(e=arguments[2]),arguments.length>3&&(t=arguments[3])),this.renderTargetEdges=new Rt(1,1,{minFilter:gt,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new d5(!0,!1,!1),this.clearPass.overrideClearColor=new Je(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new nr(new pW),this.edgeDetectionMaterial.edgeDetectionMode=t,this.edgeDetectionMaterial.predicationMode=i,this.weightsPass=new nr(new SW);let a=new Uv;a.onLoad=()=>{let n=new ai(r);n.name="SMAA.Search",n.magFilter=Bt,n.minFilter=Bt,n.generateMipmaps=!1,n.needsUpdate=!0,n.flipY=!0,this.weightsMaterial.searchTexture=n;let o=new ai(s);o.name="SMAA.Area",o.magFilter=gt,o.minFilter=gt,o.generateMipmaps=!1,o.needsUpdate=!0,o.flipY=!1,this.weightsMaterial.areaTexture=o,this.dispatchEvent({type:"load"})},a.itemStart("search"),a.itemStart("area"),r!==void 0&&s!==void 0?(a.itemEnd("search"),a.itemEnd("area")):typeof Image<"u"&&(r=new Image,s=new Image,r.addEventListener("load",()=>a.itemEnd("search")),s.addEventListener("load",()=>a.itemEnd("area")),r.src=C8,s.src=T8),this.applyPreset(e)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(e){this.edgeDetectionMaterial.edgeDetectionThreshold=e}setOrthogonalSearchSteps(e){this.weightsMaterial.orthogonalSearchSteps=e}applyPreset(e){let t=this.edgeDetectionMaterial,i=this.weightsMaterial;switch(e){case mn.LOW:t.edgeDetectionThreshold=.15,i.orthogonalSearchSteps=4,i.diagonalDetection=!1,i.cornerDetection=!1;break;case mn.MEDIUM:t.edgeDetectionThreshold=.1,i.orthogonalSearchSteps=8,i.diagonalDetection=!1,i.cornerDetection=!1;break;case mn.HIGH:t.edgeDetectionThreshold=.1,i.orthogonalSearchSteps=16,i.diagonalSearchSteps=8,i.cornerRounding=25,i.diagonalDetection=!0,i.cornerDetection=!0;break;case mn.ULTRA:t.edgeDetectionThreshold=.05,i.orthogonalSearchSteps=32,i.diagonalSearchSteps=16,i.cornerRounding=25,i.diagonalDetection=!0,i.cornerDetection=!0;break}}setDepthTexture(e,t=na){this.edgeDetectionMaterial.depthBuffer=e,this.edgeDetectionMaterial.depthPacking=t}update(e,t,i){this.clearPass.render(e,this.renderTargetEdges),this.edgeDetectionPass.render(e,t,this.renderTargetEdges),this.weightsPass.render(e,this.renderTargetEdges,this.renderTargetWeights)}setSize(e,t){this.edgeDetectionMaterial.setSize(e,t),this.weightsMaterial.setSize(e,t),this.renderTargetEdges.setSize(e,t),this.renderTargetWeights.setSize(e,t)}dispose(){let{searchTexture:e,areaTexture:t}=this.weightsMaterial;e!==null&&t!==null&&(e.dispose(),t.dispose()),super.dispose()}static get searchImageDataURL(){return C8}static get areaImageDataURL(){return T8}},yq=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,R0={DEFAULT:0,ESKIL:1},xq=class extends vs{constructor({blendFunction:e=Tt.NORMAL,technique:t=R0.DEFAULT,eskil:i=!1,offset:r=.5,darkness:s=.5}={}){super("VignetteEffect",yq,{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new ve(r)],["darkness",new ve(s)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===R0.ESKIL}set eskil(e){this.technique=e?R0.ESKIL:R0.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}},oa=class{constructor(e,t){this.enabled=!1,this.effect=new e(t),Object.defineProperty(this,"opacity",{enumerable:!0,set(i){this.effect.blendMode.opacity.value=i},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(i){this.effect.blendMode.setBlendFunction(Number(i))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=Tt.NORMAL}},bq=class extends oa{constructor(){super(eq),this.blendFunction=Tt.SCREEN}set intensity(e){this.effect.intensity=e}get intensity(){return this.effect.intensity}set luminanceThreshold(e){this.effect.luminanceMaterial.threshold=e}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(e){this.effect.luminanceMaterial.smoothing=e}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(e){this.effect.blurPass.scale=e}get blurScale(){return this.effect.blurPass.scale}set kernelSize(e){this.effect.blurPass.kernelSize=e}get kernelSize(){return this.effect.blurPass.kernelSize}},wq=class extends oa{constructor(){super(iq)}set contrast(e){this.effect.uniforms.get("contrast").value=e}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(e){this.effect.uniforms.get("brightness").value=e}get brightness(){return this.effect.uniforms.get("brightness").value}},Sq=class extends oa{constructor(){super(oq),this.effect.offset=new j(.01,.01)}set offset(e){this.effect.offset.set(e[0]/1e3,e[1]/1e3)}get offset(){return[this.effect.offset.x*1e3,this.effect.offset.y*1e3]}},_q=class extends oa{constructor(){super(sq)}},Aq=class extends oa{constructor(){super(dq),this._hue=0}set hue(e){this._hue=e,this.effect.setHue(e)}get hue(){return this._hue}set saturation(e){this.effect.uniforms.get("saturation").value=e}get saturation(){return this.effect.uniforms.get("saturation").value}},Mq=class extends oa{constructor(){super(pq),this.blendFunction=Tt.OVERLAY}},Eq=class extends oa{constructor(){super(xq)}get eskil(){return this.effect.eskil}set eskil(e){this.effect.eskil=e}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(e){this.effect.uniforms.get("darkness").value=e}get offset(){return this.effect.uniforms.get("offset").value}set offset(e){this.effect.uniforms.get("offset").value=e}},Cq=class extends oa{constructor(e){super(hq)}set focalLength(e){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=e/2e3}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(e){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=this.isPerspectiveCamera?e/2e3:(e+992)/2e3}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(e){this.effect.bokehScale=e}setCamera(e){let t=!1;(e.isPerspectiveCamera&&this.isPerspectiveCamera===!1||!e.isPerspectiveCamera&&this.isPerspectiveCamera===!0)&&(t=!0),e.isPerspectiveCamera?(this.effect.circleOfConfusionMaterial.adoptCameraSettings(e.perspCamera),this.isPerspectiveCamera=!0):(this.effect.circleOfConfusionMaterial.adoptCameraSettings(e),this.isPerspectiveCamera=!1),t&&this.effect.setChanged()}},Tq=class extends oa{constructor(){super(mq)}get granularity(){return this.effect.getGranularity()}set granularity(e){this.effect.setGranularity(e)}},Pq=`#define GLSLIFY 1
varying vec2 vUv;varying vec2 vTexCoords[9];uniform vec2 resolution;void main(){vUv=position.xy*0.5+0.5;vec2 texelSize=vec2(1.0)/resolution;vTexCoords[0]=vUv+vec2(-texelSize.x,-texelSize.y);vTexCoords[1]=vUv+vec2(0.0,-texelSize.y);vTexCoords[2]=vUv+vec2(texelSize.x,-texelSize.y);vTexCoords[3]=vUv+vec2(-texelSize.x,0.0);vTexCoords[4]=vUv+vec2(0.0,0.0);vTexCoords[5]=vUv+vec2(texelSize.x,0.0);vTexCoords[6]=vUv+vec2(-texelSize.x,texelSize.y);vTexCoords[7]=vUv+vec2(0.0,texelSize.y);vTexCoords[8]=vUv+vec2(texelSize.x,texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}`,Dq=`#define GLSLIFY 1
#include <common>
varying vec2 vUv;varying vec2 vTexCoords[9];uniform sampler2D inputBuffer;uniform sampler2D historyBuffer;uniform sampler2D velocityBuffer;uniform sampler2D depthBuffer;uniform vec2 resolution;
#define USE_YCOCG
#define USE_CATMULL_ROM
const float feedback_min=0.5;const float feedback_max=0.95;vec3 RGB_YCoCg(vec3 c){return vec3(c.x/4.0+c.y/2.0+c.z/4.0,c.x/2.0-c.z/2.0,-c.x/4.0+c.y/2.0-c.z/4.0);}vec3 YCoCg_RGB(vec3 c){return clamp(vec3(c.x+c.y-c.z,c.x+c.z,c.x-c.y-c.z),vec3(0.0),vec3(1.0));}vec4 sample_color(sampler2D tex,vec2 uv){
#ifdef USE_YCOCG
vec4 c=texture(tex,uv);return vec4(RGB_YCoCg(c.rgb),c.a);
#else
return texture(tex,uv);
#endif
}vec4 sample_catmull_rom(sampler2D tex,vec2 uv,vec2 texSize){vec2 samplePos=uv*texSize;vec2 texPos1=floor(samplePos-0.5)+0.5;vec2 f=samplePos-texPos1;vec2 w0=f*(-0.5+f*(1.0-0.5*f));vec2 w1=1.0+f*f*(-2.5+1.5*f);vec2 w2=f*(0.5+f*(2.0-1.5*f));vec2 w3=f*f*(-0.5+0.5*f);vec2 w12=w1+w2;vec2 offset12=w2/(w1+w2);vec2 texPos0=texPos1-1.0;vec2 texPos3=texPos1+2.0;vec2 texPos12=texPos1+offset12;texPos0/=texSize;texPos3/=texSize;texPos12/=texSize;vec4 result=vec4(0.0);result+=texture2D(tex,vec2(texPos12.x,texPos0.y))*w12.x*w0.y;result+=texture2D(tex,vec2(texPos0.x,texPos12.y))*w0.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos12.y))*w12.x*w12.y;result+=texture2D(tex,vec2(texPos3.x,texPos12.y))*w3.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos3.y))*w12.x*w3.y;return result;}vec3 choose_motion_vector(){
#ifdef CHOOSE_LONGEST_MOTION_VECTOR
float longest=-1.0;vec3 v_choose=vec3(-1.0);for(int i=0;i<9;i++){vec3 v=texture2D(velocityBuffer,vTexCoords[i]).rgb;float l=length(v.xy);if(l>longest){longest=l;v_choose=v;}}return v_choose;
#else
float closest_depth=1000.0;vec2 closest_uv_offset=vec2(0.0);for(int i=0;i<9;i++){float neighbor_depth=texture2D(depthBuffer,vTexCoords[i]).r;if(neighbor_depth<closest_depth){closest_uv_offset=vTexCoords[i];closest_depth=neighbor_depth;}}return texture2D(velocityBuffer,closest_uv_offset).rgb;
#endif
}vec4 clipAabb(vec3 aabb_min,vec3 aabb_max,vec4 avg,vec4 input_texel){const float FLT_EPS=0.00000001;vec3 p_clip=0.5*(aabb_max+aabb_min);vec3 e_clip=0.5*(aabb_max-aabb_min)+FLT_EPS;vec4 v_clip=input_texel-vec4(p_clip,avg.w);vec3 v_unit=v_clip.xyz/e_clip;vec3 a_unit=abs(v_unit);float ma_unit=max(a_unit.x,max(a_unit.y,a_unit.z));if(ma_unit>1.0){return vec4(p_clip,avg.w)+v_clip/ma_unit;}else{return input_texel;}}vec3 clip_aabb_variance(in vec3 cOld,in vec3 cNew,in vec3 centre,in vec3 halfSize){if(all(lessThanEqual(abs(cOld-centre),halfSize))){return cOld;}vec3 dir=(cNew-cOld);vec3 near=centre-sign(dir)*halfSize;vec3 tAll=(near-cOld)/dir;float t=0.0001;for(int i=0;i<3;i++){if(tAll[i]>=0.0&&tAll[i]<t){t=tAll[i];}}if(t>=0.0001){return cOld;}return cOld+dir*t;}void main(){vec3 v=choose_motion_vector();vec2 velocity=v.rg;vec2 previousPixelPos=vUv-velocity;vec4 currentColor=sample_color(inputBuffer,vUv);
#ifdef USE_CATMULL_ROM
vec4 previousColor=sample_catmull_rom(historyBuffer,previousPixelPos,resolution);
#else
vec4 previousColor=sample_color(historyBuffer,previousPixelPos);
#endif
#ifdef USE_YCOCG
previousColor=vec4(RGB_YCoCg(previousColor.rgb),previousColor.a);
#endif
vec4 ctl=sample_color(inputBuffer,vTexCoords[0]);vec4 ctc=sample_color(inputBuffer,vTexCoords[1]);vec4 ctr=sample_color(inputBuffer,vTexCoords[2]);vec4 cml=sample_color(inputBuffer,vTexCoords[3]);vec4 cmc=sample_color(inputBuffer,vTexCoords[4]);vec4 cmr=sample_color(inputBuffer,vTexCoords[5]);vec4 cbl=sample_color(inputBuffer,vTexCoords[6]);vec4 cbc=sample_color(inputBuffer,vTexCoords[7]);vec4 cbr=sample_color(inputBuffer,vTexCoords[8]);vec4 cmin=min(ctl,min(ctc,min(ctr,min(cml,min(cmc,min(cmr,min(cbl,min(cbc,cbr))))))));vec4 cmax=max(ctl,max(ctc,max(ctr,max(cml,max(cmc,max(cmr,max(cbl,max(cbc,cbr))))))));vec4 cavg=(ctl+ctc+ctr+cml+cmc+cmr+cbl+cbc+cbr)/9.0;vec4 cmin5=min(ctc,min(cml,min(cmc,min(cmr,cbc))));vec4 cmax5=max(ctc,max(cml,max(cmc,max(cmr,cbc))));vec4 cavg5=(ctc+cml+cmc+cmr+cbc)/5.0;cmin=0.5*(cmin+cmin5);cmax=0.5*(cmax+cmax5);cavg=0.5*(cavg+cavg5);
#ifdef USE_YCOCG
vec2 chroma_extent=vec2(0.25*0.5*(cmax.r-cmin.r));vec2 chroma_center=currentColor.gb;cmin.yz=chroma_center-chroma_extent;cmax.yz=chroma_center+chroma_extent;cavg.yz=chroma_center;
#endif
vec4 previousColorClipped=clamp(previousColor,cmin,cmax);
#ifdef LUMINANCE_DIFFERENCES
#ifdef USE_YCOCG
float lum0=currentColor.r;float lum1=previousColorClipped.r;
#else
float lum0=luminance(currentColor.rgb);float lum1=luminance(previousColorClipped.rgb);
#endif
float unbiased_diff=abs(lum0-lum1)/max(lum0,max(lum1,0.2));float unbiased_weight=1.0-unbiased_diff;float unbiased_weight_sqr=unbiased_weight*unbiased_weight;float k_feedback=mix(feedback_min,feedback_max,unbiased_weight_sqr);vec4 result=mix(currentColor,previousColorClipped,vec4(k_feedback));
#else
const float alpha=0.1;vec4 result=mix(currentColor,previousColorClipped,1.0-alpha);
#endif
#ifdef USE_YCOCG
gl_FragColor=vec4(YCoCg_RGB(result.rgb).rgb,result.a);
#else
gl_FragColor=result;
#endif
}`,Iq=`#define GLSLIFY 1
varying vec2 vUv;void main(){gl_Position=vec4(position.xy,1.0,1.0);vUv=position.xy*0.5+0.5;}`,Oq=`#define GLSLIFY 1
layout(location=1)out vec4 gVelocity;varying vec2 vUv;uniform sampler2D inputBuffer;void main(){gl_FragColor=texture2D(inputBuffer,vUv);gVelocity=vec4(0.0);}`,If=class extends It{constructor(){super({name:"PassthroughMaterial",uniforms:{inputBuffer:new ve(null)},blending:Mi,depthWrite:!1,depthTest:!1,vertexShader:Iq,fragmentShader:Oq})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}},Rq=class extends I1{constructor(){super("TAAResolvePass"),this.MRTCompatible=!0,this.needsSwap=!1,this.passThroughMaterial=new If,this.resolutionVector=new j,this.resolveMaterial=new It({name:"TAAResolveMaterial",uniforms:{inputBuffer:new ve(null),historyBuffer:new ve(null),velocityBuffer:new ve(null),depthBuffer:new ve(null),resolution:new ve(new j)},blending:Mi,depthWrite:!1,depthTest:!1,vertexShader:Pq,fragmentShader:Dq}),this.historyRenderTarget=new Rt(1024,1024,{minFilter:gt,stencilBuffer:!1,depthBuffer:!1}),this.historyRenderTarget.texture.name="TAA.History",this.resultRenderTarget=new Rt(1024,1024,{minFilter:gt,stencilBuffer:!1,depthBuffer:!1}),this.resultRenderTarget.texture.name="TAA.Output"}setSize(e,t){this.historyRenderTarget.setSize(e,t),this.resultRenderTarget.setSize(e,t)}render(e,t){this.fullscreenMaterial=this.resolveMaterial,this.resolveMaterial.uniforms.inputBuffer.value=t.texture[0],this.resolveMaterial.uniforms.velocityBuffer.value=t.texture[1],this.resolveMaterial.uniforms.depthBuffer.value=t.depthTexture,this.resolveMaterial.uniforms.historyBuffer.value=this.historyRenderTarget.texture,this.resolveMaterial.uniforms.resolution.value.set(t.width,t.height),e.setRenderTarget(this.resultRenderTarget),e.render(this.scene,this.camera),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(this.historyRenderTarget),e.render(this.scene,this.camera);let i=this.renderToScreen?null:t;this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(i),e.render(this.scene,this.camera)}dispose(){this.resultRenderTarget.dispose(),this.historyRenderTarget.dispose(),this.resolveMaterial.dispose(),this.passThroughMaterial.dispose()}},Lq=class extends I1{constructor(e,t,i){super("TransmissionPass",void 0,t),this.MRTCompatible=!0,this.depthPass=new M8(e,t,{renderTarget:i.transmissionDepthTarget}),this.passThroughMaterial=new If,this.splineScene=e,this.needsSwap=!1}updatePasses(e){this.passThroughMaterial=new If,this.depthPass=new M8(this.splineScene,this.camera,{renderTarget:e.transmissionDepthTarget})}setCamera(e){this.camera=e}setScene(e){this.splineScene=e}render(e,t,i){let r=this.camera.layers.mask,s=e;s.setRenderTarget(s.transmissionRenderTarget),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=t.texture[0],s.clear(),s.render(this.scene,this.camera),this.camera.layers.disable(3),this.depthPass.render(e,t,i),s.shadowMap.needsUpdate=!1,s.shadowMap.autoUpdate=!1;let a=this.renderToScreen?null:t;this.camera.layers.set(3),e.setRenderTarget(a),e.render(this.splineScene,this.camera),this.camera.layers.mask=r}},P8=new ls,Bq=new It({transparent:!0,vertexShader:`
        void main() {
            gl_Position = vec4(0.0);
        }
    `,fragmentShader:`
        layout(location = 1) out vec4 gVelocity;

        void main() {
            gl_FragColor = vec4(0.0);
			gVelocity = vec4(0.0);
        }
    `}),Of=class extends I1{constructor(e,t,i){super("OpaquePass",t??P8,i),this.MRTCompatible=!0,this.hasTransmissionPass=!1,this.clear=!0,this.clearColorOnly=!1,this.clearDepth=!1,this.needsSwap=!1,this.originalMaterials=new Map,this.MRTCompatible=e}setCamera(e){this.camera=e}setScene(e){this.scene=e??P8}getScene(){return this.scene}render(e,t){this.camera.layers.enable(3),this.hasTransmissionPass&&(this.originalMaterials.clear(),this.scene.traverse(r=>{r.layers.isEnabled(3)&&r instanceof D1&&(this.originalMaterials.set(r.id,r.material),r.material=Bq)}),e.shadowMap.needsUpdate=!0,e.shadowMap.autoUpdate=!0),this.camera.layers.enable(8);let i=this.renderToScreen?null:t;e.setRenderTarget(i),this.clearColorOnly&&e.clear(!0,!1,!0),this.clear&&e.clear(),e.render(this.scene,this.camera),this.clearDepth&&e.clear(!1,!0,!1),this.hasTransmissionPass&&this.originalMaterials.forEach((r,s)=>{let a=this.scene.getObjectById(s);a&&(a.material=r)})}},zq=class{constructor(e,{depthBuffer:t=!0,stencilBuffer:i=!1,multisampling:r=0,frameBufferType:s=0}={}){this.renderer=e,this.helperStartIndex=0,this.copyPass=new Df,this.depthTexture=null,this.timer=new JW,this._width=1,this._height=1,this.passes=[],this.helperPasses=[],this.autoRenderToScreen=!0,this.inputBuffer=this.createBuffer(t,i,s,r,!0,"input buffer mrt"),this.inputBufferSingle=this.createBuffer(t,i,s,r,!1," input buffer single"),this.inputBufferSingle.texture.dispose(),this.inputBufferSingle.depthTexture.dispose(),this.inputBufferSingle.texture=this.inputBuffer.texture[0],this.inputBufferSingle.depthTexture=this.inputBuffer.depthTexture,this.outputBuffer=this.inputBuffer.clone(),this.outputBuffer.name="output buffer mrt",this.outputBufferSingle=this.createBuffer(t,i,s,r,!1,"output buffer single"),this.outputBufferSingle.texture.dispose(),this.outputBufferSingle.depthTexture.dispose(),this.outputBufferSingle.texture=this.outputBuffer.texture[0],this.outputBufferSingle.depthTexture=this.outputBuffer.depthTexture,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){let t=this.inputBuffer,i=this.multisampling;i>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):i!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e,!0,"new input buffer"),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){var t;if(this.renderer=e,e!==null){let i=e.getSize(new j),r=((t=e.getContext().getContextAttributes())==null?void 0:t.alpha)??!1,s=this.inputBuffer.texture[0].type;s===y1&&e.outputEncoding===ft&&(this.inputBuffer.texture[0].encoding=ft,this.outputBuffer.texture[0].encoding=ft,this.inputBuffer.dispose(),this.outputBuffer.dispose()),e.autoClear=!1,this.setSize(i.width,i.height,!1);for(let a of this.passes)a.initialize(e,r,s)}}replaceRenderer(e,t=!0){let i=this.renderer,r=i.domElement.parentNode;return this.setRenderer(e),t&&r!==null&&(r.removeChild(i.domElement),r.appendChild(e.domElement)),i}createDepthTexture(){let e=this.depthTexture=new rl(this._width,this._height);return this.inputBuffer.depthTexture=e,this.inputBuffer.stencilBuffer?(e.format=zn,e.type=Tn):e.type=Hs,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,i,r,s,a){let n=this.renderer,o=n===null?new j:n.getDrawingBufferSize(new j),l={minFilter:gt,magFilter:gt,wrapS:ei,wrapT:ei,stencilBuffer:t,depthBuffer:e},h;return r>0?(h=new Rt(o.width,o.height,l),h.samples=r):(s?(h=new P_(o.width,o.height,2,l),h.texture[1].type=Ks):h=new Rt(o.width,o.height,l),h.depthTexture=new rl(2048,2048),h.depthTexture.type=_i),i===y1&&n!==null&&n.outputEncoding===ft&&(Array.isArray(h.texture)?h.texture.forEach(c=>c.encoding=ft):h.texture.encoding=ft),Array.isArray(h.texture)?h.texture.forEach((c,d)=>{c.name=`EffectComposer.Buffer ${s} ${d}`,c.generateMipmaps=!1}):(h.texture.name=`EffectComposer.Buffer ${s}`,h.texture.generateMipmaps=!1),h.name=a,h}addPass(e,t){var o;let i=this.passes,r=this.renderer,s=r.getDrawingBufferSize(new j),a=((o=r.getContext().getContextAttributes())==null?void 0:o.alpha)??!1,n;if(e.MRTCompatible&&(n=this.inputBuffer.texture[0].type),e.MRTCompatible||(n=this.inputBuffer.texture.type),e.setRenderer(r),e.setSize(s.width,s.height),e.initialize(r,a,n),this.autoRenderToScreen&&(i.length>0&&(i[i.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?i.splice(t,0,e):i.push(e),this.autoRenderToScreen&&(i[i.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){let l=this.createDepthTexture();for(e of i)e.setDepthTexture(l)}else e.setDepthTexture(this.depthTexture)}setHelperStartIndex(e){this.helperStartIndex=e}removePass(e){let t=this.passes,i=t.indexOf(e);if(i!==-1&&t.splice(i,1).length>0){if(this.depthTexture!==null){let r=(s,a)=>s||a.needsDepthTexture;t.reduce(r,!1)||e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null)}this.autoRenderToScreen&&i===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){let e=this.passes;e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){let t=this.renderer,i=this.copyPass,r=this.inputBuffer,s=this.outputBuffer,a=this.inputBufferSingle,n=this.outputBufferSingle,o=!1,l,h,c,d;e===void 0&&(e=this.timer.update().getDelta());for(let u of this.passes)u.enabled&&(u.MRTCompatible?u.render(t,r,s,e,o):u.render(t,a,n,e,o),u.needsSwap&&(o&&(i.renderToScreen=u.renderToScreen,l=t.getContext(),h=t.state.buffers.stencil,h.setFunc(l.NOTEQUAL,1,4294967295),i.render(t,r,s,e,o),h.setFunc(l.EQUAL,1,4294967295)),c=r,d=a,r=s,a=n,s=c,n=d),u instanceof ZW?o=!0:u instanceof MW&&(o=!1))}setSize(e,t,i){let r=this.renderer;if(this._width=e,this._height=t,e===void 0||t===void 0){let a=r.getSize(new j);e=a.width,t=a.height}r.setSize(e,t,i);let s=r.getDrawingBufferSize(new j);this.inputBuffer.setSize(s.width,s.height),this.outputBuffer.setSize(s.width,s.height),this.inputBufferSingle.setSize(s.width,s.height),this.outputBufferSingle.setSize(s.width,s.height);for(let a of this.passes)a.setSize(s.width,s.height)}reset(){let e=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(e)}dispose(){for(let e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.inputBufferSingle!==null&&this.inputBufferSingle.dispose(),this.outputBufferSingle!==null&&this.outputBufferSingle.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},Fq=new It({name:"CombineMaterial",uniforms:{inputBufferA:new ve(null),inputBufferB:new ve(null)},blending:Mi,depthWrite:!1,depthTest:!1,vertexShader:`
varying vec2 vUv;
void main() {
    gl_Position = vec4(position.xy, 1.0, 1.0);
    vUv = position.xy * 0.5 + 0.5;
}
`,fragmentShader:`
    varying vec2 vUv;
    uniform sampler2D inputBufferA;
    uniform sampler2D inputBufferB;

    // TODO: Why do we need these when postpro of framemode is enabled???
    layout(location = 1) out vec4 gVelocity;

    void main() {
	vec4 resA = texture2D(inputBufferA, vUv);
	vec4 resB = texture2D(inputBufferB, vUv);
    float a = resA.a + resB.a * ( 1.0 - resA.a );

	vec4 res;
	res.rgb =  resA.rgb + (resB.rgb * (1.0 - resA.a));
	res.a = resA.a + resB.a * (1.0 - resA.a);
	gl_FragColor = res;
    gVelocity = vec4(0.0);
    }
`}),kq=class extends I1{constructor(e){super("HelperPass",void 0,e),this.MRTCompatible=!1,this.fullscreenMaterial=Fq,this.helperPass=new Of(!1,void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperPass.renderToScreen=!1,this.helperPassOnTop=new Of(!1,void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this.helperPassOnTop.renderToScreen=!1;let t=new kb({preset:mn.LOW,edgeDetectionMode:Rd.COLOR});this.effectPass=new rd(this.camera,t),this.rt=new Rt(10,10,{minFilter:gt,magFilter:gt,wrapS:ei,wrapT:ei,depthBuffer:!0})}setSize(e,t){this.rt.setSize(e,t),this.effectPass.setSize(e,t)}set sceneHelpers(e){this.helperPass.setScene(e)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(e){this.helperPassOnTop.setScene(e)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}setCamera(e){this.helperPass.setCamera(e),this.helperPassOnTop.setCamera(e)}initialize(e,t,i){super.initialize(e,t,i),this.effectPass.initialize(e,t,i)}dispose(){super.dispose(),this.rt.dispose(),this.effectPass.dispose()}render(e,t,i){this.rt.depthTexture=t.depthTexture;let r=e.getClearAlpha();e.setClearAlpha(0),this.helperPass.clearDepth=!0,this.helperPass.clearColorOnly=!0,this.helperPass.render(e,this.rt),this.helperPassOnTop.render(e,this.rt),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.rt,i),this.fullscreenMaterial.uniforms.inputBufferA.value=i.texture,this.fullscreenMaterial.uniforms.inputBufferB.value=t.texture,e.setClearAlpha(r),e.setRenderTarget(null),e.clear(),e.render(this.scene,this.camera)}},Uq=`#define GLSLIFY 1
#include <skinning_pars_vertex>
#include <morphtarget_pars_vertex>
out vec3 n;void main(){
#include <beginnormal_vertex>
#include <morphnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <defaultnormal_vertex>
#include <begin_vertex>
#include <morphtarget_vertex>
#include <skinning_vertex>
vec4 view_space=viewMatrix*modelMatrix*vec4(transformed,1.0);gl_Position=projectionMatrix*view_space;n=normalize(transformedNormal);}`,Nq=`#define GLSLIFY 1
in vec3 n;void main(){gl_FragColor=vec4(n,1.0);}`,Vq=`#define GLSLIFY 1
out vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position.xy,1.0,1.0);}`,jq=`#define GLSLIFY 1
in vec2 v_uv;const float pi=3.14159265;const float num_steps=4.0;const float num_directions=4.0;uniform float near;uniform float far;uniform float fov;uniform vec4 proj_info;uniform bool is_ortho;uniform vec2 resolution;uniform float radius_of_influence;uniform float radius_in_screen_space;uniform float exponent;uniform vec3 ao_color;uniform float bias;uniform sampler2D texture_depth;uniform sampler2D texture_normals;uniform sampler2D texture_blue_noise;uniform sampler2D texture_blue_noise_in_disk;uniform sampler2D texture_color_pass;uniform int frame_index;uniform bool fog_enabled;uniform float fog_near;uniform float fog_far;vec3 uv_to_view_space(vec2 uv,float eye_z){return vec3((uv*proj_info.xy+proj_info.zw)*(is_ortho ? 1.0 : eye_z),eye_z);}float linearize_depth(float depth_sampled){float z=is_ortho ? depth_sampled : depth_sampled*2.0-1.0;return mix((2.0*near*far)/(far+near-z*(far-near)),near+z*(far-near),float(is_ortho));}vec3 get_view_position(vec2 uv_coords){float linear_depth=linearize_depth(texture(texture_depth,uv_coords).x);return uv_to_view_space(uv_coords,linear_depth);}vec3 min_difference(vec3 p,vec3 right,vec3 left){vec3 v1=right-p;vec3 v2=p-left;return(dot(v1,v1)<dot(v2,v2))? v1 : v2;}vec3 rebuild_normal(in vec2 uv,in vec3 p){vec2 one_over_resolution=1.0/resolution;vec3 r=get_view_position(uv+vec2(one_over_resolution.x,0));vec3 l=get_view_position(uv+vec2(-one_over_resolution.x,0));vec3 t=get_view_position(uv+vec2(0,one_over_resolution.y));vec3 b=get_view_position(uv+vec2(0,-one_over_resolution.y));return normalize(cross(min_difference(p,r,l),min_difference(p,t,b)));}float falloff(float distance_squared){float neg_inv_r2=-1.0/(radius_of_influence*radius_of_influence);return distance_squared*neg_inv_r2+1.0;}float ao_contribution(vec3 P,vec3 N,vec3 S){vec3 to_sample=S-P;float norm_squared=dot(to_sample,to_sample);float norm=sqrt(norm_squared);float cos_theta=dot(N,to_sample)/norm;return clamp(cos_theta-bias,0.0,1.0)*clamp(falloff(norm_squared),0.0,1.0);}float compute_ambient_occlusion(vec2 uv,float radius_in_screen_space,vec3 pc,vec3 view_space_n){vec2 one_over_resolution=1.0/resolution;ivec2 noise_uv=ivec2(int(mod(gl_FragCoord.x,128.0)),int(mod(gl_FragCoord.y,128.0)));float noise=texelFetch(texture_blue_noise,noise_uv,0).r;noise=fract(noise+0.61803398875*float(frame_index));float theta=noise*2.0*3.1415;float ct=cos(theta);float st=sin(theta);float step_size=radius_in_screen_space/(num_steps+1.0);const float angle_step=2.0*pi/num_directions;float contribution=0.0;for(int i=0;i<int(num_directions);++i){float current_pixel=step_size+1.0;for(int j=0;j<int(num_steps);++j){int index=i*int(num_steps)+j;vec2 blue_noise_sample=texelFetch(texture_blue_noise_in_disk,ivec2(index,0),0).rg;vec2 disk_point;disk_point.x=blue_noise_sample.x*ct-blue_noise_sample.y*st;disk_point.y=blue_noise_sample.x*st+blue_noise_sample.y*ct;vec2 sample_direction=disk_point;vec2 snapped_uv=round(current_pixel*sample_direction)*one_over_resolution+uv;vec3 ps=get_view_position(snapped_uv);current_pixel+=step_size;contribution+=ao_contribution(pc,view_space_n,ps);}}float mult=1.0/(1.0-bias);contribution*=mult/(num_directions*num_steps);return clamp(1.0-contribution*2.0,0.0,1.0);}
#define USE_GBUFFER_NORMALS
void main(){vec3 view_space_p=get_view_position(v_uv);
#ifdef USE_GBUFFER_NORMALS
vec3 view_space_n=texture(texture_normals,v_uv).rgb;view_space_n.z*=-1.0;
#else
vec3 view_space_n=-rebuild_normal(v_uv,view_space_p);
#endif
float radius_ss=radius_in_screen_space/(is_ortho ? 1.0 : view_space_p.z);float ao=compute_ambient_occlusion(v_uv,radius_ss,view_space_p,view_space_n);float final=pow(ao,exponent);if(view_space_p.z>=far){final=1.0;}vec3 color=mix(ao_color,vec3(1.0),final);if(fog_enabled){float fog_factor=smoothstep(fog_near,fog_far,view_space_p.z);color=mix(color,vec3(1.0),fog_factor);}gl_FragColor=vec4(color,1.0);}`,Gq=`#define GLSLIFY 1
out vec2 v_uv;void main(){gl_Position=vec4(position.xy,1.0,1.0);v_uv=uv;}`,Hq=`#define GLSLIFY 1
in vec2 v_uv;uniform sampler2D texture_ao_lrez;uniform sampler2D texture_depth_lrez;uniform sampler2D texture_depth_hrez;uniform float near;uniform float far;float linearize_depth(float depth_sampled){float z=depth_sampled*2.0-1.0;return(2.0*near*far)/(far+near-z*(far-near));}vec2 nearest_depth_filter(in vec2 uv){vec2 resolution=vec2(textureSize(texture_depth_lrez,0));vec2 texel_size=1.0/resolution;vec2 offset=uv-0.5*texel_size;float d_hrez=texture(texture_depth_hrez,uv).r;float a=abs(d_hrez-texture(texture_depth_lrez,offset).r);float b=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,0.0)).r);float c=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(0.0,texel_size.y)).r);float d=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,texel_size.y)).r);float min_diff=min(a,min(b,min(c,d)));if(min_diff==a)return offset;if(min_diff==b)return offset+vec2(texel_size.x,0.0);if(min_diff==c)return offset+vec2(0.0,texel_size.y);if(min_diff==d)return offset+vec2(texel_size.x,texel_size.y);}void main(){
#ifdef DEBUG
float d_lrez=texture(texture_depth_lrez,v_uv).r;float d_hrez=texture(texture_depth_hrez,v_uv).r;float output_d=mix(linearize_depth(d_lrez)/far,linearize_depth(d_hrez)/far,step(0.5,v_uv.x));gl_FragColor=vec4(vec3(output_d),1.0);
#else
vec2 filtered_uv=nearest_depth_filter(v_uv);vec4 ao=texture(texture_ao_lrez,filtered_uv);gl_FragColor=vec4(ao.rgb,1.0);gl_FragColor=ao;
#endif
}`,r2=[[.478712,.875764],[-.337956,-.793959],[-.955259,-.028164],[.864527,.325689],[.209342,-.395657],[-.106779,.672585],[.156213,.235113],[-.413644,-.082856],[-.415667,.323909],[.141896,-.93998],[.954932,-.182516],[-.766184,.410799],[-.434912,-.458845],[.415242,-.078724],[.728335,-.491777],[-.058086,-.066401],[.20299,.686837],[-.808362,-.556402],[.507386,-.640839],[-.723494,-.22924],[.48974,.317826],[-.622663,.765301],[-.01064,.929347],[.663146,.647618],[-.096674,-.413835],[.525945,-.321063],[-.122533,.366019],[.195235,-.687983],[-.563203,.098748],[.418563,.561335],[-.378595,.800367],[.826922,.001024],[-.085372,-.766651],[-.92192,.183673],[-.590008,-.721799],[.167751,-.164393],[.032961,-.56253],[.6329,-.107059],[-.46408,.569669],[-.173676,-.958758],[-.242648,-.234303],[-.275362,.157163],[.382295,-.795131],[.562955,.115562],[.190586,.470121],[.770764,-.297576],[.237281,.93105],[-.666642,-.455871],[-.905649,-.298379],[.33952,.157829],[.701438,-.7041],[-.062758,.160346],[-.220674,.957141],[.642692,.432706],[-.77339,-.015272],[-.671467,.24688],[.158051,.062859],[.806009,.527232],[-.05762,-.247071],[.333436,-.51671],[-.550658,-.315773],[-.652078,.589846],[.008818,.530556],[-.210004,.519896]],Wq=new It({vertexShader:Uq,fragmentShader:Nq}),wo=new It({vertexShader:Gq,fragmentShader:Hq,uniforms:{texture_ao_lrez:new ve(null),texture_depth_lrez:new ve(null),texture_depth_hrez:new ve(null),near:new ve(null),far:new ve(null)}}),qq=class extends I1{constructor(e,t){super("AmbientOcclusionPass",void 0,t),this.fogEnabled=!1,this.fogNear=1,this.fogFar=1e3,this.frameIndex=0,this._runHalfRes=!0,this._width=1,this._height=1;let i=1024,r=1024;this.gBuffer=new Rt(i,r,{type:ch?Ks:_i,depthTexture:new rl(i,r),minFilter:gt,magFilter:gt}),this.depthBufferHighRes=new Rt(i,r,{depthTexture:new rl(i,r)}),this.aoBuffer=new Rt(i,r,{minFilter:gt,magFilter:gt}),this.splineScene=e,this.splineCamera=t;let s=new Float32Array(r2.length*2);for(let n=0;n<r2.length;n++){let o=n*2;s[o+0]=r2[n][0],s[o+1]=r2[n][1]}this.blueNoiseInDiskTexture=new or(s,r2.length,1,lc,_i),this.blueNoiseInDiskTexture.wrapS=Gs,this.blueNoiseInDiskTexture.wrapT=Gs,this.blueNoiseInDiskTexture.needsUpdate=!0,this.hbaoMaterial=new It({vertexShader:Vq,fragmentShader:jq,uniforms:{near:new ve(null),far:new ve(null),fov:new ve(null),proj_info:new ve(new ht),is_ortho:new ve(!1),resolution:new ve(new j),radius_of_influence:new ve(8),radius_in_screen_space:new ve(1),exponent:new ve(1),ao_color:new ve(new E),bias:new ve(.5),texture_depth:new ve(null),texture_normals:new ve(null),texture_blue_noise:new ve(null),texture_blue_noise_in_disk:new ve(this.blueNoiseInDiskTexture),frame_index:new ve(0),fog_enabled:new ve(!1),fog_near:new ve(1),fog_far:new ve(1e3)}}),this.radius=128,this.aoColor={r:0,g:0,b:0},this.bias=.5,this.hbaoMaterial.uniforms.texture_depth.value=this.gBuffer.depthTexture,this.hbaoMaterial.uniforms.texture_normals.value=this.gBuffer.texture,this.needsSwap=!0,this.aaBuffer=new Rt(i,r,{minFilter:gt,magFilter:gt,wrapS:ei,wrapT:ei,depthBuffer:!1,type:_i});let a=new kb({preset:mn.ULTRA,edgeDetectionMode:Rd.COLOR});this.effectPass=new rd(this.camera,a)}initialize(e,t,i){super.initialize(e,t,i),this.effectPass.initialize(e,t,i)}setBlueNoiseTexture(e){this.hbaoMaterial.uniforms.texture_blue_noise.value=e}setSize(e,t){this._width=e,this._height=t,this.depthBufferHighRes.setSize(e,t);let i=this._runHalfRes?.5:1,r=e*i,s=t*i;this.gBuffer.setSize(r,s),this.aoBuffer.setSize(r,s),this.hbaoMaterial.uniforms.resolution.value.set(r,s),this.aaBuffer.setSize(r,s),this.effectPass.setSize(r,s)}get runHalfRes(){return this._runHalfRes}set runHalfRes(e){this._runHalfRes=e,this.setSize(this._width,this._height)}setCamera(e){this.splineCamera=e}setScene(e){this.splineScene=e}setDepthTexture(e){this.depthBufferHighRes.depthTexture=e,wo.uniforms.texture_depth_hrez.value=e,wo.needsUpdate=!0}render(e,t,i){this.splineScene.overrideMaterial=Wq;let r=this.splineCamera.layers.mask;if(this.splineCamera.layers.set(5),e.setRenderTarget(this.gBuffer),e.clear(),e.render(this.splineScene,this.splineCamera),e.setRenderTarget(this.depthBufferHighRes),e.clear(),e.render(this.splineScene,this.splineCamera),this.splineScene.overrideMaterial=null,this.splineCamera.layers.mask=r,this.hbaoMaterial.uniforms.radius_of_influence.value=this.radius,this.hbaoMaterial.uniforms.ao_color.value.set(this.aoColor.r,this.aoColor.g,this.aoColor.b),this.hbaoMaterial.uniforms.bias.value=this.bias,this.hbaoMaterial.uniforms.fog_enabled.value=this.fogEnabled,this.hbaoMaterial.uniforms.fog_near.value=this.fogNear,this.hbaoMaterial.uniforms.fog_far.value=this.fogFar,this.hbaoMaterial.uniforms.frame_index.value=this.frameIndex,this.frameIndex++,this.splineCamera.isPerspectiveCamera){this.hbaoMaterial.uniforms.near.value=this.splineCamera.perspCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.perspCamera.far;let s=this.splineCamera.perspCamera.projectionMatrix.elements,a=2/s[0],n=2/s[5],o=-(1-s[8])/s[0],l=-(1+s[9])/s[5];this.hbaoMaterial.uniforms.proj_info.value.set(a,n,o,l);let h=this.splineCamera.perspCamera.fov*(Math.PI/180),c=this.hbaoMaterial.uniforms.resolution.value.y/(Math.tan(h*.5)*2),d=this.hbaoMaterial.uniforms.radius_of_influence.value*.5*c;this.hbaoMaterial.uniforms.radius_in_screen_space.value=d,this.hbaoMaterial.uniforms.is_ortho.value=!1}else{this.hbaoMaterial.uniforms.near.value=this.splineCamera.orthoCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.orthoCamera.far;let s=this.splineCamera.orthoCamera.projectionMatrix.elements,a=2/s[0],n=2/s[5],o=-(1+s[12])/s[0],l=-(1-s[13])/s[5];this.hbaoMaterial.uniforms.proj_info.value.set(a,n,o,l);let h=.5*(this.hbaoMaterial.uniforms.resolution.value.y/n),c=this.hbaoMaterial.uniforms.radius_of_influence.value*h;this.hbaoMaterial.uniforms.radius_in_screen_space.value=c,this.hbaoMaterial.uniforms.is_ortho.value=!0}this.runHalfRes?(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aoBuffer),e.clear(),e.render(this.scene,this.camera),this.fullscreenMaterial=wo,wo.uniforms.texture_ao_lrez.value=this.aoBuffer.texture,wo.uniforms.texture_depth_lrez.value=this.gBuffer.depthTexture,wo.uniforms.texture_depth_hrez.value=this.depthBufferHighRes.depthTexture,e.setRenderTarget(e.aoRenderTarget),e.clear(),e.render(this.scene,this.camera)):(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aaBuffer),e.clear(),e.render(this.scene,this.camera),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.aaBuffer,e.aoRenderTarget))}dispose(){this.gBuffer.dispose(),this.depthBufferHighRes.dispose(),this.aoBuffer.dispose()}},Yq=`
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Xq=`
uniform sampler2D tInput;
uniform sampler2D tMap;
uniform vec2 resolution;
varying vec2 vUv;

uniform vec2 uResolution;
uniform vec2 uCoords;

// Draws a rectangle at center <st> with size <size>
float rectangle(vec2 st, vec2 size) {
    size = vec2(0.5) - size * 0.5;
    vec2 uv = vec2(step(size.x, st.x), step(size.y, st.y));
    uv *= vec2(step(size.x, 1.0 - st.x), step(size.y, 1.0 - st.y));

    return uv.x * uv.y;
}

uniform vec2 uSize;
uniform float uScale;
uniform float uDPR;
uniform float uCurrent;
uniform vec3 uSceneColor;

void main() {
    vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
    screenUv *= 1.0 / uDPR;

    vec2 center = vec2(0.5, -0.5);
    vec2 outsideUv = screenUv;
    outsideUv += center;
    outsideUv -= uCoords.xy / uResolution.xy;
    outsideUv = (outsideUv - 0.5) + 0.5;
    outsideUv -= center;
    vec2 s = (uSize / uResolution) * uScale;
    float isOutside = 1.0 - rectangle(outsideUv, s);
    
    vec2 mid = vec2(0.5);
    vec2 insideUv = (screenUv - mid + s * mid) / s;
    vec4 background = texture2D(tInput, screenUv);
    vec4 image = texture2D(tMap, insideUv);
    gl_FragColor = mix(image, background, isOutside);
}
`,Qq=class extends nr{constructor(){super(new It({vertexShader:Yq,fragmentShader:Xq,uniforms:{tInput:new ve(null),tMap:new ve(null),uResolution:new ve(new j),uSize:new ve(new j),uCoords:new ve(new j),uScale:new ve(1),uSceneColor:new ve(new Je(16711680)),uDPR:new ve(1),uCurrent:new ve(0)}}),"tInput"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tMap.value}set texture(e){this.uniforms.tMap.value=e}},Zq=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Kq=`
uniform sampler2D toScene;
uniform sampler2D fromScene;
uniform vec2 resolution;

uniform vec2 uResolution;
uniform float uDPR;

uniform float mixRatio;
uniform sampler2D tMixTexture;
uniform int useTexture;
uniform float threshold;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( fromScene, screenUv );
	vec4 texel2 = texture2D( toScene, screenUv );

	if (useTexture==1) {
		
		vec4 transitionTexel = texture2D( tMixTexture, screenUv );
		float r = mixRatio * (1.0 + threshold * 2.0) - threshold;
		float mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);
		
		gl_FragColor = mix( texel1, texel2, mixf );
	} else {
		
		gl_FragColor = mix( texel1, texel2, mixRatio );
		
	}
}
`,Jq=[],$q=class extends nr{constructor(){super(new It({vertexShader:Zq,fragmentShader:Kq,uniforms:{toScene:new ve(null),fromScene:new ve(null),uResolution:new ve(new j),uDPR:new ve(1),mixRatio:new ve(0),threshold:new ve(.1),useTexture:new ve(0),tMixTexture:{value:Jq[0]}}}),"toScene"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.fromScene.value}set texture(e){this.uniforms.fromScene.value=e}},eY=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,tY=`
uniform sampler2D inputBuffer;
uniform sampler2D blurredInputBuffer;
uniform sampler2D overlay;
uniform float blurIntensity;

uniform vec2 uResolution;
uniform float uDPR;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( overlay, screenUv );
	vec4 texel2 = texture2D( inputBuffer, screenUv );
	vec4 texel3 = texture2D( blurredInputBuffer, screenUv );

	float blurMask2 = max(sign(texel1.a), 0.0) * blurIntensity;
    gl_FragColor = mix( mix(texel2, texel3, blurMask2), texel1, texel1.a );
}
`,iY=class extends nr{constructor(){super(new It({vertexShader:eY,fragmentShader:tY,uniforms:{inputBuffer:new ve(null),blurredInputBuffer:new ve(null),overlay:new ve(null),uResolution:new ve(new j),uDPR:new ve(1),blurIntensity:new ve(0)}})),this._blurEnabled=!1,this.blurTarget=new Rt(1,1,{minFilter:gt,magFilter:gt,wrapS:ei,wrapT:ei}),this.blurPass=new u5({width:window.innerWidth,height:window.innerHeight,kernelSize:Ld.HUGE,resolutionScale:.25}),this.blurPass.renderToScreen=!1,this.uniforms.blurredInputBuffer.value=this.blurTarget.texture}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.overlay.value}set texture(e){this.uniforms.overlay.value=e}setResolution(e,t,i=1){this.uniforms.uResolution.value.set(e,t),this.uniforms.uDPR.value=i,this.blurPass.setSize(e,t),this.blurTarget.setSize(e,t),this.blurPass.setSize(e,t)}get uiCanvas(){return this._uiCanvas}set uiCanvas(e){this._uiCanvas=e,e.texture&&(this.uniforms.overlay.value=e.texture);let t=e.frame;if(t){let i=t.data.backgroundBlur,r=i.radius;this._blurEnabled=i.enabled,this.uniforms.blurIntensity.value=this._blurEnabled?1:0,this.blurPass.scale=r/3}}render(e,t,i,r,s){this._blurEnabled&&(this.blurPass.setDepthTexture(this.getDepthTexture()),this.blurPass.render(e,t,this.blurTarget,r,s)),super.render(e,t,i,r,s)}},rY=`
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,sY=`
uniform sampler2D tInput;
uniform sampler2D tOverlayImage;
varying vec2 vUv;
uniform vec2 uResolution;
uniform vec2 uRightBottom;
uniform vec2 uImageSize;
uniform float uScale;
uniform float uDPR;

vec3 blendNormal(vec3 base, vec3 blend) {
	return blend;
}

vec3 blendNormal(vec3 base, vec3 blend, float opacity) {
	return (blendNormal(base, blend) * opacity + base * (1.0 - opacity));
}

vec4 drawFixedSizeImage(sampler2D image, vec2 screenUV, vec2 imageSize, vec2 imageCoords, vec2 screenSize, float dpr) {
	vec2 uv = (screenUV * screenSize * dpr - imageCoords) / (imageSize * dpr);
	if (uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0) {
		return vec4(0.0);
	}
	return texture2D(image, uv);
}

void main() {
    vec2 screenUV = gl_FragCoord.xy / (uResolution.xy * uDPR);
	vec2 imageCoords = vec2(uResolution.x * uDPR - uImageSize.x * uScale * uDPR - uRightBottom.x * uDPR, uRightBottom.y * uDPR);
    vec4 background = texture2D(tInput, screenUV);
    vec4 image = drawFixedSizeImage(tOverlayImage, screenUV, uImageSize * uScale, imageCoords, uResolution, uDPR);
    gl_FragColor = vec4(blendNormal(background.rgb, image.rgb, image.a), max(background.a, image.a));
}
`,aY=class extends nr{constructor(){super(new It({vertexShader:rY,fragmentShader:sY,uniforms:{tInput:new ve(null),tOverlayImage:new ve(null),uResolution:new ve(new j),uImageSize:new ve(new j),uRightBottom:new ve(new j(20,20)),uScale:new ve(.25),uDPR:new ve(1)}}),"tInput")}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tOverlayImage.value}set texture(e){this.uniforms.tOverlayImage.value=e,this.uniforms.uImageSize.value.set(e.image.width,e.image.height)}};function D8(e,t){return t&&t.enabled&&e.push(t.effect),e}var nY=e=>Object.values(Tt).includes(e)?e:Tt.NORMAL,oY=class extends l1{constructor(e,t){super(),this._needsDOFResize=t,this.postprocessingState=Vc.defaultData,this._scene=new ls,this._camera=new v1,this.effects=new Map,this.blueNoiseTexture=new or,this._renderToScreen=!0,this._isUIOverlayEnabled=!1,this.clock=new wP,this.renderer=e,this.debug=!1,this.effects.set("bloom",new bq),this.effects.set("chromaticAberration",new Sq),this.effects.set("vignette",new Eq),this.effects.set("noise",new Mq),this.effects.set("colorAverage",new _q),this.effects.set("hueSaturation",new Aq),this.effects.set("brightnessContrast",new wq),this.effects.set("depthOfField",new Cq),this.effects.set("pixelation",new Tq),this.effectComposer=new zq(this.renderer),this.effectComposer.autoRenderToScreen=!1,this.opaquePass=new Of(!0,this.scene,this.camera),this.opaquePass.clear=!0,this.transmissionPass=new Lq(this.scene,this.camera,this.renderer),this.aoPass=new qq(this.scene,this.camera),this.taaPass=new Rq,this.taaPass.renderToScreen=!1,this.helperPass=new kq(this.camera),this.helperPass.renderToScreen=!1,this.stylesOverlayPass=new Qq,this.stylesOverlayPass.enabled=!1,this.uiOverlayPass=new iY,this.uiOverlayPass.enabled=!1,this.logoOverlayPass=new aY,this.logoOverlayPass.enabled=!1,this.sceneTransitionPass=new $q,this.sceneTransitionPass.enabled=!1,this._initCopyPass(),this._initPasses()}set overlayTexture(e){e!==void 0?(this.stylesOverlayPass.texture=e,this.stylesOverlayPass.enabled=!0):this.stylesOverlayPass.enabled=!1}get overlayTexture(){return this.stylesOverlayPass.texture}set sceneHelpers(e){this.helperPass.sceneHelpers=e}get sceneHelpers(){return this.helperPass.sceneHelpers}set sceneHelpersOnTop(e){this.helperPass.sceneHelpersOnTop=e}get sceneHelpersOnTop(){return this.helperPass.sceneHelpersOnTop}get scene(){return this._scene}set scene(e){this._scene=e,this.opaquePass.setScene(e),this.transmissionPass.setScene(e),this.aoPass.setScene(e)}get camera(){return this._camera}set camera(e){let t=this._camera!==e;this._camera=e,this.opaquePass.setCamera(e),this.transmissionPass.setCamera(e),t&&this.transmissionPass.updatePasses(this.renderer),this.aoPass.setCamera(e),this.helperPass.setCamera(e),this.effects.get("depthOfField").setCamera(e)}updateRenderToScreen(){let e=!1;for(let t=this.effectComposer.passes.length-1;t>=0;t--){let i=this.effectComposer.passes[t];if(i.enabled===!0&&!e&&this._renderToScreen){i.renderToScreen=!0,e=!0;continue}i.renderToScreen=!1}}get isUIOverlayEnabled(){return this._isUIOverlayEnabled}disableUIOverlay(){this._isUIOverlayEnabled=!1}enableUIOverlay(){this._isUIOverlayEnabled=!0}disableHelpers(){this.helperPass.enabled=!1,this.updateRenderToScreen()}enableHelpers(){this.helperPass.enabled=!0,this.updateRenderToScreen()}updateBlueNoiseTexture(e){this.blueNoiseTexture=new or(e,128,128),this.blueNoiseTexture.wrapS=Gs,this.blueNoiseTexture.wrapT=Gs,this.blueNoiseTexture.minFilter=Bt,this.blueNoiseTexture.magFilter=Bt,this.blueNoiseTexture.needsUpdate=!0}setAmbientOcclusionParams(e,t,i,r,s,a,n,o){this.aoPass.enabled=e,this.aoPass.radius=t,this.aoPass.bias=i,this.aoPass.aoColor=r,this.aoPass.fogEnabled=s,this.aoPass.fogNear=a,this.aoPass.fogFar=n,this.aoPass.runHalfRes!==!o&&(this.aoPass.runHalfRes=!o)}setTransmissionPassEnabled(e){this.transmissionPass.enabled=e,this.opaquePass.hasTransmissionPass=e}_initPasses(){var e,t,i;if((e=this.uvEffectPass)==null||e.dispose(),(t=this.effectPass)==null||t.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.aoPass),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.effectComposer.addPass(this.taaPass),this.postprocessingState.enabled){let r=[this.effects.get("pixelation")].reduce(D8,[]);r.length>0&&(this.uvEffectPass=new rd(this.camera,...r),this.uvEffectPass.renderToScreen=!1,this.effectComposer.addPass(this.uvEffectPass));let s=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("depthOfField"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(D8,[]);if(s.length>0&&(this.effectPass=new rd(this.camera,...s),this.effectPass.renderToScreen=!1,this.effectComposer.addPass(this.effectPass),this._needsDOFResize&&((i=this.effects.get("depthOfField"))==null?void 0:i.enabled)&&window!==void 0)){let a=this.renderer.viewportWidth,n=this.renderer.viewportHeight;this.renderer.setSize(a-1,n-1),this.renderer.setSize(a,n)}}this.effectComposer.addPass(this.stylesOverlayPass),this.effectComposer.addPass(this.uiOverlayPass),this.effectComposer.addPass(this.sceneTransitionPass),this.effectComposer.addPass(this.helperPass),this.effectComposer.addPass(this.logoOverlayPass)}_initCopyPass(){if(this._savePass)return;let e=new j;this.renderer.getDrawingBufferSize(e),this._rt=new Rt(e.x,e.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:Gs,wrapT:Gs}),this._rt.samples=0,this._savePass=new Df(this._rt,!1),this._savePass.renderToScreen=!1}setCopyPass(e){this._rt=e,this._savePass=new Df(this._rt,!1),this.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(e){if(this._renderToScreen===e)return;let t=this.effectComposer;!t||(e===!0?t.removePass(this._savePass):t.addPass(this._savePass),this._renderToScreen=e,this.updateRenderToScreen())}set sceneTransitionFromTexture(e){e!==this.sceneTransitionPass.texture&&(e!==null?this.sceneTransitionPass.enabled=!0:(this.sceneTransitionPass.enabled=!1,this.updateRenderToScreen()),this.sceneTransitionPass.texture=e)}setWatermark(e){this.logoOverlayPass.enabled=e!==null,e&&(this.logoOverlayPass.texture=e)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(e){let{enabled:t,...i}=e,r=!1;t!==this.postprocessingState.enabled&&(r=!0);for(let s of Object.entries(i)){let a=s[1],n=this.effects.get(s[0]);if(n){n.enabled!==a.enabled&&(r=!0),n.enabled=a.enabled;for(let[o,l]of Object.entries(a))o==="blendFunction"?n.blendFunction=nY(l):n[o]=l}}this.postprocessingState=e,r&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(e,t,i,r){e instanceof ht?(this.effectComposer.inputBuffer.scissor.set(e.x,e.y,e.z,e.w),this.effectComposer.outputBuffer.scissor.set(e.x,e.y,e.z,e.w)):(this.effectComposer.inputBuffer.scissor.set(e,t,i,r),this.effectComposer.outputBuffer.scissor.set(e,t,i,r));let s=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(s),this.effectComposer.outputBuffer.scissor.multiplyScalar(s),this.renderer.setScissor(e,t,i,r)}setScissorTest(e){this.effectComposer.inputBuffer.scissorTest=e,this.effectComposer.outputBuffer.scissorTest=e,this.renderer.setScissorTest(e)}setViewport(e,t,i,r){e instanceof ht?(this.effectComposer.inputBuffer.viewport.copy(e),this.effectComposer.outputBuffer.viewport.copy(e)):(this.effectComposer.inputBuffer.viewport.set(e,t,i,r),this.effectComposer.outputBuffer.viewport.set(e,t,i,r))}resize(e,t,i){if(this.effectComposer.setSize(e,t,i),this._rt){let r=this.renderer.getPixelRatio();this._rt.setSize(e*r,t*r)}}dispose(){var e,t;(e=this.uvEffectPass)==null||e.dispose(),(t=this.effectPass)==null||t.dispose(),this.effectComposer.dispose()}},lY=e=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${e};
const int gShadowSamples = ${e};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        vec2 halton = haltonSequence[frameIndex];
        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
        float temporalAngle  = temporalOffset * PI2;

        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,hY=mt.lights_fragment_begin,cY=mt.shadowmask_pars_fragment,I8=null,dY=e=>{switch(e){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},uY=(e="medium")=>{if(I8===e)return!1;I8=e;let t=dY(e);mt.shadowmap_pars_fragment=lY(t);let i=hY.slice();i=i.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),i=i.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),mt.lights_fragment_begin=i;let r=cY.slice();return r=r.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),mt.shadowmask_pars_fragment=r,!0},pY=`
attribute vec3 randomColor;
varying vec3 vNormal;
flat out vec3 vColor;
#include <skinning_pars_vertex>
#include <morphtarget_pars_vertex>
	
void main()
{
#include <beginnormal_vertex>
#include <morphnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
vec3 transformed = vec3(position);
#include <morphtarget_vertex>
#include <skinning_vertex>

vNormal = normal;
vColor = randomColor;
gl_Position = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));
}
`,fY=`
uniform float depthContrast;
varying vec3 vNormal;
flat in vec3 vColor;
void main()
{
vec3 normal = (normalize(vNormal)).rgb;

float contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;

vec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);
gl_FragColor = vec4(resultColor, vColor.r);
gl_FragColor = vec4(resultColor, vColor.r);
}
`,wp=new It({vertexShader:pY,fragmentShader:fY,uniforms:{depthContrast:{value:1}}}),O8=new ai,R8=new j,mY=class extends wv{constructor(e){super(e),this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new j,this.dummyCamera=new v1,this.sceneTransitionDuration=0,this.sceneTransitionTimeRemaining=-1,this.isXRCopyPassSet=!1,this.clear=(s=!0,a=!0,n=!0)=>{let o=this.getContext(),l=0;s&&(l|=o.COLOR_BUFFER_BIT),a&&(l|=o.DEPTH_BUFFER_BIT),n&&(l|=o.STENCIL_BUFFER_BIT),o.clear(l),o.clearBufferfv(o.COLOR,1,[0,0,0,1])},this.pipeline=new oY(this,(e==null?void 0:e.needsDOFResize)??!1),this.autoClear=!1;let t=this.setPixelRatio.bind(this),i=this.setSize.bind(this);this.shadowMap.enabled=!0,this.shadowMap.type=Kf,this.dummyCamera.matrixAutoUpdate=!1,this.domElement.removeAttribute("data-engine");let r=this.getContext();if(r&&"drawingBufferColorSpace"in r)try{r.drawingBufferColorSpace="display-p3"}catch(s){}this.setPixelRatio=s=>{this._pixelRatio!==s&&(this._pixelRatio=s,t(s))},this.setSize=(s,a,n=!0)=>{var o,l;(this.viewportWidth!==s||this.viewportHeight!==a)&&(this.viewportWidth=s,this.viewportHeight=a,i(s,a,n),(o=this.normalRenderTarget)==null||o.setSize(s*this._pixelRatio,a*this._pixelRatio),this._resizeTransmission(s,a),(l=this.transmissionDepthTarget)==null||l.setSize(s*this._pixelRatio/2,a*this._pixelRatio/2),this.pipeline.resize(s,a,n))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createAORenderTarget(){this.aoRenderTarget===void 0&&(this.aoRenderTarget=new Rt(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:gt,magFilter:gt,wrapS:ei,wrapT:ei,depthBuffer:!1}))}_resizeTransmission(e,t){var i,r;(i=this.transmissionRenderTarget)==null||i.setSize(e*this._pixelRatio/(this.hdTransmission?1:2),t*this._pixelRatio/(this.hdTransmission?1:2)),(r=this.aoRenderTarget)==null||r.setSize(e*this._pixelRatio/1,t*this._pixelRatio/1)}get hdTransmission(){return tt.transmissionLod.value===1}set hdTransmission(e){tt.transmissionLod.value=e===!0?1:2,this._resizeTransmission(this.viewportWidth,this.viewportHeight)}createTransmissionRenderTarget(){this.transmissionRenderTarget===void 0&&(this.transmissionRenderTarget=new Rt(this.viewportWidth*this._pixelRatio/(this.hdTransmission?1:2),this.viewportHeight*this._pixelRatio/(this.hdTransmission?1:2),{generateMipmaps:!0,minFilter:tl,magFilter:gt,wrapS:ei,wrapT:ei,depthBuffer:!1}),this.transmissionDepthTarget=new Rt(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:Bt,magFilter:Bt,depthBuffer:!1}))}createNormalRenderTarget(){this.normalRenderTarget===void 0&&(this.normalRenderTarget=new Rt(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:Bt,magFilter:Bt,type:_i,depthTexture:new rl(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(e,t,i){this.normalRenderTarget&&(this.setClearColor(0),i.layers.enable(8),i.layers.disable(0),i.layers.disable(3),t.traverseEntity(r=>{r.layers.isEnabled(8)&&(r.copyPreviousMatrix=!1)}),this.setRenderTarget(this.normalRenderTarget),this.clear(),i instanceof v1?wp.uniforms.depthContrast.value=(i.far-i.near)/1e4:wp.uniforms.depthContrast.value=1,t.overrideMaterial=wp,this.render(t,i),this.setClearColor(t.bgColor,t.bgColor.a),this.setRenderTarget(null),t.overrideMaterial=e.wireframeState?Uf:null,i.layers.enable(0),i.layers.enable(3),t.traverseEntity(r=>{r.layers.isEnabled(8)&&(r.copyPreviousMatrix=!0)}))}renderSplineSceneWithDummyCamera(e,t,i=1){this.dummyCamera.updateCameraState(t.dataPatched),this.dummyCamera.matrix.copy(t.matrixWorld);let r=t.height,s=t.width,a=this.viewportWidth/this.viewportHeight;s<r?s=r*a:r=s/a,this.dummyCamera.setViewplaneSize(s,r);for(let n=0;n<i;n++)this.renderSplineScene(e,this.dummyCamera)}renderSplineScene(e,t,{sceneHelpers:i=this.sceneHelpers,sceneHelpersOnTop:r=this.sceneHelpersOnTop,overrideTransmission:s=void 0,overrideNormal:a=void 0}={}){var u;let n=e instanceof b5?e.activePage:e,o=n.visible;n.visible=!0;let l=n.scene;this.xr.enabled&&(this.isXRCopyPassSet===!1&&this.getRenderTarget()!==null&&(this.pipeline.setCopyPass(this.getRenderTarget()),this.isXRCopyPassSet=!0),this.xr.updateCamera(t)),this.setClearColor(n.bgColor,n.bgColor.a),n.penumbraSizeArray.forEach((p,f)=>{tt.penumbraSize.value[f]=p}),tt.pixelRatioNode.value=this.getPixelRatio(),this.resolution.x!==0&&this.resolution.y!==0?tt.resolution.value.set(this.resolution.x,this.resolution.y):tt.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),a!==void 0?(tt.normalRenderTarget.value=a,tt.normalRenderTargetDepth.value=O8):l.needsNormal()&&(this.createNormalRenderTarget(),tt.normalRenderTarget.value=this.normalRenderTarget.texture,tt.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(l,n,t));let h=n.data.ao,c=h.occlusion;if(c&&(this.createAORenderTarget(),tt.aoRenderTarget.value=this.aoRenderTarget.texture),tt.aoEnabled.value=c,this.pipeline.setAmbientOcclusionParams(h.occlusion,h.radius,h.bias,n.aoColor,n.fog!==null,n.backupFog.near,n.backupFog.far,h.aoFullRes&&!ch),this.pipeline.aoPass.setBlueNoiseTexture(this.pipeline.blueNoiseTexture),this.pipeline.isUIOverlayEnabled&&((u=n.uiCanvas)==null?void 0:u.enabled)&&n.uiCanvas.texture&&n.uiCanvas.texture.image.width>0){let p=this.getSize(R8),f=this.getPixelRatio();(n.uiCanvas.width!==this.viewportWidth||n.uiCanvas.height!==this.viewportHeight||n.uiCanvas.dpr!==f)&&n.uiCanvas.applySize({width:this.viewportWidth,height:this.viewportHeight},f),n.uiCanvas.render(this),this.pipeline.uiOverlayPass.uiCanvas=n.uiCanvas,this.pipeline.uiOverlayPass.enabled=!0,this.pipeline.uiOverlayPass.setResolution(p.x,p.y,f),this.pipeline.updateRenderToScreen()}else this.pipeline.uiOverlayPass.enabled=!1,this.pipeline.updateRenderToScreen();if(this.pipeline.logoOverlayPass.enabled){let p=this.getSize(R8),f=this.getPixelRatio();this.pipeline.logoOverlayPass.uniforms.uResolution.value.set(p.x,p.y),this.pipeline.logoOverlayPass.uniforms.uDPR.value=f}let d=!1;if(s!==void 0)tt.transmissionRenderTarget.value=s,tt.transmissionRenderTargetDepth.value=O8,this.pipeline.setTransmissionPassEnabled(!1);else{let p=l.needsTransmission();p&&(this.transmissionRenderTarget===void 0&&(d=!0),this.createTransmissionRenderTarget(),tt.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,tt.aspectRatio.value=Qj(this.viewportWidth,this.viewportHeight),tt.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(p)}t.layers.enable(3),t.layers.enable(8),this.pipeline.sceneHelpers=i,this.pipeline.sceneHelpersOnTop=r,this.pipeline.scene=n,this.pipeline.camera=t,d&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==n.postprocessing&&(this.pipeline.updatePostprocessing(n.postprocessing),!i&&!r&&this.pipeline.disableHelpers()),this.clearAlphaOverride!==void 0&&this.setClearAlpha(this.clearAlphaOverride),n.overrideMaterial=l.wireframeState?Uf:null,this.pipeline.render(),tt.frameIndex.value=(tt.frameIndex.value+1)%16,t instanceof v1&&t.copyHistory(),n.visible=o}renderFromSceneForSceneTransitionPass(e,t,i){this.pipeline.renderToScreen=!1,this.pipeline.renderTarget,this.renderSplineScene(e,t),this.pipeline.sceneTransitionFromTexture=this.pipeline.renderTarget.texture,this.sceneTransitionDuration=i,this.sceneTransitionTimeRemaining=i,this.pipeline.renderToScreen=!0;let r=this.pipeline.sceneTransitionPass.uniforms;r.uDPR.value=window.devicePixelRatio,r.uResolution.value.set(this.domElement.width,this.domElement.height).divideScalar(window.devicePixelRatio)}_currentDispose(){var e,t,i,r,s,a;this._superDispose(),this.pipeline.dispose(),(e=this.aoRenderTarget)==null||e.dispose(),(t=this.transmissionRenderTarget)==null||t.dispose(),(i=this.transmissionDepthTarget)==null||i.dispose(),(r=this.normalRenderTarget)==null||r.dispose(),(a=(s=this.normalRenderTarget)==null?void 0:s.depthTexture)==null||a.dispose()}},Ub=class extends ph(FP){constructor(e,t=15,i=10066329){super(e,t,i),this.object=e,this.added=!1,this.name=`DirectionalLightHelper: ${e.uuid}`}raycast(e,t){fh(this.object,Ub.geometryHelper,e,t)}},Nb=class extends ph(zP){constructor(e,t=15,i=6710886){super(e,t,i),this.object=e,this.name=`PointLightHelper: ${e.uuid}`}raycast(e,t){fh(this.object,Nb.geometryHelper,e,t)}},Rf=class extends ph(BP){constructor(e,t=6710886){super(e,t),this.object=e,this.name=`SpotLightHelper: ${e.uuid}`}raycast(e,t){fh(this.object,Rf.geometryHelper,e,t)}update(){if(this.object!==void 0){let e=Rf._vector,t=this.object.distance?this.object.distance:1e3,i=t*Math.tan(this.object.angle);this.cone.scale.set(i,i,t),e.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(e);let r=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let s=0,a=this.cone.material.length;s<a;s++)this.cone.material[s].color.set(r);else this.cone.material.color.set(r)}}},Vb=Rf;Vb._vector=new E;var jb=class extends qs{constructor(){super(),this.caretIndex=0,this._caretVisibleAlpha=1,this._selectionVisibleAlpha=.3,this.current={start:0,end:void 0},this.matrixAutoUpdate=!1,this.caretMesh=new si(new $s(1,1),new Js({transparent:!0,opacity:0,side:f1})),this.add(this.caretMesh),this.selectionMesh=new si(new $s(1,1),new Js({color:2857471,transparent:!0,depthTest:!1,depthWrite:!1,opacity:0,side:f1})),this.add(this.selectionMesh),this.hide()}get caretHeight(){var e;return((e=this.object)==null?void 0:e.AD)??0}show(e){this.visible=!0,this.object=e,this.caretMesh.scale.set(1,this.caretHeight,1),this.caretMesh.position.y=-this.caretHeight*.5,this.setCaretPosition(this.caretIndex),this.update()}hide(){this.visible=!1}update(){if(this.object===void 0)return;this.updateHelperMatrix();let{depth:e}=this.object.geometry.userData.parameters;this.caretMesh.position.z=e,this.selectionMesh.position.z=e}updateHelperMatrix(){if(this.object===void 0)return;let e=this.object,t=e.parent;t!==null&&t.updateWorldMatrix(!0,!1),e.matrixAutoUpdate&&e.updateMatrix(),t!==null?(this.matrixWorld.multiplyMatrices(t.matrixWorld,e.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,e.matrix)):this.matrixWorld.multiplyMatrices(e.hiddenMatrix,e.matrix),this.matrix.copy(this.matrixWorld);for(let i of this.children)i.matrixWorld.copy(this.matrixWorld);e.updateWorldMatrix(!0,!0)}setCaretColor(e){let t=this.caretMesh.material;t.color.setRGB(e.r,e.g,e.b);let i=this._caretVisibleAlpha===t.opacity;this._caretVisibleAlpha=e.a,i&&(t.opacity=this._caretVisibleAlpha)}setSelectionColor(e){this.selectionMesh.material.color.setRGB(e.r,e.g,e.b)}setCaretPosition(e,t={}){if(this.object===void 0)return;this.caretIndex=e;let i=this.object.wrappedText,[r,s]=sd(i,e),[a,n]=e>0?sd(i,e-1):[null,null];(e>0&&i.length?i[a].charAt(n):null)===`
`&&(r++,s=0),this.current.start=e,this.current.end=void 0;let[o,l]=Sp(this.object,r,s),{AD:h,descender:c}=this.object,d=c+h*.5,{width:u,height:p,depth:f}=this.object.geometry.userData.parameters,g=typeof u=="string"?0:u,m=typeof p=="string"?0:p;this.caretMesh.scale.set(1,this.caretHeight,1),this.caretMesh.position.set(o-g*.5,l+d+m*.5,f),this.hideSelectionMesh(),this.showCaretMesh()}setSelection(e,t){if(this.object===void 0)return;let i=this.object.wrappedText;this.current.start=e,this.current.end=t;let r=[],s=[],a=gY(i,e,t),{lineHeight:n,AD:o,descender:l}=this.object,h=l+o*.5-n*.5;for(let[m,v,y]of a)if(v!==y){let[x,w]=Sp(this.object,m,v),[_,b]=Sp(this.object,m,y);w+=h,b+=h,b+=n;let A=r.length/3;r.push(x,w,0),r.push(_,w,0),r.push(_,b,0),r.push(x,b,0),s.push(A+0,A+1,A+2),s.push(A+2,A+3,A+0)}let c=new Ge;c.setIndex(s),c.setAttribute("position",new De(r,3));let{width:d,height:u,depth:p}=this.object.geometry.userData.parameters,f=typeof d=="string"?0:d,g=typeof u=="string"?0:u;this.selectionMesh.geometry.dispose(),this.selectionMesh.geometry=c,this.selectionMesh.position.x=-f*.5,this.selectionMesh.position.y=g*.5,this.selectionMesh.position.z=p,this.showSelectionMesh(),this.hideCaretMesh()}getSelectionFromPosition(e,t,i="previous"){if(this.object===void 0||this.object.font===void 0)return;let r=this.object.wrappedText,s=r.length,a=this.object.lineHeight,n=s*a,{height:o,verticalAlign:l}=this.object.geometry.userData.parameters,h=typeof o=="string"?0:o,c=0;l===3?c=h-n:l===2&&(c=h*.5-n*.5);let d=Math.min(Math.floor(Math.max(Math.min(-t-c,n),0)/a),s-1),u=this.object.charCoords[d],p=this.object.charWidths[d],f=0,g=!1;if(i==="previous"){for(let m=0;m<u.length;m++)if(u[m][0]+p[m]*.5-e>0){f=m,g=!0;break}}else if(i==="closest"){let m=1/0;for(let v=0;v<u.length;v++){let y=u[v][0]+p[v]*.5,x=Math.abs(y-e);x<m&&(m=x,f=v,g=!0)}}else for(let m=0;m<u.length;m++){let v=u[m][0],y=u[m][0]+p[m];if(e>=v&&e<y){f=m,g=!0;break}}return g||(f=u.length),{index:this.getGlobalIndexFromLineAndCharIndexes(r,d,f),lineIndex:d,characterIndex:f}}getGlobalIndexFromLineAndCharIndexes(e,t,i){return e.slice(0,t).reduce((r,s)=>r+=s.length,0)+i}showSelectionMesh(){this.selectionMesh.material.opacity=this._selectionVisibleAlpha}hideSelectionMesh(){this.selectionMesh.material.opacity=0}showCaretMesh(){this.caretMesh.material.opacity=this._caretVisibleAlpha}hideCaretMesh(){this.caretMesh.material.opacity=0}};function Sp(e,t,i){let{charCoords:r,charWidths:s,initialOffsetY:a,lineHeight:n}=e;if(r[t]&&r[t].length===0||r.length===0){let c=0,{horizontalAlign:d}=e.data.geometry,u=e.wrappedText,{width:p}=e.geometry.userData.parameters;return u.length===1&&u[0].length===0&&(d===3?c=p*.5:d===2&&(c=p)),[c,a-n*t]}let o=r[t];if(o===void 0||o.length===0)return[0,0];let[l,h]=o[Math.min(i,o.length-1)];return i>=o.length&&(l+=s[t][i-1]),[l,h]}function sd(e,t){var r;let i=0;for(let s=0;s<e.length;s++){let a=e[s],n=t-i;if(n<=a.length)return[s,n];i+=a.length}return[Math.max(0,e.length-1),((r=e[e.length-1])==null?void 0:r.length)??0]}function gY(e,t,i){let[r,s]=sd(e,t),[a,n]=sd(e,i),o=[];s>=e[r].length&&(r++,s=0);for(let l=r;l<=a;l++){let h=e[l],c=l===r?s:0,d=l===a?n:h.length;o.push([l,c,d])}return o}function vY(e,t){let i=i1.fromHex(3223857),r=.8;for(let s of e.layers){if(s.data.type==="light"||s.data.type==="displace"||s.data.type==="fresnel"||s.data.type==="matcap"||s.data.type==="texture"||s.data.type==="toon"||s.data.type==="outline"||s.data.type==="transmission"||s.data.type==="noise")continue;let a=typeof s.data.alpha=="string"?Number(t.getVariable(s.data.alpha)):s.data.alpha;if(s.data.type==="color"&&a>.3){i=yY(s.data.color,t),r=a;break}else if((s.data.type==="depth"||s.data.type==="gradient")&&a>.3){let n=xY(s.data);i={r:n[0],g:n[1],b:n[2]},r=typeof s.data.alpha=="string"?1:s.data.alpha;break}}return{...i,a:r}}function yY(e,t){return typeof e=="string"?t.data.colors[e]:e}function xY(e){return e.colors[0]}function bY(e,t){e.shadow.camera.right=t/2,e.shadow.camera.left=-t/2,e.shadow.camera.top=t/2,e.shadow.camera.bottom=-t/2,e.shadow.needsUpdate=!0}var Gb=class extends c5(bP,Ub){constructor(e,t,i){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let r=this.shadow.camera;r.top=1250,r.bottom=-1250,r.right=1250,r.left=-1250,r.near=-1e4,r.far=2500;let s=new bc(this.shadow.camera);s.visible=!1,this.gizmos.shadowmap=s}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof bc&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t);let i=e.depth!==void 0&&e.depth!==this.shadow.camera.far||e.size!==void 0&&e.size/2!==this.shadow.camera.right;e.size!==void 0&&bY(this,e.size),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),e.penumbraSize!==void 0&&t.scene.markPenumbraSizeDirty(),i&&this.update()}},L8=new E,B8=new E,z8=new lt,Hb=class extends c5(gP,Vb){constructor(e,t,i){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let r=this.shadow.camera;r.fov=Oe.RAD2DEG*2*this.angle,r.aspect=1,r.near=100,r.far=2500;let s=new bc(this.shadow.camera);s.visible=!1,this.gizmos.shadowmap=s,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof bc&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),B8.setFromMatrixPosition(this.matrixWorld),z8.setFromRotationMatrix(this.matrixWorld),L8.copy(this.up).applyQuaternion(z8).negate().multiplyScalar(this.distance),this.target.position.copy(B8).add(L8),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.angle!==void 0&&(this.angle=e.angle),e.penumbra!==void 0&&(this.penumbra=e.penumbra),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.penumbraSize!==void 0&&t.scene.markPenumbraSizeDirty(),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}};function wY(e){let t=(e[0][0]+e[1][1])/2,i=(e[0][0]-e[1][1])/2,r=(e[1][0]+e[0][1])/2,s=(e[1][0]-e[0][1])/2,a=Math.sqrt(t*t+s*s),n=Math.sqrt(i*i+r*r),o=a+n,l=a-n,h=Math.atan2(r,i),c=Math.atan2(s,t),d=(c-h)/2,u=(c+h)/2,p=[[Math.cos(u),Math.sin(u)],[-Math.sin(u),Math.cos(u)]],f=[[o,0],[0,l]],g=[[Math.cos(d),Math.sin(d)],[-Math.sin(d),Math.cos(d)]];return p[0][0]*=-1,p[0][1]*=-1,g[0][0]*=-1,g[1][0]*=-1,[p,f,g]}function tc(e,t){return[[e[0][0]*t[0][0]+e[0][1]*t[1][0],e[0][0]*t[0][1]+e[0][1]*t[1][1]],[e[1][0]*t[0][0]+e[1][1]*t[1][0],e[1][0]*t[0][1]+e[1][1]*t[1][1]]]}function F8(e){return[[e[0][0],e[1][0]],[e[0][1],e[1][1]]]}function SY(e){let[t,i,r]=wY(e),s=tc(t,F8(r)),a=tc(tc(r,i),F8(r)),n=Math.atan2(s[1][0],s[0][0]),o=[a[0][0],a[1][1]],l=[a[0][1]/a[1][1],a[1][0]/a[0][0]];return{rotation:n,scale:o,shear:l}}function _Y({rotation:e,scale:t,shear:i}){let r=Math.cos(e),s=Math.sin(e),a=[[r,-s],[s,r]],n=[[t[0],i[0]*t[1]],[i[1]*t[0],t[1]]],o=tc(a,n);return[o[0][0],o[1][0],o[0][1],o[1][1]]}var Dt;(e=>{function t(){return[1,0,0,0,1,0,0,0,1]}e.identity=t;function i(b,A=e.identity()){for(let S=0,M=b.length;S<M;S++)A[S]=b[S];return A}e.copy=i;function r(b,A,S,M,C,T){return e.setAbcdef(e.identity(),b,A,S,M,C,T)}e.create=r;function s(b,A,S,M,C,T,P){return b[0]=A,b[1]=M,b[2]=T,b[3]=S,b[4]=C,b[5]=P,b}e.setAbcdef=s;function a(b,A){let[S,M,C,T,P,I]=o(b),[D,k,H,U,F,Z]=o(A),W=D*S+k*C,G=D*M+k*T,X=H*S+U*C,ee=H*M+U*T,Y=F*S+Z*C+P,$=F*M+Z*T+I;return e.create(W,G,X,ee,Y,$)}e.append=a;function n(b,A){let[S,M,C,T,P,I]=o(b),[D,k,H,U,F,Z]=o(A),W=S,G=M,X=C,ee=T;(D!==1||k!==0||H!==0||U!==1)&&(W=S*D+M*H,G=S*k+M*U,X=C*D+T*H,ee=C*k+T*U);let Y=P*D+I*H+F,$=P*k+I*U+Z;return e.create(W,G,X,ee,Y,$)}e.prepend=n;function o(b){return[b[0],b[3],b[1],b[4],b[2],b[5]]}e.getAbcdef=o;function l(b){let[A,S,M,C,T,P]=e.getAbcdef(b),I=A*C-S*M,D=C/I,k=-S/I,H=-M/I,U=A/I,F=(M*P-C*T)/I,Z=-(A*P-S*T)/I;return e.create(D,k,H,U,F,Z)}e.invert=l;function h([b,A],S){let[M,C,T,P,I,D]=e.getAbcdef(S);return[M*b+T*A+I,C*b+P*A+D]}e.apply=h;function c(b,A){let[S,M,C,T,P,I]=e.getAbcdef(A),D=1/(S*T+C*-M),[k,H]=b;return[T*D*k+-C*D*H+(I*C-P*T)*D,S*D*H+-M*D*k+(-I*S+P*M)*D]}e.applyInverse=c;function d(b,A,S=A){let[M,C,T,P,I,D]=e.getAbcdef(b);return e.setAbcdef(b,M*A,C*S,T*A,P*S,I*A,D*S),b}e.scale=d;function u(b,A){let S=Math.cos(A),M=Math.sin(A),[C,T,P,I,D,k]=e.getAbcdef(b);return e.setAbcdef(b,C*S-T*M,C*M+T*S,P*S-I*M,P*M+I*S,D*S-k*M,D*M+k*S),b}e.rotate=u;function p(b,A,S){let[M,C]=S,T=e.translate(b,-M,-C);return T=e.rotate(T,A),T=e.translate(T,M,C),T}e.rotateAround=p;function f(b,A,S){let[M,C,T,P,I,D]=e.getAbcdef(b);return e.setAbcdef(b,M,C,T,P,I+A,D+S),b}e.translate=f;function g(b,A,S){let[M,C,T,P]=e.getAbcdef(b);return e.setAbcdef(b,M,C,T,P,A,S),b}e.setTranslate=g;function m(b,A,S){let[M,C,T,P]=e.getAbcdef(b);return e.setAbcdef(b,M,C,T,P,A,S),b}e.setPosition=m;function v(b){let[A,S,M,C]=e.getAbcdef(b),T=Math.sqrt(A*A+S*S),P=Math.sqrt(M*M+C*C);return[T,P]}e.getScale=v;function y(b){let[,,,,A,S]=e.getAbcdef(b);return[A,S]}e.getPosition=y;function x(b,A){return e.decompose(b,A).rotation}e.getRotation=x;function w(b,A){let[S,M,C,T,P,I]=e.getAbcdef(b),{rotation:D,scale:k,shear:H}=SY([[S,C],[M,T]]);return{position:[P+(A[0]*S+A[1]*C)-A[0],I+(A[0]*M+A[1]*T)-A[1]],scale:k,rotation:D,shear:H,pivot:A}}e.decompose=w;function _(b,A,S,M,C=[0,0]){let[T,P]=b,[I,D]=M,[k,H,U,F]=_Y({rotation:S,scale:A,shear:C}),Z=T-(I*k+D*U)+I,W=P-(I*H+D*F)+D;return e.create(k,H,U,F,Z,W)}e.compose=_})(Dt||(Dt={}));var AY=Math.PI/180;function MY(e,t,i,r,s,a){let n=e-i,o=t-r;return n*n/(s*s)+o*o/(a*a)<=1}function EY(e){return e*AY}var Zi=class{constructor(e,t,i){this.uuid=e,this.data=t,this.localMatrix=Dt.identity(),this.worldMatrix=Dt.identity(),this.ignoreCameraZoom=!1,this.visible=!0,this._singleBBox=new Lf,this._recursiveBBox=new Lf,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this.stateSelection=null,this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this.name="",this.position=[0,0],this.scale=[1,1],this.rotation=0,this.shear=[0,0],this.emitter=Id(),this.dpr=i.dpr??1,this.dataPatched=t}project(e,t){let i=this.worldMatrix;return t&&(i=Dt.append(t.worldMatrix,i)),Dt.applyInverse(e,i)}intersects(e,t,i,r=!1){return this.visible&&!this.data.raycastLock&&this.intersectsInLocalSpace(...this.project([e,t],i),r)}intersectsInLocalSpace(e,t,i=!1){let{min:r,max:s}=i?this.recursiveBBox:this.singleBBox;return e>=r[0]&&e<=s[0]&&t>=r[1]&&t<=s[1]}applyTransforms(e){e.setTransform(this.worldMatrix,this.ignoreCameraZoom)}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges()),this._recursiveBBox}updateLocalMatrix(){this.localMatrix=Dt.compose(this.position,this.scale,EY(this.rotation),On.getPivot(this.dataPatched),this.shear)}updateWorldMatrix(e,t,i){let r=this.parent;t&&r!==null&&r!==void 0&&r.updateWorldMatrix(e,!0,!1),e&&this.updateLocalMatrix(),this.parent?this.worldMatrix=Dt.append(this.parent.worldMatrix,this.localMatrix):this.worldMatrix=Dt.copy(this.localMatrix),this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}get pivot(){return On.getPivot(this.data)}getCenter(){return[0,0]}getHalfSize(){return[0,0]}get id(){return this.uuid}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(e=>{e.resetBBoxNeedsUpdateSelf()})}updateTransformState(e){let t=!1;e.position!==void 0&&(t=!0,this.position=e.position),e.rotation!==void 0&&(t=!0,this.rotation=e.rotation),e.scale!==void 0&&(t=!0,this.scale=e.scale),e.shear!==void 0&&(t=!0,this.shear=e.shear),t&&(this.updateWorldMatrix(!0,!1,!0),this.resetBBoxNeedsUpdate())}updateByOp(e,t,i){e.type===0&&e.props.visible!==void 0&&(this.visible=e.props.visible),this.data=t,this.data=t;let r=e,s=Yt(e.path,["states","*"]);if(s!==null){if(e.type===0){let[a]=s;if((this==null?void 0:this.stateSelection)===a){let n={...e.props};if(delete n.name,Object.values(e.props).some(o=>o===void 0)){let o=this.data;if(o!==void 0){let l=Li.zoom(o,e.path.slice(2));if(l)for(let h in e.props)e.props[h]===void 0&&h in l&&(n[h]=l[h])}}r={...e,props:n,path:e.path.slice(2)}}}}else if(e.type===0){let a=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(a!==void 0){if(e.props.name!==void 0&&a.name){let{name:o,...l}=a;a=l}let n=Li.removeOverridden(e.path,e.props,a);r={...e,props:n}}}this.updateByPatchedOpBase(r,_n.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),i)}changeSelectedState(e,t,i=!1){if(!(this.data.states.length===0&&!i)){for(let r of this.data.states)_n.toOps(this.data,r.data).forEach(s=>{let a=Ic.replaceProps(s,this.data);this.dataPatched=this.data,this.updateByPatchedOp(a,this.data,t)});if(e!==null){let r=this.data.states.data(e);r&&(this.dataPatched=_n.patch(this.data,r),_n.toOps(this.data,r).forEach(s=>{this.updateByPatchedOp(s,this.dataPatched,t)}))}i&&this.updateTransformState(this.dataPatched),this.stateSelection=e}}updateState(e,t){e.name!==void 0&&(this.name=e.name),e.visible!==void 0&&(this.visible=e.visible),this.updateTransformState(e)}updateByPatchedOpBase(e,t,i){this.dataPatched=t,this.updateByPatchedOp(e,t,i)}updateByPatchedOp(e,t,i){e.path.length===0&&e.type===0&&this.updateState(e.props,i),this.requestRender()}traverseFrameAncestors(e){this.traverseAncestors(t=>{t.data.type==="frame2d"&&e(t)})}traverseAncestors(e){let t=this.parent;for(;t;)e(t),t=t.parent}requestRender(){this.traverseFrameAncestors(e=>{e.requestRender()})}clone(e){let t=new Zi(this.uuid,this.data,e);return t.parent=void 0,t}addEventListener(e,t){this.emitter.on(e,t)}removeEventListener(e,t){this.emitter.off(e,t)}dispatchEvent(e){this.emitter.emit(e.type,{...e,target:e.target??this})}traverseSortNextHelper(){let e=this.parent;if(e){let t=e.children;if(t){let i=t.indexOf(this)+1;return t[i]?t[i]:e.traverseSortNextHelper()}}}sortNext(){let e=this.children;return e&&e.length>0&&e[0]?e[0]:this.traverseSortNextHelper()}isDescendantOf(e){e instanceof Zi&&(e=e.uuid);let t=this;for(;t.parent;){if(t.parent.uuid===e)return!0;t=t.parent}return!1}},Er=class extends Zi{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this.context=i,this.children=[]}add(e){e.parent&&e.parent instanceof Er&&e.parent.remove(e),this.children.push(e),e.parent=this}remove(e){let t=this.children.indexOf(e);t>=0&&(this.children.splice(t,1),e.parent=void 0)}traverse(e){let t=e(this);if(t!==!0)for(let i of this.children)i instanceof Er?i.traverse(e):t=e(i)}intersectsChildrenHelper(e,t,i,r,s){for(let a of this.children)if(a.intersects(e,t,i,!1)&&(s.push(a),r)||a instanceof Er&&a.intersectsChildrenHelper(e,t,i,r,s))return!0;return!1}intersectsChildren(e,t,i,r=!1,s=[],a=!1){return this.intersectsChildrenHelper(e,t,i,r,s),s}intersectsChildrenHelperReverse(e,t,i,r,s){for(let a of this.children)if(a instanceof Er&&a.intersectsChildrenHelperReverse(e,t,i,r,s)||a.intersects(e,t,i,!1)&&(s.push(a),r))return!0;return!1}intersectsChildrenReverse(e,t,i,r=!1,s=[],a=!1){return this.intersectsChildrenHelperReverse(e,t,i,r,s),s}updateWorldMatrix(e,t,i){if(super.updateWorldMatrix(e,t,i),i&&this.children)for(let r of this.children)r.updateWorldMatrix(e,!1,!0)}find(e){let t;return this.traverse(i=>{i.uuid===e&&(t=i)}),t}innerDrawChildren(e){for(let t=this.children.length-1;t>=0;t--)this.children[t].draw(e)}resetBBoxNeedsUpdate(){super.resetBBoxNeedsUpdate(),this.traverse(e=>{e.resetBBoxNeedsUpdateSelf()})}clone(e){let t=new Er(this.uuid,this.data,e);t.parent=void 0;for(let i of this.children)t.add(i.clone(e));return t}},qa=class extends Er{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this.updateState(t,i)}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.innerDrawChildren(e),e.restore())}clone(e){let t=new qa(this.uuid,this.data,e);t.parent=void 0;for(let i of this.children)t.add(i.clone(e));return t}};function CY(e,t){let[[i,r],[s,a]]=e,[[n,o],[l,h]]=t,c=(i-s)*(o-h)-(r-a)*(n-l);if(c===0)return!1;let d=((i-n)*(o-h)-(r-o)*(n-l))/c,u=-((i-s)*(r-o)-(r-a)*(i-n))/c;return d>=0&&d<=1&&u>=0&&u<=1}var Wb=[[-1,1],[-1,-1],[1,-1],[1,1]],k8=(e,t,i)=>{let r=e.getCenter(),s=e.getHalfSize(),a=Dt.append(t,e.worldMatrix);s[0]===0&&s[1]===0?i.push(Dt.apply(r,a)):Wb.forEach(n=>{let o=[n[0]*s[0]+r[0],n[1]*s[1]+r[1]];i.push(Dt.apply(o,a))})},Lf=class{constructor(){this.matrix=Dt.identity(),this.min=[1/0,1/0],this.max=[-1/0,-1/0],this.vertices=[],this.edges=[]}setFromObjectSize(e,t=!1){e.updateWorldMatrix(),this.makeEmpty(),Dt.copy(e.worldMatrix,this.matrix);let i=Dt.invert(e.worldMatrix);this.expandByObjectSize(e,i,t)}expandByObjectSize(e,t,i=!1){let r=[];i===!0&&e instanceof Er?e.traverse(s=>{s.visible&&k8(s,t,r)}):k8(e,t,r),this.setFromPoints(r)}setFromSize(e,t,i){this.makeEmpty(),Dt.copy(i,this.matrix),this.expandBySize(e,t,i)}expandBySize(e,t,i){[Dt.apply([0,0],i),Dt.apply([0,t],i),Dt.apply([e,t],i),Dt.apply([e,0],i)].forEach(r=>this.expandByPoint(r))}getCenter(){let[e,t]=this.min,[i,r]=this.getHalfSize();return Dt.apply([e+i,t+r],this.matrix)}getSize(){return[this.max[0]-this.min[0],this.max[1]-this.min[1]]}getHalfSize(){return[(this.max[0]-this.min[0])*.5,(this.max[1]-this.min[1])*.5]}makeEmpty(){this.min=[1/0,1/0],this.max=[-1/0,-1/0]}setFromPoints(e){this.makeEmpty();for(let t of e)this.expandByPoint(t)}expandByPoint(e){this.min=[Math.min(this.min[0],e[0]),Math.min(this.min[1],e[1])],this.max=[Math.max(this.max[0],e[0]),Math.max(this.max[1],e[1])]}computeVertices(){let[e,t]=this.getHalfSize(),i=this.getCenter(),[r,s,a,n]=Dt.getAbcdef(this.matrix),o=Dt.create(r,s,a,n,i[0],i[1]);this.vertices=Wb.map(([l,h])=>Dt.apply([l*e,h*t],o))}computeEdges(){this.edges=[];for(let e=0,t=this.vertices.length;e<t;++e)this.edges.push([this.vertices[e],this.vertices[(e+1)%t]])}project(e,t){let i=this.matrix;return t&&(i=Dt.append(t.worldMatrix,i)),Dt.applyInverse(e,i)}intersects(e,t,i){return this.intersectsInLocalSpace(...this.project([e,t],i))}intersectsInLocalSpace(e,t){let{min:i,max:r}=this;return e>=i[0]&&e<=r[0]&&t>=i[1]&&t<=r[1]}containsPoint(e){let[t,i]=e,[r,s]=this.min,[a,n]=this.max;return t>=r&&t<=a&&i>=s&&i<=n}intersectsBBox2D(e){for(let t=0,i=this.edges.length;t<i;t++){let r=this.edges[t];for(let s=0,a=e.edges.length;s<a;s++){let n=e.edges[s];if(CY(r,n))return!0}}for(let t=0,i=e.vertices.length;t<i;t++){let r=e.vertices[t];if(this.containsPoint(r))return!0}return!1}ensureMinMax(){let e=this.min,t=this.max;this.min=[Math.min(e[0],t[0]),Math.min(e[1],t[1])],this.max=[Math.max(e[0],t[0]),Math.max(e[1],t[1])]}copy(e){this.min=[...e.min],this.max=[...e.max],Dt.copy(e.matrix,this.matrix),this.computeVertices(),this.computeEdges()}clone(){let e=new Lf;return e.copy(this),e}},qb,TY=new Promise(e=>{qb=e}),U8=!1,L0;function PY(){if(U8)return;if(L0)return L0;async function e(){let t=await Ya(()=>import("./x4HlE1cs.js"),[],import.meta.url);qb(t.default??t),U8=!0}return L0=e(),L0}function N8(e){let t=!1;return e.scene.objects.traverse((i,r)=>{(r.type==="Mesh"&&r.geometry.type==="UIGeometry"||r.type==="Page"&&r.uiFrame!==void 0)&&(t=!0)}),t}var ct,_p;async function DY(e){let t=await TY;ct||(_p||(_p=t({locateFile:()=>e})),ct=await _p)}var V8=Dt.identity(),Yb=class{constructor(e,t=1){this.canvas=e,this._dpr=t,this._width=0,this._height=0,this._strokeMode="inside",this._layerBlur=0,this._backgroundBlur=0,this._dropShadowBlur=0,this._dropShadowOffsetX=0,this._dropShadowOffsetY=0,this._dropShadowColor=jt.transparent,this._innerShadowBlur=0,this._innerShadowOffsetX=0,this._innerShadowOffsetY=0,this._innerShadowSpread=0,this._innerShadowColor=jt.transparent,this._fonts=new Map,this._isSizeDirty=!1;try{let i=e.getBoundingClientRect();e.width=i.width*t,e.height=i.height*t}catch{e.width}this._currentM3Transform=V8,this._currentTransform=new Float32Array(V8)}get dpr(){return this._dpr}set dpr(e){this._dpr=e,this._isSizeDirty=!0}async init(){var e,t;if(!this.wasmURL)throw Error("Your must set the wasm binary url with renderer.wasmURL = ... before you can call renderer.init");await DY(this.wasmURL),this._surface=ct.MakeWebGLCanvasSurface(this.canvas),this.ctx=(e=this._surface)==null?void 0:e.getCanvas(),this._paint=new ct.Paint,this._paint.setAntiAlias(!0),this._paintFill=this._paint.copy(),this._paintFill.setStyle(ct.PaintStyle.Fill),this._paintStroke=this._paint.copy(),this._paintStroke.setStyle(ct.PaintStyle.Stroke),(t=this.ctx)==null||t.scale(this.dpr,this.dpr)}get currentTransform(){return this._currentM3Transform}get currentTransformBuffer(){return this._currentTransform}set currentTransform(e){this._currentM3Transform=e,this._currentTransform.set(e)}async loadFont(e,t){let i=await(await fetch(e)).arrayBuffer();this.registerFont(i,t)}registerFont(e,t){if(this._fonts.has(t))return;let i=ct.FontMgr.FromData(e);if(i)this._fonts.set(t,i);else throw new Error("Invalid font data for "+t)}get width(){return this._width}get height(){return this._height}set strokeColor(e){this._paintStroke&&this._paintStroke.setColor(B0(e),ct.ColorSpace.DISPLAY_P3)}set fillColor(e){this._paintFill&&this._paintFill.setColor(B0(e),ct.ColorSpace.DISPLAY_P3)}set lineWidth(e){this._paintStroke&&this._paintStroke.setStrokeWidth(this._strokeMode==="center"?e:e*2)}set strokeMode(e){this._strokeMode=e}set dropShadowBlur(e){this._dropShadowBlur=e}set dropShadowColor(e){this._dropShadowColor=e}set dropShadowOffsetX(e){this._dropShadowOffsetX=e}set dropShadowOffsetY(e){this._dropShadowOffsetY=e}set innerShadowBlur(e){this._innerShadowBlur=e}set innerShadowColor(e){this._innerShadowColor=e}set innerShadowOffsetX(e){this._innerShadowOffsetX=e}set innerShadowOffsetY(e){this._innerShadowOffsetY=e}set innerShadowSpread(e){this._innerShadowSpread=e}set layerBlur(e){this._layerBlur=e}set backgroundBlur(e){this._backgroundBlur=e}clear(){var e;(e=this.ctx)==null||e.clear(ct.TRANSPARENT)}save(){var e;(e=this.ctx)==null||e.save()}restore(){var e;(e=this.ctx)==null||e.restore()}beginPath(){var e;(e=this._currentPath)==null||e.delete(),this._currentPath=new ct.Path}closePath(){let e=this._currentPath;if(e){if(e.isEmpty())return;let t=e.getBounds();(t[3]-t[1]||t[2]-t[0])&&e.close()}}fill(){this._paintInner(this._paintFill,!0)}stroke(){this._paintInner(this._paintStroke,!1)}clipRect(e,t,i,r,s=0,a=0,n=0,o=0){var h,c;let l=ct.XYWHRect(e,t,i,r);if(s===0&&a===0&&o===0&&n===0)(h=this.ctx)==null||h.clipRect(l,ct.ClipOp.Intersect,!0);else{let d=ct.RRectXY(l,s,s);d[4]=d[5]=s,d[6]=d[7]=a,d[8]=d[9]=n,d[10]=d[11]=o,(c=this.ctx)==null||c.clipRRect(d,ct.ClipOp.Intersect,!0)}}_applyShadowOffsetMatrix(){if(this.ctx){let e=Dt.invert(this.currentTransform);this.ctx.concat(e);let t=Dt.translate(Dt.identity(),this._dropShadowOffsetX,this._dropShadowOffsetY);this.ctx.concat(t),this.ctx.concat(this._currentTransform)}}_applyEffectsToPaint(e,t,i=!0){var r,s,a,n;if(this.ctx&&this._currentPath){let o,l=!1;if(i&&this._hasDropShadow()){let h=e.copy();h.setColor(B0(this._dropShadowColor));let c;this._dropShadowBlur>0&&(c=ct.MaskFilter.MakeBlur(ct.BlurStyle.Normal,this._dropShadowBlur*this.dpr*(((r=this.camera)==null?void 0:r.scale)??1),!1),h.setMaskFilter(c)),this.ctx.save(),this.ctx.clipPath(this._currentPath,ct.ClipOp.Difference,!0),this._applyShadowOffsetMatrix(),t(h),this.ctx.restore(),h.delete(),c==null||c.delete()}if(this._backgroundBlur>0&&i){this.ctx.save(),this.ctx.clipPath(this._currentPath,ct.ClipOp.Intersect,!0);let h=ct.ImageFilter.MakeBlur(this._backgroundBlur,this._backgroundBlur,ct.TileMode.Clamp,null),c=e.copy();c.setImageFilter(h),c.setAlphaf(1);let d=this._currentPath.computeTightBounds();this.ctx.saveLayer(c,d,null,ct.SaveLayerInitWithPrevious),this.ctx.drawColor(e.getColor()),this.ctx.restore(),this.ctx.restore(),c.delete(),h.delete(),l=!0}if(this._layerBlur>0){let h=e.copy();o=ct.MaskFilter.MakeBlur(ct.BlurStyle.Normal,this._layerBlur*this.dpr*(((s=this.camera)==null?void 0:s.scale)??1),!1),h.setMaskFilter(o),t(h),h.delete(),o.delete(),l=!0}if(l||t(e),i&&this._hasInnerShadow()){let h=new ct.Paint;h.setAntiAlias(!0),h.setStyle(ct.PaintStyle.Fill),h.setColor(B0(this._innerShadowColor));let c;this._innerShadowBlur>0&&(c=ct.MaskFilter.MakeBlur(ct.BlurStyle.Normal,this._innerShadowBlur*this.dpr*(((a=this.camera)==null?void 0:a.scale)??1),!1),h.setMaskFilter(c));let d=this._currentPath.computeTightBounds(),[u,p,f,g]=d,m=f-u,v=g-p;this.ctx.save(),this.ctx.clipPath(this._currentPath,ct.ClipOp.Intersect,!0),this.ctx.saveLayer(h,d,null,ct.SaveLayerInitWithPrevious),(n=this.ctx)==null||n.translate(this._innerShadowOffsetX,this._innerShadowOffsetY),this.ctx.drawRect(ct.XYWHRect(-1e3-this._innerShadowOffsetX,-1e3-this._innerShadowOffsetY,2e3+m+Math.abs(this._innerShadowOffsetX*2),2e3+v+Math.abs(this._innerShadowOffsetY*2)),h),h.setBlendMode(ct.BlendMode.Clear),this.ctx.drawPath(this._currentPath,h),this.ctx.restore(),this.ctx.restore(),h.delete(),c==null||c.delete()}}}_paintInner(e,t=!0){if(this.ctx&&this._currentPath&&e){let i=this.ctx,r=this._currentPath;this._applyEffectsToPaint(e,s=>{let a=!1;!t&&this._strokeMode!=="center"&&(i.save(),i.clipPath(r,this._strokeMode==="outside"?ct.ClipOp.Difference:ct.ClipOp.Intersect,!0),a=!0),i.drawPath(r,s),a&&i.restore()},t)}}_hasDropShadow(){var e;return((e=this._dropShadowColor)==null?void 0:e.a)>0}_hasInnerShadow(){var e;return((e=this._innerShadowColor)==null?void 0:e.a)>0}path(e){var t;(t=this._currentPath)==null||t.addPath(ct.Path.MakeFromSVGString(e))}ellipse(e,t,i,r,s,a,n,o){var h;if(!j8([e,t,i,r])||!this._currentPath)return;if(i<0||r<0)throw Error("radii cannot be negative");let l=ct.XYWHRect(e-i,t-r,i*2,r*2);(h=this._currentPath)==null||h.addOval(l)}rect(e,t,i,r,s=0,a=0,n=0,o=0){var h,c;let l=ct.XYWHRect(e,t,i,r);if(j8(l))if(s===0&&a===0&&o===0&&n===0)(h=this._currentPath)==null||h.addRect(l);else{let d=ct.RRectXY(l,s,s);d[4]=d[5]=s,d[6]=d[7]=a,d[8]=d[9]=n,d[10]=d[11]=o,(c=this._currentPath)==null||c.addRRect(d)}}getHorizontalAlign(e){switch(e){case 2:return ct.TextAlign.Right;case 3:return ct.TextAlign.Center;case 4:return ct.TextAlign.Justify;case 1:default:return ct.TextAlign.Left}}drawTextInner(e,t,i,[r,s,a,n],o,l,h=!0){let c=0,{ctx:d}=this;if(!d)return c;let u=l.copy(),p=l.copy();return p.setAlphaf(0),this._applyEffectsToPaint(u,f=>{t.pushPaintStyle(i,f,p),t.addText(e);let g=t.build();g.layout(a);let m=s;o===2?m+=(n-g.getHeight())/2:o===3&&(m+=n-g.getHeight()),d.drawParagraph(g,r,m),c=g.getHeight(),t.reset(),g.delete()},h),u.delete(),p.delete(),c}drawText(e,t){let i=0,r=this._fonts.get(t.font),{ctx:s,_paintFill:a,_paintStroke:n}=this;if(r&&s){let o=new ct.TextStyle({fontFamilies:[t.font],fontSize:t.fontSize,heightMultiplier:t.lineHeight,letterSpacing:t.letterSpacing}),l=new ct.ParagraphStyle({textStyle:o,textAlign:this.getHorizontalAlign(t.horizontalAlign)}),h=ct.XYWHRect(t.x,t.y,t.width,t.height),c=ct.ParagraphBuilder.Make(l,r);a&&(i=this.drawTextInner(e,c,o,h,t.verticalAlign,a,!0)),n&&(i=this.drawTextInner(e,c,o,h,t.verticalAlign,n,!1)),c.delete()}return{height:i}}render(){var e;(e=this._surface)==null||e.flush()}moveTo(e,t){var i;(i=this._currentPath)==null||i.moveTo(e,t)}lineTo(e,t){var i;(i=this._currentPath)==null||i.lineTo(e,t)}bezierCurveTo(e,t,i,r,s,a){var n;(n=this._currentPath)==null||n.cubicTo(e,t,i,r,s,a)}quadraticCurveTo(e,t,i,r){var s;(s=this._currentPath)==null||s.quadTo(e,t,i,r)}setTransform(e,t=!1){var s,a,n,o,l;if(!this.ctx)return;let i=this.ctx.getTotalMatrix(),r=Dt.invert(i);if(r&&this.ctx.concat(r),(s=this.ctx)==null||s.scale(this.dpr,this.dpr),((a=this.camera)==null?void 0:a.enabled)&&((n=this.ctx)==null||n.concat(this.camera.worldMatrix),t)){let h=Dt.getScale(this.camera.worldMatrix);(o=this.ctx)==null||o.scale(1/h[0],1/h[1])}(l=this.ctx)==null||l.concat(e),this.currentTransform=e}transform(e){var t;(t=this.ctx)==null||t.concat(e)}setSize(e,t){var i;!this._isSizeDirty&&e===this._width&&t===this._height||(this._isSizeDirty=!1,this._width=e,this._height=t,this.canvas.style.width=e+"px",this.canvas.style.height=t+"px",this.canvas.width=e*this.dpr,this.canvas.height=t*this.dpr,this._surface&&(this._surface=ct.MakeWebGLCanvasSurface(this.canvas),this.ctx=(i=this._surface)==null?void 0:i.getCanvas()))}};function j8(e){for(let t=0;t<e.length;t++)if(e[t]!==void 0&&!Number.isFinite(e[t]))return!1;return!0}function B0({r:e,g:t,b:i,a:r}){return ct.Color4f(e,t,i,r)}var G8=class{constructor(e,t,i){this.uuid=e,this.data=t,this.enabled=!1,this.color=jt.transparent,this.blurRadius=0,this.offset=[0,0],this.spread=0,this.update(t)}update(e){e.color!==void 0&&(this.color=e.color),e.enabled!==void 0&&(this.enabled=e.enabled),e.blurRadius!==void 0&&(this.blurRadius=e.blurRadius),e.offset!==void 0&&(this.offset=e.offset),e.spread!==void 0&&(this.spread=e.spread)}},H8=class{constructor(e,t,i){this.uuid=e,this.data=t,this.enabled=!1,this.radius=0,this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.radius!==void 0&&(this.radius=e.radius)}},IY=class{constructor(e,t,i){this.uuid=e,this.data=t,this.enabled=!1,this.color=jt.transparent,this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.color!==void 0&&(this.color=e.color)}},OY=class{constructor(e,t,i){this.uuid=e,this.data=t,this.enabled=!1,this.color=jt.transparent,this.thickness=0,this.mode="inside",this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.color!==void 0&&(this.color=e.color),e.thickness!==void 0&&(this.thickness=e.thickness),e.mode!==void 0&&(this.mode=e.mode)}},Hi=class extends Zi{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this.autoClose=!0,this.fill=new IY(e+"-fill",t.fill,i),this.stroke=new OY(e+"-stroke",t.stroke,i),this.dropShadow=new G8(e+"-dropShadow",t.dropShadow,i),this.innerShadow=new G8(e+"-innerShadow",t.innerShadow,i),this.backgroundBlur=new H8(e+"-backgroundBlur",t.backgroundBlur,i),this.layerBlur=new H8(e+"-layerBlur",t.layerBlur,i)}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:jt.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:jt.transparent,e.strokeMode=this.stroke.mode,e.lineWidth=this.stroke.thickness}applyFilters(e){this.layerBlur.enabled?e.layerBlur=this.layerBlur.radius*5:e.layerBlur=0,this.backgroundBlur.enabled?e.backgroundBlur=this.backgroundBlur.radius*5:e.backgroundBlur=0,this.dropShadow.enabled?(e.dropShadowBlur=this.dropShadow.blurRadius*5,e.dropShadowColor=this.dropShadow.color,e.dropShadowOffsetX=this.dropShadow.offset[0],e.dropShadowOffsetY=this.dropShadow.offset[1]):e.dropShadowColor=jt.transparent,this.innerShadow.enabled?(e.innerShadowSpread=this.innerShadow.spread,e.innerShadowBlur=this.innerShadow.blurRadius*5,e.innerShadowColor=this.innerShadow.color,e.innerShadowOffsetX=this.innerShadow.offset[0],e.innerShadowOffsetY=this.innerShadow.offset[1]):e.innerShadowColor=jt.transparent}innerDraw(e){}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.applyFilters(e),this.applyFillStroke(e),e.beginPath(),this.innerDraw(e),this.autoClose&&e.closePath(),this.fill.enabled&&e.fill(),this.stroke.enabled&&e.stroke(),e.restore())}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),e.type===0&&(Yt(e.path,["fill"])?this.fill.update(e.props):Yt(e.path,["stroke"])?this.stroke.update(e.props):Yt(e.path,["dropShadow"])?this.dropShadow.update(e.props):Yt(e.path,["innerShadow"])?this.innerShadow.update(e.props):Yt(e.path,["layerBlur"])?this.layerBlur.update(e.props):Yt(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}updateState(e,t){super.updateState(e,t),e.fill!==void 0&&this.fill.update(e.fill),e.stroke!==void 0&&this.stroke.update(e.stroke),e.dropShadow!==void 0&&this.dropShadow.update(e.dropShadow),e.innerShadow!==void 0&&this.innerShadow.update(e.innerShadow),e.layerBlur!==void 0&&this.layerBlur.update(e.layerBlur),e.backgroundBlur!==void 0&&this.backgroundBlur.update(e.backgroundBlur)}clone(e){let t=new Hi(this.uuid,this.data,e);return t.parent=void 0,t}},p5=class extends Hi{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this.width=0,this.height=0,this.updateState(t,i)}innerDraw(e){e.ellipse(this.width*.5,this.height*.5,this.width*.5,this.height*.5,0,0,Math.PI*2)}intersectsInLocalSpace(e,t){return MY(e,t,this.width*.5,this.height*.5,this.width*.5,this.height*.5)}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e)}clone(e){let t=new p5(this.uuid,this.data,e);return t.parent=void 0,t}},vh=class extends Hi{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this.width=0,this.height=0,this.cornerRadius=[0,0,0,0],this.updateState(t,i)}innerDraw(e){e.rect(0,0,this.width,this.height,...this.cornerRadius)}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateCornerState(e){e.cornerRadius!==void 0&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e)}clone(e){let t=new vh(this.uuid,this.data,e);return t.parent=void 0,t}},f5=class extends Hi{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this._textHeight=0,this._textHeightDirty=!0,this.width=0,this.height=0,this.updateState(t,i)}get textHeight(){return this._textHeight}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:jt.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:jt.transparent,e.strokeMode="center",e.lineWidth=this.stroke.thickness}innerDraw(e){var a;(a=this._fontHolder)!=null&&a.arrayBuffer&&this._fontHolder.arrayBuffer.byteLength>1&&this.data.font&&e.registerFont(this._fontHolder.arrayBuffer,this.data.font);let t=this.data.textTransform,i=this.data.text.textValue.toString(),r=t===2?i.toUpperCase():t===3?i.toLowerCase():i,{height:s}=e.drawText(r,{x:0,y:0,width:this.width,height:this.height,fontSize:this.data.fontSize,lineHeight:this.data.lineHeight??1,letterSpacing:this.data.letterSpacing??0,horizontalAlign:this.data.horizontalAlign,verticalAlign:this.data.verticalAlign,font:this.data.font});this._textHeight=s}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateFontState(e,{shared:t}){e.font!==void 0&&(this._fontHolder=t.getFont(e.font),this._fontHolder&&!this._fontHolder.isLoaded&&this._fontHolder.loadingPromise.then(()=>{this.requestRender()}))}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateFontState(e,t)}clone(e){let t=new f5(this.uuid,this.data,e);return t.parent=void 0,t}},Xb=class extends Hi{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this.curves=[],this.extremasBBox={min:[0,0],max:[0,0]},this.updateState(t,i)}computeExtremas(){this.curves.length===0&&this.computeCurves();let e=this.curves.map(r=>ad.extremas(r)),t=[1/0,1/0],i=[-1/0,-1/0];for(let r=0,s=e.length;r<s;r++){let a=e[r];a[0][0]<t[0]&&(t[0]=a[0][0]),a[0][1]<t[1]&&(t[1]=a[0][1]),a[1][0]>i[0]&&(i[0]=a[1][0]),a[1][1]>i[1]&&(i[1]=a[1][1])}return this.extremasBBox.min=[t[0],t[1]],this.extremasBBox.max=[i[0],i[1]],this.extremasBBox}computeCurves(){this.curves=[];for(let i=1,r=this.data.points.length;i<r;i++){let s=this.data.points[i].data,a=this.data.points[i-1].data,n={start:a.position,cp1:a.controlNext.position,cp2:s.controlPrevious.position,end:s.position};this.curves.push(n)}let e=this.data.points[0].data,t=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let i={start:t.position,cp1:t.controlNext.position,cp2:e.controlPrevious.position,end:e.position};this.curves.push(i)}}getCenter(){let[e,t]=this.extremasBBox.min,[i,r]=this.getHalfSize();return[e+i,t+r]}getHalfSize(){let{min:e,max:t}=this.extremasBBox;return[(t[0]-e[0])*.5,(t[1]-e[1])*.5]}innerDraw(e){for(let r=0,s=this.data.points.length;r<s;r++){let a=this.data.points[r].data;if(r===0){let[n,o]=a.position;e.moveTo(n,o)}else{let n=this.data.points[r-1].data,[o,l]=n.controlNext.position,[h,c]=a.controlPrevious.position,[d,u]=a.position,p={start:n.position,cp1:n.controlNext.position,cp2:a.controlPrevious.position,end:a.position};ad.derive(p),e.bezierCurveTo(o,l,h,c,d,u)}}let t=this.data.points[0].data,i=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let[r,s]=i.controlNext.position,[a,n]=t.controlPrevious.position,[o,l]=t.position;e.bezierCurveTo(r,s,a,n,o,l)}}updateState(e,t){super.updateState(e,t),this.computeExtremas()}clone(e){let t=new Xb(this.uuid,this.data,e);return t.parent=void 0,t}},ad;(e=>{function t(n){let o=n.start,l=n.cp1,h=n.cp2,c=n.end,d=[3*(l[0]-o[0]),3*(l[1]-o[1])],u=[3*(h[0]-l[0]),3*(h[1]-l[1])],p=[3*(c[0]-h[0]),3*(c[1]-h[1])],f={start:d,cp:u,end:p};return n.derivative=f,f.derivative=Bf.derive(f),f}e.derive=t;function i(n,o,l,h=!1){let c=n-2*o+l;if(c!==0){let d=-Math.sqrt(Math.abs(o*o-n*l)),u=-n+o,p=-(d+u)/c,f=-(-d+u)/c;return[p,f]}else if(o!==l&&c===0)return[(2*o-l)/(2*(o-l))];return[]}function r(n){let o=n.derivative??e.derive(n),l=o.start,h=o.cp,c=o.end;return[i(l[0],h[0],c[0]),i(l[1],h[1],c[1])]}e.droot=r;function s(n){let[o,l]=e.droot(n),h=[n.start[0],n.end[0]],c=[n.start[1],n.end[1]];for(let d of o)h.push(e.compute(n,Math.min(1,Math.max(0,d)))[0]);for(let d of l)c.push(e.compute(n,Math.min(1,Math.max(0,d)))[1]);return h.sort((d,u)=>d-u),c.sort((d,u)=>d-u),[[h[0],c[0]],[h[h.length-1],c[c.length-1]]]}e.extremas=s;function a(n,o){if(o===0)return[...n.start];if(o===1)return[...n.end];let l=1-o,h=l*l,c=o*o,d=h*l,u=h*o*3,p=l*c*3,f=o*c;return[d*n.start[0]+u*n.cp1[0]+p*n.cp2[0]+f*n.end[0],d*n.start[1]+u*n.cp1[1]+p*n.cp2[1]+f*n.end[1]]}e.compute=a})(ad||(ad={}));var Bf;(e=>{function t(s){let a=s.start,n=s.cp,o=s.end,l=[2*(n[0]-a[0]),2*(n[1]-a[1])],h=[2*(o[0]-n[0]),2*(o[1]-n[1])],c={start:l,end:h};return c.derivative=zf.derive(c),s.derivative=c,c}e.derive=t;function i(s){let a=s.derivative??e.derive(s),n=a.start,o=a.end;return[n[0]!==o[0]?n[0]/(n[0]-o[0]):0,n[1]!==o[1]?n[1]/(n[1]-o[1]):0]}e.droot=i;function r(s,a){if(a===0)return[...s.start];if(a===1)return[...s.end];let n=1-a,o=n*n,l=a*a,h=o,c=n*a*2,d=l;return[h*s.start[0]+c*s.cp[0]+d*s.end[0],h*s.start[1]+c*s.cp[1]+d*s.end[1]]}e.compute=r})(Bf||(Bf={}));var zf;(e=>{function t(r){let s=r.start,a=r.end,n=[a[0]-s[0],a[1]-s[1]];return r.derivative=n,r.derivative}e.derive=t;function i(r,s){if(s===0)return[...r.start];if(s===1)return[...r.end];let a=r.start,n=r.end;return[a[0]+(n[0]-a[0])*s,a[1]+(n[1]-a[1])*s]}e.compute=i})(zf||(zf={}));var ds=class extends Er{constructor(e,t,i){super(e,t,i),this.uuid=e,this.width=0,this.height=0,this.clipped=!0,this.background=new vh(e+"-background",X2.defaultData,i),this.background.parent=this,this.updateState(t,i)}get fill(){return this.background.fill}get stroke(){return this.background.stroke}get backgroundBlur(){return this.background.backgroundBlur}get layerBlur(){return this.background.layerBlur}get dropShadow(){return this.background.dropShadow}get innerShadow(){return this.background.innerShadow}get cornerRadius(){return this.background.cornerRadius}set cornerRadius(e){this.background.cornerRadius=e}updateLocalMatrix(){var e;super.updateLocalMatrix(),(e=this.background)==null||e.updateLocalMatrix()}updateWorldMatrix(e,t,i){var r;super.updateWorldMatrix(e,t,i),(r=this.background)==null||r.updateWorldMatrix(e,t,i)}draw(e){if(!this.visible)return;e.save();let t=this.width,i=this.height;this.applyTransforms(e),this.background.width=t,this.background.height=i,this.background.draw(e),this.clipped&&e.clipRect(0,0,t,i,...this.cornerRadius),this.innerDrawChildren(e),e.restore()}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateCornerState(e){e.cornerRadius!==void 0&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e),e.fill!==void 0&&this.fill.update(e.fill),e.stroke!==void 0&&this.stroke.update(e.stroke),e.dropShadow!==void 0&&this.dropShadow.update(e.dropShadow),e.innerShadow!==void 0&&this.innerShadow.update(e.innerShadow),e.layerBlur!==void 0&&this.layerBlur.update(e.layerBlur),e.backgroundBlur!==void 0&&this.backgroundBlur.update(e.backgroundBlur),e.clipped!==void 0&&(this.clipped=e.clipped)}requestRender(){super.requestRender(),this.dispatchEvent({type:"render"})}dispose(){this.removeEventListener("render")}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),e.type===0&&(Yt(e.path,["fill"])?this.fill.update(e.props):Yt(e.path,["stroke"])?this.stroke.update(e.props):Yt(e.path,["dropShadow"])?this.dropShadow.update(e.props):Yt(e.path,["innerShadow"])?this.innerShadow.update(e.props):Yt(e.path,["layerBlur"])?this.layerBlur.update(e.props):Yt(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}clone(e){let t=new ds(this.uuid,this.data,e);t.parent=void 0;for(let i of this.children)t.add(i.clone(e));return t}},RY=aa(K7(),1),Bd=class extends Hi{constructor(e,t,i){super(e,t,i),this.uuid=e,this.data=t,this._pathBBox=new DOMRect,this.path="",this.updateState(t,i),this.autoClose=!1,this.computeSVGBBox()}computeSVGBBox(){let e=document.createElementNS("http://www.w3.org/2000/svg","svg"),t=document.createElementNS("http://www.w3.org/2000/svg","path");document.body.appendChild(e),t.setAttribute("d",this.path),e.appendChild(t),this._pathBBox=t.getBBox(),e.remove()}innerDraw(e){e.path(this.path)}intersectsInLocalSpace(e,t){return e>=this._pathBBox.x&&e<=this._pathBBox.x+this._pathBBox.width&&t>=this._pathBBox.y&&t<=this._pathBBox.y+this._pathBBox.height}getCenter(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}getHalfSize(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}updateState(e,t){super.updateState(e,t),e.path!==void 0&&(this.path=e.path,this.computeSVGBBox())}clone(e){let t=new Bd(this.uuid,this.data,e);return t.parent=void 0,t}};function LY(e,t=1,i=1){if(t<=0||i<=0)return e;let r=(0,RY.parseSVG)(e).map(s=>{let a={...s};return"x"in a&&(a.x=a.x*t),"y"in a&&(a.y=a.y*i),"x1"in a&&(a.x1=a.x1*t),"x2"in a&&(a.x2=a.x2*t),"y1"in a&&(a.y1=a.y1*i),"y2"in a&&(a.y2=a.y2*i),"rx"in a&&(a.rx=a.rx*t),"ry"in a&&(a.ry=a.ry*i),a});return BY(r)}function BY(e){let t=["rx","ry","xAxisRotation","largeArc","sweep","x1","y1","x2","y2","x","y"],i;return e.map(r=>{let s=[];t.forEach(n=>{if(n in r){let o=r[n]*1;s.length&&o>=0&&s.push(","),s.push(o)}});let a=(i===r.code?s[0]<0?"":",":r.code)+s.join("");return i=r.code,a}).join("")}function zY(e,t,i){switch(t.type){case"ellipse2d":return new p5(e,t,i);case"rectangle2d":return new vh(e,t,i);case"text2d":return new f5(e,t,i);case"vector2d":return new Xb(e,t,i);case"path2d":return new Bd(e,t,i);case"frame2d":return new ds(e,t,i);case"group2d":default:return new qa(e,t,i)}}var Qb=class{constructor(e,t,i){this.uuid=e,this.data=t,this.group=new qa(Qb.GROUP_ID,{...Zc.defaultData},i),this.createChildrenObjects(t.objects,this.group,i)}createObject(e,t,i,r,s,a){let n=zY(e,t,a);n&&(r.add(n),r.children.splice(s,0,r.children.pop()),n.updateWorldMatrix(),i.length>0&&(n instanceof qa||n instanceof ds)&&this.createChildrenObjects(i,n,a))}createChildrenObjects(e,t,i){let r=0;for(let s of e)this.createObject(s.id,s.data,s.children,t,r,i),r+=1}draw(e){this.group.draw(e)}updateEntityByOp(e,t,i,r){let s=this.find(e);if(s)try{s.updateByOp(t,i,{shared:r})}catch(a){}}updateTreeByOp(e,t){if(e.path.length===0&&e.type===7){let i=e.parent===null?this.group:this.find(e.parent);i!==void 0&&i instanceof Er&&(this.createObject(e.id,e.data,e.children,i,e.localIndex,t),i.requestRender())}else if(e.path.length===0&&e.type===8){let i=this.find(e.id);if(i!==void 0&&i.parent!==void 0&&i.parent instanceof Er){let r=i.parent;i.resetBBoxNeedsUpdate(),r==null||r.remove(i),r==null||r.requestRender()}}else if(e.path.length===0&&e.type===9){let i=this.find(e.id);if(i!==void 0){let r=i.parent,s=e.parent===null?this:this.find(e.parent);if(s instanceof Er||s===this){s.add(i);let a=e.localIndex;s.children.splice(a,0,s.children.pop()),i.updateWorldMatrix(!0,!1,!0),r==null||r.requestRender(),i.requestRender()}i.resetBBoxNeedsUpdate()}}}add(e){this.group.add(e)}remove(e){this.group.remove(e)}traverse(e){this.group.traverse(t=>{t!==this.group&&e(t)})}intersectsChildren(e,t,i,r=!1,s=[]){return this.group.intersectsChildren(e,t,i,r,s,!0)}intersectsChildrenReverse(e,t,i,r=!1,s=[]){return this.group.intersectsChildrenReverse(e,t,i,r,s,!0)}find(e){return this.group.find(e)}get children(){return this.group.children}project(e,t){return this.group.project(e,t)}getWithSortKey(e){let t=this.find(e);if(t===void 0)return;let i=[],r=t;for(;r!==this.group;){let s=r;r=r.parent;let a=r.children.indexOf(s);i.splice(0,0,a)}return{entity:t,sortKey:i}}getAllSorted(e){let t=[];for(let i of e){let r=this.getWithSortKey(i.id);r!==void 0&&t.push(r)}return t.sort((i,r)=>Py(i.sortKey,r.sortKey)),t.map(i=>i.entity)}},m5=Qb;m5.GROUP_ID="scene2d";function Zb({constraints:e,newParentWidth:t,newParentHeight:i,initialParentWidth:r,initialParentHeight:s,objectInitialWidth:a,objectInitialHeight:n,objectInitialPosition:o}){let{horizontalConstraint:l,verticalConstraint:h}=e,c=t-r,d=i-s,u=a,p=n,f=o[0],g=o[1];if(l!==0){if(l===1)f+=c;else if(l===3)f+=c/2;else if(l===2)u=Math.max(1,u+c);else if(l===4){let m=t/r;u*=m,f*=m}}if(h!==0){if(h===1)g+=d;else if(h===3)g+=d/2;else if(h===2)p=Math.max(1,p+d);else if(h===4){let m=i/s;p*=m,g*=m}}return{width:u,height:p,position:[f,g]}}aa(K7(),1);var FY=`
	varying vec2 vUv;
	void main() {
		vUv = uv;
		gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
	}`,kY=`
	uniform sampler2D tDiffuse;
	varying vec2 vUv;
	void main() {
		vec4 texel = texture2D( tDiffuse, vUv );
		gl_FragColor = texel;
	}`,UY=new pd(-1,1,1,-1,0,1),NY=class extends Ge{constructor(){super(),this.setAttribute("position",new De([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new De([0,2,0,0,2,0],2))}},VY=new NY,jY=class{constructor(e){this._mesh=new si(VY,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,UY)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}},Kb=new It({defines:{},uniforms:{tDiffuse:new ve(null)},vertexShader:FY,fragmentShader:kY}),GY=new jY(Kb),Ap=null,Mp=null,HY=()=>(Ap===null&&(Ap=document.createElement("canvas")),Ap),WY=e=>(Mp===null&&(Mp=new Yb(e)),Mp),qY=Dt.identity(),Jb=class{constructor(e,t,i,r){this.uuid=e,this.width=t,this.height=i,this.context=r,this.enabled=!0,this.isScreenSpace=!1,this.dpr=window.devicePixelRatio,this.isFrameDirty=!1,this.onRenderRequestedDownstream=()=>{this.isFrameDirty=!0,this.context.shared.requestRender()},this._innerApplySize=()=>{let s=this.width,a=this.height,n=this.dpr;this.renderer.dpr=this.isScreenSpace?n:Math.floor(2048/Math.max(s,a)),this.renderer.setSize(s,a)},this.onFrameOverrideObjectEvent=s=>{var a,n;if(((a=s.target)==null?void 0:a.uuid)!==void 0){let o=(n=this.frameRoot)==null?void 0:n.find(s.target.uuid);o&&o.dispatchEvent({...s,target:o})}},this.scene2d=new m5(Oe.generateUUID(),af.defaultData,{dpr:window.devicePixelRatio,shared:r.shared}),this.canvas=HY(),this.renderer=WY(this.canvas),this.promise=this.init(),this.renderTarget=new Rt(1,1,{type:Ks,stencilBuffer:!1,depthBuffer:!1}),r.shared.addUIBuffer(this.uuid,this.renderTarget),this.textureHolder=r.shared.uiBuffer(this.uuid)}get canvasTexture(){return this._canvasTexture||(this._canvasTexture=new PT(this.canvas)),this._canvasTexture}async init(){this.renderer instanceof Yb&&(this.renderer.wasmURL=bb.skiaWasmUrl),await this.renderer.init()}render(e){var t,i;if(this.isFrameDirty){this.isFrameDirty=!1,this._innerApplySize(),this.renderer.clear(),(t=this.frameOverride)==null||t.draw(this.renderer),this.renderer.render(),Kb.uniforms.tDiffuse.value=this.canvasTexture,this.canvasTexture.needsUpdate=!0;let r=e.getRenderTarget();e.setRenderTarget(this.renderTarget),e.clear(),GY.render(e),e.setRenderTarget(r),(i=this.textureHolder)==null||i.setNeedsUpdate(!0)}}updateEntity2DByOp(e,t,i,r){this.scene2d.updateEntityByOp(e,t,i,r),this.applySize()}updateTreeByOp(e,t){this.scene2d.updateTreeByOp(e,t),this.applySize()}applyOverrides(e){if(this.frameOverride&&this.frameRoot){this.frameOverride.position=[0,0],this.frameOverride.rotation=0;let t=(e==null?void 0:e.width)??this.width,i=(e==null?void 0:e.height)??this.height;this.frameOverride.width=t,this.frameOverride.height=i,this.frameOverride.localMatrix=qY,this.isScreenSpace&&(this.frameOverride.fill.color=jt.from0to1([0,0,0,0])),this.frameOverride.data={...this.frameOverride.data,width:t,height:i},$b({objectOverride:this.frameOverride,objectRoot:this.frameRoot,newParentWidth:this.frameOverride.width,newParentHeight:this.frameOverride.height,initialParentWidth:this.frameRoot.width,initialParentHeight:this.frameRoot.height}),this.frameOverride.updateWorldMatrix(!0,!1,!0)}}applySize(e,t=window.devicePixelRatio){var o,l;let i=Math.max(1,(e==null?void 0:e.width)??this.width),r=Math.max(1,(e==null?void 0:e.height)??this.height);this.dpr=t,this.width=i,this.height=r,this._innerApplySize();let s=1,a=512,n=512;(i*t<a||r*t<n)&&(s=Math.max(a/(i*t),n/(r*t))),this.renderTarget.setSize(i*t*s,r*t*s),(o=this._canvasTexture)==null||o.dispose(),this._canvasTexture=void 0,this.applyOverrides(e),(l=this.frameOverride)==null||l.requestRender()}applyFrame(e){var i,r;let t=this.context.scene.find2D(e);if(!(!t||!(t instanceof ds)))return this.disposeFrameOverride(),this.frameRoot=t,this.frameOverride=t.clone({dpr:this.renderer.dpr,shared:this.context.shared}),this.scene2d.add(this.frameOverride),this.applySize(),(i=this.frame)==null||i.addEventListener("render",this.onRenderRequestedDownstream),this.frameOverride.traverse(s=>{s.addEventListener("beginState",this.onFrameOverrideObjectEvent)}),this.frameOverride.traverse(s=>{s.addEventListener("completeState",this.onFrameOverrideObjectEvent)}),(r=this.frame)==null||r.requestRender(),t}get frame(){return this.frameOverride}get frameId(){var e;return(e=this.frame)==null?void 0:e.uuid}find(e){return this.scene2d.find(e)}get texture(){var e;return(e=this.textureHolder)==null?void 0:e.getTexture(1001)}disposeFrameOverride(){var e,t,i;(e=this.frameOverride)==null||e.removeEventListener("render",this.onRenderRequestedDownstream),(t=this.frameOverride)==null||t.traverse(r=>{r.removeEventListener("beginStateChange",this.onFrameOverrideObjectEvent)}),(i=this.frameOverride)==null||i.traverse(r=>{r.removeEventListener("completeState",this.onFrameOverrideObjectEvent)}),this.frameOverride&&this.scene2d.remove(this.frameOverride)}};function $b({objectOverride:e,objectRoot:t,newParentWidth:i,newParentHeight:r,initialParentWidth:s,initialParentHeight:a}){if(e instanceof ds&&t instanceof ds||e instanceof qa&&t instanceof qa)for(let n=0,o=e.children.length;n<o;n++){let l=e.children[n],h=t.children[n];l&&h&&l.uuid===h.uuid&&XY({objectOverride:l,objectRoot:h,newParentWidth:i,newParentHeight:r,initialParentWidth:s,initialParentHeight:a})}}function YY(e){if(Ff(e))return[e.width,e.height];if(e instanceof Bd){let[t,i]=e.getHalfSize();return[t*2,i*2]}else if(e instanceof qa){let[t,i]=e.recursiveBBox.getHalfSize();return[t*2,i*2]}return[0,0]}function XY({objectOverride:e,objectRoot:t,newParentWidth:i,newParentHeight:r,initialParentWidth:s,initialParentHeight:a}){let[n,o]=YY(t),{width:l,height:h,position:c}=Zb({constraints:e.data,newParentWidth:i,newParentHeight:r,initialParentWidth:s,initialParentHeight:a,objectInitialWidth:n,objectInitialHeight:o,objectInitialPosition:t.position});if(e.position=c,e.data={...e.data,position:c},e.states)for(let d in e.states)QY({stateId:d,objectOverride:e,objectRoot:t,newParentWidth:i,newParentHeight:r,initialParentWidth:s,initialParentHeight:a});if(Ff(e)||e instanceof qa)Ff(e)&&(e.width=l,e.height=h,e.data={...e.data,width:l,height:h}),$b({objectOverride:e,objectRoot:t,newParentWidth:l,newParentHeight:h,initialParentWidth:n,initialParentHeight:o});else if(e instanceof Bd){let d=t,u=n!==0?l/n:1,p=o!==0?h/o:1;e.path=LY(d.path,u,p),e.data={...e.data,path:e.path}}}function QY({stateId:e,objectOverride:t,objectRoot:i,newParentWidth:r,newParentHeight:s,initialParentWidth:a,initialParentHeight:n}){var h,c;let o=(h=t.states)==null?void 0:h[e],l=(c=i.states)==null?void 0:c[e];if(o&&l){let{width:d,height:u,position:p}=Zb({constraints:t.data,newParentWidth:r,newParentHeight:s,initialParentWidth:a,initialParentHeight:n,objectInitialWidth:On.isResizeable(l)?l.width:0,objectInitialHeight:On.isResizeable(l)?l.height:0,objectInitialPosition:l.position});Object.assign(t.states[e],{position:p}),On.isResizeable(o)&&Object.assign(t.states[e],{width:d,height:u})}}function Ff(e){return e instanceof vh||e instanceof ds||e instanceof p5||e instanceof f5}var Gi=class extends G4(ls){constructor(e,t,i){super(),this.data=t,this.bgColor=new o1(1,1,1,1),this.fog=null,this.backupFog=new Sv(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new Je,this.penumbraSizeArrayCache=null,this.super_Entity(e,t),this.personalCamera=new v1(Tl,{...W2.defaultData,...t.camera,name:"Personal Camera"}),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new fP(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight),t.uiScene?this.uiScene=new m5((Array.isArray(e)?e[0]:e)+"-ui",t.uiScene,{dpr:window.devicePixelRatio,shared:i.shared}):t.uiFrame&&this.createUICanvas(t.uiFrame,i)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}get frameId(){return this.data.uiFrame}get frame(){var e;return(e=this.uiCanvas)==null?void 0:e.frame}createUICanvas(e,t){this.uiCanvas=new Jb(this.uuid+"-uiscreen",window.innerWidth,window.innerHeight,t),this.uiCanvas.isScreenSpace=!0,this.uiCanvas.promise.then(()=>{var i,r;(i=this.uiCanvas)==null||i.applyFrame(e),(r=this.uiCanvas)==null||r.applySize()})}updateVisible(){}setBackgroundColor(e){this.bgColor=e,this.fogUseBGColor===!0&&(this.backupFog.color=e)}entityChildrenCount(){return this.uiScene?this.uiScene.children.length:super.entityChildrenCount()}updateAmbientLight(e,t){e.color!==void 0&&(this.ambientLight.color=T1(e.color,t)),e.intensity!==void 0&&(this.ambientLight.intensity=e.intensity),e.enabled!==void 0&&(e.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(e){this.isActive=!0,e.fog=this.fog,this.traverseEntity(t=>{t instanceof Nn&&t.recomputeBoolean()}),this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity(e=>{if(e instanceof Il)if(Array.isArray(e.material))for(let t of e.material)t.needsUpdate=!0;else e.material.needsUpdate=!0,e.material.dispose()})}updateShadow(e){e.softShadowQuality!==void 0&&this.isActive&&uY(e.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(e,t){if(e.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){let i=this.scene;i.fog=this.fog}this.fogUseBGColor=e.useBackgroundColor,e.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=T1(e.color,t),this.backupFog.near=e.near,this.backupFog.far=e.far}updateAo(e,t){e.aoColor!==void 0&&(this.aoColor=T1(e.aoColor,t))}updateByOp(e,t,i,r){let s=this.data.uiFrame;super.updateByOp(e,t,i,r);let a=t;Yt(e.path,["fog"])?this.updateFog(a.fog,i.shared):Yt(e.path,["ao"])?this.updateAo(a.ao,i.shared):Yt(e.path,["ambient"])?this.updateAmbientLight(a.ambient,i.shared):Yt(e.path,["shadow"])?this.updateShadow(a.shadow):e.type===0&&e.path.length===0&&(e.props.uiFrame!==void 0||s!==a.uiFrame)&&this.updateUIFrame(e.props.uiFrame,i)}updateUIFrame(e,t){e?(this.uiCanvas||this.createUICanvas(e,t),this.uiCanvas.enabled=!0,this.uiCanvas.applyFrame(e)):this.uiCanvas&&(this.uiCanvas.enabled=!1)}updateState(e,t){this.updateState_Entity(e,t),e.backgroundColor!==void 0&&this.setBackgroundColor(T1(e.backgroundColor,t.shared)),e.fog!==void 0&&this.updateFog(e.fog,t.shared),e.ambient!==void 0&&this.updateAmbientLight(e.ambient,t.shared),e.ao!==void 0&&this.updateAo(e.ao,t.shared),e.shadow!==void 0&&this.updateShadow(e.shadow)}createFrame(e,t){}raycast(e,t){super.raycast(e,t)}switchActiveCamera(e){e&&e.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=e,e.objectHelper.visible=!1)}get playCamera(){var e;return((e=this.scene)==null?void 0:e.find(this.data.publish.playCamera))??this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return this.penumbraSizeArrayCache===null&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let e=0,t=0;this.traverseEntity(i=>{if(!i.visible)return!0;i instanceof Gb&&i.visible&&e<3&&(this.penumbraSizeArrayCache[e]=i.data.penumbraSize??.5,e+=1),i instanceof Hb&&i.visible&&e<2&&(this.penumbraSizeArrayCache[3+t]=i.data.penumbraSize??.5,t+=1)})}raycastWithClones(e){let t=[],i=r=>{for(let s of r.children){let a=s.cloner;Et.is(s)&&(s.visible||a!=null&&a.object.data.visible)&&((Mr(s)||Cf(s)&&this.scene.enableHelpers&&s.objectHelper.visible)&&(e.intersectObject(s,!1,t),kf(s,e,t,!0)),i(s))}};return i(this),t}updateEntity2DByOp(e,t,i,r){var s;(s=this.uiCanvas)==null||s.updateEntity2DByOp(e,t,i,r)}},ZY=class extends c5(yP,Nb){constructor(e,t,i){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let r=this.shadow.camera;r.fov=90,r.aspect=1,r.near=100,r.far=2500;let s=new E(-r.far+this.position.x,-r.far+this.position.y,-r.far+this.position.z),a=new E(r.far+this.position.x,r.far+this.position.y,r.far+this.position.z),n=new vi(s,a),o=new wc(n,new Je(16755200));o.visible=!1,this.gizmos.shadowmap=o,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let e in this.gizmos){let t=this.gizmos[e];if(t instanceof wc){let i=this.shadow.camera,r=new E(-i.far+this.position.x,-i.far+this.position.y,-i.far+this.position.z),s=new E(i.far+this.position.x,i.far+this.position.y,i.far+this.position.z);t.box.set(r,s),t.updateMatrixWorld(!0)}}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},KY=class extends g1{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(e,t){let i=this.geometry.getAttribute("position");i!==void 0?K4(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,e,t):super.updateEntityBoxSize(e,t)}},g5=class extends g1{constructor(e,t,i){super(e,t,i),this._shapeId=null,this._context=i}updateState(e,t){super.updateState(e,t),this.updateShape()}updateShape(){var r;let e={...this.data.geometry.extrusion.shape};for(let s in e)typeof e[s]=="string"&&(e[s]=this._context.shared.getVariable(e[s],[this.uuid,"geometry","extrusion","shape",s]));let t;if(e.type==="Custom"){let s=e.shapeId;if(s!==this._shapeId&&this.detachShape(),s){this._shapeId=s;let a=this._context.scene.find(s);a!=null&&a.data&&(a.attachedPaths.add(this),t=(r=a.geometry.userData)==null?void 0:r.shape),t||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let s;switch(e.type){case"Rectangle":s=Z4;break;case"Ellipse":s=Q4;break;case"Polygon":s=zx;break;case"Star":s=Fx;break;default:throw new Error(`Unknown shape type: ${e.type}`)}t=s.create({parameters:e}).userData.shape}let i=this.geometry;t&&i.inputs&&(i.inputs.shapeData=t,i.build(),this.attachedSurfaceCloners.forEach(s=>s.update()))}detachShape(){var e;this._shapeId!==null&&((e=this._context.scene.find(this._shapeId))==null||e.attachedPaths.delete(this))}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.updateShape(),this.refreshAttachedPaths(e)}updateTransformState(e,t){return super.updateTransformState(e,t)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.updateShape()}updateEntityBoxSize(e,t){let i=this.geometry.getAttribute("position");i!==void 0?K4(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,e,t):super.updateEntityBoxSize(e,t)}},v5=class extends h5{constructor(e,t,i){super(e,t,i),this.data=t}},$o=class extends Ol(qs,mh){constructor(e,t,i){super(),t.type==="Instance"&&typeof e=="string"&&(t=this.transformAssignData(t,i)),this.super_Entity(e,t),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(e,t){let i=qc.getComponentData({scene:t.scene.data,shared:t.shared.data},e.component);if(i){let r,s;for(let a of Oa.rootOverrideProps)e[a]===void 0?(r===void 0&&(r={...e}),r[a]=i.data[a]):(s===void 0&&(s={}),s[a]=e[a],r===void 0&&(r={...e}),r[a]=ka.apply(i.data[a],e[a]));return this.overrideData=s,r}else return{...Xi.defaultData,...e,...hs(Xi.defaultData,Oa.rootOverrideProps)}}updateByOp(e,t,i,r){let s;if(this.isInstanceRoot&&!r){if(t=this.transformAssignData(t,i),e.type===0&&e.path.length===0&&this.component)for(let a of Oa.rootOverrideProps)a in e.props&&e.props[a]===void 0&&(s===void 0&&(s={...e,props:{...e.props}}),s.props[a]=this.component.data[a]);else if(e.type===0&&e.path.length>0&&Oa.rootOverrideProps.includes(e.path[0])){let a=e.path[0];s===void 0&&(s={...e,path:[],props:{[a]:t[a]}})}}super.updateByOp(s??e,t,i,r)}updateState(e,t){this.updateState_Entity(e,t)}expandInstanceChildren(e){let t=this.data;if(this.component===void 0){let i=e.scene.find(t.component)??null,r=!1;if(i!==this.oldComponent){if(this.oldComponent){let s=0;for(let a of this.children)if(Et.is(a))e.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(a),y5(a),s+=1;else break;this.children.splice(0,s)}r=!0}if(i){let s={};ew(e,[this.uuid],t.overrides,this,i,i,0,r,s);for(let a of this.children)if(Et.is(a)){let n=a.data;n.type==="Empty"&&n.animations&&a.traverseEntity(o=>{let l=o.dataPatched;if(o instanceof g1&&l.bones&&l.boneInverses){let h=o.dataPatched;if(h.bones&&h.boneInverses){let c=h.bones.map(p=>e.scene.find(s[p])),d=h.boneInverses.map(p=>new we().fromArray(p)),u=new a4(c,d);o.bind(u,o.bindMatrix)}}else o.matrixAutoUpdate=!0})}}this.oldComponent=this.component}}};function y5(e){if(e.component){let t=e.component.instances.indexOf(e);t>=0&&e.component.instances.splice(t,1);for(let i of e.children)Et.is(i)&&y5(i)}}function W8(e,t,i,r){return e.component===t&&D4(e.identity,r)?e.overrideData===i?2:1:0}function ew(e,t,i,r,s,a,n,o,l){if(n>50)return!1;if(r.component!==s){if(r.component){let c=r.component.instances.indexOf(r);c>=0&&r.component.instances.splice(c,1)}s.instances.find(c=>c===r)||s.instances.push(r),r.component=s}s instanceof $o&&s.isInstanceRoot&&s.expandInstanceChildren(e);let h=0;for(let c of s.children)if(Et.is(c)){let d=[...t,...typeof c.identity=="string"?[c.identity]:c.identity],u=jc.resolve(i,d,1);u!=null&&!(u instanceof Ei)&&Object.setPrototypeOf(u,Ei.prototype);let p=null,f;if(!o){let g=r.children[h];if(p=Et.is(g)?g:null,p!==null){let m=W8(p,c,u,d);f=m>=1?p.stateSelection:void 0,m!==2&&(p=null)}if(p===null&&(p=e.scene.findInstance(d)??null,p!==null)){let m=W8(p,c,u,d);if(f=m>=1?p.stateSelection:void 0,m!==2)p=null;else{let v=p.parent.children.indexOf(p);p.parent.children.splice(v,1),r.children.splice(h,0,p),p.parent===r?v<=h:(p.parent=r,p.matrixWorldNeedsUpdate=!0,p.resetBBoxNeedsUpdate(),p.updateVisible(),e.pendingDeletes.delete(p))}}}if(p===null){let g=u?ka.apply(c.data,u):c.data;kn.is(g.type)&&(g={...g,type:"Empty"}),p=La.createEntity(d,g,e),p.overrideData=u,r.add(p),r.children.splice(r.children.length-1,1),r.children.splice(h,0,p),p.updateState(p.data,e),f&&p.changeSelectedState(f,e),e.scene.registerInstanceAndSetUuid(p)}if(p.isBone){let g=p.identity[p.identity.length-1];l[g]=p.uuid}h+=1,ew(e,t,i,p,c,a,n+1,o,l)}if(!o){let c=h;for(;;){let d=r.children[h];if(Et.is(d))e.pendingDeletes.add(d);else break;h+=1}r.children.splice(c,h-c)}return!0}var JY=class extends Ol(_v,mh){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(e,t){this.updateState_Entity(e,t)}},p1=class extends g1{constructor(e,t,i){super(e,t,i),this.onBeforeRender=r=>{this.uiCanvas.render(r)},this.uiCanvas=new Jb(e+"-canvas",t.geometry.width,t.geometry.height,i),this.uiCanvas.promise.then(()=>{this.applyFrame(this.dataPatched.geometry.frame,i.shared)})}updateByPatchedOpGeometry(e,t,i){super.updateByPatchedOpGeometry(e,t,i),e.type===0&&(e.props.frame!==void 0&&this.applyFrame(e.props.frame,i.shared),(e.props.width!==void 0||e.props.height!==void 0)&&this.applySize(e.props,i.shared))}applySize(e,t){let i=(e==null?void 0:e.width)??this.dataPatched.geometry.width,r=(e==null?void 0:e.height)??this.dataPatched.geometry.height;this.uiCanvas.applySize({width:i,height:r}),this.applyGeometryParametersFromFrame(t)}applyFrame(e,t){this.uiCanvas.applyFrame(e),this.applyGeometryParametersFromFrame(t),this.applyMaterialParametersFromFrame({shared:t})}applyGeometryParametersFromFrame(e){var i;let t=this.frame;t&&(Object.assign(this.data,{geometry:Object.assign(this.data.geometry,{cornerRadius:t.cornerRadius,cornerType:0})}),Object.assign(this.dataPatched,{geometry:Object.assign(this.dataPatched.geometry,{cornerRadius:t.cornerRadius,cornerType:0})}),(i=this.localGeometry)==null||i.dispose(),this.localGeometry=$2(this.dataPatched.geometry,e,this.data.flatShading,this))}applyMaterialParametersFromFrame(e){let t=this.frame;if(t){let i=t.data.backgroundBlur;Object.assign(this.data.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.data.material.layers[1].data,{roughness:i.radius,alpha:i.enabled?1:0}),Object.assign(this.dataPatched.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.dataPatched.material.layers[1].data,{roughness:i.radius,alpha:i.enabled?1:0}),this.material.reset(this.dataPatched.material,e,!0)}}updateEntity2DByOp(e,t,i,r){this.uiCanvas.updateEntity2DByOp(e,t,i,r),e===this.frameId&&t.type===0&&(t.props.cornerRadius!==void 0?this.applyGeometryParametersFromFrame(r):Yt(t.path,["backgroundBlur"])&&this.applyMaterialParametersFromFrame({shared:r}))}get frame(){return this.uiCanvas.frame}get frameId(){var e;return(e=this.frame)==null?void 0:e.uuid}removeInteractionGeometry(e){super.removeInteractionGeometry(e),this.applySize({},e)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.applySize({width:e.width,height:e.height},t)}},$Y=class{constructor(e,t,i){this.variables=[],this.currentTextureIndex=0;let r=_i,s=new ls,a=new Vn;a.position.z=1;let n={passThruTexture:{value:null}},o=c(u(),n),l=new si(new $s(2,2),o);s.add(l),this.setDataType=function(p){return r=p,this},this.addVariable=function(p,f,g){let m=this.createShaderMaterial(f),v={name:p,initialValueTexture:g,material:m,dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:Bt,magFilter:Bt};return this.variables.push(v),v},this.setVariableDependencies=function(p,f){p.dependencies=f},this.init=function(){if(i.capabilities.isWebGL2===!1&&i.extensions.has("OES_texture_float")===!1)return"No OES_texture_float support for float textures.";if(i.capabilities.maxVertexTextures===0)return"No support for vertex shader textures.";for(let p=0;p<this.variables.length;p++){let f=this.variables[p];f.renderTargets[0]=this.createRenderTarget(e,t,f.wrapS,f.wrapT,f.minFilter,f.magFilter),f.renderTargets[1]=this.createRenderTarget(e,t,f.wrapS,f.wrapT,f.minFilter,f.magFilter),this.renderTexture(f.initialValueTexture,f.renderTargets[0]),this.renderTexture(f.initialValueTexture,f.renderTargets[1]);let g=f.material,m=g.uniforms;if(f.dependencies!==null)for(let v=0;v<f.dependencies.length;v++){let y=f.dependencies[v];if(y.name!==f.name){let x=!1;for(let w=0;w<this.variables.length;w++)if(y.name===this.variables[w].name){x=!0;break}if(!x)return"Variable dependency not found. Variable="+f.name+", dependency="+y.name}m[y.name]={value:null},g.fragmentShader=`
uniform sampler2D `+y.name+`;
`+g.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){let p=this.currentTextureIndex,f=this.currentTextureIndex===0?1:0;for(let g=0,m=this.variables.length;g<m;g++){let v=this.variables[g];if(v.dependencies!==null){let y=v.material.uniforms;for(let x=0,w=v.dependencies.length;x<w;x++){let _=v.dependencies[x];y[_.name].value=_.renderTargets[p].texture}}this.doRenderTarget(v.material,v.renderTargets[f])}this.currentTextureIndex=f},this.getCurrentRenderTarget=function(p){return p.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(p){return p.renderTargets[this.currentTextureIndex===0?1:0]},this.dispose=function(){l.geometry.dispose(),l.material.dispose();let p=this.variables;for(let f=0;f<p.length;f++){let g=p[f];g.initialValueTexture&&g.initialValueTexture.dispose();let m=g.renderTargets;for(let v=0;v<m.length;v++)m[v].dispose()}};function h(p){p.defines.resolution="vec2( "+e.toFixed(1)+", "+t.toFixed(1)+" )"}this.addResolutionDefine=h;function c(p,f){f=f||{};let g=new It({uniforms:f,vertexShader:d(),fragmentShader:p});return h(g),g}this.createShaderMaterial=c,this.createRenderTarget=function(p,f,g,m,v,y){return p=p||e,f=f||t,g=g||ei,m=m||ei,v=v||Bt,y=y||Bt,new Rt(p,f,{wrapS:g,wrapT:m,minFilter:v,magFilter:y,format:Wi,type:r,depthBuffer:!1})},this.createTexture=function(){let p=new Float32Array(e*t*4),f=new or(p,e,t,Wi,_i);return f.needsUpdate=!0,f},this.renderTexture=function(p,f){n.passThruTexture.value=p,this.doRenderTarget(o,f),n.passThruTexture.value=null},this.doRenderTarget=function(p,f){let g=i.getRenderTarget(),m=i.xr.enabled,v=i.shadowMap.autoUpdate,y=i.outputEncoding,x=i.toneMapping;i.xr.enabled=!1,i.shadowMap.autoUpdate=!1,i.outputEncoding=Rr,i.toneMapping=os,l.material=p,i.setRenderTarget(f),i.render(s,a),l.material=o,i.xr.enabled=m,i.shadowMap.autoUpdate=v,i.outputEncoding=y,i.toneMapping=x,i.setRenderTarget(g)};function d(){return`void main()	{

	gl_Position = vec4( position, 1.0 );

}
`}function u(){return`uniform sampler2D passThruTexture;

void main() {

	vec2 uv = gl_FragCoord.xy / resolution.xy;

	gl_FragColor = texture2D( passThruTexture, uv );

}
`}}},Ji=new r1,z0=new E,eX=class{constructor(e){let t=e.geometry;if(!t.isBufferGeometry||t.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.colorAttribute=this.geometry.getAttribute("color"),this.weightAttribute=null,this.distribution=null}setWeightAttribute(e){return this.weightAttribute=e?this.geometry.getAttribute(e):null,this}build(){let e=this.positionAttribute,t=this.weightAttribute,i=new Float32Array(e.count/3);for(let s=0;s<e.count;s+=3){let a=1;t&&(a=t.getX(s)+t.getX(s+1)+t.getX(s+2)),Ji.a.fromBufferAttribute(e,s),Ji.b.fromBufferAttribute(e,s+1),Ji.c.fromBufferAttribute(e,s+2),a*=Ji.getArea(),i[s/3]=a}this.distribution=new Float32Array(e.count/3);let r=0;for(let s=0;s<i.length;s++)r+=i[s],this.distribution[s]=r;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t,i){let r=this.distribution[this.distribution.length-1],s=this.binarySearch(this.randomFunction()*r);return this.sampleFace(s,e,t,i)}binarySearch(e){let t=this.distribution,i=0,r=t.length-1,s=-1;for(;i<=r;){let a=Math.ceil((i+r)/2);if(a===0||t[a-1]<=e&&t[a]>e){s=a;break}else e<t[a]?r=a-1:i=a+1}return s}sampleFace(e,t,i,r){let s=this.randomFunction(),a=this.randomFunction();return s+a>1&&(s=1-s,a=1-a),Ji.a.fromBufferAttribute(this.positionAttribute,e*3),Ji.b.fromBufferAttribute(this.positionAttribute,e*3+1),Ji.c.fromBufferAttribute(this.positionAttribute,e*3+2),t.set(0,0,0).addScaledVector(Ji.a,s).addScaledVector(Ji.b,a).addScaledVector(Ji.c,1-(s+a)),i!==void 0&&Ji.getNormal(i),r!==void 0&&this.colorAttribute!==void 0&&(Ji.a.fromBufferAttribute(this.colorAttribute,e*3),Ji.b.fromBufferAttribute(this.colorAttribute,e*3+1),Ji.c.fromBufferAttribute(this.colorAttribute,e*3+2),z0.set(0,0,0).addScaledVector(Ji.a,s).addScaledVector(Ji.b,a).addScaledVector(Ji.c,1-(s+a)),r.r=z0.x,r.g=z0.y,r.b=z0.z),this}};function tX(e){let t=new Float32Array(e*e*2);for(let i=0;i<e;i++)for(let r=0;r<e;r++){let s=i*e+r;t[s*2+0]=i/(e-1),t[s*2+1]=r/(e-1)}return t}function iX(e){let t=Math.ceil(Math.sqrt(e));return Math.max(t,1)}function rX(e,t){let i=new si(e.geometry,e.material),r=[],s=[],a=new E,n=new E;i.geometry.index!==null&&(i.geometry=i.geometry.toNonIndexed());let o=new eX(i).build();for(let c=0;c<t;c++)o.sample(a,n),r.push(a.x,a.y,a.z),s.push(n.x,n.y,n.z);let l=new Float32Array(r),h=new Float32Array(s);return{positions:l,normals:h}}function q8(e,t){let i=e,r=new Float32Array(4*t*t);for(let a=0;a<t*t;a++)r[4*a]=i[3*a],r[4*a+1]=i[3*a+1],r[4*a+2]=i[3*a+2],r[4*a+3]=0;let s=new or(r,t,t,Wi,_i);return s.needsUpdate=!0,s}function sX({size:e}){let t=new Float32Array(4*e*e);for(let r=0;r<e*e;r++)t[4*r]=r,t[4*r+1]=0,t[4*r+2]=0,t[4*r+3]=0;let i=new or(t,e,e,Wi,_i);return i.needsUpdate=!0,i}function aX(e){let t=new Float32Array(4*e*e);for(let r=0;r<e*e;r++)t[4*r]=0,t[4*r+1]=0,t[4*r+2]=0,t[4*r+3]=0;let i=new or(t,e,e,Wi,_i);return i.needsUpdate=!0,i}var nX=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU
uniform sampler2D uOriginalPosition;
uniform float uTime;
uniform float uSpeed;     // update speed of the particles
uniform vec3 uWorldOffset;    
uniform vec4 uWorldQuaternion;
uniform float uMaxLifeTime;
uniform vec3 uEmitterSize;
uniform float uFPSRatio;     // 1  for 60 FPS

float random (vec2 st) {
    return fract(sin(dot(st.xy,
        vec2(12.9898,78.233)))*
        43758.5453123);
}
vec3 applyQuaternionToVector( vec4 q, vec3 v ){
    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
}

vec3 applyForce(vec3 force, float mass) {
    vec3 acceleration = force / mass;
    
    return acceleration;
  }
  

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;
    float currentLife = texture2D( uCurrentPosition, vUv ).w;   // from 1 to 0
    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).r;        // 1. = spawning, 0. = not spawning
    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;          // 1. = active, 0. = not active
    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;         // timeStart in seconds when the particle was emitted
    vec3 originalPosition = ((texture2D( uOriginalPosition, vUv ).xyz) * uEmitterSize);
    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;
    float collisionFlag = texture2D( uCurrentVelocity, vUv ).w;             // 1. = collided, 0. = not collided
    float lifeTime = uMaxLifeTime;

    // Calculate the position adjustment based on collision
    //     if (collisionFlag > .5) {  
    float isColliding = step(0.5, collisionFlag); // 1.0 if collisionFlag > 0.5, otherwise 0.0
    float bounceOffset = 3.0 * isColliding; // Becomes 3.0 if colliding, 0.0 otherwise
    vec3 collisionAdjustedVelocity = velocity * (1.0 + bounceOffset);

    // Update position based on collision or normal movement
    vec3 fpsVelocity = velocity * min(uFPSRatio, 5.0);
    position += mix(fpsVelocity, collisionAdjustedVelocity, isColliding);

    // EMISSION RATE - BIRTH
    // if (isSpawning == 1.0) {
    // Better Approach to avoid If statement
    vec3 newPosition = applyQuaternionToVector(uWorldQuaternion, originalPosition) + uWorldOffset;
    originalPosition = mix(originalPosition, newPosition, isSpawning);
    position = mix(position, originalPosition, isSpawning);;
    timeStart = mix(timeStart, uTime, isSpawning);

    // Calculate timeLeft for life normalization
    float timeLeft = max(lifeTime - (uTime - timeStart), 0.0);
    float life_Normalize = timeLeft / lifeTime;

    // Use isActive to blend between the calculated color and black
    vec4 activeColor = vec4(position, life_Normalize);
    // if (isActive == 1.0) {
    gl_FragColor = mix(vec4(0.0), activeColor, isActive);

}
`,oX=`

    vec3 mod289(vec3 x) {
      return x - floor(x * (1.0 / 289.0)) * 289.0;
    }
    
    vec4 mod289(vec4 x) {
    return x - floor(x * (1.0 / 289.0)) * 289.0;
    }
    
    vec4 permute(vec4 x) {
        return mod289(((x*34.0)+1.0)*x);
    }
    
    vec4 taylorInvSqrt(vec4 r)
    {
    return 1.79284291400159 - 0.85373472095314 * r;
    }
    
    vec3 fade(vec3 t) {
  return t*t*t*(t*(t*6.0-15.0)+10.0);
}

    float snoise(vec3 v)
    {
    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
    vec3 i  = floor(v + dot(v, C.yyy) );
    vec3 x0 =   v - i + dot(i, C.xxx) ;
    vec3 g = step(x0.yzx, x0.xyz);
    vec3 l = 1.0 - g;
    vec3 i1 = min( g.xyz, l.zxy );
    vec3 i2 = max( g.xyz, l.zxy );
    vec3 x1 = x0 - i1 + C.xxx;
    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y
    vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y
    
    // Permutations
    i = mod289(i);
    vec4 p = permute( permute( permute(
                i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
              + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))
              + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
    
    // Gradients: 7x7 points over a square, mapped onto an octahedron.
    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)
    float n_ = 0.142857142857; // 1.0/7.0
    vec3  ns = n_ * D.wyz - D.xzx;
    
    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)
    
    vec4 x_ = floor(j * ns.z);
    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
    
    vec4 x = x_ *ns.x + ns.yyyy;
    vec4 y = y_ *ns.x + ns.yyyy;
    vec4 h = 1.0 - abs(x) - abs(y);
    
    vec4 b0 = vec4( x.xy, y.xy );
    vec4 b1 = vec4( x.zw, y.zw );
    
    vec4 s0 = floor(b0)*2.0 + 1.0;
    vec4 s1 = floor(b1)*2.0 + 1.0;
    vec4 sh = -step(h, vec4(0.0));
    
    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
    
    vec3 p0 = vec3(a0.xy,h.x);
    vec3 p1 = vec3(a0.zw,h.y);
    vec3 p2 = vec3(a1.xy,h.z);
    vec3 p3 = vec3(a1.zw,h.w);
    
    //Normalise gradients
    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
    p0 *= norm.x;
    p1 *= norm.y;
    p2 *= norm.z;
    p3 *= norm.w;
    
    // Mix final noise value
    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
    m = m * m;
    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),
                                  dot(p2,x2), dot(p3,x3) ) );
    }
    
    vec3 snoiseVec3( vec3 x ){
    
      float s  = snoise(vec3( x ));
      float s1 = snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));
      float s2 = snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));
      vec3 c = vec3( s , s1 , s2 );
      return c;
    
    }
    
      
    vec3 curlNoise( vec3 p, float seed){
      p += seed;
      const float e = .1;
      vec3 dx = vec3( e   , 0.0 , 0.0 );
      vec3 dy = vec3( 0.0 , e   , 0.0 );
      vec3 dz = vec3( 0.0 , 0.0 , e   );
    
      vec3 p_x0 = snoiseVec3( p - dx );
      vec3 p_x1 = snoiseVec3( p + dx );
      vec3 p_y0 = snoiseVec3( p - dy );
      vec3 p_y1 = snoiseVec3( p + dy );
      vec3 p_z0 = snoiseVec3( p - dz );
      vec3 p_z1 = snoiseVec3( p + dz );
    
      float x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;
      float y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;
      float z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;
    
      const float divisor = 1.0 / ( 2.0 * e );
      return normalize( vec3( x , y , z ) * divisor );
    
    }


// Classic Perlin noise
float cnoise(vec3 P)
{
  vec3 Pi0 = floor(P); // Integer part for indexing
  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1
  Pi0 = mod289(Pi0);
  Pi1 = mod289(Pi1);
  vec3 Pf0 = fract(P); // Fractional part for interpolation
  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
  vec4 iy = vec4(Pi0.yy, Pi1.yy);
  vec4 iz0 = Pi0.zzzz;
  vec4 iz1 = Pi1.zzzz;

  vec4 ixy = permute(permute(ix) + iy);
  vec4 ixy0 = permute(ixy + iz0);
  vec4 ixy1 = permute(ixy + iz1);

  vec4 gx0 = ixy0 * (1.0 / 7.0);
  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
  gx0 = fract(gx0);
  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
  vec4 sz0 = step(gz0, vec4(0.0));
  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
  gy0 -= sz0 * (step(0.0, gy0) - 0.5);

  vec4 gx1 = ixy1 * (1.0 / 7.0);
  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
  gx1 = fract(gx1);
  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
  vec4 sz1 = step(gz1, vec4(0.0));
  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
  gy1 -= sz1 * (step(0.0, gy1) - 0.5);

  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);

  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
  g000 *= norm0.x;
  g010 *= norm0.y;
  g100 *= norm0.z;
  g110 *= norm0.w;
  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
  g001 *= norm1.x;
  g011 *= norm1.y;
  g101 *= norm1.z;
  g111 *= norm1.w;

  float n000 = dot(g000, Pf0);
  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
  float n111 = dot(g111, Pf1);

  vec3 fade_xyz = fade(Pf0);
  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
  return 2.2 * n_xyz;
}


vec3 fbm_vec3(vec3 p, float frequency, float offset)
{
  return vec3(
    cnoise((p+vec3(offset))*frequency),
    cnoise((p+vec3(offset+20.0))*frequency),
    cnoise((p+vec3(offset-30.0))*frequency)
  );
}

`,lX=`
  #ifdef USE_COLLIDER
    float restitution = max(uBounce * 2., .01); // Energy Loss
    // SPHERE COLLIDER
    // **************************************************************
    #ifdef USE_SPHERE_COLLIDER       
      // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)
      vec3 radii = uColliderSize;
      // Adjust position relative to collider
      vec3 relPos = position - uColliderPos;
      // Apply rotation of the collider to the relative position
      relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
      // Scale relative position by radii (for ellipsoid collision detection)
      vec3 scaledPos = relPos / radii;
      // Calculate ellipsoidal distance
      float dist = length(scaledPos); // Distance in terms of ellipsoid
      
      // Check for collision
      if (dist <= 1. + particleSize / length(radii) && collisionFlag == 0.0) {
          // Compute the normal at the collision point, accounting for particle size
        vec3 adjustedPos = scaledPos * (1.0 + particleSize / length(radii));          
        // Compute the normal at the collision point
        vec3 normal = ellipsoidNormal(adjustedPos, radii);
        // Rotate the normal back to world space
        normal = applyQuaternionToVector(uColliderQuaternion, normal);
        // Reflect the velocity vector off the normal
        velocity = reflect(velocity, normal) * restitution;

        collisionFlag = 1.0;
      } else {
        collisionFlag = 0.0;
      }
    #endif

    // BOX COLLIDER or PLANE COLLIDER 
    // **************************************************************
    #ifdef USE_BOX_COLLIDER
      // Box dimensions and repulsion variables
      vec3 boxHalfSize = uColliderSize / 2.0;
      // Convert world position to box's local space
      vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
      // Collision detection
      vec3 localDistance = abs(localPos) - boxHalfSize;
      float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));    

      // Collision Detected
      if (distToSurface <= particleSize * 0.5 && collisionFlag == 0.0) {      
        // Find the nearest face normal for bounce direction
        vec3 normal;
        if (localDistance.x > localDistance.y && localDistance.x > localDistance.z) {
            normal = vec3(sign(localPos.x), 0.0, 0.0);
        } else if (localDistance.y > localDistance.z) {
            normal = vec3(0.0, sign(localPos.y), 0.0);
        } else {
            normal = vec3(0.0, 0.0, sign(localPos.z));
        }            
        // Rotate normal back to world space
        normal = applyQuaternionToVector(uColliderQuaternion, normal);      
        // Reflect velocity and apply repulsion force
        velocity = reflect(velocity, normal) * restitution;
        
        collisionFlag = 1.0;
      } else {
        collisionFlag = 0.0;
      }
    #endif      
  #endif      
  // END COLLIDER    
`,hX=`
  #ifdef USE_ATTRACTOR

      #ifdef USE_SPHERE_COLLIDER      
        // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)
        vec3 radii = uColliderSize;
        // Adjust position relative to collider
        vec3 relPos = position - uColliderPos;
        // Apply rotation of the collider to the relative position
        relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
        // Scale relative position by radii (for ellipsoid collision detection)
        vec3 scaledPos = relPos / radii;
        // Calculate ellipsoidal distance
        float distToSurface = length(scaledPos); // Distance in terms of ellipsoid
        float insideCheck = 1.0;

      #endif


      #ifdef USE_BOX_COLLIDER
        // Box dimensions
        vec3 boxHalfSize = uColliderSize / 2.0;
        // Convert world position to box's local space
        vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
        vec3 localDistance = abs(localPos) - boxHalfSize;
        float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));
        float insideCheck = particleSize;
      #endif      
  
      // Apply vortex force inside the Helper
      #ifdef USE_FORCE_LOCAL_SPACE
        if (distToSurface <= insideCheck ) {    
            // Define parameters for the attractor field
            #ifdef USE_SPHERE_COLLIDER      
              float attractorStrength = (1.0 - distToSurface ) * uForceIntensity; // Adjust as needed
            #endif

            #ifdef USE_BOX_COLLIDER
              float attractorStrength = max((1.0 - insideCheck / distToSurface), 0.) * uForceIntensity; // Adjust as needed
              #endif

            float attractorDamping = uForceDamping;  // Adjust as needed (higher values will attenuate velocity more)
          
            // Use the same radii calculation code as for the collider
            vec3 attractorRadii = uColliderSize;
            // Adjust position relative to attractor center
            vec3 relPos = position - uColliderPos;
            // Apply rotation of the collider to the relative position
            relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
            // Scale relative position by radii (for ellipsoid attraction)
            vec3 scaledPos = relPos / attractorRadii;

            // Calculate ellipsoidal distance as attractor radius
            float attractorRadius = length(scaledPos);
            // Calculate the distance from the attractor center
            vec3 relativePosition = position - uColliderPos;
            // Calculate the force vector towards the attractor center
            vec3 attractorForce = normalize(relativePosition) * attractorStrength;
            // Apply the attractor force to the particle
            velocity -= attractorForce;
            // Attenuate the particle's velocity
            velocity *= attractorDamping;
        }
      #else 
            // Calculate the distance from the attractor center
            vec3 relativePosition = position - uColliderPos;
            // Calculate the force vector towards the attractor center
            vec3 attractorForce = normalize(relativePosition) * uForceIntensity;
            // Apply the attractor force to the particle
            velocity -= attractorForce;
            // Attenuate the particle's velocity
            velocity *= uForceDamping;
      #endif    
  #endif      
`,cX=`
  #ifdef USE_VORTEX
    // Box dimensions
    vec3 boxHalfSize = uColliderSize / 2.0;
    // Convert world position to box's local space
    vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
    vec3 localDistance = abs(localPos) - boxHalfSize;
    float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));

    // Apply vortex force inside the box
    if (distToSurface <= particleSize) {
      float vortexStrength = uForceIntensity;
      vec3 localTopCenter = vec3(0.0, 0., 0.0);

      // Transform the local top center to the world space
      vec3 vortexCenter = uColliderPos + applyQuaternionToVector(uColliderQuaternion, localTopCenter);
      // Calculate the vector from particle to vortex center
      vec3 vortexVector = vortexCenter - position;

      // Calculate the rotation axis from the inverse of the collider's quaternion and the fixed up vector
      // Note: important to add a tiny z component to the up vector to avoid instability
      vec3 upVector = vec3(0.0, 1.0, 0.01);
      vec3 rotationAxis = cross(upVector, applyQuaternionToVector(uColliderQuaternion, vortexVector));
      rotationAxis = normalize(rotationAxis);

      // Add rotational component to velocity
      float rotationSpeed = length(vortexVector * vortexStrength * 3.0) ; 

      vec3 rotationVelocity = rotationAxis * rotationSpeed;
      // velocity += rotationVelocity * 0.005 ;
      velocity = rotationVelocity * 0.005 ;

      // Calculate vortex force
      // vec3 vortexForce = normalize(vortexVector) * uSpeed * .1 ;
      // Apply the vortex force to the particle
      vec3 originDirection = applyQuaternionToVector(uWorldQuaternion, directions);
      velocity += applyForce( originDirection * uSpeed * (1. - uForceDamping) , mass * .5);
    }
  #endif      
`,dX=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU
uniform sampler2D uOriginalPosition;
uniform sampler2D uDirections;     
uniform vec3 uDirectionsAxis;
uniform vec4 uWorldQuaternion;
uniform vec3 uGravity;        
uniform float uNoiseStrength;     // Variation of the noise
uniform float uNoiseScale;        // Scale of the noise
uniform float uNoiseSeed;         // Seed of the noise
uniform float particleSize;
uniform float uSpeed;     // update speed of the particles
uniform float uRandomMassFactor;

// COLLIDER
uniform vec3 uColliderPos;                // Collider Position
uniform vec3 uColliderSize;               // Collider Dimension
uniform vec4 uColliderQuaternion;         // Collider Rotation
uniform vec4 uColliderQuaternionInvert;   // Collider Rotation
uniform float uBounce;                    // Bounce factor
uniform float uForceDamping;
uniform float uForceIntensity;


`+oX+`
float rand(vec2 co){
    return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);
}
vec3 applyQuaternionToVector( vec4 q, vec3 v ){
    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
 } 
vec3 applyForce(vec3 force, float mass) {
  vec3 acceleration = force / mass;
  
  return acceleration;
}

vec4 conjugate(vec4 q) {
  return vec4(q.w, -q.x, -q.y, -q.z);
}

// Function to compute the normal of the ellipsoid at a given point
vec3 ellipsoidNormal(vec3 p, vec3 radii) {
  return normalize(p / (radii * radii));
}

float friction = .3;

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;
    vec3 originalPosition = texture2D( uOriginalPosition, vUv ).xyz;
    float timeLeft = texture2D( uCurrentPosition, vUv ).w;
    vec3 directions = texture2D( uDirections, vUv ).xyz;    
    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;
    float mass = rand(originalPosition.xy) * 0.5 + 0.5;
    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).x;        // 1. = spawning, 0. = not spawning
    float isActive = texture2D( uCurrentEmissionRate, vUv ).y;          // 1. = active, 0. = not active
    float collisionFlag =texture2D( uCurrentVelocity, vUv ).w;          // Indicate collision

    // Randomness Mass
    mass = (1.0 - (uRandomMassFactor * mass));
    
    if (isActive == 1.0) {
      // **************************************************************
      // FORCES NOISES
      // **************************************************************
      #ifdef USE_CURL_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = curlNoise(position * uNoiseScale * .002, uNoiseSeed) * ( uNoiseStrength + 1.0) * .05 * uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {
          velocity += curlNoise( position, uNoiseSeed)  * uNoiseStrength * 0.05 * uSpeed;
        }
      #endif
      // **************************************************************
      #ifdef USE_SIMPLEX_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = vec3(snoise(position * uNoiseScale * .001) * ( uNoiseStrength + 1.0) * .1);
          velocity *= uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0) {
          velocity += vec3(snoise(position * uNoiseStrength * .001) * .05 * uSpeed);
        }
      #endif
      // ************************************************************** 
      #ifdef USE_FBM_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = fbm_vec3(position * uNoiseScale * .001, ( uNoiseStrength + 1.0), uNoiseSeed);
          velocity *= uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {      
          velocity += fbm_vec3(position * uNoiseStrength * .001, ( uNoiseStrength + 1.0), uNoiseSeed) * .1 * uSpeed;
        }
      #endif

      // COLLIDER
      ${lX}
      // ATTRACTION
      ${hX}  
      // VORTEX
      ${cX}
    } 
    // End isActive

    // SPAWN BIRTH 
    // **************************************************************
    // if (isSpawning == 1.)
    #ifdef USE_NORMALS
      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, directions) * uSpeed, isSpawning);
    #else
      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, uDirectionsAxis) * uSpeed, isSpawning);    
    #endif
    
    // if (collisionFlag == 0.0)
    velocity += applyForce(uGravity, mass * .5) * (1.0 - collisionFlag);

    gl_FragColor = vec4(velocity, collisionFlag);
}
`,tw=`

  // Linear Fade In
  float linearFadeIn(float t) {
    return t;
  }


  // linear fade out
  float linearFadeOut(float t) {
    return 1.0 - t;
  }
  
  float linearInOut(float t) {
    return t < 0.5 ? t :  (1.0 - t);  
  }

    // lerp
    float lerp(float a, float b, float t) {
      return a + (b - a) * t;
    }

  // Ease In Out Quart
  float exponentialInOut(float t) {
    return t < 0.4 ? lerp(0.0, 1.0, t / 0.4) :
    t > 0.6 ? lerp(1.0, 0.0, (t - 0.6) / 0.4) :
    1.0;
   }

  // constant
  float constant(float t) {
    return 1.0;
  } 
`,uX=`

float rand(vec3 co){
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

vec3 applyQuaternionToVector( vec4 q, vec3 v ){
  return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
}

vec3 applyForce(vec3 force, float mass) {
  vec3 acceleration = force / mass;
    
  return acceleration;
}
`,pX=`
vec3 rgb2xyz (in vec3 rgb) {
    float r = rgb.r;
	float g = rgb.g;
	float b = rgb.b;

	r = r > 0.04045 ? pow(((r + 0.055) / 1.055), 2.4) : (r / 12.92);
	g = g > 0.04045 ? pow(((g + 0.055) / 1.055), 2.4) : (g / 12.92);
	b = b > 0.04045 ? pow(((b + 0.055) / 1.055), 2.4) : (b / 12.92);

	float x = (r * 0.4124) + (g * 0.3576) + (b * 0.1805);
	float y = (r * 0.2126) + (g * 0.7152) + (b * 0.0722);
	float z = (r * 0.0193) + (g * 0.1192) + (b * 0.9505);
    
    vec3 xyz = vec3(
        (r * 0.4124) + (g * 0.3576) + (b * 0.1805) * 100.0,
        (r * 0.2126) + (g * 0.7152) + (b * 0.0722) * 100.0,
        (r * 0.0193) + (g * 0.1192) + (b * 0.9505) * 100.0
    );
    return(xyz);
}

vec3 xyz2lab (in vec3 xyz) {
	float x = xyz.x / 95.047;
	float y = xyz.y / 100.0;
	float z = xyz.z / 108.883;

	x = x > 0.008856 ? pow(x, 1.0 / 3.0) : (7.787 * x) + (16.0 / 116.0);
	y = y > 0.008856 ? pow(y, 1.0 / 3.0) : (7.787 * y) + (16.0 / 116.0);
	z = z > 0.008856 ? pow(z, 1.0 / 3.0) : (7.787 * z) + (16.0 / 116.0);

    vec3 lab = vec3((116.0 * y) - 16.0, 500.0 * (x - y), 200.0 * (y - z));
    return(lab);
}

vec3 rgb2lab(in vec3 rgb) {
    vec3 xyz = rgb2xyz(rgb);
    vec3 lab = xyz2lab(xyz);
    return(lab);
}

vec3 xyz2rgb (in vec3 xyz) {
	float x = xyz.x / 100.0;
	float y = xyz.y / 100.0;
	float z = xyz.z / 100.0;
	
    
	float r = (x *  3.2406) + (y * -1.5372) + (z * -0.4986);
	float g = (x * -0.9689) + (y *  1.8758) + (z *  0.0415);
	float b = (x *  0.0557) + (y * -0.2040) + (z *  1.0570);

	r = r > 0.0031308 ? ((1.055 * pow(r, 1.0 / 2.4)) - 0.055) : r * 12.92;
	g = g > 0.0031308 ? ((1.055 * pow(g, 1.0 / 2.4)) - 0.055) : g * 12.92;
	b = b > 0.0031308 ? ((1.055 * pow(b, 1.0 / 2.4)) - 0.055) : b * 12.92;

	r = min(max(0.0, r), 1.0);
	g = min(max(0.0, g), 1.0);
	b = min(max(0.0, b), 1.0);

	return(vec3(r, g, b));
}

vec3 lab2xyz (in vec3 lab) {
    float l = lab.x;
	float a = lab.y;
	float b = lab.z;

  	float y = (l + 16.0) / 116.0;
	float x = a / 500.0 + y;
	float z = y - b / 200.0;

	float y2 = pow(y, 3.0);
	float x2 = pow(x, 3.0);
	float z2 = pow(z, 3.0);

  	y = y2 > 0.008856 ? y2 : (y - 16.0 / 116.0) / 7.787;
	x = x2 > 0.008856 ? x2 : (x - 16.0 / 116.0) / 7.787;
	z = z2 > 0.008856 ? z2 : (z - 16.0 / 116.0) / 7.787;

	x *= 95.047;
	y *= 100.0;
	z *= 108.883;

	return(vec3(x, y, z));
}
vec3 lab2rgb (in vec3 lab) {
    vec3 xyz = lab2xyz(lab);
    vec3 rgb = xyz2rgb(xyz);
    return(rgb);
}

`,fX=`
  uniform sampler2D uPosition;
  uniform float uSize;
  uniform float uSizeEnd;
  uniform vec3 uWorldOffset;
  uniform vec4 uWorldQuaternion;
  // Billboard Behavior - Currently at Zero, but we can change that
  uniform float uRotation;
  uniform float uRotationEnd;
  uniform vec2 center;

  // Randomness
  uniform float uRandScaleFactor;
  uniform float uRandRotationFactor;

  attribute vec2 ref;

  varying float v_LifeLeft;    // normalized lifetime 1 to 0
  varying vec2 vUv;
  varying vec2 vRef;

  ${uX}
  ${tw}
`,mX=({easeSize:e="linearFadeOut"})=>`
  vUv = uv;  
  vRef = ref;
  // Normalized LifeTime 1 to 0
  float lifeLeft = texture2D(uPosition, ref).w;
  v_LifeLeft = lifeLeft;
  // Position From DataTexture Simulation
  vec3 pos = texture2D(uPosition, ref).rgb - uWorldOffset;
  // Apply World Quaternion
  pos = applyQuaternionToVector(uWorldQuaternion, pos);  
            
  #ifdef  USE_SIZE_END
    // Scaled Over Time
    float t = 1. - lifeLeft;
    float currentSize = mix(uSize, uSizeEnd, t); // Linearly interpolate between uSize and uSizeEnd
    vec3 scaledPosition = position * vec3(currentSize);
  #else
    // Change Size Behavior over LifeTime
    float easeSize = ${e}(1. - lifeLeft);
    // Scaled Over Time
    vec3 scaledPosition = position * vec3(uSize * easeSize);
  #endif

  // Billboard Behavior
  vec2 scale;
  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );    
  // Randomness 
  float randRef = rand(ref);
  scale *= (1.0 - (uRandScaleFactor * randRef));
  // Rotation
  float randRotation =  2.0 * PI * ( uRandRotationFactor * randRef);
  float originalRotation = (1.0 - uRotation) * 2.0 * PI;
  float originalRotationEnd = (1.0 - uRotationEnd) * 2.0 * PI;
  // OverTime
  float finalRotation = mix(originalRotation + randRotation, originalRotationEnd + randRotation, lifeLeft);

  vec2 alignedPosition = ( scaledPosition.xy - ( center - vec2( 0.5 ) ) ) * scale;
  vec2 rotatedPosition;
  rotatedPosition.x = cos( finalRotation ) * alignedPosition.x - sin( finalRotation ) * alignedPosition.y;
  rotatedPosition.y = sin( finalRotation ) * alignedPosition.x + cos( finalRotation ) * alignedPosition.y;
  
  mat4 instanceMatrix = mat4(
    vec4(1.0, 0.0, 0.0, 0.0),
    vec4(0.0, 1.0, 0.0, 0.0),
    vec4(0.0, 0.0, 1.0, 0.0),
    vec4(pos.x, pos.y, pos.z, 1.0)
  );  

  mvPosition = modelViewMatrix * instanceMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
  mvPosition.xy += rotatedPosition;
  gl_Position = projectionMatrix  * mvPosition;   
`,gX=`
  uniform vec4 uColor;                // start color
  uniform vec4 uColor2;               // end color
  uniform sampler2D uTexture;         // texture
  varying float v_LifeLeft;   // normalized lifetime 1 to 0
  varying vec2 vUv;
  varying vec2 vRef;

  float random(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
  }
  `+tw+`  
  ${pX}

`,vX=({easeOpacity:e="linearFadeOut"})=>`  
  // if Particle is dead, hide it
  if (v_LifeLeft <= 0.005 ) {
    discard;
  }

  #ifdef USE_RANDOM_COLORING
    float randVal = random(vRef); // Generate a random value based on the reference
    vec4 color = mix(uColor, uColor2, randVal); // Interpolate between the two colors
  #else
    vec4 color = mix(uColor, uColor2, 1. - v_LifeLeft);
  #endif

  // Opacity over Life Time
  float finalAlpha = ${e}(1. - v_LifeLeft);  
  vec4 textureColor = texture2D(uTexture, vUv).rgba; 
  finalColor = textureColor.rgb * color.rgb;
  finalAlpha = color.a * textureColor.a * finalAlpha;
  
  gl_FragColor = vec4(finalColor, finalAlpha);     

`,yX=class extends It{constructor(e,t){super(),this.needsJitter=!0,this.type="ParticleMaterial",this.easeOpacity="linearFadeIn",this.easeSize="linearFadeIn",this.useSizeEnd=!1,this.isColoringRandom=!1,this.init(e,t),this.context=t}reset(){}init(e,t){this.transparent=!0,this.depthTest=!0,this.depthWrite=!1,this.easeOpacity=e.ease,this.easeSize=e.easeSize,this.layers=[],Oi.startContext(Oi.globalContext),this.lightLayer=new $r(0,"",{...ji.defaultData("light","phong"),visible:!1},new i5,{},t.shared),Oi.endContext(Oi.globalContext),this.build()}updateState(e){e.coloring!==void 0&&(this.isColoringRandom=e.coloring==="random"),e.color!==void 0&&(e.color instanceof Array?this.uniforms.uColor.value=e.color:this.uniforms.uColor.value=this.context.shared.color(e.color)),e.color2!==void 0&&(e.color2 instanceof Array?this.uniforms.uColor2.value=e.color2:this.uniforms.uColor2.value=this.context.shared.color(e.color2)),e.size!==void 0&&(this.uniforms.uSize.value=e.size[0],this.uniforms.uSizeEnd.value=e.size[1],e.size[0]!==e.size[1]?this.useSizeEnd=!0:this.useSizeEnd=!1),e.ease!==void 0&&(this.easeOpacity=e.ease,this.build()),e.easeSize!==void 0&&(this.easeSize=e.easeSize,this.build()),this.needsUpdate=!0}onBeforeCompile(e){this.build(),e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader}build(){let e=new Jx;return e.needsJitter=this.needsJitter,e.addFragmentParsCode(Nj),e.buildShader("vertex",this.fragment),e.buildShader("fragment",this.fragment),e.addFragmentFinalCode(Vj),this.isColoringRandom&&e.define("USE_RANDOM_COLORING"),this.useSizeEnd&&e.define("USE_SIZE_END"),e.addVertexParsCode(fX),e.addFragmentParsCode(gX),e.addVertexFinalCode(mX({easeSize:this.easeSize})),e.addFragmentFinalCode(vX({easeOpacity:this.easeOpacity})),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms={...e.uniforms,...this.uniforms},this.extensions=e.extensions,this}get nodeMaterial(){return this}get fragment(){return this.lightLayer.node}getDefines(){return this.defines}nodeMaterialDispose(){this.layers.forEach(e=>e.dispose()),super.dispose()}},Ep=class{constructor(e,t,i,r){this.type="SphereEmitterShape",this.targetMesh=void 0,this.size=e,this.type=i,this.textureSize=iX(t);let s=1;this.targetMesh=(r==null?void 0:r.type)==="Mesh"&&r?r:this.getMesh(i,s);let{positions:a,dataTexture:n,dataTextureNormals:o}=this.createPositions(this.textureSize,this.targetMesh??this.getMesh(i,s));this.positionsTexture=n,this.positionsAttribute=a,this.directionsTexture=o}createPositions(e,t){let{positions:i,normals:r}=rX(t,e*e),s=q8(i,e),a=q8(r,e);return{dataTexture:s,positions:i,dataTextureNormals:a}}getMesh(e,t){let i=null;switch(e){case"SphereEmitterShape":{i=new jo(t*.5,32,32);break}case"TorusEmitterShape":{i=new Rv(t*.5,.3,15,40);break}case"ConeEmitterShape":{i=new h4(t,t,15);break}case"BoxEmitterShape":{i=new Lr(t,t,t);break}case"PlaneEmitterShape":{i=new $s(t,t),i.rotateX(-Math.PI/2);break}case"MeshEmitterShape":{i=new jo(t,32,32);break}default:{i=new jo(t,32,32);break}}return new si(i,new Js({color:16711680}))}applyToShader(e,t){this.size=new E().fromArray(t.size),e.uEmitterSize.value=this.size}dispose(){this.positionsTexture.dispose(),this.directionsTexture.dispose(),this.positionsAttribute=new Float32Array}};function Ro(e){let t={...e},i=zc.defaultData;t.forceFieldObjectId&&(t.colliderEntityId=t.forceFieldObjectId);let r={...i.shape,...t.shape},s={...i.renderMaterial,...t.renderMaterial};return{...i,...t,shape:r,renderMaterial:s}}var xX=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU

uniform sampler2D uIndex; // Texture with corresponding index
uniform float uLastIndexEmitted; // Last emitted index
uniform float uParticlesToEmit; // Number of particles to emit on that frame
uniform float uTime;

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    float particleIndex = texture(uIndex, vUv).x;
    float timeLeft = texture2D( uCurrentPosition, vUv ).w;
    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;    // 1. = active, 0. = not active
    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;


    // ********** Detect Colision to Create a flag and use it in position **********
    // We are doing this here, so

    // ********** Emit Particles **********
    // X = isSpawning 0.0 or 1.0
    // Y = isActive 0.0 or 1.0
    // Check if the vertex index is between the first value and the last value
    // if (particleIndex >= uLastIndexEmitted && particleIndex < uLastIndexEmitted + uParticlesToEmit) {
    //     // Emit a particle by writing 1 to the red channel of the color output
    //     // r: 1. == emit the particle
    //     // g: 1. == particle is now active
    //     timeStart = uTime;
    //     gl_FragColor = vec4(1.0, 1.0, timeStart, 1.0);
    // } else {
    //     // The Particle is either already emitted or not in the range of the particles to emit
    //     // Do not emit a particle by writing 0 to the red channel of the color output        
    //     gl_FragColor = vec4(0.0, isActive, timeStart, 1.0);
    // }
    // Determine if the particle is within the emission range
    float emitLowerBound = step(uLastIndexEmitted, particleIndex);
    float emitUpperBound = step(particleIndex, uLastIndexEmitted + uParticlesToEmit - 1.0);
    float emitParticle = emitLowerBound * emitUpperBound; // 1.0 if in range, 0.0 otherwise

    // Set timeStart and color
    timeStart = mix(timeStart, uTime, emitParticle);
    gl_FragColor = vec4(emitParticle, mix(isActive, 1.0, emitParticle), timeStart, 1.0);


}
`,Cp=10,bX=class extends kt{constructor(e,t){super(),this.type="ParticleEmitter",this.debugMode=!1,this.worldSpace=!0,this.rootObject=null,this.gpuCompute=null,this.positionSimRT=null,this.velocitySimRT=null,this.emissionRateSimRT=null,this.emitterShape=void 0,this.isEmitting=!1,this.hasBeenReset=!1,this.emittedParticlesAmount=0,this.lastEmitTime=0,this.globalTime=0,this.targetFPS=60,this.previousRatio=1,this.lerpFactor=.4,this.particlesAmount=0,this.noiseStrength=0,this.noiseScale=0,this.isBillboardBased=!0,this.simFeaturesDefinition={USE_COLLIDER:!1,USE_ATTRACTOR:!1,USE_VORTEX:!1,USE_SPHERE_COLLIDER:!1,USE_BOX_COLLIDER:!1,USE_FORCE_LOCAL_SPACE:!1,USE_NORMALS:!1,USE_CURL_NOISE:!0,USE_SIMPLEX_NOISE:!1,USE_FBM_NOISE:!1},this.textureLoader=new pP,this.currentWorldPosition=new E,this.systemQuaternion=new lt,this.worldGravity=new E(0,0,0),this.directionAxis=new E(0,0,0),this.colliderV3=new E(0,0,0),this.colliderQuaternion=new lt(0,0,0,1),this.matrixAutoUpdate=!0,this.renderer=e,this.system=t,this.shared=t.context.shared;let i=t.data;this.material=new yX(i.renderMaterial,t.context),this.material.uniforms={uSize:{value:0},uSizeEnd:{value:0},uColor:{value:i.renderMaterial.color},uColor2:{value:i.renderMaterial.color2},uPosition:{value:new E(0,0,0)},uEmissionData:{value:new E(0,0,0)},uTexture:{value:this.defaultTexture},uWorldOffset:{value:new E(0,0,0)},uWorldQuaternion:{value:new ht(0,0,0,1)},uRandScaleFactor:{value:i.randomScale??0},uRandRotationFactor:{value:i.randomRotation??0},uRotation:{value:i.renderMaterial.spriteRotation[0]??0},uRotationEnd:{value:i.renderMaterial.spriteRotation[1]??0}},this.setTexture(this.material.uniforms,i.renderMaterial.texture),this.init(i)}setTexture(e,t){let i=t.data;if(typeof t=="string"){let r=this.shared.image(t),s=new ai(r.img);s.needsUpdate=!0,e.uTexture.value=s;return}if(typeof i!="string"){let r=new Image;r.onload=()=>{let n=new ai(r);n.needsUpdate=!0,e.uTexture.value=n};let s=new Blob([i],{type:"image/*"}),a=URL.createObjectURL(s);r.src=a}}updateGeometryAttributes(e,t){var r;let i=tX(t);!((r=this.emitterShape)!=null&&r.positionsAttribute)||e.geometry.setAttribute("ref",new L2(i,2))}applyWorldSpace(){if(!this.system.started||!this.worldSpace||!this.positionSimRT||!this.velocitySimRT)return;let e=this.system;e.getWorldQuaternion(this.systemQuaternion),this.systemQuaternion.invert(),e.getWorldPosition(this.currentWorldPosition),this.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.positionSimRT.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.systemQuaternion.invert(),this.positionSimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.velocitySimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize())}update(e,t){var n;if(!this.gpuCompute||!this.positionSimRT||!this.velocitySimRT||!this.emissionRateSimRT||this.hasBeenReset)return;if(this.checkIfAllParticlesAreDead()&&!this.hasBeenReset){this.reset();return}this.applyWorldSpace(),this.globalTime=e,this.positionSimRT.material.uniforms.uTime.value=e,this.emissionRateSimRT.material.uniforms.uTime.value=e;let i=1e3/t,r=this.targetFPS/i,s=this.previousRatio+(r-this.previousRatio)*this.lerpFactor;this.positionSimRT.material.uniforms.uFPSRatio.value=s,this.previousRatio=s;let a=this.isEmitting?this.GoEmitSomeParticles(e,this.system.data.birthRatePerSec):0;this.emissionRateSimRT.material.uniforms.uLastIndexEmitted.value=this.emittedParticlesAmount,this.emissionRateSimRT.material.uniforms.uParticlesToEmit.value=a,this.material.uniforms.uPosition.value=(n=this.gpuCompute.getCurrentRenderTarget(this.positionSimRT))==null?void 0:n.texture,this.system.colliderEntities.length>0&&this.renderColliders(),this.gpuCompute.compute()}renderColliders(){if(!this.velocitySimRT)return;let e=this.system.colliderEntities[0],t=this.simFeaturesDefinition.USE_COLLIDER||this.simFeaturesDefinition.USE_ATTRACTOR||this.simFeaturesDefinition.USE_VORTEX;if(e.destroyedInAction&&t&&this.init(Ro({...this.system.data,colliderEntityId:null})),!e||e.destroyedInAction)return;e.getWorldPosition(this.colliderV3),this.colliderV3.y===0&&(this.colliderV3.y=1e-4),this.velocitySimRT.material.uniforms.uColliderPos.value.copy(this.colliderV3);let i=e.data.size;this.colliderV3.fromArray(i),this.velocitySimRT.material.uniforms.uColliderSize.value.copy(this.simFeaturesDefinition.USE_SPHERE_COLLIDER?this.colliderV3.multiplyScalar(.5):this.colliderV3),e.getWorldQuaternion(this.colliderQuaternion),this.velocitySimRT.material.uniforms.uColliderQuaternion.value.copy(this.colliderQuaternion.normalize()),this.velocitySimRT.material.uniforms.uColliderQuaternionInvert.value.copy(this.colliderQuaternion.normalize().invert())}updateState(e){!this.velocitySimRT||!this.positionSimRT||(e.renderMaterial&&this.updateMaterialState(e.renderMaterial),this.updateParticleState(e))}updateVariableState(e,t){if(!this.velocitySimRT||!this.positionSimRT)return;t[2]==="size"&&this.material.updateState({size:[e,this.material.uniforms.uSizeEnd.value]}),t[2]==="sizeEnd"&&this.material.updateState({size:[this.material.uniforms.uSize.value,e]});let i=(r,s)=>{let a=[...this.system.data.shape.size];a[r]=s,this.updateParticleState({shape:{...this.system.data.shape,size:a}})};t[2]==="shape_size_0"&&i(0,e),t[2]==="shape_size_1"&&i(1,e),t[2]==="shape_size_2"&&i(2,e),t[2]==="speed"&&(this.velocitySimRT.material.uniforms.uSpeed.value=e/Cp),t[2]==="gravity"&&this.worldGravity.set(0,e/100,0),t[2]==="noiseStrength"&&(this.noiseStrength=e,this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),t[2]==="noiseScale"&&(this.noiseScale=e,this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),t[2]==="direction_x"&&(this.directionAxis=this.getDirectionAxis([Number(e),this.system.data.direction[1],this.system.data.direction[2]])),t[2]==="direction_y"&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],Number(e),this.system.data.direction[2]])),t[2]==="direction_z"&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],this.system.data.direction[1],Number(e)]))}updateMaterialState(e){this.material.updateState({...e,size:e.size?[Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","size"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","sizeEnd"]))]:[0,0]}),e.texture&&(this.setTexture(this.material.uniforms,e.texture),this.material.needsUpdate=!0)}updateParticleState(e){var t,i,r;if(!(!this.positionSimRT||!this.velocitySimRT)){if(this.shouldReInitGPUCompute(e)&&this.init(Ro(this.system.data)),e.life!==void 0&&(this.positionSimRT.material.uniforms.uMaxLifeTime.value=e.life),e.speed!==void 0&&(this.velocitySimRT.material.uniforms.uSpeed.value=Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/Cp),e.collisionBounce!==void 0&&(this.velocitySimRT.material.uniforms.uBounce.value=e.collisionBounce),e.noiseStrength!==void 0&&(this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),e.noiseScale!==void 0&&(this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"])),this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),e.noiseSeed!==void 0&&(this.velocitySimRT.material.uniforms.uNoiseSeed.value=e.noiseSeed),e.randomMass!==void 0&&(this.velocitySimRT.material.uniforms.uRandomMassFactor.value=e.randomMass),((t=e.renderMaterial)==null?void 0:t.size)!==void 0){let s=this.shared.getVariable(e.renderMaterial.size[0],[this.uuid,"particles","size"]);this.velocitySimRT.material.uniforms.particleSize.value=Number(s)}if(((i=e.renderMaterial)==null?void 0:i.spriteRotation)!==void 0&&(this.material.uniforms.uRotation.value=e.renderMaterial.spriteRotation[0],this.material.uniforms.uRotationEnd.value=e.renderMaterial.spriteRotation[1]),e.shape!==void 0){let s=e.shape.size??this.system.data.shape.size,a=[Number(this.shared.getVariable(s[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(s[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(s[2],[this.uuid,"particles","shape_size_2"]))],n={...Ro(this.system.data).shape,size:a};(r=this.emitterShape)==null||r.applyToShader(this.positionSimRT.material.uniforms,n)}if(e.gravity!==void 0&&(this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.velocitySimRT.material.uniforms.uGravity={value:this.worldGravity}),e.direction!==void 0){let s=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(s),this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis}e.randomRotation!==void 0&&(this.material.uniforms.uRandRotationFactor.value=e.randomRotation),e.randomScale!==void 0&&(this.material.uniforms.uRandScaleFactor.value=e.randomScale)}}updateForceFieldParameters(e){!this.velocitySimRT||(e.forceIntensity!==void 0&&(this.velocitySimRT.material.uniforms.uForceIntensity.value=e.forceIntensity),e.forceDambing!==void 0&&(this.velocitySimRT.material.uniforms.uForceDamping.value=e.forceDambing))}getDirectionAxis(e){let t=[Number(e[0])*Oe.DEG2RAD,Number(e[1])*Oe.DEG2RAD,Number(e[2])*Oe.DEG2RAD],i=new Ri(t[0],t[1],t[2],"XYZ");return this.directionAxis.set(0,1,0).applyEuler(i).normalize(),this.velocitySimRT&&(this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis),this.directionAxis}shouldReInitGPUCompute(e){let{birthRatePerSec:t,rootObjectType:i,colliderEntityId:r,shape:s,emitTimeDuration:a,emitTimeCycle:n,life:o,directionMode:l,noiseType:h}=e;return t!==void 0||i!==void 0||r||r===null||n!==void 0||s!==void 0||o!==void 0||a!==void 0||l!==void 0||h!==void 0}init(e){this.dispose(),this.particlesAmount=this.getMaxParticlesAmount({birthRatePerSecond:e.birthRatePerSec,particleMaxLifeTime:e.life,loopDuration:e.emitTimeCycle==="infinity"?0:e.emitTimeDuration}),this.particlesAmount>1e5&&(this.particlesAmount=1e5),this.emitterShape=this.createShape(e.shape,this.particlesAmount);let t=setInterval(()=>{if(this.emitterShape)if(isNaN(this.emitterShape.positionsTexture.source.data.data[0])){this.init(e);return}else clearInterval(t)},100);if(!this.emitterShape)return;let i=new $Y(this.emitterShape.textureSize,this.emitterShape.textureSize,this.renderer),r=this.updateSimulationDefinition(e),s=i.addVariable("uCurrentPosition",r+nX,this.emitterShape.positionsTexture),a=i.addVariable("uCurrentVelocity",r+dX,this.emitterShape.directionsTexture),n=i.addVariable("uCurrentEmissionRate",xX,aX(this.emitterShape.textureSize));i.setVariableDependencies(s,[s,a,n]),i.setVariableDependencies(a,[s,a,n]),i.setVariableDependencies(n,[s,a,n]);let o=sX({size:this.emitterShape.textureSize}),l={uOriginalPosition:{value:this.emitterShape.positionsTexture},uWorldOffset:{value:new E(0,0,0)},uWorldQuaternion:{value:new ht(0,0,0,1)},uTime:{value:0},uFPSRatio:{value:1},uMaxLifeTime:{value:e.life},uEmitterSize:{value:new E(Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"])))},particleSize:{value:0}};s.material.uniforms=l;let h=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(h),this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"]));let c=e.colliderEntityId&&this.system.getColliderData(e.colliderEntityId),d={uOriginalPosition:{value:this.emitterShape.positionsTexture},uDirections:{value:this.emitterShape.directionsTexture},uDirectionsAxis:{value:this.directionAxis},uWorldQuaternion:{value:new ht(0,0,0,1)},uColliderPos:{value:new E(0,0,0)},uColliderSize:{value:new E(0,0,0)},uForceIntensity:{value:c?c.forceIntensity:0},uForceDamping:{value:c?c.forceDambing:0},uColliderQuaternion:{value:new ht(0,0,0,1)},uColliderQuaternionInvert:{value:new ht(0,0,0,1)},particleSize:{value:0},uGravity:{value:this.worldGravity},uNoiseStrength:{value:this.noiseStrength},uNoiseScale:{value:this.noiseScale},uNoiseSeed:{value:e.noiseSeed},uRandomMassFactor:{value:e.randomMass},uBounce:{value:e.collisionBounce},uSpeed:{value:Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/Cp}};a.material.uniforms=d;let u={uIndex:{value:o},uTime:{value:0},uLastIndexEmitted:{value:0},uParticlesToEmit:{value:0}};n.material.uniforms=u;let p=[Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"]))],f={...Ro(this.system.data).shape,size:p};this.emitterShape.applyToShader(s.material.uniforms,f),i.init(),this.gpuCompute=i,this.positionSimRT=s,this.velocitySimRT=a,this.emissionRateSimRT=n,this.rootObject=this.createPrimaryEmitter(this.emitterShape.textureSize),this.add(this.rootObject),this.material.needsUpdate=!0}getDirectionFromVariable(e){let t=Number(this.shared.getVariable(e[0],[this.uuid,"particles","direction_x"])),i=Number(this.shared.getVariable(e[1],[this.uuid,"particles","direction_y"])),r=Number(this.shared.getVariable(e[2],[this.uuid,"particles","direction_z"]));return[t,i,r]}updateSimulationDefinition(e){if(this.simFeaturesDefinition.USE_COLLIDER=!1,this.simFeaturesDefinition.USE_ATTRACTOR=!1,this.simFeaturesDefinition.USE_VORTEX=!1,this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!1,this.simFeaturesDefinition.USE_BOX_COLLIDER=!1,this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!1,this.simFeaturesDefinition.USE_NORMALS=!1,this.simFeaturesDefinition.USE_CURL_NOISE=!1,this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!1,this.simFeaturesDefinition.USE_FBM_NOISE=!1,e.colliderEntityId&&this.system.colliderEntities.length>0){let i=this.system.getColliderData(e.colliderEntityId);switch(i==null?void 0:i.forceType){case"attractor":this.simFeaturesDefinition.USE_ATTRACTOR=!0;break;case"collider":this.simFeaturesDefinition.USE_COLLIDER=!0;break;case"vortex":this.simFeaturesDefinition.USE_VORTEX=!0;break}let r=i==null?void 0:i.colliderType;r==="sphere"&&(this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!0),r==="box"&&(this.simFeaturesDefinition.USE_BOX_COLLIDER=!0),(i==null?void 0:i.forceRange)==="helper"&&(this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!0)}e.directionMode==="normals"&&(this.simFeaturesDefinition.USE_NORMALS=!0),e.noiseType==="curl"&&(this.simFeaturesDefinition.USE_CURL_NOISE=!0),e.noiseType==="simplex"&&(this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!0),e.noiseType==="fbm"&&(this.simFeaturesDefinition.USE_FBM_NOISE=!0);let t="";for(let[i,r]of Object.entries(this.simFeaturesDefinition))r&&(t+=`#define ${i}
`);return t}createShape(e,t){this.emitterShape&&this.emitterShape.dispose();let i=new E(Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.size[2],[this.uuid,"particles","shape_size_2"])));if(e.type==="MeshEmitterShape"){let r=null;return this.system.context.scene.traverseEntity(s=>{s.uuid===e.fromMeshId&&(r=s)}),r?new Ep(i,t,e.type,r):new Ep(i,t,"SphereEmitterShape")}else return new Ep(i,t,e.type)}createPrimaryEmitter(e){let t,i=e*e;return t=new CT(new $s(1,1,1),this.material,i),this.updateGeometryAttributes(t,e),this.material.needsUpdate=!0,t.onBeforeRender=()=>{this.applyWorldSpace()},t}getMaxParticlesAmount({birthRatePerSecond:e,particleMaxLifeTime:t,loopDuration:i=0}){return Math.ceil(e*(t+i))}dispose(){var e,t,i;!this.gpuCompute||((t=(e=this.rootObject)==null?void 0:e.parent)==null||t.remove(this.rootObject),this.gpuCompute.dispose(),this.material.nodeMaterialDispose(),(i=this.emitterShape)==null||i.dispose())}GoEmitSomeParticles(e,t){let i=e-this.lastEmitTime,r=1/t;if(i>=r){let s=Math.max(1,Math.floor(i/r));return this.lastEmitTime=e,this.emittedParticlesAmount+s>this.particlesAmount&&(this.emittedParticlesAmount=0),this.emittedParticlesAmount+=s,s}return 0}checkIfAllParticlesAreDead(){return this.lastEmitTime+this.system.data.life+1<this.globalTime}reset(){this.hasBeenReset=!0,this.lastEmitTime=0,this.emittedParticlesAmount=0,this.gpuCompute&&this.init(Ro(this.system.data))}startEmitting(e){this.isEmitting=!0,this.hasBeenReset=!1,this.lastEmitTime=e}stopEmitting(){this.isEmitting=!1}},ic=class extends D1{constructor(e,t,i){super(e,t),this.type="ParticleSystem",this.geometry=new Ge,this.actualTime=0,this.currentLoopTime=0,this.started=!1,this.stopped=!1,this.timeoutId=void 0,this.isFrozen=!1,this.isIdle=!0,this.emitter=null,this.colliderEntities=[],this.renderer=null,this.isPreWarm=!1,this._hasOnAfterRenderBeenCalled=!1,this.onAfterRender=r=>{this._hasOnAfterRenderBeenCalled||(this._hasOnAfterRenderBeenCalled=!0,this.init(r))},this.context=i,this.data={...t,...Ro(t)},this.geometry.setAttribute("position",new De([],3)),this.material=new Js({colorWrite:!1}),this.frustumCulled=!1}init(e){this.renderer=e,this.emitter=new bX(e,this),this.add(this.emitter),this.updateParticleState(this.data)}update(e){if(!this.isReady||!this.started||this.isFrozen||this.isIdle)return;this.actualTime+=e,this.stopped||(this.currentLoopTime+=e);let t=this.data.emitTimeCycle==="one_time";if((this.data.emitTimeCycle==="loop"||t)&&this.currentLoopTime>this.data.emitTimeDuration*1e3&&(this.stopped||(this.stop(),t||this.start(this.data.emitTimeDelay*1e3))),this.emitter&&this.started){let i=this.actualTime/1e3;this.emitter.update(i,e)}this.scale.set(1,1,1),this.updateMatrix()}isReady(){return!!this.emitter}hasCollider(e){return this.colliderEntities.some(t=>t.identity===e)}getColliderData(e){let t=this.colliderEntities.find(i=>i.identity===e);return t?t.data:null}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),Yt(e.path,["renderMaterial"])&&this.updateParticleState({renderMaterial:{...this.data.renderMaterial,...qi.drop(e,1).props}}),Yt(e.path,["shape"])&&this.updateParticleState({shape:{...this.data.shape,...qi.drop(e,1).props}})}updateState(e,t){super.updateState(e,t),this.updateParticleState(e)}updateParticleState(e){if(this.emitter){if(e.colliderEntityId!==void 0&&e.colliderEntityId!==null){let t=this.context.scene.find(e.colliderEntityId);this.colliderEntities=t?[t]:[]}e.colliderEntityId===null&&(this.colliderEntities=[]),this.emitter.updateState(e),e.emitTimeCycle&&this.started&&this.start()}}updateFromColliderEntity(e){!this.emitter||(this.emitter.updateForceFieldParameters(e),this.stop(),this.start())}start(e=0){var t;if(this.currentLoopTime=0,e){this.timeoutId=window.setTimeout(()=>{this.start(0)},e);return}this.started=!0,this.stopped=!1,this.isFrozen=!1,(t=this.emitter)==null||t.startEmitting(this.actualTime/1e3)}froze(){this.isFrozen=!0}unFroze(){this.isFrozen=!1}stop(){var e;this.stopped=!0,this.currentLoopTime=0,(e=this.emitter)==null||e.stopEmitting(),clearTimeout(this.timeoutId)}reset(){var e;this.started=!1,this.stopped=!1,(e=this.emitter)==null||e.reset()}wakeUp(){this.isIdle=!1}sleep(){this.isIdle=!0,this.reset()}};function wX(){try{let e=window.location.href;if(e.includes("reducesubdiv=")){let t=e.indexOf("reducesubdiv=")+13;return parseInt(e.slice(t,t+1))}}catch{}}var Tp=wX();function SX(e,t,i){var s;Tp!==void 0&&(((s=t==null?void 0:t.geometry)==null?void 0:s.subdivisions)??0)>Tp&&(t.name,t.geometry.subdivisions,t.geometry.subdivisions=Tp);let r;return t.geometry.type==="TextGeometry"?new h5(e,t,i):t.geometry.type==="InputGeometry"?new v5(e,t,i):(t.geometry.type==="SubdivGeometry"?r=new eh(e,t,i):t.geometry.type==="PathGeometry"?r=new g5(e,t,i):t.geometry.type==="VectorGeometry"?r=new KY(e,t,i):t.geometry.type==="BooleanGeometry"?r=new Nn(e,t,i):t.geometry.type==="UIGeometry"?r=new p1(e,t,i):r=new g1(e,t,i),r)}function x5(e,t,i){return console.assert(t.type!==void 0),t.type==="Mesh"?SX(e,t,i):t.type==="Empty"?new Jo(e,t):t.type==="Particle"?new ic(e,t,i):t.type==="ParticleCollider"?new ec(e,t,i):t.type==="Splat"?new Jo(e,t):t.type==="Bone"?new JY(e,t):t.type==="Page"?new Gi(e,t,i):t.type==="PointLight"?new ZY(e,t,i):t.type==="SpotLight"?new Hb(e,t,i):t.type==="DirectionalLight"?new Gb(e,t,i):t.type==="Component"||t.type==="Instance"?new $o(e,t,i):kn.is(t.type)?new v1(e,t):new Jo(e,t)}La.createEntity=x5;function _X(e,t,i){let r=x5(e.identity,t,i),s=e.children,a=e.attachedPaths,n=e.parent,o=e.component,l=e.instances,h=e.overrideData,c=e.uuid,d=e.stateSelection;e.dispose();for(let u of Object.keys(e))delete e[u];Object.setPrototypeOf(e,Object.getPrototypeOf(r));for(let u of Object.keys(r))e[u]=r[u];e.children=[...e.children,...s],e.attachedPaths=a,e.parent=n,e.component=o,e.instances=l,e.uuid=c,e.overrideData=h,e.updateState(e.data,i),d&&e.changeSelectedState(d,i),e.resetBBoxNeedsUpdate()}La.changeEntityProptotype=_X;La.Cloner=Pr;function AX(e,t,i,r){e.updateByOp(t,i,r,!1)}function Y8(e,t){let i=!1,r=t.getLayersOfType("transmission"),s=t.getLayersOfType("outline");return s.length>0&&(e.layers.set(8),r.length>0&&e.layers.enable(3),i=!0,l5(e),o5(e)),r.length===0&&s.length===0&&e.layers.set(0),e instanceof Il&&e.needsAO&&e.layers.enable(5),i}function X8(e,t){if(!t.layers)return!1;let i=!1,r=t.getLayersOfType("transmission").filter(a=>a.data.visible),s=t.getLayersOfType("outline").filter(a=>a.data.visible);return r.length>0&&(e.layers.set(3),s.length>0&&e.layers.enable(8),i=!0),r.length===0&&s.length===0&&e.layers.set(0),e.needsAO&&e.layers.enable(5),i}function MX(e){let t=!1;return e.traverseEntity(i=>{if(i instanceof Il)if(Array.isArray(i.material))for(let r=0;r<i.material.length;r++)Y8(i,i.material[r])&&(t=!0);else Y8(i,i.material)&&(t=!0)}),t}function EX(e){let t=!1;return e.traverseEntity(i=>{if(i instanceof Il)if(Array.isArray(i.material))for(let r=0;r<i.material.length;r++)X8(i,i.material[r])&&(t=!0);else X8(i,i.material)&&(t=!0)}),t}var CX=new jv,TX=new we,PX=new vl;function kf(e,t,i,r=!1){let s=e.cloner;if(s)for(let a of s.children){let n=TX.copy(a.matrixWorld).invert(),o=PX.copy(t.ray).applyMatrix4(n),l=e.matrixWorld;o.applyMatrix4(l);let h=CX;h.set(o.origin,o.direction),h.near=t.near,h.far=t.far;let c=h.intersectObject(e,!1);c.length>0&&i.push({...c[0],object:r?a:e})}}var DX=class{constructor(){this._constraints=new Map}setConstraint(e,t){t===null?this._constraints.delete(e):this._constraints.set(e,t)}removeDependencies(e){this._constraints.delete(e)}applyConstraints(e){let t=new Set;this._constraints.forEach((i,r)=>{let s=[r,i],a=i;for(;this._constraints.has(a);){if(a=this._constraints.get(a),s.includes(a)){`${s.join(" -> ")}`;break}t.has(a)||s.push(a)}for(let n=s.length-2;n>=0;n--)if(!t.has(s[n])){let o=e.find(s[n]);o?o.applyPathSnapping(e):`${s[n]}`,t.add(s[n])}})}findDependency(e,t){let i=e;for(;this._constraints.has(i);)if(i=this._constraints.get(i),i===t)return!0;return!1}},IX="AGFzbQEAAAAADwhkeWxpbmsuMAEEAAAAAAETA2AAAGAIf39/f39/f38AYAABfwISAQNlbnYGbWVtb3J5AgMAgIAEAwQDAAECBzkDEV9fd2FzbV9jYWxsX2N0b3JzAAALc29ydEluZGV4ZXMAARNlbXNjcmlwdGVuX3Rsc19pbml0AAIK3gMDAwABC9IDAwF/BnwBfgJAIAdFDQAgAysDUCEMIAMrAzAhDSADKwMQIQ5BACEDRP///////+9/IQtEAAAAAAAAEAAhCgNAIAIgA0ECdGoCfyAOIAEgA0EMbGoiCCoCALuiIA0gCCoCBLuioCAMIAgqAgi7oqBEAAAAAAAAsECiIgmZRAAAAAAAAOBBYwRAIAmqDAELQYCAgIB4CzYCACAJIAsgCSALYxshCyAJIAogCSAKZBshCiADQQFqIgMgB0cNAAsgB0UNACAGuCAKIAuhoyEJQQAhAwNAAn8gCSACIANBAnRqIgEoAgC3IAuhoiIKmUQAAAAAAADgQWMEQCAKqgwBC0GAgICAeAshCCABIAg2AgAgBCAIQQJ0aiIBIAEoAgBBAWo2AgAgA0EBaiIDIAdHDQALCyAGQQJPBEAgBCgCACEIQQEhAwNAIAQgA0ECdGoiASABKAIAIAhqIgg2AgAgA0EBaiIDIAZHDQALCyAHQQFrIgGtIQ8DQCAEIAIgD6dBAnQiA2ooAgBBAnRqIgcgBygCAEEBayIHNgIAIAUgASAHa0ECdGogACADaigCADYCACAPUCEDIA9CAX0hDyADRQ0ACyAGBEAgBEEAIAZBAnT8CwALCwQAQQAL",za=class{};gn(za,"DepthMapRange",65536),gn(za,"MemoryPageSize",65536),gn(za,"BytesPerFloat",4),gn(za,"BytesPerInt",4);function OX(e){let t,i,r,s,a,n,o,l,h,c,d,u,p,f,g,m;function v(T){let P=new Float64Array(c,n,16);for(let D=0;D<16;D++)P[D]=T[D];let I;if(r>1){t.exports.sortIndexes(s,a,h,n,o,l,u.DepthMapRange,r);let D=new Uint32Array(r);I=D.buffer,D.set(new Uint32Array(c,l,r))}else if(r===1){let D=new Uint32Array(r);D[0]=new Uint32Array(c,s,i)[0],I=D.buffer}else I=new ArrayBuffer(0);e.postMessage({sortDone:!0,indexesBuffer:I},[I])}function y(T,P,I){let D=new Float32Array(c,a,i*3);r=0;let k=new Uint32Array(c,s,i);for(let H=0;H<I.length-1;H++){let U=P[H],F=T[H].elements,Z=U.filter(G=>G.enabled&&G.mode==="Include").map(G=>G.type==="Box"?b(G):M(G)),W=U.filter(G=>G.enabled&&G.mode==="Exclude").map(G=>G.type==="Box"?b(G):M(G));for(let G=I[H];G<I[H+1];G++){let X=p[G*3],ee=p[G*3+1],Y=p[G*3+2];if((Z.length===0||w(X,ee,Y,Z))&&(W.length===0||!w(X,ee,Y,W))){let $=1/(F[3]*X+F[7]*ee+F[11]*Y+F[15]);D[r*3]=(F[0]*X+F[4]*ee+F[8]*Y+F[12])*$,D[r*3+1]=(F[1]*X+F[5]*ee+F[9]*Y+F[13])*$,D[r*3+2]=(F[2]*X+F[6]*ee+F[10]*Y+F[14])*$,k[r]=G,r++}}}}function x(T,P){let I=[],D=P.filter(U=>U.enabled&&U.mode==="Include").map(U=>U.type==="Box"?b(U):M(U)),k=P.filter(U=>U.enabled&&U.mode==="Exclude").map(U=>U.type==="Box"?b(U):M(U)),H=T.length;for(let U=0;U<H;U+=3){let F=T[U],Z=T[U+1],W=T[U+2];(D.length===0||w(F,Z,W,D))&&(k.length===0||!w(F,Z,W,k))||I.push(U/3)}return I}function w(T,P,I,D,k){return D.some(H=>{let U=_(T,P,I,H.invRotationMatrix,H.cropCenter);return Array.isArray(H)?S(U.x,U.y,U.z,H):C(U.x,U.y,U.z,H)})}function _(T,P,I,D,k){let H=T-k[0],U=P-k[1],F=I-k[2],Z=1/(D[3]*H+D[7]*U+D[11]*F+D[15]);return{x:(D[0]*H+D[4]*U+D[8]*F+D[12])*Z+k[0],y:(D[1]*H+D[5]*U+D[9]*F+D[13])*Z+k[1],z:(D[2]*H+D[6]*U+D[10]*F+D[14])*Z+k[2]}}function b(T){let P=T.cropSize[0]/2,I=T.cropSize[1]/2,D=T.cropSize[2]/2,k=[T.cropCenter[0]-P,T.cropCenter[1]-I,T.cropCenter[2]-D,T.cropCenter[0]+P,T.cropCenter[1]+I,T.cropCenter[2]+D],H=A(T.cropRotation);return Object.assign(k,{invRotationMatrix:H,cropCenter:T.cropCenter})}function A(T){let P=[],I=T[0]*Math.PI/180,D=T[1]*Math.PI/180,k=T[2]*Math.PI/180,H=Math.cos(I),U=Math.sin(I),F=Math.cos(D),Z=Math.sin(D),W=Math.cos(k),G=Math.sin(k),X=H*W,ee=H*G,Y=U*W,$=U*G;return P[0]=F*W,P[1]=-F*G,P[2]=Z,P[4]=ee+Y*Z,P[5]=X-$*Z,P[6]=-U*F,P[8]=$-X*Z,P[9]=Y+ee*Z,P[10]=H*F,P[12]=0,P[13]=0,P[14]=0,P[3]=0,P[7]=0,P[11]=0,P[15]=1,P}function S(T,P,I,D){return T>=D[0]&&T<=D[3]&&P>=D[1]&&P<=D[4]&&I>=D[2]&&I<=D[5]}function M(T){let P=2/T.cropSize[0],I=2/T.cropSize[1],D=2/T.cropSize[2],k=A(T.cropRotation);return{invRadiusX:P,invRadiusY:I,invRadiusZ:D,cropCenter:T.cropCenter,invRotationMatrix:k}}function C(T,P,I,D){let k=(T-D.cropCenter[0])*D.invRadiusX,H=(P-D.cropCenter[1])*D.invRadiusY,U=(I-D.cropCenter[2])*D.invRadiusZ;return k*k+H*H+U*U<=1}e.onmessage=T=>{if(T.data.getCroppedIndexes){let P=new Uint32Array(x(new Float32Array(T.data.positions),T.data.crops)).buffer;e.postMessage({outOfBoundsIndexes:P},[P])}else if(T.data.positions)d=T.data.positions,p=new Float32Array(d),g=T.data.meshMatrixWorlds,m=T.data.cropsArray,f=T.data.meshIndexIntervals,y(g,m,f),e.postMessage({sortSetupComplete:!0});else if(T.data.sort||T.data.newMatrixWorlds||T.data.newCropsArray)(T.data.newMatrixWorlds||T.data.newCropsArray)&&(m=T.data.newCropsArray||m,g=T.data.newMatrixWorlds||g,y(g,m,f)),v(T.data.sort.view,T.data.sort.cameraPosition);else if(T.data.init){u=T.data.init.Constants,i=T.data.init.splatCount;let P=u.BytesPerInt,I=u.BytesPerFloat*3,D=new Uint8Array(T.data.init.sorterWasmBytes),k=P+I,H=i*k,U=i*u.BytesPerInt*2+u.DepthMapRange*u.BytesPerInt*2,F=u.MemoryPageSize*32,Z=H+U+F,W=Math.floor(Z/u.MemoryPageSize)+1,G={module:{},env:{memory:new WebAssembly.Memory({initial:W*2,maximum:W*3,shared:!0})}};WebAssembly.compile(D).then(X=>WebAssembly.instantiate(X,G)).then(X=>{t=X,s=0,a=i*P,n=a+i*I,h=n+16*u.BytesPerFloat*2,o=h+i*u.BytesPerInt,l=o+u.DepthMapRange*u.BytesPerInt,c=G.env.memory.buffer,e.postMessage({sortSetupPhase1Complete:!0})})}}}function RX(e){let t=new Worker(URL.createObjectURL(new Blob(["(",OX.toString(),")(self)"],{type:"application/javascript"}))),i=atob(IX),r=new Uint8Array(i.length);for(let s=0;s<i.length;s++)r[s]=i.charCodeAt(s);return t.postMessage({init:{sorterWasmBytes:r.buffer,splatCount:e,Constants:{BytesPerFloat:za.BytesPerFloat,BytesPerInt:za.BytesPerInt,DepthMapRange:za.DepthMapRange,MemoryPageSize:za.MemoryPageSize}}}),t}var Pp=function(){let e=new Float32Array(1),t=new Int32Array(e.buffer);return function(i){return e[0]=i,t[0]}}(),LX=function(e,t,i,r){return e+(t<<8)+(i<<16)+(r<<24)},F0=new j;function Q8(e){let t=!1;return e.scene.objects.traverse((i,r)=>{if(r.visible===!1)return!0;r.type==="Splat"&&(t=!0)}),t}var rc=class extends si{constructor(e,t,i,r,s=!1,a=1,n,o){super(i,r),this.splatCount=t,this.meshIndexIntervals=n,this.meshMatrixWorlds=o,this.splatBuffers=e,this.geometry=i,this.material=r,this.splatDataTextures=null,this.halfPrecisionCovariancesOnGPU=s,this.devicePixelRatio=a,this.resetLocalSplatDataAndTexturesFromSplatBuffer()}static buildMesh(e,t,i=!1,r=1,s,a){let n=rc.buildGeomtery(t),o=rc.buildMaterial(s);return new rc(e,t,n,o,i,r,s,a)}static buildMaterial(e){let t=`
            precision highp float;
            #include <common>

            attribute uint splatIndex;

            uniform highp sampler2D covariancesTexture;
            uniform highp usampler2D centersColorsTexture;
            uniform vec2 focal;
            uniform vec2 viewport;
            uniform vec2 basisViewport;
            uniform vec2 covariancesTextureSize;
            uniform vec2 centersColorsTextureSize;
						uniform highp sampler2D meshMatrixWorldsTexture;
						uniform uint meshIndexIntervals[257];
						uniform float orthoZoom;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;

            const vec4 encodeNorm4 = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);
            const uvec4 mask4 = uvec4(uint(0x000000FF), uint(0x0000FF00), uint(0x00FF0000), uint(0xFF000000));
            const uvec4 shift4 = uvec4(0, 8, 16, 24);
            vec4 uintToRGBAVec (uint u) {
               uvec4 urgba = mask4 & u;
               urgba = urgba >> shift4;
               vec4 rgba = vec4(urgba) * encodeNorm4;
               return rgba;
            }

            vec2 getDataUV(in int stride, in int offset, in vec2 dimensions) {
                vec2 samplerUV = vec2(0.0, 0.0);
                float d = float(splatIndex * uint(stride) + uint(offset)) / dimensions.x;
                samplerUV.y = float(floor(d)) / dimensions.y;
                samplerUV.x = fract(d);
                return samplerUV;
            }

            void main () {
                uvec4 sampledCenterColor = texture(centersColorsTexture, getDataUV(1, 0, centersColorsTextureSize));
                vec3 splatCenter = uintBitsToFloat(uvec3(sampledCenterColor.gba));
                vColor = uintToRGBAVec(sampledCenterColor.r);

                vPosition = position.xy * 2.0;

								uint meshIndex;
								for (int i = 1; i < 257; i++) {
									if (splatIndex < meshIndexIntervals[i]) {
										meshIndex = uint(i - 1);
										break;
									}
								}

								float strideMulmeshIndex = float(4u*meshIndex);
								float meshMatrixWorldsTextureLength = float(256*4);

								mat4 modelMat = mat4(
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+0.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+1.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+2.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+3.0)/meshMatrixWorldsTextureLength, 0))
								);
								mat4 modelViewMat = viewMatrix * modelMat;
								vec4 viewCenter = modelViewMat * vec4(splatCenter, 1.0); 
                vec4 clipCenter = projectionMatrix * viewCenter;

                vec2 sampledCovarianceA = texture(covariancesTexture, getDataUV(3, 0, covariancesTextureSize)).rg;
                vec2 sampledCovarianceB = texture(covariancesTexture, getDataUV(3, 1, covariancesTextureSize)).rg;
                vec2 sampledCovarianceC = texture(covariancesTexture, getDataUV(3, 2, covariancesTextureSize)).rg;

                vec3 cov3D_M11_M12_M13 = vec3(sampledCovarianceA.rg, sampledCovarianceB.r);
                vec3 cov3D_M22_M23_M33 = vec3(sampledCovarianceB.g, sampledCovarianceC.rg);

                // Compute the 2D covariance matrix from the upper-right portion of the 3D covariance matrix
                mat3 Vrk = mat3(
                    cov3D_M11_M12_M13.x, cov3D_M11_M12_M13.y, cov3D_M11_M12_M13.z,
                    cov3D_M11_M12_M13.y, cov3D_M22_M23_M33.x, cov3D_M22_M23_M33.y,
                    cov3D_M11_M12_M13.z, cov3D_M22_M23_M33.y, cov3D_M22_M23_M33.z
                );
                float s = 1.0 / (viewCenter.z * viewCenter.z);

                mat3 W = transpose(mat3(modelViewMat));
                mat3 T = orthoZoom > 0.0 ? W : W * mat3(
									focal.x / viewCenter.z, 0., -(focal.x * viewCenter.x) * s,
									0., focal.y / viewCenter.z, -(focal.y * viewCenter.y) * s,
									0., 0., 0.
								);
                mat3 cov2Dm = transpose(T) * Vrk * T;
                cov2Dm[0][0] += 0.3;
                cov2Dm[1][1] += 0.3;

                // We are interested in the upper-left 2x2 portion of the projected 3D covariance matrix because
                // we only care about the X and Y values. We want the X-diagonal, cov2Dm[0][0],
                // the Y-diagonal, cov2Dm[1][1], and the correlation between the two cov2Dm[0][1]. We don't
                // need cov2Dm[1][0] because it is a symetric matrix.
                vec3 cov2Dv = vec3(cov2Dm[0][0], cov2Dm[0][1], cov2Dm[1][1]);

                vec3 ndcCenter = clipCenter.xyz / clipCenter.w;

                // We now need to solve for the eigen-values and eigen vectors of the 2D covariance matrix
                // so that we can determine the 2D basis for the splat. This is done using the method described
                // here: https://people.math.harvard.edu/~knill/teaching/math21b2004/exhibits/2dmatrices/index.html
                //
                // This is a different approach than in the original work at INRIA. In that work they compute the
                // max extents of the 2D covariance matrix in screen space to form an axis aligned bounding rectangle
                // which forms the geometry that is actually rasterized. They then use the inverse 2D covariance
                // matrix (called 'conic') to determine fragment opacity.
                float a = cov2Dv.x;
                float d = cov2Dv.z;
                float b = cov2Dv.y;
                float D = a * d - b * b;
                float trace = a + d;
                float traceOver2 = 0.5 * trace;
                float term2 = sqrt(trace * trace / 4.0 - D);
                float eigenValue1 = traceOver2 + term2;
								float eigenValue2 = max(traceOver2 - term2, 0.00); // prevent negative eigen value

                const float maxSplatSize = 1024.0;
                vec2 eigenVector1 = normalize(vec2(b, eigenValue1 - a));
                // since the eigen vectors are orthogonal, we derive the second one from the first
                vec2 eigenVector2 = vec2(eigenVector1.y, -eigenVector1.x);
                vec2 basisVector1 = eigenVector1 * min(sqrt(2.0 * eigenValue1), maxSplatSize);
                vec2 basisVector2 = eigenVector2 * min(sqrt(2.0 * eigenValue2), maxSplatSize);

                vec2 ndcOffset = vec2(vPosition.x * basisVector1 + vPosition.y * basisVector2) * basisViewport;

								if (orthoZoom > 0.0) {
									ndcOffset *= orthoZoom;
								}

                gl_Position = vec4(ndcCenter.xy + ndcOffset, ndcCenter.z, 1.0);
            }`,i=`
            precision highp float;
            #include <common>

            uniform vec3 debugColor;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;
						layout(location = 1) out vec4 gVelocity; 

            void main () {
                // compute the negative squared distance from the center of the splat to the
                // current fragment in the splat's local space.
                float A = -dot(vPosition, vPosition);
                if (A < -4.0) discard;
                vec3 color = vColor.rgb;
                A = exp(A) * vColor.a;
                gl_FragColor = vec4(color.rgb, A);
								gVelocity = vec4(0.0); // so it is ignored by TAA
            }`,r={covariancesTexture:{type:"t",value:null},centersColorsTexture:{type:"t",value:null},meshIndexIntervals:{value:e},meshMatrixWorldsTexture:{type:"t",value:null},focal:{type:"v2",value:new j},viewport:{type:"v2",value:new j},basisViewport:{type:"v2",value:new j},debugColor:{type:"v3",value:new Je},covariancesTextureSize:{type:"v2",value:new j(1024,1024)},centersColorsTextureSize:{type:"v2",value:new j(1024,1024)},orthoZoom:{type:"f",value:-1}};return new It({uniforms:r,vertexShader:t,fragmentShader:i,transparent:!0,alphaTest:1,blending:Cn,depthTest:!0,depthWrite:!1,side:f1})}static buildGeomtery(e){let t=new Ge;t.setIndex([0,1,2,0,2,3]);let i=new Float32Array(4*3),r=new ot(i,3);t.setAttribute("position",r),r.setXYZ(0,-1,-1,0),r.setXYZ(1,-1,1,0),r.setXYZ(2,1,1,0),r.setXYZ(3,1,-1,0),r.needsUpdate=!0;let s=new Nv().copy(t),a=new Uint32Array(e),n=new L2(a,1,!1);return n.setUsage(u_),s.setAttribute("splatIndex",n),s.instanceCount=e,s}resetLocalSplatDataAndTexturesFromSplatBuffer(){this.updateLocalSplatDataFromSplatBuffer(),this.allocateAndStoreLocalSplatDataInTextures()}updateLocalSplatDataFromSplatBuffer(){this.splatBuffers.forEach(r=>r.buildPreComputedBuffers()),this.covariances=new Float32Array(this.splatCount*6),this.colors=new Uint8Array(this.splatCount*4),this.centers=new Float32Array(this.splatCount*3);let e=0,t=0,i=0;for(let r of this.splatBuffers){let s=r.nsplats;this.colors.subarray(e,e+s*4).set(r.colorsA),e+=s*4,this.centers.subarray(t,t+s*3).set(r.decoded.xyz.denormDequant().data),t+=s*3,this.covariances.subarray(i,i+s*6).set(new Float32Array(r.precomputedCovarianceBufferData)),i+=s*6}}allocateAndStoreLocalSplatDataInTextures(){let e=this.splatCount,t=new j(4096,1024);for(;t.x*t.y*2<e*6;)t.y*=2;let i=new j(4096,1024);for(;i.x*i.y*4<e*4;)i.y*=2;let r,s;if(this.halfPrecisionCovariancesOnGPU){s=new Uint16Array(t.x*t.y*2);for(let c=0;c<this.covariances.length;c++)s[c]=jP.toHalfFloat(this.covariances[c]);r=new or(s,t.x,t.y,lc,Ks)}else s=new Float32Array(t.x*t.y*2),s.set(this.covariances),r=new or(s,t.x,t.y,lc,_i);r.needsUpdate=!0,this.material.uniforms.covariancesTexture.value=r,this.material.uniforms.covariancesTextureSize.value.copy(t);let a=new Uint32Array(i.x*i.y*4);for(let c=0;c<e;c++){let d=c*4,u=c*3,p=c*4;a[p]=LX(this.colors[d],this.colors[d+1],this.colors[d+2],this.colors[d+3]),a[p+1]=Pp(this.centers[u]),a[p+2]=Pp(this.centers[u+1]),a[p+3]=Pp(this.centers[u+2])}let n=new or(a,i.x,i.y,rv,Hs);n.internalFormat="RGBA32UI",n.needsUpdate=!0,this.material.uniforms.centersColorsTexture.value=n,this.material.uniforms.centersColorsTextureSize.value.copy(i);let o=256*4,l=new Float32Array(256*16);for(let c=0;c<this.meshMatrixWorlds.length;c++)l.set(this.meshMatrixWorlds[c].elements,c*16);let h=new or(l,o,1,Wi,_i);h.needsUpdate=!0,this.material.uniforms.meshMatrixWorldsTexture.value=h,this.material.uniformsNeedUpdate=!0,this.splatDataTextures={covariances:{data:s,texture:r,size:t},centerColors:{data:a,texture:n,size:i},meshMatrixWorlds:{data:l,texture:h}}}updateIndexes(e){let t=this.geometry;t.attributes.splatIndex.set(e),t.attributes.splatIndex.needsUpdate=!0,t.instanceCount=e.length}updateUniforms(e,t,i,r){this.splatCount>0&&(F0.set(e.x*this.devicePixelRatio,e.y*this.devicePixelRatio),this.material.uniforms.viewport.value.copy(F0),this.material.uniforms.basisViewport.value.set(2/F0.x,2/F0.y),this.material.uniforms.focal.value.set(t,i),this.material.uniforms.orthoZoom.value=r,this.material.uniformsNeedUpdate=!0)}getSplatDataTextures(){return this.splatDataTextures}getSplatCount(){return this.splatCount}getCenters(){return this.centers}getColors(){return this.colors}getCovariances(){return this.covariances}dispose(){this.geometry.dispose(),this.material.dispose(),this.splatDataTextures&&(this.splatDataTextures.covariances.texture.dispose(),this.splatDataTextures.centerColors.texture.dispose(),this.splatDataTextures.meshMatrixWorlds.texture.dispose()),this.removeFromParent()}},iw,BX=new Promise(e=>{iw=e}),Z8=!1,k0;function zX(){if(Z8)return;if(k0)return k0;async function e(){let t=await Ya(()=>import("./C3PBfRjK.js"),[],import.meta.url);iw(t),Z8=!0}return k0=e(),k0}var rw;BX.then(e=>rw=e);var FX=class{constructor(e={}){gn(this,"updateView",function(){let t=new we,i=[],r=new E(0,0,-1),s=new E(0,0,-1),a=new E,n=new E;return function(o=!1,l){let h=this.updateMatrixWorldsInWorkerIfNeeded(),c=this.cropsChanged();if(!o){s.set(0,0,-1).applyQuaternion(l.quaternion);let u=!1,p=!1;if(s.dot(r)<=.95&&(u=!0),n.copy(l.position).sub(a).length()>=1&&(p=!0),!u&&!p&&!h&&!c&&!this.needsInitialRender)return}this.needsInitialRender=!1,a.copy(l.position),r.copy(s),t.copy(l.matrixWorld).invert(),t.premultiply(this.dummyPerspectiveMatrix),i[0]=l.position.x,i[1]=l.position.y,i[2]=l.position.z;let d={sort:{view:t.elements,cameraPosition:i,splatRenderCount:this.splatRenderCount,splatSortCount:this.splatRenderCount},...h?{newMatrixWorlds:this.meshMatrixWorlds}:{},...c?{newCropsArray:this.cropsArray}:{}};this.sortRunning?this.queuedMessage=d:(this.queuedMessage=null,this.sortRunning=!0,this.sortWorker.postMessage(d))}}()),this.scene=e.scene,this.currentPage=null,this.devicePixelRatio=window.devicePixelRatio,this.sortWorker=null,this.splatRenderCount=0,this.splatSortCount=0,this.splatMesh=null,this.sortRunning=!1,this.meshMatrixWorlds=null,this.meshMatrixWorldsOld=null,this.cropsArray=null,this.splatEntries=null,this.queuedMessage=null,this.needsInitialRender=!0,this.dummyPerspectiveMatrix=new we().makePerspective(-1,1,-1,1,.1,1e3)}updateSplatMeshUniforms(e,t){let i=new j;this.splatMesh!==null&&this.splatMesh.getSplatCount()>0&&(e.getSize(i),this.cameraFocalLengthX=t.projectionMatrix.elements[0]*this.devicePixelRatio*i.x*.45,this.cameraFocalLengthY=t.projectionMatrix.elements[5]*this.devicePixelRatio*i.y*.45,this.splatMesh.updateUniforms(i,this.cameraFocalLengthX,this.cameraFocalLengthY,t.isPerspectiveCamera?-1:t.zoom*this.devicePixelRatio))}loadSplat(e={}){this.activePage=this.scene.activePage,e.position&&(e.position=new E().fromArray(e.position)),e.orientation&&(e.orientation=new lt().fromArray(e.orientation)),e.halfPrecisionCovariances=!!e.halfPrecisionCovariances;let t=[];if(this.splatEntries=t,this.activePage.traverseVisibleEntity(a=>{a.data.type==="Splat"&&t.push(a)}),this.splatMesh&&this.splatMesh.dispose(),t.length===0)return this.splatMesh=null,!1;this.meshMatrixWorlds=t.map(a=>a.matrixWorld),this.meshMatrixWorldsOld=t.map(a=>a.matrixWorld.clone()),this.cropsArray=t.map(a=>a.data.crops.map(n=>n.data));let i=t.map(a=>new rw.GSplineBuffer(new Uint8Array(a.data.buffer).buffer)),r=0,s=[0];for(let a of i)r+=a.getSplatCount(),s.push(r);return this.setupSplatMesh(i,r,e.position,e.orientation,e.halfPrecisionCovariances,this.devicePixelRatio,s,this.meshMatrixWorlds),this.setupSortWorker(r),!0}updateMatrixWorldsInWorkerIfNeeded(){let e=this.splatDataTextures.meshMatrixWorlds.data;for(let t=0;t<this.meshMatrixWorlds.length;t++)e.set(this.meshMatrixWorlds[t].elements,t*16);return this.splatDataTextures.meshMatrixWorlds.texture.needsUpdate=!0,this.meshMatrixWorlds.every((t,i)=>t.equals(this.meshMatrixWorldsOld[i]))?!1:(this.meshMatrixWorldsOld=this.meshMatrixWorlds.map(t=>t.clone()),!0)}cropsChanged(){let e=!1;return this.splatEntries.forEach((t,i)=>{var r;t.data.crops.forEach((s,a)=>{this.cropsArray[i][a]===void 0?(e=!0,this.cropsArray[i][a]=s.data):Object.entries(s.data).forEach(([n,o])=>{var l;Array.isArray(o)&&o.some((h,c)=>h!==this.cropsArray[i][a][n][c])?(e=!0,this.cropsArray[i][a][n]=o):o!==((l=this.cropsArray[i][a])==null?void 0:l[n])&&(e=!0,this.cropsArray[i][a][n]=o)})}),t.data.crops.length!==((r=this.cropsArray[i])==null?void 0:r.length)&&(this.cropsArray[i].length=t.data.crops.length,e=!0)}),e}setupSplatMesh(e,t,i=new E,r=new lt,s=!1,a=1,n,o){this.splatMesh=rc.buildMesh(e,t,s,a,n,o),this.splatMesh.position.copy(i),this.splatMesh.quaternion.copy(r),this.splatMesh.frustumCulled=!1,this.splatMesh.renderOrder=99999,this.splatRenderCount=t,this.splatMesh.onBeforeRender=(l,h,c)=>this.update(l,c)}setupSortWorker(e){this.sortWorker=RX(e),this.sortWorker.onmessage=t=>{var i;t.data.sortDone?(this.sortRunning=!1,(i=this.splatMesh)==null||i.updateIndexes(new Uint32Array(t.data.indexesBuffer)),this.lastSortTime=t.data.sortTime,this.queuedMessage&&(this.sortWorker.postMessage(this.queuedMessage),this.queuedMessage=null)):t.data.sortCanceled?this.sortRunning=!1:t.data.sortSetupPhase1Complete?this.sortWorker.postMessage({positions:this.splatMesh.getCenters().buffer,meshMatrixWorlds:this.splatMesh.meshMatrixWorlds,meshIndexIntervals:this.splatMesh.meshIndexIntervals,cropsArray:this.cropsArray}):t.data.sortSetupComplete&&(this.splatDataTextures=this.splatMesh.getSplatDataTextures(),this.scene.activePage.add(this.splatMesh),this.needsInitialRender=!0)}}update(e,t){this.splatMesh!==null&&(this.updateSplatMeshUniforms(e,t),this.updateView(!1,t))}getSplatMesh(){return this.splatMesh}},Uf=new Js;Uf.wireframe=!0;var K8=new E,b5=class extends ls{constructor(e,t){super(),this.data=e,this.sharedAssets=t,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.splatViewer=null,this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new DX,this.invisibleObjects=new Jo("jflkdsafjasdifjaslk",{...W3.defaultData,visible:!1,name:"buildin invisible"}),this.needsRecomputeInstances=!1,this.init(e,t),this.matrixAutoUpdate=!1,this.errorPage=new Gi("fdasfa",{...ul.defaultData,name:""},{shared:t,scene:this})}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=EX(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=MX(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(e){let t=e.identity.join("-"),i=this.entityIdentityToEntity[t];i&&(e.uuid=i.uuid),this.entityIdentityToEntity[t]=e,this.entityByUuid[e.uuid]=e}markPenumbraSizeDirty(){for(let e of this.children)e instanceof Gi&&(e.penumbraSizeArrayCache=null)}findInstance(e){return this.entityIdentityToEntity[e.join("-")]}get bgColor(){return this.activePage.bgColor}get postprocessing(){return this.activePage.data.postprocessing}getWithSortKey(e){let t=this.find(e);if(t===void 0)return;let i=[],r=t;for(;r!==this;){let s=r;r=r.parent;let a=r.children.indexOf(s);i.splice(0,0,a)}return{entity:t,sortKey:i}}getAllSorted(e){let t=[];for(let i of e){let r=this.getWithSortKey(i.id);r!==void 0&&t.push(r)}return t.sort((i,r)=>Py(i.sortKey,r.sortKey)),t.map(i=>i.entity)}nonExistOrDescendantOf(e,t){let i=this.find(e);if(i===void 0)return!0;for(;i;){if(i.uuid===t)return!0;i=i.parent}return!1}find(e){if(this.activePage&&this.activePage.personalCamera.parent){if(e==="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera")return this.activePage.personalCamera;if(e===Tl)return this.activePage.personalCamera}if(e===""||e===void 0)return;let t=this.entityByUuid[e];return t===void 0?this.getObjectByProperty("uuid",e):t}find2D(e){for(let t of this.children)if(t instanceof Gi&&t.uiScene){let i=t.uiScene.find(e);if(i)return i}}findScene2DfromObject2D(e){for(let t of this.children)if(t instanceof Gi&&t.uiScene&&t.uiScene.find(e))return t.uiScene}find2DInUIObjects(e){let t;return this.traverseEntity(i=>{t===void 0&&i instanceof p1&&(t=i.uiCanvas.find(e))}),t}traverse2D(e){for(let t of this.children)t instanceof Gi&&t.uiScene&&t.uiScene.traverse(e)}debugEnsureEntity(e){let t=this.find(e);t&&Array.isArray(t.identity)&&this.findInstance(t.identity)}addPendingExpandCloner(e){this.toExpandCloner.add(e)}addPendingUpdateCloner(e){this.toUpdateCloner.add(e)}markToExpandCloner(e){this.toExpandCloner.add(e),e.traverseEntityAncestors(t=>{this.toExpandCloner.add(t)})}doPendingExpandCloner(){this.toExpandCloner.forEach(e=>{e.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(e=>{var t;(t=e.cloner)==null||t.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(e){this.pendingCommands.push(e)}applyPendingCommands(){this.pendingCommands.forEach(e=>e()),this.pendingCommands.length=0}updateByLibOp(e,t){e.path.length===1&&e.path[0]==="components"&&e.type===1&&this.createChildrenObjects([{...e.data.asset,id:e.id}],this.invisibleObjects,t)}updateTreeByOp(e,t){var i;if(e.path.length===0&&e.type===7){let r=e.parent===null?this:this.find(e.parent);if(r===void 0)throw new Error("unexpected");let s=this.createObject(e.id,e.data,e.children,r,e.localIndex,t);s.updateVisible(this),s.resetBBoxNeedsUpdate(),Mr(s)&&Xs(s.parent)&&(s.invalidateUpstreamBooleanData(),s.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(r),this.markNeedsRecomputeInstancesForChildren(s),this.markToExpandCloner(s),this.markPenumbraSizeDirty(),s.updatePathSnapping()}else if(e.path.length===0&&e.type===8){let r=this.find(e.id);if(r===void 0)throw new Error("unexpected");this.markToExpandCloner(r),r.resetBBoxNeedsUpdate(),this.unregisterObject(r);let s=r.parent;this.markNeedsRecomputeInstancesForAncessors(s),this.markNeedsRecomputeInstancesForChildren(r),this.markPenumbraSizeDirty(),r.parent.remove(r),Xs(r.parent)&&(r.parent.invalidateUpstreamBooleanData(),r.parent.invalidateDownstreamBooleanData().recomputeBoolean()),Mr(r)&&(r.freeBooleanPointer(),s instanceof Nn&&s.invalidateDownstreamBooleanData().recomputeBoolean()),r instanceof g5&&r.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(r),this.pathConstraints.removeDependencies(r.uuid),r.updatePathSnapping()}else if(e.path.length===0&&e.type===9){let r=this.find(e.id);if(r===void 0)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(r);let s=r.parent;this.markNeedsRecomputeInstancesForAncessors(s),(i=r.cloner)==null||i.resetOnMove(),this.markToExpandCloner(r);let a=e.parent===null?this:this.find(e.parent);if(a===void 0)throw new Error("unexpected");a.add(r),this.markNeedsRecomputeInstancesForAncessors(a),this.markToExpandCloner(r),r.invalidateClonerTransform(r),r.updateVisible(this),r.resetBBoxNeedsUpdate(),this.markPenumbraSizeDirty();let n=e.localIndex;a.children.splice(n,0,a.children.pop()),Mr(r)&&(r.invalidateUpstreamBooleanData(),Xs(r.parent)?r.parent.invalidateDownstreamBooleanData().recomputeBoolean():s instanceof Nn&&s.invalidateDownstreamBooleanData().recomputeBoolean()),r.updatePathSnapping()}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}get playPage(){return this.find(this.data.publish.playPage)??this.errorPage}updatePage(e){var t;this.activePage&&this.activePage.onDeactive(),this.activePage=this.errorPage;for(let i of this.children)i instanceof Gi&&(i.visible=i.uuid===e,i.visible&&(this.activePage=i,this.activePage.onActive(this)));this.activePage!==((t=this.splatViewer)==null?void 0:t.activePage)&&this.reloadSplats()}updateEntityByOp(e,t,i,r){if(t.type===0){if(("overrides"in t.props||"component"in t.props)&&this.markNeedsRecomputeInstances(),"visible"in t.props&&this.markPenumbraSizeDirty(),t.path.includes("overrides")&&"states"in t.props){let{rest:a}=t.props;t={...t,props:a},this.markNeedsRecomputeInstances()}t.path[0]==="pathSnapping"&&t.props.pathId!==void 0&&this.pathConstraints.setConstraint(e,t.props.pathId)}let s=this.find(e);if(s)try{AX(s,t,i,{scene:this,shared:r}),s instanceof g1&&s.updateGeometryGroupsIfNeeded()}catch(a){}}updateEntity2DByOp(e,t,i,r,s,a=[]){e.updateEntityByOp(t,i,r,s),this.traverseEntity(n=>{(n instanceof p1||n instanceof Gi)&&(a.includes(n.frameId??"")||n.frameId===t)&&n.updateEntity2DByOp(t,i,r,s)})}get activeCamera(){return this.activePage.activeCamera}switchActiveCamera(e){this.activePage.switchActiveCamera(e)}isInvisibleObjects(e){return e===this.invisibleObjects||e.hasAnccestor(this.invisibleObjects)}init(e,t){let i=Object.entries(t.data.lib.components).map((r,s)=>({data:r[1].asset.data,children:r[1].asset.children,id:r[0],fi:s}));this.invisibleObjects.updateState(this.invisibleObjects.data,{scene:this,shared:t}),this.add(this.invisibleObjects),this.createChildrenObjects(i,this.invisibleObjects,t),this.createChildrenObjects(e.objects,this,t),this.updatePage(e.publish.playPage),this.activePage.switchToPlayCamera(),this.expandInstances(t,!0),this.traverseEntity(r=>{r instanceof v1&&r.updateUp()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(e){e.traverseEntity(t=>{(t.data.type==="Component"||t.data.type==="Instance")&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(e){Et.is(e)&&(e.data.type==="Component"&&this.markNeedsRecomputeInstances(),e.traverseAncestors(t=>{Et.is(t)&&t.data.type==="Component"&&this.markNeedsRecomputeInstances()}))}relativeizeInner(e,t,i,r,s,a,n){if(e){let o=r.find(e);o&&o!==r&&s.forInstancesRec(l=>{l.data=H2(l.data,h=>{let c=h.events.data(n.id),d=l.goUp(a);if(d){let u=[...Ty(d.identity),e].join("-"),p=this.entityIdentityToEntity[u];if(p){let f=p.uuid,g=Li.zoom(c,t);g[i]=f}}}).data})}}rewriteActions(e,t,i,r,s,a){e.forEach(n=>{n.data.type==="Transition"?this.relativeizeInner(n.data.object,[...t,n.id],"object",i,r,s,a):n.data.type==="Animation"?this.relativeizeInner(n.data.object,[...t,n.id],"object",i,r,s,a):n.data.type==="Conditional"&&(this.rewriteActions(n.data.ifActions,[...t,n.id,"ifActions"],i,r,s,a),this.rewriteActions(n.data.elseActions,[...t,n.id,"elseActions"],i,r,s,a))})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(e=>{if(e instanceof $o&&typeof e.identity=="string"&&e.data.type==="Component")return e.traverseEntity((t,i)=>{t.data.events.forEach(r=>{if(r.data.type==="GameControl"){let s=!1;if(t.forInstancesRec(a=>{a.data=H2(a.data,n=>{a.isInstanceRoot||(n.events.delete(r.id),s=!0)}).data}),s===!1)for(let a of Hc.list)this.rewriteActions(r.data.gameActions[a],["gameActions",a],e,t,i,r)}else r.data.type==="Conditional"?(r.data.condition.type==="Distance"?(this.relativeizeInner(r.data.condition.fromObject,["condition"],"fromObject",e,t,i,r),this.relativeizeInner(r.data.condition.toObject,["condition"],"toObject",e,t,i,r)):r.data.condition.type==="State"?this.relativeizeInner(r.data.condition.object,["condition"],"object",e,t,i,r):r.data.condition.type==="Comparison"&&(r.data.condition.lOperand.type==="Property"&&this.relativeizeInner(r.data.condition.lOperand.value[0],["condition","lOperand","value"],0,e,t,i,r),r.data.condition.rOperand.type==="Property"&&this.relativeizeInner(r.data.condition.rOperand.value[0],["condition","rOperand","value"],0,e,t,i,r)),this.rewriteActions(r.data.inActions,["inActions"],e,t,i,r),this.rewriteActions(r.data.outActions,["outActions"],e,t,i,r)):"actions"in r.data&&this.rewriteActions(r.data.actions,["actions"],e,t,i,r)})}),!0})}expandInstances(e,t,i){let r=new Set;this.traverseEntity(s=>{if(s instanceof $o&&s.isInstanceRoot)return s.expandInstanceChildren({scene:this,shared:e,pendingDeletes:r}),t||s.resetBBoxNeedsUpdate(),i&&s.traverseEntity(a=>{i.addClip(a)}),!0});for(let s of r)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(s),y5(s)}recomputeInstances(e,t){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(i=>{i instanceof $o&&i.isInstanceRoot&&(i.component=void 0)}),this.expandInstances(e,!1,t))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(e){e.traverseEntity(t=>{let i=typeof t.identity=="string"?t.identity:t.identity.join("-");this.entityIdentityToEntity[i]===t&&(delete this.entityByUuid[t.uuid],delete this.entityIdentityToEntity[i]),t.dispose()})}clearScene(){for(let e of this.children)Et.is(e)&&e.disposeRecursively();this.children.length=0}resetAfterClear(e,t){this.init(e,t)}raycast(e){return this.raycast1(e,!1)}raycast1(e,t){let i=[],r=s=>{for(let a of s.children){let n=a.cloner;if(Et.is(a)&&!a.raycastLock&&(a.visible||n!=null&&n.object.data.visible))if(t===!0&&a.isInstanceRoot){let o=[];if(e.intersectObject(a,!0,o),o.length){let l=o[0];l.object=a,l.point.applyMatrix4(l.object.matrixWorld);let h=a.matrixWorld.clone().invert();l.point.applyMatrix4(h),i.push(l)}}else(Mr(a)||Cf(a)&&this.enableHelpers&&a.objectHelper.visible)&&(e.intersectObject(a,!1,i),kf(a,e,i)),r(a)}};return r(this.activePage),i}raycastWithClones(e){let t=[],i=r=>{for(let s of r.children){let a=s.cloner;Et.is(s)&&(s.visible||a!=null&&a.object.data.visible)&&((Mr(s)||Cf(s)&&this.enableHelpers&&s.objectHelper.visible)&&(e.intersectObject(s,!1,t),kf(s,e,t,!0)),i(s))}};return i(this),t}forEachEntity(e){for(let t of this.children)Et.is(t)&&e(t)}traverseConcreteEntity(e){for(let t of this.children)Et.is(t)&&t.isConcreteEntity&&t.traverseEntity(e)}traverseEntity(e){for(let t of this.children)Et.is(t)&&t.traverseEntity(e)}updateFont(e,t){this.traverseEntity(i=>{if(i instanceof g1&&i.data.type==="Mesh"&&(i.data.geometry.type==="TextGeometry"||i.data.geometry.type==="InputGeometry")&&i.data.geometry.font===e){let r=i.geometry,s=i.data.geometry;r.updateFont(e,t).then(()=>{r.update(s);let a=i.invalidateDownstreamBooleanData();Xs(a)&&a.recomputeBoolean()})}})}traverseObject(e){for(let t of this.children)J2.is(t)&&t.traverseObject(e)}traverseVisibleEntity(e){for(let t of this.children)Et.is(t)&&t.visible&&t.traverseVisibleEntity(e)}dispose(){this.clearScene()}createChildrenObjects(e,t,i){let r=0;for(let s of e)this.createObject(s.id,s.data,s.children,t,r,i),r+=1}registerObjectCreatedInLegacy(e){this.entityByUuid[e.uuid]=e}unregisterObject(e){delete this.entityByUuid[e.uuid];for(let t of e.children)this.unregisterObject(t)}createObject(e,t,i,r,s,a){var l;let n={scene:this,shared:a},o=x5(e,t,n);return o&&(this.entityByUuid[e]=o,r.add(o),r.children.splice(s,0,r.children.pop()),i.length>0&&(o.isInstanceRoot||this.createChildrenObjects(i,o,a)),o.updateState(t,n),o instanceof g1&&o.updateGeometryGroupsIfNeeded(),o.updateVisible(this),o.cloner&&this.toExpandCloner.add(o),(l=t.pathSnapping)!=null&&l.pathId&&this.pathConstraints.setConstraint(e,t.pathSnapping.pathId)),t.type==="Empty"&&t.animations&&o.traverseEntity(h=>{let c=h.dataPatched;if(h instanceof g1&&c.bones&&c.boneInverses){let d=c.bones.map(f=>this.find(f)),u=c.boneInverses.map(f=>new we().fromArray(f)),p=new a4(d,u);h.bind(p,h.bindMatrix)}else h.matrixAutoUpdate=!0}),o}getCenter(e){let t=[];for(let r=0,s=e.length;r<s;++r){let{id:a,recursive:n}=e[r],o=this.find(a),l=n?o.recursiveBBox:o.singleBBox;t.push(...l.vertices)}let i=new vi;return i.setFromPoints(t),i.getCenter(K8),K8}copyMatrixWorld(e,t){if(e===null){t.identity();return}let i=this.find(e);i?t.copy(i.matrixWorld):t.identity()}copyParentMatrixWorld(e,t){var r;if(e===null){t.identity();return}let i=(r=this.find(e))==null?void 0:r.parent;i?t.copy(i.matrixWorld):t.identity()}traverseMaterial(e){this.traverseEntity(t=>{if(t instanceof D1)if(Array.isArray(t.material))for(let i=0;i<t.material.length;i++)t.material[i]instanceof Wa&&e(t.material[i]);else t.material instanceof Wa&&e(t.material)})}updateViewPlaneSize(e,t,i=!1){this.traverseConcreteEntity(r=>{r instanceof v1&&r.setViewplaneSize(e,t,i)})}initializeSplatViewer(){this.splatViewer=new FX({scene:this}),this.reloadSplats()}reloadSplats(){var e;(e=this.splatViewer)==null||e.loadSplat()}},sc=(e,t)=>{let i=t.x-e.x,r=t.y-e.y;return Math.sqrt(i*i+r*r)},kX=(e,t)=>{let i=t.x-e.x,r=t.y-e.y;return NX(Math.atan2(r,i))},UX=(e,t,i)=>{let r={x:0,y:0};return i=Nf(i),r.x=e.x-t*Math.cos(i),r.y=e.y-t*Math.sin(i),r},Nf=e=>e*(Math.PI/180),NX=e=>e*(180/Math.PI),VX=e=>isNaN(e.buttons)?e.pressure!==0:e.buttons!==0,Dp=new Map,J8=e=>{Dp.has(e)&&clearTimeout(Dp.get(e)),Dp.set(e,setTimeout(e,100))},nd=(e,t,i)=>{let r=t.split(/[ ,]+/g),s;for(let a=0;a<r.length;a+=1)s=r[a],e.addEventListener?e.addEventListener(s,i,!1):e.attachEvent&&e.attachEvent(s,i)},$8=(e,t,i)=>{let r=t.split(/[ ,]+/g),s;for(let a=0;a<r.length;a+=1)s=r[a],e.removeEventListener?e.removeEventListener(s,i):e.detachEvent&&e.detachEvent(s,i)},sw=e=>(e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e),e7=()=>{if(typeof window>"u")return;let e=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:e,y:t}},Vf=(e,t)=>{t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},w5=(e,t,i)=>{let r=aw(e);for(let s in r)if(r.hasOwnProperty(s))if(typeof t=="string")r[s]=t+" "+i;else{let a="";for(let n=0,o=t.length;n<o;n+=1)a+=t[n]+" "+i+", ";r[s]=a.slice(0,-2)}return r},jX=(e,t)=>{let i=aw(e);for(let r in i)i.hasOwnProperty(r)&&(i[r]=t);return i},aw=e=>{let t={};return t[e]="",["webkit","Moz","o"].forEach(function(i){t[i+e.charAt(0).toUpperCase()+e.slice(1)]=""}),t},Ip=(e,t)=>{for(let i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},GX=(e,t)=>{let i={};for(let r in e)e.hasOwnProperty(r)&&t.hasOwnProperty(r)?i[r]=t[r]:e.hasOwnProperty(r)&&(i[r]=e[r]);return i},jf=(e,t)=>{if(e.length)for(let i=0,r=e.length;i<r;i+=1)t(e[i]);else t(e)},HX=(e,t,i)=>({x:Math.min(Math.max(e.x,t.x-i),t.x+i),y:Math.min(Math.max(e.y,t.y-i),t.y+i)});typeof window<"u"&&(nw="ontouchstart"in window,ow=!!window.PointerEvent,lw=!!window.MSPointerEvent);var nw,ow,lw,s2={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},No,th={};ow?No=s2.pointer:lw?No=s2.MSPointer:nw?(No=s2.touch,th=s2.mouse):No=s2.mouse;function qn(){}qn.prototype.on=function(e,t){var i=this,r=e.split(/[ ,]+/g),s;i._handlers_=i._handlers_||{};for(var a=0;a<r.length;a+=1)s=r[a],i._handlers_[s]=i._handlers_[s]||[],i._handlers_[s].push(t);return i};qn.prototype.off=function(e,t){var i=this;return i._handlers_=i._handlers_||{},e===void 0?i._handlers_={}:t===void 0?i._handlers_[e]=null:i._handlers_[e]&&i._handlers_[e].indexOf(t)>=0&&i._handlers_[e].splice(i._handlers_[e].indexOf(t),1),i};qn.prototype.trigger=function(e,t){var i=this,r=e.split(/[ ,]+/g),s;i._handlers_=i._handlers_||{};for(var a=0;a<r.length;a+=1)s=r[a],i._handlers_[s]&&i._handlers_[s].length&&i._handlers_[s].forEach(function(n){n.call(i,{type:s,target:i},t)})};qn.prototype.config=function(e){var t=this;t.options=t.defaults||{},e&&(t.options=GX(t.options,e))};qn.prototype.bindEvt=function(e,t){var i=this;return i._domHandlers_=i._domHandlers_||{},i._domHandlers_[t]=function(){typeof i["on"+t]=="function"?i["on"+t].apply(i,arguments):""+t},nd(e,No[t],i._domHandlers_[t]),th[t]&&nd(e,th[t],i._domHandlers_[t]),i};qn.prototype.unbindEvt=function(e,t){var i=this;return i._domHandlers_=i._domHandlers_||{},$8(e,No[t],i._domHandlers_[t]),th[t]&&$8(e,th[t],i._domHandlers_[t]),delete i._domHandlers_[t],this};var S5=qn;function Fi(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=Fi.id,Fi.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}Fi.prototype=new S5;Fi.constructor=Fi;Fi.id=0;Fi.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};Fi.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=jX("borderRadius","50%"),i=w5("transition","opacity",e),r={};return r.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},r.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},r.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},Ip(r.el,i),this.options.shape==="circle"&&Ip(r.back,t),Ip(r.front,t),this.applyStyles(r),this};Fi.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var i in e[t])this.ui[t].style[i]=e[t][i];return this};Fi.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};Fi.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};Fi.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};Fi.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),typeof e=="function"&&e.call(this)},t.options.fadeTime)),t};Fi.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var i=t.options.mode==="dynamic"?"none":"block";t.ui.el.style.display=i,typeof e=="function"&&e.call(t),t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick){let i=t.options.restJoystick,r={};r.x=i===!0||i.x!==!1?0:t.instance.frontPosition.x,r.y=i===!0||i.y!==!1?0:t.instance.frontPosition.y,t.setPosition(e,r)}return t};Fi.prototype.setPosition=function(e,t){var i=this;i.frontPosition={x:t.x,y:t.y};var r=i.options.fadeTime+"ms",s={};s.front=w5("transition",["top","left"],r);var a={front:{}};a.front={left:i.frontPosition.x+"px",top:i.frontPosition.y+"px"},i.applyStyles(s),i.applyStyles(a),i.restTimeout=setTimeout(function(){typeof e=="function"&&e.call(i),i.restCallback()},i.options.fadeTime)};Fi.prototype.restCallback=function(){var e=this,t={};t.front=w5("transition","none",""),e.applyStyles(t),e.trigger("rested",e.instance)};Fi.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};Fi.prototype.computeDirection=function(e){var t=e.angle.radian,i=Math.PI/4,r=Math.PI/2,s,a,n;if(t>i&&t<i*3&&!e.lockX?s="up":t>-i&&t<=i&&!e.lockY?s="left":t>-i*3&&t<=-i&&!e.lockX?s="down":e.lockY||(s="right"),e.lockY||(t>-r&&t<r?a="left":a="right"),e.lockX||(t>0?n="up":n="down"),e.force>this.options.threshold){var o={},l;for(l in this.direction)this.direction.hasOwnProperty(l)&&(o[l]=this.direction[l]);var h={};this.direction={x:a,y:n,angle:s},e.direction=this.direction;for(l in o)o[l]===this.direction[l]&&(h[l]=!0);if(h.x&&h.y&&h.angle)return e;(!h.x||!h.y)&&this.trigger("plain",e),h.x||this.trigger("plain:"+a,e),h.y||this.trigger("plain:"+n,e),h.angle||this.trigger("dir dir:"+s,e)}else this.resetDirection();return e};var WX=Fi;function yi(e,t){var i=this;i.nipples=[],i.idles=[],i.actives=[],i.ids=[],i.pressureIntervals={},i.manager=e,i.id=yi.id,yi.id+=1,i.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},i.config(t),(i.options.mode==="static"||i.options.mode==="semi")&&(i.options.multitouch=!1),i.options.multitouch||(i.options.maxNumberOfNipples=1);let r=getComputedStyle(i.options.zone.parentElement);return r&&r.display==="flex"&&(i.parentIsFlex=!0),i.updateBox(),i.prepareNipples(),i.bindings(),i.begin(),i.nipples}yi.prototype=new S5;yi.constructor=yi;yi.id=0;yi.prototype.prepareNipples=function(){var e=this,t=e.nipples;t.on=e.on.bind(e),t.off=e.off.bind(e),t.options=e.options,t.destroy=e.destroy.bind(e),t.ids=e.ids,t.id=e.id,t.processOnMove=e.processOnMove.bind(e),t.processOnEnd=e.processOnEnd.bind(e),t.get=function(i){if(i===void 0)return t[0];for(var r=0,s=t.length;r<s;r+=1)if(t[r].identifier===i)return t[r];return!1}};yi.prototype.bindings=function(){var e=this;e.bindEvt(e.options.zone,"start"),e.options.zone.style.touchAction="none",e.options.zone.style.msTouchAction="none"};yi.prototype.begin=function(){var e=this,t=e.options;if(t.mode==="static"){var i=e.createNipple(t.position,e.manager.getIdentifier());i.add(),e.idles.push(i)}};yi.prototype.createNipple=function(e,t){var i=this,r=i.manager.scroll,s={},a=i.options,n={x:i.parentIsFlex?r.x:r.x+i.box.left,y:i.parentIsFlex?r.y:r.y+i.box.top};if(e.x&&e.y)s={x:e.x-n.x,y:e.y-n.y};else if(e.top||e.right||e.bottom||e.left){var o=document.createElement("DIV");o.style.display="hidden",o.style.top=e.top,o.style.right=e.right,o.style.bottom=e.bottom,o.style.left=e.left,o.style.position="absolute",a.zone.appendChild(o);var l=o.getBoundingClientRect();a.zone.removeChild(o),s=e,e={x:l.left+r.x,y:l.top+r.y}}var h=new WX(i,{color:a.color,size:a.size,threshold:a.threshold,fadeTime:a.fadeTime,dataOnly:a.dataOnly,restJoystick:a.restJoystick,restOpacity:a.restOpacity,mode:a.mode,identifier:t,position:e,zone:a.zone,frontPosition:{x:0,y:0},shape:a.shape});return a.dataOnly||(Vf(h.ui.el,s),Vf(h.ui.front,h.frontPosition)),i.nipples.push(h),i.trigger("added "+h.identifier+":added",h),i.manager.trigger("added "+h.identifier+":added",h),i.bindNipple(h),h};yi.prototype.updateBox=function(){var e=this;e.box=e.options.zone.getBoundingClientRect()};yi.prototype.bindNipple=function(e){var t=this,i,r=function(s,a){i=s.type+" "+a.id+":"+s.type,t.trigger(i,a)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",r),e.on("dir:up dir:right dir:down dir:left",r),e.on("plain:up plain:right plain:down plain:left",r)};yi.prototype.pressureFn=function(e,t,i){var r=this,s=0;clearInterval(r.pressureIntervals[i]),r.pressureIntervals[i]=setInterval((function(){var a=e.force||e.pressure||e.webkitForce||0;a!==s&&(t.trigger("pressure",a),r.trigger("pressure "+t.identifier+":pressure",a),s=a)}).bind(r),100)};yi.prototype.onstart=function(e){var t=this,i=t.options,r=e;e=sw(e),t.updateBox();var s=function(a){t.actives.length<i.maxNumberOfNipples?t.processOnStart(a):r.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach(function(n){if(Object.values(r.touches).findIndex(function(l){return l.identifier===n})<0){var o=[e[0]];o.identifier=n,t.processOnEnd(o)}}),t.actives.length<i.maxNumberOfNipples&&t.processOnStart(a))};return jf(e,s),t.manager.bindDocument(),!1};yi.prototype.processOnStart=function(e){var t=this,i=t.options,r,s=t.manager.getIdentifier(e),a=e.force||e.pressure||e.webkitForce||0,n={x:e.pageX,y:e.pageY},o=t.getOrCreate(s,n);o.identifier!==s&&t.manager.removeIdentifier(o.identifier),o.identifier=s;var l=function(c){c.trigger("start",c),t.trigger("start "+c.id+":start",c),c.show(),a>0&&t.pressureFn(e,c,c.identifier),t.processOnMove(e)};if((r=t.idles.indexOf(o))>=0&&t.idles.splice(r,1),t.actives.push(o),t.ids.push(o.identifier),i.mode!=="semi")l(o);else{var h=sc(n,o.position);if(h<=i.catchDistance)l(o);else{o.destroy(),t.processOnStart(e);return}}return o};yi.prototype.getOrCreate=function(e,t){var i=this,r=i.options,s;return/(semi|static)/.test(r.mode)?(s=i.idles[0],s?(i.idles.splice(0,1),s):r.mode==="semi"?i.createNipple(t,e):!1):(s=i.createNipple(t,e),s)};yi.prototype.processOnMove=function(e){var t=this,i=t.options,r=t.manager.getIdentifier(e),s=t.nipples.get(r),a=t.manager.scroll;if(!VX(e)){this.processOnEnd(e);return}if(!s){""+r,t.manager.removeIdentifier(r);return}if(i.dynamicPage){var n=s.el.getBoundingClientRect();s.position={x:a.x+n.left,y:a.y+n.top}}s.identifier=r;var o=s.options.size/2,l={x:e.pageX,y:e.pageY};i.lockX&&(l.y=s.position.y),i.lockY&&(l.x=s.position.x);var h=sc(l,s.position),c=kX(l,s.position),d=Nf(c),u=h/o,p={distance:h,position:l},f,g;if(s.options.shape==="circle"?(f=Math.min(h,o),g=UX(s.position,f,c)):(g=HX(l,s.position,o),f=sc(g,s.position)),i.follow){if(h>o){let x=l.x-g.x,w=l.y-g.y;s.position.x+=x,s.position.y+=w,s.el.style.top=s.position.y-(t.box.top+a.y)+"px",s.el.style.left=s.position.x-(t.box.left+a.x)+"px",h=sc(l,s.position)}}else l=g,h=f;var m=l.x-s.position.x,v=l.y-s.position.y;s.frontPosition={x:m,y:v},i.dataOnly||Vf(s.ui.front,s.frontPosition);var y={identifier:s.identifier,position:l,force:u,pressure:e.force||e.pressure||e.webkitForce||0,distance:h,angle:{radian:d,degree:c},vector:{x:m/o,y:-v/o},raw:p,instance:s,lockX:i.lockX,lockY:i.lockY};y=s.computeDirection(y),y.angle={radian:Nf(180-c),degree:180-c},s.trigger("move",y),t.trigger("move "+s.id+":move",y)};yi.prototype.processOnEnd=function(e){var t=this,i=t.options,r=t.manager.getIdentifier(e),s=t.nipples.get(r),a=t.manager.removeIdentifier(s.identifier);!s||(i.dataOnly||s.hide(function(){i.mode==="dynamic"&&(s.trigger("removed",s),t.trigger("removed "+s.id+":removed",s),t.manager.trigger("removed "+s.id+":removed",s),s.destroy())}),clearInterval(t.pressureIntervals[s.identifier]),s.resetDirection(),s.trigger("end",s),t.trigger("end "+s.id+":end",s),t.ids.indexOf(s.identifier)>=0&&t.ids.splice(t.ids.indexOf(s.identifier),1),t.actives.indexOf(s)>=0&&t.actives.splice(t.actives.indexOf(s),1),/(semi|static)/.test(i.mode)?t.idles.push(s):t.nipples.indexOf(s)>=0&&t.nipples.splice(t.nipples.indexOf(s),1),t.manager.unbindDocument(),/(semi|static)/.test(i.mode)&&(t.manager.ids[a.id]=a.identifier))};yi.prototype.onDestroyed=function(e,t){var i=this;i.nipples.indexOf(t)>=0&&i.nipples.splice(i.nipples.indexOf(t),1),i.actives.indexOf(t)>=0&&i.actives.splice(i.actives.indexOf(t),1),i.idles.indexOf(t)>=0&&i.idles.splice(i.idles.indexOf(t),1),i.ids.indexOf(t.identifier)>=0&&i.ids.splice(i.ids.indexOf(t.identifier),1),i.manager.removeIdentifier(t.identifier),i.manager.unbindDocument()};yi.prototype.destroy=function(){var e=this;e.unbindEvt(e.options.zone,"start"),e.nipples.forEach(function(i){i.destroy()});for(var t in e.pressureIntervals)e.pressureIntervals.hasOwnProperty(t)&&clearInterval(e.pressureIntervals[t]);e.trigger("destroyed",e.nipples),e.manager.unbindDocument(),e.off()};var qX=yi;function Ki(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=e7(),t.config(e),t.prepareCollections();var i=function(){var s;t.collections.forEach(function(a){a.forEach(function(n){s=n.el.getBoundingClientRect(),n.position={x:t.scroll.x+s.left,y:t.scroll.y+s.top}})})};if(typeof window>"u")return t.collections;nd(window,"resize",function(){J8(i)});var r=function(){t.scroll=e7()};return nd(window,"scroll",function(){J8(r)}),t.collections}Ki.prototype=new S5;Ki.constructor=Ki;Ki.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var i;return e.collections.every(function(r){return i=r.get(t),!i}),i}};Ki.prototype.create=function(e){return this.createCollection(e)};Ki.prototype.createCollection=function(e){var t=this,i=new qX(t,e);return t.bindCollection(i),t.collections.push(i),i};Ki.prototype.bindCollection=function(e){var t=this,i,r=function(s,a){i=s.type+" "+a.id+":"+s.type,t.trigger(i,a)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",r),e.on("dir:up dir:right dir:down dir:left",r),e.on("plain:up plain:right plain:down plain:left",r)};Ki.prototype.bindDocument=function(){var e=this;e.binded||(e.bindEvt(document,"move").bindEvt(document,"end"),e.binded=!0)};Ki.prototype.unbindDocument=function(e){var t=this;(!Object.keys(t.ids).length||e===!0)&&(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)};Ki.prototype.getIdentifier=function(e){var t;return e?(t=e.identifier===void 0?e.pointerId:e.identifier,t===void 0&&(t=this.latest||0)):t=this.index,this.ids[t]===void 0&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]};Ki.prototype.removeIdentifier=function(e){var t={};for(var i in this.ids)if(this.ids[i]===e){t.id=i,t.identifier=this.ids[i],delete this.ids[i];break}return t};Ki.prototype.onmove=function(e){var t=this;return t.onAny("move",e),!1};Ki.prototype.onend=function(e){var t=this;return t.onAny("end",e),!1};Ki.prototype.oncancel=function(e){var t=this;return t.onAny("end",e),!1};Ki.prototype.onAny=function(e,t){var i=this,r,s="processOn"+e.charAt(0).toUpperCase()+e.slice(1);t=sw(t);var a=function(o,l,h){h.ids.indexOf(l)>=0&&(h[s](o),o._found_=!0)},n=function(o){r=i.getIdentifier(o),jf(i.collections,a.bind(null,o,r)),o._found_||i.removeIdentifier(r)};return jf(t,n),!1};Ki.prototype.destroy=function(){var e=this;e.unbindDocument(!0),e.ids={},e.index=0,e.collections.forEach(function(t){t.destroy()}),e.off()};Ki.prototype.onDestroyed=function(e,t){var i=this;if(i.collections.indexOf(t)<0)return!1;i.collections.splice(i.collections.indexOf(t),1)};var YX=Ki,t7=new YX,XX={create:function(e){return t7.create(e)},factory:t7},hw=new Map,T2=new Map,Mn=class{constructor(e,t,i,r){this.data=t;let{audio:s,volume:a,delay:n,loop:o}=t;if(!s)throw new Error("Missing property");let l=typeof s=="string"?r.getAudio(s).src:s.data;this.audioPlayer=new y2({src:l,volume:a,delay:n,loop:o}),T2.has(i.uuid)?T2.get(i.uuid).push(this):T2.set(i.uuid,[this]),hw.set(e,this)}playByToggle(){this.data.toggle==="stop"?this.audioPlayer.status==="playing"?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):this.data.toggle==="pause"?this.audioPlayer.status==="playing"?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},Gf=class{constructor(e){this.data=e}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(e){let t=hw.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.audioPlayer[this.data.interaction](),this.disposeDelay()},this.data.delay)):t.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(e){let t=T2.get(e);!(t!=null&&t.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(i=>i.audioPlayer[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(i=>i.audioPlayer[this.data.interaction]()))}pauseAllAudios(){let e=[...T2.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(i=>{i.audioPlayer[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(i=>{i.audioPlayer[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},cw=class{constructor(e,t,i,r,s){if(this.data=t,this.shared=r,this.condition=s,t.interaction==="play")this.interaction=new Mn(e,t,i,r);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new Gf(t);else throw new Error("Missing property")}dispatchBasic(){if(Jt(this.shared,this.condition)===!1)return!1;this.interaction instanceof Mn?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(Jt(this.shared,this.condition)===!1)return!1;this.interaction instanceof Mn?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(e){if(Jt(this.shared,this.condition)===!1)return!1;this.interaction instanceof Mn&&(e==="start"?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}},dw=class{constructor(e,t,i,r){this.data=e,this.page=t,this.shared=i,this.condition=r,this.delay=0,this.emission=e.emission,e.delay!==void 0&&(this.delay=e.delay),this.particleSystem=this.page.scene.find(this.data.emitterObjectId)}toggleEmitting(){this.particleSystem.started&&!this.particleSystem.stopped?this.stop(this.delay):this.start(this.delay)}toggleFroze(){this.particleSystem.started&&!this.particleSystem.isFrozen?this.freeze(this.delay):this.unFreeze(this.delay)}start(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.start(0),this.clearDelay()},e);return}this.particleSystem.start()}stop(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.stop(0),this.clearDelay()},e);return}this.particleSystem.stop()}freeze(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.freeze(0),this.clearDelay()},e);return}this.particleSystem.froze()}unFreeze(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.unFreeze(0),this.clearDelay()},e);return}this.particleSystem.unFroze()}reset(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.reset(0),this.clearDelay()},e);return}this.particleSystem.reset()}reverseFromCurrent(){switch(this.emission){case"emitToggle":this.toggleEmitting();break;case"pauseToggle":this.toggleFroze();break}}dispatchBasic(){if(Jt(this.shared,this.condition)===!1||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"emitToggle":this.toggleEmitting();break;case"pause":this.freeze(this.delay);break;case"pauseToggle":this.toggleFroze();break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay);break}}dispatchConditional(){if(Jt(this.shared,this.condition)===!1||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay);break}}dispatchGameControl(e){if(Jt(this.shared,this.condition)===!1||!this.particleSystem)return!1;e==="start"?this.start(this.delay):this.stop(this.delay)}dispose(){!this.particleSystem||(this.particleSystem.reset(),this.clearDelay())}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}},QX="text/plain",ZX="us-ascii",i7=(e,t)=>t.some(i=>i instanceof RegExp?i.test(e):i===e),KX=(e,{stripHash:t})=>{let i=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(e);if(!i)throw new Error(`Invalid URL: ${e}`);let{type:r,data:s,hash:a}=i.groups,n=r.split(";");a=t?"":a;let o=!1;n[n.length-1]==="base64"&&(n.pop(),o=!0);let l=(n.shift()||"").toLowerCase(),h=[...n.map(c=>{let[d,u=""]=c.split("=").map(p=>p.trim());return d==="charset"&&(u=u.toLowerCase(),u===ZX)?"":`${d}${u?`=${u}`:""}`}).filter(Boolean)];return o&&h.push("base64"),(h.length>0||l&&l!==QX)&&h.unshift(l),`data:${h.join(";")},${o?s.trim():s}${a?`#${a}`:""}`};function JX(e,t){if(t={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...t},e=e.trim(),/^data:/i.test(e))return KX(e,t);if(/^view-source:/i.test(e))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let i=e.startsWith("//");!i&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));let r=new URL(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&r.protocol==="https:"&&(r.protocol="http:"),t.forceHttps&&r.protocol==="http:"&&(r.protocol="https:"),t.stripAuthentication&&(r.username="",r.password=""),t.stripHash?r.hash="":t.stripTextFragment&&(r.hash=r.hash.replace(/#?:~:text.*?$/i,"")),r.pathname){let a=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,n=0,o="";for(;;){let h=a.exec(r.pathname);if(!h)break;let c=h[0],d=h.index,u=r.pathname.slice(n,d);o+=u.replace(/\/{2,}/g,"/"),o+=c,n=d+c.length}let l=r.pathname.slice(n,r.pathname.length);o+=l.replace(/\/{2,}/g,"/"),r.pathname=o}if(r.pathname)try{r.pathname=decodeURI(r.pathname)}catch{}if(t.removeDirectoryIndex===!0&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let a=r.pathname.split("/"),n=a[a.length-1];i7(n,t.removeDirectoryIndex)&&(a=a.slice(0,-1),r.pathname=a.slice(1).join("/")+"/")}if(r.hostname&&(r.hostname=r.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(r.hostname)&&(r.hostname=r.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(let a of[...r.searchParams.keys()])i7(a,t.removeQueryParameters)&&r.searchParams.delete(a);if(t.removeQueryParameters===!0&&(r.search=""),t.sortQueryParameters){r.searchParams.sort();try{r.search=decodeURIComponent(r.search)}catch{}}t.removeTrailingSlash&&(r.pathname=r.pathname.replace(/\/$/,""));let s=e;return e=r.toString(),!t.removeSingleSlash&&r.pathname==="/"&&!s.endsWith("/")&&r.hash===""&&(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||r.pathname==="/")&&r.hash===""&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),i&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e}var $X=class{constructor({url:e,context:t},i,r,s){if(this.controlsManager=i,this.shared=r,this.condition=s,!e)throw new Error("Missing property");this.url=e.startsWith("mailto:")?e:JX(e,{removeTrailingSlash:!1,removeSingleSlash:!1,stripWWW:!1}),this.context=t??"tab"}dispatch(){var e;if(Jt(this.shared,this.condition)===!1)return!1;ch?window.location.assign(this.url):(this.context==="tab"||Cy&&this.context==="none"?window.open(this.url,"_blank"):this.context==="window"?window.open(this.url,"_blank",`width=${window.innerWidth}, height=${window.innerHeight}`):window.open(this.url,"_parent"),(e=this.controlsManager.orbitControls)==null||e.onPointerUp(it[0]),yk())}},uw=class{constructor(e,t,i,r,s){this.data=e,this.page=t,this.controlsManager=i,this.shared=r,this.condition=s,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=a=>{var h,c;this.timeoutIdQueue.shift();let n=this.page.scene.find(a);if(n===void 0)return;let o=this.controlsManager.sharedGameControlGlobals.rapierWorld,l=o?(h=n.dataPatched.physics)==null?void 0:h.fusedBody:!0;if(n.cloner){for(let d of n.cloner.children)l?(d.playModeVisible=!1,d.rigidBody&&((c=n.dataPatched.physics)==null?void 0:c.rigidBody)==="positioned"&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(d.rigidBody.collider(0).handle),o.removeRigidBody(d.rigidBody),d.rigidBody=void 0),d.bvhGeometry&&(d.bvhGeometry=void 0)):this.clone===void 0||this.clone===d?(d.playModeVisible=!1,d.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(d.rigidBody.collider(0).handle),o.removeRigidBody(d.rigidBody),d.rigidBody=void 0)):d.playModeVisible===void 0&&(d.playModeVisible=!0);(l||this.clone===void 0||this.clone===!1)&&(n.visible=!1,n.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(n.rigidBody.collider(0).handle),o.removeRigidBody(n.rigidBody),n.rigidBody=void 0),n.bvhGeometry&&(n.bvhGeometry=void 0))}else n.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(n.rigidBody.collider(0).handle),o.removeRigidBody(n.rigidBody),n.rigidBody=void 0),n.bvhGeometry&&(n.bvhGeometry=void 0),n.visible=!1;o===void 0?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(d=>d.bvhGeometry!==void 0):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(d=>d.rigidBody!==void 0),n.destroyedInAction=!0,this.controlsManager.requestRender()},this.objects=[...e.objects]}dispatch(e){if(Jt(this.shared,this.condition)===!1)return!1;this.clone=e,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()}dispatchFromStart(){if(Jt(this.shared,this.condition)===!1)return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))}dispose(){this.timeoutIdQueue.forEach(e=>window.clearTimeout(e))}},pw=class{constructor(e,t,i,r,s){this.data=e,this.page=t,this.shared=i,this.eventManager=r,this.condition=s,this.shared=i}dispatch(){if(Jt(this.shared,this.condition)===!1)return!1;clearTimeout(this.timeoutId),delete this.timeoutId,this.timeoutId=window.setTimeout(()=>{var e;this.shared.reset(this.shared.data,!0),R5(this.page,this.shared,!0),this.eventManager.reset(),(e=this.eventManager.controlsManager.gameControl)==null||e.reset(!0),this.page.switchToPlayCamera(),this.eventManager.controlsManager.requestRender(),delete this.timeoutId},(this.data.delay??0)*1e3)}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},fw={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},_5={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},eQ=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],od={CSS:{},springs:{}};function Dr(e,t,i){return Math.min(Math.max(e,t),i)}function P2(e,t){return e.indexOf(t)>-1}function Op(e,t){return e.apply(null,t)}var nt={arr:function(e){return Array.isArray(e)},obj:function(e){return P2(Object.prototype.toString.call(e),"Object")},pth:function(e){return nt.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return!("isNode"in e)&&(e.nodeType||nt.svg(e))},str:function(e){return typeof e=="string"},fnc:function(e){return typeof e=="function"},und:function(e){return typeof e>"u"},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return nt.hex(e)||nt.rgb(e)||nt.hsl(e)},key:function(e){return!fw.hasOwnProperty(e)&&!_5.hasOwnProperty(e)&&e!=="targets"&&e!=="keyframes"}};function mw(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map(function(i){return parseFloat(i)}):[]}function gw(e,t){var i=mw(e),r=Dr(nt.und(i[0])?1:i[0],.1,100),s=Dr(nt.und(i[1])?100:i[1],.1,100),a=Dr(nt.und(i[2])?10:i[2],.1,100),n=Dr(nt.und(i[3])?0:i[3],.1,100),o=Math.sqrt(s/r),l=a/(2*Math.sqrt(s*r)),h=l<1?o*Math.sqrt(1-l*l):0,c=1,d=l<1?(l*o+-n)/h:-n+o;function u(f){var g=t?t*f/1e3:f;return l<1?g=Math.exp(-g*l*o)*(c*Math.cos(h*g)+d*Math.sin(h*g)):g=(c+d*g)*Math.exp(-g*o),f===0||f===1?f:1-g}function p(){var f=od.springs[e];if(f)return f;for(var g=1/6,m=0,v=0;;)if(m+=g,u(m)===1){if(v++,v>=16)break}else v=0;var y=m*g*1e3;return od.springs[e]=y,y}return t?u:p}function tQ(e){return e===void 0&&(e=10),function(t){return Math.ceil(Dr(t,1e-6,1)*e)*(1/e)}}var iQ=function(){var e=11,t=1/(e-1);function i(c,d){return 1-3*d+3*c}function r(c,d){return 3*d-6*c}function s(c){return 3*c}function a(c,d,u){return((i(d,u)*c+r(d,u))*c+s(d))*c}function n(c,d,u){return 3*i(d,u)*c*c+2*r(d,u)*c+s(d)}function o(c,d,u,p,f){var g,m,v=0;do m=d+(u-d)/2,g=a(m,p,f)-c,g>0?u=m:d=m;while(Math.abs(g)>1e-7&&++v<10);return m}function l(c,d,u,p){for(var f=0;f<4;++f){var g=n(d,u,p);if(g===0)return d;var m=a(d,u,p)-c;d-=m/g}return d}function h(c,d,u,p){if(!(0<=c&&c<=1&&0<=u&&u<=1))return;var f=new Float32Array(e);if(c!==d||u!==p)for(var g=0;g<e;++g)f[g]=a(g*t,c,u);function m(v){for(var y=0,x=1,w=e-1;x!==w&&f[x]<=v;++x)y+=t;--x;var _=(v-f[x])/(f[x+1]-f[x]),b=y+_*t,A=n(b,c,u);return A>=.001?l(v,b,c,u):A===0?b:o(v,y,y+t,c,u)}return function(v){return c===d&&u===p||v===0||v===1?v:a(m(v),d,p)}}return h}(),vw=function(){var e={linear:function(){return function(r){return r}}},t={Sine:function(){return function(r){return 1-Math.cos(r*Math.PI/2)}},Circ:function(){return function(r){return 1-Math.sqrt(1-r*r)}},Back:function(){return function(r){return r*r*(3*r-2)}},Bounce:function(){return function(r){for(var s,a=4;r<((s=Math.pow(2,--a))-1)/11;);return 1/Math.pow(4,3-a)-7.5625*Math.pow((s*3-2)/22-r,2)}},Elastic:function(r,s){r===void 0&&(r=1),s===void 0&&(s=.5);var a=Dr(r,1,10),n=Dr(s,.1,2);return function(o){return o===0||o===1?o:-a*Math.pow(2,10*(o-1))*Math.sin((o-1-n/(Math.PI*2)*Math.asin(1/a))*(Math.PI*2)/n)}}},i=["Quad","Cubic","Quart","Quint","Expo"];return i.forEach(function(r,s){t[r]=function(){return function(a){return Math.pow(a,s+2)}}}),Object.keys(t).forEach(function(r){var s=t[r];e["easeIn"+r]=s,e["easeOut"+r]=function(a,n){return function(o){return 1-s(a,n)(1-o)}},e["easeInOut"+r]=function(a,n){return function(o){return o<.5?s(a,n)(o*2)/2:1-s(a,n)(o*-2+2)/2}}}),e}();function A5(e,t){if(nt.fnc(e))return e;var i=e.split("(")[0],r=vw[i],s=mw(e);switch(i){case"spring":return gw(e,t);case"cubicBezier":return Op(iQ,s);case"steps":return Op(tQ,s);default:return Op(r,s)}}function yw(e){try{var t=document.querySelectorAll(e);return t}catch{return}}function zd(e,t){for(var i=e.length,r=arguments.length>=2?arguments[1]:void 0,s=[],a=0;a<i;a++)if(a in e){var n=e[a];t.call(r,n,a,e)&&s.push(n)}return s}function Fd(e){return e.reduce(function(t,i){return t.concat(nt.arr(i)?Fd(i):i)},[])}function r7(e){return nt.arr(e)?e:(nt.str(e)&&(e=yw(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function M5(e,t){return e.some(function(i){return i===t})}function E5(e){var t={};for(var i in e)t[i]=e[i];return t}function Hf(e,t){var i=E5(e);for(var r in e)i[r]=t.hasOwnProperty(r)?t[r]:e[r];return i}function kd(e,t){var i=E5(e);for(var r in t)i[r]=nt.und(e[r])?t[r]:e[r];return i}function rQ(e){var t=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(e);return t?"rgba("+t[1]+",1)":e}function sQ(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,i=e.replace(t,function(o,l,h,c){return l+l+h+h+c+c}),r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(i),s=parseInt(r[1],16),a=parseInt(r[2],16),n=parseInt(r[3],16);return"rgba("+s+","+a+","+n+",1)"}function aQ(e){var t=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),i=parseInt(t[1],10)/360,r=parseInt(t[2],10)/100,s=parseInt(t[3],10)/100,a=t[4]||1;function n(u,p,f){return f<0&&(f+=1),f>1&&(f-=1),f<1/6?u+(p-u)*6*f:f<1/2?p:f<2/3?u+(p-u)*(2/3-f)*6:u}var o,l,h;if(r==0)o=l=h=s;else{var c=s<.5?s*(1+r):s+r-s*r,d=2*s-c;o=n(d,c,i+1/3),l=n(d,c,i),h=n(d,c,i-1/3)}return"rgba("+o*255+","+l*255+","+h*255+","+a+")"}function nQ(e){if(nt.rgb(e))return rQ(e);if(nt.hex(e))return sQ(e);if(nt.hsl(e))return aQ(e)}function Zs(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function oQ(e){if(P2(e,"translate")||e==="perspective")return"px";if(P2(e,"rotate")||P2(e,"skew"))return"deg"}function Wf(e,t){return nt.fnc(e)?e(t.target,t.id,t.total):e}function ns(e,t){return e.getAttribute(t)}function C5(e,t,i){var r=Zs(t);if(M5([i,"deg","rad","turn"],r))return t;var s=od.CSS[t+i];if(!nt.und(s))return s;var a=100,n=document.createElement(e.tagName),o=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;o.appendChild(n),n.style.position="absolute",n.style.width=a+i;var l=a/n.offsetWidth;o.removeChild(n);var h=l*parseFloat(t);return od.CSS[t+i]=h,h}function xw(e,t,i){if(t in e.style){var r=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),s=e.style[t]||getComputedStyle(e).getPropertyValue(r)||"0";return i?C5(e,s,i):s}}function T5(e,t){if(nt.dom(e)&&!nt.inp(e)&&(ns(e,t)||nt.svg(e)&&e[t]))return"attribute";if(nt.dom(e)&&M5(eQ,t))return"transform";if(nt.dom(e)&&t!=="transform"&&xw(e,t))return"css";if(e[t]!=null)return"object"}function bw(e){if(nt.dom(e)){for(var t=e.style.transform||"",i=/(\w+)\(([^)]*)\)/g,r=new Map,s;s=i.exec(t);)r.set(s[1],s[2]);return r}}function lQ(e,t,i,r){var s=P2(t,"scale")?1:0+oQ(t),a=bw(e).get(t)||s;return i&&(i.transforms.list.set(t,a),i.transforms.last=t),r?C5(e,a,r):a}function P5(e,t,i,r){switch(T5(e,t)){case"transform":return lQ(e,t,r,i);case"css":return xw(e,t,i);case"attribute":return ns(e,t);default:return e[t]||0}}function D5(e,t){var i=/^(\*=|\+=|-=)/.exec(e);if(!i)return e;var r=Zs(e)||0,s=parseFloat(t),a=parseFloat(e.replace(i[0],""));switch(i[0][0]){case"+":return s+a+r;case"-":return s-a+r;case"*":return s*a+r}}function ww(e,t){if(nt.col(e))return nQ(e);if(/\s/g.test(e))return e;var i=Zs(e),r=i?e.substr(0,e.length-i.length):e;return t?r+t:r}function I5(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function hQ(e){return Math.PI*2*ns(e,"r")}function cQ(e){return ns(e,"width")*2+ns(e,"height")*2}function dQ(e){return I5({x:ns(e,"x1"),y:ns(e,"y1")},{x:ns(e,"x2"),y:ns(e,"y2")})}function Sw(e){for(var t=e.points,i=0,r,s=0;s<t.numberOfItems;s++){var a=t.getItem(s);s>0&&(i+=I5(r,a)),r=a}return i}function uQ(e){var t=e.points;return Sw(e)+I5(t.getItem(t.numberOfItems-1),t.getItem(0))}function _w(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return hQ(e);case"rect":return cQ(e);case"line":return dQ(e);case"polyline":return Sw(e);case"polygon":return uQ(e)}}function pQ(e){var t=_w(e);return e.setAttribute("stroke-dasharray",t),t}function fQ(e){for(var t=e.parentNode;nt.svg(t)&&nt.svg(t.parentNode);)t=t.parentNode;return t}function Aw(e,t){var i=t||{},r=i.el||fQ(e),s=r.getBoundingClientRect(),a=ns(r,"viewBox"),n=s.width,o=s.height,l=i.viewBox||(a?a.split(" "):[0,0,n,o]);return{el:r,viewBox:l,x:l[0]/1,y:l[1]/1,w:n/l[2],h:o/l[3]}}function mQ(e,t){var i=nt.str(e)?yw(e)[0]:e,r=t||100;return function(s){return{property:s,el:i,svg:Aw(i),totalLength:_w(i)*(r/100)}}}function gQ(e,t){function i(o){o===void 0&&(o=0);var l=t+o>=1?t+o:0;return e.el.getPointAtLength(l)}var r=Aw(e.el,e.svg),s=i(),a=i(-1),n=i(1);switch(e.property){case"x":return(s.x-r.x)*r.w;case"y":return(s.y-r.y)*r.h;case"angle":return Math.atan2(n.y-a.y,n.x-a.x)*180/Math.PI}}function s7(e,t){var i=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,r=ww(nt.pth(e)?e.totalLength:e,t)+"";return{original:r,numbers:r.match(i)?r.match(i).map(Number):[0],strings:nt.str(e)||t?r.split(i):[]}}function Mw(e){var t=e?Fd(nt.arr(e)?e.map(r7):r7(e)):[];return zd(t,function(i,r,s){return s.indexOf(i)===r})}function Ew(e){var t=Mw(e);return t.map(function(i,r){return{target:i,id:r,total:t.length,transforms:{list:bw(i)}}})}function vQ(e,t){var i=E5(t);if(/^spring/.test(i.easing)&&(i.duration=gw(i.easing)),nt.arr(e)){var r=e.length,s=r===2&&!nt.obj(e[0]);s?e={value:e}:nt.fnc(t.duration)||(i.duration=t.duration/r)}var a=nt.arr(e)?e:[e];return a.map(function(n,o){var l=nt.obj(n)&&!nt.pth(n)?n:{value:n};return nt.und(l.delay)&&(l.delay=o?0:t.delay),nt.und(l.endDelay)&&(l.endDelay=o===a.length-1?t.endDelay:0),l}).map(function(n){return kd(n,i)})}function yQ(e){for(var t=zd(Fd(e.map(function(a){return Object.keys(a)})),function(a){return nt.key(a)}).reduce(function(a,n){return a.indexOf(n)<0&&a.push(n),a},[]),i={},r=function(a){var n=t[a];i[n]=e.map(function(o){var l={};for(var h in o)nt.key(h)?h==n&&(l.value=o[h]):l[h]=o[h];return l})},s=0;s<t.length;s++)r(s);return i}function xQ(e,t){var i=[],r=t.keyframes;r&&(t=kd(yQ(r),t));for(var s in t)nt.key(s)&&i.push({name:s,tweens:vQ(t[s],e)});return i}function bQ(e,t){var i={};for(var r in e){var s=Wf(e[r],t);nt.arr(s)&&(s=s.map(function(a){return Wf(a,t)}),s.length===1&&(s=s[0])),i[r]=s}return i.duration=parseFloat(i.duration),i.delay=parseFloat(i.delay),i}function wQ(e,t){var i;return e.tweens.map(function(r){var s=bQ(r,t),a=s.value,n=nt.arr(a)?a[1]:a,o=Zs(n),l=P5(t.target,e.name,o,t),h=i?i.to.original:l,c=nt.arr(a)?a[0]:h,d=Zs(c)||Zs(l),u=o||d;return nt.und(n)&&(n=h),s.from=s7(c,u),s.to=s7(D5(n,c),u),s.start=i?i.end:0,s.end=s.start+s.delay+s.duration+s.endDelay,s.easing=A5(s.easing,s.duration),s.isPath=nt.pth(a),s.isColor=nt.col(s.from.original),s.isColor&&(s.round=1),i=s,s})}var Cw={css:function(e,t,i){return e.style[t]=i},attribute:function(e,t,i){return e.setAttribute(t,i)},object:function(e,t,i){return e[t]=i},transform:function(e,t,i,r,s){if(r.list.set(t,i),t===r.last||s){var a="";r.list.forEach(function(n,o){a+=o+"("+n+") "}),e.style.transform=a}}};function Tw(e,t){var i=Ew(e);i.forEach(function(r){for(var s in t){var a=Wf(t[s],r),n=r.target,o=Zs(a),l=P5(n,s,o,r),h=o||Zs(l),c=D5(ww(a,h),l),d=T5(n,s);Cw[d](n,s,c,r.transforms,!0)}})}function SQ(e,t){var i=T5(e.target,t.name);if(i){var r=wQ(t,e),s=r[r.length-1];return{type:i,property:t.name,animatable:e,tweens:r,duration:s.end,delay:r[0].delay,endDelay:s.endDelay}}}function _Q(e,t){return zd(Fd(e.map(function(i){return t.map(function(r){return SQ(i,r)})})),function(i){return!nt.und(i)})}function Pw(e,t){var i=e.length,r=function(a){return a.timelineOffset?a.timelineOffset:0},s={};return s.duration=i?Math.max.apply(Math,e.map(function(a){let n=a.startOnceDelay??0,o=a.pingPongDelayCorrection??0,l=a.pingPongEndDelayCorrection??0;return r(a)+n+o+l+a.duration*(a.loop??1)})):t.duration,s.delay=i?Math.min.apply(Math,e.map(function(a){let n=a.startOnceDelay??0,o=a.pingPongDelayCorrection??0;return r(a)+n+o+a.delay})):t.delay,s.endDelay=i?s.duration-Math.max.apply(Math,e.map(function(a){let n=a.startOnceDelay??0,o=a.pingPongDelayCorrection??0,l=a.pingPongEndDelayCorrection??0;return r(a)+n+o+a.duration*(a.loop??1)-a.endDelay-l})):t.endDelay,s}var a7=0;function AQ(e){var t=Hf(fw,e),i=Hf(_5,e),r=xQ(i,e),s=Ew(e.targets),a=_Q(s,r),n=Pw(a,i),o=a7;return a7++,kd(t,{id:o,children:[],animatables:s,animations:a,duration:n.duration,delay:n.delay,endDelay:n.endDelay,startOnceDelay:i.startOnceDelay,pingPongDelayCorrection:i.pingPongDelayCorrection,pingPongEndDelayCorrection:i.pingPongEndDelayCorrection})}var cr=[],n7=[],ac,MQ=function(){function e(){ac=requestAnimationFrame(t)}function t(i){var r=cr.length;if(r){for(var s=0;s<r;){var a=cr[s];a.paused?(cr.splice(s,1),r-=1):(a.tick(i),s++)}e()}else ac=cancelAnimationFrame(ac)}return e}();function EQ(e){document.hidden?(cr.forEach(function(t){return t.pause(e.timeStamp)}),n7=cr.slice(0),gi.running=cr=[]):n7.forEach(function(t){return t.play(e.timeStamp)})}typeof document<"u"&&document.addEventListener("visibilitychange",EQ);function gi(e){e===void 0&&(e={});var t=0,i=0,r=0,s,a,n=0,o=null;function l(b){var A=window.Promise&&new Promise(function(S){return o=S});return b.finished=A,A}var h=AQ(e);l(h);function c(){var b=h.direction;b!=="alternate"&&(h.direction=b!=="normal"?"normal":"reverse"),h.reversed=!h.reversed,a.forEach(function(A){(A.loop===1||A.loop%2===0)&&(A.reversed=h.reversed)})}function d(){h.direction="normal",h.reversed=!1,a.forEach(function(b){return b.reversed=!1})}function u(b){return h.reversed?h.duration-b:b}function p(){t=0,i=u(h.currentTime)*(1/gi.speed)}function f(b,A,S=!1){A&&(h.reversed?A.seek(A.duration*A.loop-(b-A.timelineOffset-A.pingPongDelayCorrection),S):A.seek(b-A.timelineOffset-A.startOnceDelay-A.pingPongDelayCorrection,S))}function g(b,A=!1){if(h.reversed)for(var S=n;S--;)f(b,a[S],A);else for(var M=0;M<n;M++)f(b,a[M],A)}function m(b){var le,re,te,ne,ce,pe,xe,Re,Ae,Ne;var A=0,S=h.animations,M=S.length;for(h.direction!=="alternate"&&((le=h.parent)==null?void 0:le.direction)==="alternate"?((re=h.parent)==null?void 0:re.rewind)===!1&&h.reversePlayback===!0&&h.rewind===!1&&((te=h.parent)!=null&&te.reversed&&h.direction==="alternate"?b=h.duration-h.delay+h.endDelay-b:b=h.duration+h.delay-h.endDelay-b):w(!1,(ne=h.parent)==null?void 0:ne.rewind,h.rewind,(ce=h.parent)==null?void 0:ce.reversePlayback,h.reversePlayback)&&((pe=h.parent)!=null&&pe.reversed&&h.direction==="alternate"?b=h.duration-h.delay+h.endDelay-b:b=h.duration+h.delay-h.endDelay-b);A<M;){var C=S[A],T=C.animatable,P=C.tweens,I=P.length-1,D=P[I];I&&(D=zd(P,function(Ee){return b<Ee.end})[0]||D);let Fe;(xe=h.parent)!=null&&xe.reversed&&h.direction==="alternate"?Fe=Dr(b-D.start-D.endDelay,0,D.duration)/D.duration:Fe=Dr(b-D.start-D.delay,0,D.duration)/D.duration;for(var k=isNaN(Fe)?1:D.easing(Fe),H=D.to.strings,U=D.round,F=[],Z=D.to.numbers.length,W=void 0,G=0;G<Z;G++){var X=void 0;let Ee,Me;h.direction!=="alternate"?((Re=h.parent)==null?void 0:Re.rewind)===!1&&h.reversePlayback===!0&&h.rewind===!1?(Ee=D.to.numbers[G],Me=D.from.numbers[G]||0):(Me=D.to.numbers[G],Ee=D.from.numbers[G]||0):w(!0,(Ae=h.parent)==null?void 0:Ae.rewind,h.rewind,(Ne=h.parent)==null?void 0:Ne.reversePlayback,h.reversePlayback)?(Ee=D.to.numbers[G],Me=D.from.numbers[G]||0):(Me=D.to.numbers[G],Ee=D.from.numbers[G]||0),D.isPath?X=gQ(D.value,k*Me):X=Ee+k*(Me-Ee),U&&(D.isColor&&G>2||(X=Math.round(X*U)/U)),F.push(X)}var ee=H.length;if(!ee)W=F[0];else{W=H[0];for(var Y=0;Y<ee;Y++){H[Y];var $=H[Y+1],Q=F[Y];isNaN(Q)||($?W+=Q+$:W+=Q+" ")}}Cw[C.type](T.target,C.property,W,T.transforms),C.currentValue=W,A++}}function v(b){h[b]&&!h.passThrough&&h[b](h)}function y(){h.remaining&&h.remaining!==!0&&h.remaining--}let x={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function w(b,A,S,M,C){return x[b<<4|A<<3|S<<2|M<<1|C]}function _(b,A=!1){var P;var S=h.duration;let M=h.delay,C=S-h.endDelay;(P=h.parent)!=null&&P.reversed&&h.direction==="alternate"&&(M=h.endDelay,C=S-h.delay);var T=u(b);if(h.progress=Dr(T/S*100,0,100),A||(h.reversePlayback=T<h.currentTime),n&&g(T,A),!h.began&&h.currentTime>=0&&(h.began=!0,v("begin")),!h.loopBegan&&h.currentTime>0&&(h.loopBegan=!0,v("loopBegin")),(h.reversed||T>=0)&&T<=M&&h.currentTime!==0&&(m(0),v("change")),(T>=C&&h.currentTime!==S+h.pingPongDelayCorrection||!S)&&(m(S),v("change")),T>M&&T<C?(h.changeBegan||(h.changeBegan=!0,h.changeCompleted=!1,v("changeBegin")),m(T),v("change")):h.changeBegan?(h.changeCompleted=!0,h.changeBegan=!1,v("change"),n&&v("timelineChangeComplete")):h.began&&T>C&&v("changeComplete"),h.currentTime=Dr(T,0,S+h.pingPongDelayCorrection),h.began&&v("update"),b>=S)if(y(),!h.remaining)h.paused=!0,h.completed||(h.completed=!0,v("loopComplete"),v("complete"),!h.passThrough&&"Promise"in window&&(o(),l(h)));else{n?t+=h.duration/gi.speed:t+=h.duration;for(let I of a)I.setStartTime(0),I.remaining=I.loop;v("loopComplete"),h.loopBegan=!1,h.direction==="alternate"?c():n&&d()}}return h.reset=function(){var b=h.direction;h.passThrough=!1,h.currentTime=0,h.progress=0,h.paused=!0,h.began=!1,h.loopBegan=!1,h.changeBegan=!1,h.completed=!1,h.changeCompleted=!1,h.reversePlayback=!1,h.reversed=b==="reverse",h.remaining=h.loop,a=h.children,n=a.length;for(var A=n;A--;)h.children[A].reset();m(h.reversed?h.duration:0)},h.setStartTime=function(b){t=b},h.set=function(b,A){return Tw(b,A),h},h.tick=function(b){r=b,t||(t=r),_((r+(i-t))*gi.speed)},h.seek=function(b,A=!1){_(b-t,A)},h.pause=function(b){h.paused=!0,n&&(s=b??performance.now())},h.play=function(b){!h.paused||(h.completed&&h.reset(),h.paused=!1,cr.push(h),n&&s!==void 0&&(t+=(b??performance.now())-s),ac||MQ())},h.reverse=function(){c(),h.completed=!h.reversed,p()},h.restart=function(){h.reset(),h.play()},h.reset(),h.autoplay&&h.play(),h}function o7(e,t){for(var i=t.length;i--;)M5(e,t[i].animatable.target)&&t.splice(i,1)}function CQ(e){for(var t=Mw(e),i=cr.length;i--;){var r=cr[i],s=r.animations,a=r.children;o7(t,s);for(var n=a.length;n--;){var o=a[n],l=o.animations;o7(t,l),!l.length&&!o.children.length&&a.splice(n,1)}!s.length&&!a.length&&r.pause()}}function TQ(e,t){t===void 0&&(t={});var i=t.direction||"normal",r=t.easing?A5(t.easing):null,s=t.grid,a=t.axis,n=t.from||0,o=n==="first",l=n==="center",h=n==="last",c=nt.arr(e),d=parseFloat(c?e[0]:e),u=c?parseFloat(e[1]):0,p=Zs(c?e[1]:e)||0,f=t.start||0+(c?d:0),g=[],m=0;return function(v,y,x){if(o&&(n=0),l&&(n=(x-1)/2),h&&(n=x-1),!g.length){for(var w=0;w<x;w++){if(!s)g.push(Math.abs(n-w));else{var _=l?(s[0]-1)/2:n%s[0],b=l?(s[1]-1)/2:Math.floor(n/s[0]),A=w%s[0],S=Math.floor(w/s[0]),M=_-A,C=b-S,T=Math.sqrt(M*M+C*C);a==="x"&&(T=-M),a==="y"&&(T=-C),g.push(T)}m=Math.max.apply(Math,g)}r&&(g=g.map(function(I){return r(I/m)*m})),i==="reverse"&&(g=g.map(function(I){return a?I<0?I*-1:-I:Math.abs(m-I)}))}var P=c?(u-d)/m:d;return f+P*(Math.round(g[y]*100)/100)+p}}function PQ(e){e===void 0&&(e={});var t=gi(e);return t.duration=0,t.add=function(i,r){var s=cr.indexOf(t),a=t.children;s>-1&&cr.splice(s,1);function n(u){u.passThrough=!0}for(var o=0;o<a.length;o++)n(a[o]);var l=kd(i,Hf(_5,e));l.targets=l.targets||e.targets;var h=t.duration;l.autoplay=!1,l.timelineOffset=nt.und(r)?h:D5(r,h),n(t);var c=gi(l);n(c),a.push(c),c.parent=t;var d=Pw(a,e);return t.delay=d.delay,t.endDelay=d.endDelay,t.duration=d.duration,c.loop===!0&&(t.duration=1/0),t.seek(0),t.reset(),t.autoplay&&t.play(),t},t}gi.version="3.2.0";gi.speed=1;gi.running=cr;gi.remove=CQ;gi.get=P5;gi.set=Tw;gi.convertPx=C5;gi.path=mQ;gi.setDashoffset=pQ;gi.stagger=TQ;gi.timeline=PQ;gi.easing=A5;gi.penner=vw;gi.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};var Dw=gi,l7=new E,h7=new E,c7=new lt;function DQ(e,t,i,r){if(r===0)return i.copy(e);if(r===1)return i.copy(t);let s=e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z;if(s>=1)return i.copy(e);let a=1-s*s;if(a<=Number.EPSILON){let c=1-r;return i.w=c*e.w+r*t.w,i.x=c*e.x+r*t.x,i.y=c*e.y+r*t.y,i.z=c*e.z+r*t.z,i.normalize(),i}let n=Math.sqrt(a),o=Math.atan2(n,s),l=Math.sin((1-r)*o)/n,h=Math.sin(r*o)/n;return i.w=e.w*l+t.w*h,i.x=e.x*l+t.x*h,i.y=e.y*l+t.y*h,i.z=e.z*l+t.z*h,i}function t1(e,t,i,r,s,a){let n=i[e]!==void 0?i[e]:void 0,o=r[e];if(o==null)return;let l=n!=null?typeof n=="string"?Number(s.getVariable(n)??0):n:t[e],h=typeof o=="string"?Number(s.getVariable(o)??0):o;if(l!==h)return{update:c=>{let d=Oe.lerp(l,h,c);a?t[e]=Math.trunc(d):t[e]=d},start:()=>{t[e]=l},end:()=>{t[e]=h}}}function O5(e,t,i,r,s,a){let n=i[e]?i[e]:void 0,o=r[e];if(!o)return;let l=t[e],h=[...n??l].map(d=>typeof d=="string"?Number(s.getVariable(d)??0):d),c=[...o].map(d=>typeof d=="string"?Number(s.getVariable(d)??0):d);if(!(h.length!==c.length||D4(h,c)))return{update:d=>{h.forEach((u,p)=>{let f=Oe.lerp(u,c[p],d);t[e][p]=a?Math.trunc(f):f})},start:()=>{Object.assign(t[e],h)},end:()=>{Object.assign(t[e],c)}}}function ld(e,t,i){return t.forEach((r,s)=>{e.setComponent(s,typeof r=="string"?Number(i.getVariable(r)??0):r)}),e}function d7(e,t,i,r,s){let a=i[e]?i[e]:void 0,n=r[e];if(!n)return;let o=t[e],l=a?ld(new E,a,s):o.clone(),h=ld(new E,n,s);if(!l.equals(h))return{update:c=>{o.lerpVectors(l,h,c)},start:()=>{o.copy(l)},end:()=>{o.copy(h)}}}function u7(e,t,i){return t.forEach((r,s)=>{e.setComponent(s,typeof r=="string"?Number(i.getVariable(r)??0):r)}),e}function hd(e,t,i,r,s){let a=i[e]?i[e]:void 0,n=r[e];if(!n)return;let o=t[e],l=!(o instanceof j),h=o instanceof j?o:new j().fromArray(o),c=a?u7(new j,a,s):h.clone(),d=u7(new j,n,s);if(!c.equals(d))return{update:u=>{h.lerpVectors(c,d,u),l&&(t[e]=h.toArray())},start:()=>{h.copy(c),l&&(t[e]=h.toArray())},end:()=>{h.copy(d),l&&(t[e]=h.toArray())}}}function IQ(e,t,i,r){let s=i[e]?i[e]:void 0,a=r[e];if(!a)return;let n=t[e],o=s?new we().fromArray(s):n.clone(),l=new E,h=new lt,c=new E;o.decompose(l,h,c);let d=new we().fromArray(a),u=new E,p=new lt,f=new E;if(d.decompose(u,p,f),!o.equals(d))return{update:g=>{c7.slerpQuaternions(h,p,g),l7.lerpVectors(l,u,g),h7.lerpVectors(c,f,g),n.compose(l7,c7,h7)},start:()=>{n.compose(l,h,c)},end:()=>{n.compose(u,p,f)}}}function OQ(e,t,i,r,s){let a=i[e]?i[e]:void 0,n=r[e];if(!n)return;let o=t[e],l=a?typeof a=="string"?s.getColor(a).clone():new Je().setRGB(a.r,a.g,a.b):o.clone(),h=typeof n=="string"?s.getColor(n).clone():new Je().setRGB(n.r,n.g,n.b);if(l.equals(h))return;let c=o.clone();return{update:d=>{var u,p;c.lerpColors(l,h,d),(p=(u=t[e])==null?void 0:u.copy)==null||p.call(u,c)},start:()=>{c.copy(l)},end:()=>{c.copy(h)}}}function U0(e,t,i,r,s){let a=i[e]?i[e]:void 0,n=r[e];if(!n)return;let o=t[e],l=new o1(o.r,o.g,o.b,o.a),h=a?typeof a=="string"?s.getColor(a).clone():new o1(a.r,a.g,a.b,a.a):l.clone(),c=typeof n=="string"?s.getColor(n).clone():new o1(n.r,n.g,n.b,n.a);if(!h.equals(c))return{update:d=>{l.lerpColors(h,c,d);let u=Oe.lerp(h.a,c.a,d);l.a=u,t[e]={r:l.r,g:l.g,b:l.b,a:l.a}},start:()=>{l.copy(h)},end:()=>{l.copy(c)}}}function Qa(e,t,i,r,s){if(typeof t[e]=="number")return t1(e,t,i??{},r,s);if(Array.isArray(t[e]))return O5(e,t,i??{},r,s)}function RQ(e,t,i,r){var o,l,h,c;let s=[],a=e.cameraType==="OrthographicCamera"?(o=t.orthographic)==null?void 0:o.zoom:(l=t.perspective)==null?void 0:l.zoom,n=e.cameraType==="OrthographicCamera"?(h=i.orthographic)==null?void 0:h.zoom:(c=i.perspective)==null?void 0:c.zoom;if(n!==void 0){let d=a??e.zoom,u=n;d!==u&&s.push({update:p=>{e.zoom=Oe.lerp(d,u,p),e.updateProjectionMatrix()},start:()=>{e.zoom=d,e.updateProjectionMatrix()},end:()=>{e.zoom=u,e.updateProjectionMatrix()}})}if(i.targetOffset!==void 0){let d=t1("targetOffset",e,t,i,r);d&&s.push(d)}return s}function LQ(e,t,i,r){if(i.scaleBaked===void 0)return;let s=(t.scaleBaked??e.data.geometry.scaleBaked).map(o=>typeof o=="string"?Number(r.getVariable(o)??0):o),a=i.scaleBaked.map(o=>typeof o=="string"?Number(r.getVariable(o)??0):o);if(In.isEqual(s,a))return;let n=[];return n.push({update:o=>{e.updateGeometryInteractions({scaleBaked:[Oe.lerp(s[0],a[0],o),Oe.lerp(s[1],a[1],o),Oe.lerp(s[2],a[2],o)]},r),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()},start:()=>{e.updateGeometryInteractions({scaleBaked:s},r),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()},end:()=>{e.updateGeometryInteractions({scaleBaked:a},r),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()}}),n}function BQ(e,t,i,r){if(!i.extrusion)return;let s=e.extrusion,a=t.extrusion??{},n=i.extrusion,o=[];return cx.forEach(l=>{let h=Qa(l,s,a,n,r);h&&o.push(h)}),o}function zQ(e,t,i,r){let s=[];if(!("geometry"in i))return s;let a=e.geometry.userData.parameters,n="geometry"in t?t.geometry:{},o=i.geometry;if(e instanceof eh){let l=LQ(e,n,o,r);l&&s.push(...l)}else{let l={};if(Object.assign(l,hs(a,Fu),hs(n,Fu)),Fu.forEach(h=>{let c=Qa(h,l,n,o,r);c&&s.push(c)}),e instanceof g5){Object.assign(l,{extrusion:{...a.extrusion}});let h=BQ(l,n,o,r);h&&s.push(...h)}s.length&&s.push({update:h=>{e.updateGeometryInteractions(l,r),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()},start:h=>{e.updateGeometryInteractions(l,r),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()},end:h=>{e.updateGeometryInteractions(l,r),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()}})}return s}function FQ(e,t,i,r){let s=[];if(i.intensity!==void 0){let a=t1("intensity",e,t,i,r);a&&s.push(a)}if(i.color!==void 0){let a=OQ("color",e,t,i,r);a&&s.push(a)}return s}function kQ(e,t,i,r){let s=[];if(Array.isArray(e.material)){if(!("materials"in i&&i.materials))return s;let a="materials"in t&&t.materials?t.materials:[],n=i.materials;e.material.forEach((o,l)=>{if(!n[l])return;let h=a[l]??{},c=n[l];typeof h=="string"||typeof c=="string"||s.push(...p7(o,h,c,r))})}else{if(!("material"in i&&i.material))return s;let a="material"in t&&t.material?t.material:{},n=i.material;if(typeof a=="string"||typeof n=="string")return s;s.push(...p7(e.material,a,n,r))}return s}function p7(e,t,i,r){var n;let s=[],a=Uo(i,r)||!!t.layers&&Uo(t,r);s.push(YQ(e,a));for(let o of e.layers){let l=(n=t.layers)==null?void 0:n.data(o.uuid),h=i.layers.data(o.uuid);if(!h||o.type!=="light"&&(!(o.visible??!0)||!(h.visible??!0)))continue;let c=o.getNames().filter(d=>!ox.some(u=>d.includes(u)));for(let d of c)try{let u=o.getValue(d),p;if(d==="colors")p=WQ(o,l,h,d);else if(Array.isArray(u))d==="steps"&&(p=HQ(o,l,h,d));else if(typeof u=="number")p=UQ(o,l,h,d,r);else{if(typeof u=="boolean")continue;u instanceof j?p=NQ(o,l,h,d):u instanceof E?p=VQ(o,l,h,d,r):u instanceof o1?p=GQ(o,l,h,d,r):u instanceof Je?p=jQ(o,l,h,d,r):"isTexture"in u&&(p=qQ(o,l,h,d))}p&&(Array.isArray(p)?s.push(...p):s.push(p))}catch(u){`${d}`}}return s}function UQ(e,t,i,r,s){if(!e.hasValue(r)||!(r in i))return;let a=t?t[r]:e.getValue(r),n=i[r],o=typeof a=="string"?Number(s.getVariable(a)??0):a,l=typeof n=="string"?Number(s.getVariable(n)??0):n;if(o!==l)return{update:h=>{e.setValue(r,Oe.lerp(o,l,h))},start:()=>{e.setValue(r,o)},end:()=>{e.setValue(r,l)}}}function NQ(e,t,i,r){if(!e.hasValue(r)||!(r in i))return;let s=e.getValue(r),a=t?new j().fromArray(t[r]):s.clone(),n=new j().fromArray(i[r]);if(!a.equals(n))return{update:o=>{s.lerpVectors(a,n,o)},start:()=>{s.copy(a)},end:()=>{s.copy(n)}}}function VQ(e,t,i,r,s){if(!e.hasValue(r)||!(r in i))return;let a=e.getValue(r),n=t?t[r]:void 0,o=i[r],l=n?ld(new E,n,s):a.clone(),h=ld(new E,o,s);if(!l.equals(h))return{update:c=>{a.lerpVectors(l,h,c)},start:()=>{a.copy(l)},end:()=>{a.copy(h)}}}function jQ(e,t,i,r,s){if(!e.hasValue(r)||!(r in i))return;let a=t?t[r]:void 0,n=i[r],o=e.getValue(r),l=a?typeof a=="string"?s.getColor(a).clone():new Je().setRGB(a.r,a.g,a.b):o.clone(),h=typeof n=="string"?s.getColor(n).clone():new Je().setRGB(n.r,n.g,n.b);if(l.equals(h))return;let c=o.clone();return{update:d=>{e.getValue(r)!==c&&e.setValue(r,c),c.lerpColors(l,h,d)},start:()=>{c.copy(l)},end:()=>{c.copy(h)}}}function GQ(e,t,i,r,s){if(!e.hasValue(r)||!(r in i))return;let a=t?t[r]:void 0,n=i[r],o=e.getValue(r),l=a?typeof a=="string"?s.getColor(a).clone():new Je().setRGB(a.r,a.g,a.b):o.clone(),h=typeof n=="string"?s.getColor(n).clone():new o1(n.r,n.g,n.b,n.a);if(l.equals(h))return;let c=o.clone();return{update:d=>{e.getValue(r)!==c&&e.setValue(r,c),c.lerpColors(l,h,d)},start:()=>{c.copy(l)},end:()=>{c.copy(h)}}}function HQ(e,t,i,r="steps"){if(!e.hasValue(r)||!(r in i))return;let s=[],a=e.getValue(r),n=t?t[r]:a,o=i[r];return D4(n,o)||s.push({update:l=>{let h=[...a];for(let c=0;c<a.length;++c){let d=n[c],u=o[c];h[c]=Oe.lerp(d,u,l)}e.setValue(r,h)},start:()=>{e.setValue(r,n)},end:()=>{e.setValue(r,o)}}),s.length?s:void 0}function WQ(e,t,i,r="colors"){if(!e.hasValue(r)||!(r in i))return;let s=[],a=e.getValue(r),n=t?t[r]:a.map(l=>l.toArray()),o=i[r];for(let l=0;l<a.length;++l){let h=[...n[l]],c=[...o[l]];Bc.isEqual(h,c)||s.push({update:d=>{a[l].fromArray(Bc.lerp(h,c,d))},start:()=>{a[l].fromArray(h)},end:()=>{a[l].fromArray(c)}})}return s.length?s:void 0}function qQ(e,t,i,r="texture"){var m,v;if(!e.hasValue(r)||!(r in i))return;let s=e.getNode("rotation"),a=((m=t==null?void 0:t[r])==null?void 0:m.rotation)??0,n=((v=i[r])==null?void 0:v.rotation)??0;if(s&&a!==n)return{update:y=>{s.value=Oe.lerp(a,n,y)*Oe.DEG2RAD},start:()=>{s.value=a*Oe.DEG2RAD},end:()=>{s.value=n*Oe.DEG2RAD}};let o=e.getNode("mat");if(!o)return;let l=t?t[r]:o,h=i[r],c=[...l.repeat],d=[...l.offset],u=[...h.repeat],p=[...h.offset],f=l.rotation??0,g=h.rotation??0;if(!Ys.isEqual(c,u)||!Ys.isEqual(d,p)||f!==g)return{update:y=>{o.repeat=Ys.lerp(c,u,y),o.offset=Ys.lerp(d,p,y),o.rotation=Oe.lerp(f,g,y),o.updateMatrix()},start:()=>{o.repeat=[...c],o.offset=[...d],o.rotation=f,o.updateMatrix()},end:()=>{o.repeat=[...u],o.offset=[...p],o.rotation=g,o.updateMatrix()}}}function YQ(e,t){return{update:()=>{e.transparent=t}}}var Rp=new E,f7=new Ri;function XQ(e,t,i,r,s){var f,g,m,v,y,x;let a=[],n,o,l,h,c,d,u,p;if(e instanceof Zi?(n=hd("position",e,t,i,s),n&&a.push(n),l=t1("rotation",e,t,i,s),l&&a.push(l),h=hd("shear",e,t,i,s),h&&a.push(h)):(p={slide:((f=t.pathSnapping)==null?void 0:f.slide)??((g=e.updatedPathSnapping)==null?void 0:g.slide)??((m=e.dataPatched.pathSnapping)==null?void 0:m.slide)??0,offset:((v=t.pathSnapping)==null?void 0:v.offset)??((y=e.updatedPathSnapping)==null?void 0:y.offset)??((x=e.dataPatched.pathSnapping)==null?void 0:x.offset)??0},d=t1("slide",p,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,i.pathSnapping??e.dataPatched.pathSnapping,s),d&&a.push(d),u=t1("offset",p,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,i.pathSnapping??e.dataPatched.pathSnapping,s),u&&a.push(u),!d&&!u&&(n=d7("position",e,t,i,s),n&&a.push(n),o=d7("scale",e,t,i,s),o&&a.push(o),l=QQ(e,t,i,r,s),l&&a.push(l),c=IQ("hiddenMatrix",e,t,i),c&&a.push(c))),n||o||l||c||d||u){let w=e instanceof Zi?()=>{e.updateWorldMatrix(!0)}:()=>{var _;e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),(_=e.parent)!=null&&_.matrixWorldFusedFalse&&(e.matrixWorld.multiplyMatrices(e.parent.matrixWorldFusedFalse,e.matrix),e.matrixWorldNeedsUpdate=!1),Mr(e)&&Xs(e.parent)&&e.invalidateDownstreamBooleanData(!0),e.updatePathSnapping(Object.assign({},t.pathSnapping,p))};a.push({update:w,start:w,end:w})}return a}function QQ(e,t,i,r,s){var c;let a=t!=null&&t.rotation?t.rotation.map(d=>(typeof d=="string"?Number(s.getVariable(d)??0):d)*Oe.DEG2RAD):void 0,n=(c=i.rotation)==null?void 0:c.map(d=>(typeof d=="string"?Number(s.getVariable(d)??0):d)*Oe.DEG2RAD);if(!n)return;let o=a?new E().fromArray(a):new E().setFromEuler(e.rotation),l=new E().fromArray(n);if(o.equals(l))return;let h=Rp.subVectors(l,o);if(r&&h.toArray().every(d=>Math.abs(d)<2*Math.PI)){let d=new lt().setFromEuler(f7.setFromVector3(o)),u=new lt().setFromEuler(f7.setFromVector3(l));return{update:p=>{DQ(d,u,e.quaternion,p)},start:()=>{e.rotation.setFromVector3(o)},end:()=>{e.rotation.setFromVector3(l)}}}else return{update:d=>{Rp.lerpVectors(o,l,d),e.rotation.setFromVector3(Rp)},start:()=>{e.rotation.setFromVector3(o)},end:()=>{e.rotation.setFromVector3(l)}}}function ZQ(e,t,i,r){let s=[];if(!("cloner"in i)||!e.cloner)return s;let a=e.cloner,n="cloner"in t?t.cloner:{},o=i.cloner;tx.forEach(p=>{let f;p==="count"?f=t1("count",a.parameters,n,o,r,!0):f=Qa(p,a.parameters,n??{},o,r),f&&s.push(f)});let l=KQ(a,n,o,r);l!=null&&l.length&&s.push(...l);let h=JQ(a,n,o,r);h!=null&&h.length&&s.push(...h);let c=$Q(a,n,o,r);c!=null&&c.length&&s.push(...c);let d=eZ(a,n,o,r);d!=null&&d.length&&s.push(...d);let u=tZ(a,n,o,r);return u!=null&&u.length&&s.push(...u),s.length&&s.push({update:()=>{a.update()}}),s}function KQ(e,t,i,r){if(e.parameters.type!=="radial")return;let s=t.radial,a=i.radial;if(!a)return;let n=e.parameters.radial,o=[];return ix.forEach(l=>{let h=Qa(l,n,s??{},a,r);h&&o.push(h)}),o}function JQ(e,t,i,r){if(e.parameters.type!=="linear")return;let s=t.linear,a=i.linear;if(!a)return;let n=[],o=e.parameters.linear;return rx.forEach(l=>{let h=Qa(l,o,s??{},a,r);h&&n.push(h)}),n}function $Q(e,t,i,r){if(e.parameters.type!=="grid")return;let s=t.grid,a=i.grid;if(!a)return;let n=[],o=e.parameters.grid;return sx.forEach(l=>{let h;l==="count"?h=O5(l,o,s??{},a,r,!0):h=Qa(l,o,s??{},a,r),h&&n.push(h)}),n}function eZ(e,t,i,r){if(e.parameters.type!=="toObject")return;let s=t.toObject,a=i.toObject;if(!a)return;let n=[],o=e.parameters.toObject;return ax.forEach(l=>{let h;l==="count"?h=t1(l,o,s??{},a,r,!0):h=Qa(l,o,s??{},a,r),h&&n.push(h)}),n}function tZ(e,t,i,r){if(!e.parameters.randomness)return;let s=t.randomnessObject,a=i.randomnessObject;if(!a)return;let n=[],o=e.parameters.randomnessObject;return nx.forEach(l=>{let h=Qa(l,o,s??{},a,r);h&&n.push(h)}),n}function iZ(e,t){return{update:()=>{e instanceof Hi&&(e.fill.enabled=t)}}}function rZ(e,t){return{update:()=>{e instanceof Hi&&(e.stroke.enabled=t)}}}function sZ(e,t){return{update:()=>{e instanceof Hi&&(e.dropShadow.enabled=t)}}}function aZ(e,t){return{update:()=>{e instanceof Hi&&(e.innerShadow.enabled=t)}}}function nZ(e,t){return{update:()=>{e instanceof Hi&&(e.backgroundBlur.enabled=t)}}}function oZ(e,t){return{update:()=>{e instanceof Hi&&(e.layerBlur.enabled=t)}}}function lZ(e,t,i,r,s){let a=[],n,o,l,h,c,d,u,p,f,g,m,v,y,x,w;if("width"in e&&(n=t1("width",e,t,i,s),n&&a.push(n)),"height"in e&&(o=t1("height",e,t,i,s),o&&a.push(o)),e instanceof Hi||e instanceof ds){let _={...t.fill},b={...i.fill};_.enabled!==void 0&&_.enabled!==b.enabled&&(a.push(iZ(e,!0)),_.enabled||Object.assign(_,{enabled:!0,color:{..._.color,a:0}}),b.enabled||Object.assign(b,{enabled:!0,color:{...b.color,a:0}})),l=U0("color",e.fill,_,b,s),l&&a.push(l)}if(e instanceof Hi){let _={...t.stroke},b={...i.stroke};(_.enabled||b.enabled)&&(a.push(rZ(e,!0)),_.enabled||Object.assign(_,{enabled:!0,color:{..._.color,a:0}}),b.enabled||Object.assign(b,{enabled:!0,color:{...b.color,a:0}})),h=U0("color",e.stroke,_,b,s),h&&a.push(h),c=t1("thickness",e.stroke,_,b,s),c&&a.push(c)}if(e instanceof Hi){let _={...t.dropShadow},b={...i.dropShadow};(_.enabled||b.enabled)&&(a.push(sZ(e,!0)),_.enabled||Object.assign(_,{enabled:!0,color:{..._.color,a:0}}),b.enabled||Object.assign(b,{enabled:!0,color:{...b.color,a:0}})),d=U0("color",e.dropShadow,_,b,s),d&&a.push(d),u=t1("blurRadius",e.dropShadow,_,b,s),u&&a.push(u),f=t1("spread",e.dropShadow,_,b,s),f&&a.push(f),p=hd("offset",e.dropShadow,_,b,s),p&&a.push(p)}if(e instanceof Hi){let _={...t.innerShadow},b={...i.innerShadow};(_.enabled||b.enabled)&&(a.push(aZ(e,!0)),_.enabled||Object.assign(_,{enabled:!0,color:{..._.color,a:0}}),b.enabled||Object.assign(b,{enabled:!0,color:{...b.color,a:0}})),g=U0("color",e.innerShadow,_,b,s),g&&a.push(g),m=t1("blurRadius",e.innerShadow,_,b,s),m&&a.push(m),y=t1("spread",e.innerShadow,_,b,s),y&&a.push(y),v=hd("offset",e.innerShadow,_,b,s),v&&a.push(v)}if(e instanceof Hi||e instanceof ds){let _={...t.backgroundBlur},b={...i.backgroundBlur};(_.enabled||b.enabled)&&(a.push(nZ(e,!0)),_.enabled||Object.assign(_,{enabled:!0,radius:0}),b.enabled||Object.assign(b,{enabled:!0,radius:0})),x=t1("radius",e.backgroundBlur,_,b,s),x&&a.push(x)}if(e instanceof Hi){let _={...t.layerBlur},b={...i.layerBlur};(_.enabled||b.enabled)&&(a.push(oZ(e,!0)),_.enabled||Object.assign(_,{enabled:!0,radius:0}),b.enabled||Object.assign(b,{enabled:!0,radius:0})),w=t1("radius",e.layerBlur,_,b,s),w&&a.push(w)}if(e instanceof ds||e instanceof vh){let _=O5("cornerRadius",e,t,i,s);_&&a.push(_)}return a}function m7(e,t,i,r,s){let a=[];return e.data.visible&&a.push(...XQ(e,t,i,s,r)),e instanceof Zi?a.push(...lZ(e,t,i,s,r)):(e.data.visible&&a.push(...ZQ(e,t,i,r)),Mr(e)?(e instanceof g1&&e.data.visible&&a.push(...zQ(e,t,i,r)),e.data.visible&&a.push(...kQ(e,t,i,r))):eW(e)?e.data.visible&&a.push(...FQ(e,t,i,r)):$H(e)&&a.push(...RQ(e,t,i,r))),a.length?{update:n=>{a.forEach(o=>o.update(n))},start:n=>{a.forEach(o=>{var l;return(l=o.start)==null?void 0:l.call(o,n)})},end:n=>{a.forEach(o=>{var l;return(l=o.end)==null?void 0:l.call(o,n)})}}:void 0}var g7=new E;function R5(e,t,i=!1){var a;let r=[],s=n=>{let o=n.data;delete n.states,n.currentState=null,n.reversibleToState=null,n.currentTransitionEvent=null;for(let l of o.states){let h={...l.data};n.states||(n.states={}),n.states[l.id]=_n.patch(o,h)}y7(e.scene,n,null,t,o.events.find(l=>l.data.type==="Follow"||l.data.type==="LookAt")!==void 0),v7(e)};e.scene.traverse2D(s),e.traverseChildren(n=>{var c,d,u,p,f,g;if(i&&((c=n.rigidBody)==null||c.setTranslation(n.position0,!0),(d=n.rigidBody)==null||d.setRotation(n.rotation0,!0),(u=n.rigidBody)==null||u.setLinvel(g7,!0),(p=n.rigidBody)==null||p.setAngvel(g7,!0)),!Et.is(n))return;let o=n.uuid,l=n.data;if(delete n.states,n.uuid===Tl)return;let h=!1;r.some(m=>{var v;return(v=e.scene.find(o))==null?void 0:v.isDescendantOf(m)})?h=!0:((f=l.physics)==null?void 0:f.fusedBody)===!0&&l.physics.rigidBody==="dynamic"&&r.push(o),n.data=l,n.currentState=null,n.reversibleToState=null,n.currentTransitionEvent=null;for(let m of l.states){let v={...m.data};e.data.globalPhysics.usePhysics===!0&&l.physics&&(l.physics.rigidBody==="dynamic"||h)&&(m.data.position!==void 0&&delete v.position,m.data.rotation!==void 0&&delete v.rotation,m.data.hiddenMatrix!==void 0&&delete v.hiddenMatrix),n.states||(n.states={}),n.states[m.id]=bn.patch(l,v)}y7(e.scene,n,null,t,l.events.find(m=>m.data.type==="Follow"||m.data.type==="LookAt")!==void 0),v7(e),n instanceof p1&&n.frame&&(n.frame.traverse(m=>s(m)),(g=n.uiCanvas)==null||g.applySize())}),e.frame&&(e.frame.traverse(n=>s(n)),(a=e.uiCanvas)==null||a.applySize())}function v7(e){e.traverseEntity(t=>{for(let i of t.data.events){let r=[];switch(i.data.type){case"Follow":case"MouseHover":case"Scroll":case"MouseDown":case"MouseUp":case"MousePress":case"KeyUp":case"KeyDown":case"KeyPress":case"Collision":r.push(...i.data.actions);break;case"GameControl":for(let s of Object.values(i.data.gameActions))r.push(...s);break;case"DragDrop":r.push(...i.data.dragDropActions.drag,...i.data.dragDropActions.drop);break;case"Conditional":r.push(...i.data.inActions,...i.data.outActions);break}for(let s of r)if(s.data.type==="Create"&&s.data.hideBase==="Yes"){let a=e.scene.find(s.data.object);a&&(a.visible=!1)}}})}function y7(e,t,i,r,s=!1){if(t instanceof g1&&t.removeInteractionGeometry(r),t instanceof Zi?t.changeSelectedState(i,{shared:r},s):t.changeSelectedState(i,{scene:e,shared:r},s),t instanceof g1&&t.updateGeometryGroupsIfNeeded(),t instanceof v1&&t.updateCameraState(t.dataPatched,{scene:e,shared:r}),!(t instanceof Zi)){if(t.cloner)for(let a of t.cloner.children)a.playModeVisible=void 0;t.updateVisible()}}function Iw(e){let t;if(e.easing===5){let{control1:i,control2:r}=e;t=`cubicBezier(
			${i[0]}, ${i[1]}, ${r[0]}, ${r[1]}
		)`}else if(e.easing===6){let{mass:i,stiffness:r,damping:s,velocity:a}=e;t=`spring( ${i}, ${r}, ${s}, ${a} )`}else{let i;switch(e.easing){case 0:i=_a.linear;break;case 1:i=_a.ease;break;case 2:i=_a.easeIn;break;case 3:i=_a.easeOut;break;case 4:i=_a.easeInOut;break;default:i=_a.linear}let[r,s,a,n]=i;t=`cubicBezier( ${r}, ${s}, ${a}, ${n} )`}return{duration:Math.max(e.duration,1e-4),easing:t}}function qf(e){let t={delay:0,loop:e.repeat===-1?!0:e.repeat+1};if(e.repeat===0)t.direction="normal",t.rewind=!1;else switch(e.direction){case"pingpong":t.direction="alternate",t.rewind=!1;break;case"pingpong-rewind":t.direction="alternate",t.rewind=!0;break;default:t.direction="normal",t.rewind=!1;break}switch(t.delay=0,t.endDelay=0,t.startOnceDelay=0,t.pingPongDelayCorrection=0,t.pingPongEndDelayCorrection=0,e.delayDirection){case"start-once":t.startOnceDelay=e.delay;break;case"start":t.delay=e.delay;break;case"end":t.endDelay=e.delay;break;case"start-end":case void 0:t.delay=e.delay,t.endDelay=e.delay;break}return t.direction==="alternate"&&(t.delay/=2,t.endDelay/=2,e.delayDirection==="start"?(t.pingPongDelayCorrection=t.delay,typeof t.loop=="number"&&t.loop%2===0&&(t.pingPongEndDelayCorrection=t.delay)):e.delayDirection==="end"?typeof t.loop=="number"&&t.loop%2!==0&&(t.pingPongEndDelayCorrection=t.endDelay):e.delayDirection==="start-end"&&(t.pingPongDelayCorrection=t.delay,t.pingPongEndDelayCorrection=t.endDelay)),t}var hZ={type:"beginState"},cZ={type:"completeState",isfromEntity:!1},x7=class{constructor(e,t,i,r,s,a){if(this.object=e,this.data=r,this.sharedAssets=s,this.allowSlerp=a,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.requestRender()),this.targets.t===0||this.targets.t===1?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let n=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=n,this.object.dispatchEvent({type:"beginState",state:n}),this.object instanceof Zi||this.object.traverseEntity(o=>{o!==this.object&&o instanceof v1&&o.dispatchEvent(hZ)})},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let n=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=n,this.object.dispatchEvent({type:"completeState",state:n}),this.object instanceof Zi||this.object.traverseEntity(o=>{o!==this.object&&o instanceof v1&&o.dispatchEvent(cZ)})},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=m7(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},t===void 0){let n=nc(this.object,this.object.currentState===i?this.object.prevState:this.object.currentState);if(!n)throw new Error("Missing property");this.from=n}else{let n=nc(this.object,t);if(!n)throw new Error("Missing property");this.from=n}if(i===void 0)throw new Error("Missing property");{let n=nc(this.object,i);if(!n)throw new Error("Missing property");this.to=n}this.useCurrentState=t===void 0||i===void 0,this.params={targets:this.targets,t:1,autoplay:!1,...qf(r),...Iw(r),change:this.onChange},this.callback=m7(this.object,t===void 0?{}:this.from.data,i===void 0?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},Ow=class extends l1{constructor(e,t,i,r,s){var n;if(super(),this.eventType=e,this.data=t,this.page=i,this.shared=r,this.condition=s,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.hasPlayedOnce=!1,this.onTimelineChangeComplete=()=>{var o;this.data.tweens[0].data.direction!=="normal"&&(this.toggleIsForward=!this.toggleIsForward),this.timelineNeedsRebuild!==!1&&((o=this.timeline)==null||o.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!1,isRebuild:!0}),this.timeline.play())},!t.object)throw new Error("Missing property");let a=this.page.scene.find(t.object)??((n=this.page.uiCanvas)==null?void 0:n.find(t.object))??this.page.scene.find2DInUIObjects(t.object);if(!a)throw new Error("Missing property");if(!a.states)throw new Error("Missing property");if(this.object=a,t.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay=t.tweens[0].data.delayDirection==="start-once"?t.tweens[0].data.delay:0,this.init()}get playing(){var e;return((e=this.timeline)==null?void 0:e.paused)===!1}get changeBegan(){return this.tweens.some(e=>e.changeBegan)??!1}init(){this.initialCurrentState=nc(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return this.data.runMode==="Toggle"&&p9(this.eventType)?this.initialCurrentState:this.object.currentState}buildTimeline({isForward:e=!0,needsRebuild:t=!1,isRebuild:i=!1}={}){var r,s,a,n;try{let o=qf(this.data.tweens[0].data);i&&typeof o.loop=="number"&&o.loop--,(r=this.timeline)==null||r.pause(),this.timeline=Dw.timeline({autoplay:!1,...o,...o.loop===!0||o.loop>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}});let l=this.tweens.findIndex(h=>h==null?void 0:h.changeBegan);if(t===!0&&(this.timelineNeedsRebuild=!0),e){let h=l===-1?0:l;for(let c=h;c<this.data.tweens.length-1;c++){let d=this.data.tweens[c],u=this.data.tweens[c+1],p;c===h&&(this.object.wasMovedByUser===!0||((s=this.object.previousAction)==null?void 0:s.changeBegan)===!0)?(p=void 0,this.object instanceof v1&&(this.object.wasMovedByUser=!1)):p=d.data.state===void 0?this.currentState:d.data.state;let f=new x7(this.object,p,u.data.state===void 0?this.currentState:u.data.state,u.data,this.shared,this.data.allowSlerp??!1);l!==-1&&c===h&&Object.assign(f.params,{startOnceDelay:0}),this.tweens[c]=f,this.timeline.add(f.params,this.timeline.duration+(c===h?o.delay:0))}this.timeline.duration+=o.endDelay}else{let h=l===-1?this.data.tweens.length-1:l+1;for(let c=h;c>0;c--){let d=this.data.tweens[c],u=this.data.tweens[c-1],p;c===h&&(this.object.wasMovedByUser===!0||((a=this.object.previousAction)==null?void 0:a.changeBegan)===!0)?(p=void 0,this.object instanceof v1&&(this.object.wasMovedByUser=!1)):p=d.data.state===void 0?this.currentState:d.data.state;let f=new x7(this.object,p,u.data.state===void 0?this.currentState:u.data.state,d.data,this.shared,this.data.allowSlerp??!1);l!==-1&&c===h&&Object.assign(f.params,{startOnceDelay:0}),this.tweens[c-1]=f,this.timeline.add(f.params,this.timeline.duration+(c===h?o.endDelay:0))}this.timeline.duration+=o.delay}}catch(o){o instanceof Error&&o.message}((n=this.object.previousAction)==null?void 0:n.playing)===!0&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(Jt(this.shared,this.condition)===!1||p9(this.eventType)&&this.data.runMode==="Once"&&this.hasPlayedOnce||(this.hasPlayedOnce=!0,this.playing))return!1;clearTimeout(this.timeoutId);let e=qf(this.data.tweens[0].data).pingPongDelayCorrection;this.timeoutId=window.setTimeout(()=>{try{this.buildTimeline(),this.timeline.play()}catch(t){t instanceof Error&&t.message}},this.startOnceDelay+e)}pause(){var e;(e=this.timeline)==null||e.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let e=this.data.tweens[0].data.state===void 0?this.initialCurrentState:this.data.tweens[0].data.state;this.object instanceof Zi?this.object.changeSelectedState(e,{shared:this.shared}):this.object.changeSelectedState(e,{scene:this.page.scene,shared:this.shared}),this.object.currentState=e}seek(e){var t;if(Jt(this.shared,this.condition)===!1)return!1;this.timeline===void 0&&this.buildTimeline(),(t=this.timeline)==null||t.seek(e*this.timeline.duration,!0)}toggle(e){var t;if(Jt(this.shared,this.condition)===!1)return!1;clearTimeout(this.timeoutId),this.toggleIsForward=e??!this.toggleIsForward,this.playing?((t=this.timeline)==null||t.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!0}),this.timeline.play()):this.timeoutId=window.setTimeout(()=>{var i;(i=this.timeline)==null||i.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function nc(e,t){var s;let i,r;if(typeof t=="string"?(i=t,r=(s=e.states)==null?void 0:s[i]):t===null&&(i=null,r=e.data),!(i===void 0||r===void 0))return{id:i,data:r}}var dZ={type:"beginState"},b7={type:"completeState",isfromEntity:!1},w7={type:"requestRender"},Rw=class extends l1{constructor(e,t,i,r){super(),this.data=e,this.page=t,this.shared=i,this.condition=r,this.toggleIsForward=!1,this.posStart=new E,this.posEnd=new E,this.qStart=new lt,this.qEnd=new lt,this.zoomStart=1,this.zoomEnd=1}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(e=!1){if(!this.data.animate)return;let t=this.page.scene.find(this.data.targetCamera);if(!t||!t.visible)throw new ReferenceError("Target camera not founded or not visible");let i={t:0};this.posStart.copy(this.page.activeCamera.position),this.qStart.copy(this.page.activeCamera.quaternion),this.zoomStart=this.page.activeCamera.zoom,this.animation=Dw({targets:i,t:1,...Iw(this.data),update:()=>{i.t===0&&(this.data.runMode==="Toggle"&&!this.toggleIsForward?this.fromCamera&&(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera.uuid)):(this.posEnd.copy(t.position),this.qEnd.copy(t.quaternion),this.zoomEnd=t.zoom,this.fromCamera=this.page.activeCamera,this.switchCamera(t.uuid)),this.page.activeCamera.dispatchEvent(dZ));let r=this.page.activeCamera;r.position.lerpVectors(this.posStart,this.posEnd,i.t),r.quaternion.slerpQuaternions(this.qStart,this.qEnd,i.t),r.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*i.t,r.wasMovedBySwitchCameraAction=!0,r.updateMatrix(),r.updateMatrixWorld(),r.updateProjectionMatrix(),r.dispatchEvent(w7),i.t===1&&r.dispatchEvent(b7)}})}switchCamera(e){let t=this.page.activeCamera,i=this.page.scene.find(e);if(!i||!i.visible)throw new ReferenceError("Target camera not founded or not visible");this.page.switchActiveCamera(i),t.dispatchEvent({type:"cameraChange",camera:i})}play(){if(Jt(this.shared,this.condition)===!1)return!1;if(!this.playing&&this.page.activeCamera.uuid!==this.data.targetCamera)try{clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var e;delete this.timeoutId,this.data.animate?(this.buildAnimation(),(e=this.animation)==null||e.play()):this.switchCamera(this.data.targetCamera)},this.data.delay*1e3)}catch{}}pause(){var e;(e=this.animation)==null||e.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(e){var t,i;if(Jt(this.shared,this.condition)===!1)return!1;if(window.clearTimeout(this.timeoutId),delete this.timeoutId,e!==this.toggleIsForward)try{this.playing?((t=this.animation)==null||t.pause(),this.toggleIsForward=e??!this.toggleIsForward,this.buildAnimation(!0),(i=this.animation)==null||i.play()):this.timeoutId=window.setTimeout(()=>{var r,s;this.toggleIsForward=e??!this.toggleIsForward,this.data.animate?((r=this.animation)==null||r.pause(),this.buildAnimation(),(s=this.animation)==null||s.play()):(this.toggleIsForward?(this.fromCamera=this.page.activeCamera,this.switchCamera(this.data.targetCamera)):this.fromCamera&&this.switchCamera(this.fromCamera.uuid),this.page.activeCamera.dispatchEvent(b7),this.page.activeCamera.dispatchEvent(w7))},this.data.delay*1e3)}catch{}}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause(),this.toggleIsForward=!1}};function Lw(e){let t=e==null?void 0:e.tracks.filter(i=>i.ValueTypeName==="vector"||i.ValueTypeName==="quaternion").map(i=>i.times.length);if(t!=null&&t.length){let i=jF(t);return i&&i>2?i:2}return 2}var Bw=class extends l1{constructor(e,t,i,r,s){var l,h,c;super(),this.data=e,this.page=t,this.animationControls=i,this.shared=r,this.condition=s,this.startOnceDelay=0,this.toggleIsForward=!1;let a=e.object,n=t.scene.find(e.object);n&&Array.isArray(n.identity)&&(a=n.identity[0]),this.data={...e,object:a};let o=this.animationControls.clipIdToAction[e.clipId+"/"+a];if(this.duration=((l=o==null?void 0:o.getClip())==null?void 0:l.duration)??1,this.data.crop2){let d=Lw(o==null?void 0:o.getClip());this.leftFrameTime=this.data.crop2[0]/(d-1)*this.duration,this.rightFrameTime=this.data.crop2[1]/(d-1)*this.duration}else{let d=(c=(h=o==null?void 0:o.getClip())==null?void 0:h.tracks[0])==null?void 0:c.times.length;d&&d>1?(this.leftFrameTime=this.data.crop[0]/d*this.duration,this.rightFrameTime=this.data.crop[1]/d*this.duration):(this.leftFrameTime=0,this.rightFrameTime=this.duration)}this.startOnceDelay=e.delay}get playing(){var e;return((e=this.threeAnimAction)==null?void 0:e.isRunning())??!1}play(e=!1){if(Jt(this.shared,this.condition)===!1)return!1;window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var i;if(this.threeAnimAction=this.animationControls.play(this.data),!this.threeAnimAction)return;this.threeAnimAction.reset(),this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime;let t=this.data.object;Object.entries(this.animationControls.clipIdToAction).forEach(([r,s])=>{let a=r.split("/")[1];this.threeAnimAction!==s&&a===t&&s.isRunning()&&(e?s.fadeOut(.2):s.stop())}),e&&((i=this.threeAnimAction)==null||i.fadeIn(.2))},this.startOnceDelay)}pause(){this.threeAnimAction&&(this.threeAnimAction.paused=!0),window.clearTimeout(this.timeoutId),delete this.timeoutId}stop(){var e;(e=this.threeAnimAction)==null||e.fadeOut(.2)}seek(e){this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction&&(this.threeAnimAction.paused=!0,this.threeAnimAction.time=Oe.clamp(this.threeAnimAction.time+1/60*e,this.leftFrameTime,this.rightFrameTime-16e-5),this.animationControls.needsUpdate=!0,this.animationControls.requestRender())}toggle(e,t=!1){if(Jt(this.shared,this.condition)===!1)return!1;this.toggleIsForward=e??!this.toggleIsForward,this.threeAnimAction&&(this.threeAnimAction._loopCount=0),this.playing?this.threeAnimAction&&(this.threeAnimAction.timeScale=this.toggleIsForward?1:-1,this.toggleIsForward?(this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime)):this.timeoutId=window.setTimeout(()=>{var i;if(this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction){this.toggleIsForward?(this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction.time=this.rightFrameTime,this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime),this.threeAnimAction.paused=!1,this.threeAnimAction.timeScale=this.toggleIsForward?1:-1;let r=this.data.clipId.split("/")[1];Object.entries(this.animationControls.clipIdToAction).forEach(([s,a])=>{let n=s.split("/")[1];this.threeAnimAction!==a&&n===r&&a.isRunning()&&(t?a.fadeOut(.2):a.stop())}),t&&((i=this.threeAnimAction)==null||i.fadeIn(.2))}},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){var t;let e=(t=this.animationControls.clipIdToAction[this.data.clipId+"/"+this.data.object])==null?void 0:t.getClip();e&&(e.duration=this.duration),this.pause()}},zw=class{constructor(e,t,i,r,s){this.data=e,this.page=t,this.eventManager=i,this.shared=r,this.condition=s,this.timeOutId=-1,this.scene=t.scene}dispatch(){if(Jt(this.shared,this.condition)===!1)return!1;this.data.target!==this.page.uuid&&(window.clearTimeout(this.timeOutId),this.timeOutId=window.setTimeout(()=>{this.play()},this.data.delay*1e3))}dispose(){window.clearTimeout(this.timeOutId)}play(){if(this.scene.children.every(t=>t.uuid!==this.data.target))return;this.data.transition==="fade"&&this.data.duration>0&&this.eventManager.eventContext.renderer.renderFromSceneForSceneTransitionPass(this.scene,this.scene.activeCamera,this.data.duration*1e3),this.eventManager.deactivate(),this.eventManager.controlsManager.deactivate();let e=this.scene.activeCamera;this.scene.updatePage(this.data.target),this.scene.traverseVisibleEntity(t=>{t.type==="ParticleSystem"&&(t.sleep(),t.wakeUp(),t.data.autoPlay?t.start():t.stop())}),this.scene.activePage.switchToPlayCamera(),this.scene.activeCamera.copyViewPlaneSize(e),R5(this.scene.activePage,this.shared),this.eventManager.activate(),this.eventManager.controlsManager.activate(this.eventManager)}},Fw=class{constructor(e,t,i,r){this.data=e,this.page=t,this.shared=i,this.condition=r,this.evaluatedCondition=!1}checkConditions(){this.evaluatedCondition=Jt(this.shared,this.condition)}dispatch(){if(this.evaluatedCondition===!1)return!1;let e=this.shared.getVariable(this.data.variableId),t=Nx(this.data.expression,this.shared,n1.typeOfVariable(e));t!==void 0&&this.shared.updateVariable(this.data.variableId,typeof t=="string"?{textValue:t}:t)}dispose(){}},kw=class{constructor(e,t,i,r){this.data=e,this.page=t,this.shared=i,this.condition=r,this.timeoutId=null}dispatchInner(){if(Jt(this.shared,this.condition)===!1)return!1;let e=this.shared.getDynamicVariablePlayState(this.data.variableId);if(this.data.mode==="PlayPause")this.shared.getDynamicVariableToggleIsForward(this.data.variableId)===void 0&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,e==="Playing"?"Paused":"Playing");else if(this.data.mode==="Play"&&e!=="Playing")this.shared.getDynamicVariableToggleIsForward(this.data.variableId)===void 0&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing");else if(this.data.mode==="Stop"&&e!=="Stopped")this.shared.setDynamicVariablePlayState(this.data.variableId,"Stopped");else if(this.data.mode==="Pause"&&e!=="Paused")this.shared.setDynamicVariablePlayState(this.data.variableId,"Paused");else if(this.data.mode==="Restart")this.shared.setDynamicVariablePlayState(this.data.variableId,"Restarted");else if(this.data.mode==="Toggle"){let t=this.shared.getDynamicVariableToggleIsForward(this.data.variableId);e==="Playing"?this.shared.setDynamicVariableToggleIsForward(this.data.variableId,t===void 0?!1:!t):(this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!t),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing"))}}dispatch(){let e=this.data.delay,t=this.shared.getDynamicVariablePlayState(this.data.variableId);this.data.mode==="PlayPause"&&t==="Playing"&&(e=this.data.pauseDelay),e!==0?(this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.timeoutId=null,this.dispatchInner()},e)):this.dispatchInner()}dispose(){this.timeoutId&&window.clearTimeout(this.timeoutId)}},uZ=class{constructor(e,t,i,r){this.data=e,this.page=t,this.shared=i,this.condition=r}dispatch(){if(Jt(this.shared,this.condition)===!1)return!1;(this.data.target==="single"?this.data.variableId?[this.data.variableId]:[]:Object.keys(this.shared.getVariables())).forEach(e=>{var i;this.shared.getVariable(e);let t=(i=this.shared.data.variables.data(e))==null?void 0:i.value;t!==void 0&&this.shared.updateVariable(e,t),this.shared.enableLocalStorageForPersistentVariables&&localStorage.removeItem(Af(e))})}dispose(){}},pZ=class{constructor(e,t,i,r){this.data=e,this.page=t,this.shared=i,this.condition=r}dispatch(){var e;if(Jt(this.shared,this.condition)===!1)return!1;this.data.userAPIId&&((e=this.shared.getUserAPI(this.data.userAPIId))==null||e.callUserAPI(this.shared))}dispose(){}};function Jt(e,t){if(t===void 0)return!0;if(t.expression.length===0)return!1;let i=Nx(t.expression,e,"boolean");return t.negate?!i:!!i}function Ci(e,t,i,r,s,a){let n={Audio:[],Video:[],Particles:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[],Animation:[],SceneTransition:[],SetVariable:[],DynamicVariablePlay:[],ClearLocalStorage:[],UserAPI:[]},o=l=>({id:h,data:c})=>{try{c.type==="Audio"?d1[e.type].includes("Audio")&&n.Audio.push(new cw(h,c,a,r,l)):c.type==="Video"&&!(a instanceof Zi)?d1[e.type].includes("Video")&&n.Video.push(new Nw(h,c,a,r,l)):c.type==="Particles"?d1[e.type].includes("Particles")&&n.Particles.push(new dw(c,i,r,l)):c.type==="Link"?d1[e.type].includes("Link")&&n.Link.push(new $X(c,s.controlsManager,r,l)):c.type==="Create"?d1[e.type].includes("Create")&&n.Create.push(new Vw(c,i,s.controlsManager,r,l)):c.type==="Destroy"?d1[e.type].includes("Destroy")&&n.Destroy.push(new uw(c,i,s.controlsManager,r,l)):c.type==="Reset"?d1[e.type].includes("Reset")&&n.Reset.push(new pw(c,i,r,s,l)):c.type==="Transition"?d1[e.type].includes("Transition")&&n.Transition.push(new Ow(e.type,c,i,r,l)):c.type==="SwitchCamera"?d1[e.type].includes("SwitchCamera")&&n.SwitchCamera.push(new Rw(c,i,r,l)):c.type==="SceneTransition"?d1[e.type].includes("SceneTransition")&&n.SceneTransition.push(new zw(c,i,s,r,l)):c.type==="Animation"?d1[e.type].includes("Animation")&&n.Animation.push(new Bw(c,i,s.animationControls,r,l)):c.type==="SetVariable"?d1[e.type].includes("SetVariable")&&n.SetVariable.push(new Fw(c,i,r,l)):c.type==="DynamicVariablePlay"?d1[e.type].includes("DynamicVariablePlay")&&n.DynamicVariablePlay.push(new kw(c,i,r,l)):c.type==="Conditional"?d1[e.type].includes("Conditional")&&(c.ifActions.forEach(o({expression:c.condition,negate:!1})),c.elseActions.forEach(o({expression:c.condition,negate:!0}))):c.type==="ClearLocalStorage"?d1[e.type].includes("ClearLocalStorage")&&n.ClearLocalStorage.push(new uZ(c,i,r,l)):c.type==="UserAPI"&&d1[e.type].includes("UserAPI")&&n.UserAPI.push(new pZ(c,i,r,l))}catch{}};return t.forEach(o()),n}function Qi(e){Object.values(e).forEach(t=>{t.forEach(i=>{(i instanceof cw||i instanceof Nw||i instanceof dw||i instanceof Bw||i instanceof Ow||i instanceof Vw||i instanceof uw||i instanceof Rw||i instanceof zw||i instanceof pw||i instanceof Fw||i instanceof kw)&&i.dispose()})})}function fZ(e,t){let i;if("material"in e){let r=e.material;Array.isArray(r)?i=e.material[0].layers.find(s=>s.uuid===t):i=e.material.layers.find(s=>s.uuid===t)}if(i)return i.color.texture.image.img instanceof HTMLVideoElement?i.color.texture.image.img:void 0}var Uw=new Map,D2=new Map,el=class{constructor(e,t,i){this.data=t,this.delay=0,this.status="stopped";let{layerId:r,loop:s,volume:a,delay:n}=t;if(this.object=i,r===void 0)throw new Error("Missing property");let o=fZ(i,r);o&&(this.videoElement=o,this.videoElement.loop=s===1/0,ch&&(this.videoElement.autoplay=!0),a!==void 0&&(this.videoElement.volume=a)),n!==void 0&&(this.delay=n),D2.has(i.uuid)?D2.get(i.uuid).push(this):D2.set(i.uuid,[this]),Uw.set(e,this),this.pause()}mute(){!this.videoElement||(this.videoElement.muted=!0)}unMute(){!this.videoElement||(this.videoElement.muted=!1)}play(e){if(!this.videoElement)return;let t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);e?(this.mute(),this.delay+=150):t?(this.mute(),window.setTimeout(()=>{this.unMute()},100)):this.unMute(),this.delayTimerId=window.setTimeout(()=>{if(!this.videoElement)return;let i=this.videoElement.play();i!==void 0&&i.then(r=>{}).catch(r=>{this.play()}),this.clearDelay()},this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){!this.videoElement||(this.videoElement.pause(),this.status="paused")}stop(){!this.videoElement||(this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay())}playByToggle(){this.data.toggle==="stop"?this.status==="playing"?this.stop():(this.stop(),this.play()):this.data.toggle==="pause"?this.status==="playing"?this.pause():this.play():(this.stop(),this.play())}dispose(){!this.videoElement||(this.stop(),this.videoElement.muted=!0)}},Yf=class{constructor(e){this.data=e}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(e){let t=Uw.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t[this.data.interaction](),this.disposeDelay()},this.data.delay)):t[this.data.interaction]())}pauseAllVideosFromObject(e){let t=D2.get(e);!(t!=null&&t.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(i=>i[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(i=>i[this.data.interaction]()))}pauseAllVideos(){let e=[...D2.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(i=>{i[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(i=>{i[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},Nw=class{constructor(e,t,i,r,s){if(this.data=t,this.shared=r,this.condition=s,t.interaction==="play")this.interaction=new el(e,t,i);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new Yf(t);else throw new Error("Missing property")}dispatchBasic(){if(Jt(this.shared,this.condition)===!1)return!1;this.interaction instanceof el?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(Jt(this.shared,this.condition)===!1)return!1;this.interaction instanceof el?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},S7=(()=>{let e,t,i,r;function s(o){!e&&!_7()&&(t==null?void 0:t.sharedGameControlGlobals.createdObjects.length)>0&&(e=requestAnimationFrame(a)),o&&(t=o,r=o.requestRender)}function a(o){let l=i?o-i:0,h=t.sharedGameControlGlobals.createdObjects,c=t.sharedGameControlGlobals.nCreatedPerAction,d=h.length,u=0;for(;u<d;){let p=h[u];p.userData.createdTime===void 0&&(p.userData.createdTime=o),p.userData.lifetime===void 0&&p.userData.quantity===void 0||p.userData.lifetime&&o-p.userData.createdTime<p.userData.lifetime||p.userData.quantity&&c[p.userData.actionId]<=p.userData.quantity?(p.userData.velocity&&(p.position.addScaledVector(p.userData.velocity,l/1e3),p.updateMatrix(),r()),u++):(c[p.userData.actionId]>p.userData.quantity&&c[p.userData.actionId]--,h.splice(u,1),p.removeFromParent(),t.sharedGameControlGlobals.rapierWorld&&p.rigidBody?(t.sharedGameControlGlobals.colliderToEntity.delete(p.rigidBody.collider(0).handle),t.sharedGameControlGlobals.rapierWorld.removeRigidBody(p.rigidBody)):(p.bvhGeometry=void 0,t.sharedGameControlGlobals.entitiesWithTransformAnim=t.sharedGameControlGlobals.entitiesWithTransformAnim.filter(f=>f.bvhGeometry!==void 0)),d--,r())}e=u>0?requestAnimationFrame(a):void 0,i=u>0?o:void 0}function n(){_7()?e&&(cancelAnimationFrame(e),e=void 0,i=void 0):s()}return typeof document<"u"&&document.addEventListener("visibilitychange",n),s})();function _7(){return!!document&&document.hidden}var A7=new lt,mZ=new E,gZ=new E,Vw=class{constructor(e,t,i,r,s){this.data=e,this.page=t,this.controlsManager=i,this.shared=r,this.condition=s,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=Oe.generateUUID(),this.dispatch=()=>{if(Jt(this.shared,this.condition)===!1)return!1;this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()},this.dispatchFromStart=()=>{if(Jt(this.shared,this.condition)===!1)return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))},this.dispatchThrottled=nk(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{this.intervalId===null&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{this.timeoutIdQueue.shift();let n=new m1(this.object);if(n.playModeVisible=!0,n.expand(),this.data.coordinateSystem!=="world"){let l=this.data.coordinateSystem,h=this.page.scene.find(l);h&&(h.updateMatrixWorldSVD(),n.hiddenMatrix.copy(h.matrixWorldRigid))}n.scale.copy(this.object.scale),n.position.fromArray(this.data.position),n.rotation.fromArray(this.data.rotation),n.updateMatrix(),this.page.add(n);let o=this.controlsManager.sharedGameControlGlobals;o.createdObjects.push(n),o.nCreatedPerAction[this.uniqueId]===void 0?o.nCreatedPerAction[this.uniqueId]=1:o.nCreatedPerAction[this.uniqueId]++,n.updateWorldMatrix(!0,!0),n.traverseObject(this.traverseObjectCB),S7(),this.controlsManager.requestRender()},this.traverseObjectCB=n=>{var c,d,u,p;n.hasNonUniformScale&&n.updateMatrixWorldSVD();let o;if(this.controlsManager.sharedGameControlGlobals.rapierWorld){if(n instanceof Pr)if(n.objectForSample){if(n.objectForSample.dataPatched.physics.fusedBody)return;o=n.object}else return n.object.dataPatched.physics.fusedBody===!0&&n.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(n instanceof m1)o=n.object;else if(o=n,(c=o.dataPatched.cloner)==null?void 0:c.hideBase)return!0}else{if(n instanceof Pr)return;n instanceof m1?o=n.object:o=n}this.data.destroy==="Time"?n.userData.lifetime=this.data.lifetime*1e3:this.data.destroy==="Quantity"&&(n.userData.quantity=this.data.destroyAfterQuantity,n.userData.actionId=this.uniqueId);let l=new E().fromArray(this.data.velocity),h=o.dataPatched;if(!(h.physics.enabled==="visibility"?!h.visible:!h.physics.enabled)&&(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(n,o,{fromCreate:!0,dynamic:this.data.dynamic}),this.data.destroy==="Collision"&&((d=n.rigidBody)==null||d.collider(0).setActiveEvents(1),n.userData.hasCollisionDestroy=!0),n.matrixWorld.decompose(mZ,A7,gZ),l.applyQuaternion(A7),this.data.velocity.some(f=>f!==0)&&this.data.dynamic&&((u=n.rigidBody)==null||u.setLinvel(l.divideScalar(this.controlsManager.pixelsPerMeter),!0))):("geometry"in n.object&&this.controlsManager.addBoundsTree(n),this.data.velocity.some(f=>f!==0)&&this.data.dynamic&&(n.userData.velocity=l)),((p=o.dataPatched.physics)==null?void 0:p.fusedBody)===!0))return!0};let a=this.page.scene.find(this.data.object);if(!a)throw new Error("Missing Property");if(this.object=a,this.data.coordinateSystem!=="world"&&!this.page.scene.find(this.data.coordinateSystem))throw new Error("Missing Property");S7(i)}dispose(){this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timeoutIdQueue.forEach(e=>window.clearTimeout(e)),this.dispatchThrottled.cancel(),this.page.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},jw=200,Lp=.02,Bp=.3,vZ=65;new E;var M7=new E,E7=new E,yZ=new E,_1=new E,R1=new E,xa=new E,zp=new we,C7=new we,xZ=new we;new we;var wr=new lt,Ts=new lt,Yr=new Ri(0,0,0,"YXZ"),bZ=new E(1,0,0),Sr=new E(0,1,0),wZ=new E(0,0,1),T7=new E(1,1,1);new V1;var SZ=1,_Z=.025,AZ=16e-6,P7=12,MZ=20,Ni=new hr,$1=new vi,EZ={type:"requestRender"},CZ={type:"updateMatrix"},D7=Math.PI/6,Xf=class extends l1{constructor(e,t,i,r,s,a,n,o,l){var f;super(),this.object=e,this.domElement=t,this.data=i,this.gloabalPhysics=r,this.controlsManager=s,this.cameraFollow=a,this.camera=n,this.page=o,this.sharedAssets=l,this.enableDamping=!0,this.hiddenMatrix0=new we,this.target0=new E,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.pixelsPerMeter=jw,this.euler0=new Ri(0,0,0,"YXZ"),this.position0Cam=new E,this.quat0Cam=new lt,this.scale0Cam=new E,this.hiddenMatrix0Cam=new we,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new hr(new E(0,-40,0),new E(0,40,0)),matrix:new we,position:new E,rotation:new lt},this.euler=new Ri(0,0,0,"YXZ"),this.eulerDelta=new E,this.lastPosition=new E,this.lastCameraQuaternion=new lt,this.lastCameraPosition=new E,this.PI_2=Math.PI/2,this.prevMouse=new j,this.velocityTarget=new E,this.velocity=new E,this.directionXZ=new E,this.rotVelocityStick=new E,this.rotVelocityTarget=new E,this.rotVelocity=new E,this.rotDirection=new E,this.nonColliderRotOffset=new we,this.nonColliderPosOffset=new we,this.firstPointerId=-1,this.rot=new E,this.path=[],this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new we,this.objectToTarget=new E,this.objectToTarget0=new E,this.objectToCamXZ=new E,this.objectToCamXZ0=new E,this.targetToCamera=new E,this.targetToCamera0=new E,this.cameraPolarAxis0=new E,this.targetPos=new E,this.targetQuat=new lt,this.lerpFactorPos=new E().setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new lt,this.objXZQuatInv=new lt,this.objXZRotMat=new we,this.isFirstPerson=!1,this.didHit=!1,this.groundVelocity=new E,this.pushedVelocity=new E,this.groundYRotation=0,this.objectRealQuat=new lt,this.colliderWorldQuat=new lt,this.groundNormal=new E,this.groundTilt=new lt,this.groundTiltInv=new lt,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.navMeshPathDest=null,this.position=new E,this.quaternion=new lt,this.scale=new E,this.initialAction=!0,this.onPointerDown=g=>{var m;!(g.target===this.domElement||g.target instanceof HTMLElement&&g.target.tagName==="SPLINE-VIEWER"&&((m=g.target.shadowRoot)!=null&&m.contains(this.domElement)))||this.firstPointerId!==-1||(this.firstPointerId=g.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.rotBy!=="keys"&&!q1&&!J6&&this.domElement.requestPointerLock(),this.prevMouse.set(g.clientX,g.clientY))},this.onPointerUp=g=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),g.pointerType==="mouse"&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=g=>{if(g.pointerId!==this.firstPointerId)return;let m=g.clientX-this.prevMouse.x,v=g.clientY-this.prevMouse.y;this.prevMouse.set(g.clientX,g.clientY),g.pointerType==="mouse"&&this.rotBy!=="keys"&&(J6&&gk<15.5&&!q1?(this.eulerDelta.y=-m*this.mouseOrbitSensitivity,this.eulerDelta.x=-v*this.mouseOrbitSensitivity):(this.eulerDelta.y=-g.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-g.movementY*this.mouseOrbitSensitivity)),g.pointerType!=="mouse"&&this.rotByTouch==="drag"&&(this.eulerDelta.y=-m*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-v*this.mouseOrbitSensitivity*5),this.controlsManager.requestRender()},this.onPointerlockChange=g=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?Xf.isLocked=!0:Xf.isLocked=!1},this.onPointerlockError=()=>{},this.handleVisibilityChange=()=>{if(document!=null&&document.hidden)for(let g in this.movementState)this.movementState[g]=0},this.onKeyDown=g=>{!(g.target instanceof HTMLInputElement)&&(g.code==="ArrowLeft"||g.code==="ArrowUp"||g.code==="ArrowRight"||g.code==="ArrowDown"||g.code==="Space")&&g.preventDefault();for(let m of this.keyAssignments)if(g.key.toUpperCase()===m[1]||g.key===m[1]){this.movementState[m[0]]=1;break}this.controlsManager.requestRender()},this.onKeyUp=g=>{for(let m of this.keyAssignments)if(g.key.toUpperCase()===m[1]||g.key===m[1]||g.code.slice(3,g.code.length).toUpperCase()===m[1]){this.movementState[m[0]]=0;break}},this.copyVRGamePadValues=(g,m)=>{for(let v=2;v<4;v++){let y=g.axes[v];m===0?v===2?this.movementState.movePosX=y:this.movementState.movePosZ=y:(g.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,v===2?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(y)>=.3&&(this.vrEulerYOffset+=y<0?1:-1),this.movementState.rotPosY=y):this.moveMode==="fly"&&(this.movementState.moveNegY=y))}},this.sharedGameControlGlobals=s.sharedGameControlGlobals,e===n&&(this.isFirstPerson=!0),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.euler0.setFromQuaternion(this.quaternion,"YXZ");let h=this.euler0.clone(),c=h.y;if(this.objectRealQuat.copy(this.quaternion),h.y=0,this.quaternion.setFromEuler(h),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),h.set(0,c,0),this.quaternion.setFromEuler(h),this.rot.setFromEuler(h),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||this.cameraFollow===!0)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),this.cameraFollow===!0){this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy((f=this.camera)==null?void 0:f.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let g=new E(0,0,-1).applyQuaternion(this.camera.quaternion),m=new E().subVectors(this.position,this.camera.position);this.objectToCamXZ.copy(m),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ);let v,y;Math.abs(g.y)<1e-6?(m.y=0,g.y=0,y=m.projectOnVector(g)):m.y/g.y>0?y=g.multiplyScalar(m.y/g.y):y=g.multiplyScalar(m.length()),this.targetToCamera0.copy(y).negate(),v=this.camera.position.clone().add(y),this.objectToTarget0.subVectors(v,this.position);let x=new Ri().setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-x.x,x.x=0,x.z=0,x.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(x)}if(this.object instanceof v1&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.rotByTouch=i.rotByTouch??"joystick",this.rotBy=i.rotBy??"keys",this.rotationMode=i.rotationMode??"normal",this.moveMode=i.moveMode??"walk",this.collisionEnabled=i.collisionEnabled,this.speedTranslate=(i.speedTranslate??250)*SZ,this.speedOrbit=(i.speedRotate??100)*_Z,this.mouseOrbitSensitivity=(i.speedRotate??100)*AZ,this.keyAssignments=i.keyAssignments.map(g=>{let m=[g[0],g[1]];return m[1]===""?m[1]="ArrowUp":m[1]===""?m[1]="ArrowLeft":m[1]===""?m[1]="ArrowDown":m[1]===""?m[1]="ArrowRight":m[1]===""?m[1]="Shift":m[1]===""?m[1]="Enter":m[1]==="Space"?m[1]=" ":m[1]===""?m[1]="Meta":m[1]==="Ctrl"?m[1]="Control":m[1]==="Esc"&&(m[1]="Escape"),m}),i.rotBy==="mouse"){let g;g=this.keyAssignments.findIndex(m=>m[0]==="rotNegX"),g!==-1&&(this.keyAssignments[g][1]=""),g=this.keyAssignments.findIndex(m=>m[0]==="rotPosX"),g!==-1&&(this.keyAssignments[g][1]=""),g=this.keyAssignments.findIndex(m=>m[0]==="rotPosY"),g!==-1&&(this.keyAssignments[g][1]=""),g=this.keyAssignments.findIndex(m=>m[0]==="rotNegY"),g!==-1&&(this.keyAssignments[g][1]="")}this.lerpFactorPosStart=1-.02**(1/((i.delayPos[0]??.3)*60)),this.lerpFactorPosEnd=1-.02**(1/((i.delayPos[1]??.3)*60)),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/((i.delayRot[0]??.3)*60)),this.lerpFactorRotEnd=1-.02**(1/((i.delayRot[1]??.3)*60)),this.lerpFactorPosCamera=1-.02**(1/((i.delayPosCamera??.3)*60)),this.lerpFactorRotCamera=1-.02**(1/((i.delayRotCamera??.3)*60)),this.gravity=(this.gloabalPhysics.gravity??cl.defaultData.gravity)*P7,this.usePhysics=this.gloabalPhysics.usePhysics??cl.defaultData.usePhysics,this.jumpPower=i.jumpPower*MZ,this.resetYPosition=this.position.y+Math.abs(i.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=i.alignToGround??!1,this.orientMode=i.autoOrientMove?i.orientMode:"none",this.orientWith=i.orientWith??Wc.defaultDataThirdPerson.orientWith,this.slopeThresh=vZ*Math.PI/180,i.collider.type==="capsule"?(this.collider.radius=i.collider.radius,this.collider.segment.start.y=i.collider.height/2-i.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=i.collider.height*Lp/this.pixelsPerMeter,this.stepThresh=i.collider.height*Bp/this.pixelsPerMeter,this.colliderHeight=i.collider.height):i.collider.type==="sphere"?(this.collider.radius=i.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*i.collider.radius*Lp/this.pixelsPerMeter,this.stepThresh=2*i.collider.radius*Bp/this.pixelsPerMeter,this.colliderHeight=i.collider.radius*2):(this.offset=i.collider.height*Lp/this.pixelsPerMeter,this.stepThresh=i.collider.height*Bp/this.pixelsPerMeter,this.colliderHeight=i.collider.height),this.collider.type=i.collider.type;let d=new E().fromArray(i.collider.position),u=new lt().setFromEuler(new Ri().fromArray([...i.collider.rotation,"XYZ"]));this.collider.position.copy(d).multiply(this.scale),this.collider.rotation.copy(u),this.collider.matrix.compose(d,u,T7),i.cameraXAxis!==void 0&&(this.cameraXAxis=i.cameraXAxis,this.cameraYAxis=i.cameraYAxis,this.minPolarAngle=i.cameraRotXLimits[0],this.maxPolarAngle=i.cameraRotXLimits[1],this.minAzimuthAngleRel=i.cameraRotYLimits[0],this.maxAzimuthAngleRel=i.cameraRotYLimits[1]),this.forwardDir=i.forwardDirection??"-z",this.isFirstPerson&&(this.forwardDir="-z"),this.runMultiplier=i.runMultiplier??2;let p=i.navmesh.destinationHelperRadius*2;if(p>0){let g=new je;g.push({fi:0,data:{...ji.defaultData("light","phong"),alpha:0},id:"layer1"}),g.push({fi:0,data:{...ji.defaultData("color"),color:i.navmesh.destinationHelperColor,alpha:i.navmesh.destinationHelperColor.a},id:"layer2"});let m=new r5({layers:g},{scene:this.page.scene,shared:this.sharedAssets});this.navMeshPathDest=new si(xx.create({parameters:{width:p,height:p/10,hollow:.7}}),m),this.navMeshPathDest.material.userData.opacity0=i.navmesh.destinationHelperColor.a}this.activate()}reset(e=!1){if(this.object.hiddenMatrix.copy(this.hiddenMatrix0),e){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity();let t=new Ri().setFromQuaternion(this.quaternion,"YXZ"),i=t.y;this.objectRealQuat.copy(this.quaternion),t.y=0,this.quaternion.setFromEuler(t),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),t.set(0,i,0),this.quaternion.setFromEuler(t),this.rot.setFromEuler(t),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}else this.object instanceof v1?this.object.matrixAutoUpdate=!0:this.object.updateMatrix();this.cameraFollow===!0&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.controlsManager.requestRender()}activate(){this.instantiateActions(),this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.addEventListener("visibilitychange",this.handleVisibilityChange)}deactivate(){this.disposeActions(),this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.removeEventListener("visibilitychange",this.handleVisibilityChange)}dispose(){var e;this.deactivate(),(e=this.navMeshPathDest)!=null&&e.parent&&this.page.remove(this.navMeshPathDest)}instantiateActions(){let e=this.data,t=this.sharedAssets;e.gameActions!==void 0&&(this.actions={},Hc.list.forEach(i=>{this.actions[i]=Ci({...e,disabled:!1,type:"GameControl"},e.gameActions[i],this.page,t,this.controlsManager.eventManager,this.object)})),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"),this.initialAction&&(this.initialAction=!1)}disposeActions(){this.initialAction=!1,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),Qi(this.actions.idle),Qi(this.actions.move),Qi(this.actions.run),Qi(this.actions.jump)}dispatchStartEvent(e){this.actions[e]!==void 0&&(this.actionState[e]||(this.actionState[e]=!0,this.actions[e].Transition.forEach(t=>{t.play()}),this.actions[e].Animation.forEach(t=>{t.play(this.initialAction===!1)}),this.actions[e].Create.forEach(t=>{t.dispatchStart()}),this.actions[e].Audio.forEach(t=>{t.dispatchGameControl("start")}),this.actions[e].Particles.forEach(t=>{t.dispatchGameControl("start")})))}dispatchStopEvent(e){this.actions[e]!==void 0&&(!this.actionState[e]||(this.actionState[e]=!1,this.actions[e].Transition.forEach(t=>{t.stop(),t.object.currentState!==null&&t.object.changeSelectedState(null,{scene:this.page.scene,shared:this.sharedAssets})}),this.actions[e].Create.forEach(t=>{t.dispatchStop()}),this.actions[e].Audio.forEach(t=>{t.dispatchGameControl("stop")}),this.actions[e].Particles.forEach(t=>{t.dispatchGameControl("stop")})))}get colliderWorldPosition(){return _1.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.position)}update(e,t,i){var o,l,h,c,d,u,p,f,g;if(this.gravity<0?this.position.y<this.resetYPosition:this.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let r=(this.isFirstFrame?16.6:e)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let s=r*60,a=!1;if(this.usePhysics&&this.collisionEnabled){let m=R1.set(0,(this.velocity.y===0?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/(10*P7),1)*(this.gravity>0?1:-1):this.velocity.y)*r,0).divideScalar(this.pixelsPerMeter),v=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,m,(o=this.object.rigidBody)==null?void 0:o.collider(0).shape,1,!1,16,void 0,void 0,this.object.rigidBody);if(v){this.onObject=!0,this.groundNormal.set(v.normal2.x,v.normal2.y,v.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(a=!0),((l=v.collider.parent())==null?void 0:l.bodyType())===0&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let y=v.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let x of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(x.rigidBody===y&&x.userData.isFollowingObj!==this.object.uuid){(x.hasNonUniformScale?x.matrixWorldRigid:x.matrixWorld).decompose(_1,Ts,R1),this.groundVelocity.subVectors(_1,x.prevT),this.object.getWorldPosition(R1).add(this.collider.position).sub(_1),this.groundYRotation=Yr.setFromQuaternion(Ts).y-x.prevR.y,xa.copy(R1).applyAxisAngle(Sr,this.groundYRotation),this.groundVelocity.add(xa.sub(R1)).divideScalar(r);break}}else this.onObject=!1}if(this.moveMode==="walk"&&this.collisionEnabled&&(this.movementState.jump===1&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*s),this.moveMode==="fly"&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,this.forwardDir==="+z"&&this.directionXZ.multiplyScalar(-1),this.directionXZ.manhattanLength()>0&&(this.path=[]),this.navMeshPathDest){let m=this.navMeshPathDest.material;if(this.moveMode==="walk"&&this.path.length>1){this.navMeshPathDest.position.copy(this.path[this.path.length-1]),this.navMeshPathDest.parent||this.page.add(this.navMeshPathDest);let v=_1.subVectors(this.path[1],this.position),y=R1.subVectors(this.path[1],this.path[0]);v.dot(y)<0?this.path.shift():(this.directionXZ.x=y.x,this.directionXZ.z=y.z),m.opacity=m.userData.opacity0}else m.opacity-=.05*m.userData.opacity0,this.navMeshPathDest.material.opacity<=0&&this.navMeshPathDest.parent&&this.page.remove(this.navMeshPathDest)}this.directionXZ.normalize(),this.movementState.run?this.moveForce=this.runMultiplier:this.moveForce=1,this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce,this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce,(this.moveMode==="walk"?this.velocityTarget.x+this.velocityTarget.z===0:this.velocityTarget.manhattanLength()===0)?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.moveMode==="walk"&&(this.lerpFactorPos.y=1),this.didHit===!1&&this.pushedVelocity.manhattanLength()===0||this.usePhysics===!1?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**s),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**s),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**s)):this.velocity.copy(this.velocityTarget),(this.moveMode==="walk"?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.movementState.run?(this.dispatchStopEvent("move"),this.dispatchStartEvent("run")):(this.dispatchStopEvent("run"),this.dispatchStartEvent("move"))));let n=yZ.copy(this.velocity);if(this.orientMode!=="none"&&this.isFirstPerson===!1){let m=R1.copy(n);m.y=0,n.set(0,n.y,m.length()*(this.forwardDir==="+z"?1:-1))}if(this.directionXZ.manhattanLength()>0&&this.orientMode!=="none"&&this.isFirstPerson===!1)if(this.orientWith==="camera"&&this.path.length<=1){let m=_1;this.camera.getWorldDirection(m);let v=xa.copy(Sr).multiplyScalar(m.dot(Sr));m.sub(v);let y=R1.copy(this.directionXZ);y.x*=-1,this.rot.y=m.angleTo(y)*(m.cross(y).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera}else this.rot.y=(this.path.length>1?0:this.euler.y)+Math.atan2(-this.directionXZ.z,this.directionXZ.x)+Math.PI/2*(this.forwardDir==="+z"?1:-1);if(Yr.setFromVector3(this.rot),this.moveMode==="walk"&&(Yr.x=0),n.applyEuler(Yr),a&&(Ts.setFromUnitVectors(Sr,this.groundNormal),n.applyQuaternion(Ts)),i){let m=Yr.set(0,this.vrEulerYOffset*D7,0);i.applyEuler(m),n.x+=i.x,n.z+=i.z,this.nonColliderPosOffset.elements[13]+=i.y*r}if(this.usePhysics===!0){let m=R1;this.pushedVelocity.set(0,0,0);for(let v of this.sharedGameControlGlobals.entitiesWithTransformAnim){let y=xa.setFromMatrixPosition(v.matrixWorld).sub(v.prevT).divideScalar(r).divideScalar(this.pixelsPerMeter),x=v.rigidBody.collider(0).castCollider(y,this.object.rigidBody.collider(0),_1.copy(n).divideScalar(this.pixelsPerMeter),r,!1);y.multiplyScalar(this.pixelsPerMeter);let w=Et.is(v)?v:v.object;if(x!==null&&this.lastHitObj!==w){let _;v instanceof m1&&(_=v);let b=this.sharedGameControlGlobals.entityToCollisionEvents[w.uuid];if(b)for(let A of b)A.data.target==="character"&&(A.dispatch(_),w.dispatchEvent(Zf));this.lastHitObj=w}if(x!==null){this.pushedVelocity.copy(y),m.copy(x.normal1).applyQuaternion(v.quaternion);break}}if(this.pushedVelocity.manhattanLength()!==0){let v=m.dot(n);v<0&&n.addScaledVector(m,-v),n.add(this.pushedVelocity)}else n.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),this.rotationMode==="normal"&&(this.movementState.rotPosX||this.movementState.rotNegX)||this.rotationMode==="steer"&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||this.moveMode==="walk")?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,this.rotationMode==="normal"&&(this.movementState.rotPosY||this.movementState.rotNegY)||this.rotationMode==="steer"&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(r),this.rotVelocityStick),this.rotVelocityTarget.manhattanLength()===0?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**s):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**s),this.euler.x+=this.rotVelocity.x*r,this.euler.y+=this.rotVelocity.y*r+this.groundYRotation,this.rotVelocityTarget.y===0&&this.directionXZ.manhattanLength()===0?this.rotationAccumWhenOrientWithCamera=0:(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*r),this.isFirstPerson===!1&&this.orientMode!=="none"&&this.directionXZ.manhattanLength()>0){if(this.orientMode==="radial"){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(Sr,this.euler.y-this.euler0.y);let m=R1.copy(this.objectToCamXZ).normalize(),v=xa.copy(n).multiplyScalar(r);v.y=0;let y=v.sub(_1.copy(m).multiplyScalar(v.dot(m))).cross(m).y;this.euler.y-=Math.atan2(y,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*r+this.groundYRotation,this.rotVelocityTarget.y!==0&&(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.euler.y=this.rot.y);if(this.cameraFollow===!0&&(this.moveMode==="walk"?this.cameraXAxis==="Limit"?this.euler.x=Oe.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=Oe.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):this.cameraXAxis==="Limit"&&(this.euler.x=Oe.clamp(this.euler.x,-this.PI_2,this.PI_2))),this.moveMode==="fly"?this.rot.x=this.euler.x:this.isFirstPerson&&(t?(Yr.copy(t),Yr.y=0):(Yr.copy(this.euler),Yr.y=0),this.nonColliderRotOffset.makeRotationFromEuler(Yr)),t&&(this.moveMode==="walk"?(this.rot.y=t.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(t),this.rot.y+=this.vrEulerYOffset*D7),wr.setFromAxisAngle(bZ,this.rot.x),Ts.setFromAxisAngle(Sr,this.rot.y),Ts.multiply(wr),wr.setFromAxisAngle(wZ,this.rot.z),Ts.multiply(wr),this.quaternion.copy(Ts),this.objectRealQuat.multiplyQuaternions(this.quaternion,this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){let m=R1.copy(n).multiplyScalar(r/this.pixelsPerMeter),v=null;this.didHit=!1;let y=new E;for(let x=0;x<5;x++){let w=m.length(),_=xa.copy(m).normalize();if(v=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(y),this.colliderWorldQuat,_,(h=this.object.rigidBody)==null?void 0:h.collider(0).shape,w,!1,24,void 0,void 0,this.object.rigidBody),v!==null){this.didHit=!0;let b=this.sharedGameControlGlobals.colliderToEntity.get(v.collider.handle);if(b!==this.lastHitObj&&x===0){this.lastHitObj=b;let C=this.sharedGameControlGlobals.entityToCollisionEvents[b==null?void 0:b.uuid];if(C){for(let T of C)if(T.data.target==="character"){let P=((c=this.sharedGameControlGlobals.rapierWorld)==null?void 0:c.getCollider(v.collider.handle))._parent,I;if(b.cloner){for(let D of b.cloner.children)if(D.rigidBody===P){I=D;break}}T.dispatch(I),b.dispatchEvent(Zf)}}}let A=M7.set(v.normal2.x,v.normal2.y,v.normal2.z).applyQuaternion(this.colliderWorldQuat),S=E7.copy(_).multiplyScalar(v.toi).dot(A),M=v.toi;if(M===0&&(this.position.y+=this.offset*this.pixelsPerMeter),S>this.offset&&(M=v.toi*(S-this.offset)/S,y.addScaledVector(_,M)),m.copy(_).multiplyScalar(w-M),Math.acos(-A.y)>this.slopeThresh){let C=this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(y),T=xa.copy(v.witness2).applyQuaternion(this.colliderWorldQuat);T.y=0;let P=C.add(T);P.y+=this.stepThresh;let I=this.sharedGameControlGlobals.rapierWorld.castShape(P,this.colliderWorldQuat,m,(d=this.object.rigidBody)==null?void 0:d.collider(0).shape,1,!1,24,void 0,void 0,this.object.rigidBody);I!==null&&I.toi===0&&(A.y=0,A.normalize())}m.addScaledVector(A,-m.dot(A))}else{x===0&&this.directionXZ.manhattanLength()!==0&&(this.lastHitObj=null),y.add(m);break}}this.position.addScaledVector(y,this.pixelsPerMeter),(u=this.object.rigidBody)==null||u.setTranslation(_1.copy(this.position).divideScalar(this.pixelsPerMeter),!0),(p=this.object.rigidBody)==null||p.setRotation(wr.copy(this.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let m=this.onObject?1:5,v=n.multiplyScalar(r/m);for(let y=0;y<m;y++)this.position.add(v),this.collisionAdjustment(r/m)}else this.position.addScaledVector(n,r);if(this.moveMode==="walk"&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.matrix.compose(this.position,this.quaternion,this.scale),this.object.matrixWorldNeedsUpdate=!0,this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),this.cameraFollow===!0){this.updateFollowArms();let m=this.objectToTarget.add(this.position),v=this.targetToCamera.add(m);zp.lookAt(v,m,Sr).setPosition(v),zp.decompose(this.targetPos,this.targetQuat,_1),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**s),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**s),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraYAxis==="Limit"&&this.orientMode==="cartesian"&&(this.euler.y=Oe.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=Oe.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.object.dispatchEvent(CZ),this.path.length<2&&this.lastPosition.distanceToSquared(this.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(this.camera===void 0||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate)&&(this.moveMode==="fly"||this.onObject===!0||this.collisionEnabled===!1)&&(this.navMeshPathDest===null||this.navMeshPathDest.material.opacity<-.04*((g=(f=this.navMeshPathDest)==null?void 0:f.material)==null?void 0:g.userData.opacity0))?!1:(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.position),this.object.dispatchEvent(EZ),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let e=wr.setFromAxisAngle(Sr,this.cameraYAxis==="Limit"&&this.orientMode!=="radial"?Oe.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&this.objectToTarget.applyQuaternion(e);let t;this.cameraXAxis==="Limit"?t=Oe.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):t=Oe.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let i=_1.copy(this.cameraPolarAxis0);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&i.applyQuaternion(e);let r=Ts.setFromAxisAngle(i,t);this.cameraYAxis!=="Locked"&&this.targetToCamera.applyQuaternion(e),this.cameraXAxis!=="Locked"&&this.targetToCamera.applyQuaternion(r)}groundTiltAdjustment(e){Sr.angleTo(e)*180/Math.PI<15||Sr.angleTo(e)*180/Math.PI>85?wr.identity():wr.setFromUnitVectors(Sr,e),this.groundTilt.slerp(wr,.06),this.groundTiltInv.copy(this.groundTilt).invert()}collisionAdjustment(e){var s;let t=E7.set(0,0,0);this.object.matrix.compose(this.position,this.quaternion,this.scale);let i=zp.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(_1,wr,R1).compose(_1,wr,T7);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach(a=>{if(a===this.object||a.isDescendantOf(this.object))return;$1.makeEmpty(),a.updateMatrixWorldSVD();let n=a.matrixWorldRigid,o=C7.copy(n).invert(),l=xZ.copy(C7).multiply(i);Ni.copy(this.collider.segment),Ni.start.applyMatrix4(l),Ni.end.applyMatrix4(l);let h=M7.copy(this.position).applyMatrix4(o);$1.expandByPoint(Ni.start),$1.expandByPoint(Ni.end),$1.min.addScalar(-this.collider.radius),$1.max.addScalar(this.collider.radius),a.bvhGeometry.boundsTree.shapecast({traverseBoundsOrder(c){return c.distanceToPoint(Ni.end)},intersectsBounds:c=>c.intersectsBox($1),intersectsTriangle:c=>{let d=_1,u=R1,p=c.closestPointToSegment(Ni,d,u);if(p<this.collider.radius){let f=this.collider.radius-p,g=u.sub(d).normalize(),m=xa.copy(h);m.addScaledVector(g,f);let v=m.applyMatrix4(n).sub(this.position);t.add(v),Ni.start.addScaledVector(g,f),Ni.end.addScaledVector(g,f)}}})}),$1.makeEmpty(),Ni.copy(this.collider.segment),Ni.start.applyMatrix4(i),Ni.end.applyMatrix4(i),$1.expandByPoint(Ni.start),$1.expandByPoint(Ni.end),$1.min.addScalar(-this.collider.radius),$1.max.addScalar(this.collider.radius),(s=this.sharedGameControlGlobals.staticMeshBVH)==null||s.shapecast({traverseBoundsOrder(a){return a.distanceToPoint(Ni.end)},intersectsBounds:a=>a.intersectsBox($1),intersectsTriangle:a=>{let n=_1,o=R1,l=a.closestPointToSegment(Ni,n,o);if(l<this.collider.radius){let h=this.collider.radius-l,c=o.sub(n).normalize();this.alignToGround&&this.groundTiltAdjustment(c),t.addScaledVector(c,h),Ni.start.addScaledVector(c,h),Ni.end.addScaledVector(c,h)}}}),this.onObject=Math.abs(t.y)>Math.abs(e*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let r=Math.max(0,t.length()-1e-5);t.normalize().multiplyScalar(r),this.position.add(t)}},Gw=Xf;Gw.isLocked=!1;var TZ=aa(Z7());function Us(e,t){let i=new Ge;if(t){let a=t.elements,n=a[0]**2+a[1]**2+a[2]**2,o=a[4]**2+a[5]**2+a[6]**2,l=a[8]**2+a[9]**2+a[10]**2,h=a[0]**2+a[4]**2+a[8]**2,c=a[1]**2+a[5]**2+a[9]**2,d=a[2]**2+a[6]**2+a[10]**2,u=1e-8;if(n<u||o<u||l<u||h<u||c<u||d<u)return i.setAttribute("position",new De([],3)),i.setIndex([]),i}if(!e.getAttribute("position"))return i.setAttribute("position",new De([],3)),i.setIndex([]),i;let{positions:r,triIndices:s}=Od(e.getAttribute("position"),e.getIndex());return i.setAttribute("position",new De(r,3)),i.setIndex(s),t&&i.applyMatrix4(t),i}var PZ=new we,DZ=new we,Xr=[[0,0,0],[0,0,0],[0,0,0]];function Hw(e){let t=e.elements;Xr[0][0]=t[0],Xr[0][1]=t[4],Xr[0][2]=t[8],Xr[1][0]=t[1],Xr[1][1]=t[5],Xr[1][2]=t[9],Xr[2][0]=t[2],Xr[2][1]=t[6],Xr[2][2]=t[10];let{u:i,v:r}=(0,TZ.SVD)(Xr),s=PZ.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),a=DZ.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1);return s.multiply(a.transpose())}var IZ=class extends jv{constructor(){super(),this.layers.enable(3),this.layers.enable(8)}setFromCamera(e,t){t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):t.isPerspectiveCamera&&(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t)}intersectVisibleObjects(e,t=!0,i=[]){return e.forEach(r=>{r.visible&&this.intersectObject(r,t,i)}),i}createRaycastLineHelper(){let e=new Xa({color:65280,linewidth:10}),t=new E(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),i=new E(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),r=this.camera.far-this.camera.near,s=new E().addVectors(t,i.multiplyScalar(r)),a=new Ge;return a.setFromPoints([t,s]),new fc(a,e)}},Ww=e=>e instanceof Jo||e instanceof $o;function OZ(e,t){return e.distance-t.distance}function qw(e,t,i){if(!(!ks(t)||!t.visible)){Mr(t)&&t.raycast(e,i);for(let r of t.children)qw(e,r,i)}}function oc(e,t,i,r=!1){if(!r&&!i.some(a=>cd(e,a)!==void 0))return[];let s=[];return t.children.forEach(a=>qw(e,a,s)),s.sort(OZ),s}function Qf(e){let t=[];if(e.length){let i=e[0].object;ks(i)&&t.push(i);let r=i.parent;for(;r;)Ww(r)&&t.push(r),r=r.parent}return t}function Ns(e,t,i,r){let s=e.frame;if(s){let a=t[0]*s.width,n=(1-t[1])*s.height;for(let o of i){let l=o===s.uuid?s:s.find(o);if(l!=null&&l.intersects(a,n))return r(l),!0}}return!1}function cd(e,t){if(Mr(t)){if(t.visible){let i=[];return t.raycast(e,i),i.length?i[0]:void 0}}else if(Ww(t))return Yw(e,t)}function Yw(e,t){if(!(!ks(t)||!t.visible)){if(Mr(t)){let i=[];if(t.raycast(e,i),i.length)return i[0]}for(let i of t.children){let r=Yw(e,i);if(r)return r}}}function RZ(e,t,i){return{x:(e-(i.left+window.scrollX))/i.width*2-1,y:-((t-(i.top+window.scrollY))/i.height)*2+1}}function LZ(e,t,i){return{x:(e-(i.left+window.scrollX))/i.width,y:1-(t-(i.top+window.scrollY))/i.height}}var BZ=class{constructor(e,t,i,r,s,a,n,o){this.renderer=e,this.publish=t,this.scene=i,this.getCamera=r,this.sharedAssets=s,this.requestRender=a,this.isExport=n,this.frame=o,this.raycaster=new IZ,this._useWindowEvents=!1,this.pointerWorld={x:0,y:0},this.pointerScreen={x:0,y:0},this._useWindowEvents=t.mouseEventTarget==="window",this.domElement=e.domElement,this.eventElement=this._useWindowEvents?window:e.domElement,this._domRect=this.domElement.getBoundingClientRect()}get stopRaycast(){return this.publish.stopRaycast}get page(){return this.scene.activePage}set useWindowEvents(e){this._useWindowEvents=e,this.eventElement=e?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}set domRect(e){this._domRect=e}get domRect(){return this._domRect}updateRaycaster(e){var r;let{pageX:t,pageY:i}=((r=e.touches)==null?void 0:r.length)>0?e.touches[0]:e;this.pointerWorld=RZ(t,i,this._domRect),this.pointerScreen=LZ(t,i,this._domRect),this.raycaster.setFromCamera(this.pointerWorld,this.getCamera())}},x1=class{constructor(e){this.eventContext=e,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},L5=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],Xw=e=>{var t;return(t=L5.find(([i,r])=>r===e))==null?void 0:t[0]},yh=e=>{var t;return(t=L5.find(([i])=>i===e))==null?void 0:t[1]},zZ=(e,t)=>{let i=Xw(e);if(i){let r=new CustomEvent(i,{bubbles:!0});return Object.defineProperty(r,"target",{writable:!1,value:t}),r}},FZ=class extends x1{constructor(){super(...arguments),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=e=>{var r;if(!e.eventName||!e.target||e.eventName==="Scroll")return;let t=(r=this.splineEvents[Xw(e.eventName)])==null?void 0:r[e.target.uuid];if(!t)return;e.eventName==="Scroll"&&e.deltaY!==void 0&&Object.assign(t,{deltaY:e.deltaY});let{domElement:i}=this.eventContext;i.dispatchEvent(t)}}connect(){let{page:e}=this.eventContext;e.traverseEntity(t=>{var i,r;if((i=t.data)!=null&&i.events.length){for(let[s,a]of L5)if(t.data.events.some(n=>n.data.type===a&&!n.data.disabled)){this.objectsPerEvents.has(s)?(r=this.objectsPerEvents.get(s))==null||r.push(t):this.objectsPerEvents.set(s,[t]);let n={id:t.uuid,name:t.name},o=zZ(a,n),l=this.splineEvents[s];l?l[t.uuid]=o:this.splineEvents[s]={[t.uuid]:o}}}}),this.objectsPerEvents.forEach(t=>{t.forEach(i=>{i.addEventListener("beginEvent",this.onBeginEvent)})})}disconnect(){this.objectsPerEvents.forEach(e=>{e.forEach(t=>{t.removeEventListener("beginEvent",this.onBeginEvent)})})}},kZ=class{constructor(e,t,i,r,s,a){if(this.id=e,this.data=t,this.object=i,this.entered=!1,(t.type==="KeyDown"||t.type==="KeyUp"||t.type==="KeyPress")&&!t.key)throw new Error("Missing property");this.actions=Ci(t,t.actions,r,s,a,i)}disconnect(){Qi(this.actions)}dispatchHeld(e){this.actions.Create.forEach(t=>{e&&t.dispatchThrottled.cancel(),t.dispatchThrottled()})}dispatch(e=!1){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.data.type==="MousePress"||this.data.type==="KeyPress"?this.entered||(this.entered=!0,this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatchStart())):(this.actions.Transition.some(t=>t.playing&&t.data.runMode!=="Toggle")||this.actions.Transition.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.SwitchCamera.some(t=>t.playing&&t.data.runMode!=="Toggle")||this.actions.SwitchCamera.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.Animation.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()})),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),e===!1&&this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Particles.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()),this.actions.Create.forEach(e=>e.dispatchStop()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}},UZ=class extends x1{constructor(e,t,i){super(e),this.eventManager=t,this.useForRaycastProperty=i,this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.sceneInterects=null,this.onCanvasRaycast=r=>{if(this.useForRaycastProperty===!0&&this.sceneInterects===null){this.eventContext.updateRaycaster(r);let{raycaster:s,page:a}=this.eventContext,n=oc(s,a,[],!0);this.sceneInterects=n,n.length&&(this.eventContext.sharedAssets.raycastProperty={x:n[0].point.x,y:n[0].point.y,z:n[0].point.z,objX:n[0].object.matrixWorld.elements[12],objY:n[0].object.matrixWorld.elements[13],objZ:n[0].object.matrixWorld.elements[14]})}},this.onCanvasMouseDown=r=>{(r.target===this.eventContext.domElement||r.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(s=>{(s.data.type==="MouseDown"||s.data.type==="MousePress")&&(this.onCanvasRaycast(r),s.dispatch())})},this.onCanvasMouseUp=r=>{(r.target===this.eventContext.domElement||r.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(s=>{s.data.type==="MouseUp"?(this.onCanvasRaycast(r),s.dispatch()):s.data.type==="MousePress"&&s.dispatchRelease()})},this.onMouseDown=r=>{it.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseEvent("MouseDown"))},this.onMouseUp=r=>{it.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=r=>{it.length>1||(this.eventContext.updateRaycaster(r),this.handleMousePressEvent())},this.onMousePressRelease=r=>{it.length>1||(this.eventContext.updateRaycaster(r),this.handleMousePressEvent(!0))},this.onKeyDown=r=>{this.heldKeys[r.key]||(this.handleKeyEvent(r,"KeyDown"),this.handleKeyEventHeld(r,"KeyDown",!0)),this.heldKeys[r.key]=!0},this.onKeyUp=r=>{this.handleKeyEvent(r,"KeyUp"),this.handleKeyEventHeld(r,"KeyUp",!0)},this.onKeyPressDown=r=>{this.heldKeysPress[r.key]?this.handleKeyEventHeld(r,"KeyPress"):(this.handleKeyEvent(r,"KeyPress"),this.handleKeyEventHeld(r,"KeyPress",!0)),this.heldKeysPress[r.key]=!0},this.onKeyPressUp=r=>{this.handleKeyEvent(r,"KeyPress",!0)},this.releaseHeldKey=r=>{delete this.heldKeys[r.key]},this.releaseHeldKeyPress=r=>{delete this.heldKeysPress[r.key]},this._onUserEvent=({eventName:r,target:s,reverse:a})=>{var o,l,h,c;if(!r||!s)return;let n=yh(r);n&&(n==="MouseDown"||n==="MouseUp"||n==="MousePress"?(s.dispatchEvent({type:"beginEvent",eventName:n}),(l=(o=this.eventsPerObjects[n])==null?void 0:o[s.uuid])==null||l.forEach(d=>{d.dispatchUserEvent(a)})):(n==="KeyDown"||n==="KeyUp"||n==="KeyPress")&&(s.dispatchEvent({type:"beginEvent",eventName:n}),(c=(h=this.eventsPerObjects[n])==null?void 0:h[s.uuid])==null||c.forEach(d=>{d.dispatchUserEvent()})))}}connect(){var s,a,n,o,l,h;let{page:e,sharedAssets:t,domElement:i}=this.eventContext,r=(c,d)=>{var p,f;if(!((p=c.data)!=null&&p.events.length))return;let u=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let g of u){let m=this.eventsPerObjects[g];c.data.events.filter(({data:v})=>v.type===g&&v.disabled!==!0).forEach(({id:v,data:y})=>{try{let x=new kZ(v,y,c,e,t,this.eventManager);x.actions.Video.length&&(this.hasVideoAction=!0),(y.type==="MouseDown"||y.type==="MouseUp"||y.type==="MousePress")&&(y.mode==="Canvas"||y.mode==="Window")?this.canvasMouseEvents.push(x):m[c.uuid]?m[c.uuid].some(w=>w.id===x.id)||m[c.uuid].push(x):m[c.uuid]=[x]}catch{}}),(f=m[c.uuid])!=null&&f.length&&this.objectsPerTypes[g].push(c instanceof Zi&&(g==="MouseDown"||g==="MouseUp"||g==="MousePress")?d:c)}};e.traverseEntity(c=>{var d;(c instanceof p1||c instanceof Gi)&&((d=c.frame)==null||d.traverse(u=>{r(u,c)})),r(c)}),this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),i.addEventListener("pointerdown",this.onCanvasMouseDown),i.addEventListener("pointerup",this.onCanvasMouseUp),((s=this.objectsPerTypes.MouseDown)!=null&&s.length||this.useForRaycastProperty)&&(this.domEventsNeeded.add("pointerdown"),i.addEventListener("pointerdown",this.onMouseDown)),(a=this.objectsPerTypes.MouseUp)!=null&&a.length&&(this.domEventsNeeded.add("pointerup"),i.addEventListener("pointerup",this.onMouseUp)),(n=this.objectsPerTypes.MousePress)!=null&&n.length&&(this.domEventsNeeded.add("pointerdown"),i.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),i.addEventListener("pointerup",this.onMousePressRelease)),(o=this.objectsPerTypes.KeyDown)!=null&&o.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),(l=this.objectsPerTypes.KeyUp)!=null&&l.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),(h=this.objectsPerTypes.KeyPress)!=null&&h.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach(([c,d])=>{d.forEach(u=>{u.addEventListener("userEvent",this._onUserEvent)})})}disconnect(){let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},e.removeEventListener("pointerdown",this.onCanvasMouseDown),e.removeEventListener("pointerup",this.onCanvasMouseUp),e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerdown",this.onMousePressDown),e.removeEventListener("pointerup",this.onMouseUp),e.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach(t=>{Object.values(t).forEach(i=>{i.forEach(r=>{r.disconnect()})})}),this.canvasMouseEvents.forEach(t=>{t.disconnect()}),Object.entries(this.objectsPerTypes).forEach(([t,i])=>{i.forEach(r=>{r.removeEventListener("userEvent",this._onUserEvent)})})}handleMouseEvent(e){var o,l,h,c;let{stopRaycast:t,raycaster:i,page:r,pointerScreen:s}=this.eventContext,a=this.objectsPerTypes[e],n=a.filter(d=>!(d instanceof Zi));if(!(!a.length&&!this.useForRaycastProperty)&&!(r.uiCanvas&&Ns(r,[s.x,s.y],Object.keys(this.eventsPerObjects[e]),d=>{this.handleObjectMouseEventDispatch(d,e)}))){if(t||this.useForRaycastProperty){let d;if(this.sceneInterects===null?d=oc(i,r,n,this.useForRaycastProperty):(d=this.sceneInterects,this.sceneInterects=null),this.useForRaycastProperty&&d.length&&(this.eventContext.sharedAssets.raycastProperty={x:d[0].point.x,y:d[0].point.y,z:d[0].point.z,objX:d[0].object.matrixWorld.elements[12],objY:d[0].object.matrixWorld.elements[13],objZ:d[0].object.matrixWorld.elements[14]}),t){let u=[((l=(o=d[0])==null?void 0:o.uv)==null?void 0:l.x)??0,((c=(h=d[0])==null?void 0:h.uv)==null?void 0:c.y)??0];Qf(d).forEach(p=>{p instanceof p1&&Ns(p,u,Object.keys(this.eventsPerObjects[e]),f=>{this.handleObjectMouseEventDispatch(f,e)}),this.eventsPerObjects[e][p.uuid]&&this.handleObjectMouseEventDispatch(p,e)})}}t||n.forEach(d=>{var p,f;let u=cd(i,d);u&&(this.handleObjectMouseEventDispatch(d,e),d instanceof p1&&Ns(d,[((p=u==null?void 0:u.uv)==null?void 0:p.x)??0,((f=u==null?void 0:u.uv)==null?void 0:f.y)??0],Object.keys(this.eventsPerObjects[e]),g=>{this.handleObjectMouseEventDispatch(g,e)}))})}}handleMousePressEvent(e=!1){let t="MousePress",i=this.objectsPerTypes[t],r=i.filter(a=>!(a instanceof Zi)),s=[];if(i.length){if(!e){let{stopRaycast:a,raycaster:n,page:o,pointerScreen:l}=this.eventContext,h=!1;if(o.uiCanvas&&(h=Ns(o,[l.x,l.y],Object.keys(this.eventsPerObjects[t]),c=>{s.push(c)})),a&&!h){let c=oc(n,o,r);s=Qf(c),c.forEach(d=>{var u,p;d.object instanceof p1&&Ns(d.object,[((u=d==null?void 0:d.uv)==null?void 0:u.x)??0,((p=d==null?void 0:d.uv)==null?void 0:p.y)??0],Object.keys(this.eventsPerObjects[t]),f=>{s.push(f)})})}else r.forEach(c=>{var u,p;let d=cd(n,c);d&&(s.push(c),c instanceof p1&&Ns(c,[((u=d==null?void 0:d.uv)==null?void 0:u.x)??0,((p=d==null?void 0:d.uv)==null?void 0:p.y)??0],Object.keys(this.eventsPerObjects[t]),f=>{s.push(f)}))})}this._prevObjects.length&&this._prevObjects.forEach(a=>{s.includes(a)||this.handleObjectMouseEventDispatchRelease(a,t)}),s.length&&s.forEach(a=>{this.handleObjectMouseEventDispatch(a,t)}),this._prevObjects=s}}handleObjectMouseEventDispatch(e,t){var i,r;e.dispatchEvent({type:"beginEvent",eventName:t}),(r=(i=this.eventsPerObjects[t])==null?void 0:i[e.uuid])==null||r.forEach(s=>{s.dispatch()})}handleObjectMouseEventDispatchRelease(e,t){var i,r;e.dispatchEvent({type:"beginEvent",eventName:t}),(r=(i=this.eventsPerObjects[t])==null?void 0:i[e.uuid])==null||r.forEach(s=>{s.dispatchRelease()})}handleKeyEvent(e,t,i=!1){this.objectsPerTypes[t].forEach(r=>{let s=this.eventsPerObjects[t][r.uuid];s.some(({data:a})=>"key"in a&&a.key===e.key)&&r.dispatchEvent({type:"beginEvent",eventName:t}),s.forEach(a=>{"key"in a.data&&a.data.key===e.key&&(i?a.dispatchRelease():a.dispatch(!0))})})}handleKeyEventHeld(e,t,i=!1){this.objectsPerTypes[t].forEach(r=>{this.eventsPerObjects[t][r.uuid].forEach(s=>{"key"in s.data&&s.data.key===e.key&&s.dispatchHeld(i)})})}},NZ=new E,VZ=new E,Qw=class{constructor(e,t,i,r,s){this.actionsIn=Ci(e,e.inActions,i,r,s,t),this.actionsOut=Ci(e,e.outActions,i,r,s,t)}disconnect(){Qi(this.actionsIn),Qi(this.actionsOut)}},jZ=class extends Qw{constructor(e,t,i,r,s,a){super(t,i,r,s,a),this.id=e,this.data=t,this.object=i,this.stage="out",this.objects=[],this.onUpdateMatrixWorld=()=>{for(let u of this.objects)if(!u.visible)return;let h=NZ.setFromMatrixPosition(this.objects[0].matrixWorld),c=VZ.setFromMatrixPosition(this.objects[1].matrixWorld),d=h.distanceTo(c)<=this.distance?"in":"out";if(this.stage!==d){this.stage=d;let u=d==="in"?this.actionsIn:this.actionsOut;u.Audio.forEach(p=>p.dispatchConditional()),u.Particles.forEach(p=>p.dispatchConditional()),u.Video.forEach(p=>p.dispatchConditional()),u.Link.forEach(p=>p.dispatch()),u.Create.forEach(p=>p.dispatch()),u.Destroy.forEach(p=>p.dispatch()),u.Reset.forEach(p=>p.dispatch()),u.Transition.forEach(p=>{p.object.currentTransitionEvent!==this&&(p.object.currentTransitionEvent=this),p.init()}),u.Transition.forEach(p=>p.play()),u.Animation.forEach(p=>p.play()),u.SwitchCamera.forEach(p=>p.play()),u.SceneTransition.forEach(p=>p.dispatch()),u.SetVariable.forEach(p=>p.checkConditions()),u.SetVariable.forEach(p=>p.dispatch()),u.DynamicVariablePlay.forEach(p=>p.dispatch()),u.ClearLocalStorage.forEach(p=>p.dispatch()),u.UserAPI.forEach(p=>p.dispatch())}};let{distance:n,fromObject:o,toObject:l}=t.condition;this.distance=n;for(let h of[o,l]){if(!h)throw new Error("Missing property");let c=r.find(h);if(!c)throw new Error("Missing property");this.objects.push(c)}}connect(){window.setTimeout(()=>{this.objects.forEach(e=>{e.addEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)}),this.onUpdateMatrixWorld()},0)}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach(e=>{e.removeEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)})}},GZ=class extends Qw{constructor(e,t,i,r,s,a){var l;super(t,i,r,s,a),this.id=e,this.data=t,this.object=i,this.onBegin=({target:h,state:c})=>{this.toState!==c&&(this.actionsOut.Audio.forEach(d=>d.dispatchConditional()),this.actionsOut.Particles.forEach(d=>d.dispatchConditional()),this.actionsOut.Video.forEach(d=>d.dispatchConditional()),this.actionsOut.Link.forEach(d=>d.dispatch()),this.actionsOut.Create.forEach(d=>d.dispatch()),this.actionsOut.Destroy.forEach(d=>d.dispatch()),this.actionsOut.Reset.forEach(d=>d.dispatch()),this.actionsIn.Transition.forEach(d=>d.pause()),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach(d=>d.play()),this.actionsOut.Animation.forEach(d=>d.play()),this.actionsIn.SwitchCamera.forEach(d=>d.pause()),this.actionsOut.SwitchCamera.forEach(d=>d.play()),this.actionsOut.SceneTransition.forEach(d=>d.dispatch()),this.actionsOut.SetVariable.forEach(d=>d.checkConditions()),this.actionsOut.SetVariable.forEach(d=>d.dispatch()),this.actionsOut.DynamicVariablePlay.forEach(d=>d.dispatch()),this.actionsOut.ClearLocalStorage.forEach(d=>d.dispatch()),this.actionsOut.UserAPI.forEach(d=>d.dispatch()))},this.onComplete=({target:h,state:c})=>{this.toState===c&&(this.actionsIn.Audio.forEach(d=>d.dispatchConditional()),this.actionsIn.Particles.forEach(d=>d.dispatchConditional()),this.actionsIn.Video.forEach(d=>d.dispatchConditional()),this.actionsIn.Link.forEach(d=>d.dispatch()),this.actionsIn.Create.forEach(d=>d.dispatch()),this.actionsIn.Destroy.forEach(d=>d.dispatch()),this.actionsIn.Reset.forEach(d=>d.dispatch()),this.actionsOut.Transition.forEach(d=>d.pause()),this.actionsOut.Transition.forEach(d=>d.pause()),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach(d=>d.play()),this.actionsIn.Animation.forEach(d=>d.play()),this.actionsOut.SwitchCamera.forEach(d=>d.pause()),this.actionsIn.SwitchCamera.forEach(d=>d.play()),this.actionsIn.SceneTransition.forEach(d=>d.dispatch()),this.actionsIn.SetVariable.forEach(d=>d.checkConditions()),this.actionsIn.SetVariable.forEach(d=>d.dispatch()),this.actionsIn.DynamicVariablePlay.forEach(d=>d.dispatch()),this.actionsOut.ClearLocalStorage.forEach(d=>d.dispatch()),this.actionsOut.UserAPI.forEach(d=>d.dispatch()))};let{condition:n}=t;if(!n.object)throw new Error("Missing property");let o=r.find(n.object)??r.scene.find2D(n.object);if(!o)throw new Error("Missing property");if(this.toObject=o,n.state&&!((l=this.toObject.states)!=null&&l[n.state]))throw new Error("Missing property");this.toState=n.state}connect(){vn(this.actionsOut).forEach(e=>{var t;(t=this.actionsOut[e])!=null&&t.length&&this.toObject.addEventListener("beginState",this.onBegin)}),vn(this.actionsIn).forEach(e=>{var t;(t=this.actionsIn[e])!=null&&t.length&&this.toObject.addEventListener("completeState",this.onComplete)})}disconnect(){super.disconnect(),vn(this.actionsOut).forEach(e=>{var t;(t=this.actionsIn[e])!=null&&t.length&&this.toObject.removeEventListener("beginState",this.onBegin)}),vn(this.actionsIn).forEach(e=>{var t;(t=this.actionsIn[e])!=null&&t.length&&this.toObject.removeEventListener("completeState",this.onComplete)})}},HZ=class extends x1{constructor(e,t){super(e),this.eventManager=t,this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1}connect(){super.connect();let{page:e,sharedAssets:t}=this.eventContext;e.traverseEntity(i=>{var r;if((r=i.data)!=null&&r.events.length){for(let{id:s,data:a}of i.data.events)if(!a.disabled&&a.type==="Conditional")try{let n;a.condition.type==="Comparison"||(a.condition.type==="Distance"?n=new jZ(s,a,i,e,t,this.eventManager):a.condition.type==="State"&&(n=new GZ(s,a,i,e,t,this.eventManager))),n&&(this.eventsPerConditions[a.condition.type].push(n),(n.actionsIn.Video.length||n.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch{}}}),Object.values(this.eventsPerConditions).forEach(i=>i.forEach(r=>r.connect()))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach(e=>e.forEach(t=>t.disconnect()))}},a2=new E,ba=new E,rn=new E,I7=new B1,WZ=.01,Lt=new E,Ii=new E,O7=new E,En=new lt,Fp=new Ri,qZ=new we,kp=new Ai,So=new E,Qr=new E,_o=.2;function Up(e,t){!t||(t[0]<t[1]&&(e.x=Math.min(Math.max(e.x,t[0]),t[1])),t[2]<t[3]&&(e.y=Math.min(Math.max(e.y,t[2]),t[3])),t[4]<t[5]&&(e.z=Math.min(Math.max(e.z,t[4]),t[5])))}var YZ=function(){let e=new we;return(t,i,r)=>{let s=t.obj;e.copy(s.hiddenMatrix),s.parent!==null&&e.premultiply(s.parent.matrixWorld),e.invert(),s.position.copy(i),t.reference==="global"&&Up(s.position,t.limits),s.position.applyMatrix4(e),t.reference==="parent"?Up(s.position,t.limits):t.reference==="local"&&(En.copy(t.quat0).invert(),s.position.sub(t.position0),s.position.applyQuaternion(En),Up(s.position,t.limits),En.invert(),s.position.applyQuaternion(En),s.position.add(t.position0)),e.multiply(r??s.matrixWorld).decompose(Lt,s.quaternion,Ii),s.updateMatrix(),s.hasNonUniformScale&&(s.updateMatrixWorld(),s.updateMatrixWorldSVD()),s instanceof D1&&Xs(s.parent)&&s.invalidateDownstreamBooleanData(!0)}}(),XZ=class{constructor(e,t,i,r,s,a,n){this.object=e,this.id=t,this.data=i,this.dropDestIds=[],this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=this.data.resetSpeed===0?1:8/this.data.resetSpeed+1,this.snapDampingFactor=this.data.snapSpeed===0?1:8/this.data.snapSpeed+1,this.actionsDrag=Ci(i,i.dragDropActions.drag,r,s,a,this.object),this.actionsDrop=Ci(i,i.dragDropActions.drop,r,s,a,this.object);let o=[];this.data.objects.forEach(l=>{let h=r.find(l);!h||h.data.visible!==!1&&(o.push(h),n[h.uuid]&&n[h.uuid].forEach(c=>{let d=r.find(c);!d||d.data.visible!==!1&&o.push(d)}))}),this.data.dropDestinations.forEach(l=>{let h=r.find(l);!h||h.data.visible!==!1&&(this.dropDestIds.push(h.uuid),n[h.uuid]&&n[h.uuid].forEach(c=>{let d=r.find(c);!d||d.data.visible!==!1&&this.dropDestIds.push(d.uuid)}))}),this.dragItems=o.map(l=>(this.data.planeMode==="locked"&&(l.userData.lockedPlane=!0),l.userData.worldPosition0=new E().setFromMatrixPosition(l.matrixWorld),{obj:l,fromPosition:new E().setFromMatrixPosition(l.matrixWorld),pointStart:new E,pointEnd:new E,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:new E().copy(l.position),quat0:new lt().copy(l.quaternion),snapped:!1,orientationMatrix:new we,limits:this.data.limits,reference:this.data.referenceFrame}))}get activeDragItem(){return this.activeIdx!==null?this.dragItems[this.activeIdx]:null}dispose(){Qi(this.actionsDrag),Qi(this.actionsDrop),this.dragItems.forEach(e=>{e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart),e.obj.recursiveBBoxNeedsUpdate=!0,e.obj.userData.lockedPlane=void 0,e.obj.position.copy(e.position0),e.obj.quaternion.copy(e.quat0),e.obj.updateMatrix()})}},QZ=class extends x1{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=i=>{var n;if(it.length>1)return;this.eventContext.updateRaycaster(i);let{raycaster:r,page:s}=this.eventContext,a=s.raycastWithClones(r);if(this.lastDropDestination=null,a.length===0){this.activeEvent=null;return}for(let o of this.events){let l=0;for(let{obj:h,pointEnd:c,pointStart:d}of o.dragItems){if(h===a[0].object||h===a[0].object.object||Et.is(h)&&h.isAncestorOf(a[0].object.uuid)){if(o.activeIdx=l,o.activeDragItem.reset=!1,o.activeDragItem.currentDampingFactor=o.data.dampingFactor,o.activeDragItem.snapped=!1,o.data.cursor==="hand"&&this.setCursor("grabbing"),this.eventManager.controlsManager.usePhysics){o.activeDragItem.obj.rigidBody&&o.activeDragItem.obj.rigidBody.setBodyType(2,!0);let u=o.activeDragItem.obj;h.hasNonUniformScale&&h.updateMatrixWorldSVD(),(u.hasNonUniformScale?u.matrixWorldRigid:u.matrixWorld).decompose(Lt,En,Ii),Fp.setFromQuaternion(En),u.prevR===void 0?(u.prevR=Fp.clone(),u.prevT=Lt.clone()):(u.prevR.copy(Fp),u.prevT.copy(Lt)),this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(o.activeDragItem.obj)}this.calcPlaneIntersectPos(h,d,o.data.plane,o.data.referenceFrame),c.copy(d),(this.eventManager.controlsManager.usePhysics&&((n=h.data.physics)==null?void 0:n.rigidBody)==="dynamic"||o.data.drop===!1||o.data.resetOnSnapFail===!1)&&o.activeDragItem.fromPosition.setFromMatrixPosition(o.activeDragItem.obj.matrixWorld),this.activeEvent=o,this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1);return}l++}}this.activeEvent=null},this.onPointerMove=i=>{var n,o,l,h;if(it.length>1)return;this.eventContext.updateRaycaster(i);let{raycaster:r,page:s}=this.eventContext,a=s.raycastWithClones(r);if(it.length===0){let c=!1;for(let d of this.events){for(let{obj:u}of d.dragItems)if(u===((n=a[0])==null?void 0:n.object)||u===((l=(o=a[0])==null?void 0:o.object)==null?void 0:l.object)||Et.is(u)&&u.isAncestorOf((h=a[0])==null?void 0:h.object.uuid)){switch(c=!0,d.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move");break}break}if(c)break}c||this.setCursor("default");return}if(this.activeEvent&&this.activeEvent.activeDragItem){let c=this.activeEvent.activeDragItem;c.snapped=!1;let d;if(this.activeEvent.data.drop&&(d=a.filter(u=>c.obj!==u.object&&!c.obj.isAncestorOf(u.object.uuid)&&!(u.object instanceof Jo)&&(this.activeEvent.data.dropOn==="all"||this.activeEvent.dropDestIds.some(p=>p===u.object.uuid||s.scene.find(p).isAncestorOf(u.object.uuid))))[0]),d){let u=O7.copy(d.face.normal).applyMatrix3(kp.getNormalMatrix(d.object.matrixWorld));if(this.activeEvent.data.snapTo==="center")c.fromPosition.setFromMatrixPosition(d.object.matrixWorld);else if(this.activeEvent.data.snapTo==="surface"){if(c.fromPosition.copy(d.point),this.activeEvent.data.snapSurfaceMode==="bbox"){Lt.copy(u).applyMatrix3(kp.setFromMatrix4(c.obj.matrixWorld).transpose());let p=c.obj;Lt.x>_o?Ii.x=-p.recursiveBBox.min.x:Lt.x<-_o&&(Ii.x=-p.recursiveBBox.max.x),Lt.y>_o?Ii.y=-p.recursiveBBox.min.y:Lt.y<-_o&&(Ii.y=-p.recursiveBBox.max.y),Lt.z>_o?Ii.z=-p.recursiveBBox.min.z:Lt.z<-_o&&(Ii.z=-p.recursiveBBox.max.z),Ii.applyMatrix3(kp.invert())}else Ii.copy(u).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);c.fromPosition.add(Ii)}this.activeEvent.data.autoOrient&&(Lt.set(0,1,0).cross(u),Lt.length()<1e-4&&Lt.set(-1,0,0).cross(u),Ii.crossVectors(O7,Lt),c.orientationMatrix.makeBasis(Lt,Ii,u)),c.pointStart.copy(c.fromPosition),c.pointEnd.copy(c.pointStart),c.currentDampingFactor=this.activeEvent.snapDampingFactor,c.snapped=!0,this.lastDropDestination!==d.object&&(this.lastDropDestination=d.object,this.activeEvent.actionsDrop.Transition.forEach(p=>{p.play()}),this.activeEvent.actionsDrop.Animation.forEach(p=>{p.play()}),this.activeEvent.actionsDrop.Audio.forEach(p=>{p.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Particles.forEach(p=>{p.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Create.forEach(p=>{p.dispatchThrottled()}))}else c.orientationMatrix.makeRotationFromQuaternion(c.quat0),this.lastDropDestination=null,c.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(c.obj,c.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach(u=>{u.stop(),u.object.currentState!==null&&u.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrop.Animation.forEach(u=>{u.stop()}),this.activeEvent.actionsDrop.Audio.forEach(u=>{u.dispatchGameControl("stop")}),this.activeEvent.actionsDrop.Particles.forEach(u=>{u.dispatchGameControl("stop")});this.activeEvent.actionsDrag.Create.forEach(u=>{u.dispatchThrottled()}),this.activeEvent.actionsDrag.SetVariable.forEach(u=>u.checkConditions()),this.activeEvent.actionsDrag.SetVariable.forEach(u=>u.dispatch()),this.activeEvent.actionsDrag.DynamicVariablePlay.forEach(u=>u.dispatch()),this.activeEvent.actionsDrag.ClearLocalStorage.forEach(u=>u.dispatch()),this.activeEvent.actionsDrag.UserAPI.forEach(u=>u.dispatch()),this.activeEvent.wasDragEventTriggered===!1&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach(u=>{u.play()}),this.activeEvent.actionsDrag.Animation.forEach(u=>{u.play()}),this.activeEvent.actionsDrag.Audio.forEach(u=>{u.dispatchGameControl("start")}),this.activeEvent.actionsDrag.Particles.forEach(u=>{u.dispatchGameControl("start")})),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout(()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach(u=>{u.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Particles.forEach(u=>{u.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Transition.forEach(u=>{u.stop(),u.object.currentState!==null&&u.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(u=>{u.stop()}))},500),this.updateDragItem(c),c.obj.dispatchEvent({type:"requestRender"})}},this.onPointerUp=i=>{var r;if(this.activeEvent&&this.activeEvent.activeDragItem){this.activeEvent.data.cursor==="hand"&&this.setCursor("grab");let s=((r=this.activeEvent.activeDragItem.obj.data.physics)==null?void 0:r.rigidBody)==="dynamic";this.activeEvent.activeDragItem.snapped===!1&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(this.eventManager.controlsManager.usePhysics===!1||!s)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.eventManager.controlsManager.usePhysics&&s&&(this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),this.activeEvent.wasDragEventTriggered===!0&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach(a=>{a.stop(),a.object.currentState!==null&&a.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(a=>{a.stop()}),this.activeEvent.actionsDrag.Audio.forEach(a=>{a.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Particles.forEach(a=>{a.dispatchGameControl("stop")}),this.activeEvent.actionsDrop.SetVariable.forEach(a=>a.checkConditions()),this.activeEvent.actionsDrop.SetVariable.forEach(a=>a.dispatch()),this.activeEvent.actionsDrop.DynamicVariablePlay.forEach(a=>a.dispatch()),this.activeEvent.actionsDrop.ClearLocalStorage.forEach(a=>a.dispatch()),this.activeEvent.actionsDrop.UserAPI.forEach(a=>a.dispatch())),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0)}}}connect(){let e={};if(this.eventContext.page.traverseEntity(i=>{i.component&&(e[i.component.uuid]?e[i.component.uuid].push(i.uuid):e[i.component.uuid]=[i.uuid])}),this.eventContext.page.traverseEntity(i=>{var r;(r=i.data)==null||r.events.filter(s=>s.data.type==="DragDrop"&&!s.data.disabled).forEach(s=>{this.events.push(new XZ(i,s.id,s.data,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager,e))})}),!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let t=this.eventContext.domElement;t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let e=this.eventContext.domElement;e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),this.events.forEach(t=>t.dispose())}setCursor(e){this.eventContext.domElement.style.cursor=e}onAnimationFrameDamping(){for(let e of this.events)for(let t of e.dragItems)t.paused||this.updateDragItem(t,!0)}calcPlaneIntersectPos(e,t,i,r){let{getCamera:s,raycaster:a}=this.eventContext;s().getWorldDirection(ba),ba.negate();let n=En.identity();switch(r==="parent"?qZ.multiplyMatrices(e.parent.matrixWorld,e.hiddenMatrix).decompose(Lt,n,Ii):r==="local"&&e.matrixWorld.decompose(Lt,n,Ii),i){case"x":Lt.set(1,0,0).applyQuaternion(n),So.copy(ba).cross(Lt),Qr.copy(Lt).cross(So);break;case"y":Lt.set(0,1,0).applyQuaternion(n),So.copy(ba).cross(Lt),Qr.copy(Lt).cross(So);break;case"z":Lt.set(0,0,1).applyQuaternion(n),So.copy(ba).cross(Lt),Qr.copy(Lt).cross(So);break;case"xy":Qr.set(0,0,1).applyQuaternion(n);break;case"yz":Qr.set(1,0,0).applyQuaternion(n);break;case"xz":Qr.set(0,1,0).applyQuaternion(n);break;case"adaptive":ba.angleTo(Ii.set(0,1,0))>Math.PI/6?(Lt.crossVectors(Ii.set(0,1,0),ba),Qr.crossVectors(Lt,Ii)):Qr.set(0,1,0);break;default:Qr.copy(ba);break}rn.setFromMatrixPosition(e.matrixWorld);let o=e.userData.lockedPlane?e.userData.worldPosition0:rn;if(I7.setFromNormalAndCoplanarPoint(Qr,o),!!a.ray.intersectPlane(I7,t)&&(i==="x"||i==="y"||i==="z")){let l=Ii.subVectors(t,o).dot(Lt);t.copy(o).addScaledVector(Lt,l)}}updateDragItem(e,t=!1){var i,r;rn.setFromMatrixPosition(e.obj.matrixWorld),e.reset==="current"?a2.subVectors(e.fromPosition,rn).divideScalar(e.currentDampingFactor):e.reset==="original"?(a2.subVectors(e.obj.userData.worldPosition0,rn).divideScalar(e.currentDampingFactor),e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart)):a2.subVectors(e.pointEnd,e.pointStart).add(e.fromPosition).sub(rn).divideScalar(e.currentDampingFactor),e.paused=e.currentDampingFactor>1?a2.length()<WZ:!0,(this.activeEvent&&this.activeEvent.data.dampingFactor===1||t)&&YZ(e,a2.add(rn),(i=this.activeEvent)!=null&&i.data.drop&&((r=this.activeEvent)!=null&&r.data.autoOrient)?e.orientationMatrix:null),e.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.eventManager.requestRender()}},Ao=new E,Np=new E,Ps=new E,Ds=new E,R7=new B1,ZZ=.01,KZ={type:"requestRender"},JZ=function(){let e=new E,t=new E;return(i,r,s)=>s>0?(e.subVectors(i,r),e.length()<=s?i:t.copy(r).add(e.normalize().multiplyScalar(s))):r}(),L7=function(){let e=new we;return(t,i)=>{t.position.copy(i),t.parent!==null&&(e.copy(t.parent.matrixWorld).invert(),t.position.applyMatrix4(e)),e.copy(t.hiddenMatrix).invert(),t.position.applyMatrix4(e),t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD()),t instanceof D1&&Xs(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),$Z=class{constructor(e,t,i,r,s,a){this.data=e,this.id=t,this.object=i,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new E,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...M3.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(this.target=r.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=Ci(e,e.actions,r,s,a,i)}},eK=class extends x1{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.pairOfEventListeners=[],this.onMouseMove=i=>{if(!(it.length>1)){this.eventContext.updateRaycaster(i);for(let r of this.events)r.target===void 0&&this.updateSingleEvent(r)}},this.onMouseEnter=i=>{for(let r of this.events)r.target===void 0&&(r.isReset=!1,r.currentDampingFactor=r.data.dampingFactor)},this.onMouseLeave=i=>{for(let r of this.events)r.target===void 0&&(r.data.resetOnPointerLeave&&(r.isReset=!0,r.currentDampingFactor=r.resetDampingFactor),this.updateSingleEvent(r))},this.onTargetChange=i=>()=>{this.updateSingleEvent(i)}}connect(){let{page:e}=this.eventContext;if(e.traverseEntity(r=>{var a,n;let s=(a=r.data)==null?void 0:a.events.find(o=>o.data.type==="Follow"&&!o.data.disabled);s&&(!e.data.globalPhysics.usePhysics||((n=r.dataPatched.physics)==null?void 0:n.rigidBody)!=="dynamic")&&this.events.push(new $Z(s.data,s.id,r,e,this.eventContext.sharedAssets,this.eventManager))}),!this.events.length)return;let{domElement:t,eventElement:i}=this.eventContext;this.domEventsNeeded.clear(),q1&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),i.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let r of this.events)if(r.target!==void 0){let s=r.target,a=this.onTargetChange(r);this.pairOfEventListeners.push([s,a]),s.addEventListener("requestRender",a)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),q1&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave);for(let[i,r]of this.pairOfEventListeners)i.removeEventListener("requestRender",r);for(let i of this.events)i.paused=!0,i.isReset=!1,Qi(i.actions)}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e,!0)}updateSingleEvent(e,t=!1){var n;this.events.forEach(o=>{o.actions.Create.forEach(l=>{l.dispatchThrottled()})});let{plane:i,limitDistance:r,limitDistanceEnabled:s}=e.data;if(e.object.getWorldPosition(Ps),e.isReset)Ds.copy(e.worldPosition0);else if(e.target)e.target.getWorldPosition(Ds);else{let{getCamera:o,raycaster:l}=this.eventContext;if(i==="custom"?(o().getWorldDirection(Np),Np.negate(),Ao.copy(Np)):i==="xy"?Ao.set(0,0,1):i==="xz"?Ao.set(0,1,0):i==="yz"&&Ao.set(1,0,0),R7.setFromNormalAndCoplanarPoint(Ao,Ps),!l.ray.intersectPlane(R7,Ds))return}if(!e.isReset){if(Ds.distanceTo(e.worldPosition0)>r&&s&&e.target)if(e.snapComplete=!1,e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)Ds.copy(e.worldPosition0),e.currentDampingFactor=e.resetDampingFactor;else return;else if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return}e.data.enabledTranslation[0]===!1&&(Ds.x=Ps.x),e.data.enabledTranslation[1]===!1&&(Ds.y=Ps.y),e.data.enabledTranslation[2]===!1&&(Ds.z=Ps.z);let a=JZ(Ps,Ds,e.wasOutside?0:e.data.maxDelta);if(e.currentDampingFactor>1){let o=Ao.subVectors(a,Ps).divideScalar(e.currentDampingFactor);Ps.add(o),t&&L7(e.object,Ps),e.paused=o.length()<ZZ}else L7(e.object,a),e.paused=!0;(n=e.object)==null||n.dispatchEvent({type:"beginEvent",eventName:"Follow"}),e.object.dispatchEvent(KZ)}},n2=new E,N0=new E,o2=new we,Mo=new lt,wa=new lt,l2=new E,h2=new E,sn=new E,Is=new E,Vp=new B1,tK=1e-6,iK={type:"requestRender"},rK={type:"changeRotation"},B7=function(){let e=new we;return function(t,i){t.parent!==null?e.multiplyMatrices(t.parent.matrixWorld,t.hiddenMatrix):e.copy(t.hiddenMatrix),i.premultiply(Hw(e).invert()),t.rotation.setFromRotationMatrix(i),t.updateMatrix(),t instanceof D1&&Xs(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),sK=class{constructor(e,t,i,r){this.id=t,this.object=i,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new lt,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...E3.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(this.target=r.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},aK=class extends x1{constructor(){super(...arguments),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=e=>{if(!(it.length>1)){this._lastMouseEvent=e,this.eventContext.updateRaycaster(e);for(let t of this.events)t.target===void 0&&this.updateSingleEvent(t)}},this.onMouseEnter=e=>{for(let t of this.events)t.target===void 0&&(t.isReset=!1,t.currentDampingFactor=t.data.dampingFactor)},this.onMouseLeave=e=>{for(let t of this.events)t.target===void 0&&(t.data.resetOnPointerLeave&&(t.isReset=!0,t.currentDampingFactor=t.resetDampingFactor),this.updateSingleEvent(t))},this.onScroll=e=>{if(this._lastMouseEvent){let t=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(t)}},this.onTargetChange=e=>()=>{this.updateSingleEvent(e)},this.createUserEventListener=e=>({eventName:t,target:i})=>{if(!t||!i)return;let r=yh(t);r&&r==="LookAt"&&this.updateSingleEvent(e)}}connect(){let{page:e}=this.eventContext;if(e.traverseEntity(r=>{var a,n;let s=(a=r.data)==null?void 0:a.events.find(o=>o.data.type==="LookAt"&&!o.data.disabled);s&&(!e.data.globalPhysics.usePhysics||((n=r.dataPatched.physics)==null?void 0:n.rigidBody)!=="dynamic")&&this.events.push(new sK(s.data,s.id,r,e))}),!this.events.length)return;let{domElement:t,eventElement:i}=this.eventContext;this.domEventsNeeded.clear(),q1&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),i.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?i.addEventListener("scroll",this.onScroll):(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let r of this.events){if(r.target!==void 0){let n=this.onTargetChange(r),o=r.target;this.pairOfEventListeners.push([o,n]),o.addEventListener("requestRender",n)}let s=this.createUserEventListener(r),a=r.object;this.pairOfUserEventListeners.push([a,s]),a.addEventListener("userEvent",s)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),q1&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave),t.removeEventListener("scroll",this.onScroll);for(let[i,r]of this.pairOfEventListeners)i.removeEventListener("requestRender",r);for(let[i,r]of this.pairOfUserEventListeners)i.removeEventListener("userEvent",r);for(let i of this.events)i.paused=!0,i.isReset=!1}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e)}updateSingleEvent(e){var u;let{tilt:t,axis:i,distance:r,plane:s,limitDistance:a,enabledRotation:n,limitDistanceEnabled:o}=e.data,{getCamera:l,raycaster:h}=this.eventContext,{object:c,target:d}=e;if(c.getWorldPosition(l2),!e.isReset)if(e.target)e.target.getWorldPosition(h2);else{if(s==="custom"?(l().getWorldDirection(N0),N0.negate(),Vp.setFromNormalAndCoplanarPoint(N0,l2)):(s==="xy"?n2.set(0,0,1):s==="xz"?n2.set(0,1,0):s==="yz"&&n2.set(1,0,0),Vp.setFromNormalAndCoplanarPoint(n2,l2)),!h.ray.intersectPlane(Vp,h2))return;r>0&&(s==="custom"||s===void 0)&&h2.addScaledVector(N0,r)}if(e.isReset||(d?t==="target"?sn.copy(d.up).applyMatrix4(o2.extractRotation(d.matrixWorld)).normalize():n.some(p=>p===!1)?(i==="x"?(Is.set(0,0,1),n[2]===!1&&Is.set(0,1,0)):i==="y"?(Is.set(1,0,0),n[0]===!1&&Is.set(0,0,1)):(Is.set(0,1,0),n[1]===!1&&Is.set(1,0,0)),sn.copy(Is).applyQuaternion(e.worldQuaternion0).normalize()):sn.set(0,1,0):s==="custom"?sn.set(0,1,0):sn.copy(n2)),e.isReset)wa.copy(e.worldQuaternion0);else if(l2.distanceTo(h2)>a&&o&&d)if(e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)wa.copy(e.worldQuaternion0),e.currentDampingFactor=e.resetDampingFactor;else return;else{if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return;nK(o2,h2,l2,sn,i,Is),wa.setFromRotationMatrix(o2),Mo.setFromUnitVectors(Is.applyQuaternion(wa),sn),n.some(p=>p===!1)&&t!=="target"&&wa.premultiply(Mo).normalize()}e.currentDampingFactor>1?(c.updateWorldMatrix(!0,!1),Mo.setFromRotationMatrix(Hw(c.matrixWorld)),Mo.slerp(wa,1/e.currentDampingFactor),B7(c,o2.makeRotationFromQuaternion(Mo)),e.paused=8*(1-Mo.dot(wa))<tK):(B7(c,o2.makeRotationFromQuaternion(wa)),e.paused=!0),(u=e.object)==null||u.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),c.dispatchEvent(iK),c.dispatchEvent(rK)}},er=new E,Di=new E,fi=new E;function nK(e,t,i,r,s,a){let n=e.elements;fi.subVectors(t,i),fi.lengthSq()===0&&(fi.z=1),fi.normalize(),Di.crossVectors(r,fi),Di.lengthSq()===0&&(Math.abs(r.z)===1?fi.x+=1e-4:fi.z+=1e-4,fi.normalize(),Di.crossVectors(r,fi)),Di.normalize(),er.crossVectors(fi,Di),s==="x"?a.z===1?[Di,er,fi]=[fi,Di,er]:(Di.negate(),[Di,fi]=[fi,Di]):s==="y"?a.x===1?[Di,er,fi]=[er,fi,Di]:(Di.negate(),[er,fi]=[fi,er]):a.x===1&&(Di.negate(),[Di,er]=[er,Di]),n[0]=Di.x,n[4]=er.x,n[8]=fi.x,n[1]=Di.y,n[5]=er.y,n[9]=fi.y,n[2]=Di.z,n[6]=er.z,n[10]=fi.z}var oK=class{constructor(e,t,i,r,s,a){this.id=e,this.data=t,this.object=i,this.entered=!1,this.actions=Ci(t,t.actions,r,s,a,i)}disconnect(){Qi(this.actions)}dispatchEnter(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered||(this.entered=!0,this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.play()),this.actions.Create.forEach(e=>e.dispatchStart()),this.actions.Particles.forEach(e=>e.dispatchBasic()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent()),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch()))}dispatchLeave(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered&&(this.entered=!1,this.actions.Create.forEach(e=>e.dispatchStop()),this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Particles.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Particles.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatch()),this.actions.Particles.forEach(t=>t.dispatchBasic()),this.actions.Destroy.forEach(t=>t.dispatch()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.SceneTransition.forEach(t=>t.dispatch()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}},lK=class extends x1{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObjects={},this.objects=[],this.objects2D=[],this._prevObjects=[],this.onMouseDown=i=>{it.length>1||(this.eventContext.updateRaycaster(i),this.handleMouseHoverEvent())},this.onMouseUp=i=>{it.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=i=>{it.length>1||(this.eventContext.updateRaycaster(i),this.handleMouseHoverEvent())},this.onUserEvent=({eventName:i,target:r,reverse:s})=>{var n;if(!i||!r)return;let a=yh(i);a&&a==="MouseHover"&&(r.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(n=this.eventsPerObjects[r.uuid])==null||n.forEach(o=>o.dispatchUserEvent(s)))}}connect(){let{page:e,sharedAssets:t}=this.eventContext,i=(s,a)=>{var n,o;if(!(!s.visible||!((n=s.data)!=null&&n.events.length))){for(let{id:l,data:h}of s.data.events)if(!h.disabled&&h.type==="MouseHover")try{let c=new oK(l,h,s,e,t,this.eventManager);this.eventsPerObjects[s.uuid]?this.eventsPerObjects[s.uuid].push(c):this.eventsPerObjects[s.uuid]=[c]}catch{}(o=this.eventsPerObjects[s.uuid])!=null&&o.length&&this.objects.push(s instanceof Zi?a:s)}};if(e.traverseEntity(s=>{var a;(s instanceof p1||s instanceof Gi)&&((a=s.frame)==null||a.traverse(n=>{i(n,s)})),i(s)}),!this.objects.length)return;let{domElement:r}=this.eventContext;this.domEventsNeeded.clear(),q1&&(this.domEventsNeeded.add("pointerdown"),r.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),r.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),r.addEventListener("pointermove",this.onMouseMove),this.objects.forEach(s=>{s.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if(!this.objects.length)return;let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),q1&&(e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerup",this.onMouseUp)),e.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach(t=>{t.forEach(i=>{i.disconnect()})}),this.objects.forEach(t=>{t.removeEventListener("userEvent",this.onUserEvent)})}handleMouseHoverEvent(e=!1){let t=[];if(!e){let{stopRaycast:i,raycaster:r,page:s,pointerScreen:a}=this.eventContext,n=!1;if(s.uiCanvas&&(n=Ns(s,[a.x,a.y],Object.keys(this.eventsPerObjects),o=>{t.push(o)})),i&&!n){let o=oc(r,s,this.objects);t=Qf(o),o.forEach(l=>{var h,c;l.object instanceof p1&&Ns(l.object,[((h=l==null?void 0:l.uv)==null?void 0:h.x)??0,((c=l==null?void 0:l.uv)==null?void 0:c.y)??0],Object.keys(this.eventsPerObjects),d=>{t.push(d)})})}else this.objects.forEach(o=>{var h,c;let l=cd(r,o);l&&(t.push(o),o instanceof p1&&Ns(o,[((h=l==null?void 0:l.uv)==null?void 0:h.x)??0,((c=l==null?void 0:l.uv)==null?void 0:c.y)??0],Object.keys(this.eventsPerObjects),d=>{t.push(d)}))})}this._prevObjects.length&&this._prevObjects.forEach(i=>{var r;t.includes(i)||(i.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(r=this.eventsPerObjects[i.uuid])==null||r.forEach(s=>s.dispatchLeave()))}),t.length&&t.forEach(i=>{var r;i.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(r=this.eventsPerObjects[i.uuid])==null||r.forEach(s=>s.dispatchEnter())}),this._prevObjects=t}},hK=class{constructor(e,t,i,r,s,a){this.id=e,this.data=t,this.object=i,this.scrollCounter=0,this.actions=Ci(t,t.actions,r,s,a,i)}connect(){this.scrollCounter=0}disconnect(){Qi(this.actions)}dispatch(e){this.actions.Transition.forEach(r=>{r.object.currentTransitionEvent!==this&&(r.object.currentTransitionEvent=this,r.init())});let t=e>0?1:-1;this.scrollCounter+=t,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let i=this.scrollCounter/this.data.steps;this.actions.Transition.forEach(r=>r.seek(i)),this.actions.Animation.forEach(r=>r.seek(t)),this.actions.Create.forEach(r=>r.dispatchThrottled()),this.actions.SetVariable.forEach(r=>r.checkConditions()),this.actions.SetVariable.forEach(r=>r.dispatch()),this.actions.DynamicVariablePlay.forEach(r=>r.dispatch()),this.actions.ClearLocalStorage.forEach(r=>r.dispatch()),this.actions.UserAPI.forEach(r=>r.dispatch())}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Animation.forEach(t=>{t.playFromCurrent()})),this.actions.Create.forEach(t=>t.dispatchThrottled()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}},cK=class{constructor(e,t,i,r,s,a,n){this.id=e,this.data=t,this.object=i,this.domElement=a,this.eventManager=n,this.scrollStart=0,this.scrollEnd=0,this.actions=Ci(t,t.actions,r,s,n,i)}getStickyParentElement(){let e=this.domElement;for(;e;){if(window.getComputedStyle(e).position==="sticky")return e;e=e.parentElement}return null}computeScrollBounds(){let e=this.getStickyParentElement(),t=e==null?void 0:e.parentElement,i=this.domElement.getBoundingClientRect(),r={top:i.top,bottom:i.bottom,left:i.left,right:i.right,width:i.width,height:i.height};if(t){let h=t.getBoundingClientRect(),c=window.getComputedStyle(e),d=parseFloat(c.marginTop)+parseFloat(c.marginBottom),u=parseFloat(c.top),p=parseFloat(c.bottom),f=h.height-d;if(!isNaN(u))i.top===u?(r.top+=h.top-u,r.bottom+=h.top-u):i.top<0&&(r.top-=f-i.height,r.bottom-=f-i.height);else if(!isNaN(p)){let g=document.body.clientHeight??window.innerHeight,m=window.innerWidth-(document.documentElement.clientWidth??window.innerWidth);i.bottom===g-p?(r.top+=h.top-i.height+p+m,r.bottom+=h.top-i.height+p+m):i.bottom<g-p&&(r.top-=f-i.height,r.bottom-=f-i.height)}}let s=document.body,a=document.documentElement,n=window.pageYOffset||a.scrollTop||s.scrollTop,o=a.clientTop||s.clientTop||0,l=Math.round(r.top+n-o);if(this.data.startFrom==="enter"){let h=window.innerHeight,c=r.height,d=this.data.enterAnchor,u=d==="top"?h:d==="bottom"?h-c:h-c*.5;this.scrollStart=l-u}else this.scrollStart=0;this.scrollStart+=this.data.startOffset??0,this.scrollEnd=this.scrollStart+(this.data.endAfter??400),this.box=r,this.computeScroll({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){Qi(this.actions)}handleResize(){this.computeScrollBounds()}get isInvalidBox(){return this.box===void 0||this.box.width===0&&this.box.height===0&&this.box.top===0&&this.box.bottom===0}computeScroll({x:e,y:t}){this.actions.Transition.forEach(s=>{s.object.currentTransitionEvent!==this&&(s.object.currentTransitionEvent=this,s.init())});let i=this.scrollEnd-this.scrollStart,r=Math.min(1,Math.max(0,(t-this.scrollStart)/i));this.actions.Transition.forEach(s=>s.seek(r)),this.actions.Animation.forEach(s=>s.seek(r)),this.actions.Create.forEach(s=>s.dispatchThrottled()),this.actions.SetVariable.forEach(s=>s.checkConditions()),this.actions.SetVariable.forEach(s=>s.dispatch()),this.actions.DynamicVariablePlay.forEach(s=>s.dispatch()),this.actions.ClearLocalStorage.forEach(s=>s.dispatch()),this.actions.UserAPI.forEach(s=>s.dispatch())}dispatch(e){this.isInvalidBox&&this.computeScrollBounds(),this.computeScroll(e)}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Animation.forEach(t=>{t.playFromCurrent()})),this.actions.Create.forEach(t=>t.dispatchThrottled()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}},dK=class extends x1{constructor(e,t){super(e),this.managers=t,this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach(([i,r])=>{r.forEach(s=>s.handleResize())})},this.onScroll=i=>{if(!this.isInview)return;let r={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach(([s,a])=>{s.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:r}),a.forEach(n=>n.dispatch(r))})},this.onWheel=i=>{!this.isInview||i.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach(([r,s])=>{r.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:i.deltaY}),s.forEach(a=>a.dispatch(i.deltaY))})},this.onUserEvent=({eventName:i,target:r,reverse:s})=>{var n;if(!i||!r)return;let a=yh(i);a&&a==="Scroll"&&(r.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),(n=this.wheelEventsPerObject.get(r))==null||n.forEach(o=>{o.dispatchUserEvent(s)}))}}connect(){let{page:e,sharedAssets:t,domElement:i,isExport:r}=this.eventContext,s=a=>{var n,o,l;if((n=a.data)!=null&&n.events.length){for(let{id:h,data:c}of a.data.events)if(!c.disabled&&c.type==="Scroll")if(c.trigger==="load"||!r){let d=new hK(h,c,a,e,t,this.managers);this.wheelEventsPerObject.has(a)?(o=this.wheelEventsPerObject.get(a))==null||o.push(d):this.wheelEventsPerObject.set(a,[d])}else{let d=new cK(h,c,a,e,t,i,this.managers);this.scrollEventsPerObject.has(a)?(l=this.scrollEventsPerObject.get(a))==null||l.push(d):this.scrollEventsPerObject.set(a,[d])}}};e.traverseEntity(a=>{var n;(a instanceof p1||a instanceof Gi)&&((n=a.frame)==null||n.traverse(o=>{s(o)})),s(a)}),this.intersectionObserver=new IntersectionObserver(a=>{let n=a[0];n&&(this.isInview=n.isIntersecting)},{root:null}),this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach(([a,n])=>{n.forEach(o=>o.connect()),a.addEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([a,n])=>{n.forEach(o=>o.connect()),a.addEventListener("userEvent",this.onUserEvent)}),[...this.wheelEventsPerObject.values()].some(a=>a.length)&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some(a=>a.length)&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(i=>i.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(i=>i.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)})}},uK=class{constructor(e,t,i,r,s,a){this.id=e,this.data=t,this.object=i,this.actions=Ci(t,t.actions,r,s,a,i)}disconnect(){Qi(this.actions)}dispatch(){this.actions.Transition.forEach(e=>{e.play()}),this.actions.Animation.forEach(e=>{e.play()}),this.actions.SwitchCamera.forEach(e=>{e.play()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch()),this.actions.Create.forEach(e=>{e.dispatchFromStart()}),this.actions.Destroy.forEach(e=>{e.dispatchFromStart()})}dispatchAfter(e){this.actions.Audio.forEach(t=>{(t.interaction.data.triggerAfter??"any")===e&&(t.interaction instanceof Mn?t.interaction.audioPlayer.play():t.interaction instanceof Gf&&t.interaction.dispatch())}),this.actions.Video.forEach(t=>{let i=t.interaction.data.triggerAfter??"autoplay";i===e&&(t.interaction instanceof el?t.interaction.play(i==="autoplay"):t.interaction instanceof Yf&&t.interaction.dispatch())}),this.actions.Particles.forEach(t=>{(t.data.triggerAfter??"any")===e&&t.dispatchBasic()})}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.SceneTransition.forEach(t=>t.dispatch()),this.actions.Reset.forEach(t=>t.dispatch()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch()),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.interaction instanceof Mn?t.interaction.audioPlayer.play():t.interaction instanceof Gf&&t.interaction.dispatch()}),this.actions.Video.forEach(t=>{t.interaction instanceof el?t.interaction.play():t.interaction instanceof Yf&&t.interaction.dispatch()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()})}},pK=class extends x1{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,r])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),r.forEach(s=>{s.dispatchAfter("mouseDown")})})},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,r])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),r.forEach(s=>{s.dispatchAfter("keyDown")})})},this.onAny=()=>{let{domElement:i,isExport:r}=this.eventContext,s=r?document:i;s.removeEventListener("pointerdown",this.onAny),s.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([a,n])=>{a.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(o=>{o.dispatchAfter("any")})})},this.onSceneTransitionAudioVideoPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,r])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),r.forEach(s=>{s.actions.Audio.forEach(a=>{a.interaction instanceof Mn&&a.interaction.audioPlayer.play()}),s.actions.Video.forEach(a=>{let n=a.interaction.data.triggerAfter??"autoplay";a.interaction instanceof el&&a.interaction.play(n==="autoplay")}),s.actions.Particles.forEach(a=>{a.dispatchBasic()})})})},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,r])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),r.forEach(s=>{s.dispatchAfter("autoplay")})})},this.onUserEvent=({eventName:i,target:r,reverse:s})=>{var n,o;if(!i||!r)return;let a=yh(i);a&&a==="Start"&&(r instanceof Zi||r.dispatchEvent({type:"beginEvent",eventName:"Start"}),(n=this.eventsPerObject.get(r))==null||n.forEach(l=>{l.dispatchUserEvent(s)}),(o=this.eventsAfterPerObject.get(r))==null||o.forEach(l=>{l.dispatchUserEvent(s)}))}}connect(){let{sharedAssets:e,page:t}=this.eventContext,i=r=>{var s,a,n,o,l;if((s=r.data)!=null&&s.events.length)for(let{id:h,data:c}of r.data.events){if(c.disabled||c.type!=="Start")continue;let d=new uK(h,c,r,t,e,this.eventManager);(d.actions.Transition.length||d.actions.Animation.length||d.actions.SwitchCamera.length||d.actions.Create.length||d.actions.Destroy.length||d.actions.SceneTransition.length||d.actions.Reset.length||d.actions.SetVariable.length||d.actions.DynamicVariablePlay.length||d.actions.ClearLocalStorage.length||d.actions.UserAPI.length)&&(this.eventsPerObject.has(r)?(a=this.eventsPerObject.get(r))==null||a.push(d):this.eventsPerObject.set(r,[d])),d.actions.Audio.length&&(this.eventsAfterPerObject.has(r)?(n=this.eventsAfterPerObject.get(r))==null||n.push(d):this.eventsAfterPerObject.set(r,[d])),d.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(r)?(o=this.eventsAfterPerObject.get(r))==null||o.push(d):this.eventsAfterPerObject.set(r,[d])),d.actions.Particles.length&&(this.eventsAfterPerObject.has(r)?(l=this.eventsAfterPerObject.get(r))==null||l.push(d):this.eventsAfterPerObject.set(r,[d]))}};if(t.traverseEntity(r=>{var s;(r instanceof p1||r instanceof Gi)&&((s=r.frame)==null||s.traverse(a=>{i(a)})),i(r)}),[...this.eventsAfterPerObject.values()].some(r=>r.length)){if(this.eventManager.activateCount===0){let{domElement:r,isExport:s}=this.eventContext,a=s?document:r;a.addEventListener("pointerdown",this.onMouseDown,{once:!0}),a.addEventListener("mousedown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),a.addEventListener("pointerdown",this.onAny),a.addEventListener("mousedown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([n,o])=>{n.addEventListener("userEvent",this.onUserEvent)})}else this.onSceneTransitionAudioVideoPlay();this.onPlay()}[...this.eventsPerObject.entries()].forEach(([r,s])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),s.forEach(a=>a.dispatch()),r.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if([...this.eventsAfterPerObject.values()].some(e=>e.length)){let{domElement:e,isExport:t}=this.eventContext,i=t?document:e;i.removeEventListener("pointerdown",this.onMouseDown),i.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),i.removeEventListener("pointerdown",this.onAny),i.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([r,s])=>{r.removeEventListener("userEvent",this.onUserEvent),s.forEach(a=>a.disconnect())})}[...this.eventsPerObject.entries()].forEach(([e,t])=>{e.removeEventListener("userEvent",this.onUserEvent),t.forEach(i=>i.disconnect())}),this.eventsPerObject.clear(),this.eventsAfterPerObject.clear()}},fK=class{constructor(e,t,i,r,s,a){this.id=e,this.data=t,this.object=i,this.initialDisabled=!1,this.actions=Ci(t,t.actions,r,s,a,i),this.target=t.target}disconnect(){Qi(this.actions)}dispatch(e){this.initialDisabled||(this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.actions.Transition.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.Animation.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch(e??!1)}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch()))}},mK=class extends x1{constructor(e,t,i,r,s){super(e),this.sharedVariables=t,this.eventManager=i,this.needsMouse=r,this.needsRaycast=s,this.dynamicVars=[],this.variablesToWatch=[],this.prevMouseProperty=null,this.prevRaycastProperty=null,this.pauseTime=0,this.isOutOfFocus=!1,this.events=[],this.onFrame=a=>{let n=this.eventContext.sharedAssets;if(this.rafId=window.requestAnimationFrame(this.onFrame),this.isOutOfFocus)return;let o=new Date,l=[],h=[];for(let u=0;u<this.propertiesToWatch.length;u++){let{objectId:p,property:f,prevValue:g}=this.propertiesToWatch[u],m=this.eventContext.scene.find(p),v=T3.propertyPaths[f];if(v[0]==="width"||v[0]==="height"||v[0]==="depth")m=m.geometry.userData.parameters[v[0]];else for(let y=0;y<v.length;y++)m=m[v[y]];g===null?this.propertiesToWatch[u].prevValue=m instanceof E?m.clone():m:(m instanceof E?!m.equals(g):g!==m)&&(h.push({objId:p,property:f}),m instanceof E?this.propertiesToWatch[u].prevValue.copy(m):this.propertiesToWatch[u].prevValue=m)}for(let u=0;u<this.variablesToWatch.length;u++){let{id:p,prevValue:f}=this.variablesToWatch[u],g=n.getVariable(p);g!==f&&(l.push(p),this.variablesToWatch[u].prevValue=g)}for(let u=0;u<this.dynamicVars.length;u++){let{id:p,expectedTime:f,last:g,data:m,timerSeconds:v,startValue:y}=this.dynamicVars[u],x=1e3;if((m.dynamicVariableType==="timer"||m.dynamicVariableType==="stopwatch")&&m.format==="number3decimal"?x=1:m.dynamicVariableType==="counter"?x=m.updateInterval:m.dynamicVariableType==="random"&&(x=m.isStatic?1/0:m.updateInterval),f===-1){this.dynamicVars[u].last=a,this.dynamicVars[u].expectedTime=a+x;continue}if(!((n.getDynamicVariablePlayState(p)==="Stopped"||n.getDynamicVariablePlayState(p)==="Restarted")&&(this.dynamicVars[u].last=a,this.dynamicVars[u].expectedTime=a+x,m.dynamicVariableType==="counter"&&n.getVariable(p)!==y&&(n.updateVariable(p,y),this.eventManager.requestRender()),(m.dynamicVariableType==="timer"||m.dynamicVariableType==="stopwatch")&&this.dynamicVars[u].timerSeconds!==y&&(this.dynamicVars[u].timerSeconds=y,n.updateVariable(p,sr.getFormattedTimerTime(y,m)),this.eventManager.requestRender()),n.getDynamicVariablePlayState(p)==="Restarted"&&n.setDynamicVariablePlayState(p,"Playing"),n.getDynamicVariablePlayState(p)==="Stopped"))){if(n.getDynamicVariablePlayState(p)==="Paused"){this.dynamicVars[u].deltaToExpectedTime===void 0&&(this.dynamicVars[u].deltaToExpectedTime=Math.max(this.dynamicVars[u].expectedTime-a,0)),this.dynamicVars[u].last=a-(x-this.dynamicVars[u].deltaToExpectedTime),this.dynamicVars[u].expectedTime=a+this.dynamicVars[u].deltaToExpectedTime;continue}else this.dynamicVars[u].deltaToExpectedTime=void 0;if(a>=f)if(this.dynamicVars[u].last=a,this.dynamicVars[u].expectedTime+=x,m.dynamicVariableType==="random"){let w=m.min+Math.random()*(m.max-m.min),_=m.decimals;w=Math.round(w*Math.pow(10,_))/Math.pow(10,_),n.updateVariable(p,w),l.push(p),this.eventManager.requestRender()}else if(m.dynamicVariableType==="counter"){let w=n.getVariable(p),_=n.getDynamicVariableToggleIsForward(p)??!0,b=n.getVariable(p)+m.increment*(_?1:-1);m.hasEnd&&(b=m.increment>0?Oe.clamp(b,y,m.endValue):Oe.clamp(b,m.endValue,y),b===y&&n.setDynamicVariableToggleIsForward(p,void 0),m.repeat?b===m.endValue&&(b=y):(b===y||b===m.endValue)&&n.setDynamicVariablePlayState(p,"Paused")),b!==w&&(l.push(p),n.updateVariable(p,b),this.eventManager.requestRender())}else if(m.dynamicVariableType==="time"){let w=n.getVariable(p),_=Yg(o,m);if(typeof w=="object"&&"textValue"in w&&typeof _=="object"&&"textValue"in _){if(Array.isArray(w.textValue)&&Array.isArray(_.textValue)){if(w.textValue.every((b,A)=>b===_.textValue[A]))continue}else if(w.textValue===_.textValue)continue}else if(w===_)continue;n.updateVariable(p,_),l.push(p),this.eventManager.requestRender()}else{let w=n1.isTextValue(m.endValue)?z7(m.endValue.textValue):m.endValue,_=n.getDynamicVariableToggleIsForward(p)??!0,b=v+(a-g)/1e3*(m.dynamicVariableType==="timer"?-1:1)*(_?1:-1);b=Math.max(b,0),m.hasEnd&&(b=m.dynamicVariableType==="stopwatch"?Oe.clamp(b,y,w):Oe.clamp(b,w,y),b===y&&n.setDynamicVariableToggleIsForward(p,void 0),m.repeat?Math.abs(b-w)<(m.format==="number3decimal"?1e-4:.1)&&(b=y):(Math.abs(b-y)<(m.format==="number3decimal"?1e-4:.1)||Math.abs(b-w)<(m.format==="number3decimal"?1e-4:.1))&&n.setDynamicVariablePlayState(p,"Paused")),b!==v&&(l.push(p),this.dynamicVars[u].timerSeconds=b,n.updateVariable(p,sr.getFormattedTimerTime(b,m)),this.eventManager.requestRender())}}}let c=!1;n.mouseProperty!==this.prevMouseProperty&&(this.prevMouseProperty=n.mouseProperty,c=!0);let d=!1;n.raycastProperty!==this.prevRaycastProperty&&(this.prevRaycastProperty=n.raycastProperty,d=!0),this.events.forEach(u=>{(l.includes(u.data.variableId)||h.find(p=>p.objId===u.data.objectId&&p.property===u.data.property)||u.data.variableId==="mouseProperty"&&c||u.data.variableId==="raycastProperty"&&d)&&(u.dispatch(),this.eventManager.requestRender())})},this.onBlur=()=>{this.pause()},this.onFocus=()=>{this.resume()}}pause(){this.isOutOfFocus||(this.isOutOfFocus=!0,this.pauseTime=Date.now())}resume(){if(!this.isOutOfFocus)return;this.isOutOfFocus=!1;let e=Date.now()-this.pauseTime;for(let t=0;t<this.dynamicVars.length;t++)this.dynamicVars[t].last+=e,this.dynamicVars[t].expectedTime+=e}connect(){this.eventContext.page.traverseEntity(t=>{var i;(i=t.data)==null||i.events.filter(r=>r.data.type==="VariableChange"&&!r.data.disabled).forEach(r=>{this.events.push(new gK(r.id,r.data,t,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),this.propertiesToWatch=this.events.filter(t=>t.data.variableId==="objectProperty"&&t.data.objectId!==null).map(t=>({objectId:t.data.objectId,property:t.data.property,prevValue:null}));let e=this.eventContext.sharedAssets;this.sharedVariables.forEach(({id:t,data:i})=>{if(!("dynamicVariableType"in i)){this.events.find(s=>s.data.variableId===t)&&this.variablesToWatch.push({id:t,prevValue:e.getVariable(t)});return}let r;if(i.dynamicVariableType==="timer"||i.dynamicVariableType==="stopwatch"){let s;if(n1.isTextValue(i.value)&&Array.isArray(i.value.textValue)){let a=i.value.textValue;a.length===3?s=a[2]+a[1]*60+a[0]*3600:s=a[1]+a[0]*60}else s=i.value;r=s,this.dynamicVars.push({id:t,last:-1,expectedTime:-1,data:i,timerSeconds:s,startValue:r})}else i.dynamicVariableType==="time"&&e.updateVariable(t,Yg(new Date,i)),i.dynamicVariableType==="counter"&&(r=n1.isTextValue(i.value)?z7(i.value.textValue):i.value),this.dynamicVars.push({id:t,last:-1,expectedTime:-1,data:i,startValue:r})}),this.rafId=window.requestAnimationFrame(this.onFrame),window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus)}disconnect(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),this.rafId&&(window.cancelAnimationFrame(this.rafId),this.rafId=void 0),this.events.forEach(e=>e.dispose())}},gK=class{constructor(e,t,i,r,s,a){this.id=e,this.data=t,this.object=i,this.actions=Ci(t,t.actions,r,s,a,i)}dispatch(){let e=this.actions;e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}dispose(){Qi(this.actions)}};function z7(e){return e.length===3?e[2]+e[1]*60+e[0]*3600:e[1]+e[0]*60}var vK="https://unpkg.com/@splinetool/runtime@1.9.37/build/",yK="https://unpkg.com/@splinetool/navmesh-wasm@1.9.37/build/",xK=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import('${vK}' + 'navmesh.js'),
		fetch('${yK}' + 'navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,bK=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import(self.location.origin + '/_libraries/navmesh.js'),
		fetch(self.location.origin + '/_libraries/navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,wK=`

onmessage = function(messageEvent) {
	const meshData = messageEvent.data;
	const positions = meshData[0];
	const offset = meshData[1];
	const indices = meshData[2];
	const indicesLength = meshData[3];
	const parameters = meshData[4];

	const module = self.module;
	const rc = new module.rcConfig();
	rc.cs = parameters.cs;
	rc.ch = parameters.ch;
	rc.borderSize = parameters.borderSize ? parameters.borderSize : 0;
	rc.tileSize = parameters.tileSize ? parameters.tileSize : 0;
	rc.walkableSlopeAngle = parameters.walkableSlopeAngle;
	rc.walkableHeight = parameters.walkableHeight;
	rc.walkableClimb = parameters.walkableClimb;
	rc.walkableRadius = parameters.walkableRadius;
	rc.maxEdgeLen = parameters.maxEdgeLen;
	rc.maxSimplificationError = parameters.maxSimplificationError;
	rc.minRegionArea = parameters.minRegionArea;
	rc.mergeRegionArea = parameters.mergeRegionArea;
	rc.maxVertsPerPoly = parameters.maxVertsPerPoly;
	rc.detailSampleDist = parameters.detailSampleDist;
	rc.detailSampleMaxError = parameters.detailSampleMaxError;

	if (!self.navMesh) {
		self.navMesh = new module.NavMesh();
	}
	self.navMesh.build(positions, offset, indices, indicesLength, rc);

	const navmeshData = navMesh.getNavmeshData();
	const arrView = new Uint8Array(module.HEAPU8.buffer, navmeshData.dataPointer, navmeshData.size);
	const ret = new Uint8Array(navmeshData.size);
	ret.set(arrView);
	navMesh.freeNavmeshData(navmeshData);

	postMessage(ret);
}
`,SK=.001,_K={cs:6,ch:2,walkableSlopeAngle:90,walkableHeight:20,walkableClimb:5,walkableRadius:0,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1},Zw,_t,$i;wk.then(e=>{Zw=e,_t=new e.Vec3,$i=new e.Vec3});var AK=new E,MK=class{constructor(e=!1,t=!1){this.usePhysics=e,this.isExport=t,this.onPointerDown=i=>{if(it.length!==1)return;let{raycaster:r,page:s}=this.eventContext;this.eventContext.updateRaycaster(i);let a=s.raycastWithClones(r);if(a.length!==0){if(this.gameControl){let n=AK.copy(this.gameControl.colliderWorldPosition);n.y-=this.gameControl.colliderHeight/2,this.gameControl.path=this.computePath(n,a[0].point)}this.eventContext.requestRender()}},this.traverseWithPhysics=(i,r)=>s=>{var u,p,f,g,m,v,y;let a;if(s instanceof Pr)if(s.objectForSample){if(s.objectForSample.dataPatched.physics.fusedBody)return;a=s.object}else return s.object.dataPatched.physics.fusedBody===!0&&s.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(s instanceof m1)a=s.object;else if(a=s,((u=a.dataPatched.cloner)==null?void 0:u.disabled)===!1&&((p=a.dataPatched.cloner)==null?void 0:p.hideBase)&&((f=a.dataPatched.physics)==null?void 0:f.fusedBody)!==!0)return!0;if(r&&!a.userData.navmesh)return;let n=a.dataPatched;if(!n.visible&&((g=n.physics)==null?void 0:g.enabled)!==!0)return!0;s.updateMatrixWorldSVD();let o=dd(n),l=a.userData.hasDestroy,h=a.userData.hasDrag,c=!1,d=!1;for(let x of n.events)x.data.disabled!==!0&&(x.data.type==="GameControl"?c=!0:x.data.type==="Follow"&&(d=!0));if(c||o||d||l||h)return!0;if(this.usePhysics&&((m=n.physics)==null?void 0:m.rigidBody)==="dynamic"){if(this.usePhysics&&((v=n.physics)!=null&&v.fusedBody))return!0}else if("geometry"in s&&s.geometry&&i.push(Us(s.geometry,s.matrixWorld)),this.usePhysics&&((y=n.physics)==null?void 0:y.fusedBody))return s.traverseObject((x,w)=>{var A,S;if(w===0)return;let _;if(x instanceof Pr)if(x.objectForSample){if(x.objectForSample.dataPatched.physics.fusedBody)return;_=x.object}else return x.object.dataPatched.physics.fusedBody===!0&&x.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(x instanceof m1)_=x.object;else if(_=x,(A=x.dataPatched.cloner)==null?void 0:A.hideBase)return!0;let b=_.dataPatched;if(!b.visible&&((S=b.physics)==null?void 0:S.enabled)!==!0)return!0;"geometry"in x&&x.geometry&&i.push(Us(x.geometry,x.matrixWorld))}),!0},this.traverseNoPhysics=(i,r)=>s=>{let a;if(s instanceof Pr)return;s instanceof m1?a=s.object:a=s;let n=a.dataPatched;if(n.physics.enabled==="visibility"?!n.visible:!n.physics.enabled)return!0;if(r&&!a.userData.navmesh)return;let o=s.geometry,l=a.userData.hasDestroy===!0,h=a.userData.hasDrag===!0;if(dd(n)||l||h||a.dataPatched.events.some(c=>c.data.disabled!==!0&&c.data.type==="GameControl"))return!0;o&&i.push(Us(o,s.matrixWorld))},this.navmeshWasm=Zw,this.navMesh=new this.navmeshWasm.NavMesh,this._workerURL=URL.createObjectURL(new Blob([(t?xK:bK)+wK])),this._worker=new Worker(this._workerURL)}init(e,t,i){this.gameControl=t,this.eventContext=i,this.setDefaultQueryExtent(new E().setScalar(e.ch*e.walkableRadius*1.2)),this._worker.onmessage=()=>{this.createNavMesh(i.page,e,r=>{this.buildFromNavmeshData(r.data)})},this.eventContext.renderer.domElement.addEventListener("pointerdown",this.onPointerDown)}createNavMesh(e,t,i){t.objects.forEach(l=>{var c;let h=e.scene.find(l);h.traverseEntity(d=>{d.userData.navmesh=!0}),(c=h.cloner)==null||c.traverseObject(d=>{d.userData.navmesh=!0})});let r=[],s=(this.usePhysics?this.traverseWithPhysics:this.traverseNoPhysics)(r,t.zones==="custom");if(e.traverseChildren(s),t.objects.forEach(l=>{var c;let h=e.scene.find(l);h.traverseEntity(d=>{d.userData.navmesh=void 0}),(c=h.cloner)==null||c.traverseObject(d=>{d.userData.navmesh=void 0})}),r.length===0)return!1;let a=An(r),{positions:n,triIndices:o}=Od(a.getAttribute("position"),a.getIndex());return this._worker.postMessage([n,n.length/3,o,o.length,{..._K,...t}]),this._worker.onmessage=i,!0}createDebugNavGeometry(){let e,t,i=this.navMesh.getDebugNavMesh(),r=i.getTriangleCount(),s=new Uint32Array(r*3),a=new Float32Array(r*3*3);for(e=0;e<r*3;e++)s[e]=e;for(e=0;e<r;e++)for(t=0;t<3;t++){let o=i.getTriangle(e).getPoint(t);a[e*9+t*3+0]=o.x,a[e*9+t*3+1]=o.y,a[e*9+t*3+2]=o.z}let n=new Ge;return n.setIndex(new ot(s,1)),n.setAttribute("position",new ot(a,3)),n}getClosestPoint(e){return _t.x=e.x,_t.y=e.y,_t.z=e.z,this.navMesh.getClosestPoint(_t)}getClosestPointToRef(e,t){_t.x=e.x,_t.y=e.y,_t.z=e.z;let i=this.navMesh.getClosestPoint(_t);t.set(i.x,i.y,i.z)}getRandomPointAround(e,t){return _t.x=e.x,_t.y=e.y,_t.z=e.z,this.navMesh.getRandomPointAround(_t,t)}getRandomPointAroundToRef(e,t,i){_t.x=e.x,_t.y=e.y,_t.z=e.z;let r=this.navMesh.getRandomPointAround(_t,t);i.set(r.x,r.y,r.z)}moveAlong(e,t){return _t.x=e.x,_t.y=e.y,_t.z=e.z,$i.x=t.x,$i.y=t.y,$i.z=t.z,this.navMesh.moveAlong(_t,$i)}moveAlongToRef(e,t,i){return _t.x=e.x,_t.y=e.y,_t.z=e.z,$i.x=t.x,$i.y=t.y,$i.z=t.z,this.navMesh.moveAlong(_t,$i)}computePath(e,t){let i=this.getClosestPoint(t);if($i.x=i.x,$i.y=i.y,$i.z=i.z,Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)+Math.pow(t.z-i.z,2))>this.getDefaultQueryExtent().y)return[];this.getClosestPoint(e);let r=this.navMesh.computePath(_t,$i),s=r.getPointCount(),a=[];for(let n=0;n<s;n++){let o=r.getPoint(n);a.push(new E(o.x,o.y,o.z))}return a}createCrowd(e,t){return new EK(this,e,t)}setDefaultQueryExtent(e){_t.x=e.x,_t.y=e.y,_t.z=e.z,this.navMesh.setDefaultQueryExtent(_t)}getDefaultQueryExtent(){return this.navMesh.getDefaultQueryExtent()}buildFromNavmeshData(e){let t=e.length*e.BYTES_PER_ELEMENT,i=this.navmeshWasm._malloc(t),r=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,i,t);r.set(e);let s=new this.navmeshWasm.NavmeshData;s.dataPointer=r.byteOffset,s.size=e.length,this.navMesh.buildFromNavmeshData(s),this.navmeshWasm._free(r.byteOffset)}getNavmeshData(){let e=this.navMesh.getNavmeshData(),t=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,e.dataPointer,e.size),i=new Uint8Array(e.size);return i.set(t),this.navMesh.freeNavmeshData(e),i}getDefaultQueryExtentToRef(e){let t=this.navMesh.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}dispose(){var e;this.navMesh.destroy(),this._worker.terminate(),URL.revokeObjectURL(this._workerURL),(e=this.eventContext)==null||e.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown)}addCylinderObstacle(e,t,i){return _t.x=e.x,_t.y=e.y,_t.z=e.z,this.navMesh.addCylinderObstacle(_t,t,i)}addBoxObstacle(e,t,i){return _t.x=e.x,_t.y=e.y,_t.z=e.z,$i.x=t.x,$i.y=t.y,$i.z=t.z,this.navMesh.addBoxObstacle(_t,$i,i)}removeObstacle(e){this.navMesh.removeObstacle(e)}isSupported(){return this.navmeshWasm!==void 0}},EK=class{constructor(e,t,i){this.navmeshWasmWrapper=e,this.transforms=[],this.agents=new Array,this.reachRadii=new Array,this._agentDestinationArmed=new Array,this._agentDestination=new Array,this.crowd=new this.navmeshWasmWrapper.navmeshWasm.Crowd(t,i,this.navmeshWasmWrapper.navMesh.getNavMesh())}onReachTarget(e,t){}addAgent(e,t,i){let r=new this.navmeshWasmWrapper.navmeshWasm.dtCrowdAgentParams;r.radius=t.radius,r.height=t.height,r.maxAcceleration=t.maxAcceleration,r.maxSpeed=t.maxSpeed,r.collisionQueryRange=t.collisionQueryRange,r.pathOptimizationRange=t.pathOptimizationRange,r.separationWeight=t.separationWeight,r.updateFlags=7,r.obstacleAvoidanceType=0,r.queryFilterType=0,r.userData=0;let s=this.crowd.addAgent(new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z),r);return this.transforms.push(i),this.agents.push(s),this.reachRadii.push(t.reachRadius?t.reachRadius:t.radius),this._agentDestinationArmed.push(!1),this._agentDestination.push(new E(0,0,0)),s}getAgentPosition(e){return this.crowd.getAgentPosition(e)}getAgentPositionToRef(e,t){let i=this.crowd.getAgentPosition(e);t.set(i.x,i.y,i.z)}getAgentVelocity(e){return this.crowd.getAgentVelocity(e)}getAgentVelocityToRef(e,t){let i=this.crowd.getAgentVelocity(e);t.set(i.x,i.y,i.z)}getAgentNextTargetPath(e){return this.crowd.getAgentNextTargetPath(e)}getAgentNextTargetPathToRef(e,t){let i=this.crowd.getAgentNextTargetPath(e);t.set(i.x,i.y,i.z)}getAgentState(e){return this.crowd.getAgentState(e)}overOffmeshConnection(e){return this.crowd.overOffmeshConnection(e)}agentGoto(e,t){this.crowd.agentGoto(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z));let i=this.agents.indexOf(e);i>-1&&(this._agentDestinationArmed[i]=!0,this._agentDestination[i].set(t.x,t.y,t.z))}agentTeleport(e,t){this.crowd.agentTeleport(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z))}updateAgentParameters(e,t){let i=this.crowd.getAgentParameters(e);t.radius!==void 0&&(i.radius=t.radius),t.height!==void 0&&(i.height=t.height),t.maxAcceleration!==void 0&&(i.maxAcceleration=t.maxAcceleration),t.maxSpeed!==void 0&&(i.maxSpeed=t.maxSpeed),t.collisionQueryRange!==void 0&&(i.collisionQueryRange=t.collisionQueryRange),t.pathOptimizationRange!==void 0&&(i.pathOptimizationRange=t.pathOptimizationRange),t.separationWeight!==void 0&&(i.separationWeight=t.separationWeight),this.crowd.setAgentParameters(e,i)}removeAgent(e){this.crowd.removeAgent(e);let t=this.agents.indexOf(e);t>-1&&(this.agents.splice(t,1),this.transforms.splice(t,1),this.reachRadii.splice(t,1),this._agentDestinationArmed.splice(t,1),this._agentDestination.splice(t,1))}getAgents(){return this.agents}update(e){if(this.navmeshWasmWrapper.navMesh.update(),e<=SK)return;let t=1/60,i=10;{let r=Math.floor(e/t);r>i&&(r=i),r<1&&(r=1);let s=e/r;for(let a=0;a<r;a++)this.crowd.update(s)}for(let r=0;r<this.agents.length;r++){let s=this.agents[r],a=this.getAgentPosition(s);if(this.transforms[r].copy(a),this._agentDestinationArmed[r]){let n=a.x-this._agentDestination[r].x,o=a.z-this._agentDestination[r].z,l=this.reachRadii[r],h=this._agentDestination[r].y-this.reachRadii[r],c=this._agentDestination[r].y+this.reachRadii[r],d=n*n+o*o;a.y>h&&a.y<c&&d<l*l&&(this.onReachTarget(s,this._agentDestination[r]),this._agentDestinationArmed[r]=!1)}}}setDefaultQueryExtent(e){let t=new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z);this.crowd.setDefaultQueryExtent(t)}getDefaultQueryExtent(){return this.crowd.getDefaultQueryExtent()}getDefaultQueryExtentToRef(e){let t=this.crowd.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}getCorners(e){let t,i=this.crowd.getCorners(e),r=i.getPointCount(),s=[];for(t=0;t<r;t++){let a=i.getPoint(t);s.push(new E(a.x,a.y,a.z))}return s}dispose(){this.crowd.destroy()}};function CK(e){let t=!1;return e.scene.objects.forEach(i=>{i.data.type==="Page"&&!t&&i.data.publish.gameControlObject&&q2.traverseModuleInstances(e,i.id,(r,s,a)=>{for(let n of a)n.data.type==="GameControl"&&n.data.navmesh.enabled&&(t=!0)})}),t}var TK={type:"change"},F7={type:"changeZoom"},PK={type:"changePan"},an={type:"start"},nn={type:"end",changed:!0},DK={type:"end",changed:!1},jp=new lt,k7=new j,IK=2*Math.PI,OK=1e-8,RK=.01,Gp=new E,V0=new j,Hp=new E,j0=new lt,U7=new we,LK={type:"requestRender"},Kw=class extends l1{constructor(e,t,i={isPlayMode:!1,isExport:!1}){super(),this.object=e,this.domElement=t,this.options=i,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,Q1.DOLLY_ROTATE,Q1.PAN],this.offset=new E,this.eye=new E,this.lastPosition=new E,this.lastQuaternion=new lt,this.current=new j,this.overShoot=new j,this.overRatio=new j,this.spherical=new c6,this.sphericalDelta=new c6,this.panOffset=new E,this.panLeftV=new E,this.panUpV=new E,this.panV=new E,this.rotateStart=new j,this.rotateEnd=new j,this.rotateDelta=new j,this.panStart=new j,this.panEnd=new j,this.panDelta=new j,this.dollyStart=new j,this.dollyEnd=new j,this.dollyDelta=new j,this.rotationRangeFactor=new j,this.panRangeFactor=new j,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.hoverRotateDamping=this.dampingFactor,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=r=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=r.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(Hp,j0,Gp),this.offset.copy(Hp).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&this.state===-1&&this.rotateLeft((this.autoRotateClockwise===!0?1:-1)*this.getAutoRotationAngle()),this.rotationLimitsMode!==0&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),this.rotationLimitsMode!==2&&(this.spherical.phi+=this.sphericalDelta.phi),(this.rotationLimitsMode!==1||this.autoRotate===!0)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&this.object.isPerspectiveCamera&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),this.panLimitsMode!==0&&(this.target.applyQuaternion(jp.copy(j0).invert()),this.panOffset.applyQuaternion(jp),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(j0),this.panOffset.applyQuaternion(j0)),this.panLimitsMode===2&&(this.panOffset.y=0),this.panLimitsMode===1&&(this.panOffset.x=0),this.state===-1&&!this.gesture?(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)):(this.target.add(this.panOffset),this.panOffset.set(0,0,0)),this.offset.setFromSpherical(this.spherical),Hp.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&(U7.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4(U7));let r=this.spherical.phi%IK;if(this.eye.copy(this.offset).normalize(),this.object.up.copy(kt.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),r>0&&r>Math.PI||r<0&&r>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),this.state===-1||this.enableDamping===!0){let s=this.hoverRotatePanMode===1?this.hoverRotateDamping:this.dampingFactor;this.sphericalDelta.theta*=1-s,this.sphericalDelta.phi*=1-s}else this.sphericalDelta.set(0,0,0);return this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>RK||8*(1-this.lastQuaternion.dot(this.object.quaternion))>OK?(this.dispatchEvent(TK),this.object.dispatchEvent(LK),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)},this.onPointerDown=r=>{this.enabled!==!1&&(r.pointerType==="touch"||r.pointerType==="pen"&&q1?this.onPointerDownTouch(r):this.onPointerDownMouse(r),this.state!==-1&&(this.isPointerDown=!0,this.dispatchEvent(an),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),r.stopPropagation(),r.pointerType==="touch"||r.pointerType==="pen"&&q1||this.domElement.setPointerCapture(r.pointerId)))},this.onPointerLeave=r=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(this.hoverRotatePanMode===1?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,Gp.subVectors(this.position0,this.target0),this.spherical.setFromVector3(Gp),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):this.hoverRotatePanMode===2&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=r},this.onPointerEnter=r=>{this.resetHoverEffectOnPointerLeave||this.pointerLeaveEvent===void 0?V0.set(r.clientX-this.domElement.clientWidth/2,r.clientY-this.domElement.clientHeight/2):V0.set(r.clientX-this.pointerLeaveEvent.clientX,r.clientY-this.pointerLeaveEvent.clientY),this.hoverRotatePanMode===1?(this.rotateDelta.copy(V0).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(k7,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(r.clientX,r.clientY)):this.hoverRotatePanMode===2&&(this.panDelta.copy(V0).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(r.clientX,r.clientY)),this.update()},this.onPointerMove=r=>{this.enabled!==!1&&(this.checkRaycastLock()||(r.pointerType==="touch"||r.pointerType==="pen"&&q1?this.onPointerMoveTouch(r):this.onPointerMoveMouse(r),r.stopPropagation()))},this.onPointerUp=r=>{this.isPointerDown=!1,it.length===0&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),it.length>1&&r.preventDefault(),this.hasChange?this.dispatchEvent(nn):this.dispatchEvent(DK),this.state=-1,r&&(r.stopPropagation(),r.pointerType==="touch"||r.pointerType==="pen"&&q1||this.domElement.releasePointerCapture(r.pointerId))},this.onPointerDownMouse=r=>{let s;switch(this.useKeyEvents?s=this.mouseButtons[r.button]:s=this.mouseButtonsPlay[r.button],s){case 0:if(r.altKey===!0&&!r.shiftKey&&!$h(r)){if(this.enableRotate===!1)return;this.handleMouseDownRotate(r),this.state=0}else if(this.key===" "){if(this.enablePan===!1)return;this.handleMouseDownPan(r),this.state=2}break;case 4:if(this.enablePan===!1)return;this.handleMouseDownPan(r),this.state=2;break;case 3:if($h(r)||r.shiftKey){if(this.enablePan===!1)return;this.handleMouseDownPan(r),this.state=2}else{if(this.enableRotate===!1)return;this.handleMouseDownRotate(r),this.state=0}break;case 5:if($h(r)||r.shiftKey){if(this.enableRotate===!1)return;this.handleMouseDownRotate(r),this.state=0}else{if(this.enablePan===!1)return;this.handleMouseDownPan(r),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=r=>{switch(this.state){case 0:if(this.enableRotate===!1)return;this.handleMouseMoveRotate(r);break;case 1:if(this.enableZoom===!1)return;this.handleMouseMoveDolly(r);break;case 2:if(this.enablePan===!1)return;this.handleMouseMovePan(r);break}this.object.wasMovedByUser=!0},this.onPointerDownTouch=r=>{switch(it.length>1&&r.preventDefault(),this.touches[it.length-1]){case Q1.ROTATE:if(this.enableRotate===!1){this.state=-1;return}this.handleTouchStartRotate(),this.state=3;break;case Q1.PAN:if(this.enablePan===!1){this.state=-1;return}this.handleTouchStartPan(),this.state=4;break;case Q1.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchStartDollyPan(),this.state=5;break;case Q1.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=r=>{switch(it.length>1&&r.preventDefault(),this.state){case 3:if(this.enableRotate===!1)return;this.handleTouchMoveRotate(r),this.update();break;case 4:if(this.enablePan===!1)return;this.handleTouchMovePan(r),this.update();break;case 5:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchMoveDollyPan(r),this.update();break;case 6:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchMoveDollyRotate(r),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=V2(()=>this.dispatchEvent(nn),33),this.onMouseWheel=r=>{this.enabled===!1||this.enableZoom===!1&&this.enablePan===!1||this.checkRaycastLock()||(!this.options.isExport&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&r.preventDefault(),this.dispatchEvent(an),this.handleMouseWheel(r),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=r=>{if(r.preventDefault(),this.enabled!==!1&&!this.checkRaycastLock()&&!ch)if(r.type==="gesturechange"){if(this.enableZoom===!1||this.isTouchZoom===!1)return;this.dispatchEvent(an),r.scale>this.prevScale?this.dollyIn(this.getZoomScale()):r.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=r.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(nn)},this.onContextMenu=r=>{r.preventDefault()},this.onTouchEnd=r=>{r.preventDefault()},this.onKeyDown=r=>{this.enabled!==!1&&(this.key=r.key,r.key===" "&&this.dispatchEvent(an))},this.onKeyUp=r=>{this.enabled!==!1&&(this.key=void 0,this.state!==-1&&r.key==="Alt"&&this.onPointerUp(it[0]),r.key===" "&&this.dispatchEvent(nn))},this.onPointerHover=r=>{r.pointerType!=="mouse"||this.enabled===!1||this.state!==-1||this.hoverRotatePanMode===2&&this.isPanOverShoot||this.hoverRotatePanMode===1&&this.isRotateOverShoot||(this.isPointerDown=!0,this.hoverRotatePanMode===2?this.handleMouseMovePan(r,this.hoverRotatePanStrength):this.hoverRotatePanMode===1&&this.handleMouseMoveRotate(r,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=r=>{r.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.initialSphericalRadius=this.spherical.radius,this.addEventListenersToCamera()}dispatchEvent(e){e.type==="start"?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(e)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}updateUseWindowEvents(e){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=e,this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let t=this.useWindowEvents?window:this.domElement;t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(e,t){this.setEnableDampingSpeed(e.enableDamping),this.enablePan=e.enablePan,this.enableZoom=e.enableZoom,this.enableRotate=e.enableRotate,this.rotationLimitsMode=e.rotationLimitsMode,this.thetaIsFree=e.rotationHorizontalOffset.min===e.rotationHorizontalOffset.max&&e.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=e.rotationVerticalOffset.min===e.rotationVerticalOffset.max&&e.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=e.panLimitsMode,this.panSoftLimit=e.panSoftLimit,this.rotationSoftLimit=e.rotationSoftLimit,this.hoverRotatePanMode=e.hoverRotatePanMode,this.hoverRotateDamping=e.hoverRotateDamping??this.dampingFactor,this.useWindowEvents=t==="window",this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let i=e.hoverRotatePanStrength/100;this.hoverRotatePanStrength=i**2,this.zoomLimitsEnabled=e.zoomLimitsEnabled,this.minZoom=e.zoomLimits.min,this.maxZoom=Math.max(e.zoomLimits.min,e.zoomLimits.max),this.minDistance=1e3/e.zoomLimits.max,this.maxDistance=Math.max(this.minDistance,1e3/e.zoomLimits.min),this.autoRotate=e.autoRotate,this.autoRotateSpeed=e.autoRotateSpeed,this.autoRotateClockwise=e.autoRotateClockwise;let r=this.object.getTarget().applyQuaternion(jp.copy(this.object.quaternion).invert());this.minV=-e.panVerticalOffset.min+r.y,this.maxV=e.panVerticalOffset.max+r.y,this.minH=-e.panHorizontalOffset.min+r.x,this.maxH=e.panHorizontalOffset.max+r.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=Zr(this.spherical.phi-e.rotationVerticalOffset.min),this.maxPhi=Zr(this.spherical.phi+e.rotationVerticalOffset.max),this.minTheta=Zr(Zr(this.spherical.theta)-e.rotationHorizontalOffset.min),this.maxTheta=Zr(Zr(this.spherical.theta)+e.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,e.orbitTouches===1&&(this.touches[0]=Q1.ROTATE),e.panTouches===1&&(this.touches[0]=Q1.PAN),e.orbitTouches===2&&(this.touches[1]=Q1.DOLLY_ROTATE),e.panTouches===2&&(this.touches[1]=Q1.DOLLY_PAN),e.orbitTouches===3&&(this.touches[2]=Q1.ROTATE),e.panTouches===3&&(this.touches[2]=Q1.PAN),this.isTouchZoom=e.isTouchZoom,this.resetHoverEffectOnPointerLeave=e.resetHoverEffectOnPointerLeave??!1}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture),this.domElement.addEventListener("touchend",this.onTouchEnd),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(e,t,i,r,s,a,n,o){this.overShoot.set(0,0);let l,h,c;e instanceof E?(l=e.x,h=e.y,this.current.set(this.target.x,this.target.y),c=!0):(l=e.theta,h=e.phi,this.current.set(Zr(this.spherical.theta),Zr(this.spherical.phi)),c=!1),i===0&&(this.current.x+=l,this.current.y+=h),(t===3||t===2)&&(!c&&this.isThetaFlipped?this.current.x>r&&this.current.x<0?this.overShoot.x=r-this.current.x:this.current.x<s&&this.current.x>0&&(this.overShoot.x=s-this.current.x):this.current.x>r?this.overShoot.x=r-this.current.x:this.current.x<s&&(this.overShoot.x=s-this.current.x)),(t===3||t===1)&&(this.current.y>a?this.overShoot.y=a-this.current.y:this.current.y<n&&(this.overShoot.y=n-this.current.y)),c||(this.overShoot.x=Zr(this.overShoot.x),this.overShoot.y=Zr(this.overShoot.y)),i!==0?(this.overRatio.copy(this.overShoot).divide(o),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),i===1&&(this.overRatio.x=N7(Math.abs(this.overRatio.x)),this.overRatio.y=N7(Math.abs(this.overRatio.y))),this.isPointerDown||i===1?i===2&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(l*this.overShoot.x<0&&!this.thetaIsFree&&(l*=1-this.overRatio.x),h*this.overShoot.y<0&&!this.phiIsFree&&(h*=1-this.overRatio.y)):i===2&&(!c&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||c&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(l=this.overShoot.x*.05),this.phiIsFree||(h=this.overShoot.y*.05),c?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):c?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,h+=this.overShoot.y),e instanceof E?(e.x=l,e.y=h):(this.thetaIsFree||(e.theta=l),this.phiIsFree||(e.phi=h))}setEnableDampingSpeed(e){this.enableDamping=e,this.rotateSpeed=e===!0?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(e){this.sphericalDelta.theta-=e}rotateUp(e){this.sphericalDelta.phi-=e}panLeft(e,t){this.panLeftV.setFromMatrixColumn(t,0),this.panLeftV.multiplyScalar(-e),this.panOffset.add(this.panLeftV)}panUp(e,t){this.panUpV.setFromMatrixColumn(t,1),this.panUpV.multiplyScalar(e),this.panOffset.add(this.panUpV)}pan(e,t){let i=this.domElement;if(i&&this.object.isPerspectiveCamera){let r=this.object.position;this.panV.copy(r).sub(this.target);let s=this.panV.length();s*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*e*s/i.clientHeight,this.object.matrixWorld),this.panUp(2*t*s/i.clientHeight,this.object.matrixWorld)}else i&&this.object.isOrthographicCamera&&(this.panLeft(e*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrixWorld),this.panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrixWorld));this.dispatchEvent(PK)}dollyOut(e){this.object.isPerspectiveCamera?this.scale/=e:this.object.isOrthographicCamera&&(this.object.zoom*=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(F7)}dollyIn(e){this.object.isPerspectiveCamera?this.scale*=e:this.object.isOrthographicCamera&&(this.object.zoom/=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(F7)}zoomOut(e=this.getZoomScale()){this.dispatchEvent(an),this.dollyOut(e),this.dispatchEvent(nn)}zoomIn(e=this.getZoomScale()){this.dispatchEvent(an),this.dollyIn(e),this.dispatchEvent(nn)}setZoom(e){if(this.dispatchEvent(an),this.object.isPerspectiveCamera){let t=this.initialSphericalRadius/e/this.spherical.radius;this.scale=t}else this.object.isOrthographicCamera&&(this.object.zoom=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0);this.dispatchEvent(nn)}handleMouseDownRotate(e){this.rotateStart.set(e.clientX,e.clientY)}handleMouseDownDolly(e){this.dollyStart.set(e.clientX,e.clientY)}handleMouseDownPan(e){this.panStart.set(e.clientX,e.clientY)}handleMouseMoveRotate(e,t=1){e.movementX!==void 0?this.rotateDelta.set(e.movementX,e.movementY):(this.rotateEnd.set(e.clientX,e.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*t).rotateAround(k7,-this.object.angleOffsetFromUp);let i=this.domElement,r=this.useWindowEvents?window.innerHeight:i.clientHeight,s=2*Math.PI*this.rotateDelta.x/r,a=2*Math.PI*this.rotateDelta.y/r;this.rotateLeft(s),this.rotateUp(a),this.update()}handleMouseMoveDolly(e){this.dollyEnd.set(e.clientX,e.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(e,t=1){e.movementX!==void 0?this.panDelta.set(e.movementX,e.movementY):(this.panEnd.set(e.clientX,e.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*t),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(e){if(mk===!1&&$h(e)===!1&&vk(e)===!0){if(this.enablePan===!1)return;this.gesture?(this.panDelta.set(-e.deltaX,-e.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),e.altKey?this.pan(0,this.panDelta.y):e.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.gesture=!1,this.isPointerDown=!1},30)}else{if(this.enableZoom===!1||this.gesture)return;e.deltaY===0?e.deltaX<0?this.dollyIn(this.getZoomScale()):e.deltaX>0&&this.dollyOut(this.getZoomScale()):e.deltaY<0?this.dollyIn(this.getZoomScale()):e.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(it.length===2){let e=.5*(it[0].pageX+it[1].pageX),t=.5*(it[0].pageY+it[1].pageY);this.rotateStart.set(e,t)}else this.rotateStart.set(it[0].pageX,it[0].pageY)}handleTouchStartPan(){if(it.length===2){let e=.5*(it[0].pageX+it[1].pageX),t=.5*(it[0].pageY+it[1].pageY);this.panStart.set(e,t)}else this.panStart.set(it[0].pageX,it[0].pageY)}handleTouchStartDolly(){let e=it[0].pageX-it[1].pageX,t=it[0].pageY-it[1].pageY,i=Math.sqrt(e*e+t*t);this.dollyStart.set(0,i)}handleTouchStartDollyPan(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(e){if(it.length===2){let i=Ou(e),r=.5*(e.pageX+i.x),s=.5*(e.pageY+i.y);this.rotateEnd.set(r,s)}else{if(e.pointerId!==it[0].pointerId)return;this.rotateEnd.set(e.pageX,e.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;t&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/t.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/t.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(e){if(it.length===2){let t=Ou(e),i=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this.panEnd.set(i,r)}else{if(e.pointerId!==it[0].pointerId)return;this.panEnd.set(e.pageX,e.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(e){let t=Ou(e),i=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(i*i+r*r);this.dollyEnd.set(0,s),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enablePan&&this.handleTouchMovePan(e)}handleTouchMoveDollyRotate(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enableRotate&&this.handleTouchMoveRotate(e)}checkRaycastLock(){var e;if(this.object.data.raycastLock){if(this.options.isPlayMode)return!1;{let t=(e=this.options)==null?void 0:e.showCameraLock;return t&&t(),!0}}else return!1}};function Zr(e){let t=Math.PI*2;for(;e<=-Math.PI;)e+=t;for(;e>Math.PI;)e-=t;return e}function N7(e){return 1-Math.pow(1-e,4)}var V7=class{constructor(e,t,i,r,s,a){this.id=e,this.data=t,this.object=i,this.page=r,this.currentIntersectedObjects=[],this.actions=Ci(t,t.actions,r,s,a,i),this.target=t.target,this.triggeringObjects=[];for(let n of t.triggeringObjects){let o=r.scene.find(n);o&&this.triggeringObjects.push(o)}}isValidTriggeringObject(e){return this.target==="all"?!0:this.triggeringObjects.some(t=>t===e||t.isAncestorOf(e.uuid)||e.isAncestorOf(t.uuid))}disconnect(){Qi(this.actions)}dispatch(){this.object.destroyedInAction||(this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Trigger"}),this.actions.Transition.forEach(e=>{e.data.runMode==="Toggle"?e.toggle():e.play()}),this.actions.SwitchCamera.forEach(e=>{e.data.runMode==="Toggle"?e.toggle():e.play()}),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch(!1)}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Particles.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch()))}},Ct;_k.then(e=>Ct=e);var bi=new E,_r=new lt,Sa=new E,Wp=new Ri(0,0,0,"YXZ"),j7=new Ri(0,0,0,"XYZ"),Ar=new E,qp=new E,Yp=new E(1,1,1),Eo=new lt,G0=new we,G7=new we,BK={type:"updateMatrix"},H7=new lt,Xp=new V1,Zf={type:"beginEvent",eventName:"Collision"},zK={type:"beginEvent",eventName:"Trigger"};function FK(e){if(q2.physicsEnabled(e.scene.objects))return!0;let t=!1;return e.scene.objects.traverse((i,r)=>{if(r.events){if(Array.isArray(r.events)){for(let s of r.events)if(s.data.disabled!==!0&&s.data.type==="GameControl"&&s.data.collisionEnabled){t=!0;break}}else for(let s of Object.values(r.events))if(s.disabled!==!0&&s.type==="GameControl"&&s.collisionEnabled){t=!0;break}}}),t}var dd=e=>e.states.some(t=>t.data.position!==void 0||t.data.rotation!==void 0||t.data.hiddenMatrix!==void 0||t.data.cloner!==void 0||t.data.pathSnapping!==void 0),kK=class{constructor(e){this.eventContext=e,this.isEnabled=!1,this.gameControl=null,this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],entityToCollisionEvents:{},colliderToEntity:new Map,triggers:[],gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.sensorToTriggerEvent={},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.isExport=!1,this.processRigidBody=t=>{if(t.bodyType()!==Ct.RigidBodyType.Dynamic)return;t.isSleeping()||this.nActiveRigidBodies++;let[i,r,s]=this.rigidBodyToMesh.get(t.handle);if(bi.copy(t.translation()).multiplyScalar(this.pixelsPerMeter),_r.copy(t.rotation()),i.matrixWorld.compose(bi,_r,r),i.hasNonUniformScale&&i.matrixWorld.multiply(i.shearScale),i.dispatchEvent(BK),s){let a=i.cloner;if(a&&a.objectForSample===void 0){a.matrixWorld.copy(i.matrixWorld);for(let n of a.children)n.updateMatrixWorld(!0)}for(let n of i.children)n.updateMatrixWorld(!0)}},this.accumulator=0,this.handleCollisionEvents=(t,i,r)=>{var n,o,l,h;if(r===!1)return;let s,a;if(this.sensorToTriggerEvent[t]?(s=this.sensorToTriggerEvent[t],a=this.sharedGameControlGlobals.colliderToEntity.get(i)):this.sensorToTriggerEvent[i]&&(s=this.sensorToTriggerEvent[i],a=this.sharedGameControlGlobals.colliderToEntity.get(t)),s&&a&&s.isValidTriggeringObject(a)){s.dispatch();return}for(let c=this.sharedGameControlGlobals.createdObjects.length-1;c>=0;c--){let d=this.sharedGameControlGlobals.createdObjects[c];if(d.userData.hasCollisionDestroy&&(((n=d.rigidBody)==null?void 0:n.collider(0).handle)===t||((o=d.rigidBody)==null?void 0:o.collider(0).handle)===i)){this.sharedGameControlGlobals.createdObjects.splice(c,1),d.removeFromParent(),requestAnimationFrame(()=>{var u;return(u=this.sharedGameControlGlobals.rapierWorld)==null?void 0:u.removeRigidBody(d.rigidBody)});break}}if(((l=this.gameControl)==null?void 0:l.object)!==void 0&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(t)){let c=this.sharedGameControlGlobals.colliderToEntity.get(i),d=this.sharedGameControlGlobals.entityToCollisionEvents[c.uuid];if(d===void 0)return;for(let u of d)u.data.target==="character"&&this.dispatchCollisionEvent(u,c,i)}else if(((h=this.gameControl)==null?void 0:h.object)!==void 0&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(i)){let c=this.sharedGameControlGlobals.colliderToEntity.get(t),d=this.sharedGameControlGlobals.entityToCollisionEvents[c.uuid];if(d===void 0)return;for(let u of d)u.data.target==="character"&&this.dispatchCollisionEvent(u,c,t)}else{let c=this.sharedGameControlGlobals.colliderToEntity.get(t),d=this.sharedGameControlGlobals.entityToCollisionEvents[c.uuid];if(d!==void 0)for(let f of d)f.data.target==="scene"&&this.dispatchCollisionEvent(f,c,t);let u=this.sharedGameControlGlobals.colliderToEntity.get(i),p=this.sharedGameControlGlobals.entityToCollisionEvents[u==null?void 0:u.uuid];if(p!==void 0)for(let f of p)f.data.target==="scene"&&this.dispatchCollisionEvent(f,u,i)}},this.isExport=e.isExport,this.sharedAssets=e.sharedAssets,this.renderer=e.renderer,this.requestRender=e.requestRender,this.domElement=this.renderer.domElement,this.pixelsPerMeter=jw,this.gravity=this.page.data.globalPhysics.gravity}get page(){return this.eventContext.page}attachVRControllers(e){e.forEach(t=>{t.addEventListener("connected",i=>{"gamepad"in i.data&&"axes"in i.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(i.data.gamepad)})})}markIsDestroyTarget(){this.page.traverseVisibleEntity(e=>{var i,r;let t=e.dataPatched;for(let s of t.events){if(s.data.disabled===!0)continue;let a=(r=(i=s.data.actions)==null?void 0:i.find(n=>n.data.type==="Destroy"))==null?void 0:r.data;if(a)for(let n of a.objects){let o=this.page.scene.find(n);o&&(o.userData.hasDestroy=!0)}}})}markIsDragObject(){this.page.traverseVisibleEntity(e=>{let t=e.dataPatched;for(let i of t.events)if(!(i.data.disabled===!0||i.data.type!=="DragDrop"))for(let r of i.data.objects){let s=this.page.scene.find(r);s&&(s.userData.hasDrag=!0)}})}initBVH(){let e=[];if(this.page.traverseChildren(t=>{var h,c;let i,r=t instanceof ec,s=t instanceof ic;if(t instanceof Pr||r||s)return;t instanceof m1?i=t.object:i=t;let a=i.dataPatched;if(((h=a.physics)==null?void 0:h.enabled)==="visibility"?!a.visible:!((c=a.physics)!=null&&c.enabled))return!0;let n=t.geometry,o=i.userData.hasDestroy===!0,l=i.userData.hasDrag===!0;if(dd(a)||o||l||i.dataPatched.events.some(d=>d.data.disabled!==!0&&(d.data.type==="GameControl"||d.data.type==="Follow")))return t.updateMatrixWorldSVD(),this.addBoundsTree(t),!0;n&&e.push(Us(n,t.matrixWorld))}),e.length>0){let t=An(e,!1);this.sharedGameControlGlobals.staticMeshBVH=new E2(t)}}addRigidBody(e,t,i){let r=[],s="geometry"in e?e.geometry:void 0,a=t.dataPatched;if((s==null?void 0:s.getAttribute("position"))!==void 0&&r.push(Us(s,e.shearScale)),a.physics.fusedBody){let n=this.gatherChildrenGeom(e,r);e.traverseObject(n),e.children.forEach(l=>l.updateMatrixWorld(!0));let o=e.cloner;o&&o.objectForSample===void 0&&a.physics.rigidBody==="dynamic"&&(o.traverseObject(n),o.children.forEach(l=>l.updateMatrixWorld(!0)))}if(r.length>0){let n,o=!i.fromCreate&&a.physics.rigidBody==="dynamic"||i.fromCreate&&i.dynamic;o?(n=Ct.RigidBodyDesc.dynamic(),n.setLinearDamping(a.physics.damping).setAngularDamping(a.physics.damping).setAdditionalMass(1e-9).setGravityScale(a.physics.gravityScale).enabledRotations(...a.physics.enabledRotation).enabledTranslations(...a.physics.enabledTranslation)):(i.hasTransformAnim||i.hasFollow||i.hasDrag)&&!i.fromCreate?(n=Ct.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e)):n=Ct.RigidBodyDesc.fixed();let l=An(r);(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(bi,_r,Sa),e.position0=bi.clone().divideScalar(this.pixelsPerMeter),e.rotation0=_r.clone(),bi.divideScalar(this.pixelsPerMeter),n.setTranslation(bi.x,bi.y,bi.z).setRotation(_r),s?l==null||l.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):l==null||l.scale(Sa.x/this.pixelsPerMeter,Sa.y/this.pixelsPerMeter,Sa.z/this.pixelsPerMeter);let h=this.sharedGameControlGlobals.rapierWorld.createRigidBody(n);o&&this.rigidBodyToMesh.set(h.handle,[e,Sa.clone(),a.physics.fusedBody]);let c=!(a.geometry===void 0||a.geometry.type==="SubdivGeometry"||a.geometry.type==="NonParametricGeometry"||a.geometry.type==="BooleanGeometry"||a.geometry.type==="VectorGeometry"||a.geometry.type==="StarGeometry"||a.geometry.type==="RectangleGeometry"||a.geometry.type==="EllipseGeometry"||a.geometry.type==="TriangleGeometry"||a.geometry.type==="TorusGeometry"||a.geometry.type==="HelixGeometry");try{this.addCollider(h,a.physics,l,t,c)}catch{try{this.addCollider(h,a.physics,l,t,!1)}catch(d){}}e.rigidBody=h}}addBoundsTree(e){var i,r;let t=[];if(((i=e.geometry)==null?void 0:i.getAttribute("position"))!==void 0&&((r=e.geometry)==null?void 0:r.getAttribute("position").count)>0&&t.push(Us(e.geometry,e.shearScale)),e.traverseObject(this.gatherChildrenGeom(e,t)),e.children.forEach(s=>s.updateMatrixWorld(!0)),t.length>0){let s=An(t,!1);e.bvhGeometry=s,s.getAttribute("position").count>0&&(e.bvhGeometry.boundsTree=new E2(s),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e))}}addCollider(e,t,i,r,s=!0){var o,l;if((i==null?void 0:i.getAttribute("position").count)===0||((o=i==null?void 0:i.getIndex())==null?void 0:o.count)===0)return;let a;i&&(t.colliderType==="trimesh"?a=Ct.ColliderDesc.trimesh(i.getAttribute("position").array,i.getIndex().array):a=Ct.ColliderDesc.convexMesh(i.getAttribute("position").array,s?i.getIndex().array:void 0)),a.setFrictionCombineRule(Ct.CoefficientCombineRule.Average).setRestitutionCombineRule(Ct.CoefficientCombineRule.Average).setDensity(t.density).setFriction(t.friction).setRestitution(t.restitution);let n=this.sharedGameControlGlobals.rapierWorld.createCollider(a,e);this.sharedGameControlGlobals.colliderToEntity.set(n.handle,r),(l=this.sharedGameControlGlobals.entityToCollisionEvents[r.uuid])!=null&&l.some(h=>h.target==="scene")&&n.setActiveEvents(Ct.ActiveEvents.COLLISION_EVENTS)}gatherChildrenGeom(e,t){return(i,r)=>{var o;if(r===0)return;let s;if(i instanceof Pr)if(i.objectForSample){if(i.objectForSample.dataPatched.physics.fusedBody)return;s=i.object}else return i.object.dataPatched.physics.fusedBody===!0&&i.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(i instanceof m1)s=i.object;else if(s=i,(o=s.dataPatched.cloner)==null?void 0:o.hideBase)return!0;let a=s.dataPatched;if(a.physics.enabled==="visibility"?!a.visible:!a.physics.enabled)return!0;r===1?e.hasNonUniformScale?i.matrixWorld.multiplyMatrices(e.shearScale,i.hiddenMatrix):i.matrixWorld.copy(i.hiddenMatrix):i.matrixWorld.multiplyMatrices(i.parent.matrixWorld,i.hiddenMatrix),i.matrixWorld.multiply(i.matrix);let n=i.geometry;(n==null?void 0:n.getAttribute("position"))!==void 0&&t.push(Us(n,i.matrixWorld))}}activate(e){var u,p;if(this.isEnabled)return;this.isEnabled=!0,this.eventManager=e,this.usePhysics=this.page.data.globalPhysics.usePhysics;let t=this.page.playCamera,i=!1,r=5,s=8,a=9,n="drag",o=this.page.data.publish.gameControlObject,l=o!==null?this.page.find(o):null,h=null;if(l)for(let f of l.data.events){if(f.data.disabled||f.data.type!=="GameControl")continue;let g=l;for(;this.usePhysics&&((u=g=g.parent)==null?void 0:u.parent)!==null;)(p=g.data.physics)==null||p.fusedBody;f.data.collisionEnabled&&(this.needsCollisionDetection=!0),h===null&&(h=f.data)}if(this.page.traverseEntity(f=>{for(let g of f.dataPatched.events)if(g.data.disabled===!1&&g.data.type==="Trigger")return this.needsCollisionDetection=!0,!0}),l&&h&&(l.data.visible===!0||l.data.physics.enabled===!0)){i=i||h.camera===t.uuid||l.uuid===t.uuid;let f=new Gw(l,this.renderer.domElement,h,this.eventContext.page.data.globalPhysics,this,l.uuid!==t.uuid&&h.camera===t.uuid,t,this.page,this.sharedAssets);this.gameControl=f,r=h.joystickPosLoc,s=h.joystickRotLoc,a=h.jumpTouchButtonLoc,n=h.rotByTouch,q1&&h.touchControl&&(this.joystickToGameControls[r]="pos",h.moveMode==="walk"&&(this.joystickToGameControls[a]="jmp"),n==="joystick"&&(this.joystickToGameControls[s]="rot"))}if(this.gameControl&&this.gameControl.data.navmesh.enabled){let f=this.gameControl.data;if(!this.navigationMeshWrapper){this.navigationMeshWrapper=new MK(this.usePhysics,this.isExport);let g;f.collider.type==="sphere"?g=f.collider.radius*2:g=f.collider.height,g=Math.floor(g/f.navmesh.ch-1),this.navigationMeshWrapper.init({...f.navmesh,walkableHeight:g},this.gameControl,this.eventContext)}}if(i===!1){let{enableRotate:f,enablePan:g,enableZoom:m,autoRotate:v,hoverRotatePanMode:y}=this.eventManager.publish.orbitControls;(f||g||m||v||y!==0)&&(this.orbitControls=new Kw(t,this.renderer.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",this.requestRender),this.orbitControls.addEventListener("end",this.requestRender),this.orbitControls.addEventListener("start",this.requestRender),this.orbitControls.fromJSON(this.eventManager.publish.orbitControls,this.eventManager.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let c=this.renderer.domElement.width/this.renderer.getPixelRatio(),d=this.renderer.domElement.height/this.renderer.getPixelRatio();this.joystickToGameControls.forEach((f,g)=>{let m=document.body.appendChild(document.createElement("div")),[v,y,x]=this.eventManager.eventContext.publish.joystickSizeAndXYOffset[g],w=(c-5*v)/4+v,_={},b=f==="jmp",A=b?0:v;g<10?(g<5?_.top=A/2:_.bottom=A/2,_.left=A/2+g%5*w):g===10?(_.left=A/2,_.top=d/2):(_.right=A/2,_.top=d/2),_.top?_.top-=y[1]:_.bottom+=y[1],_.left?_.left+=y[0]:_.right-=y[0];for(let C in _)_[C]+="px";if(b){let C=m.appendChild(document.createElement("div"));Object.assign(C.style,_,{position:"absolute",width:v+"px",height:v+"px",backgroundColor:`rgba(255,255,255,${x==="show"?.4:0})`,zIndex:"9999",borderRadius:v+"px",border:x==="show"?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let T=v/16*16*.4;x==="show"&&(C.innerHTML=`
						<svg width="${T}" height="${v*.4}" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
					`),C.addEventListener("pointerdown",()=>{this.gameControl.movementState.jump=1,this.requestRender()}),C.addEventListener("touchend",P=>P.preventDefault()),this.joysticks[g]=[void 0,m];return}let S={zone:m,mode:"static",position:_,size:v};x==="hide"&&(S.restOpacity=0);let M=XX.create(S);M.on("move",(C,T)=>{let P=this.gameControl;f==="pos"?T.force<.2?P.moveForce=0:(P.movementState.movePosZ=Math.sin(-T.angle.radian),P.movementState.movePosX=Math.cos(-T.angle.radian),T.force>1.2?P.movementState.run=1:P.movementState.run=0,T.force<.3?P.moveForce=(T.force-.2)/.1:P.moveForce=1):f==="rot"&&(T.force<.2?P.rotForce=0:(P.movementState.rotPosX=T.vector.y,P.movementState.rotPosY=-T.vector.x,T.force<.3?P.rotForce=(T.force-.2)/.1:P.rotForce=1)),this.requestRender()}),M.on("end",(C,T)=>{let P=this.gameControl;f==="pos"?(P.movementState.movePosZ=0,P.movementState.movePosX=0,P.moveForce=1):f==="rot"&&(P.movementState.rotPosX=0,P.movementState.rotPosY=0,P.rotForce=1)}),this.joysticks[g]=[M,m]}),this.markIsDestroyTarget(),this.markIsDragObject(),this.rebuildBVH(),this.initializationCounter++,window.setTimeout(()=>{this.collisionEvents.forEach(f=>f.initialDisabled=!1)},80)}initPhysics(){var n;(n=this.sharedGameControlGlobals.rapierWorld)==null||n.free(),this.sharedGameControlGlobals.rapierWorld=new Ct.World(new Ct.Vector3(0,this.gravity,0)),this.events=new Ct.EventQueue(!0);let e=[],t=[];if(this.page.traverseChildren(o=>{var v,y,x,w;let l;if(o instanceof Pr)if(o.objectForSample){if(o.objectForSample.dataPatched.physics.fusedBody)return;l=o.object}else return o.object.dataPatched.physics.fusedBody===!0&&o.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(o instanceof m1)l=o.object;else{if(o instanceof ic||o instanceof ec)return;if(l=o,((v=l.dataPatched.cloner)==null?void 0:v.disabled)===!1&&((y=l.dataPatched.cloner)==null?void 0:y.hideBase)&&((x=l.dataPatched.physics)==null?void 0:x.fusedBody)!==!0)return!0}let h=l.dataPatched,c;for(let _ of h.events)_.data.disabled!==!0&&_.data.type==="GameControl"&&(c=_.data);if(!h.physics||(h.physics.enabled==="visibility"?!h.visible:!h.physics.enabled))return!0;o.updateMatrixWorldSVD();let d=dd(h),u=!1,p=l.userData.hasDestroy,f=l.userData.hasDrag,g=!1;for(let _ of h.events)if(_.data.disabled!==!0){if(_.data.type==="Collision"){u=!0;let b=new fK(_.id,_.data,l,this.page,this.sharedAssets,this.eventManager);b.initialDisabled=!0,this.collisionEvents.push(b),this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]&&this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].every(A=>A.id!==_.id)?this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].push(b):this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]=[b]}else if(_.data.type==="Follow"){g=!0;let b=_.data.target;o.traverseVisible(A=>{A.userData.isFollowingObj=b})}}h.physics.rigidBody==="dynamic"&&h.physics.fusedBody===!1&&(o.matrixWorldFusedFalse=o.matrixWorld.clone());let m=o.geometry;if(c!==void 0){let _=Ct.RigidBodyDesc.kinematicPositionBased();(o.hasNonUniformScale?o.matrixWorldRigid:o.matrixWorld).decompose(bi,_r,Sa),o.position0=bi.clone().divideScalar(this.pixelsPerMeter),o.rotation0=_r.clone(),bi.divideScalar(this.pixelsPerMeter),_.setTranslation(bi.x,bi.y,bi.z).setRotation(_r);let b=this.sharedGameControlGlobals.rapierWorld.createRigidBody(_);o.rigidBody=b;let A;c.collider.type==="sphere"?A=Ct.ColliderDesc.ball(c.collider.radius/this.pixelsPerMeter):c.collider.type==="capsule"?A=Ct.ColliderDesc.capsule((c.collider.height/2-c.collider.radius)/this.pixelsPerMeter,c.collider.radius/this.pixelsPerMeter):A=Ct.ColliderDesc.cuboid(c.collider.width/this.pixelsPerMeter/2,c.collider.height/this.pixelsPerMeter/2,c.collider.depth/this.pixelsPerMeter/2),A.setFrictionCombineRule(Ct.CoefficientCombineRule.Average).setRestitutionCombineRule(Ct.CoefficientCombineRule.Average).setDensity(h.physics.density).setFriction(h.physics.friction).setRestitution(h.physics.restitution);let S=this.sharedGameControlGlobals.rapierWorld.createCollider(A,b);this.sharedGameControlGlobals.colliderToEntity.set(S.handle,l),bi.fromArray(c.collider.position).multiply(Sa.setFromMatrixScale(l.matrixWorld)).divideScalar(this.pixelsPerMeter),S.setTranslationWrtParent(bi);let M=new lt().setFromEuler(new Ri().setFromVector3(new E().fromArray(c.collider.rotation)));S.setRotationWrtParent(M),S.setActiveEvents(Ct.ActiveEvents.COLLISION_EVENTS),this.generateSensorColliderDescs(l,!0)}else h.physics.rigidBody==="dynamic"||d||g||p||f||u?(this.addRigidBody(o,l,{hasFollow:g,hasTransformAnim:d,hasDrag:f}),this.generateSensorColliderDescs(l,h.physics.fusedBody)):(m&&e.push(Us(m,o.matrixWorld)),h.physics.fusedBody&&o.traverseObject((_,b)=>{var C;if(b===0)return;let A;if(_ instanceof Pr)if(_.objectForSample){if(_.objectForSample.dataPatched.physics.fusedBody)return;A=_.object}else return _.object.dataPatched.physics.fusedBody===!0&&_.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else{if(_ instanceof ic||_ instanceof ec)return;if(_ instanceof m1)A=_.object;else if(A=_,(C=A.dataPatched.cloner)==null?void 0:C.hideBase)return!0}let S=A.dataPatched;if(S.physics.enabled==="visibility"?!S.visible:!S.physics.enabled)return!0;let M=_.geometry;(M==null?void 0:M.getAttribute("position"))!==void 0&&e.push(Us(M,_.matrixWorld))}),this.generateSensorColliderDescs(l,h.physics.fusedBody,t));if(((w=h.physics)==null?void 0:w.fusedBody)===!0||c)return!0}),e.length===0)return;let i=An(e);i.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let r=Ct.RigidBodyDesc.fixed(),s=this.sharedGameControlGlobals.rapierWorld.createRigidBody(r),a=Ct.ColliderDesc.trimesh(i.getAttribute("position").array,i.getIndex().array).setFrictionCombineRule(Ct.CoefficientCombineRule.Multiply).setRestitutionCombineRule(Ct.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(a,s);for(let[o,l]of t){let h=this.sharedGameControlGlobals.rapierWorld.createCollider(o,s);this.sensorToTriggerEvent[h.handle]=l}}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){this.usePhysics?this.initPhysics():(this.page.traverseEntity(e=>{for(let t of e.dataPatched.events)if(t.data.type==="Trigger"&&t.data.disabled!==!0){let i=new V7(t.id,t.data,e,this.page,this.sharedAssets,this.eventManager),r=new we().compose(Ar.fromArray(t.data.position),Eo.setFromEuler(j7.fromArray(t.data.rotation)),Yp);if(t.data.triggerZone==="box"){let s=new vi;s.min.fromArray(t.data.size).multiplyScalar(-.5),s.max.fromArray(t.data.size).multiplyScalar(.5),this.sharedGameControlGlobals.triggers.push([s,r,e,i])}else this.sharedGameControlGlobals.triggers.push([t.data.radius,r,e,i])}}),this.needsCollisionDetection&&this.initBVH())}disconnectEvents(){this.collisionEvents.forEach(e=>e.disconnect()),this.sharedGameControlGlobals.triggers.forEach(e=>e[3].disconnect()),this.sharedGameControlGlobals.triggers.length=0}deactivate(){var e,t,i,r;if(this.isEnabled){this.isEnabled=!1,this.page.traverse(s=>{let a=s;a.matrixWorldFusedFalse&&(a.matrixWorldFusedFalse=void 0),a.rigidBody&&(a.rigidBody=void 0),a.position0&&(a.position0=void 0),a.rotation0&&(a.rotation0=void 0)}),(e=this.sharedGameControlGlobals.rapierWorld)==null||e.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.accumulator=0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.disconnectEvents(),(t=this.gameControl)==null||t.reset(),(i=this.gameControl)==null||i.dispose(),this.gameControl=null,this.initializationCounter=-1,this.joysticks.forEach(([s,a])=>{s==null||s.destroy(),a.remove()}),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0),(r=this.navigationMeshWrapper)==null||r.dispose(),this.navigationMeshWrapper=void 0;for(let s of Object.values(this.sharedGameControlGlobals.entityToCollisionEvents))s.forEach(a=>a.disconnect());this.sharedGameControlGlobals.entityToCollisionEvents={},this.page.updateMatrixWorld(!0)}}update(e,t,i){if(!this.isEnabled)return!0;let r=!0;if(this.orbitControls!==void 0&&this.orbitControls.needsUpdate&&(r=!this.orbitControls.update()),this.initializationCounter>=0&&this.initializationCounter<2?(this.initializationCounter++,r=!1):this.initializationCounter===2&&this.gameControl&&(r=!this.gameControl.update(e,t,i)&&r),this.usePhysics===!1&&this.checkTrigger(),this.usePhysics){let s=.016666666666666666;if(e===0)r=this.stepPhysics()&&r;else{let a=e/1e3;a<s&&a>s*.55&&(a=s),this.accumulator+=a;let n=performance.now(),o=0,l=6;for(;this.accumulator>=s&&o<l&&(r=this.stepPhysics()&&r,this.accumulator-=s,o++,!(performance.now()-n>s*1e3)););this.accumulator=this.accumulator%s}}return r}stepPhysics(){var e;for(let t of this.sharedGameControlGlobals.entitiesWithTransformAnim){(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(bi,_r,Sa),Wp.setFromQuaternion(_r);let i=t;i.prevR===void 0?(i.prevR=Wp.clone(),i.prevT=bi.clone()):(i.prevR.copy(Wp),i.prevT.copy(bi)),t.rigidBody&&(t.rigidBody.setNextKinematicTranslation(bi.divideScalar(this.pixelsPerMeter)),t.rigidBody.setNextKinematicRotation(_r))}return this.sharedGameControlGlobals.rapierWorld.step(this.events),(e=this.events)==null||e.drainCollisionEvents(this.handleCollisionEvents),!this.updatePositions()}dispatchCollisionEvent(e,t,i){var a;let r=((a=this.sharedGameControlGlobals.rapierWorld)==null?void 0:a.getCollider(i))._parent,s;if(t.cloner){for(let n of t.cloner.children)if(n.rigidBody===r){s=n;break}}e.dispatch(s),t.dispatchEvent(Zf)}updateUseWindowEvents(e){var t;(t=this.orbitControls)==null||t.updateUseWindowEvents(e)}generateSensorColliderDescs(e,t,i){let r=G7.copy(e.matrixWorld).invert();e.traverseEntity((s,a)=>{if(t===!1&&a===1)return!0;for(let n of s.dataPatched.events)if(n.data.type==="Trigger"&&n.data.disabled!==!0){let o=new V7(n.id,n.data,s,this.page,this.sharedAssets,this.eventManager),l;if(n.data.triggerZone==="box"?l=Ct.ColliderDesc.cuboid(...n.data.size.map(h=>h/(2*this.pixelsPerMeter))):l=Ct.ColliderDesc.ball(n.data.radius/this.pixelsPerMeter),l.setDensity(0).setSensor(!0).setActiveEvents(Ct.ActiveEvents.COLLISION_EVENTS),Ar.fromArray(n.data.position),Eo.setFromEuler(j7.fromArray(n.data.rotation)),G0.compose(Ar,Eo,Yp).premultiply(s.matrixWorld),i?(G0.decompose(Ar,Eo,qp),l.setActiveCollisionTypes(Ct.ActiveCollisionTypes.KINEMATIC_FIXED|Ct.ActiveCollisionTypes.DYNAMIC_FIXED)):(G0.premultiply(r).decompose(Ar,Eo,qp),e.rigidBody.bodyType()===Ct.RigidBodyType.Dynamic||(e.rigidBody.bodyType()===Ct.RigidBodyType.Fixed?l.setActiveCollisionTypes(Ct.ActiveCollisionTypes.KINEMATIC_FIXED|Ct.ActiveCollisionTypes.DYNAMIC_FIXED):l.setActiveCollisionTypes(Ct.ActiveCollisionTypes.KINEMATIC_KINEMATIC|Ct.ActiveCollisionTypes.DYNAMIC_KINEMATIC))),Ar.divideScalar(this.pixelsPerMeter),l.setTranslation(Ar.x,Ar.y,Ar.z),l.setRotation(Eo),i)i.push([l,o]);else{let h=this.sharedGameControlGlobals.rapierWorld.createCollider(l,e.rigidBody);this.sensorToTriggerEvent[h.handle]=o}}})}checkTrigger(){let e;for(let t=0;t<this.sharedGameControlGlobals.triggers.length;t++){let[i,r,s,a]=this.sharedGameControlGlobals.triggers[t];for(let n=0;n<this.sharedGameControlGlobals.entitiesWithTransformAnim.length;n++){let o=this.sharedGameControlGlobals.entitiesWithTransformAnim[n];if(s===o||a.isValidTriggeringObject(Et.is(o)?o:o.object)===!1)continue;let l=G7.copy(s.matrixWorld).decompose(Ar,H7,qp).compose(Ar,H7,Yp).multiply(r),h=G0.copy(o.matrixWorld).invert().multiply(l);i instanceof vi?e=o.bvhGeometry.boundsTree.intersectsBox(i,h):(Xp.radius=i,Xp.center.setFromMatrixPosition(h),e=o.bvhGeometry.boundsTree.intersectsSphere(Xp)),e?a.currentIntersectedObjects.indexOf(o)===-1&&(a.currentIntersectedObjects.push(o),a.dispatch(),s.dispatchEvent(zK)):a.currentIntersectedObjects=a.currentIntersectedObjects.filter(c=>c!==o)}}}};function UK(e){let t=this._clip.duration,i=this._clip.start??0,r=this.loop,s=this.time+e,a=this._loopCount,n=r===Jf;if(e===0)return a===-1?s:n&&(a&1)===1?t-(s-i):s;if(r===sv){a===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=t)s=t;else if(s<0)s=0;else{this.time=s;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(a===-1&&(e>=0?(a=0,this._setEndings(!0,this.repetitions===0,n)):this._setEndings(this.repetitions===0,!0,n)),s>=t||s<i){let o=Math.floor((s-i)/(t-i));s-=(t-i)*o,a+=Math.abs(o);let l=this.repetitions-a;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n||(s=e>0?t:i,this.repetitions===1&&(s=t)),this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){let h=e<0;this._setEndings(h,!h,n)}else this._setEndings(!1,!1,n);this._loopCount=a,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=s;if(n&&(a&1)===1)return t-(s-i)}return s}var W7=!1,NK=class{constructor(e,t,i,r){this.scene=e,this.requestRender=t,this.updateDisplayProgress=i,this.animationInspectorState=r,this.clipIdToAction={},this.activeClip=null,this.needsUpdate=!1,this.addClip=s=>{s.data.type==="Empty"&&s.data.animations&&s.data.animations.forEach((a,n)=>{let o=a[0]+"/";if(Array.isArray(s.identity)?o+=s.identity[0]:o+=s.uuid,this.clipIdToAction[o])return;let l=o3.parse(JSON.parse(a[2]));s.animations[n]=l;let h=this.mixer.clipAction(l,s);W7===!1&&(Object.getPrototypeOf(h)._updateTime=UK,W7=!0),h.clampWhenFinished=!0,this.clipIdToAction[o]=h})},this.mixer=new LP(e),this.scene.traverseEntity(this.addClip)}deleteClip(e,t){let i=this.scene.find(t);if(!i)return;let r=i.animations.find(a=>a.uuid===e);if(!r)return;let s=this.clipIdToAction[e];!s||(s.stop(),this.mixer.uncacheClip(r),delete this.clipIdToAction[e],i.animations=i.animations.filter(a=>a.uuid!==e))}get isPlaying(){return Object.values(this.clipIdToAction).some(e=>e.isRunning())}playFromInspector(e){this.mixer.stopAllAction();let t=this.clipIdToAction[e];!t||(t.play(),this.activeClip=t.getClip(),this.requestRender())}onExitPlayMode(){Object.values(this.clipIdToAction).forEach(e=>{e.repetitions=1/0,e.loop=av}),this.mixer.stopAllAction(),this.requestRender()}play(e){let t=e.clipId+"/"+e.object,i=this.clipIdToAction[t];if(i)return e&&(e.repeat>=0&&(i.repetitions=e.repeat+1),e.direction==="pingpong"&&e.repeat!==0&&(i.loop=Jf)),i.play(),i.paused=!1,this.requestRender(),i}resumeFromInspector(e){let t=this.clipIdToAction[e];!t||(t.play(),t.paused=!1,this.requestRender())}pauseFromInspector(e){let t=this.clipIdToAction[e];!t||(t.paused=!0)}stop(){this.mixer.stopAllAction(),this.requestRender()}update(e){var t;if(this.needsUpdate)this.needsUpdate=!1;else if(this.isPlaying===!1||(t=this.animationInspectorState)!=null&&t.isScrubbing)return;this.mixer.update(e/1e3),this.activeClip&&this.updateDisplayProgress(Math.round(this.mixer.time/this.activeClip.duration*(this.maxFrames-1)%(this.maxFrames-1))),this.requestRender()}get maxFrames(){return Lw(this.activeClip??void 0)}setProgressFromInspector(e,t){if(!this.clipIdToAction[t])return;this.activeClip!==this.clipIdToAction[t].getClip()&&this.playFromInspector(t);let i=this.clipIdToAction[t].paused;this.clipIdToAction[t].paused=!1,this.mixer.setTime(Math.min(e/(this.maxFrames-1),.9999)*this.activeClip.duration),this.requestRender(),i&&(this.clipIdToAction[t].paused=!0)}},Qp=new WeakMap,VK=class extends nh{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,r){let s=new l3(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,a=>{this.decodeDracoFile(a,t).catch(r)},i,r)}decodeDracoFile(e,t,i,r){let s={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!i};return this.decodeGeometry(e,s).then(t)}decodeGeometry(e,t){let i=JSON.stringify(t);if(Qp.has(e)){let o=Qp.get(e);if(o.key===i)return o.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r,s=this.workerNextTaskID++,a=e.byteLength,n=this._getWorker(s,a).then(o=>(r=o,new Promise((l,h)=>{r._callbacks[s]={resolve:l,reject:h},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(o=>this._createGeometry(o.geometry));return n.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),Qp.set(e,{key:i,promise:n}),n}_createGeometry(e){let t=new Ge;e.index&&t.setIndex(new ot(e.index.array,1));for(let i=0;i<e.attributes.length;i++){let r=e.attributes[i],s=r.name,a=r.array,n=r.itemSize;t.setAttribute(s,new ot(a,n))}return t}_loadLibrary(e,t){let i=new l3(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((r,s)=>{i.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(i=>{let r=i[0];e||(this.decoderConfig.wasmBinary=i[1]);let s=jK.toString(),a=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([a]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){let a=s.data;switch(a.type){case"decode":r._callbacks[a.id].resolve(a);break;case"error":r._callbacks[a.id].reject(a);break;default:""+a.type}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});let i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){this.workerPool.map(e=>e._taskLoad)}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}};function jK(){let e,t;onmessage=function(n){let o=n.data;switch(o.type){case"init":e=o.decoderConfig,t=new Promise(function(c){e.onModuleLoaded=function(d){c({draco:d})},DracoDecoderModule(e)});break;case"decode":let l=o.buffer,h=o.taskConfig;t.then(c=>{let d=c.draco,u=new d.Decoder,p=new d.DecoderBuffer;p.Init(new Int8Array(l),l.byteLength);try{let f=i(d,u,p,h),g=f.attributes.map(m=>m.array.buffer);f.index&&g.push(f.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:f},g)}catch(f){self.postMessage({type:"error",id:o.id,error:f.message})}finally{d.destroy(p),d.destroy(u)}});break}};function i(n,o,l,h){let c=h.attributeIDs,d=h.attributeTypes,u,p,f=o.GetEncodedGeometryType(l);if(f===n.TRIANGULAR_MESH)u=new n.Mesh,p=o.DecodeBufferToMesh(l,u);else if(f===n.POINT_CLOUD)u=new n.PointCloud,p=o.DecodeBufferToPointCloud(l,u);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!p.ok()||u.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+p.error_msg());let g={index:null,attributes:[]};for(let m in c){let v=self[d[m]],y,x;if(h.useUniqueIDs)x=c[m],y=o.GetAttributeByUniqueId(u,x);else{if(x=o.GetAttributeId(u,n[c[m]]),x===-1)continue;y=o.GetAttribute(u,x)}g.attributes.push(s(n,o,u,m,v,y))}return f===n.TRIANGULAR_MESH&&(g.index=r(n,o,u)),n.destroy(u),g}function r(n,o,l){let h=l.num_faces()*3,c=h*4,d=n._malloc(c);o.GetTrianglesUInt32Array(l,c,d);let u=new Uint32Array(n.HEAPF32.buffer,d,h).slice();return n._free(d),{array:u,itemSize:1}}function s(n,o,l,h,c,d){let u=d.num_components(),p=l.num_points()*u,f=p*c.BYTES_PER_ELEMENT,g=a(n,c),m=n._malloc(f);o.GetAttributeDataArrayForAllPoints(l,d,g,f,m);let v=new c(n.HEAPF32.buffer,m,p).slice();return n._free(m),{name:h,array:v,itemSize:u}}function a(n,o){switch(o){case Float32Array:return n.DT_FLOAT32;case Int8Array:return n.DT_INT8;case Int16Array:return n.DT_INT16;case Int32Array:return n.DT_INT32;case Uint8Array:return n.DT_UINT8;case Uint16Array:return n.DT_UINT16;case Uint32Array:return n.DT_UINT32}}}var Fa;function GK(){return Fa||(Fa=new VK,Fa.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),Fa.decoderPending}async function HK(e){if(Fa){let t={attributeIDs:Fa.defaultAttributeIDs,attributeTypes:Fa.defaultAttributeTypes,useUniqueIDs:!1},i;try{i=await Fa.decodeGeometry(new Int8Array(e).buffer,t)}catch(r){}if(i)return{index:i.index?{array:i.index.array}:void 0,attributes:Object.entries(i.attributes).map(([r,s])=>({name:r,itemSize:s.itemSize,array:s.array}))}}return null}async function WK(e,t){let[i,r]=jy(_3.deserialize(new Uint8Array(e)));return px(i),r.result().data}function qK(e){let t=[];return e.scene.objects.traverse((i,r)=>{r.type==="Mesh"&&r.geometry.type==="NonParametricGeometry"&&r.geometry.data.draco!==void 0&&t.push(r)}),t}async function YK(e){for(let t of e){let i=await HK(t.geometry.data.draco);if(i){let r=t.geometry.data;i.index&&(r.index={array:i.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let s={};i.attributes.forEach(({name:a,array:n,itemSize:o})=>{s[a]={array:n,itemSize:o,type:"Float32Array",normalized:!1}}),r.attributes=s,r.draco=void 0}}}var XK=class{constructor(){this._clickCount=0,this._lastTime=0,this._lastPosition=[0,0],this._delay=500,this._distance=2,this._onMouseDown=e=>{let t=[e.clientX,e.clientY],i=new Date().getTime();if(this._clickCount>0){let r=t[0]-this._lastPosition[0],s=t[1]-this._lastPosition[1];Math.sqrt(r*r+s*s)>this._distance&&(this._clickCount=0)}this._lastPosition=t,this._clickCount=i-this._lastTime>this._delay?1:this._clickCount+1,this._lastTime=i},this._onMouseUp=e=>{}}start(e,t=500,i=2){this._target&&this.stop(),this.reset(),this._delay=t,this._distance=i,this._target=e,this._target.addEventListener("pointerdown",this._onMouseDown,!1),this._target.addEventListener("pointerup",this._onMouseUp,!1)}stop(){this._target&&(this._target.removeEventListener("pointerdown",this._onMouseDown,!1),this._target.removeEventListener("pointerup",this._onMouseUp,!1),this._target=void 0)}get clickCount(){return this._clickCount}reset(){this._clickCount=0,this._lastTime=0,this._lastPosition=[0,0]}},QK=class{constructor(e,t,i,r,s,a,n,o){this.eventId=e,this.id=t,this.data=i,this.dataEvent=r,this.object=s,this.stage=!1,this.actions=Ci(r,i.actions,a,n,o,s)}disconnect(){Qi(this.actions)}dispatchIn(){this.actions.Audio.forEach(e=>e.dispatchBasic()),this.actions.Particles.forEach(e=>e.dispatchBasic()),this.actions.Video.forEach(e=>e.dispatchBasic()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.Link.forEach(e=>e.dispatch()),this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.actions.Transition.forEach(e=>e.toggle()),this.actions.Animation.forEach(e=>e.play()),this.actions.SwitchCamera.forEach(e=>e.play()),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch())}dispatchOut(){this.actions.Transition.forEach(e=>{e.toggle()})}},ZK=class extends x1{constructor(e,t){super(e),this.eventManager=t,this.breakpoints=[],this.resize=(i,r)=>{this.breakpoints.forEach(s=>{let a=C3.deviceToSize(s.data.size),n=s.dataEvent.orientation==="horizontal"?i:r,o;switch(s.data.operator){case"<":o=n<a[0];break;case">":o=n>a[0];break;case"<>":o=n>a[0]&&n<a[1];break}s.stage!==o&&(s.stage=o,s.stage?s.dispatchIn():s.dispatchOut())})},this.onResizeObserver=new ResizeObserver(i=>{for(let r of i){let{width:s,height:a}=r.contentRect;this.resize(s,a)}})}connect(){let{page:e,sharedAssets:t,domElement:i}=this.eventContext;this.onResizeObserver.observe(i);let r=s=>{var a;if(!(!s.visible||!((a=s.data)!=null&&a.events.length)))for(let{data:n,id:o}of s.data.events)n.disabled||n.type==="Resize"&&n.breakpoints.forEach(({data:l,id:h})=>{try{let c=new QK(o,h,l,n,s,e,t,this.eventManager);this.breakpoints.push(c)}catch{}})};e.traverseEntity(s=>{var a;(s instanceof p1||s instanceof Gi)&&((a=s.frame)==null||a.traverse(n=>{r(n)})),r(s)})}disconnect(){this.onResizeObserver.disconnect(),this.breakpoints.forEach(e=>{e.disconnect()}),this.breakpoints=[]}},KK=class extends x1{constructor(e,t){super(e),this.eventManager=t,this.userAPIs={},this.events=[],this.onSuccess=({userAPIId:i})=>{this.events.forEach(r=>{r.data.userAPIId===i&&r.dispatchSuccess()})},this.onError=({userAPIId:i})=>{this.events.forEach(r=>{r.data.userAPIId===i&&r.dispatchError()})},this.userAPIs=e.sharedAssets.getUserAPIs()}connect(){this.eventContext.page.traverseEntity(e=>{var t;(t=e.data)==null||t.events.filter(i=>i.data.type==="API"&&!i.data.disabled).forEach(i=>{this.events.push(new JK(i.id,i.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),Object.entries(this.userAPIs).forEach(([e,t])=>{t.on("success",this.onSuccess),t.on("error",this.onError),t.autostart&&t.callUserAPI(this.eventContext.sharedAssets)})}disconnect(){Object.entries(this.userAPIs).forEach(([e,t])=>{t.off("success",this.onSuccess),t.off("error",this.onError)})}},JK=class{constructor(e,t,i,r,s,a){this.id=e,this.data=t,this.object=i,this.successActions=Ci(t,t.successActions,r,s,a,i),this.errorActions=Ci(t,t.errorActions,r,s,a,i)}dispatchSuccess(){this.dispatchActions(this.successActions)}dispatchError(){this.dispatchActions(this.errorActions)}dispatchActions(e){e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}},$K=class extends x1{constructor(e,t){super(e),this.eventManager=t,this.userWebhooks={},this.events=[],this.onMessage=({userWebhookId:i})=>{this.events.forEach(r=>{r.data.userWebhookId===i&&r.dispatch()})},this.userWebhooks=e.sharedAssets.getUserWebhooks()}connect(){this.eventContext.page.traverseEntity(e=>{var t;(t=e.data)==null||t.events.filter(i=>i.data.type==="WEBHOOK"&&!i.data.disabled).forEach(i=>{this.events.push(new eJ(i.id,i.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),Object.entries(this.userWebhooks).forEach(([e,t])=>{t.connect(),t.on("message",this.onMessage)})}disconnect(){Object.entries(this.userWebhooks).forEach(([e,t])=>{t.off("message",this.onMessage),t.disconnect()})}},eJ=class{constructor(e,t,i,r,s,a){this.id=e,this.data=t,this.object=i,this.actions=Ci(t,t.actions,r,s,a,i)}dispatch(){let e=this.actions;e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}};function tJ(){let e=document.createElement("textarea");return e.style.position="fixed",e.style.top="200px",e.style.left="400px",e.style.zIndex="-1",e.style.border="1px solid rgba(255,0,0,0.5)",e.style.width="10px",e.style.height="500px",e.style.color="white",e.style.opacity="0.5",e.style.background="transparent",e.style.display="none",e.style.margin="0px",e.style.padding="0px",e.style.boxSizing="content-box",e.style.pointerEvents="none",e}var iJ=new E(0,0,1),q7=new E,Y7=new E,X7=new Ai,rJ=class{constructor(e,t,i,r,s){this.containerScene=e,this.raycaster=t,this.sharedAssets=i,this.requestRender=r,this.onExit=s,this.htmlInput=null,this.virtualInput=null,this.helper=new jb,this.doubleClickHandler=new XK,this.isDragging=!1,this.plane=new B1,this.caretInterval=0,this.planeIntersection=new E,this.projected=new j,this._lastIndex=0,this._isFirstDragMove=!1,this.selectionOnDragStart=0,this.onTextMaterialChanged=()=>{var n;let a=(n=this.virtualInput)==null?void 0:n.data;if(this.virtualInput!==void 0&&a){let o=a.material,l=typeof o=="string"?this.sharedAssets.data.materials[o]:o,h=vY(l,this.sharedAssets);this.helper.setCaretColor(h)}},this.stopAnimateTextCursor=()=>{clearInterval(this.caretInterval),this.helper&&(this.helper.caretMesh.visible=!1)},this.startAnimateTextCursor=()=>{this.stopAnimateTextCursor(),this.helper&&(this.helper.caretMesh.visible=!0,this.caretInterval=setInterval(()=>{this.helper&&(this.helper.caretMesh.visible=!this.helper.caretMesh.visible),this.requestRender()},600))},this.handleCaretUpdate=a=>{if(!this.htmlInput||!this.virtualInput)return;let n=this.helper,o=(a==null?void 0:a.key)==="ArrowLeft"||(a==null?void 0:a.key)==="ArrowRight",l=(a==null?void 0:a.key)==="ArrowUp"||(a==null?void 0:a.key)==="ArrowDown";this.htmlInput.selectionStart===this.htmlInput.selectionEnd?(n.setCaretPosition(this.htmlInput.selectionStart,{horizontalKeyMove:o,verticalKeyMove:l}),this.startAnimateTextCursor()):n.setSelection(this.htmlInput.selectionStart,this.htmlInput.selectionEnd),this.requestRender()},this.containerScene.add(this.helper)}createInput(){return this.htmlInput=tJ(),this.htmlInput}connect(){}disconnect(){var e;this.stopAnimateTextCursor(),this.helper.hide(),(e=this.htmlInput)==null||e.remove(),this.doubleClickHandler.stop()}handleMouseDown(){var a,n;if(!this.htmlInput||!this.virtualInput)return!0;this.getPointOnPlane();let e=this.doubleClickHandler.clickCount,{index:t,lineIndex:i,characterIndex:r}=this.helper.getSelectionFromPosition(this.projected.x,this.projected.y,e>1?"inside":"previous")??{index:0,lineIndex:0,characterIndex:0};(n=(a=this.virtualInput)==null?void 0:a.wrappedText)!=null&&n.length&&this.virtualInput.wrappedText[i][Math.max(0,r-1)]===`
`&&(t--,r--),this._lastIndex=t,this._isFirstDragMove=!0;let s=this.checkClickedObject();if(e===1){if(s===null)return this.onExit(this.virtualInput),!0;this.selectionOnDragStart=t,this.isDragging=!0,this.setInputSelection(t)}else s===this.virtualInput&&(e===2?this.selectClosestWord(i,r):e>2&&(this.setInputSelection(0,this.htmlInput.value.length),this.doubleClickHandler.reset()))}handleMouseUp(){this.applyRangeToTextInput(),this.isDragging=!1,this._isFirstDragMove=!1}handleMouseMove(){!this.virtualInput||(this._isFirstDragMove&&this.doubleClickHandler.clickCount>1&&(this.selectionOnDragStart=this._lastIndex,this.isDragging=!0,this.setInputSelection(this._lastIndex)),this._isFirstDragMove=!1,this.getPointOnPlane(),this.applyRangeToTextInput())}focus(e){var t;if(this.virtualInput=e,this.updateTextInputStyles(),this.htmlInput)if(e){let i=(t=this.data)==null?void 0:t.geometry.text;this.htmlInput.value=typeof i=="string"?"":(i==null?void 0:i.textValue.toString())??""}else this.htmlInput.value=""}blur(){}get data(){let{virtualInput:e}=this;if(e)return e.dataPatched}applyRangeToTextInput(){var s;if(!this.isDragging||!this.virtualInput||!this.htmlInput)return;let e=this.selectionOnDragStart,{index:t,lineIndex:i,characterIndex:r}=this.helper.getSelectionFromPosition(this.projected.x,this.projected.y,this.doubleClickHandler.clickCount>2?"inside":"previous")??{index:0};i!==void 0&&r!==void 0&&((s=this.virtualInput)==null?void 0:s.wrappedText[i][r-1])===`
`&&t--,this.htmlInput.setSelectionRange(Math.min(e,t),Math.max(e,t))}checkClickedObject(){if(this.virtualInput){let e=this.raycaster.intersectObject(this.virtualInput,!1);if(e.length>0){let t=e[0];if(t.object instanceof v5)return t.object}}return null}selectClosestWord(e,t){if(!this.virtualInput)return;let i=this.virtualInput.wrappedText,r=i[e],s=t+1,a=t;r[t]!==" "&&(s=this.findNextCharOccurence(r,t,"forward"," "),a=this.findNextCharOccurence(r,t,"backward"," "),a>0&&a++,s>=r.length-1&&e===i.length-1&&s++);let n=this.helper,o=n.getGlobalIndexFromLineAndCharIndexes(i,e,a),l=n.getGlobalIndexFromLineAndCharIndexes(i,e,s);this.setInputSelection(o,l)}findNextCharOccurence(e,t,i,r=" "){let s=Math.max(0,e.length-1),a=i==="forward"?s:0,n=i==="forward"?1:-1,o=Math.max(Math.min(t,s),0);for(;o!==a;)if(o+=n,e.charAt(o)===r)return o;return a}getPointOnPlane(){var t;let e=(t=this.virtualInput)==null?void 0:t.data;if(!(!this.virtualInput||!e)&&this.raycaster.ray.intersectsPlane(this.plane)){this.planeIntersection===null&&(this.planeIntersection=new E);let i=this.raycaster.ray.intersectPlane(this.plane,this.planeIntersection);if(i){this.planeIntersection.copy(this.virtualInput.worldToLocal(i));let r=typeof e.geometry.width=="number"?e.geometry.width:1,s=typeof e.geometry.height=="number"?e.geometry.height:1;this.projected.set(i.x+r*.5,i.y-s*.5)}}}updatePlane(){var t;let e=(t=this.virtualInput)==null?void 0:t.data;this.virtualInput&&e&&(X7.getNormalMatrix(this.virtualInput.matrixWorld),q7.copy(iJ).applyMatrix3(X7).normalize(),this.virtualInput.localToWorld(Y7.set(0,0,e.geometry.depth)),this.plane.setFromNormalAndCoplanarPoint(q7,Y7))}setInputSelection(e,t=e){var i;(i=this.htmlInput)==null||i.setSelectionRange(e,t),setTimeout(()=>{var r;(r=this.htmlInput)==null||r.focus()})}updateTextInputStyles(){var t;let e=(t=this.virtualInput)==null?void 0:t.data;this.virtualInput&&e&&this.htmlInput&&(this.htmlInput.style.fontSize=e.geometry.fontSize+"px",this.htmlInput.style.letterSpacing=e.geometry.letterSpacing*e.geometry.fontSize+"px",this.htmlInput.style.lineHeight=e.geometry.fontSize*e.geometry.lineHeight+"px",this.htmlInput.style.width=e.geometry.width+"px",this.htmlInput.style.height=e.geometry.height+"px",this.htmlInput.style.textAlign=sJ(e.geometry.horizontalAlign))}};function sJ(e){return e===4?"justify":e===2?"right":e===3?"center":"left"}var Jw=(e,t)=>{if(typeof e=="string"){let i=t.data(e);if(i)return Jw(i.value,t)}return n1.getDisplayedValue(e)};function Q7(e,t){let i=e.text,r="";if(typeof i=="string"){let s=t.variables.data(r);s&&(r=Jw(s.value,t.variables))}else r=i.textValue.toString();return r}var aJ=class extends x1{constructor(e,t){super(e),this.eventManager=t,this._textInputs=[],this.sceneHelpers=new ls,this.helper=new jb,this._onMouseDownFocusIn=i=>{if(it.length>1)return;this.eventContext.updateRaycaster(i);let r=null;if(this.eventContext.raycaster){for(let s of this._textInputs)if(this.eventContext.raycaster.intersectObject(s,!0).length>0){r=s;break}}this.focusOnTextInput(r),this._onCaretUpdate(),this._onMouseUp(),this.textInputManager.doubleClickHandler.start(this.eventContext.domElement),this.textInputManager.doubleClickHandler._onMouseDown(i),this._onMouseDown(i)},this.onExit=()=>{let{virtualInput:i}=this.textInputManager;if(i===null)return;let r=this.textInputManager.htmlInput;this.helper.hide(),r==null||r.setSelectionRange(r.value.length,r.value.length),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0);let{domElement:s}=this.eventContext;s.removeEventListener("pointerdown",this._onMouseDown,!1),s.removeEventListener("pointerup",this._onMouseUp,!1),s.removeEventListener("pointermove",this._onMouseMove,!1),window.removeEventListener("keydown",this._onKeyPress),this.textInputManager.doubleClickHandler.reset(),s.addEventListener("pointerdown",this._onMouseDownFocusIn),this.eventContext.renderer.sceneHelpersOnTop=void 0,this.eventContext.renderer.pipeline.disableHelpers()},this._onMouseDown=i=>{this.eventContext.updateRaycaster(i),this.textInputManager.handleMouseDown(),this.textInputManager.virtualInput&&this.eventContext.raycaster.intersectObject(this.textInputManager.virtualInput,!0).length>0&&this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1)},this._onMouseUp=()=>{this.textInputManager.handleMouseUp(),this.eventManager.controlsManager.orbitControls&&!this.eventManager.controlsManager.orbitControls.enabled&&(this.eventManager.controlsManager.orbitControls.enabled=!0)},this._onMouseMove=i=>{this.eventContext.updateRaycaster(i),this.textInputManager.handleMouseMove()},this._onTextEdit=i=>{let{htmlInput:r,virtualInput:s,helper:a}=this.textInputManager;if(!r||!s)return;let n=r.value;s.textGeometry.setText(n).then(()=>{this.eventContext.requestRender()});let o=s.data;a.update();let l=o.geometry.text;if(typeof l=="string"){let h=l;this.eventContext.sharedAssets.updateVariable(h,{textValue:n})}this.textInputManager.updateTextInputStyles(),this._onCaretUpdate()},this._onCaretUpdate=i=>{this.textInputManager.handleCaretUpdate(i)},this._onKeyPress=i=>{i.key==="Escape"&&this.onExit()},this.textInputManager=new rJ(this.sceneHelpers,e.raycaster,e.sharedAssets,e.requestRender,this.onExit)}connect(){let e=[];if(this.eventContext.scene.traverseEntity(r=>{r instanceof v5&&e.push(r)}),this._textInputs=e,e.length===0)return;let{domElement:t}=this.eventContext;t.addEventListener("pointerdown",this._onMouseDownFocusIn),this.textInputManager.connect();let i=this.textInputManager.createInput();document.body.appendChild(i),i.style.display="none",i.addEventListener("keyup",this._onCaretUpdate),i.addEventListener("keydown",this._onCaretUpdate),i.addEventListener("beforeinput",this._onCaretUpdate),i.addEventListener("paste",this._onCaretUpdate),i.addEventListener("cut",this._onCaretUpdate),i.addEventListener("select",this._onCaretUpdate),i.addEventListener("selectstart",this._onCaretUpdate)}disconnect(){let e=this.textInputManager.htmlInput,{domElement:t}=this.eventContext;t.removeEventListener("pointerdown",this._onMouseDownFocusIn),e==null||e.removeEventListener("keyup",this._onCaretUpdate),e==null||e.removeEventListener("keydown",this._onCaretUpdate),e==null||e.removeEventListener("beforeinput",this._onCaretUpdate),e==null||e.removeEventListener("paste",this._onCaretUpdate),e==null||e.removeEventListener("cut",this._onCaretUpdate),e==null||e.removeEventListener("select",this._onCaretUpdate),e==null||e.removeEventListener("selectstart",this._onCaretUpdate),this._textInputs.forEach(i=>{let r=Q7(i.data.geometry,this.eventContext.sharedAssets.data);i.textGeometry.setText(r)}),t.removeEventListener("pointerdown",this._onMouseDown,!1),t.removeEventListener("pointerup",this._onMouseUp,!1),t.removeEventListener("pointermove",this._onMouseMove,!1),window.addEventListener("keydown",this._onKeyPress),this.eventContext.renderer.sceneHelpersOnTop=void 0,this.eventContext.renderer.pipeline.disableHelpers(),this.textInputManager.disconnect()}focusOnTextInput(e){this.textInputManager.focus(e),this.textInputManager.onTextMaterialChanged();let t=this.textInputManager.htmlInput;if(!t||e===null)return;this.textInputManager.updateTextInputStyles(),this.eventContext.renderer.sceneHelpersOnTop=this.sceneHelpers,this.eventContext.renderer.pipeline.enableHelpers(),this.textInputManager.isDragging=!1;let i=Q7(e.textGeometry.userData.parameters,this.eventContext.sharedAssets.data);t.value=i,t.setSelectionRange(0,0),this.textInputManager.helper.show(e),t.style.display="block",t.addEventListener("input",this._onTextEdit),this.textInputManager.updatePlane();let{domElement:r}=this.eventContext;r.removeEventListener("pointerdown",this._onMouseDownFocusIn),r.addEventListener("pointerdown",this._onMouseDown,!1),r.addEventListener("pointerup",this._onMouseUp,!1),r.addEventListener("pointermove",this._onMouseMove,!1),window.addEventListener("keydown",this._onKeyPress)}},nJ=class extends x1{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.onVoice=({value:i,frequencies:r})=>{this.events.forEach(s=>{s.dispatch()})}}connect(){this.openAIRealtime=this.eventContext.sharedAssets.openAIRealtime,this.openAIRealtime&&(this.eventContext.page.traverseEntity(e=>{var t;(t=e.data)==null||t.events.filter(i=>i.data.type==="AIAssistantListener"&&!i.data.disabled).forEach(i=>{this.events.push(new oJ(i.id,i.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),this.openAIRealtime.on("voice",this.onVoice))}disconnect(){var e;(e=this.openAIRealtime)==null||e.off("voice",this.onVoice)}},oJ=class{constructor(e,t,i,r,s,a){this.id=e,this.data=t,this.object=i,this.actions=Ci(t,t.actions,r,s,a,i)}dispatch(){this.dispatchActions(this.actions)}dispatchActions(e){e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}},lJ=class extends x1{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.onTriggerEvent=({description:i,direction:r})=>{let s=this.events.find(a=>a.data.description===i);s&&(r==="backward"?s.dispatchReverse():s.dispatch())}}connect(){this.openAIRealtime=this.eventContext.sharedAssets.openAIRealtime,this.openAIRealtime&&(this.eventContext.page.traverseEntity(e=>{var t;(t=e.data)==null||t.events.filter(i=>i.data.type==="AIAssistantTrigger"&&!i.data.disabled).forEach(i=>{this.events.push(new hJ(i.id,i.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),this.openAIRealtime.on("trigger_event",this.onTriggerEvent))}disconnect(){var e;(e=this.openAIRealtime)==null||e.off("trigger_event",this.onTriggerEvent)}},hJ=class{constructor(e,t,i,r,s,a){this.id=e,this.data=t,this.object=i,this.actions=Ci(t,t.actions,r,s,a,i)}dispatch(){let e=this.actions;e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}dispatchReverse(){let e=this.actions;e.Transition.forEach(t=>t.reverseFromCurrent()),e.Particles.forEach(t=>t.reverseFromCurrent()),e.Animation.forEach(t=>t.reverseFromCurrent()),e.SwitchCamera.forEach(t=>t.reverseFromCurrent()),e.Create.forEach(t=>t.dispatchStop())}},cJ=class{constructor(e,t,i,r,s){this.publish=e,this.controlsManager=t,this.animationControls=i,this.eventContext=r,this.sharedVariables=s,this.isEnabled=!1,this.activateCount=0,this.needsMouse=!1,this.needsRaycast=!1,this.onTouchMovePreventScroll=a=>{let n=window.parent!==window,o=document.documentElement.scrollHeight>document.documentElement.clientHeight||document.documentElement.scrollWidth>document.documentElement.clientWidth;(a.touches.length>1||this.preventTouchScroll||n===!1&&o===!1)&&a.preventDefault()},this.onMouseWheelPreventScroll=a=>{this.preventScroll&&a.preventDefault()},this.onMouseMove=a=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(a),pressed:a.buttons>0}},this.onMouseDown=a=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(a),pressed:!0}},this.onMouseUp=a=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(a),pressed:!1}},this.getMousePosition=a=>{var h;let{domRect:n}=this.eventContext,{pageX:o,pageY:l}=((h=a.touches)==null?void 0:h.length)>0?a.touches[0]:a;return{x:o-(n.left+window.scrollX),y:l-(n.top+window.scrollY)}},this.stopRaycast=e.stopRaycast,this.preventScroll=e.preventScroll,this.preventTouchScroll=e.preventTouchScroll,this.hideCursor=e.hideCursor,this.requestRender=r.requestRender}activate(e=!1){var r,s;if(this.isEnabled)return;this.isEnabled=!0,this.initializeActionsDependentStates(),this.needsMouse&&(this.eventContext.domElement.addEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.addEventListener("pointerdown",this.onMouseDown)),this.handlers={Spline:new FZ(this.eventContext),VariableChange:new mK(this.eventContext,this.sharedVariables,this,this.needsMouse,this.needsRaycast),API:new KK(this.eventContext,this),WEBHOOK:new $K(this.eventContext,this),AIAssistantListener:new nJ(this.eventContext,this),AIAssistantTrigger:new lJ(this.eventContext,this),Conditional:new HZ(this.eventContext,this),Start:new pK(this.eventContext,this),Basic:new UZ(this.eventContext,this,this.needsRaycast),MouseHover:new lK(this.eventContext,this),Scroll:new dK(this.eventContext,this),Follow:new eK(this.eventContext,this),DragDrop:new QZ(this.eventContext,this),LookAt:new aK(this.eventContext),Resize:new ZK(this.eventContext,this),Textfields:new aJ(this.eventContext,this)};let{page:t,domElement:i}=this.eventContext;this.hideCursor&&(i.style.cursor="none"),t.traverseEntity(a=>{a.addEventListener("requestRender",this.requestRender)}),Object.values(this.handlers).forEach(a=>a.connect()),i.addEventListener("wheel",this.onMouseWheelPreventScroll),i.addEventListener("touchmove",this.onTouchMovePreventScroll),this.activateCount++,e||((r=this.eventContext.sharedAssets.openAIRealtime)==null||r.connect(),(s=this.eventContext.sharedAssets.openAIRealtime)==null||s.start())}deactivate(e=!1){var r;if(!this.isEnabled)return;this.isEnabled=!1,this.eventContext.domElement.removeEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.removeEventListener("pointerdown",this.onMouseDown),this.eventContext.domElement.removeEventListener("pointerup",this.onMouseUp),this.eventContext.sharedAssets.mouseProperty=null,this.eventContext.sharedAssets.raycastProperty=null;let{page:t,domElement:i}=this.eventContext;if(i.style.cursor="",Object.values(this.handlers).forEach(s=>s.disconnect()),(r=this.controlsManager.gameControl)==null||r.disposeActions(),this.controlsManager.disconnectEvents(),t.traverseEntity(s=>{s.removeEventListener("requestRender",this.requestRender),s.destroyedInAction=!1}),i.removeEventListener("touchmove",this.onTouchMovePreventScroll),i.removeEventListener("wheel",this.onMouseWheelPreventScroll),this.animationControls.onExitPlayMode(),!e){let s=this.eventContext.sharedAssets.openAIRealtime;s==null||s.disconnect(),s==null||s.stop().then(()=>{s==null||s.disconnect()})}}get isPaused(){return this.isEnabled}pause(){this.deactivate()}resume(){this.activate()}reset(){this.deactivate(!0),this.activate(!0),this.controlsManager.deactivate(),this.controlsManager.page.updateMatrixWorld(!0),this.controlsManager.rebuildBVH()}updateUseWindowEvents(e){let t=this.isEnabled;t&&this.deactivate(),this.eventContext.useWindowEvents=e,t&&this.activate()}initializeActionsDependentStates(){let e=this.eventContext.sharedAssets;e.resetDynamicVariablePlayState();let t=i=>{if(i.data.type==="Conditional"&&(i.data.ifActions.forEach(t),i.data.elseActions.forEach(t)),i.data.type==="Conditional"||i.data.type==="SetVariable")for(let r of i.data.type==="Conditional"?i.data.condition:i.data.expression)"id"in r&&Array.isArray(r.id)&&(r.id[0]==="mouse"&&(this.needsMouse=!0),r.id[0]==="raycast"&&(this.needsRaycast=!0));i.data.type==="DynamicVariablePlay"&&i.data.variableId!==""&&(i.data.mode==="Play"||i.data.mode==="PlayPause"||i.data.mode==="Toggle")&&e.setDynamicVariablePlayState(i.data.variableId,"Stopped")};this.eventContext.page.traverseEntity(i=>{var r;if((r=i.data)!=null&&r.events.length)for(let s of i.data.events)if(s.data.type==="VariableChange"&&(s.data.variableId==="mouseProperty"&&(this.needsMouse=!0),s.data.variableId==="raycastProperty"&&(this.needsRaycast=!0)),s.data.type==="Conditional")for(let a of["inActions","outActions"])s.data[a].forEach(t);else if(s.data.type==="DragDrop")for(let a of["drag","drop"])s.data.dragDropActions[a].forEach(t);else if(s.data.type==="GameControl")for(let a of["idle","move","jump","run"])s.data.gameActions[a].forEach(t);else if(s.data.type==="Resize")for(let a of s.data.breakpoints)a.data.actions.forEach(t);else s.data.type==="LookAt"||s.data.type==="API"||s.data.actions.forEach(t)})}},dJ=class{constructor(e,t,i,r,s){this._aspect=1,this.enableResponsive=!1,this._renderer=e,this._camera=t,this._frameSize=new j().copy(i),this._editorSize=new j().copy(r),this._aspect=t.aspect,this._fov=s??t.fov}set frameSize(e){this._frameSize.copy(e)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||this._camera.cameraType!=="PerspectiveCamera")return;let e=this._frameSize.x,t=this._frameSize.y,i=this._editorSize.y;this._aspect=e/t,t<=i&&(this._camera.zoom*=i/t),this._renderer.setViewport(0,0,e,t)}updateCamera(e=!0){if(this._camera)if(this._camera.cameraType==="PerspectiveCamera"){let t=this._frameSize.y,i=this._editorSize.y,r=this._fov;if(e&&t>i){let s=uJ(t,1080,2160,1,15)/100;r*=t/i,r*=1-s}this._camera.aspect=this._aspect,this._camera.fov=r,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y,this.enableResponsive)}setCamera(e){this._camera=e,this._aspect=e.aspect,this._fov=e.fov}revert(){let e=window.innerWidth,t=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,e,t),this._renderer.setSize(e,t)),this._camera&&(this._camera.aspect=e/t,this._camera.fov=this._fov,this._camera.setViewplaneSize(e,t,this.enableResponsive),this._camera.updateProjectionMatrix())}};function uJ(e,t,i,r,s){return(e-t)/(i-t)*(s-r)+r}var pJ=class{get sharedAssets(){return this.shared}constructor(e,t={},i=!0){this.shared=new n5(e.shared,t,!0,i),this.scene=new b5(e.scene,this.sharedAssets),this.shared.setEntityOpContext({scene:this.scene,shared:this.shared})}reset(e,t){this.scene.clearScene(),this.sharedAssets.reset(e.shared),this.scene.resetAfterClear(e.scene,this.sharedAssets)}resetPersonalCameraFromDocumentData(){for(let e of this.scene.children)e instanceof Gi&&!e.uiScene&&e.personalCamera.updateState(e.data.camera,{scene:this.scene,shared:this.shared})}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity(e=>{e instanceof g1&&e.markGeometryAsReachable(this.shared)}),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},fJ=class{constructor({x:e=10,y:t=10}){this._startTime=0;let i=document.getElementById("spe-perfs");i?this.element=i:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left=`${e}px`,this.element.style.top=`${t}px`}dispose(){var e;(e=this.element.parentElement)==null||e.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let e=performance.now()-this._startTime;this.element.innerHTML=e.toFixed(3)+" ms"}};function mJ(e){let t;if(e.index)for(let i=0;i<e.index.array.length;i+=3)t=e.index.array[i],e.index.array[i]=e.index.array[i+2],e.index.array[i+2]=t}function I2(e){return e instanceof eh?"SubdivObject":e.geometry.type==="NonParametricGeometry"?"NonParametric":"Mesh"}function gJ(e,t){let i={};return e.traverseEntity(r=>{var l;if(!r.visible||!(r instanceof D1)||r.type!=="Mesh"||Array.isArray(r.material)||r.states&&Object.keys(r.states).length)return;let s=r.parent;for(;s;){if(s instanceof D1&&r.states&&Object.keys(r.states).length)return;s=s.parent}let a=r.material.uuid,n=t.shared.materials[a];if(n){if(!a1.isMergable(n))return}else{let h=(l=t.scene.objects.get(r.uuid))==null?void 0:l.data;if(h&&"material"in h&&typeof h.material!="string"){if(!a1.isMergable(h.material))return;a=a1.getHash(h.material)}}i[a]||(i[a]={});let o=i[a][I2(r)];if(o){if(o.push(r),r.cloner)for(let h of r.cloner.children)o.push(h)}else if(i[a][I2(r)]=[r],r.cloner)for(let h of r.cloner.children)i[a][I2(r)].push(h)}),i}function vJ(e){let t=0;return Object.values(e).forEach(i=>{Object.values(i).forEach(r=>{let s=r.length;s>t&&(t=s)})}),t}function yJ(e,t){let i=gJ(t,e),r=vJ(i),s=new Array(r),a=0,n=new Array(r),o=0,l=new Array(r),h=0,c=new Array(r),d=0;for(let[u,p]of Object.entries(i))for(let f of Object.values(p)){if(o=0,h=0,f.forEach(m=>{m instanceof D1&&(n[o++]=m.geometry.clone(),l[h++]=m)}),h<2)continue;for(let m=0;m<h;m++)l[m].updateWorldMatrix(!0,!1),n[m].applyMatrix4(l[m].matrixWorld),l[m].matrixWorld.determinant()<0&&mJ(n[m]);let g=An(n.slice(0,o),!1);if(g){let m;switch(u){case"SubdivObject":{m=new si(g,l[0].material);break}default:{m=new si(g,l[0].material);break}}m.castShadow=l[0].castShadow,m.receiveShadow=l[0].receiveShadow,t.add(m);let v=y=>{d=0;for(let x of y)x.children&&v(x.children),x instanceof D1&&(Array.isArray(x.material)||i[x.material.uuid]&&i[x.material.uuid][I2(x)]&&i[x.material.uuid][I2(x)].length>1||(c[d++]=x));for(let x=0;x<d;x++)t.attach(c[x])};for(let y=0;y<h;y++){let x=l[y];v(x.children),s[a++]=x}}}for(let u=0;u<a;u++)s[u].removeFromParent()}var xJ=aa(yS(),1),bJ=new j;function wJ(e){let t="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";e.endsWith(".spline")?t+"":e.endsWith(".splinecode")}var SJ=class{constructor(e,{renderOnDemand:t,renderMode:i="auto"}={}){this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._variablesCache=new Map,this._isPaused=!1,this._renderRequested=!1,this._skipRender=!1,this.time=performance.now(),this.dt=0,this.currentTAAFrame=0,this.disposed=!1,this._requestRenderAutoMode=()=>{this._skipRender=!1},this.requestRender=()=>{this._renderRequested=!0},this.render=r=>{var s,a,n,o,l,h,c,d,u,p,f,g,m;if(this.time=r,this._lastTime&&(this.dt=this.time-this._lastTime),this._lastTime=this.time,(s=this._perfs)==null||s.start(),!this._renderer){(a=this._perfs)==null||a.end();return}if(!this._isPaused&&(this.renderMode==="manual"&&!this._renderRequested||this.renderMode==="auto"&&this._skipRender)){(n=this._perfs)==null||n.end();return}if(this._renderRequested=!1,this._skipRender=!0,this._controls&&(this._skipRender=this._controls.update(this.dt)),this._eventManager&&((o=this._eventManager.handlers)!=null&&o.Start.hasVideoAction||(l=this._eventManager.handlers)!=null&&l.Basic.hasVideoAction||(h=this._eventManager.handlers)!=null&&h.Conditional.hasVideoAction)&&(this._skipRender=!1),(c=this._animationControls)==null||c.update(this.dt),this._skipRender?(this.currentTAAFrame++,this.currentTAAFrame<32?this._skipRender=!1:this.currentTAAFrame=0):this.currentTAAFrame=0,(d=this._scene)==null||d.traverseVisibleEntity(v=>{v.type==="ParticleSystem"&&(v.update(this.dt),this._skipRender=!1)}),this._scene&&this._scene.activeCamera!==this._camera&&(this._camera=this._scene.activeCamera),(u=this._eventManager)!=null&&u.isEnabled&&(((p=this._eventManager.handlers)==null?void 0:p.Follow).onAnimationFrameDamping(),((f=this._eventManager.handlers)==null?void 0:f.LookAt).onAnimationFrameDamping(),((g=this._eventManager.handlers)==null?void 0:g.DragDrop).onAnimationFrameDamping()),this._scene&&this._camera){if(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.sceneTransitionTimeRemaining>0){this._renderer.sceneTransitionTimeRemaining-=this.dt;let v=1-this._renderer.sceneTransitionTimeRemaining/this._renderer.sceneTransitionDuration;this._renderer.pipeline.sceneTransitionPass.uniforms.mixRatio.value=v,this._skipRender=!1}else this._renderer.pipeline.sceneTransitionFromTexture=null;this._renderer.renderSplineScene(this._scene,this._camera)}this.canvas.dispatchEvent(this._renderedEvent),(m=this._perfs)==null||m.end()},this._resize=r=>{var s,a,n,o,l,h,c,d,u,p;if(this._renderer){if(this._viewportMode===1&&this._frameView&&(this._frameView.frameSize=bJ.set(this._viewportWidth,this._viewportHeight)),r){let f=this._viewportWidth,g=this._viewportHeight;this._renderer.setSize(f-1,g-1,!1),this._renderer.setSize(f,g,!1)}else this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1);if(this._camera=(s=this._scene)==null?void 0:s.activeCamera,(c=this._scene)==null||c.updateViewPlaneSize(((n=(a=this._frameView)==null?void 0:a.frameSize)==null?void 0:n.x)??this._viewportWidth,((l=(o=this._frameView)==null?void 0:o.frameSize)==null?void 0:l.y)??this._viewportHeight,((h=this._frameView)==null?void 0:h.enableResponsive)??!1),this._camera){let f=Object.values(((d=this._data)==null?void 0:d.frames)??{})[0].preset??"fullscreen";(u=this._frameView)==null||u.setCamera(this._camera),(p=this._frameView)==null||p.updateCamera(f!=="fullscreen"),this._camera.cameraType==="PerspectiveCamera"&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()}this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect()),this._requestRenderAutoMode()}},this._debouncedResize=V2(this._resize,10),this._onScroll=r=>{this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect())},this.canvas=e,this.renderMode=t?"auto":i,this._renderedEvent=new CustomEvent("rendered",{bubbles:!0}),Object.defineProperty(this._renderedEvent,"target",{writable:!1,value:this}),window.location.search.includes("perfs")&&(this._perfs=new fJ({x:10,y:10})),xk(e)}async load(e,t,i){wJ(e),this.disposed=!1;let r=await(await fetch(e,i)).arrayBuffer();await this.start(r,{variables:t})}async start(e,{interactive:t=!0,variables:i}={}){var l,h,c,d;if(this.disposed)return;let r=await WK(e);this._data=r;let s=qK(r);r.version&&(0,xJ.default)(r.version,"1.9.37")>0,await Promise.all([s.length&&GK(),x8(r)&&yj(),OH(r)&&fj(),q2.physicsEnabled(r.scene.objects)&&Ak(),m8(r)&&$G(),Q8(r)&&zX(),KG(r)&&ZG(),N8(r)&&PY(),CK(r)&&Sk()].filter(Boolean)),s.length&&await YK(s),(l=this._eventManager)==null||l.deactivate(),(h=this._controls)==null||h.deactivate(),(c=this._scene)==null||c.dispose();let a=new pJ(r);if(a.resetPersonalCameraFromDocumentData(),this._scene=a.scene,this._sharedAssetsManager=a.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let u=performance.now();yJ(r,a.scene),performance.now()-u}x8(r)&&this._scene.traverse(u=>{Xs(u)&&u.recomputeBoolean()}),this._sharedAssetsManager.setRequestRender(()=>{var u;this._requestRenderAutoMode(),(u=this._scene)==null||u.traverse(p=>{p instanceof Pr&&p.pendingMediaLoad&&p.update()})}),(d=this._scene)==null||d.traverse(u=>{u.type==="ParticleSystem"&&(u.wakeUp(),u.data.autoPlay?u.start():u.stop())});let n=Object.keys(r.shared.fonts).map(u=>this._sharedAssetsManager.getFont(u).loadingPromise);if(Promise.all(n).then(()=>{a.scene.markNeedsUpdateRendererDirty(),this._requestRenderAutoMode()}),m8(r)&&FK(r)&&await Promise.all(n),N8(r)){let u=[];this._scene.traverseEntity(p=>{(p instanceof p1||p instanceof Gi)&&p.uiCanvas&&u.push(p.uiCanvas)}),await Promise.all(u.map(p=>p.promise))}if(this._scene.rewriteEventsBeforeGoToPlayMode(),R5(this._scene.activePage,this._sharedAssetsManager),!this._renderer&&(this._renderer=new mY({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.hdTransmission=r.scene.publish.hdTransmission===!0,this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.pipeline.enableUIOverlay(),this._renderer.pipeline.addEventListener("smaaloaded",this._requestRenderAutoMode),r.shared.images.SplineWatermark)){let u=this._sharedAssetsManager.getImage("SplineWatermark");await u.loadPromise;let p=u.getTexture(1001);this._renderer.pipeline.setWatermark(p)}Q8(r)&&this._scene.initializeSplatViewer(),r.scene.blueNoiseTextureData!==void 0&&this._renderer.pipeline.updateBlueNoiseTexture(r.scene.blueNoiseTextureData);let o=Object.values(r.frames)[0];if(this._frameView?this._frameView.setCamera(this._camera):(o.preset==="fullscreen"?(this._viewportMode=1,this.canvas.style.display="block",this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=o.size[0],this._viewportHeight=o.size[1],this.canvas.style.width=`${this._viewportWidth}px`,this.canvas.style.height=`${this._viewportHeight}px`),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new dJ(this._renderer,this._camera,new j(this._viewportWidth,this._viewportHeight),new j(window.innerWidth,window.innerHeight)),this._frameView.enableResponsive=(o.allowResponsive??!1)&&o.preset==="fullscreen"),t){let u=new BZ(this._renderer,this.data.scene.publish,this._scene,()=>this._scene.activeCamera,this._sharedAssetsManager,this._requestRenderAutoMode,!0,o);this._scene.updateMatrixWorld(!0),this._controls=new kK(u),this._animationControls=new NK(this._scene,this._requestRenderAutoMode),this._eventManager=new cJ(r.scene.publish,this._controls,this._animationControls,u,r.shared.variables),this._eventManager.activate(),this._controls.activate(this._eventManager)}this._resize(),this._scene.activePage.data.postprocessing.depthOfField.enabled&&Promise.all(this._sharedAssetsManager.getImageLoadPromises()).then(()=>{this._resize(!0)}),i!==void 0&&this.setVariables(i),this.dt===0&&(this.render(performance.now()),setTimeout(()=>{var u;(u=this._renderer)==null||u.setAnimationLoop(this.render)},0)),this._resizeObserverTimeout=setTimeout(()=>{!this._resizeObserver&&this.canvas.parentElement&&(this._resizeObserver=new ResizeObserver(()=>{this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._debouncedResize()}),this._resizeObserver.observe(this.canvas.parentElement))},300),document.addEventListener("scroll",this._onScroll)}setVariables(e){if(this._data!==void 0){let t=Object.entries(e);for(let[i,r]of t)this.setVariable(i,r)}}setVariable(e,t){var r;let i=this._getVariableByName(e);if(i&&!("dynamicVariableType"in i.data)){let s=t;typeof i.data.value=="number"?s=typeof t=="number"?t:typeof t=="boolean"?t===!0?1:0:parseFloat(t):typeof i.data.value=="boolean"?s=typeof t=="number"?!!t:typeof t=="boolean"?t:t.toLocaleLowerCase()==="false"?!1:!!t:typeof i.data.value!="string"&&i.data.value.textValue!==void 0&&(s=t.toString());let a=typeof s=="string"?{textValue:s}:s;(r=this._sharedAssetsManager)==null||r.updateVariable(i.id,a),this.requestRender(),this._requestRenderAutoMode()}else i===void 0?`${e}`:"dynamicVariableType"in i.data&&`${e}`}getVariables(){let e={};return this._data&&this._data.shared.variables.forEach(t=>{e[t.data.name]===void 0&&(e[t.data.name]=this._getVariableValue(this._sharedAssetsManager.getVariable(t.id)))}),e}getVariable(e){let t=this._getVariableByName(e);if(t){let i=this._sharedAssetsManager.getVariable(t.id);return this._getVariableValue(i)}}_getVariableValue(e){return typeof e!="string"&&n1.isTextValue(e)?n1.getDisplayedValue(e):e}_getVariableByName(e){if(this._data){if(this._variablesCache.has(e))return this._variablesCache.get(e);let t=this._data.shared.variables.find(i=>i.data.name===e);return t&&this._variablesCache.set(e,t),t}}findObjectById(e){var i;let t=(i=this._scene)==null?void 0:i.getObjectByProperty("uuid",e);return this._createProxyObject(t)}findObjectByName(e){var i;let t=(i=this._scene)==null?void 0:i.getObjectByName(e);return this._createProxyObject(t)}getAllObjects(){var t;let e=[];return(t=this._scene)==null||t.traverseEntity(i=>{if(i.uuid!==Tl&&!this._scene.isInvisibleObjects(i)&&!(i instanceof Gi)){let r=this._createProxyObject(i);r&&e.push(r)}}),e}getSplineEvents(){var e,t;return((t=(e=this._eventManager)==null?void 0:e.handlers)==null?void 0:t.Spline).splineEvents}emitEvent(e,t){var i;(i=this.findObjectById(t)||this.findObjectByName(t))==null||i.emitEvent(e)}emitEventReverse(e,t){var i;(i=this.findObjectById(t)||this.findObjectByName(t))==null||i.emitEventReverse(e)}addEventListener(e,t){this.canvas.addEventListener(e,t)}removeEventListener(e,t){this.canvas.removeEventListener(e,t)}setZoom(e){var t,i;((t=this._controls)==null?void 0:t.orbitControls)instanceof Kw&&((i=this._controls)==null||i.orbitControls.setZoom(e))}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(e,t){this._viewportWidth=e,this._viewportHeight=t,this._viewportMode=2,this._resize()}setBackgroundColor(e){var n;let{r:t,g:i,b:r,a:s}={r:0,g:0,b:0,a:1},a=new o1(t,i,r,s);try{a.setStyle(e)}catch{}(n=this._scene)==null||n.activePage.setBackgroundColor(a),this._requestRenderAutoMode()}dispose(){var e,t,i,r,s,a,n;this.disposed=!0,(e=this._eventManager)==null||e.deactivate(),(t=this._scene)==null||t.dispose(),(i=this._sharedAssetsManager)==null||i.dispose(),this._proxyObjectCache.forEach(o=>{b6.unsubscribe(o)}),this._variablesCache.clear(),(r=this._renderer)==null||r.setAnimationLoop(null),(s=this._renderer)==null||s.dispose(),this._renderer=void 0,(a=this._sharedAssetsManager)==null||a.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),this._resizeObserverTimeout!==void 0&&clearTimeout(this._resizeObserverTimeout),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),(n=this._controls)==null||n.deactivate(),this.dt=0,bk(this.canvas),document.removeEventListener("scroll",this._onScroll)}get isStopped(){return this._isPaused}stop(){var e,t,i;this._isPaused||((e=this._renderer)==null||e.setAnimationLoop(null),this._isPaused=!0,(t=this._eventManager)==null||t.pause(),(i=this._controls)!=null&&i.orbitControls&&(this._controls.orbitControls.enabled=!1))}play(){var e,t,i;!this._isPaused||(this._isPaused=!1,(e=this._eventManager)==null||e.resume(),(t=this._controls)!=null&&t.orbitControls&&(this._controls.orbitControls.enabled=!0),(i=this._renderer)==null||i.setAnimationLoop(this.render))}setGlobalEvents(e){var t;(t=this._eventManager)==null||t.updateUseWindowEvents(e)}get data(){return this._data}_createProxyObject(e){var s;if(e==null)return;if(this._proxyObjectCache.has(e.uuid))return this._proxyObjectCache.get(e.uuid);let t;e.traverseAncestors(a=>{a instanceof Gi&&(t=a.name)});let i={name:e.name,uuid:e.uuid,visible:e.visible,intensity:e.intensity,position:e.position,rotation:e.rotation,scale:e.scale,type:e.data.type,page:t,parentUuid:e.parent instanceof Gi||e instanceof b5||(s=e.parent)==null?void 0:s.uuid,emitEvent(a){e.dispatchEvent({type:"userEvent",eventName:a})},emitEventReverse(a){e.dispatchEvent({type:"userEvent",eventName:a,reverse:!0})}},r=b6(i,(a,n)=>{var o;typeof e[a]!="object"&&((o=Object.getOwnPropertyDescriptor(e,a))!=null&&o.writable)&&(e[a]=n),this._requestRenderAutoMode(),e.updateMatrix()});return this._proxyObjectCache.set(e.uuid,r),r}setUIWasmUrl(e){bb.skiaWasmUrl=e}};const AJ=$w({__name:"spline",props:{scene:{type:ArrayBuffer,default:[]},timeout:{type:Number,default:0}},setup(e,{expose:t}){const i=e,r=B5(null),s=B5(null);return eS(()=>{const S=()=>{r.value&&(s.value=new SJ(r.value),s.value.start(i.scene))};if(i.timeout>0){const M=setTimeout(()=>{S(),clearTimeout(M)},i.timeout)}else S()}),t({spline:s,play:()=>{var S;return(S=s.value)==null?void 0:S.play()},pause:()=>{var S;return(S=s.value)==null?void 0:S.stop()},stop:()=>{var S;return(S=s.value)==null?void 0:S.stop()},setVariables:S=>{var M;return(M=s.value)==null?void 0:M.setVariables(S)},setVariable:(S,M)=>{var C;return(C=s.value)==null?void 0:C.setVariable(S,M)},getVariables:()=>{var S;return(S=s.value)==null?void 0:S.getVariables()},getVariable:S=>{var M;return(M=s.value)==null?void 0:M.getVariable(S)},setBackgroundColor:S=>{var M;return(M=s.value)==null?void 0:M.setBackgroundColor(S)},getAllObjects:()=>{var S;return(S=s.value)==null?void 0:S.getAllObjects()},getSplineEvents:()=>{var S;return(S=s.value)==null?void 0:S.getSplineEvents()},setZoom:S=>{var M;return(M=s.value)==null?void 0:M.setZoom(S)},setSize:(S,M)=>{var C;return(C=s.value)==null?void 0:C.setSize(S,M)},findObjectById:S=>{var M;return(M=s.value)==null?void 0:M.findObjectById(S)},findObjectByName:S=>{var M;return(M=s.value)==null?void 0:M.findObjectByName(S)},emitEvent:(S,M)=>{var C;return(C=s.value)==null?void 0:C.emitEvent(S,M)},emitEventReverse:(S,M)=>{var C;return(C=s.value)==null?void 0:C.emitEventReverse(S,M)},addEventListener:(S,M)=>{var C;return(C=s.value)==null?void 0:C.addEventListener(S,M)},removeEventListener:(S,M)=>{var C;return(C=s.value)==null?void 0:C.removeEventListener(S,M)}}),(S,M)=>(tS(),iS("canvas",rS({ref_key:"canvasRef",ref:r},i),null,16))}}),MJ=[212,114,64,149,166,115,99,104,101,109,97,165,115,99,101,110,101,166,102,114,97,109,101,115,166,115,104,97,114,101,100,167,118,101,114,115,105,111,110,204,115,212,114,65,147,167,111,98,106,101,99,116,115,167,112,117,98,108,105,115,104,166,115,116,121,108,101,115,212,3,0,145,212,114,66,148,162,102,105,162,105,100,164,100,97,116,97,168,99,104,105,108,100,114,101,110,1,217,36,97,50,49,56,102,99,99,51,45,50,55,54,98,45,52,57,98,57,45,98,52,56,53,45,52,57,48,51,55,102,100,49,52,102,53,102,212,114,67,220,0,22,164,116,121,112,101,166,115,116,97,116,101,115,166,101,118,101,110,116,115,167,118,105,115,105,98,108,101,171,114,97,121,99,97,115,116,76,111,99,107,167,112,104,121,115,105,99,115,172,112,97,116,104,83,110,97,112,112,105,110,103,168,112,111,115,105,116,105,111,110,168,114,111,116,97,116,105,111,110,165,115,99,97,108,101,172,104,105,100,100,101,110,77,97,116,114,105,120,166,99,108,111,110,101,114,175,98,97,99,107,103,114,111,117,110,100,67,111,108,111,114,174,112,111,115,116,112,114,111,99,101,115,115,105,110,103,163,102,111,103,173,103,108,111,98,97,108,80,104,121,115,105,99,115,167,97,109,98,105,101,110,116,162,97,111,166,115,104,97,100,111,119,167,112,117,98,108,105,115,104,166,99,97,109,101,114,97,164,110,97,109,101,164,80,97,103,101,214,105,0,0,0,14,212,2,0,144,214,105,0,0,0,15,212,2,0,144,195,194,212,114,68,156,167,101,110,97,98,108,101,100,169,102,117,115,101,100,66,111,100,121,169,114,105,103,105,100,66,111,100,121,167,100,101,110,115,105,116,121,169,112,111,105,110,116,77,97,115,115,172,103,114,97,118,105,116,121,83,99,97,108,101,168,102,114,105,99,116,105,111,110,167,100,97,109,112,105,110,103,171,114,101,115,116,105,116,117,116,105,111,110,172,99,111,108,108,105,100,101,114,84,121,112,101,175,101,110,97,98,108,101,100,82,111,116,97,116,105,111,110,178,101,110,97,98,108,101,100,84,114,97,110,115,108,97,116,105,111,110,170,118,105,115,105,98,105,108,105,116,121,194,170,112,111,115,105,116,105,111,110,101,100,1,0,1,203,63,224,0,0,0,0,0,0,0,203,63,201,153,153,153,153,153,154,166,99,111,110,118,101,120,214,105,0,0,0,16,147,195,195,195,214,105,0,0,0,17,147,195,195,195,214,105,0,0,0,18,212,114,69,148,166,112,97,116,104,73,100,165,115,108,105,100,101,166,111,102,102,115,101,116,171,111,114,105,101,110,116,97,116,105,111,110,192,0,0,170,116,97,110,103,101,110,116,105,97,108,147,0,0,0,214,105,0,0,0,19,147,0,0,0,214,105,0,0,0,20,147,1,1,1,214,105,0,0,0,21,220,0,16,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,192,212,114,70,150,167,105,115,67,111,108,111,114,161,114,161,103,161,98,168,105,115,67,111,108,111,114,65,161,97,195,203,63,180,68,89,121,201,82,8,203,63,180,68,89,121,201,82,8,203,63,180,68,89,121,201,82,8,195,0,212,114,71,153,167,101,110,97,98,108,101,100,170,112,105,120,101,108,97,116,105,111,110,165,98,108,111,111,109,179,99,104,114,111,109,97,116,105,99,65,98,101,114,114,97,116,105,111,110,168,118,105,103,110,101,116,116,101,173,104,117,101,83,97,116,117,114,97,116,105,111,110,178,98,114,105,103,104,116,110,101,115,115,67,111,110,116,114,97,115,116,172,100,101,112,116,104,79,102,70,105,101,108,100,165,110,111,105,115,101,194,212,114,72,148,167,111,112,97,99,105,116,121,173,98,108,101,110,100,70,117,110,99,116,105,111,110,167,101,110,97,98,108,101,100,171,103,114,97,110,117,108,97,114,105,116,121,1,16,194,15,212,114,73,152,167,111,112,97,99,105,116,121,173,98,108,101,110,100,70,117,110,99,116,105,111,110,167,101,110,97,98,108,101,100,169,105,110,116,101,110,115,105,116,121,169,98,108,117,114,83,99,97,108,101,178,108,117,109,105,110,97,110,99,101,84,104,114,101,115,104,111,108,100,178,108,117,109,105,110,97,110,99,101,83,109,111,111,116,104,105,110,103,170,107,101,114,110,101,108,83,105,122,101,1,16,194,1,1,203,63,208,0,0,0,0,0,0,203,63,153,153,153,153,153,153,154,3,212,114,74,148,167,111,112,97,99,105,116,121,173,98,108,101,110,100,70,117,110,99,116,105,111,110,167,101,110,97,98,108,101,100,166,111,102,102,115,101,116,1,13,194,146,2,2,212,114,75,149,167,111,112,97,99,105,116,121,173,98,108,101,110,100,70,117,110,99,116,105,111,110,167,101,110,97,98,108,101,100,168,100,97,114,107,110,101,115,115,166,111,102,102,115,101,116,1,13,194,1,0,212,114,76,149,167,111,112,97,99,105,116,121,173,98,108,101,110,100,70,117,110,99,116,105,111,110,167,101,110,97,98,108,101,100,163,104,117,101,170,115,97,116,117,114,97,116,105,111,110,1,13,194,3,0,212,114,77,149,167,111,112,97,99,105,116,121,173,98,108,101,110,100,70,117,110,99,116,105,111,110,167,101,110,97,98,108,101,100,170,98,114,105,103,104,116,110,101,115,115,168,99,111,110,116,114,97,115,116,1,13,194,203,63,208,0,0,0,0,0,0,0,212,114,78,150,167,111,112,97,99,105,116,121,173,98,108,101,110,100,70,117,110,99,116,105,111,110,167,101,110,97,98,108,101,100,171,102,111,99,97,108,76,101,110,103,116,104,173,102,111,99,117,115,68,105,115,116,97,110,99,101,170,98,111,107,101,104,83,99,97,108,101,1,13,194,20,204,100,5,212,114,79,147,167,111,112,97,99,105,116,121,173,98,108,101,110,100,70,117,110,99,116,105,111,110,167,101,110,97,98,108,101,100,1,16,194,212,114,80,149,167,101,110,97,98,108,101,100,178,117,115,101,66,97,99,107,103,114,111,117,110,100,67,111,108,111,114,165,99,111,108,111,114,164,110,101,97,114,163,102,97,114,194,194,212,114,81,147,161,114,161,103,161,98,1,1,1,203,63,185,153,153,153,153,153,154,205,7,208,212,114,82,146,170,117,115,101,80,104,121,115,105,99,115,167,103,114,97,118,105,116,121,194,246,212,114,83,147,167,101,110,97,98,108,101,100,165,99,111,108,111,114,169,105,110,116,101,110,115,105,116,121,195,81,203,63,234,122,122,122,122,122,122,203,63,234,122,122,122,122,122,122,203,63,234,122,122,122,122,122,122,203,63,232,0,0,0,0,0,0,212,114,84,149,169,111,99,99,108,117,115,105,111,110,169,97,111,70,117,108,108,82,101,115,166,114,97,100,105,117,115,164,98,105,97,115,167,97,111,67,111,108,111,114,194,194,205,1,0,203,63,224,0,0,0,0,0,0,81,203,63,201,25,25,25,25,25,26,203,63,201,25,25,25,25,25,26,203,63,201,25,25,25,25,25,26,212,114,85,145,177,115,111,102,116,83,104,97,100,111,119,81,117,97,108,105,116,121,163,108,111,119,212,114,86,146,170,112,108,97,121,67,97,109,101,114,97,177,103,97,109,101,67,111,110,116,114,111,108,79,98,106,101,99,116,175,112,101,114,115,111,110,97,108,32,99,97,109,101,114,97,192,212,114,87,220,0,18,166,115,116,97,116,101,115,166,101,118,101,110,116,115,167,118,105,115,105,98,108,101,171,114,97,121,99,97,115,116,76,111,99,107,167,112,104,121,115,105,99,115,172,112,97,116,104,83,110,97,112,112,105,110,103,168,112,111,115,105,116,105,111,110,168,114,111,116,97,116,105,111,110,165,115,99,97,108,101,172,104,105,100,100,101,110,77,97,116,114,105,120,166,99,108,111,110,101,114,163,102,97,114,164,116,121,112,101,171,112,101,114,115,112,101,99,116,105,118,101,172,111,114,116,104,111,103,114,97,112,104,105,99,162,117,112,177,105,115,85,112,86,101,99,116,111,114,70,108,105,112,112,101,100,172,116,97,114,103,101,116,79,102,102,115,101,116,144,144,195,194,68,170,118,105,115,105,98,105,108,105,116,121,195,170,112,111,115,105,116,105,111,110,101,100,1,0,1,203,63,224,0,0,0,0,0,0,0,203,63,201,153,153,153,153,153,154,166,99,111,110,118,101,120,147,195,195,195,147,195,195,195,69,192,0,0,170,116,97,110,103,101,110,116,105,97,108,147,203,64,25,29,196,67,195,147,40,203,64,15,153,197,197,130,167,147,203,64,144,52,145,241,77,186,219,147,0,0,0,147,1,1,1,220,0,16,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,192,206,0,1,134,160,178,79,114,116,104,111,103,114,97,112,104,105,99,67,97,109,101,114,97,212,114,88,147,164,110,101,97,114,163,102,111,118,164,122,111,111,109,204,70,45,1,212,114,89,146,164,110,101,97,114,164,122,111,111,109,210,255,254,121,96,203,63,245,196,23,173,35,105,100,147,0,1,0,194,205,3,232,167,83,99,101,110,101,32,49,146,66,203,191,248,32,254,67,109,161,100,217,36,101,98,53,54,49,52,50,97,45,48,102,98,49,45,52,50,102,54,45,56,100,49,99,45,102,100,57,98,98,54,57,48,98,55,51,54,212,114,90,157,164,116,121,112,101,166,115,116,97,116,101,115,166,101,118,101,110,116,115,167,118,105,115,105,98,108,101,171,114,97,121,99,97,115,116,76,111,99,107,167,112,104,121,115,105,99,115,172,112,97,116,104,83,110,97,112,112,105,110,103,168,112,111,115,105,116,105,111,110,168,114,111,116,97,116,105,111,110,165,115,99,97,108,101,172,104,105,100,100,101,110,77,97,116,114,105,120,166,99,108,111,110,101,114,164,110,97,109,101,165,69,109,112,116,121,212,2,0,144,212,2,0,144,195,194,214,105,0,0,0,6,68,170,118,105,115,105,98,105,108,105,116,121,195,170,112,111,115,105,116,105,111,110,101,100,1,0,1,203,63,224,0,0,0,0,0,0,0,203,63,201,153,153,153,153,153,154,166,99,111,110,118,101,120,147,195,195,195,147,195,195,195,214,105,0,0,0,7,69,192,0,0,170,116,97,110,103,101,110,116,105,97,108,147,0,0,0,147,0,203,64,66,87,174,103,41,163,120,203,192,50,118,242,236,29,141,108,147,1,1,1,220,0,16,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,192,164,108,111,103,111,146,66,203,191,241,121,6,158,35,211,152,217,36,102,54,100,56,53,51,100,48,45,55,100,99,53,45,52,57,53,97,45,97,100,49,55,45,97,99,53,99,53,53,57,102,57,52,97,100,212,114,91,220,0,20,164,110,97,109,101,166,115,116,97,116,101,115,166,101,118,101,110,116,115,167,118,105,115,105,98,108,101,171,114,97,121,99,97,115,116,76,111,99,107,167,112,104,121,115,105,99,115,172,112,97,116,104,83,110,97,112,112,105,110,103,168,112,111,115,105,116,105,111,110,168,114,111,116,97,116,105,111,110,165,115,99,97,108,101,172,104,105,100,100,101,110,77,97,116,114,105,120,166,99,108,111,110,101,114,164,116,121,112,101,171,102,108,97,116,83,104,97,100,105,110,103,169,119,105,114,101,102,114,97,109,101,164,115,105,100,101,170,99,97,115,116,83,104,97,100,111,119,173,114,101,99,101,105,118,101,83,104,97,100,111,119,168,103,101,111,109,101,116,114,121,169,109,97,116,101,114,105,97,108,115,164,76,105,110,101,212,2,0,145,212,114,92,147,162,102,105,162,105,100,164,100,97,116,97,203,63,220,155,167,53,130,250,16,217,36,98,102,52,99,99,57,51,97,45,102,51,49,100,45,52,52,57,56,45,57,101,49,57,45,55,51,52,100,102,97,99,56,100,101,97,56,212,114,93,148,164,110,97,109,101,168,103,101,111,109,101,116,114,121,168,114,111,116,97,116,105,111,110,169,109,97,116,101,114,105,97,108,115,165,83,116,97,116,101,212,114,94,144,147,0,205,1,104,0,145,212,114,95,145,166,108,97,121,101,114,115,212,6,0,94,212,2,0,145,92,203,63,227,212,212,226,9,192,226,217,36,50,101,53,97,48,52,101,49,45,54,48,100,98,45,52,99,52,50,45,56,51,99,52,45,56,56,56,49,51,48,51,98,56,101,53,98,212,114,96,147,164,116,121,112,101,168,100,105,115,97,98,108,101,100,167,97,99,116,105,111,110,115,165,83,116,97,114,116,194,212,2,0,145,92,203,63,226,201,170,117,233,97,224,217,36,49,101,101,101,99,54,98,99,45,99,50,99,101,45,52,97,102,56,45,57,97,56,48,45,57,49,52,57,101,97,99,48,48,100,99,52,212,114,97,152,164,116,121,112,101,167,114,117,110,77,111,100,101,166,111,98,106,101,99,116,166,116,119,101,101,110,115,166,114,101,112,101,97,116,165,100,101,108,97,121,174,100,101,108,97,121,68,105,114,101,99,116,105,111,110,169,100,105,114,101,99,116,105,111,110,170,84,114,97,110,115,105,116,105,111,110,164,79,110,99,101,217,36,102,54,100,56,53,51,100,48,45,55,100,99,53,45,52,57,53,97,45,97,100,49,55,45,97,99,53,99,53,53,57,102,57,52,97,100,212,2,0,146,212,114,98,147,162,105,100,164,100,97,116,97,162,102,105,217,36,99,52,54,57,49,97,54,102,45,50,54,97,55,45,52,102,51,56,45,97,49,98,56,45,99,101,52,55,57,53,99,56,51,98,51,53,212,114,99,151,165,115,116,97,116,101,166,114,101,112,101,97,116,165,100,101,108,97,121,174,100,101,108,97,121,68,105,114,101,99,116,105,111,110,169,100,105,114,101,99,116,105,111,110,168,100,117,114,97,116,105,111,110,166,101,97,115,105,110,103,192,255,0,170,115,116,97,114,116,45,111,110,99,101,166,110,111,114,109,97,108,205,3,232,4,10,98,217,36,49,100,55,53,99,52,102,100,45,49,52,55,49,45,52,98,52,50,45,98,101,48,56,45,99,51,99,48,56,57,49,98,54,48,52,55,99,217,36,98,102,52,99,99,57,51,97,45,102,51,49,100,45,52,52,57,56,45,57,101,49,57,45,55,51,52,100,102,97,99,56,100,101,97,56,0,0,170,115,116,97,114,116,45,111,110,99,101,166,110,111,114,109,97,108,205,23,112,0,11,0,0,170,115,116,97,114,116,45,111,110,99,101,166,110,111,114,109,97,108,195,194,68,170,118,105,115,105,98,105,108,105,116,121,195,170,112,111,115,105,116,105,111,110,101,100,1,0,1,203,63,224,0,0,0,0,0,0,0,203,63,201,153,153,153,153,153,154,166,99,111,110,118,101,120,147,195,195,195,147,195,195,195,69,192,0,0,170,116,97,110,103,101,110,116,105,97,108,147,203,64,19,221,159,251,206,66,96,203,64,36,3,124,11,136,202,16,203,64,18,0,0,0,0,0,0,147,0,0,0,147,1,1,1,220,0,16,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,192,164,77,101,115,104,194,194,0,195,195,212,114,100,150,164,116,121,112,101,165,119,105,100,116,104,166,104,101,105,103,104,116,165,100,101,112,116,104,172,115,117,98,100,105,118,105,115,105,111,110,115,164,100,97,116,97,181,78,111,110,80,97,114,97,109,101,116,114,105,99,71,101,111,109,101,116,114,121,203,64,115,239,133,0,0,0,0,203,64,119,130,60,64,0,0,0,9,0,212,114,101,146,170,97,116,116,114,105,98,117,116,101,115,165,100,114,97,99,111,94,220,3,59,204,68,204,82,204,65,204,67,204,79,2,2,1,1,0,0,0,204,110,208,200,1,1,208,199,1,20,4,59,7,13,204,68,204,85,21,6,204,120,14,54,204,111,208,149,208,183,237,208,182,204,117,208,173,55,208,160,237,208,159,204,126,208,173,208,214,208,218,204,109,208,173,7,204,82,208,129,208,170,208,173,208,207,3,208,133,208,170,208,173,204,125,208,160,208,148,204,90,208,219,22,208,133,204,122,208,211,42,208,222,231,208,169,204,84,208,158,204,82,208,162,208,168,62,208,170,5,208,141,204,71,225,208,139,18,0,208,128,2,208,128,204,112,208,158,37,208,152,208,148,248,11,204,88,204,83,208,164,15,249,37,204,103,208,212,208,153,208,151,226,208,208,245,208,150,204,83,251,236,255,208,133,40,208,198,50,208,207,208,210,208,213,204,104,208,181,53,235,204,76,208,217,208,191,208,130,2,255,0,0,0,1,0,1,0,9,3,0,0,2,1,1,9,3,0,1,3,1,1,1,0,15,3,204,105,6,208,148,41,1,208,148,208,148,208,148,7,208,148,208,145,7,208,209,5,17,18,204,117,17,208,169,4,40,208,189,208,161,204,88,61,204,107,56,204,127,208,144,255,24,208,156,208,193,208,204,208,151,19,249,208,171,204,101,58,37,204,110,204,98,204,126,204,80,62,204,119,244,54,49,208,143,204,98,204,114,33,204,92,204,89,208,201,204,103,208,170,204,95,208,131,204,68,54,0,0,49,0,0,208,192,208,195,16,2,0,0,204,98,1,0,204,120,208,216,15,208,159,17,0,208,132,53,208,168,30,208,198,40,19,9,204,98,208,130,204,85,208,168,0,208,192,40,7,9,0,204,118,208,166,204,88,2,0,208,190,204,90,204,74,15,208,211,208,135,40,244,48,204,127,208,168,204,66,15,204,115,208,135,36,4,0,208,135,8,204,68,15,227,208,135,51,4,0,208,131,28,208,192,1,0,24,226,3,208,196,208,196,204,116,204,76,208,136,225,204,126,204,106,48,0,208,152,37,58,27,0,204,96,208,171,204,73,9,0,204,120,246,23,0,18,42,208,128,24,0,0,240,208,176,208,215,238,2,208,192,208,177,36,208,187,0,204,64,208,219,204,113,208,181,16,208,195,208,205,208,132,204,78,208,136,33,204,102,250,38,0,208,192,204,127,204,114,204,97,0,204,96,48,1,0,0,224,204,117,204,105,0,20,204,114,204,74,9,49,2,208,192,208,164,4,0,204,93,208,151,6,0,14,249,208,164,4,0,208,186,208,153,208,190,61,12,208,128,233,204,123,1,204,72,208,131,6,204,125,0,208,128,46,17,204,75,1,208,128,204,93,208,150,42,33,204,70,208,189,249,208,148,0,208,128,0,1,32,204,118,4,237,208,128,208,195,208,196,204,74,0,208,128,44,204,77,9,0,208,206,208,178,208,147,0,204,64,55,251,55,0,208,128,208,150,208,168,4,49,204,95,208,185,204,73,0,204,64,204,64,0,16,204,119,204,112,204,67,22,2,208,128,208,218,204,101,11,6,0,208,214,208,194,204,74,4,0,208,171,204,81,208,136,13,0,204,96,204,68,208,162,227,1,208,128,204,90,204,106,241,208,135,225,33,23,208,135,24,29,208,218,22,0,204,78,204,78,15,0,208,192,236,28,7,0,204,112,242,204,123,0,208,128,208,212,204,96,63,12,208,203,46,16,204,98,228,247,232,31,208,166,63,18,204,64,0,208,128,208,218,208,191,25,0,208,128,48,33,4,0,204,106,253,208,190,0,208,128,38,204,69,4,0,204,85,204,87,235,204,97,208,169,208,182,22,208,196,46,204,85,251,0,204,96,27,208,130,17,0,240,208,130,204,98,4,0,208,204,29,208,158,1,0,208,176,208,130,208,149,0,204,64,233,204,98,4,0,208,152,2,208,140,0,204,64,204,66,208,198,204,121,208,152,35,204,92,28,208,136,208,153,204,89,204,91,0,42,204,122,12,2,0,60,204,77,231,2,0,208,170,225,204,84,0,208,128,208,188,250,29,0,204,104,204,76,204,89,15,0,204,104,208,212,208,158,1,208,192,204,120,208,169,204,64,0,208,160,204,76,204,120,12,0,208,200,44,20,16,208,211,204,120,208,159,249,48,233,30,2,24,204,74,204,66,2,0,0,0,0,0,255,63,0,0,40,204,124,31,208,195,226,17,60,208,195,0,0,208,144,208,192,226,17,208,188,204,67,14,0,3,1,1,5,208,193,7,29,56,247,204,68,32,32,7,204,68,3,204,68,208,219,208,132,204,111,32,47,204,100,255,208,211,32,208,223,32,27,32,15,204,68,204,111,204,100,255,243,13,1,208,132,255,239,32,32,32,204,103,204,68,204,75,32,204,111,32,204,75,32,3,32,255,15,32,208,187,204,100,204,68,47,32,32,255,204,75,32,32,204,68,11,204,68,204,68,204,72,204,87,208,162,208,198,33,208,130,208,195,33,204,115,208,191,208,196,204,126,208,178,204,67,208,184,208,184,208,194,14,208,130,204,71,47,208,198,29,254,55,204,113,30,208,193,204,96,208,199,30,240,208,183,208,183,208,135,208,166,208,184,250,208,147,208,170,208,148,249,6,225,42,208,212,4,204,125,49,204,122,208,159,204,102,208,136,248,204,74,255,208,173,208,202,208,165,41,208,130,208,206,248,47,34,204,123,22,54,26,39,208,172,208,174,208,130,255,3,0,0,255,1,0,0,10,145,212,114,102,146,166,108,97,121,101,114,115,164,110,97,109,101,212,2,0,150,92,203,191,253,203,225,12,59,196,66,217,36,54,97,48,57,56,53,97,51,45,102,52,98,97,45,52,99,102,101,45,98,50,50,48,45,97,98,50,52,54,97,48,102,55,54,54,102,212,114,103,150,165,97,108,112,104,97,164,109,111,100,101,166,105,115,77,97,115,107,167,118,105,115,105,98,108,101,164,116,121,112,101,167,116,101,120,116,117,114,101,203,63,211,51,51,51,51,51,51,0,194,195,166,109,97,116,99,97,112,212,114,104,151,165,105,109,97,103,101,168,119,114,97,112,112,105,110,103,166,114,101,112,101,97,116,166,111,102,102,115,101,116,168,114,111,116,97,116,105,111,110,169,109,105,110,70,105,108,116,101,114,169,109,97,103,70,105,108,116,101,114,179,109,97,116,99,97,112,95,114,101,102,108,101,99,116,105,111,110,95,52,205,3,233,146,1,1,146,0,0,0,205,3,240,205,3,238,214,105,0,0,0,9,92,203,191,246,255,141,96,117,117,61,217,36,55,52,57,56,56,102,102,52,45,48,100,56,102,45,52,57,51,98,45,57,102,100,53,45,57,99,48,48,101,50,101,57,54,100,99,97,212,114,105,154,165,97,108,112,104,97,164,109,111,100,101,166,105,115,77,97,115,107,167,118,105,115,105,98,108,101,164,116,121,112,101,165,99,111,108,111,114,164,98,105,97,115,165,115,99,97,108,101,169,105,110,116,101,110,115,105,116,121,166,102,97,99,116,111,114,203,63,201,153,153,153,153,153,154,3,194,195,167,102,114,101,115,110,101,108,212,114,106,148,161,114,161,103,161,98,161,97,1,1,1,1,203,63,185,153,153,153,153,153,154,1,2,1,214,105,0,0,0,10,212,114,107,147,162,102,105,164,100,97,116,97,162,105,100,203,191,243,148,216,154,246,179,26,212,114,108,157,164,109,111,100,101,166,105,115,77,97,115,107,167,118,105,115,105,98,108,101,167,98,117,109,112,77,97,112,176,98,117,109,112,77,97,112,73,110,116,101,110,115,105,116,121,172,114,111,117,103,104,110,101,115,115,77,97,112,173,97,108,112,104,97,79,118,101,114,114,105,100,101,168,99,97,116,101,103,111,114,121,168,115,112,101,99,117,108,97,114,169,115,104,105,110,105,110,101,115,115,164,116,121,112,101,169,111,99,99,108,117,115,105,111,110,165,97,108,112,104,97,0,194,195,212,0,0,5,212,0,0,1,165,112,104,111,110,103,81,203,63,201,153,153,153,153,153,154,203,63,201,153,153,153,153,153,154,203,63,201,153,153,153,153,153,154,5,165,108,105,103,104,116,195,203,63,233,153,153,153,153,153,154,166,108,97,121,101,114,49,214,105,0,0,0,11,92,203,191,240,229,136,234,17,243,23,217,36,52,56,97,53,102,55,98,53,45,49,48,55,100,45,52,55,102,56,45,98,55,98,51,45,54,56,100,49,48,51,98,57,97,50,97,98,103,203,63,196,122,225,71,174,20,123,2,194,195,166,109,97,116,99,97,112,104,182,109,97,116,99,97,112,95,114,101,102,108,101,99,116,105,111,110,95,108,105,110,101,205,3,233,146,1,1,146,0,0,0,205,3,240,205,3,238,214,105,0,0,0,12,92,203,191,223,87,120,209,35,185,28,217,36,57,100,98,100,57,50,52,51,45,102,99,99,102,45,52,57,53,51,45,98,49,100,52,45,102,48,52,56,53,101,101,102,57,97,98,52,103,203,63,227,51,51,51,51,51,51,2,194,195,166,109,97,116,99,97,112,104,179,109,97,116,99,97,112,95,114,101,102,108,101,99,116,105,111,110,95,53,205,3,233,146,1,1,146,0,0,0,205,3,240,205,3,238,214,105,0,0,0,13,107,1,212,114,109,150,165,97,108,112,104,97,164,109,111,100,101,166,105,115,77,97,115,107,167,118,105,115,105,98,108,101,164,116,121,112,101,165,99,111,108,111,114,1,0,194,195,165,99,111,108,111,114,81,203,63,237,167,143,168,42,70,204,203,63,238,16,163,238,49,46,32,203,63,239,86,54,173,251,7,116,166,108,97,121,101,114,50,173,76,105,110,101,32,77,97,116,101,114,105,97,108,144,66,203,191,240,44,215,16,156,231,250,217,36,101,55,48,56,54,55,56,57,45,54,54,50,56,45,52,53,100,52,45,56,51,57,101,45,49,57,55,100,57,55,49,97,52,49,101,53,212,114,110,157,164,110,97,109,101,164,116,121,112,101,166,115,116,97,116,101,115,166,101,118,101,110,116,115,167,118,105,115,105,98,108,101,171,114,97,121,99,97,115,116,76,111,99,107,167,112,104,121,115,105,99,115,172,112,97,116,104,83,110,97,112,112,105,110,103,168,112,111,115,105,116,105,111,110,168,114,111,116,97,116,105,111,110,165,115,99,97,108,101,172,104,105,100,100,101,110,77,97,116,114,105,120,166,99,108,111,110,101,114,165,71,114,111,117,112,165,69,109,112,116,121,212,2,0,145,92,203,63,220,78,254,2,230,38,235,217,36,55,50,54,51,101,56,49,49,45,102,57,99,55,45,52,49,51,101,45,57,51,48,50,45,57,102,48,54,100,97,102,99,52,49,53,53,212,114,111,149,164,110,97,109,101,168,114,111,116,97,116,105,111,110,168,112,111,115,105,116,105,111,110,165,115,99,97,108,101,172,104,105,100,100,101,110,77,97,116,114,105,120,165,83,116,97,116,101,147,0,0,0,147,203,64,19,226,196,157,73,81,192,203,191,233,108,253,27,29,10,64,203,64,19,28,159,100,215,81,172,147,1,1,1,220,0,16,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,212,2,0,145,92,203,63,225,55,185,244,116,195,165,217,36,49,99,98,48,48,100,56,102,45,52,53,97,54,45,52,55,52,97,45,97,102,56,102,45,57,48,55,100,53,53,102,98,50,98,57,99,96,165,83,116,97,114,116,194,212,2,0,145,92,203,63,227,66,177,130,124,175,160,217,36,49,52,100,97,100,53,54,51,45,57,48,49,49,45,52,56,99,56,45,97,100,99,98,45,102,50,53,99,102,56,52,53,52,49,54,56,97,170,84,114,97,110,115,105,116,105,111,110,164,79,110,99,101,217,36,101,55,48,56,54,55,56,57,45,54,54,50,56,45,52,53,100,52,45,56,51,57,101,45,49,57,55,100,57,55,49,97,52,49,101,53,212,2,0,147,98,217,36,56,98,97,57,98,97,102,50,45,51,55,49,49,45,52,102,48,49,45,56,56,55,50,45,101,50,57,55,53,52,99,97,48,56,98,99,99,192,255,0,170,115,116,97,114,116,45,111,110,99,101,166,110,111,114,109,97,108,205,3,232,4,10,98,217,36,57,49,55,52,48,51,54,51,45,97,55,53,50,45,52,102,56,98,45,97,51,54,53,45,100,52,55,57,56,56,99,56,52,56,98,54,99,217,36,55,50,54,51,101,56,49,49,45,102,57,99,55,45,52,49,51,101,45,57,51,48,50,45,57,102,48,54,100,97,102,99,52,49,53,53,0,0,170,115,116,97,114,116,45,111,110,99,101,166,110,111,114,109,97,108,205,3,232,4,11,92,203,64,38,234,160,200,65,180,79,217,36,100,97,98,56,100,48,49,53,45,55,101,97,101,45,52,101,101,98,45,57,49,48,48,45,102,54,100,55,102,101,100,53,48,51,99,51,212,114,112,150,166,114,101,112,101,97,116,165,100,101,108,97,121,174,100,101,108,97,121,68,105,114,101,99,116,105,111,110,169,100,105,114,101,99,116,105,111,110,168,100,117,114,97,116,105,111,110,166,101,97,115,105,110,103,0,0,170,115,116,97,114,116,45,111,110,99,101,166,110,111,114,109,97,108,205,3,232,4,0,0,170,115,116,97,114,116,45,111,110,99,101,166,110,111,114,109,97,108,195,194,214,105,0,0,0,1,68,170,118,105,115,105,98,105,108,105,116,121,195,170,112,111,115,105,116,105,111,110,101,100,1,0,1,203,63,224,0,0,0,0,0,0,0,203,63,201,153,153,153,153,153,154,166,99,111,110,118,101,120,147,195,195,195,147,195,195,195,214,105,0,0,0,2,69,192,0,0,170,116,97,110,103,101,110,116,105,97,108,147,203,64,19,226,196,157,73,81,192,203,192,54,195,88,47,26,159,216,203,64,19,28,159,100,215,81,172,214,105,0,0,0,3,147,0,0,0,214,105,0,0,0,4,147,1,1,1,214,105,0,0,0,5,220,0,16,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,192,145,66,203,63,221,115,16,213,164,49,56,217,36,52,102,56,97,51,101,99,57,45,51,50,51,97,45,52,57,55,99,45,57,99,100,49,45,55,101,51,98,101,48,52,49,102,50,98,55,110,164,67,111,114,101,165,69,109,112,116,121,212,2,0,145,92,203,63,216,245,10,29,161,168,20,217,36,98,99,100,102,49,48,48,52,45,52,49,55,48,45,52,54,57,56,45,97,57,100,101,45,53,52,99,57,102,52,52,101,48,57,50,98,111,165,83,116,97,116,101,147,0,204,180,0,147,0,0,0,147,203,63,239,255,255,255,255,255,255,1,203,63,239,255,255,255,255,255,255,220,0,16,203,63,240,0,0,0,0,0,1,0,203,60,144,0,0,0,0,0,0,0,0,1,0,0,203,188,144,0,0,0,0,0,0,0,203,63,240,0,0,0,0,0,1,0,0,203,188,240,0,0,0,0,0,0,203,60,208,0,0,0,0,0,0,1,212,2,0,145,92,203,63,226,4,73,109,248,197,22,217,36,51,53,101,97,48,51,98,57,45,57,57,51,102,45,52,51,48,97,45,56,99,54,53,45,97,98,49,53,50,98,49,54,97,101,48,97,96,165,83,116,97,114,116,194,212,2,0,145,92,203,63,220,155,130,105,170,251,227,217,36,54,100,56,50,101,100,57,51,45,48,48,55,54,45,52,48,53,97,45,97,52,101,102,45,51,53,49,98,56,52,101,53,52,100,56,51,97,170,84,114,97,110,115,105,116,105,111,110,164,79,110,99,101,217,36,52,102,56,97,51,101,99,57,45,51,50,51,97,45,52,57,55,99,45,57,99,100,49,45,55,101,51,98,101,48,52,49,102,50,98,55,212,2,0,146,98,217,36,55,53,53,54,53,52,97,51,45,52,53,49,48,45,52,54,48,50,45,98,98,99,55,45,51,101,55,99,100,100,98,98,99,99,57,49,99,192,255,0,170,115,116,97,114,116,45,111,110,99,101,168,112,105,110,103,112,111,110,103,205,3,232,4,10,98,217,36,100,48,51,49,100,49,48,53,45,55,101,48,101,45,52,100,97,98,45,56,102,56,97,45,98,51,101,54,53,101,55,49,53,99,101,50,99,217,36,98,99,100,102,49,48,48,52,45,52,49,55,48,45,52,54,57,56,45,97,57,100,101,45,53,52,99,57,102,52,52,101,48,57,50,98,0,0,170,115,116,97,114,116,45,111,110,99,101,166,110,111,114,109,97,108,205,11,184,4,11,0,0,170,115,116,97,114,116,45,111,110,99,101,166,110,111,114,109,97,108,195,194,214,112,0,0,0,1,214,112,0,0,0,2,147,0,0,0,214,112,0,0,0,3,214,112,0,0,0,4,214,112,0,0,0,5,192,146,66,203,63,227,145,182,207,134,2,103,217,36,48,53,51,53,97,48,55,51,45,97,98,102,52,45,52,101,50,101,45,98,48,48,98,45,100,97,101,53,100,101,57,100,52,97,50,52,110,164,67,111,114,101,165,69,109,112,116,121,212,2,0,144,212,2,0,144,195,194,68,170,118,105,115,105,98,105,108,105,116,121,195,170,112,111,115,105,116,105,111,110,101,100,1,0,1,203,63,224,0,0,0,0,0,0,0,203,63,201,153,153,153,153,153,154,166,99,111,110,118,101,120,147,195,195,195,147,195,195,195,69,192,0,0,170,116,97,110,103,101,110,116,105,97,108,147,203,191,116,174,240,6,141,128,0,203,191,232,245,193,235,133,31,0,0,147,0,0,0,147,1,1,203,63,241,107,36,122,25,112,193,220,0,16,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,192,145,66,203,63,219,66,119,64,219,125,160,217,36,99,52,55,49,53,50,57,49,45,52,97,102,100,45,52,57,97,48,45,56,56,50,54,45,98,51,49,53,100,50,49,97,99,48,100,99,212,114,113,220,0,20,164,116,121,112,101,166,115,116,97,116,101,115,166,101,118,101,110,116,115,167,118,105,115,105,98,108,101,171,114,97,121,99,97,115,116,76,111,99,107,167,112,104,121,115,105,99,115,172,112,97,116,104,83,110,97,112,112,105,110,103,168,112,111,115,105,116,105,111,110,168,114,111,116,97,116,105,111,110,165,115,99,97,108,101,172,104,105,100,100,101,110,77,97,116,114,105,120,166,99,108,111,110,101,114,171,102,108,97,116,83,104,97,100,105,110,103,169,119,105,114,101,102,114,97,109,101,164,115,105,100,101,170,99,97,115,116,83,104,97,100,111,119,173,114,101,99,101,105,118,101,83,104,97,100,111,119,164,110,97,109,101,168,103,101,111,109,101,116,114,121,168,109,97,116,101,114,105,97,108,164,77,101,115,104,212,2,0,144,212,2,0,144,195,194,214,112,0,0,0,6,214,112,0,0,0,7,147,203,192,90,192,81,224,0,0,0,203,64,86,89,153,160,0,0,0,203,192,41,255,255,255,255,255,255,147,0,0,0,147,1,1,1,220,0,16,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,192,194,194,0,195,195,164,67,111,114,101,212,114,114,152,165,115,104,97,112,101,164,116,121,112,101,165,119,105,100,116,104,166,104,101,105,103,104,116,172,115,117,98,100,105,118,105,115,105,111,110,115,165,100,101,112,116,104,176,101,120,116,114,117,100,101,66,101,118,101,108,83,105,122,101,180,101,120,116,114,117,100,101,66,101,118,101,108,83,101,103,109,101,110,116,115,212,114,115,148,166,112,111,105,110,116,115,168,105,115,67,108,111,115,101,100,169,114,111,117,110,100,110,101,115,115,170,115,104,97,112,101,72,111,108,101,115,212,2,0,156,92,0,217,36,49,102,102,57,50,98,97,100,45,98,102,56,48,45,52,51,99,98,45,97,97,54,56,45,99,98,53,51,97,55,50,100,54,100,52,98,212,114,116,149,169,114,111,117,110,100,110,101,115,115,168,112,111,115,105,116,105,111,110,189,97,114,101,67,111,110,116,114,111,108,115,68,105,114,101,99,116,105,111,110,115,77,105,114,114,111,114,101,100,175,99,111,110,116,114,111,108,80,114,101,118,105,111,117,115,171,99,111,110,116,114,111,108,78,101,120,116,0,146,203,63,132,122,225,71,174,16,0,203,192,85,30,20,122,225,71,174,195,212,114,117,145,168,112,111,115,105,116,105,111,110,146,203,63,132,122,225,71,174,16,0,203,192,85,30,20,122,225,71,174,117,146,203,63,132,122,225,71,174,16,0,203,192,85,30,20,122,225,71,174,92,1,217,36,56,97,54,52,50,55,53,100,45,55,99,56,100,45,52,56,97,56,45,57,57,101,50,45,99,55,102,56,102,101,100,97,48,97,50,102,116,0,146,203,64,72,87,10,61,112,163,215,203,192,98,221,194,143,92,40,245,195,117,146,203,64,72,87,10,61,112,163,215,203,192,98,221,194,143,92,40,245,117,146,203,64,72,87,10,61,112,163,215,203,192,98,221,194,143,92,40,245,92,2,217,36,56,97,97,54,53,56,57,50,45,50,50,54,48,45,52,56,97,99,45,56,56,48,99,45,53,50,49,97,98,102,55,53,98,54,54,57,116,0,146,203,64,90,192,163,215,10,61,112,203,192,102,89,153,153,153,153,153,195,117,146,203,64,90,192,163,215,10,61,112,203,192,102,89,153,153,153,153,153,117,146,203,64,90,192,163,215,10,61,112,203,192,102,89,153,153,153,153,153,92,3,217,36,52,102,53,101,101,102,53,98,45,99,53,102,48,45,52,101,53,48,45,97,54,50,51,45,51,99,57,56,101,101,53,56,50,57,98,102,116,0,146,203,64,100,170,225,71,174,20,123,203,192,98,221,194,143,92,40,245,195,117,146,203,64,100,170,225,71,174,20,123,203,192,98,221,194,143,92,40,245,117,146,203,64,100,170,225,71,174,20,123,203,192,98,221,194,143,92,40,245,92,4,217,36,53,50,49,54,48,98,48,101,45,100,99,48,56,45,52,49,56,55,45,56,50,50,55,45,100,56,54,56,99,48,56,54,49,49,56,102,116,0,146,203,64,106,192,81,235,133,30,183,203,192,85,30,20,122,225,71,174,195,117,146,203,64,106,192,81,235,133,30,183,203,192,85,30,20,122,225,71,174,117,146,203,64,106,192,81,235,133,30,183,203,192,85,30,20,122,225,71,174,92,5,217,36,57,57,102,48,100,55,97,97,45,55,100,52,50,45,52,56,49,98,45,57,53,101,55,45,49,55,49,98,51,57,102,56,57,52,49,99,116,0,146,203,64,104,127,92,40,245,194,143,203,192,49,130,143,92,40,245,192,195,117,146,203,64,104,127,92,40,245,194,143,203,192,49,130,143,92,40,245,192,117,146,203,64,104,127,92,40,245,194,143,203,192,49,130,143,92,40,245,192,92,6,217,36,54,52,98,57,50,56,98,53,45,57,52,53,49,45,52,51,54,51,45,98,102,50,57,45,49,48,54,57,53,50,55,54,54,102,50,51,116,0,146,203,64,101,191,10,61,112,163,215,0,195,117,146,203,64,101,191,10,61,112,163,215,0,117,146,203,64,101,191,10,61,112,163,215,0,92,7,217,36,48,50,51,51,99,99,99,98,45,53,100,102,57,45,52,102,52,54,45,97,100,100,57,45,49,102,51,98,98,98,100,53,50,97,97,51,116,0,146,203,64,96,92,204,204,204,204,204,203,192,60,227,215,10,61,112,160,195,117,146,203,64,96,92,204,204,204,204,204,203,192,60,227,215,10,61,112,160,117,146,203,64,96,92,204,204,204,204,204,203,192,60,227,215,10,61,112,160,92,8,217,36,55,51,102,99,49,49,97,50,45,50,53,51,101,45,52,53,49,51,45,98,49,102,55,45,52,98,48,57,49,53,52,97,53,52,49,48,116,0,146,203,64,84,199,10,61,112,163,214,203,192,60,227,215,10,61,112,160,195,117,146,203,64,84,199,10,61,112,163,214,203,192,60,227,215,10,61,112,160,117,146,203,64,84,199,10,61,112,163,214,203,192,60,227,215,10,61,112,160,92,9,217,36,98,54,101,48,54,98,52,50,45,101,53,56,98,45,52,52,97,49,45,98,50,54,102,45,57,51,53,97,54,57,49,53,49,53,52,102,116,0,146,203,64,68,5,30,184,81,235,133,0,195,117,146,203,64,68,5,30,184,81,235,133,0,117,146,203,64,68,5,30,184,81,235,133,0,92,10,217,36,55,97,100,57,100,56,97,56,45,98,52,102,54,45,52,51,98,100,45,98,56,98,50,45,57,54,50,57,97,51,97,102,101,52,52,54,116,0,146,203,64,50,7,174,20,122,225,70,203,192,49,130,143,92,40,245,192,195,117,146,203,64,50,7,174,20,122,225,70,203,192,49,130,143,92,40,245,192,117,146,203,64,50,7,174,20,122,225,70,203,192,49,130,143,92,40,245,192,92,11,217,36,101,57,100,52,98,101,49,98,45,53,102,101,57,45,52,54,101,100,45,56,99,54,97,45,54,99,100,48,100,48,97,51,97,98,100,53,116,0,146,0,203,192,85,30,20,122,225,71,174,195,117,146,0,203,192,85,30,20,122,225,71,174,117,146,0,203,192,85,30,20,122,225,71,174,195,0,145,115,212,2,0,153,92,0,217,36,52,54,51,102,55,54,97,54,45,97,50,98,99,45,52,97,50,50,45,98,56,53,98,45,97,52,49,56,54,54,100,52,55,52,48,57,116,0,146,203,64,68,247,10,61,112,163,215,203,192,68,204,204,204,204,204,204,195,117,146,203,64,68,247,10,61,112,163,215,203,192,68,204,204,204,204,204,204,117,146,203,64,68,247,10,61,112,163,215,203,192,68,204,204,204,204,204,204,92,1,217,36,55,55,48,52,99,54,50,100,45,98,102,98,99,45,52,102,52,52,45,98,98,56,49,45,98,54,98,52,99,52,98,48,56,49,57,50,116,0,146,203,64,84,185,153,153,153,153,152,203,192,78,42,61,112,163,215,8,195,117,146,203,64,84,185,153,153,153,153,152,203,192,78,42,61,112,163,215,8,117,146,203,64,84,185,153,153,153,153,152,203,192,78,42,61,112,163,215,8,92,2,217,36,48,102,102,99,100,51,50,49,45,100,97,57,98,45,52,56,53,101,45,98,102,53,48,45,50,57,52,48,50,52,56,49,101,48,56,99,116,0,146,203,64,96,99,215,10,61,112,163,203,192,78,42,61,112,163,215,8,195,117,146,203,64,96,99,215,10,61,112,163,203,192,78,42,61,112,163,215,8,117,146,203,64,96,99,215,10,61,112,163,203,192,78,42,61,112,163,215,8,92,3,217,36,56,56,50,100,98,51,48,56,45,56,57,98,53,45,52,57,52,48,45,97,57,52,99,45,49,55,53,100,50,51,97,102,52,97,56,99,116,0,146,203,64,101,130,225,71,174,20,123,203,192,68,204,204,204,204,204,204,195,117,146,203,64,101,130,225,71,174,20,123,203,192,68,204,204,204,204,204,204,117,146,203,64,101,130,225,71,174,20,123,203,192,68,204,204,204,204,204,204,92,4,217,36,49,54,100,55,100,100,53,97,45,50,53,102,55,45,52,98,52,52,45,98,99,102,49,45,50,49,97,48,52,97,50,51,49,53,52,49,116,0,146,203,64,102,139,51,51,51,51,51,203,192,83,197,30,184,81,235,132,195,117,146,203,64,102,139,51,51,51,51,51,203,192,83,197,30,184,81,235,132,117,146,203,64,102,139,51,51,51,51,51,203,192,83,197,30,184,81,235,132,92,5,217,36,97,101,101,48,56,100,98,54,45,48,102,57,48,45,52,97,102,102,45,56,51,54,52,45,52,54,50,98,102,100,101,99,55,49,97,97,116,0,146,203,64,99,166,20,122,225,71,174,203,192,96,5,30,184,81,235,133,195,117,146,203,64,99,166,20,122,225,71,174,203,192,96,5,30,184,81,235,133,117,146,203,64,99,166,20,122,225,71,174,203,192,96,5,30,184,81,235,133,92,6,217,36,98,53,53,53,57,56,53,98,45,101,99,56,101,45,52,48,56,55,45,57,102,97,98,45,102,101,51,51,97,48,98,98,102,57,54,52,116,0,146,203,64,90,192,163,215,10,61,112,203,192,99,66,143,92,40,245,195,195,117,146,203,64,90,192,163,215,10,61,112,203,192,99,66,143,92,40,245,195,117,146,203,64,90,192,163,215,10,61,112,203,192,99,66,143,92,40,245,195,92,7,217,36,56,49,101,102,51,55,57,54,45,50,97,57,56,45,52,55,101,55,45,97,48,53,53,45,102,54,101,49,50,99,102,51,101,98,57,48,116,0,146,203,64,76,106,61,112,163,215,9,203,192,96,5,30,184,81,235,133,195,117,146,203,64,76,106,61,112,163,215,9,203,192,96,5,30,184,81,235,133,117,146,203,64,76,106,61,112,163,215,9,203,192,96,5,30,184,81,235,133,92,8,217,36,55,50,50,101,50,55,102,54,45,102,99,52,100,45,52,51,57,101,45,97,48,51,48,45,52,101,53,56,51,50,100,51,51,55,53,102,116,0,146,203,64,64,213,194,143,92,40,245,203,192,83,197,30,184,81,235,132,195,117,146,203,64,64,213,194,143,92,40,245,203,192,83,197,30,184,81,235,132,117,146,203,64,64,213,194,143,92,40,245,203,192,83,197,30,184,81,235,132,195,0,144,174,86,101,99,116,111,114,71,101,111,109,101,116,114,121,203,64,106,192,81,235,133,30,183,203,64,102,89,153,153,153,153,153,12,26,0,1,102,212,2,0,151,92,203,192,2,92,14,53,62,45,212,217,36,48,102,50,50,52,55,50,56,45,56,97,57,57,45,52,101,51,100,45,98,97,48,49,45,54,99,56,56,51,53,99,56,101,55,97,101,212,114,118,159,165,97,108,112,104,97,164,109,111,100,101,166,105,115,77,97,115,107,167,118,105,115,105,98,108,101,164,116,121,112,101,172,103,114,97,100,105,101,110,116,84,121,112,101,166,115,109,111,111,116,104,168,105,115,86,101,99,116,111,114,172,105,115,87,111,114,108,100,83,112,97,99,101,166,111,114,105,103,105,110,169,100,105,114,101,99,116,105,111,110,166,99,111,108,111,114,115,165,115,116,101,112,115,164,110,101,97,114,163,102,97,114,1,1,194,195,165,100,101,112,116,104,1,194,195,194,147,205,1,87,209,255,121,0,214,105,0,0,0,8,147,1,0,0,146,148,1,203,63,231,55,55,55,55,55,55,203,63,226,82,82,82,82,82,82,1,148,1,203,63,231,55,55,55,55,55,55,203,63,226,82,82,82,82,82,82,0,146,0,1,204,79,204,191,92,203,191,254,145,148,113,3,10,134,217,36,52,54,55,56,100,57,53,99,45,56,100,102,98,45,52,53,50,53,45,98,48,54,57,45,53,55,99,49,97,48,51,101,54,52,98,52,118,1,1,194,195,165,100,101,112,116,104,1,194,195,194,147,208,157,0,0,214,112,0,0,0,8,146,148,203,63,230,246,246,246,246,246,247,203,63,234,250,250,250,250,250,251,203,63,238,30,30,30,30,30,30,1,148,203,63,230,246,246,246,246,246,247,203,63,234,250,250,250,250,250,251,203,63,238,30,30,30,30,30,30,0,146,0,1,50,204,191,214,112,0,0,0,9,214,112,0,0,0,10,214,112,0,0,0,11,214,112,0,0,0,12,214,112,0,0,0,13,173,67,111,114,101,32,77,97,116,101,114,105,97,108,144,66,203,63,245,46,197,164,229,76,32,217,36,97,49,57,52,57,53,54,55,45,56,98,48,53,45,52,102,102,98,45,56,97,97,52,45,49,55,102,57,49,97,55,102,54,98,56,102,110,171,67,111,114,101,32,83,116,114,111,107,101,165,69,109,112,116,121,212,2,0,144,212,2,0,144,195,194,68,170,118,105,115,105,98,105,108,105,116,121,195,170,112,111,115,105,116,105,111,110,101,100,1,0,1,203,63,224,0,0,0,0,0,0,0,203,63,201,153,153,153,153,153,154,166,99,111,110,118,101,120,147,195,195,195,147,195,195,195,69,192,0,0,170,116,97,110,103,101,110,116,105,97,108,147,0,0,203,63,195,137,94,123,127,46,128,214,112,0,0,0,3,214,112,0,0,0,4,214,112,0,0,0,5,192,145,66,203,63,216,156,23,146,1,242,67,217,36,54,97,51,55,101,99,55,99,45,49,57,54,51,45,52,102,50,99,45,56,51,98,100,45,102,50,98,49,101,54,52,52,56,53,101,101,113,164,77,101,115,104,212,2,0,144,212,2,0,144,195,194,214,112,0,0,0,6,214,112,0,0,0,7,147,203,192,94,11,132,64,0,0,0,203,64,89,229,30,192,0,0,0,203,192,26,0,0,0,0,0,0,147,0,0,0,147,1,1,1,220,0,16,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,192,194,194,0,195,195,171,67,111,114,101,32,83,116,114,111,107,101,114,115,212,2,0,155,92,0,217,36,56,51,100,52,52,48,49,48,45,97,53,50,97,45,52,50,56,97,45,57,99,54,99,45,101,100,57,52,97,51,97,97,48,50,52,102,116,0,146,203,64,94,11,131,123,74,35,58,203,192,105,229,30,184,81,235,132,195,117,146,203,64,94,11,131,123,74,35,58,203,192,105,229,30,184,81,235,132,117,146,203,64,94,11,131,123,74,35,58,203,192,105,229,30,184,81,235,132,92,1,217,36,100,97,49,52,54,57,98,54,45,57,97,99,52,45,52,55,98,52,45,56,102,53,101,45,57,97,54,97,101,102,101,56,98,50,97,57,116,0,146,203,64,74,241,235,133,30,184,82,203,192,101,239,92,40,245,194,144,195,117,146,203,64,74,241,235,133,30,184,82,203,192,101,239,92,40,245,194,144,117,146,203,64,74,241,235,133,30,184,82,203,192,101,239,92,40,245,194,144,92,2,217,36,56,97,102,56,54,100,56,54,45,102,50,97,48,45,52,99,53,54,45,57,51,54,98,45,101,101,53,97,97,57,56,99,55,48,53,57,116,0,146,0,203,192,89,120,245,194,143,92,40,195,117,146,0,203,192,89,120,245,194,143,92,40,117,146,0,203,192,89,120,245,194,143,92,40,92,3,217,36,53,53,102,52,51,54,50,57,45,56,51,55,56,45,52,51,51,49,45,97,57,97,51,45,98,51,101,100,97,51,52,101,51,52,56,101,116,0,146,203,64,52,145,235,133,30,184,82,203,192,57,125,112,163,215,10,56,195,117,146,203,64,52,145,235,133,30,184,82,203,192,57,125,112,163,215,10,56,117,146,203,64,52,145,235,133,30,184,82,203,192,57,125,112,163,215,10,56,92,4,217,36,54,55,50,54,55,100,53,48,45,98,102,49,101,45,52,53,98,101,45,97,51,101,50,45,55,97,98,99,49,99,48,56,48,55,48,99,116,0,146,203,64,74,76,204,204,204,204,206,0,195,117,146,203,64,74,76,204,204,204,204,206,0,117,146,203,64,74,76,204,204,204,204,206,0,92,5,217,36,98,53,101,97,56,51,101,97,45,97,54,102,53,45,52,101,51,53,45,97,52,55,48,45,98,53,101,100,49,99,57,101,54,54,100,54,116,0,146,203,64,88,253,111,0,104,219,140,203,192,63,194,143,92,40,245,192,195,117,146,203,64,88,253,111,0,104,219,140,203,192,63,194,143,92,40,245,192,117,146,203,64,88,253,111,0,104,219,140,203,192,63,194,143,92,40,245,192,92,6,217,36,48,56,55,101,98,99,51,102,45,100,51,49,99,45,52,99,56,48,45,97,57,51,53,45,53,51,52,98,49,51,56,100,98,100,52,50,116,0,146,203,64,97,140,203,251,21,181,116,203,192,63,194,143,92,40,245,192,195,117,146,203,64,97,140,203,251,21,181,116,203,192,63,194,143,92,40,245,192,117,146,203,64,97,140,203,251,21,181,116,203,192,63,194,143,92,40,245,192,92,7,217,36,57,99,56,51,55,101,99,55,45,57,100,55,53,45,52,54,52,97,45,56,102,99,57,45,52,53,50,97,53,55,49,49,98,102,99,99,116,0,146,203,64,103,120,81,25,206,7,96,0,195,117,146,203,64,103,120,81,25,206,7,96,0,117,146,203,64,103,120,81,25,206,7,96,0,92,8,217,36,52,99,51,98,100,54,52,48,45,97,53,97,97,45,52,51,100,102,45,56,97,55,54,45,52,56,57,97,101,53,100,51,97,53,98,55,116,0,146,203,64,107,121,70,220,93,99,136,203,192,57,125,112,163,215,10,56,195,117,146,203,64,107,121,70,220,93,99,136,203,192,57,125,112,163,215,10,56,117,146,203,64,107,121,70,220,93,99,136,203,192,57,125,112,163,215,10,56,92,9,217,36,99,97,99,49,55,52,99,56,45,101,49,53,55,45,52,51,56,102,45,56,52,51,102,45,50,98,99,53,57,102,97,101,97,57,48,53,116,0,146,203,64,110,11,132,77,1,58,146,203,192,89,120,245,194,143,92,40,195,117,146,203,64,110,11,132,77,1,58,146,203,192,89,120,245,194,143,92,40,117,146,203,64,110,11,132,77,1,58,146,203,192,89,120,245,194,143,92,40,92,10,217,36,48,98,100,98,50,102,52,53,45,97,54,53,54,45,52,102,49,51,45,97,51,53,53,45,57,100,97,52,98,97,55,52,99,98,101,97,116,0,146,203,64,103,79,9,107,185,140,126,203,192,101,239,92,40,245,194,144,195,117,146,203,64,103,79,9,107,185,140,126,203,192,101,239,92,40,245,194,144,117,146,203,64,103,79,9,107,185,140,126,203,192,101,239,92,40,245,194,144,195,0,145,115,212,2,0,156,92,0,217,36,48,51,54,52,56,48,52,102,45,48,100,48,51,45,52,99,50,51,45,57,55,55,54,45,99,98,54,55,101,48,49,51,48,57,98,52,116,0,146,203,64,78,236,201,133,240,111,106,203,192,100,188,122,225,71,174,20,195,117,146,203,64,78,236,201,133,240,111,106,203,192,100,188,122,225,71,174,20,117,146,203,64,78,236,201,133,240,111,106,203,192,100,188,122,225,71,174,20,92,1,217,36,51,56,53,49,53,49,48,53,45,49,52,49,49,45,52,57,97,49,45,56,102,57,51,45,55,55,48,51,51,54,48,54,57,51,98,57,116,0,146,203,64,94,11,131,123,74,35,58,203,192,104,56,81,235,133,30,184,195,117,146,203,64,94,11,131,123,74,35,58,203,192,104,56,81,235,133,30,184,117,146,203,64,94,11,131,123,74,35,58,203,192,104,56,81,235,133,30,184,92,2,217,36,98,55,55,53,51,53,54,49,45,55,50,101,98,45,52,51,54,49,45,98,97,57,98,45,56,98,98,100,100,100,52,52,100,49,98,51,116,0,146,203,64,102,80,81,25,206,7,96,203,192,100,188,122,225,71,174,20,195,117,146,203,64,102,80,81,25,206,7,96,203,192,100,188,122,225,71,174,20,117,146,203,64,102,80,81,25,206,7,96,203,192,100,188,122,225,71,174,20,92,3,217,36,50,97,99,54,51,55,49,98,45,48,51,52,97,45,52,57,97,97,45,97,54,56,51,45,97,100,48,50,50,50,102,48,98,101,98,57,116,0,146,203,64,108,101,193,189,165,17,156,203,192,88,219,133,30,184,81,236,195,117,146,203,64,108,101,193,189,165,17,156,203,192,88,219,133,30,184,81,236,117,146,203,64,108,101,193,189,165,17,156,203,192,88,219,133,30,184,81,236,92,4,217,36,98,49,98,50,51,51,101,50,45,101,56,98,51,45,52,56,97,102,45,56,49,56,56,45,102,97,52,100,53,98,52,97,100,100,99,99,116,0,146,203,64,106,36,203,251,21,181,116,203,192,64,60,40,245,194,143,92,195,117,146,203,64,106,36,203,251,21,181,116,203,192,64,60,40,245,194,143,92,117,146,203,64,106,36,203,251,21,181,116,203,192,64,60,40,245,194,143,92,92,5,217,36,99,100,51,98,48,51,54,54,45,53,49,48,51,45,52,54,48,50,45,56,99,102,53,45,100,52,101,50,102,48,52,53,101,102,49,56,116,0,146,203,64,103,100,122,15,144,150,188,203,192,45,235,133,30,184,81,240,195,117,146,203,64,103,100,122,15,144,150,188,203,192,45,235,133,30,184,81,240,117,146,203,64,103,100,122,15,144,150,188,203,192,45,235,133,30,184,81,240,92,6,217,36,98,52,97,48,52,53,97,48,45,102,50,101,100,45,52,54,52,49,45,56,48,98,56,45,99,102,99,49,51,99,49,54,53,99,57,101,116,0,146,203,64,98,2,60,158,236,191,177,203,192,69,236,204,204,204,204,204,195,117,146,203,64,98,2,60,158,236,191,177,203,192,69,236,204,204,204,204,204,117,146,203,64,98,2,60,158,236,191,177,203,192,69,236,204,204,204,204,204,92,7,217,36,97,49,50,49,55,51,56,102,45,100,101,102,50,45,52,102,55,101,45,57,51,52,49,45,100,102,49,56,55,101,49,57,55,54,100,57,116,0,146,203,64,88,17,233,225,176,137,160,203,192,69,236,204,204,204,204,204,195,117,146,203,64,88,17,233,225,176,137,160,203,192,69,236,204,204,204,204,204,117,146,203,64,88,17,233,225,176,137,160,203,192,69,236,204,204,204,204,204,92,8,217,36,99,50,53,98,98,54,50,48,45,101,100,100,97,45,52,101,56,102,45,98,97,55,101,45,55,97,102,50,101,54,97,100,49,100,56,101,116,0,146,203,64,74,154,225,71,174,20,124,203,192,45,235,133,30,184,81,240,195,117,146,203,64,74,154,225,71,174,20,124,203,192,45,235,133,30,184,81,240,117,146,203,64,74,154,225,71,174,20,124,203,192,45,235,133,30,184,81,240,92,9,217,36,101,53,49,52,56,99,48,101,45,53,99,50,55,45,52,50,50,101,45,98,54,97,55,45,100,98,102,98,102,57,57,48,52,49,97,56,116,0,146,203,64,63,51,51,51,51,51,52,203,192,64,60,40,245,194,143,92,195,117,146,203,64,63,51,51,51,51,51,52,203,192,64,60,40,245,194,143,92,117,146,203,64,63,51,51,51,51,51,52,203,192,64,60,40,245,194,143,92,92,10,217,36,57,52,51,56,49,56,49,57,45,48,56,100,97,45,52,57,98,53,45,56,98,102,100,45,56,50,50,97,98,53,98,54,49,102,99,52,116,0,146,203,64,42,87,10,61,112,163,216,203,192,88,219,133,30,184,81,236,195,117,146,203,64,42,87,10,61,112,163,216,203,192,88,219,133,30,184,81,236,117,146,203,64,42,87,10,61,112,163,216,203,192,88,219,133,30,184,81,236,92,11,217,36,98,101,54,99,50,48,98,49,45,100,48,52,100,45,52,100,57,100,45,56,97,97,97,45,101,101,48,57,99,98,50,99,55,98,102,50,116,0,146,203,64,78,235,129,215,219,244,136,203,192,100,188,122,225,71,174,20,195,117,146,203,64,78,235,129,215,219,244,136,203,192,100,188,122,225,71,174,20,117,146,203,64,78,235,129,215,219,244,136,203,192,100,188,122,225,71,174,20,195,0,144,174,86,101,99,116,111,114,71,101,111,109,101,116,114,121,203,64,110,11,132,77,1,58,146,203,64,105,229,30,184,81,235,132,12,13,0,1,102,212,2,0,151,92,203,192,4,10,10,50,233,28,245,217,36,100,55,102,48,51,53,57,100,45,100,53,49,50,45,52,100,101,51,45,98,49,50,100,45,55,102,56,54,52,53,55,100,101,55,99,54,212,114,119,220,0,22,165,97,108,112,104,97,164,109,111,100,101,166,105,115,77,97,115,107,167,118,105,115,105,98,108,101,164,116,121,112,101,164,115,105,122,101,169,110,111,105,115,101,84,121,112,101,165,115,99,97,108,101,164,109,111,118,101,166,99,111,108,111,114,65,166,99,111,108,111,114,66,166,99,111,108,111,114,67,166,99,111,108,111,114,68,170,100,105,115,116,111,114,116,105,111,110,162,102,65,162,102,66,172,118,111,114,111,110,111,105,83,116,121,108,101,167,104,105,103,104,67,117,116,166,108,111,119,67,117,116,170,115,109,111,111,116,104,110,101,115,115,164,115,101,101,100,167,113,117,97,108,105,116,121,203,63,185,153,153,153,153,153,154,2,194,195,165,110,111,105,115,101,147,204,100,204,100,204,100,0,203,191,132,122,225,71,174,20,123,1,106,203,63,217,153,153,153,153,153,154,203,63,217,153,153,153,153,153,154,203,63,217,153,153,153,153,153,154,1,106,203,63,217,153,153,153,153,153,154,203,63,217,153,153,153,153,153,154,203,63,217,153,153,153,153,153,154,1,106,1,1,1,1,106,1,1,1,1,146,1,1,146,203,63,251,51,51,51,51,51,51,203,64,34,102,102,102,102,102,102,146,203,64,32,153,153,153,153,153,154,203,64,6,102,102,102,102,102,102,0,1,0,203,63,211,51,51,51,51,51,51,0,1,92,203,192,0,81,111,14,117,197,105,217,36,48,100,55,54,102,98,98,102,45,56,101,49,56,45,52,97,52,56,45,98,52,100,57,45,53,52,50,100,102,52,97,101,102,97,49,102,103,1,2,194,195,166,109,97,116,99,97,112,104,179,109,97,116,99,97,112,95,114,101,102,108,101,99,116,105,111,110,95,53,205,3,233,146,1,1,146,0,0,0,205,3,240,205,3,238,107,203,191,246,255,141,214,23,182,213,108,0,194,195,212,0,0,5,212,0,0,1,165,112,104,111,110,103,81,203,63,201,153,153,153,153,153,154,203,63,201,153,153,153,153,153,154,203,63,201,153,153,153,153,153,154,5,165,108,105,103,104,116,195,203,63,227,51,51,51,51,51,51,166,108,97,121,101,114,49,92,203,191,242,236,250,23,128,90,154,217,36,102,102,57,48,98,97,49,97,45,101,51,54,97,45,52,55,99,98,45,56,53,53,100,45,53,97,55,51,99,54,100,54,100,50,100,98,212,114,120,155,165,97,108,112,104,97,164,109,111,100,101,166,105,115,77,97,115,107,167,118,105,115,105,98,108,101,164,116,121,112,101,173,102,105,108,109,84,104,105,99,107,110,101,115,115,168,109,111,118,101,109,101,110,116,171,119,97,118,101,108,101,110,103,116,104,115,173,110,111,105,115,101,83,116,114,101,110,103,116,104,170,110,111,105,115,101,83,99,97,108,101,166,111,102,102,115,101,116,203,63,227,51,51,51,51,51,51,3,194,195,167,114,97,105,110,98,111,119,10,0,147,0,0,0,0,1,147,0,0,0,92,203,191,239,29,83,166,7,255,12,217,36,52,55,101,57,55,56,53,52,45,57,55,57,56,45,52,50,99,50,45,97,97,51,97,45,51,102,99,51,102,49,97,57,56,98,102,56,118,1,0,194,195,165,100,101,112,116,104,1,194,195,194,147,205,1,35,209,255,119,0,147,1,0,0,146,148,1,203,63,221,133,146,79,51,220,224,203,63,195,31,17,101,231,37,72,1,148,203,63,239,191,191,191,191,191,192,203,63,224,208,208,208,208,208,209,203,63,208,144,144,144,144,144,145,0,146,0,1,50,204,207,92,203,191,225,83,118,165,223,12,32,217,36,102,54,54,53,56,52,100,57,45,57,52,56,102,45,52,56,53,57,45,98,54,51,48,45,101,50,57,98,53,99,53,100,55,99,54,99,118,1,0,194,195,165,100,101,112,116,104,1,194,195,194,147,239,208,194,0,147,1,0,0,146,148,203,63,192,151,254,217,205,46,102,203,63,212,198,12,40,216,27,196,203,63,233,131,67,27,86,253,132,1,148,0,0,0,0,146,0,1,50,205,1,4,107,1,109,1,0,194,195,165,99,111,108,111,114,81,203,63,232,24,24,24,24,24,24,203,63,234,26,26,26,26,26,26,203,63,235,251,251,251,251,251,252,166,108,97,121,101,114,50,180,67,111,114,101,32,83,116,114,111,107,101,32,77,97,116,101,114,105,97,108,144,212,114,121,148,162,102,105,164,100,97,116,97,162,105,100,168,99,104,105,108,100,114,101,110,255,212,114,122,220,0,21,166,115,116,97,116,101,115,166,101,118,101,110,116,115,167,118,105,115,105,98,108,101,171,114,97,121,99,97,115,116,76,111,99,107,167,112,104,121,115,105,99,115,172,112,97,116,104,83,110,97,112,112,105,110,103,168,112,111,115,105,116,105,111,110,168,114,111,116,97,116,105,111,110,165,115,99,97,108,101,172,104,105,100,100,101,110,77,97,116,114,105,120,166,99,108,111,110,101,114,164,116,121,112,101,165,99,111,108,111,114,169,105,110,116,101,110,115,105,116,121,167,115,104,97,100,111,119,115,164,115,105,122,101,165,100,101,112,116,104,172,112,101,110,117,109,98,114,97,83,105,122,101,176,115,104,97,100,111,119,82,101,115,111,108,117,116,105,111,110,172,115,104,97,100,111,119,82,97,100,105,117,115,164,110,97,109,101,214,112,0,0,0,14,214,112,0,0,0,15,195,194,68,170,118,105,115,105,98,105,108,105,116,121,195,170,112,111,115,105,116,105,111,110,101,100,1,0,1,203,63,224,0,0,0,0,0,0,0,203,63,201,153,153,153,153,153,154,166,99,111,110,118,101,120,214,112,0,0,0,16,214,112,0,0,0,17,214,112,0,0,0,18,147,204,200,205,1,44,205,1,44,214,112,0,0,0,19,214,112,0,0,0,20,214,112,0,0,0,21,192,176,68,105,114,101,99,116,105,111,110,97,108,76,105,103,104,116,106,1,1,1,1,203,63,230,102,102,102,102,102,102,195,205,7,208,206,0,1,134,160,203,63,224,0,0,0,0,0,0,205,4,0,1,177,68,105,114,101,99,116,105,111,110,97,108,32,76,105,103,104,116,217,36,56,51,48,97,50,55,48,56,45,56,101,100,57,45,52,57,99,102,45,97,54,56,101,45,48,56,53,50,57,57,56,57,57,49,48,51,144,212,114,123,155,173,111,114,98,105,116,67,111,110,116,114,111,108,115,168,112,108,97,121,80,97,103,101,174,119,105,116,104,66,97,99,107,103,114,111,117,110,100,173,112,114,101,118,101,110,116,83,99,114,111,108,108,178,112,114,101,118,101,110,116,84,111,117,99,104,83,99,114,111,108,108,170,104,105,100,101,67,117,114,115,111,114,176,109,111,117,115,101,69,118,101,110,116,84,97,114,103,101,116,183,106,111,121,115,116,105,99,107,83,105,122,101,65,110,100,88,89,79,102,102,115,101,116,168,115,101,116,116,105,110,103,115,171,115,116,111,112,82,97,121,99,97,115,116,174,104,100,84,114,97,110,115,109,105,115,115,105,111,110,212,114,124,220,0,24,169,101,110,97,98,108,101,80,97,110,170,101,110,97,98,108,101,90,111,111,109,172,101,110,97,98,108,101,82,111,116,97,116,101,173,101,110,97,98,108,101,68,97,109,112,105,110,103,178,114,111,116,97,116,105,111,110,76,105,109,105,116,115,77,111,100,101,182,114,111,116,97,116,105,111,110,86,101,114,116,105,99,97,108,79,102,102,115,101,116,184,114,111,116,97,116,105,111,110,72,111,114,105,122,111,110,116,97,108,79,102,102,115,101,116,177,114,111,116,97,116,105,111,110,83,111,102,116,76,105,109,105,116,173,112,97,110,76,105,109,105,116,115,77,111,100,101,177,112,97,110,86,101,114,116,105,99,97,108,79,102,102,115,101,116,179,112,97,110,72,111,114,105,122,111,110,116,97,108,79,102,102,115,101,116,172,112,97,110,83,111,102,116,76,105,109,105,116,177,122,111,111,109,76,105,109,105,116,115,69,110,97,98,108,101,100,170,122,111,111,109,76,105,109,105,116,115,170,97,117,116,111,82,111,116,97,116,101,175,97,117,116,111,82,111,116,97,116,101,83,112,101,101,100,179,97,117,116,111,82,111,116,97,116,101,67,108,111,99,107,119,105,115,101,178,104,111,118,101,114,82,111,116,97,116,101,80,97,110,77,111,100,101,182,104,111,118,101,114,82,111,116,97,116,101,80,97,110,83,116,114,101,110,103,116,104,178,104,111,118,101,114,82,111,116,97,116,101,68,97,109,112,105,110,103,171,105,115,84,111,117,99,104,90,111,111,109,172,111,114,98,105,116,84,111,117,99,104,101,115,170,112,97,110,84,111,117,99,104,101,115,190,114,101,115,101,116,72,111,118,101,114,69,102,102,101,99,116,79,110,80,111,105,110,116,101,114,76,101,97,118,101,194,194,194,195,0,212,114,125,146,163,109,105,110,163,109,97,120,203,63,233,33,251,84,68,45,24,203,63,233,33,251,84,68,45,24,125,203,63,233,33,251,84,68,45,24,203,63,233,33,251,84,68,45,24,2,0,125,204,250,204,250,125,204,250,204,250,2,194,125,203,63,185,153,153,153,153,153,154,2,194,2,195,0,20,203,63,192,0,0,0,0,0,0,194,2,3,195,217,36,97,50,49,56,102,99,99,51,45,50,55,54,98,45,52,57,98,57,45,98,52,56,53,45,52,57,48,51,55,102,100,49,52,102,53,102,194,194,194,194,166,99,97,110,118,97,115,156,147,204,120,146,30,226,164,115,104,111,119,147,204,120,146,0,226,164,115,104,111,119,147,204,120,146,0,226,164,115,104,111,119,147,204,120,146,0,226,164,115,104,111,119,147,204,120,146,226,226,164,115,104,111,119,147,204,120,146,30,30,164,115,104,111,119,147,204,120,146,0,30,164,115,104,111,119,147,204,120,146,0,30,164,115,104,111,119,147,204,120,146,0,30,164,115,104,111,119,147,204,120,146,226,30,164,115,104,111,119,147,204,120,146,30,0,164,115,104,111,119,147,204,120,146,226,0,164,115,104,111,119,212,114,126,147,165,105,109,97,103,101,165,118,105,100,101,111,163,119,101,98,212,114,127,146,166,102,111,114,109,97,116,165,114,97,116,105,111,163,112,110,103,1,212,114,64,151,166,102,111,114,109,97,116,171,105,109,97,103,101,70,111,114,109,97,116,163,102,112,115,164,109,98,112,115,165,114,97,116,105,111,168,115,116,111,112,77,111,100,101,168,100,117,114,97,116,105,111,110,163,109,112,52,163,106,112,103,30,204,80,1,166,109,97,110,117,97,108,205,19,136,212,114,65,150,164,108,111,103,111,168,99,111,109,112,114,101,115,115,166,112,114,101,115,101,116,167,112,114,101,108,111,97,100,164,104,105,110,116,172,105,109,97,103,101,81,117,97,108,105,116,121,195,195,1,195,194,204,70,195,194,212,114,66,156,164,109,111,100,101,166,112,114,111,109,112,116,174,110,101,103,97,116,105,118,101,80,114,111,109,112,116,165,115,116,121,108,101,172,105,115,82,97,110,100,111,109,83,101,101,100,164,115,101,101,100,169,103,117,101,115,115,77,111,100,101,168,97,100,118,97,110,99,101,100,165,115,116,101,112,115,173,103,117,105,100,97,110,99,101,83,99,97,108,101,175,99,111,110,116,114,111,108,78,101,116,83,99,97,108,101,169,109,111,100,105,102,105,101,114,115,173,108,105,110,101,45,97,114,116,45,98,111,116,104,160,160,212,114,67,148,162,105,100,165,108,97,98,101,108,165,115,116,121,108,101,166,112,114,111,109,112,116,165,98,97,115,105,99,165,66,97,115,105,99,164,78,111,110,101,160,195,206,0,1,62,195,194,194,20,203,64,30,0,0,0,0,0,0,1,212,114,68,154,167,119,101,97,116,104,101,114,167,115,104,97,100,111,119,115,171,108,105,103,104,116,79,114,105,103,105,110,171,116,101,109,112,101,114,97,116,117,114,101,163,115,117,110,166,99,97,109,101,114,97,171,101,110,118,105,114,111,110,109,101,110,116,169,112,97,114,116,105,99,108,101,115,166,110,97,116,117,114,101,165,102,108,111,111,114,0,0,0,0,0,0,0,0,0,0,212,1,0,212,114,69,145,217,36,55,50,102,99,50,57,57,51,45,50,100,97,51,45,52,98,54,98,45,57,54,97,99,45,50,56,55,57,100,98,51,97,50,56,98,100,212,114,70,150,166,112,114,101,115,101,116,175,97,108,108,111,119,82,101,115,112,111,110,115,105,118,101,164,115,105,122,101,166,99,111,111,114,100,115,170,115,99,101,110,101,83,99,97,108,101,165,99,111,108,111,114,164,99,114,111,112,194,146,205,2,6,205,2,6,146,0,0,1,106,0,0,0,203,63,224,0,0,0,0,0,0,212,114,71,156,168,99,97,116,101,108,111,103,115,169,109,97,116,101,114,105,97,108,115,166,105,109,97,103,101,115,166,118,105,100,101,111,115,166,99,111,108,111,114,115,166,97,117,100,105,111,115,169,112,97,114,116,105,99,108,101,115,165,102,111,110,116,115,169,118,97,114,105,97,98,108,101,115,163,108,105,98,168,117,115,101,114,65,80,73,115,172,117,115,101,114,87,101,98,104,111,111,107,115,212,1,0,94,212,1,0,94,212,1,0,212,114,72,147,179,109,97,116,99,97,112,95,114,101,102,108,101,99,116,105,111,110,95,52,182,109,97,116,99,97,112,95,114,101,102,108,101,99,116,105,111,110,95,108,105,110,101,179,109,97,116,99,97,112,95,114,101,102,108,101,99,116,105,111,110,95,53,212,114,73,146,164,100,97,116,97,164,110,97,109,101,197,139,80,255,216,255,224,0,16,74,70,73,70,0,1,1,0,0,1,0,1,0,0,255,219,0,132,0,2,2,2,2,2,2,2,2,2,2,3,3,2,3,3,4,3,3,3,3,4,6,4,4,4,4,4,6,9,5,6,5,5,6,5,9,8,9,7,7,7,9,8,14,11,9,9,11,14,16,13,12,13,16,19,17,17,19,24,23,24,31,31,42,1,2,2,2,2,2,2,2,2,2,2,3,3,2,3,3,4,3,3,3,3,4,6,4,4,4,4,4,6,9,5,6,5,5,6,5,9,8,9,7,7,7,9,8,14,11,9,9,11,14,16,13,12,13,16,19,17,17,19,24,23,24,31,31,42,255,194,0,17,8,4,56,4,56,3,1,34,0,2,17,1,3,17,1,255,196,0,48,0,0,3,1,1,1,1,1,1,1,0,0,0,0,0,0,0,2,3,4,1,0,5,6,7,8,9,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,218,0,12,3,1,0,2,16,3,16,0,0,0,253,72,132,131,33,32,140,72,50,18,8,192,194,48,32,200,116,50,18,8,192,194,220,35,76,72,210,194,11,112,130,222,35,75,52,211,19,52,132,206,44,35,119,180,45,205,52,187,78,44,35,183,136,194,237,56,187,76,46,35,54,191,104,249,189,251,191,96,252,181,191,177,220,126,61,232,126,169,167,230,245,125,247,31,20,239,173,195,229,139,233,64,249,225,250,0,62,120,62,129,103,206,167,233,20,124,210,126,153,71,205,47,232,208,120,7,234,78,75,186,161,172,140,139,53,46,15,68,130,208,48,200,12,38,40,198,24,16,222,226,7,123,78,33,35,187,120,206,222,7,183,128,226,192,112,176,28,49,7,15,1,19,192,68,176,193,46,3,11,0,195,192,65,130,8,158,1,133,128,9,224,2,193,3,139,143,230,99,3,12,128,195,32,32,204,12,35,29,12,128,194,48,32,200,72,34,18,8,192,205,49,51,75,8,34,18,8,176,141,44,35,75,8,210,19,52,132,141,44,35,119,180,210,194,56,176,142,46,176,151,126,187,234,15,204,126,131,244,250,79,136,250,31,108,137,218,221,3,79,129,226,195,51,112,28,209,48,72,65,2,16,0,214,10,204,0,83,86,41,77,88,149,61,68,233,165,68,136,177,36,51,122,40,60,160,244,102,23,95,159,41,245,109,248,87,31,108,95,53,238,22,144,16,210,91,66,98,92,110,111,29,189,193,119,105,157,188,102,22,3,197,128,225,96,56,92,6,30,1,196,32,225,112,24,88,8,159,0,39,128,97,136,24,98,8,158,0,39,128,11,4,14,46,63,152,200,76,35,2,24,64,65,144,144,100,36,25,1,6,66,65,144,24,70,6,105,137,154,98,102,150,16,69,132,22,225,5,184,65,22,104,69,154,105,102,133,189,161,110,25,197,103,214,159,25,244,95,125,233,31,57,244,111,104,45,210,52,176,130,208,208,184,120,60,28,12,71,2,17,192,132,68,32,193,52,68,2,12,3,67,0,229,234,206,95,1,138,37,130,163,88,181,49,98,82,229,8,75,212,75,61,105,34,151,208,156,243,35,245,230,55,232,190,70,35,245,250,127,18,250,99,244,150,121,62,160,238,194,51,123,141,220,35,187,180,206,222,7,11,129,19,192,112,176,28,44,7,11,128,194,192,112,176,28,44,3,15,0,195,16,68,240,12,44,3,11,0,22,8,28,92,127,47,152,24,100,6,25,1,134,64,97,24,16,100,6,17,137,4,98,65,48,12,34,19,8,132,130,49,32,139,8,211,18,52,196,130,220,32,183,8,45,194,8,175,251,19,228,254,195,232,107,23,102,52,39,1,134,96,65,146,248,110,175,134,106,184,110,47,6,114,176,96,128,140,197,136,193,94,6,32,1,136,0,98,0,24,0,132,188,3,67,0,229,234,142,94,172,197,234,193,83,20,45,77,80,164,185,66,19,66,73,167,173,36,82,223,57,230,199,235,200,120,191,69,230,68,126,205,244,127,204,223,70,126,239,159,57,244,135,16,232,91,220,119,119,25,197,128,246,240,28,88,14,22,3,134,32,225,96,24,120,8,158,1,134,32,137,224,24,98,8,158,2,12,16,48,196,14,46,63,151,13,102,25,129,6,96,65,144,24,100,38,105,137,132,96,97,152,16,70,38,105,137,4,98,65,22,16,68,36,17,9,133,162,97,16,144,68,95,74,120,191,93,235,250,6,88,47,13,202,104,214,36,198,154,72,105,43,135,106,116,111,43,134,226,184,111,40,70,242,176,96,175,6,98,132,104,172,67,197,136,98,0,48,0,3,16,16,128,64,32,17,52,49,97,47,128,192,224,49,122,179,22,75,5,76,88,165,53,98,20,245,19,162,149,18,207,98,72,36,244,166,60,184,61,169,15,159,250,255,0,14,3,250,43,219,254,77,253,28,253,187,99,176,238,222,59,55,129,226,192,112,196,28,44,51,55,128,195,192,56,176,12,49,7,11,1,19,192,68,196,12,49,4,79,0,195,16,59,120,254,89,53,152,100,36,25,129,132,96,192,200,12,35,19,8,192,194,48,48,140,72,35,3,8,132,194,33,32,247,8,34,18,8,197,166,122,190,143,209,10,245,70,145,148,41,195,92,147,30,105,33,228,130,28,72,33,220,174,29,201,225,220,158,29,137,193,216,172,28,42,193,184,161,26,43,17,160,2,48,86,35,5,98,48,0,67,21,224,66,0,24,8,4,34,38,134,1,161,192,112,112,24,26,0,172,128,21,49,98,214,197,138,83,150,33,52,164,153,21,164,142,107,144,121,178,122,179,30,47,157,244,17,30,119,238,63,136,121,103,246,70,255,0,54,126,254,122,157,218,102,22,3,197,128,225,96,56,88,96,150,3,133,128,225,96,28,88,6,24,129,135,128,97,96,24,120,0,158,1,219,199,242,169,129,132,98,97,24,144,102,6,17,131,2,48,48,200,72,50,18,12,132,130,49,32,200,72,34,19,8,132,130,44,246,9,254,163,111,27,90,168,28,244,180,123,18,193,198,146,30,73,33,218,157,28,72,209,218,142,31,137,225,220,158,27,138,225,184,172,27,137,193,194,172,25,138,193,162,161,26,43,17,160,188,12,64,70,0,8,96,34,24,8,6,33,134,136,137,163,130,96,240,26,28,7,6,129,139,32,4,12,5,129,128,165,180,4,42,133,19,38,165,17,207,114,15,62,111,74,99,202,135,218,144,249,224,245,224,63,122,253,27,248,159,245,51,250,27,18,240,120,176,28,44,7,11,129,194,19,51,120,12,60,3,11,1,194,192,68,176,17,49,7,11,1,18,192,123,120,254,82,49,32,204,12,51,3,12,132,194,48,48,200,12,50,19,8,192,131,48,48,136,72,51,2,12,128,131,110,123,65,123,41,184,117,72,160,123,208,209,237,157,131,216,130,30,104,33,250,157,29,169,209,252,158,29,168,225,220,158,29,138,193,216,172,27,138,193,184,158,26,42,193,184,161,27,138,193,130,177,26,43,17,130,2,48,87,129,226,240,48,17,11,3,2,12,19,71,4,209,193,52,120,76,13,19,0,132,17,220,22,12,0,1,128,41,110,2,112,122,201,147,90,136,209,106,79,62,127,74,115,203,143,216,148,240,188,159,167,128,103,244,223,242,98,207,237,62,248,95,187,7,183,12,194,192,112,176,193,49,7,11,1,194,192,48,240,17,49,7,8,65,194,192,68,196,30,222,63,148,76,12,38,1,6,96,97,144,152,70,6,17,137,6,96,65,152,16,70,12,8,132,131,33,32,218,191,88,119,166,139,10,42,158,130,135,78,226,134,206,193,236,65,20,18,8,121,32,135,106,116,126,163,71,114,120,119,39,135,98,184,111,39,134,226,120,118,39,6,242,112,104,175,6,114,132,110,43,6,98,196,102,47,3,197,224,120,190,11,3,3,1,192,196,48,49,28,52,115,13,30,19,71,132,209,236,48,8,65,18,19,0,176,0,60,22,182,136,165,188,9,193,224,76,170,212,70,155,82,67,63,162,131,203,147,215,152,240,252,207,165,128,249,111,232,63,196,252,115,251,123,191,11,253,204,220,220,51,11,1,194,224,48,176,28,33,51,11,1,18,192,112,132,28,44,3,12,65,237,227,249,60,192,195,33,32,204,12,50,6,4,96,97,24,24,100,36,25,172,194,49,32,200,12,45,71,164,81,233,77,105,77,83,208,80,249,220,80,217,216,80,104,96,227,73,141,37,176,61,29,15,67,66,208,224,248,56,62,94,13,197,224,220,86,13,197,96,220,86,13,197,96,220,80,142,21,224,204,94,12,197,136,209,1,25,129,129,224,96,120,24,30,15,29,221,198,118,241,152,124,47,155,194,177,250,78,53,241,38,91,196,3,233,113,229,15,172,39,144,191,105,103,140,30,202,79,40,125,4,145,174,181,19,3,196,149,117,44,145,54,168,134,127,65,39,153,47,173,57,225,249,191,71,9,242,127,169,252,71,145,31,218,125,252,233,253,23,93,133,134,102,240,57,188,14,22,3,132,32,225,112,24,88,6,24,130,38,32,246,241,252,154,64,97,152,24,102,4,25,129,134,107,48,204,12,50,2,24,64,65,152,16,115,162,194,175,74,91,138,107,154,130,154,38,113,75,103,164,55,117,32,56,136,227,206,25,170,209,188,172,29,201,225,220,156,27,202,193,184,174,27,137,225,184,172,27,138,225,152,172,27,138,193,184,188,25,139,193,156,172,25,139,225,152,188,25,203,224,240,120,46,14,15,131,134,112,104,122,28,51,128,130,32,208,201,102,17,1,7,162,65,24,48,226,227,3,88,66,70,179,60,229,123,26,124,252,223,82,39,197,199,247,114,31,14,159,176,243,15,158,95,167,33,18,172,89,10,47,81,230,201,235,78,120,112,123,241,159,43,250,55,202,121,17,253,151,223,128,126,255,0,93,221,192,225,97,130,88,96,150,3,133,128,225,8,56,88,14,110,3,219,199,242,89,172,195,48,48,140,12,51,3,12,128,195,32,48,200,72,51,89,133,8,168,183,211,146,242,171,37,164,169,243,216,50,182,92,46,174,209,132,174,29,201,209,220,158,29,201,225,220,158,27,201,225,188,158,27,201,193,216,172,27,138,193,188,161,27,202,193,184,172,27,138,193,188,172,27,139,193,184,174,25,202,225,156,174,27,129,131,53,92,51,87,195,57,122,25,47,134,106,244,110,175,70,18,200,102,129,6,64,65,152,104,210,89,134,96,67,12,12,51,3,13,139,96,102,6,30,241,138,69,236,62,119,199,251,181,159,151,121,159,171,248,135,231,106,250,95,24,243,81,232,36,243,36,245,230,60,88,61,232,227,229,191,94,252,235,201,175,236,108,252,195,245,3,48,132,204,44,7,11,128,19,16,112,176,28,33,48,75,1,238,227,249,36,192,194,96,16,102,6,25,1,134,66,97,16,144,102,179,14,82,240,10,189,120,189,18,187,100,172,170,181,123,226,253,82,49,132,157,27,202,225,220,158,31,200,225,220,158,29,201,225,220,142,29,138,193,216,158,29,137,225,188,156,27,202,193,184,174,26,42,225,188,158,25,202,225,152,190,25,202,225,156,174,25,203,225,156,190,25,203,225,154,173,25,203,209,156,189,27,193,195,117,122,48,150,67,9,100,48,150,99,8,8,51,89,12,53,152,195,89,140,53,176,51,91,6,24,24,108,89,140,98,216,49,138,96,198,45,129,137,176,242,254,123,238,132,252,111,197,253,179,228,143,206,39,247,188,184,243,37,245,165,60,111,59,232,99,175,152,254,141,252,29,49,253,99,158,71,177,88,39,128,230,225,153,184,14,22,2,37,128,225,136,29,188,127,35,144,24,205,18,24,64,97,154,204,51,2,12,192,194,238,249,160,109,131,213,44,186,75,74,189,133,253,65,214,175,134,242,120,119,43,134,242,184,119,39,135,114,120,119,39,134,242,120,118,43,7,114,56,111,39,7,98,176,118,43,7,10,176,118,43,7,98,176,111,43,6,242,176,111,43,134,226,248,103,47,134,242,184,102,175,134,114,248,111,47,70,106,180,97,40,131,37,232,194,89,13,208,209,134,163,24,64,67,13,70,48,214,67,73,108,12,192,195,98,204,97,173,131,24,163,26,107,104,108,89,140,98,216,52,214,193,140,91,6,177,108,24,182,180,249,111,129,253,167,206,63,0,151,244,255,0,131,60,57,125,121,143,19,205,250,40,96,127,164,191,151,62,246,191,107,238,224,120,132,28,44,7,55,128,195,16,112,176,14,222,63,145,13,102,25,172,195,98,204,51,2,12,214,99,9,106,34,249,249,125,50,255,0,66,43,139,126,138,63,180,24,245,224,220,87,13,229,112,222,79,14,228,232,222,78,141,228,240,236,79,14,228,224,236,86,14,197,96,236,79,13,228,224,238,78,14,197,96,236,86,13,229,112,220,94,13,229,112,222,87,13,229,104,205,87,13,229,104,205,86,141,229,240,222,14,27,203,33,154,178,25,171,33,134,162,24,107,32,205,100,52,214,67,13,102,48,150,99,24,166,6,197,152,195,3,24,197,48,99,20,193,134,6,49,139,96,198,45,129,177,108,26,197,152,214,169,163,88,182,13,106,154,35,227,126,251,15,231,143,39,247,79,202,207,149,151,215,152,240,124,175,167,243,227,245,175,183,254,103,254,138,46,205,202,204,33,48,75,1,194,192,68,176,30,222,143,228,19,89,209,154,216,25,1,134,64,97,144,24,127,17,235,124,169,233,122,144,122,37,222,247,149,250,33,117,75,193,162,172,29,201,193,220,158,29,138,225,216,172,31,138,193,220,142,29,201,225,188,156,29,201,225,216,158,28,42,193,216,172,29,137,225,188,172,29,201,225,188,174,27,202,193,220,157,27,169,225,186,173,25,170,209,188,190,27,203,209,154,189,27,170,33,154,178,25,161,163,9,100,48,150,99,9,100,52,150,99,13,102,48,128,195,48,33,140,89,140,48,49,140,89,140,48,49,140,91,3,98,216,48,192,198,53,102,52,214,193,141,83,70,53,76,28,197,52,99,84,209,173,83,66,249,175,167,51,249,243,192,253,251,242,3,229,162,246,164,143,158,250,63,63,203,175,233,46,248,207,180,7,11,1,194,192,68,176,28,44,7,183,143,227,227,89,134,197,144,194,2,24,64,67,22,127,14,121,62,135,155,235,151,250,62,127,214,31,73,244,232,209,162,172,27,201,225,188,158,27,201,225,220,158,29,201,193,248,158,29,200,225,216,158,29,137,225,220,142,27,201,225,216,158,27,201,225,188,158,29,138,225,188,174,27,202,225,186,158,27,170,209,188,173,24,74,225,186,173,27,203,209,186,173,24,75,209,186,179,8,212,67,116,52,97,172,134,18,204,97,44,198,26,140,105,44,198,154,204,97,172,198,49,102,48,192,198,49,77,13,139,96,195,3,24,197,152,214,44,198,53,76,24,192,49,140,91,67,106,218,49,170,96,214,169,131,152,166,141,106,154,23,202,125,118,159,206,62,79,237,95,147,30,23,159,239,69,30,79,239,191,131,125,149,126,156,37,128,225,96,56,88,14,16,131,219,199,241,225,1,134,64,97,152,16,194,91,8,63,46,244,98,61,79,83,206,244,79,91,245,31,145,251,193,194,176,27,138,193,188,158,27,201,193,220,156,31,201,193,248,158,29,201,193,220,158,27,201,193,220,156,29,201,193,220,142,29,201,193,220,158,27,201,225,220,158,29,201,225,220,174,26,72,209,218,157,29,202,209,220,173,27,203,33,186,162,24,74,33,132,178,25,171,49,132,163,24,75,33,134,163,12,214,67,73,102,48,214,99,24,163,26,64,67,141,76,24,197,152,198,44,198,48,12,97,131,6,49,76,24,197,176,99,22,99,88,179,26,96,193,140,91,6,49,108,26,213,52,99,22,193,141,83,70,181,45,28,212,180,31,204,63,86,132,254,113,147,237,126,94,60,63,59,232,60,227,245,207,83,242,143,214,40,115,120,28,33,7,11,1,238,227,248,228,214,99,8,8,97,1,12,241,189,143,200,207,51,220,242,61,131,211,246,124,111,182,62,235,208,71,13,20,224,220,79,13,228,240,236,79,14,228,224,252,79,14,196,224,238,79,14,196,240,236,79,14,196,240,236,86,14,228,224,238,79,14,228,240,221,71,14,229,112,238,87,13,212,144,221,78,142,213,104,221,86,141,213,232,210,73,13,37,16,237,73,140,53,16,194,2,24,75,49,132,178,24,75,49,134,178,24,107,49,134,179,24,107,96,195,3,24,197,48,99,22,192,216,182,12,98,204,107,22,99,26,179,24,192,96,108,3,24,192,96,108,3,24,197,176,99,22,209,140,3,26,197,176,99,1,131,26,179,28,212,180,113,131,15,152,252,111,250,43,243,19,243,8,125,168,207,158,253,107,243,107,227,245,60,44,161,205,224,115,112,30,222,63,141,141,102,25,1,134,107,51,197,252,115,222,241,79,91,214,242,189,67,213,253,91,243,159,213,75,69,64,59,18,35,185,56,59,21,131,185,28,59,147,131,185,56,63,145,195,177,60,59,19,131,241,60,59,19,131,249,28,59,147,131,249,28,63,145,195,181,60,59,149,195,181,26,63,83,163,117,90,59,82,67,181,36,56,146,67,73,70,48,148,99,9,102,48,150,67,13,70,48,214,97,154,140,97,172,134,26,204,97,172,198,49,102,48,214,193,134,182,12,98,204,105,129,140,98,216,49,128,99,24,182,12,98,216,49,139,96,198,1,140,48,96,198,45,131,24,6,49,139,104,198,45,161,177,109,24,197,176,107,20,193,173,83,6,181,76,29,230,122,68,126,9,225,254,177,249,161,226,249,127,65,231,159,160,250,255,0,155,254,144,14,22,3,133,128,247,113,252,102,107,48,205,102,31,157,232,126,86,124,79,175,228,123,7,171,233,121,158,161,247,191,125,242,255,0,66,55,18,35,177,34,63,17,195,185,28,63,19,131,249,28,59,147,131,185,56,63,17,195,241,56,63,19,131,241,60,59,145,195,185,60,59,147,195,185,58,59,147,163,181,58,52,144,67,181,58,60,144,67,73,36,59,84,67,73,100,52,148,99,73,102,27,18,99,73,100,52,150,99,13,70,48,128,134,26,204,97,172,198,144,24,195,3,13,139,96,198,45,131,24,182,6,213,48,99,22,208,218,166,134,192,96,195,6,6,213,176,99,22,208,216,182,134,197,176,54,3,6,53,108,13,128,193,140,91,6,49,108,24,192,96,198,45,161,181,77,24,197,176,135,241,207,220,255,0,62,63,49,135,217,136,240,63,79,252,251,218,62,215,55,1,226,16,123,184,254,49,37,152,194,2,7,249,207,245,127,198,143,91,215,242,61,99,213,246,188,31,167,63,78,244,33,112,241,72,143,196,112,236,79,14,228,112,238,71,14,228,224,252,78,15,196,240,238,70,15,196,224,252,79,14,228,112,254,78,15,228,112,254,71,15,212,104,254,78,143,228,232,253,78,142,36,232,242,65,15,36,232,227,73,15,36,152,226,83,6,26,140,105,168,198,26,200,105,44,198,26,140,97,172,198,49,102,48,212,193,134,6,49,138,96,198,41,131,76,12,99,86,99,76,24,49,139,96,198,45,131,24,12,13,171,96,198,1,140,98,216,49,128,99,24,6,49,128,192,216,12,24,197,176,54,3,6,24,48,99,22,193,140,91,6,53,76,24,213,52,63,47,212,195,240,207,51,238,62,70,60,120,125,159,52,253,20,252,31,122,135,183,1,237,227,248,176,214,97,154,227,63,22,249,223,62,243,214,245,60,159,76,244,254,211,226,62,236,251,242,155,71,226,56,119,35,135,98,56,127,35,7,242,56,119,35,135,242,48,127,35,135,114,56,118,39,135,114,112,127,35,135,242,56,127,35,71,242,52,113,35,71,106,116,127,36,135,26,8,113,36,198,154,72,113,36,135,154,76,113,41,131,26,134,14,37,48,97,168,198,144,16,210,89,140,53,152,211,89,140,53,176,54,44,198,49,108,13,128,99,12,24,27,1,131,24,182,12,106,154,27,84,209,140,3,24,192,96,198,45,131,24,12,13,128,99,24,13,9,128,208,154,6,48,193,161,52,12,99,22,193,140,3,13,128,192,218,166,12,96,24,198,41,131,12,12,249,127,204,191,104,252,164,240,32,246,34,38,251,143,207,126,240,118,110,25,221,199,241,81,172,195,252,231,244,95,231,211,229,253,31,47,210,61,127,71,202,244,143,75,244,31,206,191,68,62,195,103,226,140,159,135,242,48,127,35,135,226,112,127,35,10,49,24,81,137,193,248,156,29,201,193,252,140,31,200,225,251,63,20,116,250,63,81,163,246,125,31,169,209,196,157,28,73,209,230,130,30,73,49,196,147,28,74,49,166,163,28,212,48,113,44,198,177,38,56,212,99,73,102,49,138,96,195,89,141,53,176,54,1,140,53,176,99,22,99,24,182,12,98,216,49,139,96,198,1,140,106,218,27,1,129,180,24,49,139,104,108,6,6,213,180,38,131,3,96,48,54,3,3,96,52,54,45,161,53,108,13,128,192,216,182,6,192,96,102,38,27,22,192,216,6,48,129,134,126,113,250,87,200,159,157,199,233,203,30,47,179,8,31,93,155,149,157,220,127,20,26,204,71,242,191,238,255,0,207,229,190,143,153,232,30,175,161,229,222,122,191,161,254,111,250,1,245,187,55,20,116,218,81,200,193,252,142,31,200,225,248,142,31,136,225,252,142,29,200,194,140,71,15,233,248,127,35,71,242,52,118,163,71,106,116,126,163,71,234,8,121,32,135,156,230,60,144,99,201,6,61,136,49,205,67,7,18,216,49,168,96,246,33,163,24,163,26,197,24,211,89,140,53,176,99,20,193,164,6,53,138,96,198,45,131,12,24,27,22,208,216,12,24,192,96,108,6,12,98,218,49,139,104,109,91,70,24,48,99,1,129,181,108,13,160,192,216,12,13,130,97,176,26,19,86,208,143,12,51,19,24,96,97,176,76,51,19,9,128,192,152,6,27,22,97,248,254,196,167,229,17,123,126,89,230,121,158,223,156,125,49,249,158,145,221,220,127,19,16,17,248,183,229,254,247,207,23,250,30,101,231,169,119,153,113,234,125,231,231,191,108,125,143,75,165,91,55,20,236,186,83,211,240,254,71,15,196,112,252,71,15,228,112,254,70,15,228,112,254,71,15,228,112,253,71,20,114,52,121,78,67,202,125,40,41,200,160,144,67,205,4,80,104,49,230,131,30,201,216,61,168,96,246,164,199,49,44,26,197,48,107,20,99,88,163,26,197,152,198,45,131,24,166,12,98,216,49,139,96,198,45,131,24,6,27,86,208,218,182,12,98,216,49,160,193,140,91,67,96,48,99,86,208,216,44,13,128,192,218,12,13,128,192,216,12,24,192,48,218,182,134,98,97,176,24,25,139,2,49,48,204,76,51,6,6,96,97,53,108,8,196,130,3,227,243,223,11,234,254,108,243,160,245,162,39,246,254,127,232,14,236,227,248,154,74,126,56,254,121,21,233,117,254,109,199,163,119,153,121,232,253,135,196,125,73,247,7,11,138,186,110,42,217,116,167,166,210,142,159,138,49,56,63,167,226,140,71,15,233,248,127,35,135,242,120,127,35,138,54,125,40,217,200,121,78,69,26,130,28,201,200,123,39,49,230,131,30,217,216,56,210,209,172,75,10,24,134,148,49,13,28,196,176,107,82,99,152,150,14,98,88,53,138,96,214,45,131,24,182,12,98,204,113,173,131,26,166,12,96,48,99,22,193,172,91,6,53,108,24,192,96,198,173,161,181,109,13,171,104,109,6,6,213,180,54,3,3,96,176,54,3,3,96,52,38,3,3,49,96,76,19,13,128,97,152,176,214,9,132,192,48,204,76,214,1,132,96,97,110,17,242,255,0,39,246,191,30,65,39,163,41,226,251,62,125,5,125,221,31,196,191,147,126,175,248,29,126,121,170,34,250,252,250,207,70,239,50,242,255,0,161,249,159,96,251,218,124,139,202,118,93,42,233,248,167,102,210,142,159,71,242,48,163,17,195,249,28,81,136,225,252,142,40,233,244,126,207,165,27,62,148,20,228,81,168,33,231,57,20,28,230,61,147,153,65,161,131,155,59,71,177,13,30,106,49,206,67,71,181,13,30,212,48,115,20,193,172,83,7,26,154,53,138,96,214,41,163,26,166,140,98,218,27,86,193,140,91,6,177,108,24,213,176,99,1,131,24,12,13,160,193,140,6,134,213,180,54,131,6,48,26,27,86,208,154,13,9,130,192,154,12,13,128,192,204,88,25,139,2,96,48,35,22,4,98,97,152,50,8,196,232,140,12,50,19,8,132,205,44,211,200,248,223,182,248,242,9,111,152,242,213,100,101,221,221,31,196,95,204,127,210,159,202,85,1,47,139,108,243,235,61,11,124,234,143,67,210,242,46,62,219,213,249,175,108,168,165,210,146,151,74,182,93,41,233,248,163,145,197,29,63,15,228,112,254,71,20,116,250,81,200,226,141,159,74,53,4,60,167,34,130,65,20,28,230,80,72,49,236,157,131,219,59,71,182,118,143,98,26,80,212,52,115,144,225,204,75,71,53,44,30,106,96,214,169,131,90,166,14,98,152,53,139,104,198,41,195,24,182,140,98,218,49,139,104,198,45,161,180,24,49,128,193,140,6,134,208,96,109,6,12,106,218,49,128,208,216,13,13,130,192,216,38,27,65,129,176,76,51,195,9,130,97,176,76,38,9,132,98,97,152,152,71,132,17,139,13,49,51,76,72,35,18,11,115,79,63,228,126,195,228,200,102,182,115,206,243,189,127,54,40,225,227,248,23,249,143,250,11,249,230,165,224,226,186,161,168,244,42,243,234,61,10,252,218,143,166,247,254,67,232,143,83,167,226,174,155,74,74,82,40,41,116,167,167,226,142,159,138,58,125,40,233,244,126,163,138,54,125,40,212,105,65,78,69,5,57,20,156,198,80,115,153,65,206,194,134,78,210,134,33,133,13,153,165,13,67,74,28,134,143,114,26,61,169,96,230,165,163,152,166,141,106,90,53,170,104,214,41,193,181,108,26,213,48,107,84,209,172,91,6,177,109,24,192,104,109,91,67,104,52,54,173,163,24,13,13,171,112,109,91,67,104,52,54,11,3,104,52,38,131,66,96,176,38,97,132,193,96,71,134,17,227,13,96,152,70,38,17,139,13,60,32,140,76,35,3,53,128,102,152,145,187,132,67,242,223,83,243,36,72,173,17,15,157,235,65,82,118,113,254,109,126,25,251,15,227,132,153,130,83,76,84,23,209,21,37,244,67,73,234,125,7,202,123,103,209,28,45,40,41,116,164,165,34,157,155,74,122,98,31,179,232,253,159,71,236,228,59,81,163,202,125,40,41,200,160,167,34,130,156,202,14,118,20,50,102,20,54,118,15,108,237,30,217,220,80,233,220,61,200,120,246,161,195,218,135,14,106,90,53,201,104,230,165,163,152,166,142,98,154,53,170,104,214,45,163,26,182,13,106,154,53,171,96,198,173,163,26,182,134,213,180,99,86,208,218,13,13,160,193,141,6,134,213,184,54,131,6,53,110,9,160,208,216,44,9,152,192,143,24,107,48,194,96,152,70,44,52,240,205,96,152,69,134,105,225,4,98,97,111,20,105,9,209,110,17,187,154,65,243,159,69,224,18,162,164,145,69,232,197,30,87,23,87,249,111,249,71,233,127,153,146,47,64,109,18,60,182,168,104,46,162,26,11,189,63,30,163,233,234,241,239,43,233,248,164,165,210,173,151,138,246,110,42,233,244,163,145,197,27,57,15,212,16,242,156,135,156,228,60,144,99,217,57,148,28,236,40,100,236,41,108,205,40,116,206,30,233,220,80,233,220,80,233,222,61,200,112,246,161,195,218,134,143,106,90,61,169,104,230,165,195,88,182,141,98,218,53,169,112,214,169,163,90,167,12,106,218,49,171,104,198,169,163,28,182,134,208,104,109,6,134,208,104,109,6,134,208,104,110,6,134,208,104,109,6,132,209,105,172,227,53,156,102,179,12,214,97,154,120,102,158,16,70,38,17,97,154,98,113,165,135,90,88,65,110,17,165,132,111,118,30,119,137,236,249,36,201,165,68,113,250,17,158,47,31,71,249,59,249,223,223,124,5,68,179,72,198,206,194,218,33,164,181,241,60,186,136,94,123,94,159,207,250,71,169,179,105,70,205,165,5,54,148,236,218,84,82,145,78,207,163,245,60,83,168,33,231,57,20,20,228,82,83,176,160,231,96,246,78,194,134,204,210,150,206,210,135,78,225,239,157,197,14,67,138,29,59,138,31,51,199,185,14,28,212,184,115,146,209,205,75,135,53,78,26,213,52,107,86,193,173,83,134,181,77,26,213,180,107,84,209,173,83,134,53,109,24,213,180,99,86,209,141,6,134,229,180,99,86,225,140,6,140,104,56,38,139,67,104,180,38,139,77,110,25,173,195,52,248,206,62,35,79,140,195,226,52,176,205,49,51,75,136,211,19,56,196,205,44,211,75,8,209,32,60,175,55,208,136,66,105,81,36,119,201,30,39,31,31,228,119,194,125,207,194,212,51,190,115,88,131,41,124,84,23,62,23,150,209,5,5,222,135,143,97,237,183,206,164,163,103,210,142,71,20,108,250,84,82,145,86,206,69,5,49,148,20,228,80,72,49,228,131,30,115,180,121,160,202,89,59,10,29,43,138,93,51,202,29,59,138,31,51,138,157,45,5,14,157,227,222,135,20,58,119,143,106,90,61,200,112,230,169,195,154,166,142,106,156,53,170,104,214,169,195,90,166,141,114,154,49,203,104,198,173,195,26,182,140,114,156,27,65,163,26,182,140,114,218,49,160,209,142,91,70,57,110,13,162,209,141,6,134,209,104,76,195,8,248,205,62,51,143,136,227,226,56,248,142,46,35,139,136,210,194,52,196,130,33,35,76,72,221,205,57,109,65,229,203,74,4,169,234,38,146,217,79,19,139,163,252,136,248,111,187,248,106,243,38,166,80,116,56,123,102,105,91,227,121,99,163,121,99,225,121,234,213,228,216,95,211,17,70,206,69,29,62,148,148,198,83,179,145,73,74,210,141,157,133,37,57,148,28,228,82,217,88,82,201,216,82,196,48,161,211,56,161,243,184,161,243,80,61,243,188,161,243,188,123,231,160,115,208,241,238,67,199,57,46,28,228,184,107,208,225,206,75,198,185,46,26,213,56,107,84,209,205,83,134,181,77,28,213,52,107,148,209,173,91,70,57,78,24,213,180,99,150,209,173,91,70,57,111,13,202,120,110,6,140,112,56,54,139,67,104,180,214,227,13,62,97,199,198,113,241,28,92,102,22,233,197,196,113,118,155,189,176,91,135,92,88,70,238,17,187,154,116,149,194,66,166,128,149,61,68,242,89,33,226,247,116,127,145,159,9,250,15,192,87,147,37,177,10,204,17,140,78,149,62,54,150,62,23,151,54,39,22,213,231,56,245,14,39,21,116,250,81,168,226,162,152,138,74,109,41,108,218,84,201,136,168,231,34,150,204,194,134,78,194,134,206,210,134,206,210,167,74,226,183,76,226,151,204,242,151,204,226,170,37,160,165,243,80,80,249,220,61,232,112,247,33,195,222,135,14,114,92,57,201,112,231,37,195,154,166,141,114,94,53,170,112,214,173,163,92,166,141,106,156,53,170,112,199,45,163,90,182,140,114,220,27,212,225,142,91,134,52,28,49,192,209,173,91,195,112,56,39,3,66,102,48,35,198,26,120,103,31,17,197,198,97,113,70,23,21,118,241,24,88,70,238,17,164,36,110,246,157,189,160,65,108,2,1,128,41,79,73,60,150,200,120,93,157,31,228,199,231,191,164,254,113,94,68,62,143,158,76,182,40,45,94,143,57,216,82,233,26,86,248,158,86,232,216,95,71,156,242,198,74,69,58,141,40,57,136,160,230,97,65,76,194,150,70,226,163,149,197,37,59,10,155,51,10,95,35,138,157,35,202,157,51,138,157,53,5,46,67,202,31,59,202,95,59,202,95,51,202,95,59,199,209,59,199,181,47,28,244,56,123,146,225,175,75,135,57,46,28,213,56,107,148,209,205,83,134,185,77,28,213,56,107,146,225,173,91,70,57,109,26,213,184,99,150,225,141,91,134,57,110,26,229,60,99,212,241,142,91,195,112,52,55,45,193,52,88,17,139,13,60,51,75,136,210,195,48,183,142,222,35,183,180,237,222,56,176,142,44,211,119,184,221,206,17,21,82,128,12,1,74,114,137,228,178,51,231,184,58,63,202,175,205,127,79,252,206,188,159,55,213,243,72,82,244,3,195,195,13,4,80,217,88,84,216,218,90,201,26,86,248,92,90,200,94,82,114,145,94,32,138,78,83,42,41,140,168,230,97,83,101,97,75,165,97,91,99,121,99,38,105,83,167,113,77,18,80,86,249,94,84,249,158,84,249,168,42,124,180,20,209,53,5,15,67,199,189,15,30,228,60,123,144,241,206,75,135,185,46,30,228,56,123,82,225,206,75,135,57,45,28,229,52,115,84,225,143,75,198,181,109,24,229,56,107,148,225,173,91,71,53,110,26,229,60,107,148,241,174,91,134,185,110,24,229,184,54,131,66,104,48,38,9,132,98,102,158,25,197,132,110,246,157,189,167,118,233,221,218,110,225,28,89,166,144,145,192,105,137,148,193,165,137,136,149,61,36,241,91,17,243,28,174,143,242,247,243,31,212,191,50,175,27,206,245,124,211,205,154,201,4,142,128,68,190,28,104,34,134,76,194,179,149,133,109,141,165,110,133,165,140,144,202,89,41,148,50,98,41,57,140,169,178,176,165,178,180,176,229,97,99,164,105,91,229,160,165,242,208,86,249,40,43,162,74,10,168,150,130,170,36,160,170,137,158,84,249,169,40,124,239,41,124,212,20,57,15,30,228,184,123,146,225,238,67,199,181,47,28,228,180,115,148,225,205,83,134,185,77,28,228,184,107,148,225,173,91,134,57,78,26,228,188,107,148,241,142,83,198,189,79,24,245,60,99,214,225,174,91,134,53,110,24,213,176,54,129,134,120,97,22,25,166,36,105,97,28,93,167,110,105,189,218,118,230,154,66,71,111,105,189,154,98,27,56,177,49,5,108,1,73,122,73,160,191,205,62,79,149,209,254,100,124,7,219,124,165,124,191,157,234,249,231,151,23,163,9,34,158,131,51,48,102,168,134,178,115,40,100,166,86,201,26,82,216,220,84,114,52,172,165,97,86,206,101,71,49,149,148,205,42,108,141,43,116,110,43,108,175,43,124,148,21,209,29,5,148,199,73,93,18,80,85,76,180,20,209,59,202,105,150,146,170,38,160,165,243,188,161,243,188,161,232,120,247,161,197,14,67,199,185,46,30,228,60,115,84,225,206,67,199,57,47,26,229,56,107,148,209,205,83,134,185,78,26,228,184,115,148,225,174,83,135,57,78,28,244,188,107,212,225,207,83,134,185,110,24,229,56,54,173,161,176,12,54,1,134,66,97,16,153,164,36,110,225,29,185,166,247,113,189,218,111,97,27,185,166,230,136,8,98,193,194,16,4,192,82,92,130,127,27,215,249,227,231,59,58,63,203,207,23,214,243,235,227,252,255,0,91,205,60,184,125,56,79,62,122,230,16,36,6,232,112,194,73,14,36,233,67,38,50,147,152,202,155,33,149,50,99,42,100,172,41,100,198,86,217,26,84,232,220,86,233,26,88,233,40,42,166,58,11,40,138,130,218,162,160,178,153,42,42,124,212,21,83,37,69,84,205,65,77,19,82,81,68,239,40,162,122,7,189,15,30,244,56,161,200,120,247,37,195,220,151,142,114,92,57,201,120,215,37,227,154,167,14,114,92,57,170,112,230,169,195,92,166,143,106,156,57,202,112,231,37,227,158,151,142,122,94,57,233,120,214,173,163,90,182,140,106,154,27,86,99,12,12,50,19,11,112,141,49,35,183,52,222,238,11,179,77,238,211,139,52,226,205,56,9,64,142,225,130,66,0,24,10,67,144,73,242,191,79,241,164,61,157,31,229,156,154,154,240,124,207,107,202,60,168,125,72,79,54,75,228,35,85,8,23,220,33,112,240,205,81,13,52,16,243,70,149,20,230,84,201,24,84,115,48,173,146,180,169,146,176,177,178,60,169,210,56,177,210,80,89,68,116,150,83,13,37,180,197,81,101,18,84,85,76,148,150,83,45,5,116,75,73,85,19,82,83,68,212,20,190,119,148,190,119,148,62,122,7,189,15,30,228,184,123,208,225,238,75,135,57,46,30,228,184,115,146,225,206,83,71,57,47,26,229,56,107,146,225,238,75,135,57,78,28,244,184,123,208,241,239,67,199,185,46,28,213,180,107,148,209,141,83,67,96,24,194,3,12,192,131,33,35,119,52,45,206,55,115,77,209,208,187,52,210,29,11,71,140,89,1,153,184,14,16,128,6,177,83,81,41,7,195,253,103,199,153,217,199,249,77,55,32,15,43,210,136,242,224,245,33,60,184,253,40,136,17,92,228,192,213,131,156,48,124,29,76,37,104,226,65,15,57,204,161,147,25,83,37,97,91,37,50,198,200,226,183,200,226,154,34,160,177,241,80,91,76,116,150,83,29,69,148,199,73,93,50,82,87,84,149,21,211,29,69,116,203,81,85,50,212,81,76,212,148,62,122,10,95,53,5,15,67,199,209,59,199,190,122,7,61,15,30,228,184,115,146,241,206,75,135,185,14,30,228,180,123,146,225,206,75,134,189,15,28,228,60,115,210,225,239,67,135,209,59,199,189,15,28,244,56,123,146,209,236,83,70,177,108,24,197,152,195,3,12,132,131,209,208,244,72,222,205,55,115,130,220,211,119,56,34,29,52,116,12,206,227,59,176,193,209,5,76,80,153,41,132,249,207,158,244,124,195,59,56,255,0,38,165,41,77,56,236,60,248,125,56,79,54,47,74,51,206,146,249,8,213,74,4,131,22,103,102,5,195,195,53,122,52,146,69,26,130,41,100,204,41,100,174,43,108,173,44,108,111,43,162,58,10,233,134,130,250,97,168,182,184,43,45,162,42,75,169,138,178,202,100,164,174,168,234,45,170,58,138,233,154,130,170,101,160,166,137,168,41,162,103,148,209,59,202,31,61,3,222,135,20,57,15,40,106,92,61,200,160,115,146,225,237,83,134,189,46,28,228,184,115,146,225,206,75,135,57,46,30,228,60,115,210,209,239,67,199,189,13,40,124,238,30,249,220,61,169,104,214,165,163,77,108,24,107,49,134,178,12,135,66,32,208,180,116,45,29,11,71,66,32,35,119,56,225,225,55,59,142,206,195,0,128,20,177,34,60,203,254,120,249,132,232,153,217,199,249,20,141,156,26,252,209,61,136,125,72,15,54,63,74,51,204,147,209,144,243,231,182,98,85,185,66,133,139,51,179,2,225,224,201,124,52,208,99,153,59,10,29,43,10,219,35,162,186,34,162,172,124,84,22,83,21,37,212,197,73,109,81,82,93,84,53,150,213,21,69,180,197,81,101,81,212,91,92,85,22,83,37,101,84,203,73,69,50,210,83,68,212,20,83,53,5,15,158,129,239,67,199,189,14,40,114,30,57,232,112,247,161,227,156,151,15,114,28,61,200,120,231,33,227,156,151,14,114,92,57,201,112,247,33,195,223,59,202,29,59,138,29,59,138,26,135,15,106,26,61,168,96,230,165,131,77,102,48,128,131,209,208,244,116,45,29,11,71,134,104,104,122,58,111,102,29,221,199,102,225,217,216,98,201,96,33,179,19,124,119,212,124,40,140,225,59,179,143,242,2,125,64,10,236,62,141,81,122,135,153,39,161,41,230,201,232,200,121,147,122,18,144,162,201,201,150,245,11,3,16,123,176,222,206,131,213,237,53,136,49,236,157,133,46,145,197,173,145,241,93,17,209,86,211,21,69,181,69,73,117,81,82,93,76,85,22,217,5,101,181,69,89,101,81,86,91,84,85,22,213,21,69,180,75,65,93,18,208,85,76,180,21,62,106,74,31,61,5,15,157,229,15,158,129,238,67,199,61,15,30,249,220,61,201,112,247,37,195,156,135,143,114,90,61,200,112,231,37,195,156,150,148,53,46,30,228,56,123,144,210,134,161,165,13,67,135,186,103,15,106,26,57,137,96,227,81,141,37,144,194,13,15,71,67,208,208,244,116,34,29,11,71,77,225,227,123,56,222,206,51,56,65,89,168,92,174,132,241,62,79,212,242,78,30,19,187,58,63,199,105,205,21,163,169,51,236,63,63,250,98,249,125,24,207,62,79,66,99,205,147,210,144,243,230,190,82,52,214,130,96,114,197,9,136,61,216,110,143,12,37,16,227,73,20,182,103,20,190,87,21,209,27,203,170,134,162,234,162,164,190,168,106,47,170,26,139,107,138,162,202,226,172,182,168,172,44,178,26,203,42,142,178,186,100,164,174,137,105,42,162,106,10,104,154,130,154,38,160,161,243,188,165,243,80,80,228,56,123,231,121,67,144,226,135,33,197,14,67,135,61,14,30,228,60,115,146,209,237,75,135,57,45,30,228,180,123,82,225,206,67,135,57,13,30,228,52,123,103,112,246,33,163,154,147,28,196,176,105,44,134,234,200,102,129,7,160,65,16,232,122,58,23,15,5,217,167,119,113,217,216,112,104,24,147,156,95,145,232,124,153,225,47,132,225,225,59,179,143,241,188,51,14,134,159,56,75,36,140,253,118,40,189,51,207,150,249,136,36,244,101,60,217,189,25,79,61,23,76,70,170,146,78,183,0,161,96,3,185,129,104,232,102,179,26,212,48,165,211,52,170,137,40,44,178,10,79,66,152,107,47,170,26,203,107,134,178,219,33,172,182,168,170,46,174,26,203,107,142,146,234,225,176,178,137,105,42,166,90,74,168,150,146,154,38,160,169,243,80,82,249,222,80,249,232,40,114,28,61,243,188,161,243,188,123,231,120,247,161,195,218,151,15,114,90,61,200,112,246,165,195,154,151,15,106,90,57,201,104,230,165,195,156,134,143,106,26,61,168,104,230,206,209,236,75,6,177,44,26,106,49,132,178,24,75,33,132,179,8,131,67,209,208,184,116,46,206,11,51,141,30,19,131,86,4,236,144,147,225,126,131,229,140,30,19,179,132,238,206,143,241,179,177,85,52,44,148,84,141,156,246,127,77,252,99,245,18,153,125,9,72,39,186,115,207,151,209,148,243,230,244,37,33,69,168,136,151,74,170,117,189,98,196,240,13,238,52,195,70,177,44,30,233,219,20,209,43,234,202,98,172,178,200,106,46,174,26,139,235,134,162,250,224,172,186,168,234,46,174,26,203,170,138,178,218,163,172,178,168,234,43,170,58,138,168,150,146,154,102,121,77,19,80,82,249,232,40,124,239,40,124,239,40,124,239,30,249,222,80,228,56,161,200,112,247,161,195,218,151,14,114,90,61,201,104,246,165,195,156,135,14,106,90,61,168,104,246,161,195,152,150,142,98,152,57,168,96,230,164,199,49,38,56,150,67,73,102,25,172,134,104,232,100,26,30,129,5,185,193,112,240,89,152,118,112,28,173,72,30,125,31,58,120,16,232,26,57,145,217,153,93,195,209,254,55,67,71,155,73,153,146,2,178,89,190,215,137,199,237,49,195,234,30,124,247,78,67,53,243,158,124,247,206,121,211,250,19,144,34,212,17,170,180,147,131,214,47,24,6,111,116,19,22,116,214,165,165,15,153,229,116,199,81,101,113,86,89,92,85,150,213,13,69,214,65,105,117,81,212,91,92,54,23,87,13,69,245,195,97,101,81,212,89,76,148,149,211,37,37,84,75,73,75,231,160,166,137,104,41,162,103,148,186,122,7,190,119,148,62,119,20,57,14,30,244,56,123,231,120,247,33,195,220,135,15,106,92,57,169,104,247,33,163,218,150,142,106,90,57,169,96,230,169,131,154,134,142,98,88,57,137,96,211,81,142,37,152,195,89,12,32,33,132,26,25,1,5,163,161,240,240,90,60,111,6,26,28,176,80,82,19,252,71,183,242,231,14,9,163,194,118,118,29,195,199,248,195,3,164,21,57,168,193,209,55,59,143,79,245,143,197,63,66,61,233,175,152,138,123,18,67,61,200,60,249,253,9,207,62,127,66,114,4,220,130,53,212,146,113,122,197,105,97,133,196,107,86,209,206,67,138,105,146,130,218,163,164,182,184,108,45,170,58,139,44,134,178,250,225,172,186,184,171,45,178,27,11,44,134,194,218,163,168,178,153,41,43,166,90,10,169,150,130,170,37,164,166,137,105,41,124,212,20,62,119,148,62,119,148,58,119,148,62,119,20,186,119,20,57,14,30,228,60,115,144,225,238,157,227,156,135,14,106,90,61,169,104,230,165,163,92,134,142,106,88,57,169,96,214,41,131,88,163,26,197,24,211,83,6,26,140,110,129,12,37,144,100,26,51,135,66,209,224,184,112,32,224,57,58,128,124,218,62,88,242,165,193,52,115,14,30,195,179,4,222,30,143,241,90,102,201,75,14,227,51,68,220,220,58,137,248,253,152,62,23,244,51,206,69,179,145,166,180,145,79,114,72,39,244,39,32,69,243,144,166,212,145,174,165,147,11,192,95,31,28,193,49,141,83,71,211,37,5,117,197,89,101,112,214,91,84,85,150,213,29,37,245,195,97,117,113,84,93,100,21,151,215,13,101,213,71,81,101,81,212,89,68,180,21,211,45,5,84,75,73,83,229,164,165,243,60,165,243,188,161,243,80,80,249,222,80,228,56,161,243,184,161,211,184,161,200,112,247,33,195,220,134,143,106,92,57,169,104,231,33,195,90,150,142,106,90,57,137,104,214,165,131,88,166,13,98,140,107,20,99,77,76,24,64,67,9,102,25,172,131,37,144,122,26,23,14,6,56,38,128,168,217,74,18,95,140,183,205,56,120,78,204,195,179,48,236,204,55,131,143,241,74,70,206,14,231,29,157,134,230,225,185,220,103,234,127,149,214,126,193,53,75,34,77,104,36,77,106,34,69,170,32,69,233,32,69,201,33,77,201,35,93,107,39,199,8,179,221,53,130,99,104,67,199,213,45,37,117,71,81,101,113,212,89,92,85,150,215,21,101,213,69,105,101,81,88,91,100,54,22,215,21,69,181,71,81,101,49,212,85,76,180,21,83,37,37,79,154,130,167,205,65,75,230,121,75,167,121,67,231,121,67,231,121,67,167,113,75,167,120,246,161,227,218,150,148,53,14,30,212,180,123,80,225,205,75,71,53,45,28,196,180,115,18,209,172,83,6,177,76,26,197,24,214,40,198,154,140,97,172,134,26,200,97,44,134,112,112,222,94,135,130,33,128,129,169,201,140,249,219,254,60,1,28,52,120,78,206,19,179,48,209,225,59,135,143,241,49,36,6,246,113,217,220,118,119,27,217,135,1,172,250,207,210,63,12,253,48,247,81,116,228,74,173,36,169,173,81,26,108,85,66,155,82,68,155,146,68,171,82,72,52,132,35,155,212,7,164,19,150,209,212,78,242,170,101,168,170,169,105,43,174,58,203,43,138,162,234,226,172,182,184,170,46,178,10,203,234,138,178,234,162,168,182,152,234,43,162,90,74,168,150,146,170,37,160,166,137,104,41,124,239,40,162,103,148,190,103,148,186,119,148,57,13,41,116,238,40,114,28,61,200,112,247,33,163,218,150,143,106,88,80,196,56,115,144,193,205,75,70,181,76,26,212,52,113,169,131,77,76,26,106,49,196,163,26,106,49,132,163,24,75,208,244,56,102,7,6,32,1,168,80,108,91,243,132,112,14,29,152,38,143,97,163,152,118,102,26,57,135,112,244,127,137,57,155,93,221,198,119,113,221,216,110,119,28,178,19,90,158,63,102,171,242,31,215,201,83,106,9,21,82,137,85,82,137,21,98,136,149,98,136,149,106,200,151,98,201,114,129,18,76,208,25,166,19,129,163,169,67,202,169,150,162,154,229,164,174,200,171,45,170,43,10,236,138,178,203,33,172,186,184,171,45,166,74,202,234,146,146,170,101,164,170,153,40,42,166,90,10,159,53,5,47,154,130,151,78,242,151,78,242,151,78,226,151,78,226,135,206,226,135,33,195,220,134,148,53,14,30,228,52,123,80,209,237,75,71,53,13,30,196,176,123,18,193,204,75,7,49,44,26,197,16,227,89,140,53,24,210,81,140,37,16,194,95,12,213,224,204,1,13,96,144,229,207,48,79,204,154,78,204,195,71,132,33,204,52,115,14,30,195,179,4,222,30,63,196,190,205,55,59,140,238,227,187,184,236,220,48,12,13,236,227,190,147,230,240,253,226,111,134,253,8,243,213,98,9,87,74,137,211,82,201,85,90,137,85,90,201,23,90,201,66,160,39,231,112,179,34,49,156,192,222,183,15,161,20,20,213,53,37,85,73,73,101,82,84,89,84,149,22,87,29,69,181,197,81,117,112,214,91,84,117,21,211,37,37,116,75,65,85,18,208,85,68,180,21,62,103,21,62,90,10,95,51,202,95,51,202,31,59,138,29,59,138,93,59,138,28,134,143,114,26,80,212,52,123,144,209,237,67,71,177,44,30,212,52,115,18,193,205,67,7,49,44,26,196,152,227,81,14,37,24,210,86,142,213,104,222,86,140,197,136,213,130,134,78,17,27,242,231,1,185,130,16,240,155,153,134,143,9,163,152,104,230,26,57,134,240,113,254,39,238,113,189,156,119,118,27,157,199,102,225,130,64,111,102,157,154,39,126,139,249,214,31,189,77,243,223,82,64,186,210,74,186,86,76,186,64,149,117,44,153,116,129,48,208,36,216,252,21,172,32,25,166,115,177,131,30,183,15,166,122,74,42,158,146,154,102,168,166,169,107,41,174,58,203,44,134,178,218,226,168,178,169,42,42,170,90,10,232,146,146,170,37,160,166,153,104,42,124,207,41,124,180,20,190,103,148,190,103,148,190,103,20,186,119,20,58,119,20,58,119,20,53,14,30,228,48,161,168,104,246,161,163,218,134,15,106,26,57,137,96,230,37,131,141,38,60,210,99,141,38,52,148,67,117,122,55,83,163,113,88,52,22,161,169,84,131,62,127,188,179,115,48,220,204,52,115,2,193,195,115,48,236,204,59,48,77,204,19,184,120,255,0,21,114,142,39,198,44,238,238,59,59,141,206,195,4,132,238,238,59,187,12,194,16,191,84,252,164,143,222,39,240,254,148,133,85,164,157,84,172,157,116,172,156,40,2,113,126,19,139,240,78,179,64,50,35,27,140,9,235,112,215,170,129,181,206,242,170,102,164,166,185,41,43,170,74,74,235,142,162,186,229,168,174,184,233,45,162,74,74,232,150,130,170,38,160,166,137,168,41,124,207,41,124,212,20,190,103,20,190,103,148,190,103,20,186,119,20,57,13,40,116,238,40,116,238,40,98,26,80,212,48,161,179,184,123,16,194,134,36,199,177,38,61,179,176,121,164,199,26,72,113,167,71,146,116,118,167,135,98,132,112,165,99,146,153,70,248,161,231,4,57,134,240,224,88,56,111,14,27,152,38,230,97,163,152,118,96,154,60,38,240,113,254,52,101,224,73,212,17,16,122,2,64,191,69,100,25,104,147,46,160,16,76,225,90,205,18,20,8,24,237,19,250,119,231,58,126,213,63,206,253,97,2,171,81,40,80,4,194,240,16,47,1,56,220,23,199,160,17,105,204,198,26,209,104,116,41,195,232,158,130,138,103,168,162,153,233,40,162,122,74,107,146,162,186,163,172,174,184,234,43,162,90,74,169,150,130,170,37,160,170,137,104,41,124,207,41,124,238,42,116,239,41,116,207,41,116,238,41,116,238,40,116,238,40,116,238,40,108,238,30,233,220,61,168,97,67,80,209,236,67,71,177,6,80,201,216,61,136,49,230,131,28,104,33,228,130,29,168,209,248,140,30,40,88,244,162,65,254,74,101,11,7,130,28,192,176,112,33,225,55,51,13,204,19,115,48,209,193,8,115,14,193,195,184,122,63,200,172,171,170,46,179,136,122,238,60,254,244,86,69,213,225,34,238,194,85,95,199,151,190,160,158,81,250,32,66,23,225,46,211,196,159,91,243,156,126,164,143,146,251,66,37,90,146,80,160,4,3,192,72,184,69,115,48,2,210,56,240,194,104,48,99,150,209,212,206,242,154,102,121,85,51,82,81,84,180,148,211,53,37,85,73,73,93,81,212,91,76,116,149,211,37,37,79,154,130,154,38,121,75,231,113,77,18,208,82,249,158,82,233,158,80,249,158,80,233,220,82,233,156,80,233,218,82,217,220,61,168,105,67,16,194,134,206,209,237,157,133,12,157,133,12,153,133,7,57,143,52,16,242,71,20,106,56,163,39,194,129,157,69,40,154,34,175,49,66,22,15,5,131,129,102,96,88,56,22,14,4,57,134,230,97,163,130,16,230,29,152,38,143,9,188,28,127,148,29,234,241,228,247,169,135,149,222,158,30,112,250,216,121,35,234,241,229,15,175,167,141,190,199,30,54,251,152,120,125,237,105,227,119,175,199,148,94,159,30,83,47,226,47,64,72,250,124,249,191,120,197,94,130,64,165,100,226,240,21,140,192,56,180,194,226,9,128,99,90,166,142,122,28,83,76,180,149,83,37,37,84,77,73,85,49,210,87,76,148,22,83,37,69,117,197,73,101,18,82,85,68,180,21,81,37,5,79,150,130,151,202,242,167,202,242,167,74,242,167,76,226,151,76,226,166,204,226,150,204,226,150,204,210,166,78,210,150,76,210,134,204,210,134,76,194,147,156,202,74,115,41,41,200,160,166,34,141,155,74,58,97,41,9,148,85,52,146,20,160,120,222,30,11,7,3,193,192,179,48,222,30,59,135,13,204,16,179,4,33,204,52,112,77,204,19,71,128,222,14,63,204,46,221,48,187,140,22,104,190,97,8,202,48,159,155,194,121,186,43,155,162,121,220,39,159,162,121,248,36,40,225,6,198,147,13,186,23,165,229,208,49,62,130,136,2,165,147,11,196,79,51,1,221,224,140,8,99,84,209,206,67,74,104,145,229,149,69,65,109,49,208,89,68,175,44,166,58,11,106,134,146,234,97,168,182,137,40,44,162,74,10,223,43,202,159,43,202,168,145,229,110,149,197,79,149,197,79,145,197,79,145,229,46,153,165,46,149,165,78,149,165,45,149,133,108,153,133,71,43,10,153,41,149,28,166,84,83,17,73,72,69,91,47,20,244,128,88,184,231,46,146,102,154,99,129,112,224,120,60,111,15,4,57,198,240,225,188,56,22,14,27,195,134,224,225,185,152,104,142,26,56,38,230,9,188,28,127,154,58,253,38,202,184,151,170,226,126,167,137,178,173,36,218,180,159,168,210,125,163,73,58,206,36,234,248,156,168,210,110,175,4,21,12,37,107,184,73,55,69,176,218,71,47,184,7,130,191,70,98,65,165,98,184,240,18,237,53,128,67,92,134,148,58,103,21,85,19,203,169,134,162,218,97,164,182,136,168,46,162,42,11,233,130,147,208,166,10,75,169,130,146,231,197,65,99,227,121,99,164,121,91,227,121,99,163,113,99,164,105,91,227,113,91,163,113,91,100,105,91,100,105,91,36,97,99,35,97,91,36,97,81,200,69,103,38,150,20,124,89,177,97,104,196,162,244,249,236,24,227,208,184,120,46,14,11,135,130,193,227,120,120,222,28,11,48,66,225,195,115,48,209,204,8,115,13,193,195,71,4,209,225,52,71,13,224,227,252,232,221,96,145,164,136,250,195,32,219,248,131,175,35,207,219,248,139,109,210,35,176,136,10,238,35,235,116,148,233,34,77,179,72,217,99,8,206,198,144,182,246,16,178,214,18,178,166,16,248,223,84,71,230,232,253,39,231,79,148,27,144,77,205,192,55,120,38,44,198,181,12,42,116,174,45,166,10,15,66,143,62,146,250,96,160,190,152,40,47,167,207,164,244,41,243,170,61,10,124,250,15,65,240,208,92,248,94,92,248,40,45,124,47,45,116,79,44,124,78,44,116,77,45,108,109,45,100,109,44,108,77,44,56,216,88,200,140,180,226,50,194,136,139,118,30,46,239,60,79,64,60,183,142,101,85,11,112,240,92,56,23,15,5,193,193,112,241,188,60,111,14,6,57,129,96,224,88,56,22,14,4,56,33,14,97,185,130,110,14,26,56,38,142,9,188,28,127,159,186,205,38,39,232,141,163,132,107,176,94,176,196,147,116,87,56,132,21,70,71,182,48,132,253,3,60,243,244,154,121,110,244,76,128,189,13,35,109,44,39,39,176,156,168,105,43,104,113,51,222,193,77,97,158,79,200,126,144,243,240,169,255,0,119,249,3,243,65,246,124,226,125,102,28,96,67,91,59,74,93,35,139,169,243,222,122,52,249,180,158,141,30,125,7,163,71,157,65,233,81,231,82,122,52,249,180,158,141,62,109,7,162,255,0,62,130,247,249,244,23,186,7,23,191,207,121,123,188,247,23,182,7,23,54,6,151,178,22,23,156,38,122,7,1,30,129,65,167,160,94,119,30,143,121,160,122,161,230,250,196,213,251,20,147,88,56,31,7,7,195,193,112,112,92,56,30,15,5,195,129,112,224,88,56,30,14,5,153,134,230,97,184,56,16,230,27,131,129,8,225,163,192,16,102,26,56,38,240,113,252,31,173,50,126,176,136,202,210,33,43,140,129,150,105,25,212,66,13,228,78,199,24,150,145,2,90,64,150,176,14,113,10,39,152,134,185,130,141,174,39,107,152,36,218,193,12,123,201,157,81,139,107,28,45,230,193,63,43,246,108,63,16,249,31,234,20,31,203,217,251,159,197,31,4,85,78,107,20,69,14,145,165,180,121,238,61,58,60,202,15,78,143,46,147,212,163,204,160,244,233,242,232,61,74,124,183,158,171,252,186,15,77,254,99,207,77,222,107,143,73,222,107,79,77,190,107,79,73,190,107,79,73,158,107,15,76,252,195,61,51,242,200,245,119,202,195,216,239,35,214,56,61,255,0,120,249,79,115,216,227,140,120,46,29,11,135,130,225,224,184,56,60,204,11,135,3,193,224,176,120,46,14,11,7,141,193,224,176,112,44,28,11,4,66,193,195,115,4,220,193,8,71,13,28,19,71,4,222,95,31,197,60,68,1,52,196,19,136,73,59,69,235,136,73,153,129,173,33,38,194,22,205,96,179,38,138,42,24,76,202,76,67,24,98,204,216,40,218,226,118,82,193,14,105,139,99,90,45,219,161,238,48,195,55,138,161,174,21,65,176,198,99,9,254,75,238,154,126,27,241,223,212,237,63,140,179,251,7,229,207,230,134,126,213,243,71,231,238,245,188,114,151,249,236,61,90,60,151,30,189,30,53,7,181,71,137,65,237,81,226,188,246,159,226,188,246,157,227,56,246,91,227,176,246,153,227,25,237,55,196,97,237,28,190,209,1,125,71,182,126,121,233,126,157,97,240,62,255,0,208,112,183,134,135,193,161,240,104,92,60,31,7,7,193,193,240,224,124,56,30,15,5,195,129,112,224,92,60,111,14,5,194,33,224,224,92,34,23,7,26,57,134,224,224,67,130,110,14,4,34,33,7,0,66,34,111,7,31,199,27,220,17,247,4,125,193,239,112,69,220,17,119,7,189,193,51,184,38,247,12,46,224,203,184,97,119,26,125,195,15,184,107,59,134,159,112,195,238,8,251,131,119,112,231,119,15,103,112,230,119,6,125,195,91,220,27,123,130,103,112,214,119,12,111,112,107,238,60,127,27,184,242,60,222,226,24,251,132,47,184,227,238,29,79,113,101,221,197,254,143,113,233,250,221,199,171,234,247,15,238,227,119,184,222,238,55,187,141,222,227,187,184,222,238,59,123,142,238,227,187,184,238,238,59,187,140,238,227,179,184,236,238,59,187,140,238,227,51,184,204,238,59,59,140,30,227,51,184,28,238,48,123,129,206,224,71,184,17,238,4,123,160,123,186,191,255,196,0,36,16,0,3,0,3,0,2,3,1,1,1,1,1,1,0,0,0,0,1,2,3,17,18,4,16,5,6,32,19,48,7,20,64,21,255,218,0,8,1,1,0,1,2,0,16,133,233,8,94,151,180,33,11,242,154,16,189,33,11,210,244,189,47,107,247,175,107,210,253,235,30,12,95,15,139,235,113,245,88,250,156,253,89,125,105,125,119,255,0,194,127,10,254,25,252,61,124,67,248,138,248,154,248,186,248,247,225,188,26,66,244,132,255,0,75,210,107,210,23,248,47,79,240,255,0,26,31,183,254,204,214,180,132,33,8,94,151,164,33,122,66,246,132,47,75,210,246,189,36,191,248,23,181,239,88,60,28,31,86,193,244,204,63,83,195,240,211,227,255,0,47,231,195,158,56,114,229,203,151,46,92,57,169,112,226,177,214,43,193,88,89,253,151,149,143,40,191,9,250,94,144,191,40,94,151,227,79,211,247,167,235,94,159,166,191,26,244,253,179,79,210,253,47,104,66,16,132,47,75,210,16,189,33,123,94,144,132,36,47,122,95,133,233,35,73,97,241,124,95,171,120,223,78,241,190,14,112,168,81,206,181,173,126,24,198,49,140,105,148,154,106,147,85,53,55,21,23,138,240,171,159,147,199,242,216,242,175,75,212,139,212,181,248,94,245,249,127,228,215,225,254,52,205,13,107,210,98,244,132,47,72,66,16,132,33,122,66,23,225,8,66,246,191,43,240,191,40,71,141,224,248,159,82,241,62,179,139,198,88,212,169,18,255,0,6,54,219,244,198,49,140,99,24,198,80,202,84,169,92,220,92,94,42,199,143,229,48,125,135,199,242,208,137,98,23,229,126,154,253,235,252,116,63,79,242,253,33,8,66,16,189,33,11,240,133,233,8,94,151,164,47,194,244,133,237,122,95,172,88,188,63,172,120,95,90,197,227,204,41,75,247,189,239,123,111,109,182,219,99,109,182,219,109,177,182,50,134,49,148,82,165,83,115,113,120,171,31,143,243,190,39,218,113,101,76,95,149,239,95,189,126,31,225,255,0,163,77,8,66,23,229,8,66,244,133,233,11,218,23,165,233,11,218,252,33,123,73,36,188,79,143,240,190,171,226,124,124,196,202,73,33,122,222,247,189,183,182,219,109,182,219,219,109,182,219,109,182,198,219,110,155,109,177,140,101,20,168,165,74,166,166,226,241,228,197,135,63,131,247,79,3,229,208,191,11,244,205,126,181,233,254,159,248,235,210,23,164,47,107,218,23,225,8,94,144,133,233,8,66,244,191,193,9,120,95,19,224,253,115,22,9,137,148,47,198,247,189,239,125,109,214,221,109,182,219,116,219,123,109,211,109,182,219,109,182,219,24,219,40,162,134,81,69,42,84,174,110,46,50,98,172,127,27,247,47,136,251,55,255,0,30,191,12,208,253,235,219,53,233,8,66,244,132,33,122,66,16,132,47,75,218,244,189,175,202,23,165,233,30,31,197,248,31,3,143,20,204,164,144,132,211,216,158,247,189,239,125,111,109,245,211,166,219,109,183,77,182,219,109,237,182,219,109,182,54,198,83,162,138,40,101,20,169,90,185,184,184,201,139,46,31,138,251,167,194,253,171,210,252,235,222,181,254,205,63,76,211,31,225,8,66,16,189,47,72,94,208,189,33,11,210,16,189,33,122,95,132,35,197,240,188,15,130,197,138,38,82,16,132,111,105,239,123,222,247,215,93,117,190,186,233,211,110,157,58,109,211,123,219,123,109,182,219,109,186,109,182,198,49,140,99,25,69,42,85,53,55,55,23,143,38,44,152,126,27,239,223,15,246,20,47,214,191,122,255,0,224,126,208,132,33,8,66,16,133,233,8,66,244,133,233,8,66,23,180,33,8,197,139,193,248,60,24,34,37,74,66,54,132,211,222,247,183,93,111,174,183,211,174,186,219,166,250,223,78,186,111,125,116,219,109,186,109,189,182,219,108,109,140,99,25,67,24,202,84,170,106,110,110,46,47,30,92,40,248,15,250,95,133,231,127,150,191,122,255,0,6,159,225,8,94,144,132,33,8,66,16,132,33,11,218,23,225,123,66,18,240,254,51,195,240,177,196,204,136,66,19,79,123,85,189,239,125,116,223,78,186,235,167,78,157,58,235,167,77,186,116,222,221,55,182,219,109,182,219,109,182,49,141,177,140,99,24,202,24,211,84,170,106,110,46,47,30,76,89,112,124,103,203,125,95,254,137,254,237,53,248,99,245,173,123,126,208,133,233,8,94,144,132,33,8,66,23,180,33,8,95,132,98,197,224,252,94,44,81,50,164,145,8,218,105,244,158,250,235,125,117,215,77,245,215,93,117,190,183,211,167,78,183,211,166,219,109,183,91,109,214,247,182,219,109,182,216,219,24,219,24,198,82,106,165,170,85,55,55,23,143,38,44,184,115,248,223,89,255,0,162,252,79,204,127,158,189,49,254,31,227,70,135,237,8,66,252,105,11,210,23,165,233,11,210,23,233,30,47,133,226,248,184,226,20,146,33,9,166,154,125,111,174,147,223,93,55,215,91,235,174,186,235,167,93,117,211,167,91,116,222,246,233,182,221,54,219,109,182,219,27,108,109,140,99,24,198,50,138,41,82,165,74,166,166,226,226,241,229,197,155,7,198,252,151,212,127,232,127,141,126,116,205,123,211,255,0,23,233,122,66,23,164,33,8,94,144,132,33,11,240,132,47,114,188,79,7,14,40,152,82,73,45,9,167,180,211,223,91,235,125,117,215,93,111,174,186,223,93,58,235,174,186,117,211,166,219,109,211,109,237,189,239,109,183,182,219,109,182,219,99,99,24,253,49,141,52,211,85,52,170,106,46,47,30,76,89,176,103,241,254,161,255,0,79,241,188,159,222,141,15,242,215,248,161,8,66,23,180,33,11,218,16,132,33,8,66,247,17,226,120,184,163,26,149,36,146,208,154,105,166,169,82,165,91,235,174,186,117,215,93,109,215,93,117,215,93,58,233,183,93,58,233,189,183,189,182,222,247,189,183,189,182,219,109,177,191,108,161,141,49,141,52,213,42,154,154,138,139,139,199,120,178,225,207,227,253,95,238,31,95,251,23,251,191,195,246,253,161,8,66,16,132,33,8,66,16,133,233,126,80,140,120,252,124,24,226,20,146,38,154,104,77,53,91,233,82,123,223,93,117,214,250,235,173,245,211,167,91,233,215,93,117,211,110,155,235,123,109,182,247,182,219,222,246,222,219,109,141,191,109,191,76,126,152,198,52,211,85,53,53,21,55,23,143,38,44,184,115,120,255,0,27,242,95,77,251,215,249,63,122,244,255,0,79,218,16,132,33,123,66,23,180,33,8,66,16,132,99,140,24,177,206,53,36,146,33,52,211,77,52,247,215,93,111,174,186,85,214,247,215,93,111,174,186,223,93,116,235,110,186,219,125,55,189,239,166,219,222,247,182,247,191,91,223,166,49,143,211,67,26,26,106,147,85,46,106,110,106,47,29,226,203,135,54,4,190,139,255,0,71,252,107,255,0,141,8,66,16,132,33,8,66,16,133,237,11,210,49,206,28,120,230,20,146,75,150,154,105,237,52,247,181,91,235,125,117,214,221,116,235,174,186,235,167,93,117,211,174,155,235,125,111,166,246,222,247,189,182,219,102,219,246,199,248,126,159,167,235,77,105,173,57,105,167,46,106,106,42,42,42,47,30,92,57,176,103,241,190,133,255,0,73,255,0,228,99,16,132,33,11,210,23,180,33,8,66,23,180,74,195,143,28,194,146,73,36,150,132,211,79,105,239,105,155,222,247,189,239,125,117,215,93,117,215,93,117,211,173,244,235,174,183,189,239,123,222,247,249,214,181,207,60,56,225,227,120,222,55,141,227,120,248,114,211,90,105,166,154,114,230,166,166,162,162,226,241,229,197,151,7,145,226,253,7,254,136,171,240,199,249,211,244,205,126,144,189,33,8,94,208,154,16,132,33,123,151,134,49,76,40,36,146,68,211,77,52,33,37,248,217,189,239,125,111,125,117,214,221,117,215,93,58,222,247,215,78,183,189,239,123,55,249,214,146,214,185,231,158,56,227,249,255,0,39,135,248,188,15,199,175,25,248,213,227,87,143,88,156,57,105,203,150,156,184,169,168,188,119,143,38,44,184,124,143,27,232,63,127,138,252,63,243,215,225,11,210,252,161,122,66,244,189,47,78,240,70,57,133,4,146,38,154,114,41,153,82,144,141,239,123,235,174,186,235,174,186,111,174,157,117,215,93,116,223,91,235,173,239,123,222,247,182,247,189,255,0,154,52,132,148,243,199,31,201,225,120,31,141,94,45,248,119,224,223,133,126,53,99,105,203,154,154,154,138,138,199,120,178,98,203,131,200,241,190,129,247,185,175,219,255,0,53,248,94,144,132,33,8,66,16,189,39,147,54,24,197,48,160,130,68,228,136,140,115,9,35,125,111,174,186,235,123,235,174,186,235,174,186,235,174,183,215,93,117,215,93,117,190,183,215,91,222,247,189,239,123,222,246,158,247,191,73,166,132,33,8,66,246,133,60,127,23,130,188,76,158,14,95,142,203,241,217,60,74,198,229,205,77,69,69,197,227,201,139,46,31,35,197,255,0,158,253,231,127,166,53,254,40,66,16,133,248,66,23,164,33,122,242,60,140,24,241,78,53,4,18,65,143,22,60,83,8,222,250,79,174,186,235,174,186,235,174,186,235,167,78,186,235,173,186,235,174,183,215,93,111,123,233,189,239,123,222,247,180,247,191,91,222,247,191,105,161,11,210,244,133,233,8,66,18,225,224,191,15,47,199,103,248,172,255,0,29,147,11,151,21,21,23,142,241,228,199,151,15,147,227,127,207,62,239,249,208,255,0,15,244,132,33,8,66,16,189,33,122,66,245,230,121,88,49,226,152,80,73,38,44,88,176,70,51,125,117,215,91,223,93,117,215,93,117,211,125,117,214,250,235,174,183,215,93,117,189,239,123,222,247,214,247,189,239,173,239,123,218,123,244,189,39,233,8,66,98,16,154,23,164,33,8,66,16,135,21,227,102,248,255,0,39,226,60,159,138,203,130,162,162,162,226,241,228,199,151,14,127,31,232,31,115,252,63,195,244,253,177,250,66,16,132,72,191,8,94,209,230,121,120,35,12,227,32,131,28,248,254,54,60,72,223,91,222,250,235,174,186,223,93,58,235,174,186,235,174,186,222,250,235,123,235,174,183,215,91,222,247,214,247,189,239,123,222,205,166,38,33,49,8,66,19,66,244,132,33,52,33,11,210,16,132,33,8,213,97,205,241,254,103,195,121,127,19,120,170,46,47,29,226,201,139,54,6,190,153,246,191,203,255,0,13,122,66,16,132,33,8,66,16,132,121,30,76,60,51,141,65,6,12,62,63,139,19,189,239,123,235,173,245,190,186,223,93,117,190,183,215,91,219,174,157,117,215,93,117,215,91,235,123,222,247,214,247,189,239,173,239,123,54,158,215,180,109,49,8,66,16,189,161,8,66,36,66,16,132,33,8,145,42,195,228,252,111,200,124,31,149,241,247,142,226,241,222,44,152,179,96,240,60,223,130,249,175,111,246,255,0,8,66,244,189,33,8,66,16,138,188,222,70,25,196,177,144,188,79,23,199,241,209,189,239,123,235,174,183,190,186,235,174,157,117,189,245,215,91,223,93,117,215,93,117,190,186,219,125,117,189,239,123,222,247,189,155,79,126,247,177,8,94,151,181,233,122,66,16,132,33,8,66,16,132,33,8,66,16,150,79,27,206,248,127,145,248,76,184,171,29,227,188,121,113,102,193,245,143,159,193,159,240,253,235,219,252,175,72,66,244,189,163,228,252,220,17,137,99,49,175,7,194,195,135,123,222,247,189,245,215,91,235,174,186,235,174,186,235,174,182,235,174,186,235,174,186,223,91,235,174,186,222,247,189,236,222,247,189,155,245,180,38,189,38,38,133,237,9,166,132,33,8,66,16,132,33,122,66,17,34,17,34,17,35,143,43,227,254,91,224,60,159,18,177,222,60,152,242,226,207,131,232,31,101,252,191,211,244,132,33,11,240,132,47,95,45,231,248,241,134,113,168,95,29,224,225,197,189,239,123,223,91,235,174,183,215,93,117,215,91,235,174,186,233,215,93,117,215,93,117,189,239,123,222,250,222,247,189,239,123,218,123,222,247,179,104,79,98,98,244,154,98,16,132,33,8,66,104,66,16,132,33,8,66,17,34,104,145,8,205,227,124,183,192,249,223,29,120,239,30,76,89,113,103,195,244,159,177,254,31,229,143,210,23,164,33,8,66,16,143,43,201,254,184,103,18,198,124,111,131,131,23,93,111,123,235,125,111,125,117,215,93,116,223,93,117,214,250,235,174,186,235,190,183,189,245,215,91,222,250,222,250,235,123,222,247,189,239,105,155,66,105,137,161,9,237,8,66,16,132,33,8,66,16,132,33,8,66,16,132,33,18,33,8,68,136,188,95,45,240,191,39,241,87,142,241,228,199,151,23,133,230,124,103,200,191,79,252,80,133,233,11,240,132,124,183,159,130,113,44,71,198,248,126,46,13,245,189,245,211,174,186,235,125,117,215,93,117,215,93,117,210,174,186,235,174,186,235,174,186,235,110,183,189,245,189,239,173,239,123,222,211,218,105,250,70,253,161,52,47,75,210,16,132,47,72,66,16,132,33,8,66,16,132,33,18,34,68,33,18,72,138,143,149,248,127,149,248,171,199,120,242,98,203,135,233,159,54,63,219,246,132,33,8,66,16,189,124,247,200,248,243,133,98,94,23,143,241,254,35,173,245,215,93,111,125,111,174,186,223,93,117,190,186,235,110,186,235,174,183,215,93,111,174,186,222,250,223,91,222,247,189,250,222,246,153,189,250,76,77,8,94,144,132,33,52,33,9,161,8,66,19,16,132,33,8,66,16,132,33,8,66,16,132,33,14,126,95,226,62,83,227,47,30,76,121,49,249,24,126,153,243,159,135,237,254,16,132,34,69,239,62,124,158,78,5,136,195,31,13,224,38,223,93,111,174,149,117,214,250,223,93,117,215,93,117,215,93,58,235,173,245,215,74,186,222,247,189,239,174,183,189,167,189,239,123,55,189,166,38,109,11,210,107,210,19,66,16,154,16,133,233,8,66,16,132,33,122,66,16,132,33,8,66,36,66,16,137,16,135,63,55,240,222,127,129,120,239,30,92,94,7,153,226,249,95,183,237,122,66,16,189,35,236,255,0,37,227,206,21,140,248,79,11,20,186,233,189,245,215,93,117,215,93,111,174,186,235,110,186,222,250,235,174,183,215,93,111,123,117,214,247,214,247,210,123,222,246,154,123,218,126,147,76,76,79,218,98,16,133,233,8,66,16,132,33,8,66,16,137,16,132,33,8,66,36,66,17,34,16,137,16,132,92,125,135,225,60,159,26,241,228,199,155,15,210,62,95,246,253,33,11,210,16,132,124,175,200,97,120,86,35,194,195,241,158,51,167,93,117,215,93,117,215,91,222,250,223,91,235,174,186,235,174,186,235,174,183,214,247,214,250,235,125,117,190,183,190,186,111,102,246,159,164,196,38,132,197,233,122,77,8,66,16,132,208,132,33,8,66,16,132,33,8,66,16,132,33,8,68,136,66,36,66,16,132,35,54,31,178,124,46,76,87,143,46,42,95,15,242,127,135,249,66,54,132,33,31,101,249,63,29,98,49,159,95,240,164,117,211,174,186,235,174,186,235,173,239,174,186,235,167,93,117,215,93,117,215,93,111,174,186,223,93,109,86,247,190,186,222,247,180,247,189,137,167,189,250,77,11,210,16,132,33,8,66,244,132,33,11,210,16,132,33,8,66,16,132,33,18,33,8,68,136,66,16,132,72,132,35,206,240,254,119,226,238,50,99,205,139,234,159,37,248,208,253,161,122,94,254,193,242,126,58,194,177,30,14,31,141,192,233,215,78,186,235,125,111,174,186,235,174,186,233,215,93,117,215,93,111,174,186,235,174,186,223,93,117,215,91,233,52,247,189,239,123,222,247,233,53,233,63,73,251,66,246,189,33,8,94,147,66,16,132,33,8,66,16,132,33,8,145,8,68,136,68,136,66,17,34,17,34,17,243,191,23,230,120,153,49,228,199,159,23,192,124,151,225,175,75,240,189,35,236,223,39,227,172,43,17,245,239,22,71,93,117,215,93,117,215,91,235,125,116,235,174,186,235,174,183,215,93,117,189,239,174,186,223,93,117,180,247,189,239,173,245,190,182,158,196,211,244,152,154,98,246,189,38,132,47,72,66,16,132,33,8,66,16,132,33,8,145,8,66,16,132,33,8,68,136,68,136,68,136,66,50,71,217,254,39,38,60,152,243,99,250,223,159,251,66,16,132,35,236,127,41,227,152,86,19,199,159,134,192,233,215,93,117,215,93,117,215,93,117,215,93,117,215,93,117,215,93,117,215,93,117,215,93,117,215,93,111,123,222,211,218,123,77,52,253,33,61,166,159,164,215,180,33,11,210,16,132,33,8,66,16,132,33,8,66,16,132,33,8,66,16,132,33,8,66,16,132,33,8,145,8,66,17,242,94,31,202,248,57,35,38,60,248,190,19,228,63,72,66,16,132,125,199,229,60,115,9,136,248,108,62,50,117,215,93,58,235,174,186,235,174,186,235,174,186,235,174,186,235,174,186,233,215,91,235,174,186,235,123,235,123,222,247,189,237,51,105,237,52,211,19,94,145,177,8,66,19,16,132,33,8,66,16,132,208,132,34,68,33,8,68,136,66,16,132,33,8,66,16,132,33,18,33,8,145,18,82,251,55,198,100,199,146,51,99,250,223,152,255,0,193,9,163,230,62,71,21,97,48,152,143,174,224,84,233,190,186,235,174,186,223,93,117,214,250,235,174,186,235,174,186,235,174,186,235,125,117,215,91,235,173,239,123,222,211,79,105,167,189,166,33,52,196,38,132,47,72,66,16,189,33,8,145,8,66,16,132,34,68,33,8,66,16,132,36,132,33,8,68,136,66,16,132,33,8,66,16,137,17,242,30,55,202,248,119,25,113,230,143,141,242,255,0,72,77,8,255,0,160,252,166,3,1,136,192,190,19,27,167,93,117,215,78,186,235,174,187,235,174,157,117,215,93,117,215,93,117,214,250,235,173,245,215,93,117,190,183,189,170,77,61,166,154,105,137,166,189,33,52,33,52,33,9,136,66,16,132,33,8,66,16,132,33,8,66,16,132,73,34,16,132,33,8,68,136,66,16,132,144,132,144,132,33,8,67,159,179,124,125,198,72,205,143,235,30,87,225,136,66,245,155,55,153,231,96,48,152,159,199,79,199,174,186,235,174,186,235,174,186,235,174,186,235,174,186,235,125,117,215,93,117,215,93,117,190,186,222,246,171,164,246,158,247,180,211,218,123,77,27,222,196,33,8,66,16,132,33,8,66,16,132,33,8,66,16,132,33,8,66,16,132,33,8,66,16,132,33,8,66,16,132,33,8,66,16,132,33,31,41,227,121,216,46,114,227,139,199,147,242,132,35,239,223,39,132,194,240,152,223,194,71,142,251,235,174,186,235,174,186,235,174,186,235,174,186,235,174,186,235,174,186,235,174,149,117,214,250,235,165,91,79,105,239,105,166,154,123,77,52,253,38,132,196,196,215,164,33,52,33,8,66,16,133,233,8,66,16,132,33,8,66,16,132,144,132,33,8,73,8,66,36,66,16,132,33,8,66,16,132,242,79,216,124,59,140,145,155,31,215,188,159,194,16,189,125,227,228,240,152,76,79,17,240,19,141,187,235,167,93,58,235,174,186,235,174,186,117,215,93,117,215,78,186,235,174,183,215,93,117,215,74,149,117,189,244,158,246,154,105,166,154,98,105,175,72,66,16,191,8,66,16,133,233,8,66,16,132,33,8,146,68,33,8,66,16,132,33,8,68,136,66,16,132,72,132,33,8,66,16,132,33,11,215,207,248,153,49,228,140,184,254,35,55,225,123,249,63,53,229,194,97,120,158,39,240,36,215,125,117,215,93,117,215,93,117,215,91,235,174,186,235,174,187,235,174,186,235,173,245,190,183,215,74,186,218,105,237,52,208,154,105,161,52,211,77,11,210,23,164,38,132,33,8,66,16,132,33,8,66,16,132,34,68,72,132,33,36,33,9,33,41,18,66,16,132,33,18,33,9,33,8,66,16,133,233,30,126,47,144,193,113,146,50,207,141,155,218,16,143,250,79,201,99,120,94,39,137,227,127,6,42,233,215,93,117,215,93,117,215,93,117,215,93,117,215,93,117,215,93,117,215,93,111,174,186,84,158,250,218,105,167,189,166,154,104,77,49,8,77,52,208,132,196,47,72,66,16,132,33,8,66,16,132,33,8,159,72,66,16,132,33,8,66,16,132,33,8,68,136,66,36,66,16,132,33,8,66,23,172,147,243,222,62,72,201,25,163,224,179,123,77,52,125,239,228,113,24,76,85,137,226,127,12,213,119,215,93,117,215,93,58,235,190,186,235,174,186,117,215,93,117,215,93,117,190,186,235,123,84,169,61,166,158,211,77,52,211,77,8,66,107,210,16,154,19,66,16,154,16,132,33,8,66,16,132,33,9,33,18,34,68,34,68,33,8,66,18,66,72,66,18,66,16,189,33,8,66,16,132,47,72,66,23,175,158,241,238,114,78,88,248,252,159,159,51,202,207,159,17,137,226,112,240,63,137,165,125,117,215,93,117,215,93,117,215,93,117,215,93,117,215,93,117,215,93,117,215,93,116,171,106,149,38,169,52,211,77,9,166,154,16,154,105,161,8,77,122,66,16,132,33,8,66,16,132,33,8,66,16,132,33,8,68,136,66,17,34,18,66,16,132,33,8,66,72,66,16,132,33,9,33,8,66,23,164,35,229,113,103,199,115,146,51,44,89,61,163,254,131,231,203,198,241,60,79,27,192,254,38,213,246,169,87,125,117,215,93,117,215,93,117,215,93,117,215,93,117,215,93,117,181,93,116,159,74,147,79,106,147,77,52,211,77,52,211,77,8,66,16,132,38,132,33,8,66,244,132,33,8,66,36,66,16,132,33,8,66,17,41,8,66,37,36,137,16,146,72,68,136,66,16,132,33,9,33,8,66,16,132,47,94,100,249,216,238,114,78,104,248,172,155,16,143,250,127,159,47,27,198,241,188,111,5,124,85,171,233,87,125,245,215,93,117,215,78,186,235,174,186,235,173,245,215,93,117,215,74,147,85,215,74,147,77,52,213,38,154,105,166,156,180,33,50,68,38,132,33,8,66,16,132,33,8,66,16,132,33,8,66,104,66,36,66,17,34,16,132,33,9,33,36,33,8,66,16,132,33,8,66,16,132,33,8,66,23,172,171,229,177,220,92,229,143,141,163,98,62,217,231,75,198,241,60,117,142,177,87,197,92,223,106,250,233,87,93,117,210,174,186,235,174,186,235,174,186,235,174,186,235,174,149,42,235,164,246,154,105,237,52,211,77,57,105,203,77,8,68,180,33,8,66,16,132,33,8,66,16,132,33,8,66,16,132,145,34,16,132,36,132,33,36,36,132,33,8,66,18,66,16,132,33,8,66,16,133,233,11,210,247,71,204,227,169,185,203,18,253,252,151,151,154,225,227,120,220,86,55,141,252,94,72,190,250,239,174,157,117,223,93,117,215,93,117,215,93,117,181,93,117,210,174,147,218,174,183,214,213,38,154,105,166,132,211,146,90,37,161,52,33,52,33,8,66,23,164,33,8,66,16,132,33,122,66,17,34,36,73,36,33,8,66,16,132,33,8,73,8,66,72,66,17,41,8,73,8,94,144,132,33,8,66,245,243,17,115,107,36,231,140,86,39,247,255,0,46,220,60,111,27,198,241,214,58,248,204,152,175,190,251,86,175,174,250,239,174,186,235,174,186,235,174,186,235,174,186,235,165,93,39,189,166,158,211,84,154,105,166,154,105,200,156,137,161,52,208,154,16,132,33,8,66,16,132,33,8,66,16,132,33,9,72,132,34,68,33,8,66,82,33,18,144,146,18,66,36,73,8,66,16,132,33,11,210,16,133,237,122,249,73,185,185,185,205,30,21,122,255,0,168,121,116,75,198,225,227,172,117,15,227,175,6,69,78,250,233,87,106,187,235,190,186,235,174,186,233,87,93,117,215,93,39,210,174,147,77,52,211,77,82,105,166,132,208,154,19,145,18,211,66,16,132,34,68,47,82,33,8,66,16,132,34,68,33,8,66,17,41,36,33,8,66,16,132,33,36,36,146,18,66,16,132,144,132,33,9,33,8,66,16,132,47,75,215,200,206,73,165,107,44,248,158,147,255,0,163,121,116,229,195,135,21,142,177,215,133,126,54,78,251,85,215,93,117,215,93,59,235,174,186,235,167,91,235,174,149,42,235,164,250,84,154,105,167,52,154,98,105,166,132,38,132,33,8,66,16,132,33,8,66,16,132,33,9,33,8,66,16,132,33,8,66,16,148,136,68,136,66,16,137,16,132,144,132,36,146,16,141,33,11,210,16,132,47,75,210,252,121,230,89,169,181,146,113,250,223,218,124,150,229,195,198,241,185,168,175,22,252,76,170,251,235,181,93,119,215,125,117,215,93,117,215,93,42,235,165,74,186,233,53,93,116,154,105,166,169,53,73,161,52,211,145,57,105,162,68,208,132,33,8,66,17,34,17,34,16,132,34,68,33,8,145,8,146,68,144,132,72,146,16,132,33,36,33,36,33,8,73,9,33,8,66,16,132,36,132,33,11,218,23,175,53,101,154,86,178,78,68,103,203,229,228,110,92,56,172,78,42,30,27,240,178,205,245,218,174,149,245,215,93,117,215,93,117,215,93,117,215,91,233,87,73,237,82,125,38,154,105,166,154,105,203,77,57,114,72,132,39,36,136,146,73,17,34,36,68,136,66,16,132,33,8,66,16,132,33,8,66,17,41,8,73,36,146,68,164,145,41,9,36,132,33,8,66,18,72,66,73,33,122,66,23,231,204,50,170,86,173,121,18,159,216,243,231,109,167,14,28,56,120,234,43,195,203,139,39,93,245,210,165,125,116,171,174,250,235,174,186,233,82,174,186,235,106,183,180,211,77,82,106,147,78,68,39,45,57,104,66,114,208,132,39,36,136,66,36,66,16,137,16,132,36,146,16,132,72,137,16,132,33,18,33,8,66,16,137,73,33,9,33,36,36,132,146,66,16,132,36,133,233,123,66,16,191,62,89,150,105,90,181,158,113,191,188,231,204,233,167,46,8,168,168,169,191,19,46,12,189,170,237,87,74,250,239,174,186,235,174,186,235,174,182,171,165,91,235,174,147,84,154,105,166,156,180,211,77,57,114,39,36,137,161,8,66,104,145,18,72,132,33,8,68,136,66,36,148,148,136,66,16,132,33,8,66,72,66,18,73,36,146,73,36,146,73,8,73,8,66,72,72,66,16,132,47,107,245,229,153,85,42,86,179,76,31,244,76,185,134,39,14,28,212,184,113,94,61,248,249,85,247,210,174,187,84,171,190,157,117,215,93,117,215,93,42,235,165,74,186,77,82,165,74,149,39,46,92,180,211,146,73,19,146,73,37,162,73,17,34,16,132,33,18,33,8,66,16,132,33,9,33,9,33,8,73,18,74,73,8,66,72,73,9,36,146,18,66,18,73,36,144,132,144,146,18,66,73,36,132,47,215,148,100,84,169,92,229,148,127,209,242,230,117,234,92,184,112,229,195,199,126,54,92,121,59,85,218,165,93,245,215,93,117,190,186,235,174,149,116,169,86,213,42,233,52,211,77,52,211,78,92,180,73,36,146,75,68,185,37,200,132,208,132,33,18,33,8,66,16,132,33,18,33,8,66,17,36,169,72,73,41,82,164,66,37,72,146,72,148,146,73,36,146,16,146,18,73,8,66,16,133,248,95,175,40,180,213,43,89,85,47,250,46,76,163,55,46,28,212,185,168,168,172,25,49,100,237,87,93,119,215,115,93,245,215,93,117,215,93,117,210,105,166,154,105,166,154,105,166,154,104,78,73,36,146,68,73,36,136,146,68,33,18,72,137,17,34,36,145,8,145,8,66,16,132,33,8,66,36,66,72,73,9,72,146,72,148,146,73,36,146,73,33,11,210,72,66,72,66,16,132,33,122,66,23,227,203,44,165,74,214,69,153,127,208,47,43,175,73,195,135,53,53,46,107,14,76,25,38,250,85,210,174,186,237,90,174,186,235,174,186,218,173,237,52,211,77,52,213,39,45,52,229,166,156,146,211,151,36,180,33,52,72,132,33,18,33,8,68,136,66,16,137,18,68,136,66,17,34,16,132,144,132,34,82,72,146,68,144,146,82,146,66,72,73,36,146,73,36,105,36,47,72,94,215,165,233,123,103,148,233,53,74,214,85,228,47,189,214,98,141,162,28,56,115,83,83,88,235,6,72,181,93,245,215,93,117,210,174,250,235,174,149,42,235,165,74,147,77,52,246,154,114,228,78,92,146,228,146,73,17,36,185,114,33,18,33,8,66,36,66,36,146,73,36,68,146,33,18,33,18,34,73,36,146,68,146,68,146,165,33,18,164,148,146,18,73,36,144,150,146,73,8,66,72,73,36,47,72,66,23,230,143,36,99,41,90,200,188,165,247,87,152,191,73,203,138,138,135,46,92,214,43,199,146,111,174,186,233,87,93,42,239,174,182,169,53,74,147,79,165,73,166,154,105,167,46,92,185,104,78,90,37,201,46,92,146,34,73,36,145,18,73,36,146,34,73,36,68,136,66,17,34,16,137,36,66,18,68,146,33,36,146,68,164,146,73,41,73,36,146,73,36,146,16,146,244,146,73,33,9,36,191,11,243,111,200,108,106,138,89,15,45,125,197,230,44,98,105,166,156,212,185,169,172,119,139,36,223,93,170,233,82,165,93,117,210,125,42,84,171,123,233,61,166,154,105,167,46,92,185,114,73,36,146,229,162,68,72,137,16,137,17,36,136,66,36,68,136,149,36,136,66,17,34,16,148,146,33,36,144,137,16,132,74,74,84,164,165,36,146,73,36,146,73,33,36,144,146,244,132,132,146,95,165,237,153,30,97,166,169,82,200,188,197,247,3,49,144,111,105,166,156,212,212,210,168,172,87,142,213,245,215,93,42,233,82,165,74,149,116,159,73,166,154,105,166,132,211,77,57,114,228,146,73,36,146,73,36,68,136,146,68,33,18,34,68,73,34,16,132,33,18,72,137,36,146,73,17,34,72,66,36,68,146,34,82,73,37,42,84,164,146,73,36,146,73,36,132,144,146,246,132,144,189,47,107,243,149,228,26,105,171,89,15,52,251,121,152,200,87,173,167,46,92,212,181,74,162,241,220,223,74,149,117,210,174,149,42,233,82,174,149,38,169,53,73,170,77,52,211,151,36,146,229,203,146,73,36,145,18,73,36,146,34,73,36,146,73,16,132,73,34,16,137,16,132,37,34,16,132,33,8,145,41,18,149,34,36,66,72,74,68,146,73,36,132,146,73,36,144,146,72,210,72,94,210,253,230,116,52,202,86,178,30,105,247,3,58,200,80,196,211,151,46,26,115,83,83,88,238,45,87,93,117,215,74,149,116,171,169,125,167,210,106,149,38,169,82,105,166,137,114,228,146,73,114,73,36,146,73,36,146,228,68,146,73,36,136,146,73,36,66,17,36,146,73,36,146,73,34,16,132,73,42,84,146,164,149,42,68,146,149,42,84,164,165,36,146,73,36,146,73,107,66,75,218,244,191,193,188,205,141,49,148,100,94,113,247,9,204,100,43,218,106,165,205,77,77,75,85,23,23,54,171,174,149,116,159,74,186,151,212,215,73,244,154,105,166,156,212,185,114,229,203,151,46,92,185,114,228,146,73,36,146,68,73,36,136,68,146,34,68,72,137,36,66,36,146,73,16,137,17,34,16,137,36,149,42,68,72,148,136,74,73,73,36,146,73,36,146,73,35,73,33,9,37,237,126,80,189,209,149,177,140,162,214,67,228,15,185,44,198,85,67,245,180,229,170,85,53,53,53,53,54,178,42,239,125,116,171,174,186,77,87,74,149,117,45,53,73,166,132,228,151,46,92,184,114,73,36,146,229,201,36,185,36,146,73,36,66,17,34,17,36,136,145,8,145,18,73,34,36,66,36,68,136,73,18,73,42,73,36,146,68,72,148,169,73,33,36,36,146,73,36,150,185,209,163,95,181,235,35,200,198,50,138,50,31,34,125,202,115,44,170,199,235,123,77,82,165,74,165,170,154,138,86,171,174,186,84,171,169,125,75,238,95,73,170,85,52,156,185,114,229,201,36,146,75,151,46,9,36,146,73,36,146,73,36,146,73,16,137,36,66,17,36,146,73,36,169,17,36,136,68,146,74,146,73,36,149,34,36,149,42,73,36,146,82,72,73,36,144,133,233,36,146,66,94,181,249,94,151,227,35,161,141,50,139,50,31,34,125,194,115,44,197,170,25,189,166,156,185,169,165,74,149,77,77,77,42,233,53,93,38,171,165,73,170,85,47,105,203,78,90,114,229,167,36,144,75,146,73,36,151,46,73,36,146,73,36,146,68,73,36,146,73,36,169,36,68,146,33,8,145,8,68,146,72,132,34,73,82,146,74,73,82,165,36,148,169,73,33,8,73,36,33,126,181,235,73,126,217,145,177,140,101,20,101,62,69,253,165,102,89,150,69,67,245,180,211,77,84,210,165,74,166,230,251,154,84,169,87,93,116,154,164,213,75,85,52,169,84,180,211,146,92,185,114,230,164,146,73,114,229,201,36,146,34,73,17,34,36,145,8,146,73,17,36,146,73,36,146,34,68,33,18,73,36,137,72,132,74,68,146,165,73,36,169,73,34,82,72,66,23,164,33,8,95,239,70,70,49,166,81,70,83,228,31,207,172,203,42,202,173,63,123,77,82,165,73,205,42,138,85,53,52,169,87,73,244,154,169,165,83,73,167,45,84,185,115,82,229,201,36,185,36,151,14,73,37,203,130,73,36,146,73,36,146,73,36,145,18,73,36,136,145,36,73,34,36,146,68,72,132,72,137,36,146,73,36,146,68,164,149,36,169,73,36,132,36,132,33,8,94,144,191,218,221,122,99,25,69,153,143,54,190,74,115,172,171,42,200,168,111,210,105,244,154,165,74,165,245,52,169,82,174,149,39,190,149,38,169,57,165,73,203,151,46,92,185,114,229,203,151,14,73,36,146,92,185,36,146,73,36,146,73,17,36,146,73,36,146,72,132,73,34,16,137,16,132,164,66,36,68,136,146,84,169,72,146,82,82,34,73,72,66,23,164,33,122,94,144,191,43,252,27,182,253,49,148,81,102,119,228,86,87,228,206,85,149,100,86,51,102,247,180,230,149,117,53,53,218,185,174,165,244,159,74,147,150,170,90,106,165,170,154,135,46,92,185,37,203,151,46,92,57,114,228,146,73,36,146,72,36,146,73,36,146,73,36,66,36,145,18,73,36,136,68,146,73,34,17,36,146,164,146,73,37,74,145,18,73,42,73,16,146,18,66,23,164,47,194,95,231,78,199,237,140,162,207,34,169,186,249,24,202,178,172,138,213,15,218,123,218,169,165,93,77,117,52,173,82,164,213,38,169,53,74,147,85,53,45,57,114,229,197,75,151,36,57,114,65,36,146,65,36,146,73,36,146,73,36,146,34,73,17,36,146,34,73,17,36,146,72,132,73,36,146,73,36,146,73,42,84,164,73,42,73,16,137,16,132,33,123,95,132,47,107,252,87,170,117,233,140,99,40,200,252,250,101,95,203,70,85,145,100,89,21,12,126,147,77,61,167,210,165,74,186,84,171,164,250,154,84,171,169,106,147,151,45,84,57,114,73,46,28,146,225,195,151,14,73,33,195,146,92,185,36,146,68,73,36,146,73,34,36,146,73,16,137,17,34,36,146,73,36,146,73,17,36,146,73,36,146,73,36,136,145,8,66,72,66,16,191,217,126,25,94,223,166,81,70,71,242,182,58,249,121,202,178,172,147,106,213,12,109,27,222,211,77,57,169,165,74,149,77,116,169,82,165,82,213,42,78,105,57,114,225,195,154,151,14,28,146,67,135,46,8,36,151,36,146,75,146,73,36,146,73,36,146,68,34,73,36,146,73,36,145,8,146,73,36,146,73,36,146,73,36,74,73,37,73,36,146,72,132,33,8,94,151,165,254,203,213,58,252,49,148,89,149,252,181,142,188,229,153,101,156,139,34,181,67,245,180,111,105,166,154,106,147,84,170,105,82,165,73,170,154,85,52,156,181,83,82,229,201,4,184,112,225,195,151,36,144,75,146,72,112,224,146,92,146,73,36,146,73,36,146,73,36,146,73,36,136,145,18,73,34,17,36,136,68,146,73,36,169,36,146,73,36,68,146,33,8,66,16,189,33,127,189,63,195,25,69,153,171,228,114,21,121,12,243,149,100,89,22,69,105,143,222,247,189,170,233,62,149,38,169,53,74,149,42,77,57,169,106,229,201,46,92,212,84,185,32,151,14,28,16,65,14,9,114,228,146,73,36,146,73,36,146,73,36,146,73,36,146,73,36,66,36,145,8,68,146,73,36,146,73,36,146,73,36,146,73,34,16,132,33,11,210,23,165,233,127,171,31,183,233,140,162,204,245,154,203,171,175,38,114,44,179,146,114,43,86,80,205,155,218,123,222,250,84,156,210,106,165,166,169,84,212,185,105,203,151,14,106,92,152,220,56,112,229,201,14,9,112,65,4,146,65,36,146,228,146,73,36,146,73,36,146,68,73,34,36,146,73,36,146,73,36,146,84,136,146,73,36,146,73,36,146,73,17,34,16,132,33,8,66,244,152,191,209,183,248,99,25,69,159,35,149,250,167,85,153,101,89,39,44,229,86,173,80,198,63,123,19,218,105,166,169,53,91,150,169,84,212,184,165,82,230,165,201,4,56,112,224,146,92,56,112,225,201,14,28,146,65,36,146,73,36,146,73,36,146,73,36,146,33,8,145,8,146,73,16,132,34,73,36,145,18,73,36,136,151,34,16,137,16,132,33,122,66,253,47,202,252,182,253,63,195,40,167,149,252,198,70,110,170,233,86,89,201,57,39,34,181,74,149,39,235,123,79,123,218,105,237,62,165,170,84,169,57,169,114,229,203,78,42,28,57,32,135,46,42,28,57,33,195,135,4,16,65,36,144,228,151,36,146,73,36,146,72,137,36,68,146,34,73,36,145,18,34,73,17,36,146,73,36,146,73,36,136,146,73,16,132,33,8,66,23,164,47,194,255,0,6,219,252,49,140,162,204,213,242,89,125,85,85,247,154,114,44,139,36,228,86,169,82,105,251,223,173,237,52,213,109,82,174,165,203,154,150,170,28,185,168,112,75,135,141,195,135,4,16,67,151,14,8,33,203,151,36,144,73,36,146,73,36,146,73,36,146,34,73,17,36,146,73,34,36,145,8,146,73,17,36,146,72,137,36,145,8,150,132,33,8,66,244,191,11,252,23,225,254,31,166,50,157,191,39,38,91,25,119,85,146,177,188,147,145,100,156,138,230,230,147,76,127,173,237,61,167,185,123,150,170,90,169,169,169,169,112,230,166,162,162,165,203,138,138,135,14,72,33,195,135,36,146,73,46,8,36,146,73,36,146,73,36,146,73,16,137,36,146,73,17,34,36,66,36,146,73,36,151,36,146,75,151,45,52,33,8,66,104,95,236,189,191,211,24,221,188,143,229,179,49,250,186,170,170,240,114,101,155,87,57,38,230,230,149,42,77,63,198,205,166,154,125,39,14,105,53,73,203,150,170,92,84,56,114,75,135,14,28,16,224,147,25,4,16,65,4,56,112,73,36,18,73,36,146,73,34,36,146,73,36,146,73,36,146,68,73,36,146,73,36,146,73,34,37,201,36,180,73,46,90,19,66,16,132,255,0,215,123,252,191,76,101,60,181,242,249,155,245,85,85,119,135,46,105,200,173,92,220,220,218,165,73,166,159,231,98,123,77,52,211,85,53,46,92,180,229,203,130,28,18,228,198,65,4,56,112,225,195,135,14,28,57,36,151,4,146,73,36,16,73,36,146,73,36,146,73,34,36,68,146,73,36,146,72,137,17,36,146,73,34,37,201,34,105,201,45,9,161,8,94,147,79,252,23,248,63,76,101,59,126,78,76,249,54,217,117,78,169,158,46,76,138,213,205,205,205,205,77,38,154,107,240,189,111,105,161,52,229,203,150,156,212,184,112,225,195,135,14,8,168,112,225,193,4,16,67,130,28,18,75,130,73,114,34,9,36,146,73,36,146,73,36,146,68,34,73,36,66,36,146,73,17,36,146,73,34,114,34,92,136,66,19,66,19,66,104,77,61,254,55,233,127,147,27,110,222,71,242,222,67,244,217,85,117,182,254,47,54,89,181,115,145,92,220,218,165,74,147,84,49,140,223,180,208,154,114,230,166,166,147,138,135,14,42,28,56,113,80,225,203,135,4,16,65,4,16,67,130,92,18,228,146,72,36,146,73,36,145,18,72,137,36,146,73,36,130,73,36,146,68,34,73,37,201,34,36,66,114,75,68,136,66,16,132,33,52,111,98,255,0,102,219,101,59,121,171,229,51,191,79,213,85,180,54,243,119,145,92,220,220,220,220,220,210,164,213,38,135,249,94,147,77,53,82,229,167,46,92,84,56,33,195,135,14,8,33,195,135,14,28,56,114,229,193,4,18,73,14,73,36,146,73,36,146,73,16,137,37,201,36,146,33,8,145,8,146,73,104,146,73,36,68,180,33,52,211,66,19,77,9,161,122,223,248,111,246,198,219,167,117,230,231,187,24,253,85,54,100,172,183,245,255,0,43,36,220,220,220,220,220,220,212,210,105,166,49,254,54,109,52,229,167,46,92,56,37,195,151,4,56,32,146,8,112,225,195,135,14,8,112,65,14,8,36,146,72,37,203,146,73,114,73,36,146,73,36,146,73,36,146,73,36,146,34,73,36,146,73,36,146,73,104,78,73,36,66,114,38,132,208,189,38,191,11,210,107,252,88,202,118,242,87,204,121,13,183,182,203,99,121,238,235,193,243,178,171,155,155,155,155,155,155,154,154,84,169,52,208,255,0,41,167,45,52,39,36,144,225,201,21,21,21,142,161,195,138,135,14,28,56,32,130,9,32,151,4,184,36,151,36,146,73,36,146,72,137,36,146,73,36,146,68,73,34,36,146,73,17,34,36,66,16,132,33,9,200,154,16,154,104,66,126,208,133,233,127,155,116,233,221,121,25,60,172,198,219,24,217,146,178,85,213,191,175,121,215,54,174,110,110,110,110,110,106,105,84,180,211,79,244,132,209,45,18,67,135,36,56,112,226,161,227,168,112,225,193,4,56,32,130,8,112,228,135,36,146,73,36,146,73,36,146,73,36,136,68,146,73,36,146,73,36,146,34,68,33,8,150,137,19,151,36,180,38,132,38,132,208,152,152,189,33,123,223,237,189,177,148,237,229,175,151,242,91,126,159,183,235,54,74,187,116,254,7,207,203,54,173,82,185,185,184,169,169,169,169,164,211,77,15,218,16,132,209,36,185,112,67,138,138,135,14,12,111,27,151,14,8,112,225,227,112,224,130,8,112,224,146,9,36,146,73,36,146,73,36,146,73,36,146,73,36,145,18,73,36,146,73,36,146,72,132,72,132,208,137,105,161,52,208,132,211,79,210,54,159,173,255,0,139,109,211,186,207,147,205,242,54,54,223,188,181,150,237,219,166,124,15,159,115,74,166,166,230,230,166,166,230,230,166,147,77,126,144,132,75,146,72,114,75,135,141,195,135,14,28,60,110,9,112,225,197,67,135,14,9,36,130,8,36,146,92,18,73,36,146,73,36,146,72,156,136,146,73,36,146,73,16,137,17,34,16,132,39,34,36,66,36,66,104,77,8,66,104,66,98,23,249,54,219,117,89,47,229,124,189,141,182,55,235,53,213,91,166,253,124,15,200,228,155,154,85,55,55,55,55,53,53,53,53,45,52,211,90,104,66,16,137,37,203,146,28,56,32,130,28,56,33,193,14,28,16,225,193,14,28,18,67,146,73,36,146,9,114,73,36,146,73,36,144,73,36,146,73,34,104,146,73,16,132,208,132,33,8,68,146,33,8,66,104,77,9,166,154,104,66,23,248,109,250,109,182,233,221,103,201,230,249,15,214,217,182,219,201,89,46,157,83,246,207,174,252,141,205,205,170,85,53,55,53,53,53,53,46,92,180,214,181,233,18,209,34,36,146,8,37,195,135,14,30,50,28,56,112,225,195,135,141,195,135,14,28,16,228,146,72,36,151,46,73,114,73,34,36,146,73,36,146,73,36,145,18,72,132,34,68,72,132,33,9,161,8,66,16,133,233,52,38,154,105,136,95,189,141,177,182,234,178,95,203,121,77,191,203,102,107,183,146,182,63,76,248,143,144,162,230,213,77,43,154,155,138,154,154,151,53,45,57,105,175,104,68,136,146,28,56,112,67,135,14,8,33,227,112,225,195,135,14,8,112,224,130,8,112,75,130,92,185,36,146,73,36,146,68,39,46,68,34,73,16,137,16,137,17,34,36,68,136,66,16,132,33,52,33,9,161,52,208,189,33,52,47,194,54,108,219,109,211,187,242,51,121,89,223,167,233,191,121,42,157,211,253,125,83,228,178,69,205,42,84,170,106,106,106,106,106,106,92,180,229,166,141,33,8,151,46,73,112,228,130,8,33,195,135,140,131,25,14,28,16,224,135,14,8,112,75,130,9,114,73,4,146,228,146,73,36,146,73,36,146,68,75,146,92,136,78,90,36,145,18,73,34,16,156,136,66,19,145,52,33,8,66,107,240,189,175,91,27,109,183,85,89,111,229,188,166,217,191,77,239,101,213,182,216,253,191,94,47,147,227,121,55,53,52,154,169,169,169,168,168,169,169,169,169,114,214,180,33,18,34,73,36,151,14,28,56,112,225,195,130,42,28,16,67,198,67,135,4,16,73,4,18,228,146,73,36,151,36,136,151,36,146,73,36,146,34,92,146,73,34,16,137,17,36,136,66,16,154,19,66,16,132,33,8,66,23,164,33,52,35,102,205,182,219,117,87,126,111,147,147,35,109,140,222,223,166,85,100,167,233,254,190,175,242,185,34,166,166,149,77,77,77,77,77,77,205,77,69,75,151,60,181,164,144,132,73,36,16,75,135,140,130,8,120,220,84,16,67,130,28,56,33,193,14,8,36,151,4,146,73,36,146,73,36,146,228,146,73,17,46,73,36,146,73,104,66,16,137,104,145,9,203,77,52,33,8,66,104,76,66,16,154,23,189,239,123,222,246,221,85,222,108,159,33,229,54,217,177,250,109,250,183,79,218,253,125,119,229,110,110,105,84,212,185,169,169,169,169,115,83,82,229,203,157,115,164,164,146,73,32,130,8,112,225,195,138,135,14,28,16,225,195,131,25,4,56,112,224,135,14,9,37,203,146,73,36,146,73,36,146,73,36,146,68,73,36,146,73,36,146,33,8,68,136,77,52,38,154,19,66,16,132,33,8,66,19,252,239,109,186,117,85,119,242,126,99,109,141,155,219,99,102,90,126,223,239,227,252,252,25,238,106,92,181,83,83,83,83,83,83,83,83,80,229,203,90,210,73,34,73,82,65,14,8,112,67,130,8,33,195,151,14,28,16,225,195,135,14,28,144,73,46,9,36,130,73,36,151,36,146,228,145,18,75,145,18,75,145,18,33,52,72,137,16,132,33,8,68,137,161,9,161,8,77,52,111,105,250,222,205,186,117,85,119,229,249,57,179,55,182,247,177,179,109,150,253,191,211,245,245,127,153,201,21,53,45,53,82,213,77,77,77,77,77,67,135,46,121,231,73,36,148,146,73,4,56,32,131,27,135,14,8,32,198,67,198,226,162,161,195,151,36,185,112,224,151,36,185,36,146,73,36,146,73,114,73,36,146,228,146,73,16,132,34,73,16,156,136,77,8,66,16,154,16,132,33,52,209,180,211,247,189,239,167,85,87,121,179,121,222,83,123,27,31,173,250,108,167,237,254,159,191,171,252,205,197,77,42,154,154,78,92,212,212,212,212,84,57,114,231,158,121,73,41,36,146,72,32,135,14,8,32,130,28,56,112,65,14,8,33,195,151,4,144,75,135,46,73,114,73,46,73,37,201,36,146,73,36,146,73,34,36,77,18,75,68,136,145,9,161,8,66,16,132,208,154,105,163,123,16,158,247,189,186,117,85,87,151,39,200,249,141,182,219,99,109,251,219,99,253,111,219,247,131,63,196,252,149,69,203,150,170,90,115,82,230,166,166,166,165,203,151,60,242,146,73,37,42,20,56,112,65,14,30,55,4,16,225,195,130,12,100,56,33,195,135,4,57,36,146,73,37,201,36,146,34,73,36,146,68,38,137,17,36,137,203,68,180,33,8,77,8,66,19,66,17,45,122,77,8,77,61,236,222,247,183,78,170,242,100,243,188,202,191,91,222,205,191,91,27,223,183,251,127,143,138,249,60,25,238,90,169,105,203,154,151,53,14,106,92,185,114,231,148,146,229,41,82,165,74,130,8,32,133,4,56,112,225,193,14,28,84,56,112,73,36,144,224,151,36,185,114,73,46,92,146,228,146,73,114,73,46,73,114,39,46,92,146,75,66,17,45,52,38,154,19,66,104,66,16,132,33,61,155,222,247,189,186,171,187,242,188,156,217,183,182,246,205,155,24,222,247,251,127,135,249,250,239,206,53,82,230,147,150,154,169,114,229,203,151,46,92,185,214,146,82,148,169,33,65,4,56,112,225,193,4,16,99,32,130,8,32,130,8,36,146,72,32,146,73,114,229,203,146,73,36,146,92,136,151,45,8,151,34,17,34,17,34,16,132,211,66,104,77,8,66,19,77,61,167,180,111,123,222,221,85,213,231,207,229,121,45,254,31,166,216,222,219,54,255,0,205,254,190,177,246,12,152,234,106,90,164,211,154,78,92,185,114,229,203,158,121,210,74,84,165,4,144,73,4,16,67,135,14,8,112,67,135,14,28,16,228,135,36,146,228,151,36,185,37,201,34,36,146,73,114,228,146,73,36,150,132,208,132,38,137,16,154,105,166,132,38,154,19,66,98,126,147,222,247,215,78,170,234,242,230,242,252,189,141,239,99,102,246,223,173,239,252,223,233,159,87,251,14,72,169,164,211,77,82,114,229,203,151,46,92,243,207,42,82,73,41,82,161,73,36,16,65,4,16,65,6,50,8,112,65,4,56,114,75,146,28,185,36,146,73,36,151,46,73,114,228,150,137,36,146,73,114,229,166,132,38,156,136,77,9,203,66,19,77,52,246,154,123,222,246,169,211,167,78,234,242,102,243,60,189,239,126,182,219,99,31,173,182,219,55,254,79,244,196,254,181,246,27,138,151,45,52,211,154,151,46,90,114,231,151,58,82,165,41,73,74,149,4,16,65,36,16,65,4,16,225,197,69,67,135,4,18,67,130,92,144,228,146,72,36,151,36,180,209,36,185,19,151,36,146,33,8,145,52,208,132,228,77,9,167,45,52,211,77,52,247,180,247,215,93,58,117,89,50,102,242,252,189,141,239,102,246,55,189,250,111,109,239,157,127,131,253,63,83,95,92,251,21,197,75,154,78,92,185,114,229,174,92,235,158,82,229,36,146,149,42,84,144,160,146,72,32,130,28,16,73,4,16,225,201,36,146,73,46,73,36,151,36,146,75,150,137,36,151,46,73,36,145,8,77,8,77,52,75,66,105,161,52,38,154,19,77,52,247,180,250,235,167,78,235,38,76,222,87,151,189,237,250,222,247,177,189,177,155,126,155,217,170,157,63,91,246,199,249,126,226,254,187,246,59,135,46,90,114,211,77,53,166,156,243,206,146,73,36,165,73,10,84,168,32,146,8,32,130,8,112,241,144,73,4,144,229,203,146,8,114,229,203,146,73,114,73,36,146,73,36,146,209,34,19,66,105,167,45,57,105,166,154,19,77,52,38,158,211,77,86,250,239,174,157,214,76,153,188,159,47,123,222,198,205,183,182,205,191,203,123,227,133,15,27,194,240,60,79,27,196,177,255,0,55,141,99,254,111,20,227,172,107,23,15,28,47,128,251,22,76,117,53,52,154,105,161,206,154,214,180,146,148,146,68,169,36,130,8,33,66,146,9,36,130,8,32,146,28,18,67,146,73,37,201,46,73,114,228,151,46,92,185,37,166,137,104,151,46,92,180,38,132,33,52,211,66,105,166,154,105,166,159,74,147,235,174,157,187,172,153,51,121,30,86,205,183,177,189,250,111,123,54,219,123,99,123,254,85,139,142,120,225,227,120,94,31,230,227,90,208,147,90,225,71,242,156,127,5,246,27,199,81,82,211,77,52,211,90,211,157,107,73,36,146,82,164,146,72,112,73,36,18,65,14,8,112,225,201,14,92,146,75,146,92,146,75,146,72,36,146,73,114,228,145,57,114,38,156,185,37,203,77,52,38,154,105,166,154,105,166,154,123,222,250,235,183,110,235,38,92,249,188,141,236,222,198,219,111,123,108,111,123,244,222,246,44,79,7,254,111,225,252,63,243,127,15,231,252,127,243,188,31,249,255,0,243,95,143,255,0,153,248,223,249,215,140,252,127,224,176,44,15,31,195,124,219,154,135,45,52,211,77,107,90,210,73,33,41,73,73,36,41,82,73,4,16,73,36,16,65,4,56,114,65,36,144,228,151,36,146,75,146,73,37,203,151,34,37,203,78,90,105,203,78,90,105,166,154,105,166,158,213,38,154,123,77,87,93,118,237,221,100,172,185,124,140,153,182,111,243,182,253,109,179,108,111,109,183,182,248,231,157,123,115,206,191,28,184,120,222,55,58,209,174,126,43,229,97,212,84,212,185,105,166,180,214,181,161,9,33,41,36,135,46,72,36,146,8,32,130,92,16,225,195,130,72,36,146,73,114,228,146,90,37,201,36,146,229,200,154,16,156,180,211,77,9,166,154,106,165,170,84,159,74,149,111,174,187,117,219,183,146,179,101,242,42,205,236,223,173,236,111,123,247,189,182,205,239,99,199,252,248,215,42,86,39,137,199,31,205,227,88,158,15,227,252,191,146,197,252,255,0,138,193,255,0,149,120,159,249,103,199,240,242,225,205,81,82,229,203,90,107,90,210,66,17,34,36,146,9,112,73,46,73,32,135,14,28,184,32,130,73,37,203,135,46,92,185,114,229,203,78,73,114,75,150,156,185,114,229,203,151,45,52,211,77,82,105,170,84,169,82,174,186,85,215,93,187,121,43,37,230,201,159,105,239,123,55,235,102,246,108,111,109,183,189,182,219,123,231,151,63,205,226,88,22,47,228,241,172,63,199,249,127,15,252,203,11,195,252,127,151,242,254,95,203,134,132,185,140,158,47,157,120,220,185,115,203,157,107,90,94,144,137,36,146,72,36,151,4,144,225,195,151,46,28,56,112,229,195,146,92,184,114,228,146,92,185,114,229,203,151,46,92,185,105,203,77,52,211,77,52,211,77,82,105,170,79,165,74,186,235,190,251,121,43,46,79,33,228,55,189,236,111,126,247,189,239,109,237,189,236,99,109,237,189,112,150,185,231,90,113,199,28,115,175,199,60,163,78,94,37,143,135,143,248,248,222,83,154,135,13,52,214,181,164,144,132,34,68,73,36,184,112,75,151,46,73,33,203,135,14,28,56,37,203,151,36,146,229,201,46,92,185,105,203,151,46,106,92,185,114,211,77,52,213,38,159,74,149,42,85,210,174,187,239,183,145,228,172,181,154,243,165,189,155,55,182,205,237,183,235,109,239,99,123,108,109,179,109,233,47,194,126,154,215,189,105,207,58,210,199,252,248,254,95,206,112,255,0,15,231,252,240,185,119,142,161,203,150,180,214,151,164,33,9,203,151,46,28,56,114,75,135,46,28,56,114,225,203,151,14,92,146,229,203,151,46,92,185,114,213,75,151,46,92,185,114,211,77,82,106,149,42,77,82,165,74,186,85,215,93,246,242,60,149,150,243,238,81,189,239,126,219,245,189,141,155,111,109,155,108,216,219,123,88,255,0,159,243,115,207,43,27,197,252,184,229,71,241,254,43,7,240,120,63,135,243,254,83,31,207,142,20,44,107,18,199,252,166,53,213,225,168,114,229,173,107,66,16,137,37,203,151,46,42,42,106,92,57,112,230,161,195,135,14,28,212,185,114,229,203,150,154,105,205,75,78,90,114,213,38,169,52,211,84,171,165,74,147,84,169,95,93,247,223,127,209,228,121,107,59,205,24,183,235,102,247,249,219,109,141,239,214,247,179,108,111,108,111,106,116,114,163,133,60,243,206,189,161,123,231,149,139,249,127,47,229,49,199,28,40,254,115,134,112,206,43,241,50,224,168,114,231,90,208,132,33,57,114,229,205,69,77,67,138,151,14,106,106,28,84,84,84,212,212,212,185,115,83,83,82,230,165,203,154,154,85,53,52,170,106,105,82,165,74,149,42,84,169,82,181,125,247,223,244,254,143,43,205,89,241,224,153,246,222,253,111,102,246,111,123,109,189,237,182,247,182,247,179,109,183,191,92,56,88,248,231,157,104,210,199,252,150,53,139,249,44,95,201,99,81,252,191,146,196,176,175,29,97,254,11,4,225,159,29,120,179,129,98,191,19,202,248,123,196,225,206,181,161,8,77,52,229,203,138,154,154,154,154,154,154,138,138,154,154,154,138,138,154,154,154,154,85,53,53,46,106,106,106,106,105,82,165,74,149,43,84,169,82,181,74,149,247,223,127,211,250,60,175,43,205,126,70,60,24,176,251,217,189,250,222,247,179,126,183,182,247,177,182,55,182,55,189,182,219,106,84,112,177,255,0,53,143,249,255,0,63,229,252,191,151,242,254,127,205,79,60,41,231,148,133,63,205,66,20,78,37,137,66,133,11,26,149,42,51,252,111,153,240,23,137,195,157,104,66,16,156,185,115,82,230,162,166,166,161,197,77,77,69,77,69,77,77,77,77,77,205,77,77,42,154,154,154,85,54,170,106,106,105,82,165,106,213,171,86,178,119,223,244,254,191,213,230,121,171,200,197,227,225,241,61,108,223,231,123,55,179,123,222,247,182,246,222,198,217,182,219,109,182,219,254,127,204,94,215,225,47,104,70,185,88,255,0,138,193,252,23,143,62,47,254,101,227,78,5,131,248,206,31,230,177,44,115,137,96,140,51,141,71,153,240,254,119,214,50,120,238,28,232,94,144,156,180,230,162,166,226,226,166,166,226,226,230,166,166,226,226,230,230,166,166,166,166,230,213,205,77,77,77,205,42,87,54,173,90,181,106,214,69,145,100,254,159,215,250,188,175,59,242,48,248,94,63,133,235,123,54,111,123,217,189,237,189,239,222,247,183,233,182,247,189,237,189,182,219,123,53,207,28,240,163,149,141,71,28,255,0,53,141,98,88,86,21,137,66,198,177,172,74,18,229,79,38,166,120,156,107,23,19,11,26,153,149,142,48,249,95,19,231,253,35,205,248,183,143,158,116,38,154,115,83,81,83,115,113,115,113,113,81,115,113,113,115,113,115,115,83,115,115,83,115,115,106,213,205,205,171,86,173,90,181,107,34,201,253,22,79,235,253,94,106,207,21,131,226,48,120,134,253,236,223,190,183,189,239,126,183,191,91,27,222,246,111,123,216,219,123,111,106,56,231,158,84,242,177,172,75,23,242,88,103,23,242,88,86,25,196,177,44,124,41,231,158,56,88,214,41,198,161,66,198,161,37,42,84,206,57,194,177,78,57,137,139,241,254,67,233,31,33,244,140,190,51,142,68,38,154,169,169,168,185,185,185,185,184,185,185,185,184,184,185,185,185,185,185,185,185,185,181,106,230,214,69,145,92,228,89,22,69,147,250,127,111,237,253,158,127,239,131,227,60,127,131,136,222,253,239,214,205,239,102,246,111,123,54,63,91,245,189,239,123,111,109,179,109,155,111,149,141,97,254,43,15,241,88,249,214,148,242,167,148,151,181,60,169,82,163,153,149,11,26,133,141,99,80,161,68,202,197,56,166,82,83,56,230,52,146,153,159,43,227,60,239,249,199,200,127,207,243,248,156,164,39,53,53,55,55,55,55,55,25,38,230,231,36,92,228,156,147,145,100,156,147,145,100,155,156,147,145,100,89,39,34,200,178,172,171,47,245,254,207,59,242,39,55,143,241,30,55,214,240,120,155,217,179,127,141,239,214,246,111,102,247,235,102,205,237,179,109,237,182,246,222,246,198,219,223,58,72,70,180,151,58,72,231,92,169,210,158,84,164,167,153,196,177,240,164,73,46,98,39,18,198,146,153,197,56,215,164,106,102,113,196,78,53,41,121,62,15,159,255,0,59,243,191,229,126,119,211,235,18,73,170,84,174,114,78,73,201,57,39,44,229,156,145,146,114,206,89,203,57,86,85,150,114,172,171,42,202,178,172,203,55,246,254,239,200,94,79,143,241,254,63,213,124,111,172,225,241,247,239,123,245,179,123,223,173,183,191,198,246,111,126,183,239,123,219,27,222,247,182,247,182,55,180,146,81,194,133,60,169,229,79,60,172,107,26,141,105,74,133,138,112,172,106,84,241,252,248,88,212,168,152,73,37,42,18,216,133,51,19,134,97,66,73,33,37,42,82,71,151,241,62,103,252,223,204,255,0,144,249,95,242,255,0,43,234,151,137,53,115,146,114,78,89,203,57,167,52,230,156,211,154,115,206,121,206,179,44,235,58,242,23,145,25,240,124,118,15,169,248,255,0,72,241,254,165,131,193,222,255,0,27,222,247,189,175,198,247,179,126,247,239,123,55,179,99,109,237,189,182,54,109,182,247,182,246,146,18,73,74,142,20,40,210,74,125,74,80,162,99,149,42,121,83,202,72,82,162,101,46,84,204,175,73,40,136,156,113,141,74,148,144,133,42,82,73,36,36,146,83,41,35,47,141,155,234,25,191,230,89,191,228,89,127,227,185,63,228,53,255,0,42,175,249,163,255,0,158,175,162,47,163,207,210,35,232,216,254,129,31,243,188,95,243,124,63,243,108,95,243,188,63,71,193,245,220,120,55,179,123,245,189,250,219,123,55,189,254,246,111,123,222,205,155,223,173,239,123,111,211,109,183,177,189,182,219,109,255,0,255,196,0,74,16,0,1,2,2,7,6,2,6,8,4,5,3,2,7,0,0,1,0,2,3,17,4,16,32,33,49,65,97,5,18,48,64,80,81,19,34,6,82,96,113,129,145,20,35,50,66,98,114,161,177,21,36,51,209,37,67,83,178,193,146,194,210,115,130,52,53,69,85,99,147,225,255,218,0,8,1,1,0,3,63,0,176,58,161,81,162,221,14,19,223,249,90,74,218,113,101,185,66,139,239,112,221,253,214,213,116,137,134,198,126,103,127,105,170,97,251,113,225,183,221,55,35,247,233,127,38,40,3,237,71,138,126,65,80,134,46,136,126,42,128,49,99,143,254,226,168,35,252,159,155,138,161,15,242,7,204,170,23,250,3,230,85,19,253,31,212,170,47,250,103,230,85,31,38,187,230,161,119,114,3,7,148,241,131,255,0,69,20,102,20,70,253,212,225,136,227,119,246,134,151,72,254,141,26,35,199,112,211,37,181,99,75,122,27,33,140,247,221,253,166,176,52,138,89,247,67,108,191,82,182,100,48,55,225,190,33,238,247,31,248,146,160,64,151,133,68,132,210,51,221,4,166,55,236,180,4,59,32,133,129,93,235,43,33,3,80,236,129,201,17,129,42,35,115,159,188,39,9,239,51,228,84,44,230,223,120,80,223,246,30,15,7,191,30,75,30,74,254,145,135,37,72,164,29,216,16,30,243,248,90,74,218,81,228,98,53,144,91,248,140,207,200,42,43,36,105,49,159,16,246,30,80,182,117,26,94,21,18,30,240,205,195,120,252,202,107,110,13,8,14,99,74,133,65,5,72,133,246,35,59,220,111,31,170,164,67,35,196,134,215,141,60,165,81,29,115,247,161,159,196,46,249,133,10,40,156,40,141,112,252,36,30,72,117,12,185,28,248,116,170,89,149,30,3,223,168,23,124,213,42,44,141,38,43,97,143,85,190,98,182,109,30,68,193,241,93,222,33,159,233,130,135,13,161,172,96,107,70,64,73,1,151,66,198,178,211,188,194,90,238,237,50,42,159,71,50,241,60,70,246,136,39,250,168,6,66,147,5,208,207,118,249,154,168,212,145,56,17,216,253,26,111,181,114,28,89,33,214,37,98,118,226,70,120,100,40,110,123,251,52,18,85,54,145,35,26,80,88,123,222,239,146,217,244,112,215,62,25,141,19,188,75,199,201,49,128,53,141,0,100,0,67,145,199,139,143,11,26,129,69,164,61,132,181,195,2,219,136,91,78,137,32,232,130,52,49,247,98,222,126,120,170,4,98,25,73,14,163,196,57,190,246,124,194,135,25,130,36,24,141,123,14,14,97,152,42,99,30,95,183,23,46,157,75,166,16,32,65,115,134,110,55,52,124,83,4,159,76,136,92,125,70,92,62,106,141,69,104,108,8,45,96,208,32,16,224,252,250,24,88,169,229,85,46,132,243,18,137,72,124,39,103,186,110,62,241,129,81,224,145,15,105,81,247,219,135,139,6,231,124,90,86,206,218,109,222,161,210,152,247,12,89,131,199,189,166,255,0,99,233,148,217,24,112,247,97,250,239,184,42,44,2,31,30,113,162,126,43,155,242,77,96,1,173,0,12,0,175,46,1,233,24,213,57,220,157,13,205,124,39,150,68,23,135,52,200,131,161,11,106,236,253,216,116,192,41,116,113,33,231,50,138,6,142,207,226,182,78,214,147,32,82,55,41,25,192,141,229,127,195,191,195,216,186,85,48,141,200,123,176,243,123,176,84,90,60,157,17,190,36,94,238,192,123,130,107,112,11,14,67,94,21,252,236,213,202,70,96,200,140,10,219,27,36,182,20,115,244,202,32,187,114,41,243,180,126,23,255,0,117,177,246,216,12,163,199,240,233,89,209,227,73,143,248,122,223,14,189,46,13,34,148,233,65,97,221,205,198,224,20,8,50,124,97,226,68,198,252,7,184,32,0,0,92,128,235,26,44,107,154,32,239,54,97,194,240,70,32,133,181,182,81,100,13,160,13,54,134,46,155,143,215,52,104,236,254,43,101,109,216,91,251,62,148,215,68,3,207,5,222,88,172,247,180,219,151,4,112,51,233,111,140,224,200,108,46,119,96,133,207,165,95,158,224,195,226,153,13,160,49,160,1,144,230,117,233,49,232,177,89,72,163,70,124,40,236,51,108,72,110,45,112,58,16,163,81,247,40,190,145,67,49,33,224,41,112,155,231,26,196,104,199,222,21,19,104,64,101,38,133,73,100,104,15,189,175,134,233,143,96,35,82,36,231,205,144,255,0,82,161,81,219,40,108,3,92,207,53,175,75,158,75,106,250,63,73,250,78,203,164,186,25,39,235,33,155,225,68,209,237,205,108,205,182,97,208,233,251,180,45,166,110,12,121,250,168,167,240,56,231,161,228,15,77,124,103,110,195,108,202,100,57,62,47,154,39,232,16,18,236,135,35,173,187,205,157,108,107,205,139,99,178,198,160,114,65,192,220,182,166,193,48,232,123,83,126,155,179,5,192,184,206,52,33,248,73,251,67,66,182,118,219,162,182,155,179,41,76,141,0,220,119,110,115,79,103,3,120,61,105,241,200,36,73,157,211,33,52,53,141,146,28,198,182,117,174,92,238,60,80,65,91,83,96,83,5,59,101,82,157,6,48,150,243,113,100,65,234,189,185,133,179,189,33,16,232,84,221,218,38,216,148,188,39,31,171,138,70,112,137,255,0,110,60,204,185,233,144,0,153,88,58,32,191,178,2,87,93,208,245,225,124,172,99,205,98,177,83,152,146,51,222,19,4,94,8,184,130,169,27,60,195,217,190,146,189,241,168,151,54,29,52,13,232,144,244,137,235,13,113,84,122,92,8,84,154,44,102,69,163,196,104,123,34,67,118,243,92,14,4,17,198,151,22,238,4,249,23,61,192,52,94,154,201,18,38,238,234,82,246,26,124,13,16,53,109,111,68,99,129,4,152,251,45,206,156,90,27,207,150,252,93,12,253,215,45,151,233,45,5,180,237,153,28,57,184,69,132,235,162,66,126,109,123,122,30,28,115,16,128,5,200,48,11,189,146,209,104,182,159,163,244,230,109,29,149,72,48,99,179,17,139,34,55,212,120,204,21,179,189,43,130,32,187,118,143,181,225,182,113,104,164,227,221,240,201,197,191,183,67,191,138,98,29,16,0,41,73,97,236,134,53,226,163,209,35,194,165,81,34,190,13,38,19,131,225,197,134,100,230,145,152,42,14,217,240,182,78,220,123,32,109,128,55,97,197,251,48,233,63,217,250,103,100,113,37,206,152,134,236,20,165,86,21,246,226,107,210,207,43,165,157,22,40,226,219,156,12,193,25,20,226,232,27,15,210,88,210,137,115,40,180,247,224,238,204,138,123,246,114,4,116,179,16,200,125,148,7,72,215,157,40,163,217,30,214,244,224,104,167,146,209,76,27,148,77,154,232,59,15,210,24,197,212,18,67,40,212,199,153,152,61,153,16,230,206,199,36,28,208,230,144,90,68,193,6,96,131,100,219,60,206,22,60,82,0,251,31,186,148,130,210,216,230,245,232,65,104,180,170,115,185,30,200,167,12,147,150,139,30,22,53,104,183,129,185,68,216,175,133,177,54,228,82,237,150,72,101,30,146,227,51,71,39,238,187,240,126,201,175,107,94,199,7,48,128,90,225,120,32,216,188,219,206,206,92,183,116,99,59,117,191,211,31,170,148,184,38,200,230,117,231,130,8,84,16,236,135,100,59,45,16,236,177,50,71,32,158,220,145,110,92,12,150,43,69,162,14,157,201,251,22,36,61,135,182,163,19,178,220,67,104,212,135,99,71,39,238,147,234,126,200,56,53,205,51,105,188,16,102,8,61,20,198,119,134,195,228,24,158,234,85,97,104,154,229,204,131,205,221,198,8,32,80,57,32,114,64,228,167,146,34,114,9,237,157,200,140,65,224,98,180,64,131,114,118,205,137,7,96,109,168,196,208,92,119,40,148,135,159,232,147,132,55,19,247,14,71,37,158,92,205,197,79,131,226,56,193,135,135,222,112,253,148,128,182,77,64,33,94,188,249,228,117,229,66,5,52,228,154,114,64,228,177,242,167,178,114,5,61,152,139,26,87,138,197,3,59,174,78,156,31,71,118,212,98,98,92,202,21,37,231,17,148,39,158,254,169,230,240,183,186,124,24,71,206,126,209,236,165,43,78,114,146,13,67,159,191,163,93,193,105,201,53,217,38,187,238,160,103,229,79,100,203,90,158,203,156,219,88,169,162,12,196,193,6,96,140,66,254,45,9,155,27,106,196,150,213,132,223,170,136,110,241,225,183,254,241,159,126,128,40,236,221,101,241,157,128,237,170,36,239,19,55,27,201,43,11,172,57,196,72,44,38,128,8,1,201,235,213,187,240,65,196,38,184,96,154,255,0,186,131,129,147,84,72,68,150,130,156,210,65,18,43,74,241,83,170,53,26,52,42,77,26,35,161,82,33,60,62,28,70,220,90,225,120,33,66,244,146,130,91,27,117,155,82,0,13,164,66,25,246,136,221,13,156,249,150,81,161,24,143,199,6,142,229,68,141,16,197,136,102,227,122,150,86,29,16,132,27,136,65,189,47,91,90,241,254,117,75,145,194,176,83,92,48,76,137,59,144,59,197,173,81,96,19,188,211,33,103,26,169,155,19,104,64,218,84,23,110,199,134,111,25,61,135,22,59,66,168,155,123,103,64,218,20,83,115,132,162,67,63,106,28,65,139,29,206,54,27,28,247,144,26,209,50,74,117,54,54,249,254,152,185,141,236,20,176,176,232,132,18,19,88,48,82,195,155,239,194,214,198,188,128,228,165,198,154,99,198,9,145,67,188,169,240,139,156,198,167,48,144,225,34,44,104,177,81,253,25,218,98,49,37,219,62,49,12,165,66,198,236,158,7,172,213,6,147,6,21,34,3,195,224,68,104,123,30,211,48,230,156,8,227,99,197,241,226,125,22,17,250,166,31,57,25,184,101,240,64,74,188,0,197,23,144,226,19,97,180,33,210,251,215,127,57,143,36,28,47,76,138,211,229,10,123,206,99,111,81,32,57,205,123,108,98,167,59,145,160,71,110,193,167,196,254,86,43,137,162,189,198,230,68,63,114,125,157,150,188,60,184,255,0,70,132,32,194,119,215,196,195,240,183,186,148,150,21,78,67,52,92,67,156,19,97,52,9,114,122,240,245,183,175,91,100,80,110,77,138,28,67,47,81,104,175,33,205,59,182,49,185,95,49,48,69,224,139,136,71,108,208,77,18,150,249,237,42,48,1,243,198,43,48,15,254,252,196,42,36,7,199,137,246,90,46,29,206,64,40,148,168,239,143,20,249,222,103,238,29,172,24,133,174,112,77,132,209,33,207,14,4,237,107,201,97,42,238,232,45,136,8,33,50,59,92,67,20,90,28,71,121,78,229,154,78,199,167,192,218,20,67,40,176,221,123,114,123,78,45,58,21,71,218,212,26,61,62,140,233,194,136,217,203,54,156,218,117,28,164,235,250,117,43,194,132,239,229,161,25,14,206,118,101,72,4,46,88,20,232,239,107,136,242,166,66,96,187,216,78,221,0,60,72,132,202,67,29,229,81,40,113,29,38,157,202,244,83,154,59,35,104,125,6,144,249,80,41,78,2,252,33,197,55,7,123,142,7,149,193,125,22,143,244,104,78,254,98,53,218,181,153,149,41,86,232,241,26,208,46,77,129,12,25,112,53,230,251,116,108,45,5,119,44,28,36,83,41,12,119,149,68,161,197,112,45,242,78,173,22,138,104,237,58,15,208,233,47,157,58,138,3,93,60,95,15,6,191,254,15,41,14,139,2,44,120,174,148,54,52,184,168,148,250,92,90,84,92,94,110,29,155,144,88,44,17,123,154,209,137,66,27,3,156,47,213,0,36,44,31,100,103,201,7,54,69,50,147,13,254,75,212,74,36,87,49,192,202,119,27,17,246,62,208,129,79,129,139,12,158,220,158,195,139,74,131,76,163,193,165,64,112,116,24,172,15,97,208,242,126,44,102,236,216,78,242,48,135,70,150,110,201,191,10,176,168,197,120,136,230,220,132,54,6,142,173,167,37,243,228,240,227,53,237,145,9,177,161,189,205,109,248,205,58,11,220,199,139,193,174,121,35,2,43,246,53,33,222,71,147,18,140,78,78,197,204,248,226,57,38,108,218,20,106,73,145,120,27,176,219,221,231,4,248,175,116,88,142,222,123,201,115,156,115,37,1,42,140,104,172,96,23,18,132,8,77,187,46,163,44,249,137,244,38,197,97,105,8,141,232,208,216,164,72,34,241,92,72,17,97,199,130,75,98,195,112,123,28,49,4,25,132,205,171,64,129,75,109,207,35,118,35,125,87,183,17,193,199,129,244,253,160,40,208,221,58,61,30,109,208,196,205,72,5,130,193,78,81,28,16,107,64,246,177,148,136,78,5,179,36,35,68,140,231,181,190,66,77,122,35,179,182,137,162,197,116,168,212,162,27,163,98,100,126,56,114,3,101,236,232,177,90,64,164,68,250,168,35,241,59,63,130,153,153,51,39,18,128,2,163,26,43,26,16,131,5,183,101,213,231,196,237,100,116,89,228,155,73,130,243,186,157,71,140,248,110,24,21,165,82,51,23,17,120,35,34,23,241,61,157,10,51,207,243,12,250,168,223,153,185,252,109,227,192,254,35,181,93,10,27,167,70,163,78,27,123,23,125,227,94,11,121,194,33,8,49,160,14,22,190,210,8,140,115,74,145,116,102,11,197,143,225,251,72,66,123,165,71,164,202,27,180,119,221,60,111,225,91,46,60,102,144,35,191,234,160,254,119,103,240,8,155,201,188,226,176,88,35,18,35,24,51,40,66,130,223,119,45,175,28,88,61,30,238,54,156,147,105,16,92,55,68,228,141,22,144,246,75,202,73,34,188,198,33,127,17,217,240,162,184,253,115,7,135,20,126,38,231,241,226,253,59,106,10,36,39,78,5,22,108,187,56,135,31,150,21,224,188,88,237,39,36,33,194,104,231,13,188,122,116,184,247,242,27,205,150,72,61,142,138,214,249,133,232,137,206,173,17,161,237,3,71,123,165,6,145,229,208,60,97,196,102,202,217,180,170,107,141,236,97,12,29,222,110,104,78,136,247,68,121,37,238,37,206,39,18,74,194,188,28,115,82,0,113,181,168,115,35,163,247,179,135,31,94,40,143,5,192,227,36,104,244,151,182,87,19,49,91,152,67,216,72,123,72,115,72,196,17,122,20,234,20,10,72,251,78,111,156,118,112,184,240,252,72,244,93,147,13,215,67,30,52,111,204,235,154,62,1,97,94,243,216,209,153,91,144,154,125,140,249,244,96,224,66,152,49,26,219,197,120,163,14,52,122,11,207,149,255,0,89,15,222,49,28,40,116,120,49,99,197,118,236,56,109,47,121,57,6,137,149,19,105,83,233,84,232,132,239,70,136,93,35,147,114,31,1,86,21,120,145,216,50,5,6,65,111,31,47,105,4,104,46,187,36,96,199,136,195,132,234,184,167,209,41,48,105,44,198,27,195,189,227,48,155,22,27,34,176,205,175,104,112,58,30,15,208,182,56,162,49,223,93,75,119,135,168,134,219,220,86,21,92,42,222,140,12,150,236,54,142,123,30,66,255,0,97,67,216,90,87,135,20,196,2,173,20,242,94,45,12,192,113,243,193,116,189,237,55,142,15,211,246,236,88,44,51,131,68,104,128,222,219,194,247,31,154,193,96,176,170,240,84,152,61,180,17,33,60,201,72,144,113,175,232,187,65,128,153,50,44,225,159,126,35,128,205,157,179,233,148,231,159,44,24,78,120,212,129,112,248,148,248,209,98,70,136,102,247,184,189,199,185,113,153,171,10,238,105,94,81,96,88,215,135,62,72,112,47,177,151,27,229,193,186,206,29,28,68,130,225,37,225,210,34,10,180,69,164,57,183,57,164,16,117,8,82,40,240,163,15,190,208,126,57,219,52,125,153,70,217,204,116,159,73,137,188,241,248,33,255,0,253,174,66,169,144,164,214,171,135,0,243,195,146,191,146,237,210,131,152,66,45,139,190,5,120,162,96,197,163,147,124,55,76,13,29,111,233,222,144,210,33,181,211,133,69,2,3,123,76,94,239,212,216,213,121,155,239,94,70,89,214,189,109,107,111,191,180,23,45,230,23,75,91,30,5,62,28,238,108,64,97,159,142,22,153,66,161,210,169,113,15,146,12,39,196,62,230,137,167,210,105,17,169,17,12,226,68,123,162,56,234,227,51,99,5,55,181,73,141,228,53,228,181,183,173,179,194,203,158,239,92,249,189,248,78,91,142,112,236,107,45,115,94,220,90,65,30,240,132,88,108,136,48,115,67,190,118,126,135,232,244,72,32,202,37,42,35,96,143,202,60,199,246,87,213,133,126,118,175,43,109,252,185,193,201,225,236,6,252,39,45,216,239,21,99,86,245,27,112,155,216,75,126,24,139,59,244,250,22,207,105,242,193,130,98,59,243,68,63,216,88,194,175,51,87,149,170,225,199,202,118,126,124,150,188,30,254,194,222,166,194,183,98,155,27,148,136,144,242,123,102,61,226,207,211,246,254,211,164,3,54,248,198,27,127,44,63,32,253,170,148,172,94,213,229,106,184,88,214,206,188,150,188,141,253,3,62,147,229,40,111,78,199,133,72,132,254,206,145,247,27,172,10,14,207,166,210,207,249,48,31,19,226,208,139,222,231,184,222,76,201,238,77,171,194,185,170,109,246,19,14,129,119,35,114,152,38,197,203,126,20,55,102,90,13,127,70,244,114,144,192,100,232,241,25,4,124,78,241,253,2,190,196,214,11,5,130,242,138,141,153,173,108,107,80,232,121,114,247,116,233,180,216,197,78,14,233,197,164,143,249,174,76,217,116,32,113,223,140,225,242,104,87,217,184,169,149,34,20,218,45,79,155,215,135,127,4,115,82,232,243,99,149,230,187,138,147,226,179,188,141,98,62,223,124,32,124,176,32,178,31,196,249,207,239,98,251,18,112,19,83,104,224,229,99,94,110,124,76,249,185,215,42,238,226,95,202,249,10,243,58,198,236,113,168,34,191,164,237,205,169,26,119,26,67,218,61,205,59,170,251,23,131,85,243,82,114,184,41,219,215,153,215,139,46,44,186,223,144,169,57,213,226,183,98,49,221,156,42,16,96,70,140,239,178,200,110,121,248,9,163,18,44,72,135,23,56,184,157,73,177,149,137,16,85,202,98,189,86,93,127,62,20,135,35,135,47,229,43,206,229,141,119,21,48,14,147,95,71,216,91,82,32,199,232,239,104,247,184,110,240,47,88,44,47,83,10,65,100,165,94,188,13,125,167,242,21,230,54,49,83,99,87,135,232,237,40,103,17,240,216,62,115,87,217,185,93,92,136,10,225,125,122,240,117,224,124,186,190,125,40,110,148,119,205,140,85,199,66,165,178,104,176,243,125,34,127,244,180,240,37,81,5,92,20,235,186,212,249,62,220,125,121,94,221,82,226,175,54,46,82,47,71,115,102,66,255,0,213,119,236,21,230,206,22,36,224,176,87,90,214,206,168,114,135,163,93,103,14,118,92,75,149,230,204,158,84,233,148,40,121,54,1,63,55,89,190,212,164,176,177,118,182,103,98,251,90,217,215,217,203,138,198,204,158,183,182,180,54,250,180,118,126,229,94,109,107,86,10,229,125,83,171,62,6,189,42,254,189,113,87,21,141,139,148,136,83,219,113,71,171,10,24,253,21,230,206,117,95,93,225,106,174,28,41,243,163,161,225,210,46,43,27,24,213,34,20,246,221,47,70,195,255,0,104,88,217,185,74,221,213,235,205,142,79,14,62,124,41,89,29,10,235,119,47,241,202,111,254,207,246,139,119,74,177,92,214,28,61,108,106,178,235,216,112,116,230,74,144,87,218,242,149,61,185,78,247,183,253,162,222,22,48,21,75,216,156,234,195,163,220,175,181,228,43,252,110,155,239,103,251,71,10,85,97,103,62,20,248,189,189,150,146,197,95,107,200,229,254,51,74,247,51,253,162,171,229,107,5,173,115,42,251,29,173,142,167,219,150,35,158,198,223,144,175,241,104,199,214,99,15,233,42,241,181,149,114,22,38,175,224,74,214,188,83,208,112,235,50,103,197,127,137,53,221,224,179,244,36,85,141,185,149,42,167,102,238,36,249,236,45,95,201,207,146,194,201,157,140,185,9,155,87,47,40,26,175,230,168,207,239,10,95,34,177,174,118,100,61,245,225,98,103,137,62,96,117,9,169,243,87,219,251,35,85,49,67,126,143,11,27,184,23,215,157,137,87,62,20,184,227,147,195,143,159,18,238,62,11,176,229,103,106,229,230,96,247,149,189,68,128,255,0,86,33,253,69,88,240,176,225,223,85,194,250,167,103,62,123,91,56,112,111,235,56,169,198,3,69,226,108,248,167,213,123,77,119,217,60,25,88,191,129,159,89,207,133,157,140,109,103,203,11,55,21,58,67,244,144,94,37,6,148,223,192,79,202,245,121,171,30,82,67,171,225,198,195,164,220,86,244,104,167,241,45,246,61,153,16,66,33,206,4,112,112,176,13,121,215,119,49,135,11,5,62,75,14,183,138,147,92,86,243,156,123,149,114,220,164,70,3,13,243,46,12,234,192,43,171,152,174,65,107,84,135,28,231,103,14,163,159,73,185,110,193,136,127,13,114,142,231,100,64,53,227,86,53,220,56,119,171,237,25,112,239,175,11,67,152,187,168,95,198,148,18,59,144,43,7,195,119,188,87,143,24,41,147,92,228,38,138,184,114,24,27,24,117,137,244,12,84,220,198,13,77,123,240,72,150,6,106,251,82,171,26,175,170,234,164,45,223,99,62,68,90,195,139,135,51,46,71,14,111,21,189,72,127,96,37,84,150,243,93,168,82,36,113,245,176,103,201,10,207,179,82,105,43,126,43,221,221,196,213,58,175,38,254,39,107,55,172,57,12,16,168,216,28,93,121,236,236,11,89,207,162,110,64,136,103,124,165,93,213,7,54,99,37,141,142,252,91,249,59,185,13,121,110,203,14,171,32,164,214,51,185,159,202,206,241,45,238,56,119,161,196,149,155,173,94,167,100,44,42,195,129,135,43,219,144,195,162,225,94,43,126,146,225,147,68,171,184,149,51,53,39,7,118,43,27,24,218,146,206,169,219,189,72,113,48,230,176,228,48,234,161,172,113,39,0,81,123,222,243,153,38,178,140,228,20,132,151,137,1,142,204,121,79,195,129,143,64,195,150,191,216,45,200,14,3,23,29,209,102,75,84,11,162,66,57,141,225,240,88,217,199,141,58,165,104,90,21,30,166,45,225,208,37,86,252,97,12,96,209,63,137,177,51,126,10,102,175,10,60,56,157,141,254,229,219,10,241,88,244,51,110,241,99,14,14,28,198,10,93,40,53,174,36,220,17,139,21,241,59,146,108,74,199,143,69,97,55,185,190,71,124,44,99,197,191,131,243,70,206,28,134,28,95,157,172,58,205,198,173,200,5,160,249,157,229,179,50,86,74,117,6,198,116,23,27,162,11,191,48,179,143,35,133,161,100,89,23,86,22,11,15,100,113,82,5,120,177,247,1,185,131,245,177,157,89,85,138,48,94,216,141,185,205,33,195,224,155,30,12,40,236,251,47,104,112,171,74,177,227,30,16,239,86,8,21,173,88,44,44,225,193,249,115,24,117,49,10,19,222,112,1,23,185,207,56,147,51,106,102,117,0,9,37,77,120,176,34,209,28,239,52,51,190,207,202,236,126,71,159,21,19,43,23,34,165,42,176,168,91,159,87,187,147,251,48,65,198,243,106,234,164,22,85,26,13,58,4,121,157,201,238,188,119,97,184,160,64,112,189,166,241,238,43,30,83,11,24,95,85,248,174,245,96,65,70,201,186,208,233,61,186,56,107,92,78,0,35,26,52,72,157,205,222,238,4,130,153,38,171,201,95,77,217,194,19,204,227,81,207,134,117,111,221,60,228,236,14,4,144,246,3,46,54,181,98,183,33,120,96,222,251,190,28,27,140,170,184,213,244,13,161,9,239,50,129,19,234,226,251,157,129,248,21,122,199,131,165,131,93,202,75,10,240,180,81,235,152,115,146,171,21,32,87,143,29,238,7,202,46,111,2,65,76,217,20,253,156,192,243,58,68,9,67,126,163,35,94,60,198,10,114,172,89,195,148,195,150,154,249,244,159,14,17,96,62,119,221,193,198,172,236,127,15,167,195,47,116,160,69,250,184,189,128,56,31,129,87,244,44,47,227,79,216,105,2,73,94,60,119,63,238,139,135,2,64,162,177,42,102,207,211,246,120,133,20,206,145,71,1,142,158,109,251,165,105,203,142,62,21,4,22,21,31,98,119,33,150,52,249,223,250,14,14,43,43,110,217,180,232,84,129,253,34,119,34,183,187,14,41,143,107,98,67,51,99,192,115,72,204,28,15,58,16,178,16,171,4,16,66,206,190,195,6,53,206,38,224,38,140,120,174,136,112,203,65,193,37,76,204,169,155,126,60,7,108,232,206,250,200,67,122,12,243,102,99,225,98,124,208,168,32,130,194,172,42,30,197,235,84,254,161,166,243,123,171,194,221,202,67,129,22,135,72,131,73,130,101,18,27,131,134,186,40,91,66,137,6,151,7,236,61,179,35,54,187,49,84,172,79,146,190,172,237,225,107,10,207,27,14,180,32,195,123,201,247,106,83,162,61,207,113,155,141,252,34,74,153,211,130,40,116,147,66,142,239,229,163,144,26,114,108,76,143,184,169,79,149,151,19,14,1,71,171,27,25,113,36,23,143,20,180,31,35,127,83,195,144,42,243,193,145,95,196,232,126,20,87,78,151,0,6,190,120,185,185,57,99,103,78,4,184,198,162,141,88,33,100,214,122,94,28,223,134,223,13,135,206,239,208,114,241,182,117,50,21,46,9,243,48,222,223,89,167,22,149,6,155,70,131,75,163,153,194,136,217,141,59,131,168,89,112,187,113,48,175,5,175,12,215,170,28,28,57,153,116,11,148,147,97,49,207,37,58,44,71,61,216,147,196,36,241,62,129,31,232,116,135,202,135,29,216,156,24,243,116,253,199,62,108,89,61,237,4,16,185,4,44,97,193,188,85,135,35,58,176,232,50,4,156,17,143,18,64,249,26,110,225,138,177,226,253,58,7,240,250,83,255,0,154,132,223,171,113,251,236,25,123,194,151,3,78,83,74,192,171,14,1,90,242,24,115,183,114,114,5,27,224,176,222,113,61,135,55,22,141,26,28,120,15,44,138,199,7,53,195,34,161,109,138,27,99,182,66,59,100,216,204,236,238,254,227,204,225,193,194,222,188,175,106,176,233,50,156,202,16,154,100,124,231,0,139,156,92,227,50,111,231,35,108,170,91,41,48,175,111,217,136,204,158,206,197,64,166,209,225,210,168,207,222,131,16,76,28,198,135,177,28,190,8,89,195,128,16,186,228,20,249,44,59,112,110,232,82,173,176,152,231,20,232,207,47,113,224,95,103,231,192,187,129,154,118,202,143,225,71,36,208,98,145,226,12,119,15,174,19,34,53,175,99,131,152,224,11,92,47,4,30,74,250,165,104,173,106,194,198,21,225,205,97,210,3,1,36,220,140,119,254,1,128,232,31,70,115,54,101,53,255,0,203,56,202,12,71,127,150,227,145,208,169,113,52,227,97,192,30,193,6,131,122,49,92,90,211,228,7,161,8,205,135,178,233,239,250,192,55,96,69,113,199,240,59,94,202,86,103,202,106,176,181,175,91,214,216,8,188,152,108,55,102,109,231,157,137,115,27,166,96,144,69,224,161,79,99,104,20,231,129,76,104,148,55,159,243,64,203,243,5,140,199,19,69,167,11,11,56,11,120,112,112,230,101,107,14,46,188,9,3,122,38,108,97,191,51,201,145,201,57,142,107,216,226,215,130,8,112,196,20,221,166,198,208,169,174,2,158,209,38,191,1,20,15,251,150,156,193,179,218,160,22,22,48,171,11,250,196,149,229,140,55,247,89,217,206,201,225,104,140,240,227,93,91,161,185,175,99,139,94,211,48,225,113,4,102,153,180,218,218,29,53,193,180,246,137,53,216,8,160,127,220,187,173,45,142,71,11,56,117,221,84,145,51,107,15,188,242,162,160,154,113,9,168,32,16,168,161,87,116,42,9,166,160,130,48,156,215,180,144,240,102,8,196,16,153,79,107,40,84,231,6,211,48,100,67,132,95,127,103,41,89,159,26,92,76,57,156,58,12,167,122,1,23,77,173,60,176,40,84,16,170,98,162,138,112,201,30,200,246,70,162,143,101,52,81,38,250,136,32,223,49,129,66,32,101,11,104,190,81,46,108,40,238,251,218,63,93,106,198,234,207,39,133,169,87,127,37,135,110,13,220,142,60,57,4,0,51,40,188,200,27,173,227,200,2,16,40,41,84,83,130,238,16,118,72,4,14,73,163,36,206,200,100,16,204,41,96,81,41,185,212,66,7,21,44,17,236,157,4,50,137,78,113,116,12,25,16,222,89,161,209,7,52,61,132,22,17,48,69,224,142,78,92,190,28,17,94,22,143,51,44,208,1,57,231,78,96,162,138,54,38,138,54,65,65,4,81,68,45,42,36,162,20,122,17,16,162,3,18,138,113,102,109,213,170,28,120,109,141,5,225,208,221,129,22,52,229,69,114,226,95,207,203,62,44,176,40,184,204,243,46,78,236,157,217,30,200,32,138,114,40,246,71,178,209,77,20,254,200,230,42,61,144,236,167,146,202,72,27,200,66,119,35,44,20,130,141,66,126,252,39,121,79,218,97,192,168,84,166,111,195,50,119,222,97,196,41,101,203,103,209,176,225,119,225,1,154,36,144,23,207,154,111,100,59,45,16,245,83,123,38,26,180,67,178,6,161,217,51,178,8,0,154,114,77,31,117,52,100,155,217,55,178,33,28,194,210,162,81,236,162,65,120,124,55,22,188,96,66,135,73,147,34,201,145,176,159,221,114,150,92,41,89,186,222,28,28,57,251,184,250,160,38,156,253,27,92,231,103,30,80,88,29,170,53,3,146,21,20,81,174,117,3,146,29,144,236,180,77,77,42,72,96,154,154,83,225,1,14,49,47,134,48,57,132,215,183,125,132,22,247,28,208,171,85,175,74,202,192,8,155,155,123,145,156,220,102,121,220,81,224,148,107,8,32,130,8,85,221,20,228,238,202,98,101,106,180,90,39,195,51,97,247,140,143,189,54,47,221,221,127,171,253,148,184,55,240,176,224,11,186,54,182,49,172,4,248,151,224,222,231,20,25,112,28,249,70,177,81,68,39,39,118,68,212,87,122,229,92,177,66,162,130,5,119,67,52,212,26,132,240,65,194,79,19,215,53,116,197,237,238,20,173,246,227,124,186,112,90,167,60,238,195,4,148,1,155,204,221,208,28,143,106,130,22,13,122,86,44,139,58,33,83,147,142,73,253,147,142,40,35,144,209,23,9,180,94,156,194,67,154,65,228,240,224,107,86,188,230,182,165,86,171,33,121,236,19,223,230,138,100,222,195,20,214,9,52,0,56,61,248,58,217,60,64,106,41,211,78,70,163,217,26,137,202,173,16,66,162,136,196,43,176,68,163,87,100,86,136,21,44,17,237,53,60,66,98,13,193,14,202,28,97,186,246,130,20,86,77,208,70,251,59,125,228,90,76,197,249,242,26,173,66,21,106,143,67,214,206,170,89,168,241,164,231,121,25,220,226,161,193,251,34,252,220,111,61,13,200,217,8,84,16,67,178,200,35,80,236,135,100,6,8,32,135,106,167,80,25,34,137,71,48,154,114,93,130,239,84,150,138,228,74,163,210,199,214,50,79,201,195,21,73,128,11,225,55,197,135,143,151,17,240,69,164,130,10,61,31,94,38,182,2,144,188,169,102,169,52,139,229,185,15,187,191,178,131,6,68,13,231,250,206,233,197,20,108,104,130,209,79,36,81,236,143,100,81,171,68,70,75,186,111,116,44,104,130,1,14,200,42,13,52,19,22,16,108,79,93,151,21,75,130,75,232,255,0,93,15,75,156,19,225,184,181,236,45,112,196,56,72,243,178,179,135,7,189,155,173,76,201,183,184,224,21,42,60,156,255,0,170,103,226,199,228,160,64,145,13,222,127,172,235,205,137,216,207,160,104,180,67,25,45,16,65,95,130,154,40,162,157,217,30,200,73,2,130,1,12,130,210,177,107,68,83,170,210,193,177,66,167,141,218,76,6,187,179,176,112,247,16,162,121,157,179,227,135,15,244,226,220,126,4,42,109,5,251,148,186,51,225,156,137,23,31,113,68,112,199,7,11,19,225,231,94,182,245,90,173,86,170,52,119,110,192,134,231,157,5,202,51,252,212,168,155,131,212,101,231,230,168,244,97,245,80,192,62,182,39,230,122,73,82,168,216,39,36,238,200,230,43,8,33,83,74,98,104,192,32,114,66,190,200,172,170,25,132,222,213,5,42,180,172,156,17,205,4,42,206,74,20,102,24,113,161,181,236,56,181,192,16,182,77,47,121,244,109,234,52,83,234,94,201,254,82,182,197,16,185,208,97,138,76,33,131,161,99,241,105,189,69,130,242,200,176,156,199,140,90,224,65,249,27,120,90,214,198,181,252,234,194,172,45,222,133,90,213,173,90,215,170,213,75,52,92,67,89,55,59,32,47,37,109,10,76,137,96,132,206,241,49,249,5,70,133,39,71,115,163,63,177,185,191,32,153,13,161,172,96,107,123,1,33,102,238,140,123,39,20,14,41,169,169,137,161,1,146,61,150,139,68,81,180,81,171,186,157,103,178,114,40,174,245,4,5,68,228,187,132,208,16,78,57,84,5,154,5,61,165,148,218,36,40,163,187,219,50,61,197,108,234,68,221,64,143,18,142,252,154,239,172,103,235,122,219,244,57,190,20,6,210,97,140,224,58,103,254,147,34,163,209,158,97,199,128,248,113,6,45,136,210,211,242,40,217,214,173,108,235,99,90,181,175,94,6,182,117,90,160,51,78,136,237,216,109,115,157,217,162,103,244,91,82,147,34,97,120,76,57,197,50,253,49,80,89,39,82,163,190,35,189,86,249,90,168,212,81,40,16,88,205,64,188,251,207,78,21,26,202,40,230,130,10,74,118,116,66,160,130,209,26,194,21,104,141,68,163,154,2,162,167,138,104,64,85,217,73,18,187,173,42,21,80,233,172,240,233,116,104,81,153,218,35,3,135,234,189,29,166,77,208,97,196,162,196,57,193,119,151,254,151,77,109,6,77,219,58,159,6,48,245,98,131,13,223,49,48,189,34,217,251,198,62,201,142,88,62,252,33,226,183,223,54,77,62,27,139,94,194,215,12,65,18,40,213,42,245,175,90,245,181,173,122,213,170,214,189,80,239,84,204,134,43,106,82,191,163,66,139,47,89,195,112,124,221,37,78,137,35,73,164,195,132,49,147,102,247,127,192,91,58,12,140,93,248,206,238,247,72,124,155,37,2,142,3,96,65,100,49,217,141,3,168,148,123,84,16,170,104,32,133,66,176,17,69,26,138,146,25,161,104,41,138,128,69,18,128,197,1,98,104,149,153,168,41,34,176,178,86,204,167,137,83,168,16,35,255,0,234,67,14,43,209,138,100,203,40,177,40,206,239,2,33,253,157,188,19,47,117,3,108,17,217,180,136,115,253,90,87,164,240,55,140,22,81,233,0,127,165,22,68,252,31,186,189,36,161,127,241,27,22,150,209,221,176,203,199,205,147,81,160,184,182,44,55,177,253,158,55,79,234,141,157,107,214,192,238,181,171,84,59,173,86,168,188,238,176,23,30,192,77,109,122,76,188,29,157,72,51,204,176,180,124,221,37,183,99,72,190,28,40,35,255,0,201,16,79,228,217,167,220,105,91,71,222,216,76,255,0,146,182,60,9,24,144,226,70,61,226,60,254,205,146,161,81,68,168,244,88,80,245,107,64,43,191,84,187,128,16,168,87,59,38,192,183,162,22,10,53,18,164,135,106,229,87,117,42,133,102,163,98,141,29,187,177,224,67,136,211,136,123,67,191,117,232,205,42,102,54,196,162,76,230,216,97,135,230,217,47,68,163,76,182,133,22,17,57,194,140,255,0,217,196,173,134,242,76,13,161,76,135,216,56,177,224,126,129,9,255,0,47,183,136,210,36,9,254,206,91,93,191,209,218,212,71,254,118,189,159,221,122,76,195,229,143,65,120,210,43,135,238,213,233,99,48,129,71,127,229,140,63,230,75,210,230,97,179,154,125,209,153,253,215,165,224,255,0,242,151,31,116,88,127,249,47,75,135,255,0,72,119,255,0,182,31,254,75,210,239,254,210,126,49,97,255,0,228,189,44,56,236,224,61,241,153,253,215,165,39,24,16,27,249,163,15,248,94,145,153,111,70,161,183,223,17,199,246,106,218,199,250,187,74,140,223,202,28,239,236,159,49,227,109,143,120,100,31,238,229,179,91,47,22,159,74,127,187,117,163,246,43,209,232,127,106,4,88,135,241,197,119,253,178,91,14,0,250,189,153,0,234,246,239,159,155,166,160,65,1,176,160,177,141,25,53,160,15,211,141,113,233,159,255,196,0,23,17,0,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,16,176,49,255,218,0,8,1,2,1,1,63,0,134,30,197,44,47,255,196,0,20,17,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,192,255,218,0,8,1,3,1,1,63,0,16,135,255,217,179,77,97,116,99,97,112,32,82,101,102,108,101,99,116,105,111,110,32,52,73,197,71,33,255,216,255,224,0,16,74,70,73,70,0,1,1,0,0,1,0,1,0,0,255,219,0,132,0,2,2,2,2,2,2,2,2,2,2,3,3,2,3,3,4,3,3,3,3,4,6,4,4,4,4,4,6,9,5,6,5,5,6,5,9,8,9,7,7,7,9,8,14,11,9,9,11,14,16,13,12,13,16,19,17,17,19,24,23,24,31,31,42,1,2,2,2,2,2,2,2,2,2,2,3,3,2,3,3,4,3,3,3,3,4,6,4,4,4,4,4,6,9,5,6,5,5,6,5,9,8,9,7,7,7,9,8,14,11,9,9,11,14,16,13,12,13,16,19,17,17,19,24,23,24,31,31,42,255,194,0,17,8,4,0,4,0,3,1,34,0,2,17,1,3,17,1,255,196,0,48,0,1,1,1,0,2,3,1,1,1,0,0,0,0,0,0,0,0,3,2,7,8,1,5,6,4,9,10,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,218,0,12,3,1,0,2,16,3,16,0,0,0,255,0,63,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,243,179,52,165,137,86,182,39,90,216,149,169,98,118,165,137,90,150,39,106,84,197,107,82,118,165,137,219,119,37,106,88,149,233,82,118,165,137,95,118,39,106,92,149,171,82,86,165,137,218,150,37,125,216,157,169,98,117,173,78,132,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,51,189,212,197,107,82,86,173,73,218,150,39,90,212,157,171,82,118,165,76,86,181,39,90,216,149,169,99,21,165,137,214,150,39,106,88,157,107,82,118,165,137,214,181,39,125,216,157,109,82,86,173,73,218,150,37,125,216,157,169,98,86,173,79,231,168,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,79,26,213,76,86,150,39,90,88,157,169,98,117,173,73,218,150,37,106,92,149,247,114,86,165,137,90,150,39,109,220,149,107,98,87,221,140,86,181,39,106,88,157,105,98,118,165,137,214,182,39,90,212,157,169,98,86,165,137,218,150,37,106,88,157,169,114,85,173,79,231,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13,80,197,105,82,118,165,137,218,150,37,106,88,157,169,98,117,173,73,218,181,39,90,212,157,247,114,85,173,137,90,150,39,106,88,149,171,82,87,221,201,214,181,39,90,216,157,169,82,87,165,76,90,150,37,106,88,157,169,98,117,165,140,86,181,39,106,84,157,247,98,117,173,143,230,96,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,243,179,20,165,73,218,149,49,90,212,157,109,83,21,165,137,90,150,39,106,88,149,171,82,118,165,137,214,181,39,106,88,157,105,99,21,165,137,218,150,39,90,212,149,233,82,118,173,73,219,118,49,106,88,149,107,83,22,165,137,86,181,49,109,220,149,171,83,21,165,137,214,181,39,106,88,157,107,99,249,112,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,163,59,221,137,214,150,39,106,88,149,169,98,118,165,137,214,180,49,109,220,149,169,98,87,221,201,214,182,37,106,88,157,107,82,118,165,137,214,181,39,106,216,149,169,98,118,165,137,90,150,39,90,92,149,169,98,118,165,137,214,181,39,109,220,149,107,98,87,221,201,214,150,39,106,88,149,171,82,118,165,137,218,149,63,148,160,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,228,241,173,84,157,105,98,87,165,137,90,150,37,122,88,149,171,82,118,221,201,214,181,39,109,220,157,107,82,118,165,137,214,182,37,106,88,157,107,82,117,173,137,214,182,37,125,220,149,183,98,119,165,73,218,150,37,125,220,149,169,98,117,173,137,214,181,39,109,216,157,109,82,87,165,137,218,150,35,122,88,157,105,98,87,221,140,86,150,63,146,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,243,83,20,165,137,95,118,39,106,84,197,169,98,86,173,73,219,118,39,106,212,157,169,98,117,173,73,219,118,49,90,212,157,169,98,118,165,137,90,150,39,90,216,149,169,98,117,165,201,90,150,39,106,88,157,169,98,86,173,73,219,119,39,90,212,149,233,98,117,173,73,214,181,39,106,212,149,171,98,87,165,137,90,149,49,90,92,149,169,83,22,221,207,227,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,179,53,213,137,90,181,39,106,88,157,105,98,117,173,73,223,119,37,106,88,149,171,98,117,173,73,218,150,39,109,220,149,169,98,118,165,73,218,150,39,106,84,157,107,98,119,213,201,90,180,49,109,220,149,169,98,118,165,73,223,119,37,106,88,149,233,83,21,165,137,214,181,49,90,88,157,107,83,21,173,73,218,149,49,106,84,157,107,83,22,221,201,90,150,39,109,220,254,52,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,163,59,213,137,86,212,49,109,220,149,171,82,118,165,137,90,150,39,106,88,149,247,98,118,165,137,90,150,49,90,216,141,169,98,118,173,137,86,181,49,109,220,149,107,83,22,165,137,86,181,49,109,220,149,171,82,118,221,201,90,150,39,106,84,157,169,98,118,165,137,90,150,39,106,88,149,169,99,21,165,201,86,181,49,106,88,149,107,83,22,165,137,86,181,39,125,220,157,107,82,87,221,207,226,160,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,117,83,20,173,12,91,119,39,90,212,149,247,114,87,165,73,219,118,39,106,88,197,105,98,86,165,140,86,181,37,106,88,197,183,98,116,181,73,223,119,37,90,212,197,183,98,117,181,9,223,119,37,106,88,149,247,114,117,173,73,95,119,37,106,88,157,169,98,86,165,140,86,182,35,106,88,197,183,114,54,165,137,218,151,37,90,212,157,247,114,85,173,73,218,151,39,74,212,157,247,99,21,165,137,90,150,63,136,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,91,49,74,208,157,169,114,117,173,73,95,119,39,90,212,149,247,99,21,173,73,219,119,37,106,88,157,169,98,117,165,137,218,150,39,90,212,197,183,98,117,173,73,223,119,37,91,84,149,169,114,86,173,73,90,150,49,90,212,149,247,99,21,173,73,90,182,37,106,88,157,169,98,86,165,137,218,150,37,106,212,157,169,98,117,173,73,223,118,39,90,212,157,247,114,116,173,137,90,150,49,90,88,149,169,98,118,173,73,90,150,63,133,160,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,51,186,80,157,169,114,117,173,73,95,118,49,90,212,149,169,99,21,173,73,90,151,39,90,216,149,107,98,86,173,73,218,150,37,106,212,157,169,98,117,173,137,95,119,37,90,212,157,247,98,117,181,73,95,118,49,90,212,149,169,99,21,173,73,90,181,39,106,212,157,107,82,118,165,137,218,150,37,106,212,157,169,98,117,173,73,94,150,39,90,212,157,169,98,117,173,137,90,150,39,106,212,149,169,98,118,173,73,90,150,39,106,212,157,107,83,248,50,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,79,26,221,12,86,150,39,90,216,149,169,99,21,173,73,90,150,49,90,216,141,169,98,119,221,200,218,181,49,109,220,149,107,83,21,173,73,218,150,39,90,212,157,169,98,117,173,137,90,150,39,90,216,149,169,83,53,165,137,90,150,39,122,84,149,169,98,118,165,137,90,150,39,125,220,149,107,83,21,173,73,94,150,37,106,212,157,169,98,117,173,73,218,150,39,91,80,157,169,99,21,165,137,90,150,39,106,88,149,169,98,118,165,137,90,150,39,106,92,141,171,83,248,10,0,0,0,0,0,0,0,0,0,0,0,0,0,30,124,212,157,105,98,118,165,137,90,181,39,106,88,149,169,99,22,221,201,86,181,49,109,220,141,169,98,118,173,137,86,181,39,125,220,149,107,83,21,173,73,218,150,39,90,212,157,169,99,21,165,136,222,150,49,90,88,149,169,98,118,165,137,90,150,49,90,92,141,171,82,118,165,200,218,181,39,125,220,149,169,83,21,173,73,218,150,39,90,212,157,169,98,117,173,136,222,150,49,74,216,149,107,98,118,165,137,90,150,49,109,220,149,105,83,22,165,137,90,181,39,109,216,157,43,83,252,249,128,0,0,0,0,0,0,0,0,0,0,0,60,208,197,55,98,118,165,137,90,150,39,106,88,149,169,98,118,165,137,90,181,39,106,92,149,107,82,119,221,137,214,181,39,125,216,157,107,98,87,221,201,210,182,39,90,212,157,169,98,118,165,73,218,150,39,106,88,149,107,83,22,165,137,90,150,39,106,88,157,107,82,119,221,137,90,181,39,125,216,157,107,82,118,165,137,214,213,39,90,212,149,171,98,118,221,137,94,150,39,106,88,149,169,83,21,173,137,90,150,39,106,88,157,107,82,118,165,137,210,213,39,125,216,149,105,82,118,165,137,214,182,63,206,240,0,0,0,0,0,0,0,0,0,0,26,51,77,212,157,169,98,86,165,137,218,149,49,90,92,149,169,98,86,173,73,218,149,49,106,88,149,169,98,118,221,201,90,181,39,106,88,157,107,98,86,165,137,90,181,39,106,88,149,169,98,119,221,137,214,182,37,106,216,149,169,98,86,165,137,218,149,39,125,220,149,169,98,118,221,201,90,181,39,106,88,149,171,82,117,173,137,90,150,39,106,88,149,169,98,118,165,137,214,181,39,106,212,157,169,98,86,165,137,94,149,39,106,92,149,183,114,118,221,201,90,181,37,90,208,197,105,98,118,165,137,90,150,37,122,88,255,0,57,64,0,0,0,0,0,0,0,0,7,147,199,157,212,197,41,114,86,173,73,218,149,39,106,88,157,183,114,87,165,73,218,150,37,106,92,149,169,98,86,173,73,218,181,37,122,88,157,107,82,118,173,9,218,181,39,106,88,157,107,82,118,173,73,214,181,39,106,212,157,105,99,21,165,137,218,150,37,106,88,157,169,98,117,165,137,214,182,37,122,84,197,107,98,86,165,73,218,150,39,90,212,157,171,82,118,165,137,214,181,39,90,216,149,169,99,21,165,201,86,151,37,106,88,157,169,98,86,165,137,218,149,39,106,80,205,43,82,117,173,76,86,181,37,106,212,157,169,98,117,173,79,243,110,0,0,0,0,0,0,0,0,53,67,21,165,137,90,150,39,106,88,157,107,82,117,173,76,86,150,39,90,212,157,169,98,118,165,73,218,150,39,106,84,157,247,114,86,165,137,218,150,39,90,212,157,169,98,117,165,137,218,150,39,106,88,149,169,98,86,165,140,86,150,37,106,212,157,169,98,117,173,137,90,150,39,106,88,149,169,99,21,173,73,214,181,39,106,88,157,107,82,118,165,137,218,150,39,109,220,149,169,98,86,165,137,218,150,37,91,84,149,247,99,22,165,73,218,150,39,109,216,157,169,83,20,165,137,214,150,39,106,88,149,169,98,118,165,137,90,181,39,106,126,115,244,250,174,53,233,177,252,219,0,0,0,0,0,0,1,231,102,105,171,147,173,44,78,212,177,43,82,196,239,171,146,181,44,78,212,169,138,210,196,237,75,17,190,238,78,212,177,58,210,196,237,75,18,181,44,98,181,169,43,82,196,237,75,19,181,44,78,212,177,42,214,196,237,187,146,181,44,78,181,169,59,82,196,237,75,17,190,238,78,213,169,43,82,196,237,75,18,181,44,78,213,169,43,82,196,239,187,146,181,42,98,212,177,43,82,196,175,187,146,181,44,74,212,177,59,82,196,235,90,147,181,44,78,181,169,59,82,166,43,186,147,181,42,98,212,177,43,82,196,237,75,18,181,106,78,213,217,156,250,14,184,28,235,213,46,173,117,180,229,254,13,245,88,0,0,0,0,0,1,163,59,221,73,214,150,39,106,88,157,107,83,22,221,201,214,150,39,90,92,149,169,98,118,165,76,86,181,39,106,88,149,169,98,118,165,137,90,150,49,90,88,149,171,83,21,173,73,90,181,39,109,220,157,107,83,22,221,201,214,150,39,90,92,149,169,98,118,221,137,218,150,39,106,88,141,233,98,118,165,137,90,150,39,106,88,157,107,83,21,165,137,90,150,39,125,216,149,171,82,119,221,201,86,181,39,125,216,157,107,98,118,221,137,218,150,39,90,216,141,233,82,118,165,12,87,118,49,106,88,149,109,67,22,165,137,86,181,49,109,216,157,99,198,39,33,240,159,89,186,104,118,55,169,191,19,248,11,192,0,0,0,0,0,121,60,121,221,12,82,181,39,106,92,149,107,82,118,165,137,214,182,37,125,216,157,107,98,86,165,201,90,150,39,90,216,149,169,98,118,165,137,90,150,39,106,88,149,169,98,118,165,137,214,181,39,106,88,157,105,98,119,221,137,214,182,37,106,92,149,169,98,86,165,137,218,150,39,90,216,149,169,98,118,165,137,90,181,39,106,88,149,169,99,21,165,137,214,181,39,109,220,157,105,98,118,165,137,214,182,37,106,88,157,107,82,118,165,137,214,182,39,90,216,149,169,98,118,221,73,214,150,39,90,216,149,169,98,118,165,137,214,180,49,106,88,149,181,232,79,121,241,188,33,210,67,180,157,37,225,143,147,61,199,164,240,0,0,0,0,0,3,84,49,77,216,157,169,99,21,173,73,90,150,39,90,216,149,169,98,118,165,137,95,118,39,106,88,149,169,114,86,165,137,218,150,37,106,88,157,169,98,117,165,137,218,151,35,106,88,157,169,99,20,181,73,90,150,39,90,212,157,169,98,118,165,137,90,151,37,106,88,149,169,98,118,165,137,218,150,37,106,88,149,233,98,117,173,73,218,150,37,106,212,157,169,98,117,173,73,218,150,39,90,212,157,169,98,117,173,137,90,150,39,90,216,149,169,98,118,165,137,94,149,37,90,88,157,169,98,117,165,137,94,150,37,90,216,157,169,98,117,164,202,254,47,129,234,33,217,78,151,117,179,135,15,188,227,175,207,224,0,0,0,0,0,15,59,49,186,88,149,169,98,117,173,73,223,119,39,90,88,149,169,98,118,173,73,90,150,39,106,88,157,105,98,118,165,137,90,181,39,106,88,157,169,98,86,173,73,218,150,39,90,212,157,169,98,117,173,73,218,151,39,74,216,157,105,98,117,181,73,90,150,39,106,88,149,169,98,118,165,137,90,150,39,106,88,149,233,98,86,165,137,218,150,39,90,212,157,183,114,117,173,73,218,150,39,90,212,157,169,83,21,173,137,90,150,39,106,88,149,169,98,118,165,137,90,180,49,93,216,157,183,98,118,165,137,218,150,37,106,88,157,169,82,118,174,204,249,245,28,4,115,79,88,58,183,213,179,155,122,247,232,228,107,32,0,0,0,0,3,70,117,186,147,181,44,78,181,177,43,82,196,235,91,18,181,44,78,251,177,43,82,198,43,75,146,173,44,78,251,185,27,82,196,239,187,146,173,106,78,212,185,43,110,196,237,90,147,182,238,74,213,169,59,82,196,235,90,147,181,44,78,212,177,43,82,198,43,75,18,181,44,78,212,177,42,214,196,237,75,146,173,106,78,212,185,43,110,228,171,91,19,190,236,78,180,177,59,82,196,235,90,147,181,44,78,212,177,43,82,196,237,75,18,181,44,78,212,177,43,82,196,237,186,147,173,44,78,212,177,58,210,196,235,106,19,190,238,74,213,169,58,207,224,79,183,226,78,184,116,168,236,191,79,248,243,213,159,171,242,0,0,0,0,0,0,5,43,74,152,173,106,74,251,185,58,214,196,109,90,152,181,44,74,181,177,59,82,196,173,75,19,190,236,74,212,177,138,210,196,171,106,147,190,238,74,181,169,59,82,196,173,91,19,173,106,74,244,169,138,214,196,111,187,24,181,44,74,181,169,139,82,196,171,90,152,190,238,74,180,169,139,82,196,171,106,147,181,44,78,212,169,59,82,196,175,187,146,181,106,74,251,177,138,214,164,173,91,19,173,108,74,180,177,139,82,196,173,74,152,181,44,74,181,169,139,110,196,171,90,24,181,44,78,181,169,59,82,196,173,75,19,181,44,74,219,245,103,180,249,158,30,233,57,218,62,145,112,103,195,31,67,243,120,0,0,0,0,0,0,0,1,237,175,187,146,189,42,74,213,177,59,82,196,173,74,152,181,44,74,181,169,139,82,196,171,106,147,181,44,78,181,169,59,82,196,235,90,147,190,236,78,212,177,43,82,196,175,75,19,173,106,74,212,177,138,214,196,173,74,152,181,44,74,181,169,139,82,196,173,75,19,181,44,78,181,169,59,110,228,235,90,146,253,26,185,59,82,164,237,187,146,181,106,98,181,169,43,86,166,43,90,146,181,44,98,212,177,42,214,166,45,187,146,173,108,78,219,177,58,210,164,237,187,147,165,170,78,219,185,59,82,164,237,187,146,181,6,191,63,198,245,76,236,87,78,58,201,193,103,36,241,87,227,240,0,0,0,0,0,0,0,0,0,125,93,169,83,22,165,137,86,181,49,106,88,149,107,83,22,165,137,210,213,39,106,88,157,107,82,118,221,201,214,181,39,106,88,157,107,82,118,165,140,82,181,39,106,88,149,171,82,118,173,137,86,181,49,109,220,149,107,82,119,221,201,86,213,37,125,220,149,171,82,87,165,137,214,181,39,109,220,157,107,82,87,165,137,214,181,39,106,88,149,171,82,119,165,137,86,181,49,90,88,157,107,83,22,165,73,214,181,39,125,216,157,105,82,118,221,201,214,181,37,106,88,197,107,82,86,165,140,86,180,39,79,93,194,167,45,117,203,171,221,75,57,231,173,95,53,3,120,0,0,0,0,0,0,0,0,0,0,62,254,181,177,59,110,228,171,91,19,181,42,78,181,177,59,82,196,235,90,146,190,238,78,181,169,43,238,228,235,91,17,190,238,78,181,169,59,82,196,237,75,18,181,44,78,181,169,59,210,196,171,90,152,182,236,78,182,169,59,110,228,233,106,146,190,238,78,181,169,43,238,228,237,75,17,181,46,78,181,169,59,110,228,237,75,18,173,108,78,181,177,59,110,196,235,90,147,190,236,78,182,169,43,238,228,233,90,19,182,236,78,182,169,43,238,198,43,90,146,181,44,98,180,177,58,248,248,243,235,56,211,175,93,37,59,61,211,62,47,244,103,239,245,224,0,0,0,0,0,0,0,0,0,0,0,114,157,169,82,119,221,201,86,212,39,106,92,157,107,66,119,221,140,86,181,37,125,220,157,107,98,86,165,137,218,150,35,106,212,197,169,98,85,173,137,218,150,37,91,84,157,169,82,119,221,137,214,213,37,125,216,157,171,82,87,221,137,218,181,37,106,88,197,107,98,54,165,140,90,150,35,106,216,157,169,98,85,173,137,218,150,37,90,212,197,107,82,118,165,201,86,181,39,106,88,157,107,67,21,221,137,218,181,37,125,216,197,107,82,86,165,140,86,182,35,106,126,19,247,122,78,43,233,121,218,14,145,240,7,27,159,83,242,51,0,0,0,0,0,0,0,0,0,0,0,0,0,115,61,109,66,118,165,137,214,182,37,106,88,157,169,98,86,173,76,90,150,35,106,212,197,169,98,85,173,76,90,150,37,90,212,197,169,98,85,173,137,218,150,37,106,212,197,43,98,86,165,137,214,181,39,106,88,157,171,82,86,173,76,90,149,37,106,88,197,183,114,86,165,76,91,119,37,90,212,197,107,98,86,165,73,223,119,39,90,88,157,107,82,118,165,137,214,181,39,93,216,197,105,98,86,165,137,218,181,37,106,88,197,183,98,86,166,134,62,99,172,103,63,245,19,171,253,121,57,91,134,189,118,79,62,0,0,0,0,0,0,0,0,0,0,0,0,0,0,57,242,180,177,58,210,198,43,75,18,181,44,98,181,177,27,82,198,43,90,147,173,106,78,251,185,42,214,164,239,187,146,173,106,78,244,177,58,214,164,237,75,19,173,106,78,213,169,43,82,198,43,90,146,181,44,78,212,177,43,86,166,43,90,146,181,106,78,212,185,42,214,196,175,187,146,173,106,78,244,177,42,218,164,175,187,147,173,44,98,149,169,43,82,166,43,75,18,181,44,98,180,177,43,82,196,237,75,146,173,106,78,191,147,137,142,76,224,94,177,116,240,236,55,86,126,71,241,149,144,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,118,62,212,177,58,210,196,237,75,19,181,44,74,212,177,58,214,196,175,74,147,181,44,74,212,177,59,82,196,235,91,18,181,44,78,212,177,43,82,196,237,75,18,181,44,78,212,177,59,110,198,43,75,19,181,44,74,212,177,43,86,164,237,74,152,181,44,74,212,177,59,110,228,235,90,147,181,44,78,181,177,43,82,196,235,90,147,182,236,78,180,177,43,82,196,237,75,19,173,46,74,181,177,58,210,228,173,231,230,143,162,248,62,6,233,25,218,46,149,113,23,205,158,207,213,120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,218,59,82,196,235,91,18,182,238,78,219,185,43,82,196,175,75,19,173,106,78,212,177,58,214,164,239,187,19,181,42,78,213,169,58,214,164,237,75,19,181,44,78,181,169,59,82,196,173,90,147,181,44,78,212,177,43,82,196,175,75,19,173,44,78,181,177,58,214,164,175,75,19,173,108,74,213,169,58,214,164,237,74,152,165,42,78,212,177,58,214,196,173,75,18,181,44,78,212,185,43,83,243,159,163,214,113,207,78,142,205,116,163,174,156,80,125,167,193,196,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,118,222,181,177,59,110,228,171,91,18,190,236,98,181,169,58,210,196,237,75,19,182,238,78,181,169,59,82,196,237,75,18,181,44,78,212,177,58,210,196,237,75,19,173,106,78,212,169,138,214,196,171,90,147,190,236,78,212,177,58,210,228,173,75,18,190,238,78,180,177,59,82,196,237,75,18,181,42,98,187,177,43,82,196,237,75,19,173,44,78,212,169,59,82,196,235,93,153,122,30,186,156,231,213,78,174,117,156,230,62,8,245,24,60,248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,59,151,106,84,197,105,114,117,165,137,90,150,39,106,88,157,169,82,118,173,73,90,150,49,106,84,157,107,83,22,221,201,90,150,49,90,212,157,105,98,119,213,201,90,150,39,106,88,157,105,98,118,165,136,223,119,39,106,212,157,107,82,118,173,73,90,151,39,90,212,157,105,98,118,221,137,214,149,49,106,88,149,107,98,87,221,201,90,181,39,90,212,157,161,198,199,32,112,183,90,58,102,118,63,169,95,11,235,207,209,249,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,238,253,169,98,117,173,76,90,150,35,122,84,157,169,98,86,173,76,86,181,39,90,212,197,107,82,117,173,73,218,151,37,90,212,197,169,98,117,173,73,219,119,37,106,212,157,169,83,21,173,73,218,150,37,106,212,157,169,98,86,165,140,86,150,37,107,80,197,105,82,116,173,73,218,150,39,106,84,197,169,98,86,165,73,218,150,49,93,250,67,220,252,143,9,244,144,237,39,73,56,91,227,143,119,232,178,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,239,165,105,98,86,165,201,219,118,39,106,84,197,105,114,54,173,76,86,181,49,74,212,197,105,114,86,165,73,218,150,39,90,216,157,183,114,117,173,73,90,151,37,106,88,157,169,98,117,165,201,219,118,39,90,88,157,169,98,117,173,76,86,149,49,74,84,197,105,114,85,173,73,218,150,49,90,84,197,105,114,86,166,13,254,63,134,234,57,217,46,152,117,171,134,15,191,227,111,205,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,160,246,165,137,218,149,39,125,216,157,169,82,119,221,201,86,150,39,106,92,157,107,82,86,165,137,218,150,37,125,220,149,169,98,87,165,73,218,150,39,90,216,149,169,98,118,165,137,95,118,39,106,212,157,107,82,119,221,137,210,149,49,90,92,149,109,82,86,165,137,214,181,39,106,88,157,169,82,123,245,60,14,115,47,89,122,185,213,99,156,58,239,232,36,107,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,253,27,181,44,78,181,177,43,82,196,237,75,18,190,236,78,212,177,43,238,228,235,75,19,173,106,78,213,169,59,110,198,45,187,146,173,44,98,180,177,58,214,164,237,90,147,181,44,78,212,169,59,82,196,235,74,147,182,236,78,212,169,59,238,198,43,75,19,181,42,98,150,169,43,99,225,79,180,226,142,185,116,164,236,199,79,56,231,212,159,175,241,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,75,237,75,19,173,106,78,251,177,59,82,196,173,75,24,173,106,74,244,169,59,238,228,171,90,152,173,108,74,180,177,59,210,196,109,90,147,190,238,74,212,169,59,238,228,173,187,19,181,42,98,187,177,58,214,196,171,91,19,173,106,98,219,177,59,82,196,235,191,90,123,63,155,226,30,148,157,163,233,31,4,124,17,244,95,51,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,253,67,181,44,78,181,169,59,82,196,237,75,18,181,44,98,180,177,43,82,198,43,75,145,181,44,98,219,177,58,214,166,45,187,146,173,106,78,251,185,42,214,164,239,187,18,173,42,98,181,169,59,82,196,235,91,18,173,44,98,213,169,43,83,193,184,124,143,85,206,195,244,239,172,92,14,114,95,19,254,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,85,237,75,19,181,44,74,181,177,59,82,196,173,90,25,173,44,74,181,169,139,238,196,173,90,147,181,46,74,181,169,59,82,196,235,90,147,190,236,78,180,169,43,82,196,173,91,19,173,106,78,181,169,138,214,196,173,74,152,167,224,225,147,149,186,239,213,238,163,156,253,214,95,152,252,198,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,245,174,212,177,59,82,196,171,91,19,181,44,74,182,169,59,82,196,233,106,147,190,236,78,181,169,59,82,196,235,90,147,181,44,78,181,161,58,210,198,43,90,146,181,44,78,181,169,59,86,196,171,90,152,183,143,146,62,163,142,58,253,210,51,180,61,48,226,207,66,126,255,0,92,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,95,237,90,147,181,44,74,181,177,59,82,196,173,90,147,190,236,78,181,169,59,110,228,235,90,147,181,44,78,212,161,58,238,228,237,75,18,181,44,78,212,177,43,82,196,237,90,147,182,255,0,33,250,253,47,24,116,196,237,7,73,58,249,198,135,213,252,116,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,253,147,181,44,78,219,185,58,90,164,237,187,147,173,106,74,244,169,138,214,164,175,75,19,181,42,78,187,169,138,214,196,171,90,152,181,44,74,212,169,139,82,196,171,111,35,31,57,214,115,158,250,149,213,206,186,156,181,194,158,187,7,159,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,253,168,173,106,74,212,177,138,86,196,175,74,152,173,108,74,181,169,139,82,196,109,74,147,181,44,74,181,169,139,82,196,173,74,152,182,238,74,213,161,138,254,94,42,57,39,130,186,199,211,147,177,93,84,248,239,196,90,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,219,202,210,196,237,74,152,173,106,78,219,177,138,214,196,171,74,152,173,44,74,181,169,139,82,196,171,91,19,182,238,74,213,169,43,249,249,227,223,252,55,5,116,136,237,31,74,120,127,229,207,109,233,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,238,125,169,98,118,221,140,86,181,39,106,84,157,119,98,118,165,137,90,181,39,106,88,157,107,82,118,165,201,90,144,47,235,184,247,167,167,102,58,83,215,46,35,62,223,224,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,251,201,90,88,157,107,82,118,213,137,219,119,39,90,88,157,169,98,117,173,73,218,150,39,90,232,241,231,210,117,228,230,254,172,117,115,172,103,51,112,39,166,153,231,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,223,122,210,166,43,187,146,173,168,78,251,177,59,82,196,175,75,18,181,44,78,178,227,163,239,120,111,173,125,46,59,41,212,95,130,245,199,232,252,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,250,10,173,44,78,219,185,43,82,196,173,75,19,181,106,78,187,244,231,183,249,62,24,233,41,218,78,145,240,151,198,30,243,208,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,232,118,212,177,58,214,196,235,91,17,181,112,83,242,124,79,82,142,200,116,207,172,252,38,114,39,24,254,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,232,202,181,169,59,82,166,53,235,56,48,230,14,181,117,115,170,71,58,117,199,231,226,107,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,233,26,185,248,147,236,56,179,174,189,39,59,55,211,158,54,244,199,237,252,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,253,159,233,31,2,113,249,244,159,45,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,196,0,33,16,1,1,0,2,2,3,1,1,1,1,1,0,0,0,0,0,2,1,6,7,4,5,3,80,96,64,17,0,18,176,255,218,0,8,1,1,0,1,2,0,249,104,97,32,130,8,128,136,8,34,8,8,128,130,8,34,2,32,32,152,8,32,136,32,32,130,8,32,130,32,32,130,8,249,79,228,36,16,65,16,16,68,16,64,68,4,16,65,16,16,65,4,64,65,16,16,68,4,17,4,4,16,65,16,16,68,16,65,242,95,200,32,32,136,32,32,136,8,34,2,72,32,130,8,32,130,32,32,136,8,34,2,32,128,130,33,32,130,8,128,130,8,34,2,62,70,24,72,32,136,8,32,130,8,128,130,8,32,136,32,128,130,32,32,130,8,34,2,8,32,130,32,34,8,8,32,130,8,130,2,8,248,248,73,32,130,8,34,2,32,32,130,32,34,2,72,32,130,8,32,146,8,32,130,8,34,2,9,32,136,8,130,2,32,32,130,8,128,136,62,54,72,72,128,130,8,34,2,97,32,130,8,32,130,8,130,2,96,32,130,8,32,130,96,32,136,8,128,130,8,32,130,96,32,130,8,36,130,32,248,200,73,32,136,8,32,130,8,134,2,8,34,2,8,32,136,8,32,130,32,32,130,8,32,130,8,128,8,32,32,130,32,32,130,8,128,130,8,32,143,138,132,130,8,128,136,32,130,2,8,128,130,8,32,130,32,32,130,32,32,130,32,36,130,8,32,130,8,128,136,32,130,2,8,32,130,8,32,130,8,36,143,136,254,64,65,4,17,1,4,16,68,4,16,65,4,16,65,4,16,68,16,16,65,16,16,65,4,64,65,16,17,1,16,17,4,4,17,1,4,16,65,4,17,1,31,13,33,36,16,65,4,17,1,16,16,68,4,64,65,4,17,1,4,65,1,4,64,65,4,17,1,4,65,1,16,17,1,4,17,4,4,16,68,4,17,1,4,16,65,31,11,12,4,16,65,4,16,68,4,16,68,4,18,65,4,17,4,16,64,68,4,17,1,4,145,1,4,16,65,4,145,4,4,16,68,4,16,65,16,17,4,4,16,65,4,124,28,48,16,68,4,16,68,4,65,1,4,16,65,4,16,68,4,65,12,4,16,65,4,64,65,4,16,68,16,145,4,4,17,4,4,16,65,4,16,68,4,65,4,16,145,9,31,3,252,132,130,32,128,130,8,32,130,8,34,2,32,128,130,8,32,130,32,34,8,8,32,130,32,32,136,32,32,130,8,32,130,32,34,2,8,128,130,8,34,2,8,34,2,73,128,143,127,36,48,64,68,48,64,68,4,16,65,4,17,1,16,16,65,16,16,65,4,17,4,4,16,65,4,64,65,16,64,68,4,64,65,4,17,1,4,16,65,4,16,65,4,16,65,4,16,71,190,132,130,8,32,130,8,34,8,8,32,130,8,32,130,8,34,2,8,32,130,8,34,2,8,32,130,8,32,130,8,32,136,8,32,130,8,32,130,8,34,2,8,32,136,32,34,2,8,128,143,121,33,36,16,65,4,66,65,4,64,65,48,16,65,4,64,65,16,144,65,4,65,4,4,16,65,4,16,65,16,16,65,4,64,65,4,16,73,4,64,65,4,64,65,4,65,4,4,16,65,4,17,238,164,34,8,8,34,2,32,32,130,8,128,130,32,130,18,8,130,8,8,128,130,8,32,146,8,130,2,8,32,130,8,32,130,8,128,130,32,130,2,8,128,130,8,128,130,8,34,2,8,34,2,8,131,220,194,68,16,144,68,4,17,1,4,144,68,16,16,68,16,17,4,4,64,65,4,16,68,48,16,68,16,16,73,4,17,1,16,18,68,4,16,68,4,17,4,4,16,68,16,16,65,16,16,65,16,16,68,30,222,24,32,32,136,8,32,130,32,32,130,8,32,130,32,36,130,8,32,136,8,32,136,8,32,136,8,32,136,72,32,130,8,32,130,8,36,130,8,32,130,8,32,130,8,32,130,8,32,136,8,32,136,32,32,143,107,9,48,64,68,36,64,65,4,16,68,16,16,68,16,16,65,16,64,65,16,16,65,4,16,65,16,64,65,4,16,65,4,16,65,4,16,68,16,16,65,16,16,65,16,16,65,4,64,65,4,65,1,16,17,1,4,123,57,33,32,136,32,130,2,8,128,130,8,32,136,8,32,130,32,128,136,32,32,130,32,128,130,32,32,130,32,128,130,32,128,130,32,32,130,32,32,130,32,32,136,32,32,130,8,36,136,8,32,130,32,128,130,32,32,146,61,148,36,16,65,4,65,4,4,16,65,4,64,65,4,64,65,16,16,65,16,17,1,36,193,1,4,65,1,4,64,65,4,64,68,4,192,65,16,64,1,16,192,65,4,17,4,4,64,65,4,65,1,4,16,65,4,64,68,4,123,8,96,32,130,32,32,130,32,32,130,32,32,130,8,34,8,8,34,2,8,32,136,32,32,136,32,32,130,32,32,130,32,32,130,32,32,136,8,34,8,8,32,130,8,32,136,8,32,136,8,32,130,32,32,130,32,128,130,8,128,143,93,33,48,64,65,16,64,65,4,64,65,4,17,1,4,16,65,4,16,65,16,16,65,4,16,65,16,64,65,16,64,65,36,16,65,16,145,1,4,17,1,4,16,65,16,16,65,4,64,65,16,64,68,16,64,65,4,16,65,16,16,65,30,178,72,73,34,8,8,32,136,8,34,2,8,32,136,32,32,130,8,34,2,8,32,130,8,34,2,8,32,136,8,32,136,8,32,130,8,32,130,32,34,2,8,32,130,8,32,136,32,34,8,8,32,136,32,128,136,8,34,8,8,32,136,32,35,213,195,1,4,17,1,4,19,4,16,16,65,4,16,65,4,16,65,4,16,68,4,17,1,4,17,1,4,16,65,4,64,68,4,16,65,16,16,65,16,16,65,4,17,12,4,65,9,4,17,4,4,16,65,4,17,1,4,16,68,16,16,65,16,17,234,97,128,136,32,32,130,32,32,130,32,32,130,8,32,130,32,128,136,32,32,130,8,32,130,32,32,136,32,32,130,32,32,130,8,128,130,32,32,130,8,128,136,32,32,130,8,32,130,32,128,130,33,32,130,8,32,130,32,128,130,32,32,130,8,128,159,79,33,48,64,65,4,16,65,4,16,65,4,16,68,16,64,65,4,64,65,36,16,68,16,16,73,16,64,65,16,16,65,4,16,65,16,64,65,16,17,1,4,65,1,16,16,65,16,16,68,4,64,68,4,16,65,4,64,65,16,65,1,16,65,1,4,193,7,165,146,24,72,32,130,8,130,2,8,128,130,72,32,130,8,34,8,8,32,136,32,128,130,32,32,130,8,128,130,8,130,2,8,128,130,8,34,2,8,32,136,8,32,136,32,32,130,32,32,130,8,130,2,8,130,2,8,128,130,8,34,2,8,130,2,8,34,8,125,36,48,144,65,16,16,65,4,16,68,16,64,65,4,64,65,16,64,65,4,65,1,16,16,65,16,16,65,16,16,65,4,16,65,16,64,65,4,16,65,4,64,65,16,16,68,4,64,68,16,64,65,16,16,65,16,16,65,16,64,65,4,16,65,4,64,65,48,64,71,162,134,18,8,130,2,8,34,2,8,128,130,32,130,2,8,128,130,8,128,130,8,34,2,8,128,130,8,32,130,8,32,130,8,128,130,8,130,2,32,128,128,8,32,130,8,34,2,8,128,130,8,34,8,32,32,130,8,128,130,32,128,130,8,128,130,8,34,18,8,34,15,65,36,48,16,65,16,16,68,4,16,65,16,64,65,4,64,73,4,64,65,4,16,65,4,64,68,4,16,65,16,16,65,4,16,65,16,16,65,16,64,65,4,16,65,4,16,65,4,65,4,4,16,65,16,16,76,4,16,65,16,16,65,16,64,73,4,16,65,48,65,1,4,65,251,225,34,8,8,32,130,8,130,8,8,32,130,8,32,136,32,32,130,32,32,130,72,128,136,8,32,136,72,128,136,8,34,2,8,32,130,8,32,136,32,34,2,8,32,130,8,128,136,8,34,24,8,128,130,8,34,2,32,32,130,32,32,136,33,32,130,8,134,2,32,128,136,8,253,176,193,4,16,18,65,16,16,65,4,16,65,4,64,65,16,16,68,16,18,65,16,64,65,16,16,65,16,16,68,4,16,65,16,16,68,4,64,65,4,16,68,16,64,65,4,64,65,4,17,1,16,144,65,4,16,65,16,16,65,4,64,73,16,16,68,16,66,65,4,65,1,16,64,71,235,144,136,32,36,130,8,32,130,8,34,2,8,132,130,8,32,136,8,34,2,8,32,130,8,32,130,32,128,130,8,32,130,8,130,2,8,132,130,32,34,8,8,34,2,8,32,136,8,128,130,32,32,130,8,32,130,72,34,2,8,128,130,8,36,136,8,34,24,32,128,130,32,32,136,33,131,244,201,9,16,64,65,4,17,4,16,16,65,4,19,1,16,144,65,4,16,65,16,17,1,4,17,9,16,16,68,16,65,4,16,16,68,4,66,65,4,16,65,4,16,65,4,65,1,4,16,65,16,64,65,4,16,68,16,16,68,4,17,1,4,16,65,4,16,76,48,65,1,4,65,1,16,16,68,31,162,24,8,32,136,32,32,136,8,130,2,8,32,130,8,32,130,8,34,8,72,32,136,32,32,146,8,34,2,96,32,130,8,32,130,9,128,130,8,32,130,8,32,146,8,130,8,32,34,2,8,34,2,32,128,130,8,32,130,9,32,130,8,32,146,32,34,18,72,32,136,32,32,130,8,32,136,33,231,247,63,154,24,72,32,130,8,32,136,32,128,130,32,32,130,32,32,136,8,32,130,8,32,130,8,128,136,72,32,130,8,32,130,33,128,152,9,32,130,8,34,8,8,32,130,32,32,130,8,128,152,72,32,130,8,32,136,8,32,152,8,32,130,8,32,146,8,34,18,96,128,130,33,32,130,8,32,130,33,228,243,114,189,147,176,247,199,228,134,24,8,34,8,32,32,130,8,128,130,8,34,2,8,34,2,32,32,130,8,128,130,32,34,8,8,32,130,32,32,130,8,130,2,8,34,2,8,32,130,32,32,136,8,128,130,8,32,136,72,32,136,32,32,130,8,32,136,8,34,2,8,32,130,8,128,136,8,32,130,32,32,136,8,34,2,60,158,92,131,54,216,27,211,51,219,92,254,227,241,73,9,36,64,65,4,17,1,4,64,68,16,16,65,16,17,1,4,16,65,4,64,68,16,17,1,4,64,65,4,17,1,4,65,4,16,64,65,16,16,65,4,16,65,4,64,68,16,16,65,4,64,65,4,16,65,16,64,65,16,16,65,16,16,65,4,17,9,36,64,65,16,17,1,4,16,65,23,253,219,100,153,222,233,206,247,87,111,147,55,248,161,134,2,8,34,2,8,128,130,8,34,8,8,32,130,8,32,130,8,32,130,8,32,136,8,34,2,8,32,130,8,128,130,8,34,8,8,32,136,8,128,130,72,32,130,8,128,136,8,34,2,8,32,130,8,32,130,32,34,8,8,32,130,8,32,130,97,36,130,8,32,130,8,34,2,8,35,249,205,237,115,45,177,176,119,174,67,156,121,121,31,138,24,96,128,130,8,32,130,8,32,146,8,32,152,32,32,130,8,128,130,8,32,130,9,128,136,8,128,130,8,32,130,8,32,136,8,128,130,8,32,130,32,128,130,8,128,130,8,128,136,8,34,2,32,32,130,8,128,130,32,128,136,8,32,130,8,128,136,72,128,130,8,34,2,8,128,146,96,243,242,178,141,137,176,183,198,89,179,57,125,135,226,146,24,8,32,130,8,32,136,8,130,8,32,34,2,8,32,130,8,32,130,8,32,130,8,34,8,8,32,130,8,32,130,8,128,130,32,34,2,96,32,130,72,130,2,8,32,130,8,32,130,8,32,130,8,32,130,8,32,130,32,34,2,8,128,130,8,34,24,8,34,8,8,34,2,9,34,2,31,147,189,204,115,253,229,154,237,238,199,187,75,240,201,12,4,64,65,4,16,65,16,64,68,4,64,65,16,16,68,4,16,65,4,64,68,4,16,65,16,16,65,4,16,65,4,64,68,16,16,65,4,64,68,4,16,65,4,64,65,4,16,65,16,16,65,4,64,65,4,16,68,16,192,65,16,16,68,4,16,68,4,16,76,4,64,68,16,16,65,23,253,218,100,25,198,229,207,119,119,117,149,191,47,226,134,2,8,34,2,32,128,130,32,32,130,32,34,2,9,32,130,8,32,130,32,128,130,8,128,136,8,34,2,8,32,130,32,32,130,8,34,8,9,32,130,32,32,130,32,32,130,8,32,130,8,34,2,8,34,8,8,32,130,32,34,8,8,32,130,32,38,8,8,32,130,8,128,130,8,34,8,121,125,150,97,180,246,22,246,201,51,223,63,43,241,67,12,4,16,65,16,16,68,4,16,65,16,16,65,4,16,65,4,16,68,4,67,4,4,192,68,4,16,65,16,16,68,4,16,65,16,16,65,4,16,68,4,17,4,16,65,4,4,64,65,4,16,65,16,16,65,4,17,1,4,16,73,4,16,65,4,17,12,4,17,1,4,16,68,4,16,65,30,110,70,73,159,236,45,237,151,237,30,103,101,111,225,146,24,8,128,130,72,34,2,32,34,2,8,32,130,8,34,2,8,32,130,8,128,130,8,34,8,8,32,130,8,34,2,32,34,2,8,32,136,8,34,2,8,32,130,8,32,130,8,34,8,8,32,130,8,32,130,8,34,2,8,32,130,8,34,2,8,32,130,72,32,146,8,34,8,8,32,130,19,238,178,204,251,119,231,27,143,179,239,210,252,63,194,96,130,2,32,34,8,8,34,2,8,32,130,8,34,24,8,32,130,8,32,136,8,128,146,8,32,130,96,32,130,8,128,130,8,34,2,8,34,2,8,34,2,8,32,130,32,32,146,8,128,130,96,32,130,8,128,130,97,128,130,8,130,8,8,32,130,96,32,130,8,36,130,8,32,130,32,254,118,61,230,111,184,51,253,227,222,102,30,79,55,226,134,2,8,128,130,32,34,18,8,128,130,8,128,130,8,34,2,8,34,2,8,34,2,32,32,130,8,128,130,32,128,130,8,128,130,8,128,130,8,34,18,8,34,8,8,34,2,32,32,130,8,128,130,32,130,18,8,130,2,32,128,130,8,34,2,8,134,18,8,34,2,32,32,130,8,128,130,121,124,252,183,102,236,45,239,147,236,46,71,51,241,67,12,4,144,68,4,16,68,4,16,68,4,16,65,4,16,65,4,16,68,16,16,65,4,17,1,4,144,65,4,16,65,4,16,65,4,16,65,4,16,65,4,16,68,16,16,68,4,17,1,4,146,68,4,16,68,4,17,4,4,16,65,4,16,68,16,16,68,16,64,65,4,17,4,4,144,68,30,95,62,69,157,108,29,235,152,237,126,119,107,111,226,132,130,32,32,136,8,32,130,32,128,130,8,128,130,8,128,130,8,128,130,8,34,8,8,32,130,32,34,2,32,32,130,32,128,130,8,128,130,8,32,130,8,130,2,8,32,130,8,128,130,8,32,136,8,34,2,72,32,130,8,32,130,8,128,130,8,130,18,8,130,2,8,32,130,8,34,4,187,140,159,60,221,121,214,231,237,178,68,255,0,33,4,16,65,4,65,4,4,17,1,4,19,1,4,16,68,4,18,65,4,16,76,16,16,65,4,16,65,4,65,4,4,193,4,4,17,1,4,17,4,4,19,1,4,18,65,4,16,65,4,17,1,4,17,1,4,17,4,4,17,4,4,16,65,4,19,12,4,16,68,4,16,65,4,17,15,243,159,219,230,155,115,96,111,62,255,0,53,242,249,255,0,49,4,17,4,4,16,65,36,17,4,4,16,65,4,16,68,4,16,68,16,16,68,16,16,65,4,64,68,4,16,68,4,16,68,4,16,68,16,16,68,4,16,68,16,64,68,16,16,68,4,17,4,4,16,65,16,17,4,4,16,68,16,16,68,4,16,65,16,16,68,16,16,65,4,65,201,230,101,91,35,97,111,140,171,100,114,185,223,162,2,8,34,2,8,128,130,8,34,2,72,32,136,8,34,8,8,32,130,8,32,136,8,34,2,8,130,2,32,128,130,8,32,136,8,128,130,8,32,130,8,34,8,32,32,130,8,34,2,32,34,2,8,128,130,8,128,136,8,36,130,8,34,2,8,32,130,8,34,8,8,34,7,229,239,243,77,129,188,243,77,183,207,238,106,253,36,17,4,48,16,65,16,16,65,48,16,65,4,16,65,16,16,65,4,64,65,16,65,1,16,16,65,16,16,65,4,16,65,16,16,73,48,64,65,4,64,65,4,64,65,4,64,65,4,16,68,16,16,68,4,16,65,48,16,65,16,66,65,16,64,65,4,64,65,4,64,69,189,174,69,157,110,140,243,117,247,25,67,242,126,184,8,32,136,8,32,136,8,32,136,8,32,130,32,128,130,32,32,136,72,32,130,8,128,136,32,32,130,8,32,136,8,32,130,8,32,136,32,32,136,32,32,130,32,32,130,72,128,130,8,128,130,8,32,136,8,32,130,32,34,24,96,32,130,8,32,136,8,32,130,63,231,155,218,102,91,95,96,239,92,139,58,243,114,63,105,4,16,65,16,16,65,4,16,65,4,16,68,16,16,65,16,16,65,16,16,65,16,65,4,4,16,65,4,16,65,4,16,65,16,16,68,16,16,65,16,16,73,4,16,65,16,64,65,4,17,1,16,16,65,4,16,68,4,18,65,4,16,68,16,64,65,4,16,71,159,149,148,108,61,133,190,50,221,155,203,236,63,124,4,16,68,16,17,4,4,16,68,4,16,68,4,16,65,16,16,73,4,16,65,4,16,68,4,16,68,4,17,4,4,18,68,16,16,65,4,16,73,16,64,73,16,16,65,4,64,65,4,16,68,4,16,68,4,17,12,4,64,65,16,16,73,16,16,73,4,63,39,121,152,103,251,199,54,220,29,151,120,151,160,128,130,8,34,2,8,34,8,8,34,2,8,32,130,8,38,8,8,32,130,8,2,2,32,130,2,8,32,130,8,130,2,8,128,130,8,32,130,8,34,2,8,34,2,8,34,8,8,130,2,8,32,130,8,34,8,9,130,2,8,32,130,8,34,2,8,254,118,125,246,113,184,243,237,221,221,229,143,203,232,160,32,136,8,32,130,8,130,2,32,34,2,8,130,2,8,32,130,32,34,2,8,38,2,9,32,130,32,32,130,8,130,2,32,128,130,0,32,130,8,128,130,8,130,2,8,38,2,9,32,130,32,128,130,96,134,2,8,128,130,8,32,130,8,34,30,95,99,151,237,45,133,189,242,92,255,0,207,202,244,132,16,65,16,16,65,4,64,65,4,65,1,4,64,65,4,16,65,4,145,1,16,16,65,16,17,1,16,64,65,4,16,65,4,65,1,4,64,65,4,17,1,4,16,65,16,16,65,16,64,65,16,16,68,36,16,65,4,65,1,4,64,65,4,249,185,25,46,123,176,183,182,95,180,185,157,157,190,148,136,8,34,8,8,32,136,8,32,130,8,34,8,32,32,130,8,32,130,8,32,130,32,32,136,8,34,8,8,32,136,8,32,136,8,32,136,32,32,130,8,32,130,32,32,136,32,34,8,8,34,8,33,32,136,8,32,130,32,32,136,96,75,185,202,243,221,221,156,110,78,211,32,79,211,144,68,4,193,4,4,16,65,4,16,68,4,16,68,4,16,76,16,16,68,4,16,68,16,16,68,4,16,68,16,16,65,4,16,76,4,17,4,16,16,68,4,16,76,4,17,1,16,16,68,4,19,4,4,16,65,4,16,68,4,17,252,236,123,188,219,111,231,251,199,189,204,124,190,111,82,68,16,16,65,16,16,68,4,16,65,4,16,68,4,64,65,4,16,65,4,17,4,4,64,68,4,16,65,16,16,68,16,16,65,16,64,65,4,16,65,4,64,65,4,17,1,4,64,68,16,16,65,4,16,68,4,16,65,4,67,202,231,229,155,51,97,239,124,163,98,114,57,190,172,136,32,34,2,8,32,136,32,32,130,8,32,130,32,130,2,8,128,130,8,32,130,32,32,136,32,34,0,8,34,2,8,32,130,72,128,130,32,128,130,9,32,130,8,34,2,32,32,146,72,32,130,32,34,8,8,128,130,124,190,108,135,56,216,59,215,50,219,28,254,218,223,88,68,16,16,76,4,16,68,4,16,65,16,18,68,4,17,4,4,16,68,16,16,68,4,65,4,4,192,68,4,16,65,4,16,65,16,16,68,4,17,4,4,16,68,16,16,68,16,193,4,4,16,68,4,16,65,4,17,111,111,147,103,155,171,59,221,29,182,72,223,174,32,130,8,32,130,32,128,130,32,32,130,8,32,130,8,32,130,8,32,136,8,130,8,8,32,130,8,32,130,8,128,130,33,32,130,8,34,2,8,128,130,8,32,130,8,34,8,73,32,136,32,32,130,8,128,143,231,63,183,204,246,214,192,222,121,6,109,229,243,251,8,8,130,8,8,34,2,8,128,136,32,32,130,32,32,130,8,128,130,8,32,136,32,34,2,8,130,8,8,34,2,9,130,8,8,32,130,8,32,136,8,128,130,8,132,136,32,32,130,8,130,2,8,32,136,57,28,204,171,99,236,45,241,149,108,174,79,63,217,16,65,48,16,65,4,16,68,4,17,1,4,66,65,16,16,68,36,16,65,4,17,4,4,16,65,16,64,65,16,16,65,4,16,65,4,17,1,4,17,4,4,19,12,16,65,1,4,17,1,16,66,68,15,201,223,230,123,3,121,230,187,115,176,238,170,246,112,66,65,4,16,65,4,16,65,4,64,65,16,64,65,4,192,68,4,16,65,4,16,68,16,64,65,4,144,65,16,16,68,4,16,65,4,16,65,4,16,68,36,17,1,4,16,65,4,64,65,4,95,247,105,144,231,59,159,60,221,189,206,82,252,158,212,130,32,34,8,8,32,136,8,130,2,32,34,8,8,32,136,32,32,136,8,128,130,8,34,2,8,128,136,8,32,136,8,128,130,32,34,2,8,128,136,33,32,130,32,128,136,32,128,130,8,135,155,218,102,59,87,96,239,108,143,59,243,114,125,185,4,16,65,16,17,1,16,16,65,4,64,65,16,17,1,4,64,65,4,17,1,4,65,4,16,64,65,16,17,1,4,16,65,4,64,68,16,65,1,36,16,65,4,64,65,16,16,68,16,121,249,57,54,193,216,91,223,45,217,252,190,199,220,193,1,16,16,68,4,65,1,4,16,68,4,64,65,16,16,65,16,16,73,4,16,65,16,64,65,4,16,65,4,16,65,4,16,65,4,16,65,48,144,65,16,16,65,4,16,68,4,55,222,101,217,254,240,205,247,15,103,223,37,238,136,32,130,8,128,130,8,130,2,8,34,2,32,34,2,8,32,130,8,32,130,8,32,130,32,128,130,8,34,2,8,32,130,8,34,2,33,32,136,8,128,130,8,36,130,8,35,249,217,119,217,198,227,207,247,127,119,150,249,60,190,240,136,8,32,136,32,32,136,8,128,130,32,128,130,8,32,130,8,128,130,32,34,2,32,32,130,8,32,136,32,32,130,8,32,136,33,132,130,8,32,130,8,32,136,8,34,30,95,97,150,237,13,133,189,242,93,129,200,229,251,226,32,32,130,32,32,136,8,128,130,8,34,2,8,32,130,8,130,2,8,34,8,32,32,130,32,32,130,8,34,2,32,32,130,32,130,2,8,32,130,8,34,2,8,35,205,231,200,243,205,131,189,179,13,169,205,237,45,247,228,64,65,16,65,1,4,64,65,4,16,68,4,64,68,16,64,68,4,16,68,16,18,65,4,16,65,4,65,1,4,16,68,48,16,68,4,64,68,4,16,68,4,37,220,229,57,238,237,206,183,47,105,144,167,240,36,16,65,16,64,65,16,65,1,4,16,68,4,17,1,4,16,68,4,16,65,4,16,65,4,17,1,16,193,1,48,17,1,4,16,68,4,16,65,4,64,71,243,176,238,115,93,189,176,55,151,125,153,121,124,223,6,65,4,16,65,4,16,65,16,16,76,4,64,68,4,67,4,4,17,1,4,64,65,4,16,65,4,18,65,4,16,73,4,16,65,4,65,1,4,64,68,28,158,110,87,178,246,22,247,202,54,47,39,155,240,164,16,65,4,16,68,16,17,1,16,64,68,4,17,1,16,16,65,16,192,65,4,16,65,4,17,4,4,146,65,4,17,4,4,16,65,4,16,68,30,79,46,67,155,236,13,235,153,237,158,127,111,111,195,16,68,4,16,65,16,16,68,4,66,65,16,16,65,16,16,65,4,64,65,4,64,65,4,64,68,4,17,1,4,16,65,16,16,68,4,16,69,189,190,75,157,238,172,239,116,246,249,51,127,16,73,16,65,8,4,16,65,4,64,65,4,64,65,4,64,65,4,16,65,4,65,12,4,64,65,16,194,73,4,16,65,4,64,65,16,65,15,59,182,204,182,206,192,222,153,14,111,229,228,124,81,4,17,1,16,64,65,4,65,4,4,16,68,4,16,65,4,16,68,4,16,65,16,17,1,16,192,65,4,64,65,4,17,4,4,67,200,229,229,27,23,97,111,124,175,101,242,185,255,0,24,65,16,16,65,16,65,1,4,65,1,4,192,65,4,16,65,4,16,65,4,19,4,4,67,1,4,18,65,36,66,65,4,65,3,242,119,217,150,192,222,89,174,222,236,123,186,190,52,130,8,34,2,8,34,2,8,130,2,8,32,130,72,34,2,8,128,136,32,34,8,9,34,2,8,130,2,8,32,130,8,191,238,211,32,206,183,46,123,187,123,172,169,249,62,62,2,8,130,2,32,130,2,8,34,2,8,32,130,8,34,2,8,32,136,8,36,130,8,34,2,8,32,130,96,128,136,121,157,158,97,181,54,14,246,200,243,207,63,43,228,96,32,130,72,32,130,32,32,130,96,32,130,32,32,130,8,32,130,8,130,18,8,128,130,32,32,136,32,32,136,60,220,156,151,96,108,45,239,151,109,30,103,101,111,201,64,65,4,64,65,16,64,65,4,64,65,4,17,1,4,17,1,4,195,1,4,17,1,4,16,65,4,65,2,125,222,91,159,110,252,223,113,118,125,250,95,40,65,4,16,68,4,17,4,4,17,1,4,145,4,4,16,68,16,18,68,4,16,68,16,16,65,4,17,252,236,123,204,223,113,103,219,195,188,203,252,158,95,150,128,130,8,130,2,32,128,130,8,128,130,8,128,136,9,134,24,9,32,130,9,32,136,32,32,136,121,92,252,183,103,236,45,239,147,108,46,71,47,230,32,32,130,8,128,130,8,130,2,8,128,130,8,32,146,72,128,130,8,130,2,8,130,2,96,242,249,242,44,239,96,239,108,195,106,243,123,91,126,100,130,8,32,130,8,32,136,32,34,8,8,32,136,97,32,136,32,32,136,32,32,136,32,87,185,202,51,205,217,157,110,110,215,35,79,230,200,130,2,32,128,130,8,128,130,8,130,2,33,32,130,8,130,2,8,34,2,8,254,115,251,156,215,110,236,13,231,223,230,126,79,63,206,144,65,4,65,1,4,17,1,4,17,4,4,17,4,4,17,1,4,16,68,16,242,121,185,86,201,216,91,223,41,216,252,158,119,207,144,68,4,65,4,16,16,65,4,66,65,4,16,68,16,17,4,4,16,71,147,203,223,230,187,3,122,102,123,107,159,220,91,244,4,65,1,4,17,1,4,65,12,36,16,65,4,17,4,4,145,1,22,246,217,30,119,186,115,189,213,219,228,239,201,244,68,65,1,16,16,65,16,195,4,4,18,65,4,16,65,16,17,15,59,182,204,182,198,193,222,185,14,115,230,228,125,36,16,64,65,16,65,9,4,17,1,4,64,65,4,16,68,30,126,94,79,177,54,22,247,202,246,103,47,176,183,233,72,32,130,8,38,2,8,34,8,8,32,146,8,128,134,251,220,199,63,222,57,182,223,236,123,202,190,158,2,32,130,18,8,128,130,32,32,130,8,128,139,254,236,251,252,231,114,103,187,187,186,202,223,151,234,72,32,130,8,32,130,8,34,2,8,34,8,121,157,150,95,180,246,22,246,201,51,239,63,43,234,225,128,152,8,32,130,8,32,130,8,35,205,200,201,51,253,133,189,242,253,163,204,236,237,250,194,32,128,130,32,32,130,8,32,132,187,172,175,62,221,217,190,228,236,251,244,190,184,130,8,32,136,8,32,130,63,157,143,119,155,110,28,255,0,120,119,185,135,147,205,246,4,64,65,4,16,65,4,242,185,249,102,205,216,59,223,39,216,124,142,103,217,17,1,4,17,4,30,95,62,69,157,108,29,235,152,237,110,119,109,111,217,145,1,4,16,151,113,147,231,155,175,58,220,253,182,70,159,218,145,1,31,206,127,113,154,109,205,129,188,242,12,215,203,231,251,114,33,228,115,114,173,145,176,183,198,87,178,57,92,239,185,126,94,255,0,52,216,27,207,51,219,125,135,115,87,221,103,91,163,60,221,125,198,80,252,159,121,145,103,94,110,79,254,15,223,255,196,0,45,16,0,1,2,5,2,7,1,0,2,3,1,1,1,0,0,0,1,2,3,0,4,5,17,97,49,64,16,32,33,48,80,81,96,65,18,36,19,35,145,51,112,176,255,218,0,8,1,1,0,3,63,0,251,108,125,86,155,189,62,143,29,220,115,227,151,175,209,219,134,145,215,117,167,62,159,37,142,29,57,122,246,49,177,199,119,31,39,110,206,56,105,26,108,49,223,210,52,249,204,115,117,239,99,236,177,222,198,195,31,29,141,158,157,155,198,56,105,24,230,233,195,17,143,157,199,127,78,109,58,115,233,244,248,229,199,29,54,90,115,227,144,124,142,57,116,219,105,207,211,79,150,61,220,70,156,78,195,78,231,78,214,62,28,238,52,239,14,24,231,233,241,247,231,199,115,27,109,56,29,142,159,11,142,24,225,142,76,108,177,219,191,116,243,99,225,14,195,27,225,242,125,57,122,118,49,219,199,127,28,116,238,233,241,120,240,24,216,233,223,199,193,227,155,29,156,112,211,151,78,214,57,177,241,164,236,177,194,252,250,109,49,184,211,206,232,54,24,217,99,125,167,28,121,204,109,116,217,99,101,142,246,60,206,57,177,231,53,230,199,142,191,143,211,99,208,124,31,94,7,255,0,131,105,195,78,26,112,27,205,15,128,199,142,191,119,175,127,27,44,119,113,218,211,179,142,115,24,241,23,222,227,192,227,177,142,206,62,39,77,150,158,51,79,17,126,26,109,180,240,26,109,49,218,199,12,120,140,120,252,115,227,115,167,28,121,44,118,49,179,199,46,57,177,217,199,28,111,113,231,52,238,105,201,136,199,46,156,186,114,233,187,61,211,26,120,11,246,186,243,255,0,222,78,156,52,227,167,62,60,6,56,99,148,240,199,54,54,56,222,158,56,221,233,219,211,99,164,99,179,215,113,143,47,211,78,76,119,244,216,227,193,227,147,28,218,66,82,58,196,164,131,101,78,58,145,111,103,193,14,198,35,27,45,56,14,230,57,143,111,72,211,97,142,92,118,237,12,74,161,74,90,192,176,138,117,37,167,127,176,144,64,247,4,255,0,157,185,121,159,122,29,191,231,130,199,99,28,154,113,211,151,30,19,78,198,56,180,202,73,90,132,72,82,154,89,83,233,4,15,112,204,186,94,67,19,34,253,116,49,63,84,117,212,162,97,86,36,254,196,212,235,138,82,220,81,191,129,211,125,142,56,242,184,226,148,11,168,196,149,53,181,41,111,36,91,49,39,79,67,200,106,97,63,200,102,39,42,11,121,12,204,155,117,208,196,237,73,197,169,110,168,223,48,165,155,168,237,116,219,105,24,228,198,243,29,140,119,244,142,156,184,216,1,172,74,201,33,74,113,196,139,69,62,148,211,169,76,194,110,1,253,135,166,20,243,114,243,6,216,49,80,170,186,225,83,234,32,230,29,121,69,75,81,218,116,240,29,56,227,151,78,93,35,78,125,56,99,191,167,127,78,157,195,202,196,178,74,150,176,0,138,125,37,167,63,176,128,64,247,1,33,230,229,230,127,225,138,141,89,215,127,222,171,18,127,97,249,165,21,45,100,222,47,180,235,190,211,181,164,98,15,103,29,206,188,184,230,211,134,155,150,218,77,214,161,18,20,166,150,165,60,144,64,247,18,242,137,121,182,38,69,250,232,98,126,166,227,169,68,202,172,73,253,137,185,229,169,75,113,70,254,204,21,117,39,100,79,54,135,123,167,31,216,211,111,143,17,136,74,58,152,147,167,182,181,184,234,69,179,18,84,212,60,134,230,19,113,152,154,158,91,200,102,96,216,220,116,49,61,83,117,106,91,202,32,230,22,226,138,148,122,248,124,114,105,220,211,134,56,105,189,211,192,129,212,196,180,146,20,167,28,2,41,244,150,157,2,97,55,25,135,30,47,53,47,51,239,67,21,10,171,171,37,245,16,79,184,117,245,21,45,68,223,199,227,142,55,195,134,60,67,50,233,42,90,128,2,41,212,150,156,37,244,130,1,253,132,54,31,110,94,103,222,134,42,21,87,93,2,97,86,36,254,196,196,218,202,156,112,152,39,93,145,230,211,142,56,105,216,210,49,199,28,248,237,226,49,216,235,220,199,111,17,142,254,59,154,112,67,66,234,34,36,41,141,44,173,228,130,7,184,149,146,67,232,98,96,92,102,39,170,78,60,150,230,21,99,125,12,78,84,28,82,156,117,70,254,204,41,70,234,59,110,156,250,118,113,205,142,76,118,52,228,61,172,119,177,225,66,65,42,49,39,32,218,148,227,169,22,204,72,211,27,117,40,152,77,198,98,102,113,111,54,196,201,253,208,196,253,77,213,169,111,40,133,102,22,234,138,148,162,119,253,119,186,111,177,191,255,0,145,47,40,130,167,22,5,132,83,169,45,59,253,132,133,1,238,22,191,243,55,47,51,239,67,21,10,179,174,18,250,136,39,220,61,48,162,165,172,155,239,52,238,13,150,54,125,57,122,118,49,207,211,114,211,9,42,90,128,138,125,37,167,10,159,72,32,123,134,152,15,55,47,50,63,71,67,21,10,171,174,132,204,42,196,159,216,153,157,89,83,142,40,222,9,215,111,142,108,118,58,70,60,86,60,74,27,23,81,176,137,26,99,107,43,117,32,140,196,164,130,30,67,51,41,191,93,12,78,84,92,121,13,76,170,198,250,24,157,168,184,165,56,234,141,207,184,82,205,212,119,218,109,241,26,111,241,205,142,206,56,227,187,211,148,13,116,137,73,22,212,167,28,72,176,247,18,20,166,221,8,153,77,192,63,176,252,202,158,109,137,147,110,186,24,159,170,58,178,183,212,65,62,225,199,84,84,181,19,188,199,130,211,134,56,233,195,77,142,57,177,190,98,85,37,78,44,11,123,138,117,37,167,127,176,144,160,61,199,254,205,75,76,251,208,197,66,172,235,159,216,81,4,251,135,166,84,84,181,147,228,52,228,211,151,77,190,131,97,141,211,76,164,169,106,2,41,244,166,214,165,62,145,97,238,24,150,75,205,177,50,46,61,24,159,170,58,234,81,50,171,27,254,196,212,242,212,167,28,38,249,130,117,62,99,30,51,164,105,219,199,62,56,37,2,234,49,37,77,105,74,91,169,22,235,172,73,83,208,242,26,153,77,197,244,49,55,62,183,144,212,201,177,244,98,118,162,226,138,222,81,7,48,181,146,84,124,214,59,24,141,56,233,195,27,12,112,198,252,1,18,178,72,82,156,88,22,138,125,41,167,82,137,132,220,15,112,235,229,230,216,153,63,186,24,159,170,184,178,167,212,65,62,225,215,148,84,181,19,240,152,242,204,203,36,169,107,2,209,79,164,180,231,246,18,8,30,225,41,15,53,47,51,236,116,49,81,170,184,237,159,85,137,63,176,252,210,212,167,22,77,207,133,199,107,77,206,55,184,218,161,160,74,200,2,36,41,109,173,75,121,32,129,238,37,229,18,243,108,204,11,245,29,12,79,212,220,117,40,153,85,142,98,110,125,197,169,199,84,111,152,42,55,39,193,99,177,141,134,158,3,78,65,187,74,69,212,98,78,158,133,41,110,164,88,68,141,53,14,161,169,132,220,3,161,137,169,213,188,134,102,85,99,125,12,79,84,221,89,91,202,32,230,22,225,37,74,39,195,233,202,35,28,221,54,120,141,60,79,78,200,26,196,180,154,10,156,88,22,138,125,37,167,64,152,77,192,63,176,183,75,205,177,51,255,0,12,84,42,206,184,75,234,32,159,112,235,234,42,90,137,248,92,118,49,224,49,221,102,93,37,75,80,17,79,164,180,229,223,72,32,123,132,52,31,110,94,103,254,24,168,85,93,116,38,97,86,36,254,196,196,218,212,167,28,38,240,78,190,99,28,154,108,177,225,199,34,27,77,212,64,17,33,76,109,101,111,36,88,123,137,89,36,62,134,102,69,250,232,98,122,164,183,82,220,202,172,73,208,196,229,65,197,41,199,84,111,152,82,137,42,62,51,72,211,109,142,214,155,60,113,211,108,18,46,76,74,72,33,74,91,137,22,17,33,75,109,212,183,48,155,139,232,98,98,109,79,33,137,147,110,186,24,159,170,58,178,183,212,65,62,225,110,155,169,68,252,182,60,31,184,151,148,65,83,139,2,217,138,117,37,167,127,222,144,70,96,171,252,205,203,204,251,208,197,66,172,235,151,125,68,28,195,211,10,42,90,201,191,147,198,195,27,12,118,49,179,233,203,142,56,228,105,132,149,45,64,8,167,210,90,89,83,233,4,15,112,211,1,230,165,230,125,232,98,161,85,117,208,153,133,88,223,246,38,167,86,165,56,225,55,204,19,169,242,127,145,167,111,78,230,135,101,167,13,54,248,226,148,11,168,196,141,53,181,169,111,36,16,61,196,156,130,30,67,51,41,184,7,67,19,149,21,188,134,166,85,99,125,12,78,212,92,82,150,242,141,207,184,82,205,212,124,222,56,233,221,211,105,211,134,156,116,231,211,179,142,29,120,129,169,137,73,22,212,167,92,2,222,204,72,82,219,117,40,152,79,242,0,254,195,243,42,121,182,38,77,186,232,98,126,170,234,202,159,81,7,48,227,202,42,90,137,243,61,59,154,70,56,227,147,29,206,131,187,142,201,236,99,133,132,49,42,146,167,22,4,83,169,45,185,254,244,130,7,184,232,243,114,243,62,244,49,80,171,58,231,251,213,99,152,126,105,69,78,44,155,249,109,59,61,57,49,219,198,199,28,152,224,109,181,109,148,146,181,8,167,210,154,90,150,242,65,25,134,37,82,242,24,153,23,193,137,250,163,142,165,19,42,177,191,236,77,79,45,74,113,197,27,230,9,212,249,236,112,199,123,27,12,108,116,227,215,157,40,23,87,72,146,167,54,181,56,234,69,135,184,146,167,33,228,53,50,155,128,127,98,110,125,110,161,153,147,99,125,12,79,84,156,90,150,234,136,57,133,44,221,71,227,63,56,99,191,167,122,221,224,58,152,149,146,65,83,142,1,104,167,210,91,116,38,97,33,67,48,235,229,230,165,230,125,232,98,161,85,117,194,167,212,65,204,58,242,138,150,162,124,198,156,216,216,245,236,233,176,211,98,33,153,116,149,173,96,90,41,212,150,151,119,210,8,30,225,8,15,55,47,51,239,67,21,10,171,174,218,97,68,28,196,196,218,202,150,178,111,243,90,120,4,52,159,228,163,107,68,133,45,181,169,111,36,17,152,150,147,67,205,177,50,63,70,177,61,83,113,212,162,101,86,57,137,185,247,20,167,28,81,190,97,74,212,252,54,158,77,41,23,61,34,78,156,218,148,227,169,22,137,26,99,78,165,185,132,220,3,161,137,153,197,60,219,19,38,199,209,137,234,155,171,46,60,162,9,247,11,116,221,106,39,225,122,243,245,228,199,12,120,49,200,4,75,73,161,74,113,96,69,58,146,211,160,76,36,40,102,22,225,125,169,121,159,99,161,138,133,85,215,9,125,68,18,127,97,233,133,21,45,100,252,56,238,233,199,30,13,166,18,84,181,0,34,159,73,105,101,79,164,16,15,236,52,200,121,185,121,159,122,24,168,85,92,116,38,97,86,57,137,153,197,169,75,112,155,197,254,31,28,216,216,244,211,97,211,151,173,185,144,216,37,74,137,26,99,107,82,222,72,41,17,43,34,135,155,102,96,92,95,67,19,181,21,186,150,230,21,99,152,156,168,56,165,45,213,27,230,20,179,117,31,169,199,115,175,28,66,82,46,98,82,65,5,78,58,145,104,144,165,180,234,81,48,155,140,196,196,218,158,67,19,62,244,49,63,84,113,101,111,40,130,125,194,221,55,82,137,249,60,109,113,177,2,37,229,80,84,181,129,108,197,58,146,211,191,216,72,41,7,246,9,255,0,51,114,243,62,244,49,80,171,58,231,251,212,65,204,63,50,162,165,172,155,252,70,35,29,205,59,56,230,199,38,54,77,48,146,165,168,0,34,159,74,105,106,91,233,4,102,25,151,75,205,203,204,123,29,12,84,42,142,58,19,48,171,28,196,212,234,212,167,28,36,152,36,220,252,183,95,6,148,11,168,196,141,53,165,169,199,146,45,152,147,167,161,228,53,48,155,139,232,98,114,160,183,80,204,193,183,95,216,157,169,56,181,45,229,27,159,112,165,155,168,253,142,59,0,11,157,34,86,69,10,83,142,36,91,49,79,165,180,234,81,48,155,128,127,97,233,130,243,76,76,159,221,12,79,213,92,89,83,234,32,159,112,227,202,37,106,39,234,49,178,98,89,5,75,90,68,83,169,44,185,254,244,130,7,184,9,15,55,47,49,255,0,12,84,42,206,187,253,133,88,147,251,15,205,44,169,107,38,47,242,26,114,233,199,30,5,182,146,84,181,1,18,20,182,150,86,250,65,3,220,49,42,151,219,98,100,95,174,134,39,234,142,186,17,50,175,226,115,19,115,203,82,156,113,70,10,186,147,246,248,224,148,11,147,18,84,230,212,165,186,145,97,238,36,169,200,121,13,76,166,227,49,53,60,183,144,204,201,177,204,79,84,156,90,150,242,136,38,22,225,186,143,209,117,143,124,154,108,128,29,98,86,77,5,75,112,11,69,62,146,211,160,76,38,227,48,235,197,246,152,153,233,215,67,21,10,171,171,42,125,68,28,195,175,168,169,106,39,231,180,227,142,56,228,196,99,98,204,186,74,150,176,34,159,73,105,203,190,144,70,97,13,135,154,150,153,246,58,24,168,85,93,118,211,10,41,57,137,137,181,169,75,89,55,49,127,152,235,183,199,105,13,11,169,86,137,10,91,107,43,121,34,195,220,75,73,161,228,49,50,46,51,19,213,39,29,74,38,21,99,152,156,159,90,148,183,84,110,97,74,55,39,238,82,145,117,68,157,61,181,41,199,82,44,34,70,152,219,201,110,97,55,0,254,196,204,226,222,67,51,38,221,71,67,19,245,55,22,165,188,162,9,247,11,116,146,179,244,221,70,203,16,4,75,202,33,74,113,96,69,62,146,219,182,152,72,32,31,216,82,203,237,203,204,251,208,197,66,172,235,151,125,68,19,238,30,152,81,82,214,79,217,99,134,156,205,48,146,165,168,8,167,210,90,93,223,72,35,48,211,1,230,165,230,61,142,134,42,21,87,29,9,152,85,142,98,102,113,106,83,142,19,120,39,95,158,211,177,164,99,100,134,193,42,32,8,145,166,52,165,45,228,130,51,18,146,8,121,12,204,166,253,116,49,59,81,91,200,106,101,86,55,208,196,237,65,197,169,199,84,111,10,89,37,71,238,66,71,83,18,146,8,82,156,113,34,194,36,41,109,186,148,76,39,249,12,195,243,74,125,182,38,77,176,98,126,168,234,202,159,81,7,48,227,170,42,90,137,251,13,59,32,107,164,49,42,133,41,197,129,104,167,82,90,115,251,9,4,15,112,79,249,155,151,153,247,161,138,141,89,215,63,222,171,28,195,211,43,42,90,201,250,77,35,77,134,57,90,101,37,75,80,17,79,165,52,178,183,210,8,30,225,137,100,188,219,19,35,247,67,19,245,87,29,9,152,85,142,98,106,117,197,41,199,9,188,19,175,220,165,0,149,24,146,166,182,181,45,212,139,15,113,39,79,67,200,106,101,55,30,140,78,79,173,228,53,50,108,125,24,157,169,56,181,56,242,141,243,11,89,186,149,245,88,230,199,99,16,6,177,43,36,130,167,22,5,162,159,74,105,208,153,132,220,3,251,15,62,167,155,98,100,219,174,134,39,234,174,172,169,245,16,79,184,117,229,21,45,68,253,150,157,134,37,146,84,226,192,180,83,169,45,57,253,132,130,51,1,33,230,165,230,125,232,98,163,86,117,223,236,42,196,159,216,126,105,101,75,89,48,79,220,161,160,74,212,0,17,79,165,180,178,183,146,8,7,246,37,229,82,242,24,153,23,235,161,137,250,155,175,37,19,10,177,204,77,207,184,181,56,234,141,243,5,70,228,253,202,82,46,76,73,211,218,82,150,234,69,179,18,84,228,58,134,230,19,112,14,134,38,231,86,242,25,152,54,36,232,98,122,166,226,202,222,81,185,247,11,112,146,165,125,110,157,192,58,152,150,147,66,148,226,192,176,138,125,37,167,64,152,77,198,97,199,75,205,203,204,251,26,197,66,170,235,133,79,168,133,31,112,235,234,42,90,201,251,108,114,50,194,74,150,176,34,157,73,105,194,95,72,32,123,132,54,30,110,94,103,254,24,168,213,93,116,7,212,82,115,19,51,107,82,156,89,55,130,117,250,220,115,105,204,134,197,212,109,18,52,198,150,165,188,144,64,247,18,178,72,121,12,204,143,229,212,107,19,213,37,188,150,230,85,98,79,236,78,84,28,82,150,234,141,225,74,55,81,251,148,166,228,196,156,131,106,83,142,164,91,49,35,76,109,212,162,97,55,0,232,98,102,113,111,33,153,147,110,186,24,159,170,58,178,183,148,65,204,45,194,74,148,126,231,220,75,202,32,169,199,0,138,125,37,167,64,152,77,192,63,176,165,151,155,151,153,246,58,24,168,85,93,114,239,168,131,152,122,97,69,75,89,55,251,166,153,79,242,90,128,2,41,244,166,156,42,125,32,129,238,26,97,47,55,47,51,215,174,134,42,21,87,93,9,152,85,137,247,19,51,139,82,150,226,141,243,4,234,126,211,28,152,132,160,18,162,0,137,26,107,107,82,222,72,32,68,164,130,30,67,51,41,184,184,232,98,114,162,183,144,212,202,172,111,161,137,218,139,139,82,222,81,188,41,100,149,31,185,9,234,98,82,69,10,83,142,36,90,36,41,109,58,17,48,155,140,195,243,42,121,182,38,77,186,232,168,159,170,58,181,45,245,16,172,195,142,168,169,106,39,238,64,134,37,82,84,181,129,108,197,62,146,211,159,216,77,198,99,255,0,102,229,230,125,232,98,161,86,117,207,236,42,199,48,252,202,138,150,178,126,233,182,83,252,150,160,4,83,233,77,44,169,228,130,51,12,75,37,246,216,153,23,23,208,196,253,81,199,82,137,133,88,223,246,38,167,150,165,56,226,141,224,171,169,63,119,39,78,67,200,106,100,92,102,39,39,214,242,25,153,54,36,232,98,122,164,226,212,183,148,65,204,45,100,149,43,239,106,21,87,86,84,250,136,39,220,58,250,138,150,162,79,223,223,255,0,192,3,255,196,0,20,17,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,192,255,218,0,8,1,2,1,1,63,0,0,7,255,196,0,20,17,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,192,255,218,0,8,1,3,1,1,63,0,0,7,255,217,182,77,97,116,99,97,112,32,82,101,102,108,101,99,116,105,111,110,32,76,105,110,101,73,197,162,112,255,216,255,224,0,16,74,70,73,70,0,1,1,0,0,1,0,1,0,0,255,219,0,132,0,2,2,2,2,2,2,2,2,2,2,3,3,2,3,3,4,3,3,3,3,4,6,4,4,4,4,4,6,9,5,6,5,5,6,5,9,8,9,7,7,7,9,8,14,11,9,9,11,14,16,13,12,13,16,19,17,17,19,24,23,24,31,31,42,1,2,2,2,2,2,2,2,2,2,2,3,3,2,3,3,4,3,3,3,3,4,6,4,4,4,4,4,6,9,5,6,5,5,6,5,9,8,9,7,7,7,9,8,14,11,9,9,11,14,16,13,12,13,16,19,17,17,19,24,23,24,31,31,42,255,194,0,17,8,4,0,4,0,3,1,34,0,2,17,1,3,17,1,255,196,0,48,0,1,0,1,4,3,1,1,0,0,0,0,0,0,0,0,0,0,5,3,4,6,7,1,2,8,9,10,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,218,0,12,3,1,0,2,16,3,16,0,0,0,252,255,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,14,121,58,187,114,117,231,189,193,107,218,94,88,197,238,179,188,132,214,114,187,183,99,158,99,154,245,198,76,120,247,53,245,20,89,169,114,89,92,120,201,47,53,132,17,187,250,121,234,48,244,149,31,50,219,30,161,171,229,94,79,87,60,171,88,245,21,15,54,93,155,246,59,80,200,153,164,2,92,215,248,111,163,103,79,12,96,223,80,36,79,149,79,164,218,244,240,219,210,122,112,195,184,236,58,59,240,117,115,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,228,227,158,121,58,243,207,115,167,107,201,114,10,255,0,46,202,76,7,33,221,121,249,231,237,157,179,241,226,71,41,211,120,193,232,156,107,207,16,7,160,177,205,13,22,110,200,13,69,106,108,216,156,11,161,152,217,226,227,32,163,12,37,250,197,242,73,243,24,37,123,68,246,38,106,193,114,100,119,56,183,99,50,190,192,234,155,34,87,84,92,27,162,127,65,223,30,145,201,252,179,48,122,231,46,241,190,74,122,51,82,82,204,79,49,232,255,0,168,51,167,201,87,208,207,59,30,123,235,121,108,116,118,224,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,147,142,121,228,227,149,66,157,91,233,226,2,111,42,216,198,180,207,54,96,227,35,213,88,161,183,177,29,97,20,103,152,238,55,72,191,140,239,193,97,66,74,153,25,214,75,169,29,204,135,5,143,55,156,22,202,221,78,156,186,157,185,165,193,93,110,46,57,182,228,185,230,219,185,95,154,93,202,156,241,84,235,218,173,66,141,74,221,206,151,14,229,204,140,85,115,37,159,192,239,77,173,151,232,201,147,210,25,215,149,242,195,209,190,125,202,179,163,231,166,187,251,19,172,15,152,189,125,5,231,243,163,183,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,207,60,156,114,236,117,239,115,50,69,206,78,236,19,8,216,185,84,89,144,69,225,209,132,174,63,117,120,99,20,243,203,195,94,86,206,227,140,90,148,172,41,66,207,172,121,113,66,198,200,149,163,9,64,156,183,134,234,74,81,177,23,61,40,142,252,116,228,229,192,0,7,60,112,119,239,74,244,169,47,59,182,205,51,215,211,48,231,157,219,75,14,33,110,108,44,12,162,235,14,190,50,187,156,114,64,157,189,133,145,38,101,241,233,35,46,202,181,220,201,184,51,189,13,150,30,139,197,113,60,236,241,7,152,126,219,225,71,199,142,61,33,230,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,29,135,32,118,188,45,228,228,114,194,19,55,205,178,66,47,138,149,140,106,134,199,202,77,61,55,187,164,77,59,127,176,48,162,43,30,143,215,230,69,137,227,24,225,147,195,99,214,228,165,149,184,237,215,129,203,168,236,235,193,217,212,118,117,28,184,28,184,28,184,28,184,28,184,29,178,204,87,98,27,195,213,250,135,217,196,20,111,160,185,60,127,173,125,239,141,31,56,53,207,211,13,114,124,220,198,61,243,170,207,37,119,221,24,25,11,47,141,89,27,42,99,83,205,155,82,99,88,79,27,55,34,213,217,1,182,115,13,53,148,155,195,50,209,57,113,189,116,166,67,149,31,40,181,87,221,47,31,31,59,146,209,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,158,67,151,39,21,106,206,22,89,36,222,243,53,222,212,204,229,205,123,33,184,115,147,69,230,123,214,96,212,50,153,142,175,43,107,156,63,73,153,254,169,192,240,243,43,197,226,250,149,105,241,193,219,142,7,60,0,0,0,0,0,0,0,0,119,216,186,231,50,61,175,236,255,0,3,123,88,222,215,144,82,36,151,107,43,131,172,78,65,88,214,88,31,162,173,143,24,106,95,161,216,129,243,23,89,125,63,212,103,206,56,15,107,234,35,66,204,77,98,102,105,146,105,217,99,120,100,218,55,40,55,150,87,162,178,147,122,229,122,43,43,55,182,89,162,178,211,48,249,187,244,131,45,62,22,62,144,252,241,35,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,57,28,242,56,115,80,235,125,113,153,17,91,87,101,250,136,212,185,198,221,207,141,45,158,238,60,144,213,211,249,118,189,59,107,28,55,205,102,201,243,230,184,213,166,99,129,197,211,59,244,0,0,0,0,0,0,0,0,0,0,0,100,56,244,145,234,15,108,252,251,246,169,234,185,172,55,37,37,43,198,87,37,46,34,238,9,74,241,119,4,143,22,215,5,134,51,158,118,52,14,163,246,148,1,243,131,75,125,76,212,103,203,188,47,232,54,140,60,189,47,151,96,230,101,149,105,137,227,122,101,154,43,44,55,182,95,162,50,243,123,102,26,35,49,55,190,47,5,153,159,42,53,71,220,191,157,71,146,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,115,200,57,92,148,231,110,183,17,140,123,63,114,250,44,213,121,254,209,202,205,121,148,101,177,5,142,37,13,230,211,60,243,22,183,243,129,158,233,44,110,32,184,181,0,0,0,0,0,0,0,0,0,0,0,0,5,205,181,67,111,251,39,195,94,180,61,175,154,234,157,144,75,92,70,87,37,43,197,220,18,149,227,43,146,149,226,238,9,74,241,151,4,149,88,250,229,88,73,234,198,159,212,30,186,132,62,114,104,63,170,218,80,249,109,134,251,219,64,154,35,38,183,198,205,181,152,104,172,184,222,249,142,137,204,77,241,153,232,124,208,223,25,174,135,205,77,15,243,187,238,6,153,62,79,166,97,128,0,0,0,0,0,0,0,0,0,0,0,0,28,241,201,216,187,25,101,215,168,12,99,233,206,199,221,102,17,153,229,21,136,138,92,235,18,103,69,97,222,77,51,175,43,97,154,100,157,194,168,116,57,224,0,0,0,0,0,0,0,0,0,0,0,0,0,115,192,203,253,55,229,13,240,123,227,110,249,163,125,25,109,120,203,130,74,188,109,114,78,226,46,224,147,175,25,92,149,175,23,112,73,220,69,215,37,107,197,220,18,149,99,107,149,113,236,146,161,162,180,39,185,177,3,229,198,133,250,189,231,3,231,69,15,69,105,130,182,101,168,103,13,237,154,232,108,216,223,25,182,135,205,205,241,156,104,124,224,191,249,71,246,30,40,248,188,207,240,0,0,0,0,0,0,0,0,0,0,0,0,1,219,173,217,223,58,165,235,131,175,215,137,109,186,68,202,221,69,140,86,207,71,19,126,95,197,252,142,101,126,104,131,192,203,152,238,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,222,200,213,211,167,181,61,53,243,215,212,39,172,100,181,222,102,76,92,69,220,18,119,17,149,201,58,241,149,137,90,241,119,4,165,120,187,130,82,226,42,228,147,175,25,92,148,184,139,184,36,249,178,174,71,107,125,191,110,120,155,204,63,81,244,137,242,135,93,253,1,243,41,169,51,28,54,220,222,89,190,134,206,77,241,157,104,108,228,223,89,222,134,206,204,219,228,175,215,10,39,197,86,127,128,0,0,0,0,0,0,0,0,0,0,0,42,157,243,59,79,74,25,15,217,184,95,64,29,238,56,133,59,107,251,111,58,18,190,73,131,242,129,47,160,109,49,179,181,48,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,90,136,204,55,215,152,51,227,232,14,233,241,31,165,205,205,115,143,74,18,213,226,238,9,58,241,149,201,74,241,149,201,58,241,149,201,75,136,171,146,78,188,101,114,82,226,46,224,148,175,25,92,147,184,139,184,46,224,166,187,154,31,204,95,64,245,161,242,123,71,253,58,242,97,230,44,178,207,29,55,70,117,161,243,179,124,231,186,23,61,55,206,123,161,243,211,42,249,29,246,31,19,62,58,166,97,128,0,0,0,0,0,0,0,0,1,216,231,33,181,220,102,67,246,107,90,123,192,173,125,204,25,198,178,233,230,82,235,199,214,126,87,46,52,173,56,83,158,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,230,82,42,161,186,61,55,226,13,226,123,199,53,243,190,230,51,11,136,139,162,82,188,101,114,82,226,42,224,148,173,27,92,146,184,140,174,74,87,140,174,73,220,69,220,18,149,227,43,146,151,17,87,4,165,120,202,228,149,167,53,141,113,230,207,105,224,135,202,255,0,59,253,72,242,9,228,220,174,150,48,110,156,251,67,103,198,249,207,180,62,126,111,157,131,161,118,9,141,252,166,251,127,229,19,231,56,0,0,0,0,0,0,0,0,14,111,237,179,162,123,233,86,145,251,60,77,206,245,141,41,234,186,190,94,58,248,235,159,46,29,116,221,72,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,46,115,205,119,42,122,235,210,62,14,244,193,234,9,76,15,44,37,235,198,87,36,238,98,174,9,90,241,119,4,157,120,202,228,165,120,218,228,149,120,202,228,165,196,93,193,39,94,50,224,148,175,23,112,74,87,139,184,36,232,210,172,96,158,106,246,86,191,62,89,121,219,233,191,142,79,55,230,120,252,113,188,118,6,135,216,6,248,216,90,31,97,27,231,96,232,141,134,120,99,201,63,114,254,69,26,164,0,0,0,0,0,0,0,59,245,148,36,189,39,175,126,192,27,251,122,91,87,41,107,11,207,49,22,30,55,191,242,201,99,166,238,177,67,142,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,21,105,12,187,124,249,155,100,30,230,218,254,81,244,9,177,46,33,239,9,59,136,171,130,86,226,46,185,39,113,23,92,149,184,138,184,37,43,198,87,36,235,198,215,36,174,35,43,146,149,226,238,9,75,136,171,146,78,188,101,114,78,219,173,99,88,121,67,221,218,124,249,93,165,61,249,228,147,93,103,218,214,88,222,219,15,67,236,67,124,108,77,15,177,77,239,21,5,177,79,138,81,159,72,190,110,128,0,0,0,0,0,3,177,95,96,227,158,153,61,39,245,243,92,237,227,190,9,33,231,50,19,198,243,158,80,34,116,164,158,188,40,82,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,243,248,237,209,232,63,74,120,155,209,7,171,230,181,198,110,76,87,139,174,74,220,69,92,18,149,226,235,146,183,17,119,4,157,120,202,228,165,196,93,193,39,94,50,185,41,90,54,185,39,113,23,92,148,184,139,184,36,238,34,238,9,24,57,49,231,15,25,125,43,243,9,243,79,11,244,150,131,37,54,38,147,206,77,241,177,180,62,199,55,190,198,209,27,24,222,191,44,190,144,118,62,43,37,162,64,0,0,0,0,1,127,105,154,153,175,215,159,24,125,171,38,163,238,180,209,143,120,243,39,242,41,142,232,169,173,90,69,195,243,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,183,81,57,185,180,54,120,123,59,109,249,111,126,155,2,226,34,236,148,184,139,184,36,235,198,87,37,46,34,238,9,74,241,149,201,59,136,187,130,82,226,46,185,41,94,50,224,146,175,27,92,147,175,25,92,147,184,139,184,37,43,198,87,42,106,237,165,12,120,35,200,159,78,60,96,121,10,234,111,18,54,174,199,209,27,32,222,219,31,68,236,131,123,108,157,19,178,79,61,252,239,251,167,242,0,213,96,0,0,0,1,207,21,137,29,229,174,254,138,158,230,244,189,140,33,9,228,236,199,199,102,35,231,172,135,81,144,120,20,140,48,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,115,61,1,118,111,159,70,120,243,208,199,163,229,112,172,156,149,184,140,174,74,87,139,184,37,46,34,174,9,74,241,119,4,165,196,93,114,82,226,46,224,147,184,139,184,37,43,197,220,18,149,226,238,9,43,136,218,228,149,196,93,193,39,205,149,115,14,242,199,178,244,225,243,63,75,251,75,203,6,15,157,224,50,102,243,217,90,39,100,155,215,101,104,173,148,111,93,105,144,108,179,225,107,209,222,113,0,0,0,0,230,98,51,96,155,71,238,95,130,254,165,29,244,78,91,228,179,4,243,6,93,163,204,119,89,100,26,232,179,232,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,191,65,148,111,15,61,109,51,214,121,254,147,218,198,73,113,23,92,148,175,25,92,148,175,25,112,73,220,69,215,37,107,197,220,18,149,227,43,146,149,226,238,9,74,241,149,201,74,241,119,4,173,120,187,130,78,188,101,114,78,188,101,114,67,22,200,40,30,80,241,175,210,47,31,158,42,136,216,56,9,151,108,173,35,177,13,233,178,244,102,202,55,166,204,209,123,48,188,248,231,247,51,230,137,229,240,0,0,14,120,168,73,239,205,87,244,44,250,27,157,220,233,195,4,242,86,125,231,19,17,213,153,46,179,49,172,86,238,204,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,190,117,128,100,199,165,183,87,155,55,169,176,238,34,46,137,75,136,186,228,165,196,93,193,41,94,46,224,148,175,23,112,74,87,139,184,37,43,197,220,18,151,17,87,36,157,120,202,228,165,196,93,193,41,94,46,224,148,175,23,112,73,85,143,174,66,249,187,212,154,164,249,211,163,125,147,229,179,3,202,177,139,131,117,236,205,25,179,13,231,179,52,110,205,55,148,37,182,205,62,23,241,232,175,58,128,0,2,70,195,44,54,111,218,15,154,191,96,72,255,0,50,236,15,47,152,30,153,203,117,97,139,107,44,163,93,22,124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,152,105,19,114,111,175,55,239,131,107,223,65,72,146,119,17,117,201,90,241,149,201,74,241,149,201,75,136,171,130,82,226,46,185,41,113,23,92,149,175,23,112,73,220,69,220,18,119,17,119,4,165,120,202,228,165,120,202,228,165,196,93,114,67,24,158,181,60,173,227,223,161,62,63,60,161,31,149,226,166,81,179,116,174,198,55,142,206,209,219,56,222,59,59,71,108,243,23,249,55,247,99,227,153,172,192,0,23,59,47,3,220,39,210,207,72,199,96,70,3,231,204,239,76,152,134,176,203,181,121,137,98,50,49,160,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,47,108,174,205,143,189,52,30,239,54,188,158,63,40,73,220,69,215,37,107,197,220,18,181,163,43,146,151,17,87,36,165,120,187,130,82,188,93,193,41,94,46,224,148,184,139,174,74,87,139,184,37,46,34,235,146,151,17,117,201,90,241,119,4,159,123,10,230,39,229,191,94,104,99,193,26,199,208,186,36,136,203,240,249,51,117,236,253,31,179,205,225,179,244,134,207,55,127,150,61,17,144,159,16,215,86,160,14,221,106,25,23,179,188,93,245,72,244,230,142,204,244,185,130,234,172,207,87,24,110,176,204,117,129,7,208,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,115,109,114,103,155,171,72,238,99,104,74,99,242,100,165,120,202,228,165,120,202,228,165,196,93,114,82,226,42,224,148,184,139,184,37,43,198,87,37,43,197,220,18,151,17,117,201,75,136,186,228,165,196,93,193,39,113,23,112,74,92,69,92,18,149,227,43,151,58,199,101,98,103,139,188,205,237,79,39,26,179,181,75,115,61,218,26,71,103,155,187,104,233,13,164,110,221,161,164,182,137,243,155,204,255,0,80,190,94,128,59,244,228,200,62,220,252,186,250,118,97,250,151,54,213,166,17,171,179,109,90,97,90,231,42,194,206,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,155,107,147,54,220,26,119,109,155,30,74,10,68,148,175,25,112,73,220,69,220,18,149,226,238,9,59,136,187,130,82,188,101,114,82,226,42,228,147,184,139,184,36,238,34,238,9,74,241,117,201,91,136,171,130,82,188,93,193,41,113,21,112,74,87,141,174,73,70,215,166,104,143,36,123,111,202,7,153,226,242,92,108,186,216,218,195,52,55,102,209,210,123,68,221,155,71,74,109,35,103,124,67,251,127,243,16,243,104,0,250,65,233,72,202,102,9,171,115,189,88,96,186,183,58,213,166,15,7,121,102,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,155,107,163,50,218,186,167,104,25,244,132,37,241,43,94,46,224,148,175,23,112,74,87,139,184,37,43,198,87,37,46,34,235,146,151,17,117,201,75,136,187,130,82,188,93,193,41,94,50,185,41,113,23,92,149,175,23,92,148,184,139,184,37,43,197,220,18,157,227,235,24,151,152,189,85,231,147,200,56,62,208,214,133,188,236,21,225,184,118,150,148,218,102,234,218,90,87,105,27,171,205,155,242,161,241,116,12,231,6,245,153,244,163,85,231,250,176,192,53,110,123,171,76,7,86,103,218,176,198,186,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,186,181,186,50,253,151,172,182,49,155,94,195,94,18,183,17,87,4,165,120,202,228,165,196,93,193,39,94,50,185,41,113,23,112,73,220,69,215,37,107,197,220,18,151,17,87,36,157,120,202,228,165,120,202,228,173,120,187,130,78,226,46,224,148,184,138,185,36,235,197,215,41,233,29,217,169,143,33,234,29,235,164,136,158,253,6,123,180,244,182,211,55,78,210,210,251,76,221,27,75,76,109,51,227,150,13,235,47,38,143,163,255,0,56,62,192,25,158,171,216,90,172,215,218,179,96,106,195,95,234,252,243,91,150,160,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,23,118,151,70,89,176,53,238,118,101,183,113,23,68,173,196,93,114,82,188,101,114,82,226,42,228,148,175,23,112,73,220,69,220,18,149,226,238,9,74,241,149,201,75,136,171,130,86,188,93,193,39,113,23,92,149,175,25,92,148,175,23,112,74,92,69,215,37,43,197,220,23,154,227,62,193,143,46,232,127,68,121,252,198,28,240,75,108,253,73,178,77,205,181,52,206,212,55,46,212,211,59,80,243,231,206,15,176,31,31,202,191,114,190,61,253,139,53,214,171,216,186,168,215,90,179,98,106,179,93,224,57,118,28,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,46,173,110,204,155,54,193,243,3,38,185,138,185,37,46,34,235,146,149,227,43,146,151,17,119,4,165,120,202,228,165,120,187,130,78,226,50,185,41,113,23,92,148,184,139,174,74,215,139,184,36,238,34,238,9,75,136,186,228,165,120,202,228,165,196,93,193,39,94,50,185,35,137,100,88,201,231,207,61,122,47,207,38,29,215,183,82,166,123,175,243,3,114,237,77,55,181,13,199,181,52,238,211,54,119,195,79,186,95,28,77,161,244,191,194,190,222,53,190,171,217,26,168,214,250,171,100,106,163,92,227,146,241,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,234,214,232,200,178,188,67,37,50,11,136,202,228,165,196,85,201,41,94,50,185,39,113,23,92,149,175,25,92,148,184,138,184,37,46,34,235,146,181,226,238,9,58,241,151,4,165,196,85,193,41,94,50,185,41,113,23,92,148,175,25,92,149,184,138,184,37,43,198,86,36,241,249,72,35,73,121,243,208,26,0,194,186,84,166,50,60,114,96,219,251,87,78,237,83,113,109,77,61,181,77,193,243,67,233,31,136,76,239,210,250,111,109,154,207,85,236,173,86,107,77,85,178,245,73,175,35,238,173,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,205,181,201,55,144,99,115,68,221,196,93,193,39,113,23,112,74,92,69,215,37,43,197,220,18,151,17,119,4,157,120,202,228,173,120,186,228,165,196,93,193,39,113,23,112,74,92,69,92,18,149,227,43,146,151,17,87,36,165,120,186,228,165,196,85,201,41,94,50,185,39,7,127,4,106,29,9,188,116,73,137,211,237,212,72,199,93,155,83,106,233,253,172,109,253,171,168,54,169,183,188,207,232,253,72,101,89,69,46,166,176,213,91,59,85,26,199,85,108,237,84,96,52,106,83,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,23,22,245,201,73,88,73,2,98,226,46,185,39,113,23,92,149,184,138,184,37,46,34,235,146,151,17,119,4,157,196,93,193,41,94,46,224,147,185,138,184,37,43,198,87,37,46,34,174,73,74,241,117,201,75,136,187,130,82,188,101,114,78,230,42,224,148,175,25,112,72,227,242,120,217,170,116,150,220,211,102,63,215,158,5,122,21,13,145,181,117,30,213,54,238,213,212,123,84,219,120,198,67,216,155,199,51,140,12,213,186,167,105,106,147,87,106,173,163,170,76,35,175,60,0,0,0,0,21,133,23,60,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,42,210,236,94,222,70,92,18,151,17,117,201,74,241,117,201,91,136,187,130,78,188,101,114,82,230,42,224,148,175,23,92,149,184,139,174,74,92,69,92,18,181,226,238,9,59,136,187,130,82,188,93,193,39,113,23,112,74,215,139,174,74,87,140,174,74,215,139,184,47,241,105,140,56,214,26,159,96,235,98,59,128,119,233,201,159,109,93,77,181,77,181,181,117,54,213,54,214,71,139,231,165,222,180,218,154,168,213,90,167,106,234,147,85,234,173,169,170,76,47,142,120,0,0,3,153,146,50,70,82,137,97,111,33,64,176,163,125,68,180,84,166,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,222,165,14,197,221,123,10,132,149,104,218,196,165,196,93,193,41,94,50,185,39,113,23,112,74,87,140,174,74,215,139,184,36,238,34,235,146,181,226,238,9,74,241,119,4,165,196,85,201,39,94,46,224,149,175,23,112,73,220,69,215,37,106,198,83,46,112,11,253,108,99,216,100,148,49,208,14,120,228,205,246,174,168,218,166,216,218,186,167,106,155,95,101,235,61,170,113,170,118,110,180,53,70,170,218,218,168,213,26,167,107,234,163,9,227,158,0,0,93,74,101,228,53,196,133,2,62,132,133,2,194,133,253,2,194,132,133,2,62,141,253,2,203,138,244,142,160,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,119,232,43,85,181,238,95,87,142,172,73,87,140,174,74,92,69,215,37,46,34,238,9,59,136,187,130,82,226,42,224,148,175,25,92,148,184,139,184,36,238,34,238,9,59,136,187,130,78,226,46,185,43,94,47,130,74,18,203,13,59,224,61,241,243,165,14,120,0,115,199,38,107,181,181,94,213,54,166,214,213,123,84,218,187,87,85,236,178,203,2,202,49,179,83,106,173,179,170,141,75,170,182,206,170,48,46,59,117,5,225,107,157,100,18,196,125,9,10,5,133,188,133,2,194,133,253,2,194,141,245,18,194,222,66,129,97,66,254,129,97,111,33,68,176,233,119,64,166,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,59,119,165,201,113,90,207,185,35,94,54,177,41,94,50,185,41,94,50,185,41,113,23,92,148,175,23,112,74,215,139,184,36,238,34,238,9,59,152,171,130,82,180,88,149,140,141,198,203,188,58,156,40,182,112,0,3,158,59,153,198,213,213,219,84,218,91,87,87,109,83,104,231,216,54,70,65,117,199,178,131,81,234,173,185,170,141,69,170,182,238,169,53,197,58,217,89,21,183,38,120,44,40,95,209,35,232,72,80,35,232,223,208,44,40,72,80,44,45,228,40,22,20,36,40,17,212,111,232,22,20,36,40,17,244,111,232,22,20,175,168,22,238,221,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,28,240,42,85,182,238,93,215,176,168,73,87,140,174,74,92,69,220,18,117,227,43,146,151,17,119,4,165,120,186,228,165,120,174,164,181,132,84,49,127,142,219,216,29,168,56,0,0,5,74,117,204,251,106,235,29,170,108,253,171,172,118,169,179,187,85,197,204,83,109,121,199,210,230,161,213,91,123,85,154,131,85,109,250,198,154,218,83,145,133,133,9,10,4,125,9,10,5,133,9,11,114,62,141,253,18,62,132,133,2,62,141,253,2,194,133,253,18,62,133,253,18,194,133,253,2,194,133,253,2,194,132,133,2,62,141,253,2,209,83,161,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,231,183,65,94,181,167,98,254,188,109,114,78,188,93,193,39,113,23,92,148,169,23,208,149,179,141,177,47,35,41,80,57,232,0,0,0,11,187,73,19,98,109,93,105,181,77,151,181,181,158,213,54,94,163,220,222,103,48,47,111,252,219,250,96,105,237,87,184,107,154,138,134,214,215,70,167,134,202,177,226,62,132,133,2,62,132,133,2,194,132,133,2,62,132,133,185,99,66,254,137,29,66,66,129,97,66,254,137,31,66,66,129,97,66,254,137,31,66,254,129,97,66,254,137,31,66,66,129,97,66,254,129,101,197,197,19,168,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,191,122,60,151,85,172,187,146,29,227,249,47,232,90,83,43,81,233,193,207,0,0,0,0,2,102,27,36,54,62,212,215,27,80,217,27,87,91,109,99,99,248,131,221,159,51,141,95,246,55,225,119,223,131,15,181,218,24,1,170,245,214,214,215,166,165,197,51,252,44,141,161,127,68,143,161,33,110,88,80,144,160,88,80,191,160,88,80,191,162,71,208,191,160,88,81,191,160,88,91,200,80,44,40,95,209,35,232,72,91,150,20,111,232,22,20,47,232,22,20,47,232,145,244,111,232,22,29,46,232,148,156,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,183,81,217,212,115,192,0,0,0,0,0,28,230,56,142,124,108,77,169,174,246,161,177,54,174,186,218,134,197,248,231,246,23,225,161,75,238,95,195,79,171,7,178,240,29,159,129,26,179,94,237,109,122,106,140,11,105,107,226,2,133,253,18,62,132,133,2,62,132,133,2,194,132,133,2,62,133,253,2,194,132,133,2,62,141,253,2,194,133,253,18,62,132,133,2,62,132,133,2,194,133,253,2,194,132,133,2,62,141,253,2,194,133,253,2,62,140,133,2,62,149,245,177,68,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,222,201,192,118,137,176,54,166,190,218,102,193,218,186,243,106,24,103,199,239,164,31,55,199,182,124,77,181,143,190,24,22,206,193,13,93,128,109,60,4,213,26,247,109,107,211,4,161,35,110,71,208,144,160,71,209,191,162,71,208,144,160,71,208,144,160,88,91,200,208,35,232,95,209,35,232,72,80,35,232,223,208,35,232,223,209,35,232,95,209,35,232,72,80,35,232,223,208,44,40,95,209,35,232,223,208,35,237,37,44,8,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,238,100,187,79,1,218,102,125,180,240,29,164,103,251,79,1,218,71,205,127,38,103,56,48,169,76,126,139,59,249,211,211,230,175,192,246,142,10,106,157,127,182,48,19,85,216,100,144,133,133,11,250,5,133,9,10,4,125,27,250,5,133,11,250,5,133,9,10,4,125,9,10,5,133,11,250,5,133,11,250,5,133,27,250,4,125,9,10,5,133,11,250,36,125,11,250,5,141,188,133,2,62,141,253,2,194,58,102,48,129,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,47,44,231,140,223,105,96,219,68,206,182,158,11,180,76,239,188,167,154,207,155,192,3,232,47,213,47,129,191,125,76,15,5,218,24,41,171,112,45,173,129,154,155,20,216,216,65,19,66,66,129,31,66,66,129,97,66,254,129,97,66,254,137,97,66,254,137,29,66,66,129,97,66,254,137,31,66,66,220,176,163,127,68,143,183,144,160,88,80,191,162,71,208,144,160,88,80,191,160,88,80,191,160,88,196,79,196,24,152,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,182,105,138,108,115,53,218,88,78,209,51,109,165,132,109,19,56,249,135,244,227,226,25,98,0,47,190,248,252,0,250,132,125,8,193,246,118,16,107,12,19,106,96,198,168,192,246,198,6,96,244,100,109,136,250,18,20,11,10,18,20,8,250,18,20,8,250,55,244,72,250,18,22,229,133,11,250,37,133,188,133,2,62,141,253,18,62,132,133,2,62,132,133,2,62,141,253,2,194,132,133,185,97,66,254,129,99,15,144,67,152,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,29,201,221,159,134,237,19,50,217,248,110,208,51,61,163,134,109,35,206,95,47,61,55,230,64,0,27,251,64,223,159,164,200,93,73,188,205,99,132,109,12,40,213,120,38,215,193,141,85,25,151,227,36,125,9,11,114,194,141,253,2,62,132,133,2,62,141,253,18,62,132,133,2,62,141,253,2,194,133,253,2,194,133,253,18,62,132,133,2,62,141,245,18,62,141,253,2,194,132,133,2,62,132,133,2,62,38,126,40,213,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,39,27,151,153,118,207,196,118,121,151,109,60,63,113,25,62,77,57,230,35,230,100,60,244,9,212,0,1,239,127,175,63,156,111,190,196,134,23,179,176,195,87,224,251,83,9,53,70,25,180,176,131,20,161,33,64,143,163,127,64,176,183,145,183,44,40,95,209,44,45,228,40,17,244,36,40,22,20,36,45,203,10,18,20,8,250,55,244,11,10,23,244,11,10,18,20,8,250,55,244,8,250,50,22,229,132,100,221,137,165,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,57,47,118,46,47,179,12,171,104,98,155,120,203,247,254,51,232,195,143,144,95,80,62,55,154,210,6,254,60,0,0,31,81,62,93,236,83,244,89,134,222,223,26,199,11,218,24,97,171,48,141,171,133,154,178,195,44,199,72,234,55,244,11,10,18,20,8,250,18,20,11,10,23,244,72,234,55,244,11,10,18,20,8,250,18,20,11,10,23,244,72,250,18,22,229,133,9,10,4,125,27,250,5,133,9,10,4,125,180,141,19,207,202,212,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,237,158,86,100,187,55,26,219,6,79,232,108,83,214,6,67,185,43,96,135,206,175,159,219,83,66,145,148,192,0,0,3,234,95,210,159,205,231,232,92,167,134,236,236,60,213,248,94,210,195,77,87,134,237,76,40,195,168,200,219,22,20,36,40,17,244,111,232,22,20,36,40,17,244,36,45,203,26,23,244,8,250,18,20,11,10,18,20,8,250,18,20,11,10,23,244,11,10,23,244,11,10,18,20,8,250,18,20,15,63,71,100,24,248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,229,238,197,199,246,177,145,122,3,29,245,169,144,122,150,55,108,150,31,44,125,235,240,208,213,186,246,82,24,0,0,0,1,244,67,231,125,233,250,111,196,48,29,182,107,44,59,103,225,230,175,195,54,174,26,106,152,156,235,19,34,232,95,209,35,232,95,209,35,232,72,80,35,232,72,80,44,40,95,209,35,232,72,91,150,20,111,232,22,22,242,20,72,250,18,20,8,250,18,20,11,10,23,244,11,10,23,244,13,39,132,109,205,70,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,184,237,150,77,111,248,159,92,18,190,186,141,223,133,100,167,151,79,12,124,234,216,186,48,142,162,0,0,0,0,1,233,63,189,191,151,255,0,175,71,183,241,29,153,137,154,199,16,218,24,129,171,112,237,171,135,154,230,222,122,40,143,161,33,64,143,163,127,64,176,161,127,68,143,161,127,68,143,163,127,64,143,163,127,64,176,161,33,64,143,161,33,64,176,161,127,64,176,161,33,64,143,161,33,64,198,60,227,234,239,57,24,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,84,227,47,47,189,15,105,236,34,191,175,104,111,210,190,91,205,145,7,241,83,217,223,33,204,39,10,188,143,0,0,0,0,0,4,236,16,253,28,230,63,15,126,237,154,235,18,217,184,153,172,113,13,163,137,26,179,20,218,56,129,135,209,146,181,44,40,72,91,150,20,36,45,203,27,121,10,4,125,27,250,5,133,11,250,36,125,9,10,5,133,188,133,2,194,132,133,2,62,132,133,2,62,141,253,2,195,87,109,152,243,202,11,187,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,87,190,82,83,244,101,95,101,150,222,186,169,188,10,153,197,11,242,150,155,216,255,0,32,207,53,249,155,36,215,133,30,160,0,0,0,0,0,0,250,217,242,78,76,253,53,98,186,235,115,26,207,20,217,184,169,172,49,45,165,137,154,178,7,98,226,102,61,66,66,129,31,66,66,129,97,66,66,129,31,66,254,137,31,66,66,129,97,66,254,129,31,70,254,129,97,66,254,137,31,66,66,129,31,70,254,129,97,66,254,129,163,245,55,173,60,170,90,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,216,226,242,227,62,34,189,33,53,236,162,31,213,151,123,108,102,52,165,202,145,151,90,44,208,63,32,54,23,155,8,184,206,221,0,0,0,0,0,0,114,112,236,58,187,13,189,250,4,252,206,123,64,251,53,139,231,240,70,179,197,182,110,46,106,252,79,105,98,166,174,139,206,241,114,18,141,253,2,194,132,133,185,97,66,66,129,97,66,254,129,31,70,254,137,31,66,254,137,31,70,254,129,97,66,254,137,29,70,254,137,31,66,66,129,97,166,119,117,129,227,164,196,56,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,115,118,81,155,149,220,134,45,233,204,191,214,198,61,232,251,236,252,227,38,233,50,84,169,218,4,131,248,197,187,190,106,144,56,45,197,128,0,0,0,0,0,0,237,215,177,203,142,64,29,123,15,168,255,0,78,255,0,48,127,105,15,90,98,251,43,25,53,158,45,179,177,131,88,98,187,75,23,53,116,126,113,140,16,244,36,40,17,244,36,40,22,20,47,232,145,244,36,45,203,10,18,20,8,250,55,244,11,10,23,244,72,250,18,20,8,250,55,244,8,250,55,244,13,93,231,47,107,249,164,215,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,114,113,82,182,70,68,231,217,111,162,12,11,212,185,207,162,204,123,115,93,229,39,19,221,102,78,215,188,199,20,188,31,179,62,50,152,238,154,189,199,78,188,0,0,0,0,0,0,3,183,94,195,158,57,0,112,228,76,195,112,125,240,244,119,230,199,239,81,159,227,59,43,26,53,166,51,179,49,163,88,226,219,75,24,53,124,118,117,141,16,118,242,54,228,125,27,250,36,125,9,10,5,133,11,250,5,133,11,250,36,125,27,250,5,133,11,250,5,133,11,250,36,125,11,250,36,124,14,79,64,241,85,151,162,188,234,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,29,174,203,105,57,173,168,97,91,183,100,250,72,214,254,146,204,182,169,19,158,87,155,56,152,76,28,200,241,110,116,243,252,215,198,67,30,243,93,214,26,116,164,0,0,0,0,0,0,0,57,224,118,231,142,64,0,3,141,135,175,120,63,69,155,71,243,145,247,156,203,113,173,145,143,26,211,27,217,152,217,172,113,173,161,141,154,182,35,98,99,70,49,66,74,216,176,161,127,64,176,161,127,68,143,161,33,64,143,163,127,64,143,163,127,64,176,161,127,68,143,161,33,64,176,161,127,64,176,243,39,169,34,15,20,166,225,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,66,157,123,252,192,198,115,253,137,232,35,83,122,51,105,238,147,6,220,83,217,89,103,144,85,150,58,76,118,151,58,200,45,142,218,137,241,204,165,228,90,216,25,214,215,158,0,0,0,0,0,0,0,0,1,219,168,238,224,57,227,144,1,192,216,122,244,126,133,119,47,230,211,237,225,188,241,236,230,36,215,56,238,202,199,205,101,141,236,252,116,213,176,27,59,28,48,122,19,209,100,117,9,10,4,125,9,10,5,133,9,10,4,125,9,10,4,125,9,10,5,133,9,11,114,62,141,253,18,62,132,133,3,94,121,67,221,122,76,243,216,0,0,0,0,0,0,0,0,0,0,0,0,0,0,119,58,119,188,200,140,127,40,207,247,89,168,247,182,230,222,198,167,222,121,182,104,64,230,23,210,229,9,106,178,197,25,106,178,135,75,212,121,87,76,67,124,125,37,188,153,71,9,57,178,231,128,0,0,0,0,0,0,0,0,0,14,121,234,59,28,128,28,14,92,14,101,162,7,218,31,103,126,101,126,150,159,75,97,228,250,152,150,63,158,196,26,227,29,217,176,6,175,199,182,142,62,107,59,44,222,0,129,161,35,108,88,81,191,160,71,208,144,160,88,91,200,80,44,40,95,208,44,40,72,80,44,40,95,209,35,237,228,40,30,91,213,62,236,242,57,133,128,0,0,0,0,0,0,0,0,0,0,0,21,10,125,239,242,51,25,200,118,46,225,52,230,228,222,187,196,210,91,215,103,102,166,39,154,203,203,150,50,247,50,133,188,157,196,161,111,45,90,64,167,91,172,25,115,229,173,107,242,192,201,124,235,109,139,29,173,64,0,0,0,0,0,0,0,0,0,0,0,231,158,188,156,242,3,128,114,113,207,3,144,122,207,235,119,231,119,101,31,160,11,127,55,250,4,226,38,98,220,197,96,179,152,179,93,227,251,50,12,214,16,91,66,0,215,246,249,76,49,19,66,66,129,31,66,254,129,97,66,66,129,31,66,66,129,97,66,254,137,31,66,66,220,177,130,201,104,30,32,128,245,103,148,192,0,0,0,0,0,0,0,0,0,14,247,69,157,105,236,184,193,50,125,183,184,13,17,183,253,7,185,77,15,187,54,198,96,97,89,172,220,161,27,43,125,32,90,72,222,73,22,114,119,82,69,180,159,126,165,213,180,46,149,54,159,205,29,27,228,98,127,82,219,67,157,232,128,0,0,0,0,0,0,0,0,0,0,0,0,14,253,57,59,56,228,112,14,120,28,184,228,28,23,126,254,249,236,63,65,50,159,16,190,153,30,140,163,11,112,85,142,190,166,64,67,101,246,6,7,7,177,98,77,103,15,179,33,77,127,111,150,195,144,116,100,109,136,250,18,20,11,10,55,244,8,250,18,20,8,250,55,244,76,107,194,159,66,60,26,68,128,0,0,0,0,0,0,3,181,114,219,180,172,233,138,72,236,141,132,105,124,223,208,155,120,243,94,224,244,126,205,52,70,217,218,121,9,135,101,51,146,4,92,140,141,241,97,33,125,124,89,200,92,92,28,223,88,219,147,253,48,124,60,218,24,127,159,188,0,122,235,230,254,182,192,9,220,66,218,145,207,78,120,56,0,0,0,0,0,0,0,0,0,0,0,0,0,0,59,117,29,128,115,192,231,129,203,129,207,28,133,123,113,236,223,121,252,63,201,143,184,85,188,53,235,99,50,227,31,170,74,89,211,22,145,179,52,76,94,35,51,177,48,40,141,135,26,107,187,28,250,36,195,232,228,49,196,69,188,157,177,29,70,66,129,31,227,31,107,249,100,209,96,0,0,0,0,231,185,77,119,120,68,247,202,50,3,95,200,109,188,228,208,249,95,164,182,105,229,189,151,234,141,140,121,155,107,111,220,168,212,153,230,121,36,99,83,51,23,68,117,237,221,67,173,229,191,82,82,190,61,102,102,13,125,8,109,72,237,45,132,155,251,12,243,150,141,61,119,229,79,35,106,83,99,107,56,43,2,230,203,142,0,29,123,117,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,28,240,59,115,215,144,114,112,228,112,231,131,151,3,158,1,159,96,67,232,135,167,190,40,231,71,215,254,222,63,244,193,149,243,7,220,152,167,26,47,45,169,240,80,176,147,162,65,71,228,182,230,35,23,155,217,152,37,150,119,98,96,250,11,213,26,176,240,27,35,160,65,241,52,33,83,213,204,111,156,186,64,192,235,108,169,179,81,222,239,28,156,243,220,231,165,243,83,203,25,119,172,51,115,202,27,7,212,89,97,231,93,137,186,166,205,109,153,101,23,5,172,213,141,51,33,184,196,104,25,195,95,217,27,50,158,168,139,55,37,166,141,130,55,244,95,156,241,115,211,24,231,151,48,195,213,56,63,151,48,67,212,26,191,204,120,41,183,245,100,5,153,127,31,75,128,14,28,142,28,112,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,29,157,121,57,7,46,57,56,57,56,229,192,7,46,57,25,14,61,193,236,79,80,252,154,172,125,142,124,221,244,161,232,254,96,174,137,52,96,146,226,59,177,123,78,223,177,223,167,110,229,188,46,75,80,249,225,87,47,166,99,183,121,76,153,136,201,229,210,166,39,57,146,73,144,217,29,205,249,121,146,99,247,70,113,61,172,123,155,142,79,68,211,61,13,91,205,212,79,75,116,243,21,161,234,27,111,45,216,30,168,178,242,164,105,234,216,191,41,69,158,171,134,242,188,65,234,56,31,49,67,158,148,198,252,235,16,111,204,103,73,196,155,127,23,214,150,134,85,1,97,72,186,183,165,193,207,14,0,57,112,29,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,60,14,220,245,228,0,114,112,228,112,228,14,14,120,231,131,158,2,99,124,121,195,131,232,94,225,249,41,38,125,93,233,224,205,208,122,39,174,51,60,92,44,41,18,220,193,208,60,167,132,98,120,201,183,175,116,205,83,118,221,232,218,198,245,185,208,149,77,251,91,64,119,61,3,219,207,189,143,64,188,255,0,193,191,169,232,62,166,249,163,162,105,155,202,219,73,82,55,77,166,156,162,109,219,45,83,72,217,182,58,238,153,157,89,97,253,76,150,210,23,146,254,141,176,169,197,46,165,78,189,7,60,7,0,0,227,131,158,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,158,122,142,206,57,28,240,0,1,207,0,228,28,14,92,114,113,200,51,236,4,122,103,106,248,68,125,13,243,102,133,28,240,14,120,28,243,212,118,231,160,239,205,49,81,76,84,83,29,221,7,119,65,203,142,64,14,121,58,243,200,231,154,99,191,29,56,59,112,7,0,7,60,14,120,227,131,158,0,0,0,0,0,0,0,0,0,0,0,0,3,255,196,0,41,16,1,0,2,2,2,1,3,4,3,1,1,1,1,0,0,0,2,3,5,4,6,1,7,8,0,17,80,16,18,19,96,32,48,64,20,21,22,9,255,218,0,8,1,1,0,1,2,0,248,175,111,111,92,19,4,120,48,212,193,69,6,187,6,181,139,170,215,117,126,31,72,227,244,116,93,60,58,227,157,87,156,53,155,206,193,255,0,214,255,0,246,231,118,227,107,230,233,137,117,153,186,187,35,161,50,252,99,205,241,94,199,198,219,62,173,150,47,225,237,237,250,167,183,183,208,129,141,21,118,61,46,53,6,46,185,81,215,245,221,55,133,213,120,244,167,105,201,223,50,119,236,158,192,201,223,242,55,185,183,89,119,7,182,45,163,157,159,141,155,141,156,237,3,105,27,92,123,108,91,124,59,140,27,158,62,231,141,186,98,238,121,23,54,61,93,107,226,237,215,139,183,253,127,245,246,231,143,211,253,190,156,17,4,56,24,244,248,180,53,218,205,79,85,224,245,198,51,202,221,50,247,108,189,219,43,117,201,220,242,54,249,246,153,118,57,47,157,210,182,230,207,155,31,253,15,253,15,253,14,51,248,176,226,199,139,51,106,45,227,186,142,246,45,134,13,151,31,105,198,219,113,55,12,61,203,11,114,194,220,109,245,43,239,22,246,63,27,115,235,190,158,223,165,123,123,125,56,142,60,76,122,204,90,76,13,126,167,173,48,117,15,254,135,51,113,204,220,50,246,236,173,171,35,101,158,254,91,135,98,178,249,155,151,239,237,246,253,156,15,179,236,251,62,207,183,237,227,143,92,115,194,50,25,134,76,121,177,88,195,109,143,121,139,177,98,109,24,91,102,6,221,129,183,229,229,236,158,54,237,126,52,101,225,125,61,191,69,246,227,233,236,98,135,15,26,171,18,150,151,77,175,209,205,198,118,223,155,181,229,236,217,55,243,219,201,156,230,231,158,71,49,254,47,195,248,127,15,226,252,95,143,241,254,63,199,246,125,159,103,217,246,126,63,179,241,254,63,197,248,248,143,129,199,7,145,36,121,17,102,99,217,98,221,97,223,224,236,181,251,69,118,213,111,129,182,248,163,185,117,79,211,219,244,31,111,167,177,142,12,44,90,172,58,138,125,31,18,167,63,107,206,217,242,239,242,45,100,202,92,115,7,252,220,227,115,7,49,115,31,49,253,159,111,175,127,187,153,57,151,153,191,63,253,28,228,127,209,255,0,79,253,60,100,241,145,196,252,77,196,220,73,194,227,158,61,112,120,28,71,192,36,122,142,72,114,49,243,177,45,112,110,235,246,10,237,139,6,251,112,241,251,122,241,183,147,235,219,231,125,190,164,69,137,139,91,135,85,83,166,99,113,159,178,102,94,79,158,249,255,0,148,215,113,89,255,0,10,199,101,250,124,165,203,83,44,133,150,179,57,204,231,39,153,255,0,47,47,238,247,247,250,123,251,253,223,121,146,47,80,99,28,21,143,207,60,78,50,70,64,152,51,200,224,113,31,168,158,60,248,185,216,86,181,247,53,215,149,183,155,175,79,246,31,138,178,71,207,206,123,125,56,49,99,227,87,226,86,83,234,56,241,231,93,228,103,46,14,4,84,209,81,26,119,133,63,25,19,79,147,46,84,153,82,102,73,156,243,86,71,47,252,24,208,211,210,83,233,35,174,243,186,250,195,74,204,214,167,174,94,142,108,121,241,103,69,153,30,84,83,197,44,82,67,46,60,248,153,88,54,21,246,149,214,245,246,251,255,0,76,118,127,140,191,51,199,31,81,22,62,22,37,109,54,181,131,83,151,101,42,227,6,26,60,109,106,13,107,138,73,177,243,50,115,172,242,237,114,108,166,177,150,193,101,114,255,0,159,191,191,191,191,191,191,191,191,191,191,191,185,245,79,139,164,235,250,190,157,14,149,155,162,90,117,221,183,91,218,245,229,150,143,157,171,100,83,178,51,161,179,134,202,12,248,115,97,204,131,47,31,47,19,51,11,59,2,199,2,207,10,215,18,215,178,188,114,236,126,153,249,158,12,56,248,184,21,180,245,90,140,179,40,34,168,197,214,112,245,28,109,83,138,92,191,86,118,214,155,5,141,254,101,204,246,146,101,115,207,211,223,223,223,223,223,251,227,245,173,71,215,88,122,166,12,24,142,187,34,139,55,85,178,209,173,186,238,227,173,109,250,242,211,72,206,214,114,42,189,225,178,199,181,199,179,199,178,198,177,198,207,196,176,195,178,194,179,194,181,196,181,195,181,230,126,214,241,22,238,139,228,184,227,233,199,161,30,62,30,29,118,191,166,97,85,113,133,5,6,14,165,129,166,226,106,127,249,25,211,220,236,55,123,93,182,207,159,125,145,100,164,245,239,239,239,254,88,253,107,82,117,198,70,171,60,18,23,199,60,199,38,14,77,30,118,169,105,162,220,245,205,215,91,92,117,245,158,155,155,175,201,137,30,102,53,182,45,182,45,174,37,166,37,166,29,166,29,174,29,174,29,174,21,174,21,166,243,215,253,185,227,159,200,123,125,56,226,24,49,48,42,168,245,238,191,21,184,186,229,126,159,93,166,97,234,156,84,231,229,94,236,251,14,233,121,183,217,236,121,54,41,251,251,255,0,164,250,161,155,175,51,181,12,204,73,75,44,178,248,231,152,229,192,202,161,177,212,109,244,11,206,182,188,235,139,141,26,199,89,200,172,51,99,90,98,91,98,91,97,219,97,219,97,218,225,218,225,90,225,90,97,90,226,216,119,7,138,87,52,191,32,76,24,216,53,154,158,139,175,233,88,122,221,118,159,93,167,97,106,194,163,55,34,255,0,104,217,247,189,143,120,184,218,115,45,19,255,0,117,68,186,30,110,147,155,93,57,144,200,89,144,200,89,124,114,161,200,171,206,214,173,244,139,222,186,191,235,123,205,10,207,86,202,170,226,92,91,76,59,92,59,92,59,92,43,92,43,92,43,92,27,76,27,76,27,78,200,234,190,211,233,223,138,246,250,145,141,135,89,77,161,117,37,78,165,93,168,215,106,56,58,196,52,217,74,243,99,218,183,221,167,176,47,247,44,251,183,39,192,96,73,165,229,232,153,212,243,153,12,129,137,12,134,66,203,50,112,254,217,112,179,40,45,180,235,238,188,216,186,218,255,0,65,182,213,114,171,35,159,14,211,14,215,10,211,10,211,6,211,6,211,6,211,6,211,6,211,55,23,187,252,99,248,142,56,250,199,30,21,125,30,181,214,253,33,93,170,214,234,120,58,214,61,52,145,91,221,109,27,198,221,216,187,62,249,111,178,207,147,240,88,203,83,202,208,51,168,50,68,133,150,89,144,200,89,102,66,204,133,241,234,76,108,202,91,109,67,96,235,237,151,174,54,13,14,215,89,159,7,31,55,10,211,6,211,6,211,6,211,6,211,2,207,2,207,2,207,2,203,188,252,94,200,199,248,152,161,174,171,211,244,110,177,233,42,221,87,3,90,198,166,227,23,59,59,98,219,55,14,195,219,187,15,98,220,115,109,19,248,56,185,214,231,208,51,181,172,168,101,44,178,203,44,50,204,134,66,204,133,151,199,50,65,155,77,113,168,108,157,123,179,245,206,193,164,89,80,242,48,236,176,109,48,109,48,109,48,44,240,44,240,44,240,44,240,44,187,175,160,118,29,123,225,56,250,113,196,16,85,83,245,215,88,117,159,78,215,107,120,148,163,14,121,46,47,182,173,227,115,236,93,179,124,185,217,102,200,231,159,132,62,168,230,208,243,181,76,220,73,139,44,200,25,101,150,100,50,25,4,133,153,11,50,113,204,152,249,244,151,186,110,209,215,123,71,95,94,106,89,149,176,101,224,217,224,218,96,89,224,89,224,89,215,217,215,217,215,217,118,199,81,239,26,47,193,241,235,142,32,130,154,147,170,122,131,174,122,159,6,142,28,21,198,118,126,193,180,110,27,246,233,216,155,70,233,99,112,159,195,214,77,166,88,233,182,181,153,130,66,203,44,178,204,134,64,203,50,25,3,18,25,12,133,250,159,14,211,94,217,52,109,179,174,246,93,30,214,135,214,13,150,5,166,5,157,125,157,125,157,125,157,117,149,125,151,98,117,199,99,245,191,193,113,196,16,81,210,117,7,78,245,223,88,226,86,113,12,211,89,219,108,187,110,233,216,27,150,255,0,177,109,153,121,220,243,241,24,242,107,150,90,102,193,175,92,99,100,153,11,50,22,89,102,67,33,101,137,12,133,150,89,144,178,208,204,172,189,212,246,206,191,219,116,27,237,95,35,19,15,62,190,206,190,206,190,202,190,202,190,198,186,202,190,203,123,209,59,39,173,190,6,8,104,233,186,111,167,186,227,173,49,240,215,172,172,171,107,173,171,114,221,187,7,112,222,239,118,73,178,62,40,243,95,151,171,95,106,59,29,61,164,51,22,36,50,25,11,44,200,89,102,67,33,101,153,11,50,25,11,225,77,143,107,67,180,233,27,135,95,236,186,142,125,102,54,101,125,149,125,149,125,149,117,149,125,149,117,141,117,142,247,162,118,71,92,127,190,24,169,106,58,147,170,186,179,172,113,241,219,204,204,186,189,219,183,77,227,176,118,237,214,230,245,201,241,145,186,155,29,75,97,213,111,235,179,163,148,200,25,101,153,11,50,25,11,50,22,89,144,179,33,102,67,39,13,11,10,189,151,80,220,244,29,175,77,181,168,131,34,190,198,190,202,190,202,186,202,186,198,186,198,186,199,177,250,239,121,209,255,0,219,28,117,21,157,109,215,157,57,212,88,216,205,230,230,222,236,27,142,237,188,111,251,94,225,107,112,151,199,65,45,13,174,159,177,107,151,56,153,66,67,33,144,178,203,44,178,204,133,153,11,44,72,89,101,137,11,245,151,133,176,235,27,166,137,183,105,119,20,177,205,95,99,93,99,93,99,91,99,91,99,91,99,91,99,219,157,81,176,235,255,0,235,6,179,3,73,212,122,3,164,241,49,90,206,205,216,54,29,207,119,221,247,205,163,108,178,180,231,159,143,227,156,44,157,102,235,81,216,41,108,160,156,49,33,101,153,11,44,179,33,101,150,100,44,178,204,133,150,95,11,35,30,251,95,221,52,125,199,75,186,164,142,90,235,26,219,26,219,26,219,10,219,26,219,10,219,14,254,233,76,156,111,244,158,48,113,53,61,115,198,46,138,194,196,92,231,102,236,59,22,235,187,239,27,214,207,180,88,217,124,144,85,121,218,157,238,173,121,93,155,28,165,150,89,101,150,89,101,153,11,18,25,12,133,153,12,134,67,33,144,169,225,189,162,221,116,173,207,77,186,166,138,90,235,26,219,26,219,26,219,10,219,10,203,10,203,15,40,186,59,253,28,113,139,6,179,69,226,247,69,87,225,122,206,205,216,246,45,219,119,222,55,141,155,101,178,177,249,72,37,162,179,212,111,181,235,108,92,128,203,44,178,203,44,178,203,50,25,11,12,200,100,50,22,88,144,201,195,154,43,218,77,223,76,220,245,27,154,152,39,173,177,173,176,173,176,172,176,172,207,172,207,173,206,242,115,164,63,207,12,116,53,61,7,211,186,206,188,14,110,102,199,176,238,251,174,239,187,108,187,29,165,143,202,241,206,22,78,179,113,169,222,84,103,197,49,144,200,89,144,178,203,50,9,11,44,200,89,147,134,100,44,179,33,101,240,230,138,254,147,121,211,183,45,86,214,187,19,38,182,194,178,194,179,62,179,62,179,62,179,63,43,11,184,186,183,252,160,213,96,117,190,143,212,29,101,4,89,121,91,29,254,239,186,110,251,166,203,177,90,89,115,207,203,70,170,115,181,59,173,106,223,11,40,72,100,44,200,100,44,178,203,50,25,11,44,179,33,144,200,89,144,50,204,156,60,152,118,74,45,243,79,219,245,204,252,60,28,202,220,250,204,250,204,250,204,250,188,250,188,238,212,235,139,154,127,241,241,235,11,27,82,160,241,99,167,48,241,242,39,216,111,119,125,199,119,220,246,109,134,218,201,47,152,198,155,94,179,212,174,233,108,32,152,179,32,144,200,89,144,200,89,101,150,89,101,150,100,44,200,100,50,25,11,225,230,99,237,154,254,251,169,108,244,121,48,214,231,86,103,214,103,85,231,85,231,213,231,85,231,121,91,211,255,0,227,130,61,118,167,198,78,154,172,193,146,75,251,173,219,111,222,119,45,159,97,184,179,150,95,153,60,214,229,106,182,250,205,182,6,81,144,200,100,50,6,100,44,200,89,144,200,100,44,178,204,133,153,12,134,66,204,133,251,217,97,238,154,222,247,171,222,213,243,205,102,117,94,125,94,117,94,117,94,117,94,117,118,95,145,157,69,254,18,106,112,186,203,72,234,238,191,60,93,91,110,155,102,245,184,237,27,13,205,158,94,71,205,193,37,13,134,167,113,75,159,12,198,66,195,44,178,195,44,179,32,144,178,203,44,178,204,134,67,33,102,66,223,171,202,237,239,89,220,245,235,60,60,121,234,243,234,243,170,243,170,243,170,179,106,179,123,7,72,190,163,255,0,6,36,26,149,39,137,157,75,139,13,157,134,227,180,111,91,134,215,176,220,217,216,230,124,225,230,187,35,87,181,214,109,48,114,68,134,65,33,144,178,204,130,67,33,144,50,203,44,200,100,44,178,203,50,22,100,47,38,61,162,159,126,214,118,138,108,152,107,242,234,243,170,243,170,243,170,243,106,179,170,179,124,186,234,159,239,140,81,87,120,249,213,116,181,153,121,91,110,199,189,109,251,110,199,119,105,107,156,151,206,195,37,22,118,169,107,77,157,12,198,67,33,144,178,204,130,64,204,133,153,11,44,179,33,101,150,25,144,178,204,159,117,150,54,235,65,189,107,183,117,235,213,94,109,86,109,94,109,94,109,86,109,86,108,28,119,39,91,127,111,30,176,49,180,186,47,28,250,207,149,179,94,239,91,102,225,178,94,218,218,231,100,205,243,220,115,93,145,171,217,107,150,56,147,153,11,44,200,100,50,6,100,50,22,89,144,178,203,50,22,89,101,150,89,101,191,87,245,219,238,187,183,210,103,99,227,203,87,155,87,155,87,155,85,155,85,153,85,153,228,95,89,255,0,108,67,93,173,241,95,170,177,69,221,174,239,180,238,155,46,193,109,109,157,101,149,250,6,60,148,25,186,181,149,94,92,114,22,89,144,72,25,101,134,25,101,150,89,144,200,100,44,200,89,101,153,3,225,229,197,183,83,239,154,245,253,116,162,187,46,171,54,171,54,171,50,171,50,171,50,167,51,201,174,177,254,190,56,174,198,209,104,58,75,175,179,179,55,61,147,119,217,182,75,139,124,235,92,198,255,0,64,28,213,100,106,214,20,89,184,242,153,11,44,200,100,50,25,11,44,200,100,50,25,11,44,200,24,144,178,203,44,179,34,87,24,123,213,22,229,75,97,140,85,86,101,86,101,86,101,86,101,78,93,78,95,115,117,251,31,213,16,215,43,188,74,235,63,191,105,189,222,54,125,162,234,231,62,215,51,58,127,208,176,228,215,51,117,188,220,25,203,47,137,11,50,25,11,50,25,12,133,150,100,44,178,204,133,153,11,50,25,11,50,23,146,54,186,189,246,135,97,175,148,96,228,85,102,84,230,85,102,85,101,212,229,212,229,249,85,214,255,0,211,199,170,252,125,34,151,165,180,107,155,61,219,100,219,111,47,44,45,115,45,114,249,231,244,40,85,30,78,177,153,87,144,36,50,25,11,50,25,11,44,200,100,44,72,100,12,178,203,50,25,12,134,66,203,44,201,247,92,99,111,52,187,149,69,132,28,115,83,151,83,151,85,151,83,151,83,151,83,151,220,250,15,60,127,68,103,94,193,241,95,175,50,50,118,251,253,202,254,254,202,219,50,215,47,50,111,208,207,53,82,235,25,84,217,17,72,89,144,200,89,101,150,100,50,22,89,144,178,204,134,64,203,44,179,33,101,150,94,73,218,171,119,202,91,252,25,14,28,213,57,117,57,117,57,117,57,117,57,85,57,94,78,245,239,244,97,67,168,86,120,239,166,223,219,110,119,251,37,165,198,101,182,85,182,87,60,254,135,199,170,247,173,228,81,207,143,33,102,66,204,133,150,89,144,178,204,133,150,89,102,66,196,133,153,12,133,153,12,133,242,174,113,183,170,141,186,179,54,30,57,170,202,169,203,169,202,169,202,169,202,169,202,242,95,70,254,103,138,92,94,134,209,178,242,182,219,205,170,222,235,54,219,42,219,43,54,111,209,112,249,215,165,161,155,22,67,33,97,150,25,101,137,12,134,66,203,50,25,12,133,150,89,101,153,12,134,66,203,47,44,109,213,219,205,77,206,43,227,10,106,156,170,156,170,156,170,140,170,156,170,185,187,131,69,254,88,227,92,196,241,27,81,191,182,219,110,47,179,237,242,173,178,109,178,185,231,244,92,95,84,78,134,76,57,11,44,178,204,134,64,196,134,66,204,133,150,25,101,150,89,102,66,203,50,22,100,50,46,111,241,119,170,189,159,7,32,113,205,70,85,78,85,78,85,70,77,78,77,70,79,153,154,79,241,227,213,124,90,166,6,187,83,179,91,236,118,55,25,86,217,54,217,54,51,126,141,141,234,147,154,23,137,33,101,150,25,101,150,100,12,200,100,44,178,204,133,150,89,144,200,89,102,67,33,144,201,195,178,143,115,175,220,171,172,97,245,93,61,70,77,70,77,70,77,70,77,70,78,207,174,103,97,127,3,197,96,241,83,87,186,178,216,236,174,242,237,242,109,242,109,242,100,95,163,99,250,165,230,137,225,200,89,144,200,100,44,178,204,134,67,33,144,200,89,144,200,100,50,22,88,144,177,33,144,200,100,44,185,253,108,248,155,205,109,230,51,226,39,81,147,81,147,81,145,81,147,81,145,81,145,229,118,153,252,35,245,132,252,80,215,47,108,111,179,46,50,45,242,45,242,109,178,63,71,199,245,79,205,27,196,97,153,12,133,153,12,133,153,12,134,66,196,133,153,11,44,178,204,133,150,89,144,200,89,102,78,85,220,59,197,126,205,137,144,125,85,79,81,147,81,145,81,145,81,147,81,145,229,198,161,252,7,52,248,120,21,215,89,151,57,54,249,22,243,219,228,102,73,250,60,30,170,61,82,172,86,89,102,66,204,134,66,203,50,22,88,144,200,100,44,200,89,101,153,11,44,179,33,144,178,203,177,59,142,30,223,135,159,31,172,57,42,50,42,50,42,50,42,50,42,39,177,168,180,173,250,241,207,138,122,189,198,77,198,77,198,69,188,246,249,22,249,11,159,209,224,245,83,205,58,197,144,178,203,50,25,11,44,176,203,44,179,33,102,66,204,134,66,204,134,67,33,101,153,11,44,201,145,206,209,141,186,225,91,195,207,163,205,68,245,19,212,100,84,79,81,61,60,254,86,106,159,195,195,29,98,222,123,121,237,231,183,158,222,123,105,191,72,131,213,79,170,149,140,203,50,22,100,50,22,89,101,150,89,144,200,89,144,200,25,102,66,204,133,150,100,50,25,12,134,68,175,162,221,241,47,160,124,122,170,154,162,122,137,234,38,168,158,158,127,51,181,175,225,213,218,229,196,246,243,92,79,113,61,196,249,146,126,145,7,170,175,85,92,227,179,33,144,200,100,50,22,100,44,176,203,50,22,89,102,67,33,102,66,204,133,153,12,134,67,33,101,240,237,206,233,141,178,65,144,125,97,73,81,61,68,244,243,212,77,79,63,104,107,159,94,179,214,174,38,184,154,222,107,121,173,230,183,157,243,250,68,30,170,253,86,44,118,100,50,22,100,50,25,12,133,153,12,134,67,33,102,66,203,12,179,33,144,72,89,102,64,204,134,66,203,176,245,183,65,181,65,152,125,70,170,39,167,154,158,106,137,170,38,168,151,179,117,191,167,135,58,237,196,215,19,92,77,111,53,188,214,243,126,147,7,170,206,107,185,129,153,4,134,67,33,97,153,12,133,150,89,144,200,89,144,200,36,44,177,32,144,200,89,102,66,204,133,153,50,249,218,35,219,161,177,63,74,137,169,230,167,154,158,106,137,169,229,243,27,95,250,120,91,69,113,45,188,183,19,92,75,113,53,156,159,164,193,234,183,213,122,133,134,89,101,150,89,144,200,89,144,200,100,44,176,203,44,200,88,144,200,36,50,22,36,44,179,33,146,101,177,29,190,43,65,244,172,146,158,106,121,169,229,167,150,158,95,52,168,126,157,5,75,111,45,196,183,18,220,75,113,46,99,253,38,15,85,222,176,84,82,25,4,133,150,100,44,72,89,144,200,100,50,22,89,144,200,36,50,25,3,50,6,89,98,66,203,44,54,239,189,110,17,219,158,126,152,106,158,90,121,105,229,167,150,158,94,254,165,245,12,48,87,220,73,113,45,196,183,18,220,75,39,63,164,193,234,191,156,37,27,50,22,89,101,150,36,44,200,100,12,179,33,102,66,204,134,66,204,134,64,204,133,150,36,44,179,39,46,239,214,224,46,74,250,69,205,60,180,242,211,203,81,45,60,147,87,207,7,77,83,220,73,113,37,196,151,18,92,75,113,39,63,165,65,235,3,214,34,142,66,203,50,25,12,133,153,11,44,177,33,102,66,203,50,9,11,50,22,89,102,67,33,144,200,36,44,191,190,227,157,187,139,190,31,211,143,84,242,83,201,79,37,60,148,242,83,201,220,52,254,36,212,220,73,113,37,196,151,18,92,73,110,255,0,74,135,214,23,56,168,51,33,144,178,203,44,200,89,101,153,11,50,25,12,134,65,33,101,150,89,144,200,89,144,179,33,101,253,246,171,108,245,119,195,250,212,73,79,37,60,148,242,83,201,79,39,150,245,94,18,86,220,59,135,112,238,36,184,146,209,126,149,23,172,62,113,216,101,153,4,134,66,203,44,179,33,101,150,89,144,179,33,98,64,203,18,9,11,44,178,204,134,66,248,118,143,107,230,239,212,191,90,167,79,37,59,167,116,238,158,79,54,235,124,41,175,185,119,14,225,220,59,135,96,191,74,143,214,47,48,48,203,44,200,89,144,72,89,144,200,100,12,179,33,101,150,100,44,177,33,102,64,204,133,137,12,134,66,248,118,114,109,42,235,153,62,181,202,157,211,58,119,78,233,223,154,213,254,36,225,92,59,135,112,174,29,194,204,231,244,168,253,99,40,89,101,150,100,18,22,89,144,179,33,144,200,100,44,72,89,144,179,33,144,200,100,50,25,11,50,25,12,134,67,39,18,89,203,180,73,112,159,215,15,154,119,76,233,149,59,167,126,90,224,248,239,137,112,174,21,194,184,87,15,35,159,210,135,168,20,76,200,89,101,150,100,50,25,12,133,150,100,44,200,100,12,200,89,97,153,11,44,179,33,102,65,33,144,201,249,44,229,217,165,182,75,235,143,205,58,166,84,202,157,83,175,34,49,122,163,26,225,92,43,133,113,205,194,151,244,177,234,37,27,18,22,100,50,22,89,102,66,204,134,67,33,144,178,203,44,200,88,144,178,203,50,22,89,144,176,204,156,201,105,54,201,45,154,95,88,185,167,84,234,157,83,170,117,218,248,218,148,23,60,220,115,113,205,207,55,41,254,151,199,49,160,196,133,153,11,50,22,100,50,22,25,144,200,100,44,179,33,102,67,33,98,67,33,144,51,33,101,150,89,145,73,107,54,197,53,130,231,234,61,83,170,117,78,169,213,55,59,108,56,177,92,115,115,205,199,55,60,220,242,191,179,136,121,28,241,243,135,147,201,101,150,89,97,150,89,144,72,89,101,153,12,134,67,33,147,137,12,133,153,12,133,134,100,50,22,100,44,201,44,214,249,55,211,230,47,169,245,79,205,63,52,252,211,115,79,206,92,89,70,227,155,159,87,28,220,243,113,235,159,234,135,28,99,34,130,60,159,156,227,158,17,101,150,89,144,72,100,50,6,89,144,178,204,134,64,204,134,67,33,102,66,204,133,134,100,44,179,39,229,202,203,185,207,183,202,157,125,79,170,111,84,222,169,185,167,230,159,214,41,184,245,113,234,227,213,199,171,143,87,30,185,254,142,56,198,171,230,52,17,69,4,81,249,206,23,28,148,89,102,64,195,50,22,100,44,178,204,133,150,100,50,22,89,144,178,204,133,137,11,44,201,46,77,141,149,189,150,110,67,231,235,199,170,111,84,254,169,189,83,250,167,230,159,213,199,171,159,87,30,174,61,92,250,184,227,159,231,139,135,139,90,138,40,32,202,8,34,135,60,124,231,11,133,195,44,50,203,50,22,100,44,178,204,134,66,196,134,65,33,102,66,203,12,200,89,149,228,102,216,90,90,103,102,73,39,240,62,169,189,83,241,79,234,155,213,63,170,127,89,74,231,213,199,23,28,92,113,115,199,63,202,178,142,60,100,81,69,20,80,69,20,80,67,147,243,156,115,199,37,22,88,101,150,89,101,153,12,134,67,33,144,179,33,102,65,33,144,200,95,18,44,140,188,251,27,60,220,217,101,231,159,225,199,170,127,84,220,83,241,79,197,63,24,171,18,91,142,46,120,184,226,231,139,142,23,240,2,167,90,65,20,16,65,4,80,69,4,16,65,30,79,206,240,184,231,134,89,102,67,33,144,200,100,44,200,24,144,178,203,44,200,100,47,137,22,70,78,118,125,142,102,108,178,243,207,241,62,169,248,167,226,159,138,126,41,248,202,151,82,154,231,139,158,46,56,184,226,224,191,174,22,13,77,2,40,162,138,8,34,138,8,160,130,40,160,135,39,231,120,231,133,194,225,150,89,102,66,203,44,200,89,144,179,33,144,200,100,226,85,145,62,110,109,134,86,100,146,243,207,242,30,169,248,167,52,252,83,241,76,118,217,250,163,38,228,220,27,131,112,110,56,151,233,75,67,129,84,138,8,160,138,8,162,130,8,34,130,40,160,138,40,243,199,206,241,207,28,240,139,44,200,25,101,150,100,50,25,12,133,153,12,139,34,124,220,172,252,156,185,36,231,159,231,15,20,230,156,211,154,115,78,123,95,39,199,108,187,147,112,110,69,193,184,51,241,173,234,112,226,32,138,60,148,80,69,4,16,65,20,121,40,32,143,33,20,81,231,143,158,225,113,207,15,134,89,144,200,100,12,178,203,50,113,42,200,155,51,39,50,108,133,39,60,255,0,70,63,20,230,156,211,154,99,78,124,136,203,241,43,58,224,92,11,129,112,46,70,191,164,126,36,16,65,20,17,67,144,130,8,162,138,8,160,130,40,34,138,8,242,126,123,142,120,231,133,195,44,179,33,102,66,204,156,76,178,37,203,155,42,73,146,254,172,62,41,197,56,167,20,226,156,121,109,157,225,77,133,192,184,23,2,224,85,104,249,209,160,130,40,160,138,8,34,138,8,160,138,40,160,138,8,32,138,8,160,143,60,124,247,28,241,207,8,178,203,47,137,63,50,200,147,38,73,220,156,243,253,117,198,156,83,138,113,78,41,199,154,214,30,18,89,92,11,129,111,21,94,155,105,29,148,72,162,130,40,162,138,40,162,138,8,32,138,40,242,16,65,4,16,65,20,81,231,143,159,227,158,23,12,179,39,18,243,51,153,73,203,231,159,236,170,20,226,156,83,138,113,78,60,219,178,241,34,214,226,59,120,170,245,75,56,173,34,180,137,20,80,69,20,17,69,4,17,65,20,81,65,4,81,65,20,17,69,20,16,228,115,199,207,241,207,28,240,190,255,0,201,203,229,115,207,247,84,71,79,29,60,116,241,211,71,79,31,150,246,221,59,113,113,29,102,181,103,29,156,86,145,90,66,194,40,34,138,40,160,130,40,160,130,28,148,80,69,20,16,65,4,17,69,4,17,228,254,129,247,125,223,119,191,247,241,234,158,58,120,169,227,167,142,158,58,120,251,150,226,9,245,40,44,163,179,138,206,43,72,109,33,154,52,81,65,20,80,69,20,17,69,30,66,40,162,130,8,162,138,40,160,138,28,148,16,67,158,63,81,139,138,120,170,35,167,138,158,58,120,230,177,154,111,94,42,95,217,69,101,21,156,86,112,218,67,149,18,40,32,130,8,32,138,8,162,138,8,32,138,40,162,130,40,162,138,8,162,130,40,35,207,31,168,97,138,120,169,226,167,138,158,42,120,251,250,235,233,255,0,231,222,199,101,21,148,86,81,89,195,103,13,132,40,162,138,40,34,138,8,160,130,8,162,130,8,32,138,8,162,130,8,162,138,40,178,140,135,245,10,184,233,225,167,138,158,26,120,169,226,243,78,247,233,224,110,203,99,21,140,86,80,217,67,101,13,156,40,34,130,40,162,130,12,162,130,40,160,138,40,32,130,8,34,138,8,242,17,69,4,16,200,227,245,10,136,105,225,167,134,162,26,120,105,225,243,27,98,250,116,110,207,99,21,140,86,48,217,67,101,5,156,18,70,138,8,162,130,8,162,138,40,34,138,40,34,138,40,34,135,33,20,81,69,20,17,71,44,254,159,25,168,134,162,26,120,105,225,168,134,158,30,204,217,126,144,203,215,187,13,140,86,48,216,195,99,5,148,25,113,32,138,40,34,130,8,160,138,8,34,138,40,160,138,40,162,138,40,34,130,8,33,200,206,63,167,225,71,81,13,60,20,240,212,65,79,7,104,236,95,195,194,61,170,198,27,8,108,97,177,130,202,11,24,17,65,20,16,69,20,81,65,4,81,65,4,80,69,20,80,69,4,81,65,20,121,40,216,159,211,234,97,168,130,162,10,120,42,32,168,131,204,237,159,248,120,25,184,88,67,97,13,140,22,48,89,65,101,142,227,65,20,57,8,160,138,40,162,138,40,162,130,8,32,138,8,160,138,8,160,130,40,217,159,211,143,20,248,245,24,245,24,245,16,84,65,81,7,149,155,95,240,232,109,139,27,58,194,27,8,108,96,178,130,203,31,42,36,17,69,4,80,65,4,80,65,4,81,65,20,81,69,20,16,65,4,17,71,146,133,177,253,59,14,58,140,122,140,122,140,122,140,122,140,123,27,123,75,47,225,87,159,227,246,209,97,13,132,54,16,88,227,217,99,216,192,130,8,33,200,65,20,80,69,20,17,69,4,16,69,132,81,69,4,81,65,4,57,23,3,244,234,168,42,113,234,49,234,49,234,49,234,32,242,227,111,254,94,17,239,153,240,216,65,97,5,142,61,142,61,142,52,177,162,130,40,162,130,40,32,130,8,32,138,40,34,138,8,162,130,40,32,138,40,220,31,211,99,21,24,213,24,213,56,213,24,213,24,181,24,190,87,238,31,203,199,125,166,162,215,62,12,248,44,32,176,199,176,198,205,129,20,17,65,20,16,69,4,81,228,160,138,40,34,130,8,34,130,40,162,138,40,91,159,211,107,160,168,198,168,198,168,198,166,196,166,192,217,175,44,231,95,202,174,199,198,173,211,62,12,248,51,224,176,199,176,199,176,198,65,4,80,69,4,81,69,20,17,69,20,57,40,34,138,40,34,138,8,32,130,22,195,244,195,197,78,45,70,45,70,53,54,37,5,109,37,79,152,187,70,112,127,207,195,206,202,205,139,62,12,248,51,241,236,49,172,49,178,161,69,20,80,65,4,16,65,4,17,65,20,17,65,20,80,65,20,17,65,20,108,199,233,152,80,212,226,212,226,211,226,107,213,154,213,29,125,111,120,109,182,77,127,62,187,218,186,143,100,207,131,63,31,63,30,195,26,195,30,195,25,132,17,65,20,80,69,20,16,69,4,16,65,4,81,69,4,16,65,4,17,205,143,244,190,56,169,197,169,196,168,196,215,235,53,42,13,126,143,200,141,175,103,203,204,151,250,60,44,237,140,232,51,177,243,241,236,49,172,49,172,49,114,161,69,20,81,65,4,16,65,4,81,65,20,16,65,4,80,67,147,200,65,4,101,139,244,188,40,106,113,42,48,232,107,53,29,123,83,215,49,43,252,166,223,246,12,217,23,244,117,102,227,161,108,185,208,103,99,231,227,216,99,103,227,88,98,176,138,8,162,138,40,34,130,40,34,130,40,34,138,8,160,130,40,34,130,57,3,244,147,197,86,37,70,29,21,102,165,174,233,154,181,69,71,116,238,219,181,197,142,71,245,120,61,220,25,216,249,216,249,216,217,216,217,248,217,248,185,112,34,130,44,162,138,40,34,130,40,162,130,8,162,138,40,162,138,40,160,133,188,127,164,224,193,83,135,69,89,169,107,154,78,165,174,80,49,229,175,101,236,150,82,191,234,208,182,254,182,220,243,177,243,177,243,177,179,177,179,241,115,241,100,141,20,81,69,4,81,65,4,16,97,4,81,65,4,81,69,4,89,65,13,166,47,210,0,170,194,162,171,212,181,189,31,80,213,53,184,49,123,187,176,183,171,251,28,158,127,179,193,158,236,206,199,205,198,206,198,206,198,206,197,206,197,205,198,65,20,81,65,20,81,65,4,81,65,4,16,65,4,80,69,20,17,71,125,199,253,34,179,14,138,171,82,214,116,125,59,81,213,235,240,51,102,242,159,181,118,59,57,95,246,86,216,248,229,219,185,184,217,216,217,184,217,184,217,216,185,216,147,195,200,65,20,81,69,4,17,69,4,16,228,162,130,40,160,130,40,162,143,97,225,126,143,139,5,13,70,163,171,232,218,86,161,170,84,214,78,188,140,236,205,210,247,63,35,251,188,94,238,231,206,110,54,110,54,110,54,110,54,118,46,118,43,141,20,25,65,4,80,69,4,80,69,22,80,65,20,80,65,20,17,216,43,255,0,70,142,58,26,109,67,84,209,116,141,71,83,166,169,224,222,90,121,9,218,151,214,82,63,239,240,67,190,115,49,243,113,179,113,179,113,179,177,115,113,115,49,145,69,20,80,71,144,130,40,160,138,40,34,130,40,162,138,40,32,134,211,91,250,33,20,84,218,118,161,162,232,186,134,165,79,81,12,89,185,30,89,246,214,217,119,151,63,248,53,141,151,167,59,75,55,31,51,27,55,27,55,23,55,23,59,19,38,4,80,101,4,80,69,4,17,65,6,81,65,4,16,67,146,138,40,118,69,79,232,98,58,106,125,47,75,209,52,45,75,82,167,169,198,130,121,123,71,176,59,55,119,182,206,92,255,0,135,196,254,250,147,140,204,108,220,92,204,92,220,92,220,76,220,73,98,69,20,80,69,20,81,65,20,17,65,20,16,69,20,81,65,28,252,44,252,47,208,98,138,162,155,73,209,180,77,3,84,212,170,106,177,113,249,230,211,59,201,190,229,216,237,166,147,252,126,11,249,9,153,141,153,141,155,139,153,139,155,139,155,137,155,136,227,65,20,81,69,20,80,69,4,17,69,20,17,65,20,16,65,14,204,164,249,254,56,135,30,158,139,71,208,116,109,3,88,213,106,235,49,113,207,25,153,62,83,247,30,219,127,155,147,207,63,227,165,184,241,211,187,243,49,179,49,115,49,115,49,115,113,51,112,242,241,16,69,20,17,67,144,138,8,160,138,8,34,138,40,34,130,40,219,86,103,97,252,233,56,184,116,122,230,141,215,218,70,129,174,107,21,213,216,208,70,50,38,237,254,205,236,141,222,219,61,175,242,244,143,111,106,27,110,102,54,94,46,102,38,102,38,102,38,110,38,94,42,8,160,138,40,162,130,8,34,130,40,34,130,8,34,138,8,246,118,191,243,145,197,131,91,175,106,154,63,93,233,154,29,6,187,129,131,141,4,49,74,246,109,135,191,59,138,250,218,105,63,195,199,31,95,111,111,17,60,138,50,101,226,230,98,230,98,230,98,102,97,230,97,229,99,34,138,40,32,143,33,4,16,65,4,17,69,20,16,65,4,115,48,239,169,254,103,142,33,199,172,165,214,180,205,35,174,181,45,30,154,139,15,11,30,8,98,74,195,55,202,30,245,217,175,114,178,63,209,237,225,119,147,25,16,101,226,229,226,229,226,102,98,102,97,230,97,228,99,32,130,8,163,200,69,20,16,103,144,138,40,160,130,40,34,143,98,107,95,48,70,46,13,46,183,170,232,186,103,94,107,26,125,93,70,46,46,60,16,195,235,55,47,201,222,245,219,54,60,252,197,207,250,113,178,124,71,242,95,47,23,47,23,47,19,47,19,47,19,51,15,51,11,39,23,146,138,40,160,130,8,162,138,40,34,138,40,162,130,8,35,216,58,199,202,241,196,80,87,212,107,250,126,167,160,106,58,5,6,175,129,89,141,141,4,16,67,199,25,121,61,255,0,221,155,182,221,103,96,215,250,245,237,131,198,143,33,114,241,114,241,114,177,50,177,50,240,242,240,242,240,178,49,145,65,20,16,65,20,80,65,20,16,69,4,80,69,20,111,233,44,107,254,76,199,141,131,79,173,235,58,46,167,215,218,198,145,79,65,135,131,6,60,16,65,9,57,89,29,199,219,189,147,216,118,214,146,63,246,232,155,215,65,247,166,86,46,86,46,86,38,86,38,94,30,94,30,94,22,86,35,8,162,138,8,34,130,8,32,130,8,162,138,8,160,135,101,234,95,35,193,139,26,186,150,131,78,213,122,251,87,208,168,53,58,234,140,108,88,32,134,8,33,39,34,126,211,236,238,219,237,107,155,121,165,255,0,47,31,213,214,61,153,210,157,215,149,139,149,137,149,137,149,135,151,137,151,135,151,133,149,134,227,69,20,81,65,4,80,69,148,16,65,4,16,69,4,59,23,81,248,248,225,196,172,166,213,181,173,11,86,235,221,127,76,168,215,176,235,224,199,130,8,32,134,16,103,159,178,59,35,185,123,130,242,234,121,191,207,199,63,211,213,253,161,210,221,213,145,143,149,137,149,137,149,135,149,135,149,133,149,133,149,133,36,72,160,138,40,162,130,40,162,138,40,162,130,8,163,109,85,176,209,124,96,143,31,2,175,93,215,180,125,95,175,53,205,18,159,89,175,168,199,196,135,30,8,33,130,24,73,159,35,177,251,35,184,251,146,246,239,34,126,121,255,0,71,28,255,0,79,89,118,127,70,119,220,240,100,226,229,98,101,97,228,225,229,97,101,224,229,96,207,140,130,8,162,138,40,161,200,69,4,17,65,20,81,67,120,212,102,135,226,72,131,14,186,134,143,76,214,122,247,90,235,250,77,74,186,147,19,2,12,104,113,225,130,24,33,135,131,147,147,217,221,165,220,61,203,121,123,60,252,243,240,154,54,247,227,223,146,114,199,145,143,147,137,149,135,149,135,149,133,149,133,149,131,145,134,227,69,20,81,69,20,16,65,20,81,69,4,80,67,180,52,175,135,224,67,137,129,71,75,167,107,157,125,173,117,229,22,151,91,65,135,91,6,44,48,67,4,48,67,143,20,62,217,57,125,187,220,125,171,219,119,87,147,207,207,63,13,69,125,227,119,150,207,212,209,79,143,147,137,147,133,149,133,149,133,149,131,149,131,54,58,40,32,130,8,160,130,8,162,138,40,34,138,29,147,164,124,33,16,226,96,210,83,233,250,247,95,107,157,117,67,163,214,107,152,149,144,97,195,143,22,60,48,67,143,14,60,80,242,178,243,123,179,191,251,15,178,110,46,166,159,226,96,155,199,31,50,161,204,124,75,20,248,217,56,153,56,89,56,57,88,57,56,57,24,82,68,138,60,158,66,40,114,121,8,160,130,8,162,142,110,22,235,168,124,9,142,28,44,26,42,141,58,131,175,181,206,185,162,209,107,53,156,74,184,48,161,198,135,30,28,120,177,226,199,134,1,27,151,51,63,189,60,158,219,183,123,75,105,102,248,14,63,179,160,252,168,212,119,174,100,124,77,20,248,217,24,153,56,89,56,57,56,25,56,19,98,48,138,40,160,130,40,34,130,40,34,138,55,180,123,38,187,254,222,8,135,30,187,3,93,167,210,232,58,243,94,235,154,61,18,175,88,196,170,131,14,44,104,177,226,199,139,30,44,120,113,226,131,142,38,201,216,118,126,245,242,131,100,218,236,44,228,147,224,184,231,250,250,211,181,250,111,200,190,50,121,145,250,150,41,177,231,196,200,194,201,193,201,192,201,192,151,21,132,17,69,4,16,65,20,80,65,4,123,90,147,253,102,56,241,113,105,235,181,106,125,22,135,174,168,58,230,151,70,173,214,113,106,225,195,139,26,44,120,177,226,199,139,30,44,120,160,60,60,156,171,126,201,238,94,224,239,203,221,155,51,57,63,144,194,206,233,127,48,171,47,120,201,230,85,234,72,230,130,124,76,140,60,140,28,140,12,138,249,177,24,71,144,138,8,162,130,8,162,133,254,15,250,56,3,30,10,220,61,118,179,78,165,235,250,46,183,164,235,186,141,43,3,93,199,173,139,14,60,88,241,163,199,143,26,44,120,160,142,62,19,205,202,187,177,217,251,103,202,77,203,177,109,47,114,50,185,231,159,134,227,159,236,235,14,236,234,254,250,57,135,39,243,114,153,150,25,177,166,196,159,10,124,12,138,249,176,156,72,32,138,8,160,138,8,35,125,133,254,78,0,199,134,187,22,130,191,81,169,208,233,122,230,147,173,233,244,10,205,71,14,138,12,8,177,35,198,143,26,60,104,241,163,128,14,31,57,50,217,229,236,54,27,110,237,219,221,167,228,69,198,209,153,102,229,231,159,92,252,71,31,217,141,149,213,158,88,235,59,161,203,57,95,157,72,253,73,28,176,77,139,54,36,248,51,224,205,129,46,43,141,4,80,65,20,17,237,76,47,240,123,113,16,196,134,175,23,94,192,212,107,52,58,142,185,166,235,106,126,188,172,210,176,117,172,90,136,112,99,196,24,177,227,136,8,60,241,63,57,142,206,123,220,205,166,199,117,184,223,247,255,0,36,118,93,239,62,230,108,174,87,204,235,27,135,92,121,95,95,114,114,184,202,255,0,167,243,114,215,169,35,146,9,49,165,195,155,10,108,9,176,36,196,113,32,130,8,119,182,15,246,125,188,68,113,35,173,130,139,19,87,193,210,235,52,10,158,183,168,235,74,174,186,173,210,48,53,108,90,40,107,99,195,16,24,207,174,36,255,0,167,156,213,103,37,204,215,249,59,78,110,231,99,190,89,246,6,221,221,219,127,104,230,221,79,152,164,254,30,255,0,21,199,63,219,165,118,110,133,229,38,37,151,25,28,100,241,147,196,252,204,154,244,196,144,201,143,38,44,184,114,224,205,129,38,11,198,113,119,213,127,211,219,219,219,219,237,251,56,132,226,10,232,233,224,215,177,181,92,61,47,3,65,174,235,154,206,180,171,235,90,206,190,175,210,240,181,156,106,72,112,68,124,63,207,255,0,87,253,202,201,219,201,119,46,195,62,207,147,182,229,238,185,219,237,143,97,216,246,22,193,218,123,31,103,229,91,205,152,229,231,159,225,207,63,39,207,244,105,189,147,164,249,77,89,115,196,220,79,249,255,0,55,51,115,42,75,148,92,110,25,49,164,196,147,10,76,14,218,215,221,63,52,255,0,248,255,0,248,252,83,10,65,65,22,183,14,173,143,168,98,233,88,122,30,15,95,87,245,229,127,95,215,232,216,58,134,38,185,141,81,14,36,107,140,207,253,30,109,57,183,87,110,250,77,138,93,158,109,179,35,112,201,221,178,247,172,205,251,59,176,51,247,252,237,230,219,127,182,223,39,177,147,37,75,202,254,60,243,241,254,255,0,221,175,109,154,127,149,58,183,96,254,79,203,249,191,55,229,230,79,191,223,215,35,152,121,198,231,14,250,143,138,83,64,117,193,172,69,170,67,168,99,233,184,250,94,46,153,139,167,226,234,216,186,246,53,70,62,20,38,60,131,101,197,207,55,252,236,107,102,123,68,155,92,155,116,187,140,219,172,219,198,70,245,145,189,228,239,121,91,214,94,241,149,187,101,110,57,59,86,110,221,153,178,73,148,230,82,114,190,99,223,250,185,254,48,79,170,121,5,171,121,33,131,103,204,159,151,243,254,126,39,226,126,38,226,110,38,226,94,37,184,17,100,197,149,22,92,57,176,231,195,103,21,180,87,81,95,199,178,13,167,141,187,141,199,157,213,110,203,119,91,195,222,30,243,38,243,46,243,46,241,46,239,54,235,54,233,54,229,62,223,62,219,145,181,207,179,205,177,77,123,53,220,217,220,203,204,156,191,127,227,207,175,127,149,247,255,0,5,69,254,181,228,182,187,228,22,38,119,60,242,249,155,243,255,0,213,255,0,95,25,188,103,118,158,124,119,177,223,141,132,108,99,101,59,65,218,142,214,118,222,54,223,254,187,255,0,174,255,0,235,185,219,121,219,121,219,86,216,182,181,181,61,166,77,162,77,153,236,178,108,114,108,18,95,73,118,237,221,138,205,89,28,175,187,151,202,247,254,94,254,255,0,165,85,221,80,121,19,69,228,149,54,222,138,225,122,229,75,62,241,180,113,159,197,137,179,54,166,223,139,142,46,120,186,226,235,255,0,111,255,0,111,255,0,107,155,190,110,249,186,230,231,155,158,109,213,183,54,170,207,155,21,157,206,95,57,28,203,247,253,125,249,95,119,191,243,231,159,155,247,255,0,31,10,147,180,41,188,150,168,239,204,222,218,236,158,234,254,30,254,255,0,119,221,247,254,79,201,249,127,47,228,252,159,147,239,251,190,239,127,127,225,237,237,235,223,238,247,253,39,223,223,251,248,255,0,103,183,211,223,223,238,247,254,175,127,131,255,196,0,80,16,0,1,3,1,4,7,3,9,5,5,4,9,4,1,5,0,1,0,2,3,4,5,17,33,50,6,18,34,49,65,81,97,7,35,161,16,19,20,32,48,64,66,96,113,80,82,83,129,145,21,67,98,114,130,22,51,146,177,36,52,99,115,162,163,178,193,195,37,147,179,194,209,38,53,68,84,100,255,218,0,8,1,1,0,3,63,0,251,52,157,193,61,220,19,221,118,202,145,223,10,123,174,216,78,63,2,56,108,39,72,224,198,64,92,242,112,107,91,121,90,71,89,170,96,176,43,11,14,231,190,19,27,127,196,251,130,210,89,46,243,240,82,82,143,246,243,180,255,0,241,107,162,208,61,55,72,41,34,231,230,98,116,191,245,22,45,20,134,239,76,183,106,229,231,230,88,200,127,234,215,93,156,211,97,35,43,42,46,252,106,139,191,248,195,23,102,116,249,116,122,23,28,113,150,121,164,240,115,215,103,240,96,205,21,178,79,251,218,102,75,255,0,88,43,68,97,188,65,163,182,68,127,201,71,11,127,201,170,199,139,24,172,250,54,114,213,133,141,255,0,32,169,90,3,88,200,154,222,65,160,47,246,222,43,253,183,138,164,120,213,116,113,57,167,120,45,4,43,22,127,239,172,218,41,47,223,175,4,110,221,245,11,66,234,175,21,58,45,98,74,14,111,59,65,3,239,253,90,187,48,171,191,207,104,77,136,47,252,42,72,225,255,0,227,13,93,143,86,95,231,52,70,6,56,241,130,170,166,47,6,72,2,236,154,178,255,0,50,45,90,75,247,122,53,96,117,223,79,62,201,22,135,207,127,236,221,48,180,169,249,122,84,49,84,254,186,158,105,90,226,255,0,217,58,105,102,212,114,244,184,37,165,255,0,227,51,46,212,40,131,157,75,69,103,218,33,191,255,0,74,181,130,241,208,84,121,165,218,53,143,172,234,253,11,181,219,27,111,214,150,26,103,207,24,250,190,29,102,169,96,145,209,77,27,227,149,185,153,32,45,112,250,131,242,249,114,115,184,39,191,225,41,238,187,101,56,221,123,22,235,216,173,139,71,84,209,89,53,18,180,252,98,50,25,254,39,92,21,170,224,215,87,79,71,70,222,45,123,252,227,255,0,72,239,30,43,69,232,238,54,133,169,81,80,71,195,11,91,11,124,117,202,208,75,51,251,155,22,158,71,13,238,168,115,166,191,242,121,33,89,214,123,11,40,160,130,157,159,118,6,54,49,135,70,220,154,47,239,124,85,215,247,190,40,227,223,120,167,227,223,120,169,13,253,247,138,149,215,247,222,42,67,127,123,226,164,63,188,82,31,222,39,254,33,79,252,68,255,0,196,79,252,66,159,248,137,255,0,138,158,63,122,156,46,239,19,191,21,28,59,213,187,189,241,91,187,213,187,189,241,86,53,179,24,134,215,179,232,235,161,186,239,55,89,3,39,111,233,32,43,178,11,122,243,81,162,52,148,210,187,115,236,231,190,142,239,163,33,115,89,224,180,50,184,57,214,6,149,218,52,18,29,204,173,142,58,200,239,228,53,60,201,1,118,129,66,31,37,139,89,101,218,241,98,90,200,103,52,211,159,171,103,13,111,252,75,77,244,95,93,214,254,139,90,84,112,55,125,67,224,115,169,240,229,51,47,97,253,125,65,242,161,41,238,59,147,222,114,167,56,139,218,137,186,246,41,170,100,100,52,244,207,150,103,110,100,109,47,113,250,0,173,170,128,215,84,67,21,28,95,122,169,247,59,252,13,188,173,27,161,13,117,163,104,77,82,241,189,145,1,11,47,229,241,21,163,22,48,31,179,236,170,88,222,221,210,57,190,114,65,253,114,94,80,23,221,42,223,222,163,143,125,226,157,143,122,158,111,186,85,33,191,189,82,59,247,170,67,251,197,35,190,50,164,63,17,82,125,228,243,241,39,253,228,254,105,252,211,254,242,127,222,79,230,159,247,138,147,239,39,143,137,60,124,74,65,241,167,143,141,72,46,219,79,31,188,79,23,119,137,194,238,241,56,93,222,248,163,135,122,183,119,171,47,122,187,52,210,224,231,91,186,35,102,205,59,239,214,168,134,63,70,168,36,243,150,13,71,21,161,182,158,188,218,45,164,181,182,100,199,17,5,99,27,91,7,209,164,121,183,180,125,75,151,105,214,22,188,180,86,117,61,181,70,49,243,182,84,193,239,255,0,217,151,81,228,244,104,42,209,178,170,100,161,181,40,106,40,235,89,158,10,168,157,12,173,191,155,94,1,31,40,148,74,123,248,20,247,93,178,156,110,189,137,243,61,145,197,3,159,35,176,107,24,210,231,31,160,10,212,156,50,74,166,197,71,14,251,234,13,207,187,163,27,143,235,114,209,107,40,7,85,185,245,179,15,190,124,220,127,147,88,111,253,74,160,179,162,48,217,244,240,211,197,247,97,96,96,63,91,183,163,143,122,137,214,239,124,83,141,253,234,121,191,188,82,58,254,241,74,226,118,202,149,215,237,21,43,190,37,35,190,34,158,120,167,167,39,39,39,34,157,213,57,20,81,69,57,57,20,228,238,105,220,211,199,20,241,197,60,124,74,65,118,210,145,183,109,148,246,221,222,20,241,119,120,156,46,190,68,112,239,81,195,189,90,63,164,212,162,135,72,172,154,27,74,147,132,85,176,50,118,131,205,186,224,220,122,133,217,166,145,7,207,163,213,53,90,63,90,236,64,133,198,170,146,243,206,41,142,183,232,240,23,105,26,60,217,106,108,202,104,45,234,6,156,31,101,188,154,141,94,110,129,247,60,158,140,214,85,150,125,68,148,149,244,147,83,85,198,117,100,134,118,58,41,24,121,57,174,184,143,32,249,32,121,75,147,159,193,57,215,108,173,215,181,90,54,136,107,169,105,29,230,120,204,253,136,176,254,35,189,88,244,0,73,107,86,25,228,24,152,160,216,103,230,227,137,240,86,93,145,25,134,205,165,134,157,151,92,76,98,231,31,230,118,243,249,167,99,222,167,27,251,196,243,126,218,145,215,237,169,92,115,21,43,175,218,42,71,113,41,229,57,31,98,16,65,4,16,67,200,16,245,136,78,9,193,56,113,79,31,18,123,110,218,79,109,219,105,237,187,109,56,106,247,136,236,247,136,225,222,45,16,211,90,102,210,233,85,133,67,105,70,26,88,199,84,198,12,177,131,248,114,139,158,207,171,72,86,21,164,217,107,52,11,72,31,67,80,111,115,108,251,82,249,169,250,53,147,51,109,131,234,28,180,251,64,223,35,180,135,71,170,35,161,105,194,208,167,30,145,70,225,125,192,249,216,239,13,191,128,117,199,228,107,188,164,167,62,236,17,117,219,40,97,178,171,170,90,201,167,99,105,105,143,199,62,14,35,155,89,189,104,229,138,3,188,208,170,168,31,29,69,197,160,244,102,239,214,245,117,237,107,238,3,112,9,238,191,188,82,56,157,181,43,201,218,82,190,252,74,149,219,201,79,40,242,87,111,8,33,201,15,40,65,53,53,4,57,166,243,77,230,135,52,222,105,188,211,121,166,243,77,230,155,205,53,55,154,106,106,9,169,168,33,229,40,132,224,156,222,41,205,187,105,61,183,109,39,54,237,180,225,171,182,142,206,218,100,204,116,82,234,190,39,180,177,236,120,189,174,107,176,32,131,188,21,217,134,156,54,106,170,58,47,216,22,204,152,138,171,40,6,64,93,206,74,108,135,174,174,169,60,215,104,218,28,101,170,161,161,253,191,99,52,23,250,101,146,210,249,88,209,143,123,79,157,189,75,117,155,213,22,146,215,11,156,13,196,29,255,0,34,23,112,78,121,220,139,174,217,89,118,113,42,166,86,182,90,203,169,41,249,200,59,194,58,51,255,0,202,177,108,54,143,67,128,58,113,251,249,110,116,159,151,47,201,61,215,221,34,145,247,237,149,44,151,226,84,210,41,95,192,167,157,237,87,111,9,173,224,154,222,9,161,12,80,65,4,222,105,169,163,138,28,209,224,158,84,135,138,121,226,157,204,222,157,204,163,196,174,190,67,228,60,241,71,154,112,226,83,249,169,156,69,202,119,93,178,84,215,98,199,41,27,189,165,61,168,141,232,38,166,148,212,210,135,146,228,66,115,110,197,57,183,98,156,219,182,147,134,174,210,59,59,107,46,218,236,219,180,182,205,61,179,99,178,150,219,144,127,251,181,157,117,61,94,183,57,8,5,178,255,0,88,43,79,116,73,179,218,58,51,118,147,88,141,5,247,209,70,89,95,27,127,142,155,18,255,0,172,101,202,72,100,124,83,49,204,149,142,44,123,30,11,92,215,52,220,67,129,220,71,200,37,199,114,46,187,4,5,215,133,85,82,214,77,56,20,212,167,29,121,6,211,135,240,183,138,178,108,70,143,68,132,58,112,49,158,77,167,254,92,191,37,35,239,219,42,89,9,196,169,100,82,191,129,82,59,123,81,226,212,26,49,106,141,131,114,99,47,76,109,232,99,138,24,226,135,52,7,20,57,167,28,169,231,138,113,222,85,254,224,94,224,19,170,92,219,152,74,146,96,222,230,245,33,103,247,62,10,86,131,220,120,41,163,214,238,136,85,17,95,115,74,169,132,229,55,41,226,39,88,20,91,188,174,168,97,180,129,226,129,226,154,80,65,11,198,42,226,49,68,93,138,45,187,20,69,219,72,236,237,44,187,75,179,174,212,227,124,246,213,153,232,150,233,27,22,197,157,171,13,93,252,60,238,5,179,14,143,4,242,90,125,217,255,0,158,180,108,216,29,164,58,52,203,221,233,214,116,78,51,196,206,117,20,227,89,204,234,230,222,223,182,185,249,79,4,93,185,23,93,130,203,123,85,93,121,6,24,181,97,6,231,76,252,24,223,207,143,208,43,46,198,13,120,104,158,172,126,246,65,131,79,240,55,130,150,66,113,82,200,74,150,77,205,42,89,62,2,158,110,189,136,52,2,88,163,140,98,213,12,32,224,20,81,223,138,96,191,20,49,184,171,239,218,66,243,180,175,220,164,119,20,231,111,62,192,121,79,172,81,69,94,66,243,175,96,185,9,221,22,199,37,27,163,142,248,134,238,74,47,54,59,145,187,146,137,237,61,200,253,19,31,173,116,24,253,22,123,160,240,79,102,183,115,224,165,140,187,185,63,162,150,61,110,236,169,226,38,224,85,68,59,194,123,46,214,189,110,188,161,134,210,28,208,60,80,195,20,48,197,110,197,12,49,87,93,138,187,87,105,93,118,210,203,180,183,109,46,207,59,74,19,218,52,112,182,192,210,121,9,121,180,44,248,135,154,153,238,227,83,79,123,90,254,174,109,206,60,74,211,222,203,234,8,210,59,40,190,202,115,181,97,181,168,175,154,134,78,67,206,92,11,28,120,53,224,31,182,137,78,113,69,215,96,166,168,145,144,193,11,159,43,183,53,162,242,169,232,195,38,180,200,146,93,226,157,135,100,127,49,27,209,13,17,68,208,200,218,46,107,90,46,0,116,10,89,78,226,166,148,229,42,73,8,238,202,113,186,248,211,88,49,98,134,1,139,66,130,156,59,114,134,48,235,156,19,6,176,215,87,235,109,162,111,218,69,215,128,229,35,248,162,113,39,203,205,15,115,218,65,210,199,245,9,142,243,55,142,74,33,20,91,35,112,81,106,1,112,80,188,29,144,162,125,251,1,67,37,253,216,81,72,29,220,132,199,107,119,30,11,53,208,120,39,179,90,232,124,20,209,107,119,71,244,83,71,127,118,84,209,19,115,72,85,16,158,55,39,50,237,98,66,221,123,144,55,109,45,216,161,134,40,97,138,221,138,221,180,174,187,105,93,118,210,203,180,178,237,42,27,78,142,106,11,74,150,10,186,25,217,230,231,166,169,141,178,195,43,15,194,246,60,16,225,208,171,54,213,21,22,231,101,83,71,69,90,67,164,146,194,170,144,138,105,93,190,234,89,95,127,155,115,184,49,219,29,66,182,116,106,210,169,177,237,251,46,166,207,181,32,118,172,180,213,113,152,164,111,35,115,183,180,240,112,192,253,172,81,113,8,191,130,39,87,101,85,218,1,147,202,211,5,22,255,0,56,241,139,199,240,14,63,85,71,102,67,230,104,96,212,188,109,72,113,123,254,165,75,41,202,165,148,141,130,158,251,175,139,193,110,190,37,28,96,95,26,130,156,98,208,169,233,154,119,40,97,14,1,225,11,223,116,136,188,191,109,57,229,219,106,73,14,9,239,197,206,62,161,247,109,176,174,150,52,47,135,30,72,24,163,87,180,121,1,76,119,5,19,254,21,20,131,32,81,72,29,221,133,20,154,215,66,63,68,199,235,221,7,130,35,94,232,60,20,145,235,221,7,130,154,45,110,232,169,97,39,96,169,224,38,235,194,154,35,115,129,91,175,114,6,237,165,126,174,210,24,109,45,219,75,118,210,221,180,183,109,45,219,75,46,210,221,180,180,47,181,43,43,246,94,149,217,141,150,70,52,138,90,248,110,142,178,148,158,49,73,203,155,77,237,43,76,59,49,51,218,212,129,214,214,135,130,72,180,233,163,185,244,237,229,87,16,188,199,252,248,183,237,75,209,113,69,215,96,167,171,150,56,41,224,116,147,60,220,214,48,94,74,134,132,50,166,212,99,102,169,192,182,1,140,108,254,111,188,124,20,146,220,3,48,82,202,70,194,115,181,111,137,101,190,37,28,96,19,26,130,157,184,128,169,233,154,113,2,229,12,33,224,72,2,104,47,2,84,231,185,247,74,159,33,118,223,208,94,166,152,187,104,162,236,73,39,223,54,130,213,150,60,120,173,87,67,143,36,29,28,88,242,90,204,30,168,41,143,27,148,82,12,170,41,65,216,10,41,65,238,135,232,162,144,58,232,71,232,129,215,186,15,4,230,107,221,7,130,150,34,238,228,254,138,104,75,187,181,44,46,38,226,20,240,28,111,68,17,123,150,93,165,187,105,110,218,91,182,150,237,181,187,109,110,219,91,182,150,237,165,28,209,186,25,154,215,197,35,75,30,199,128,230,185,167,2,28,14,240,85,147,164,140,170,210,46,204,91,5,157,110,27,229,154,197,123,132,116,85,71,143,152,39,8,30,121,100,61,21,173,163,214,157,93,141,110,89,211,208,218,148,175,49,207,77,82,195,28,140,119,80,120,30,7,113,31,104,223,193,23,157,200,188,141,149,104,219,178,134,211,195,169,78,210,4,181,15,27,12,233,212,244,84,86,44,2,42,56,75,166,112,186,73,222,54,223,255,0,224,116,82,74,69,236,40,155,175,137,1,171,124,106,56,192,238,212,52,237,197,161,83,210,180,226,20,20,237,125,207,9,141,243,129,178,243,226,157,33,144,9,185,241,78,145,206,239,20,211,184,237,20,92,111,39,223,245,101,106,213,150,17,127,16,175,142,28,120,5,173,27,125,128,42,55,240,81,72,50,5,20,160,247,97,69,40,119,115,224,152,253,123,160,240,78,26,247,65,224,165,136,190,232,79,232,166,132,187,187,42,88,73,217,33,77,1,184,223,112,68,92,9,91,182,150,93,165,187,105,110,218,91,182,150,237,165,151,105,110,218,91,182,150,133,246,185,101,138,77,33,165,243,54,172,76,34,134,215,165,1,181,84,228,240,191,116,140,230,199,96,180,195,178,123,76,83,91,180,194,123,34,103,145,65,107,211,2,105,106,70,251,185,199,39,54,59,31,179,203,147,158,225,178,157,33,110,194,169,181,27,13,161,107,70,248,44,227,115,153,29,215,75,48,233,201,189,84,84,240,197,77,73,74,216,169,216,46,99,24,219,154,17,58,164,199,224,154,53,79,154,76,96,111,118,20,80,128,75,66,130,153,135,114,130,149,175,185,225,71,24,147,86,110,124,81,113,148,9,188,83,230,115,251,213,53,67,141,207,41,207,36,147,246,14,172,141,90,146,197,138,190,56,113,228,181,162,110,60,61,78,190,187,93,189,71,38,246,168,165,7,96,98,161,148,59,186,31,162,141,225,247,66,179,145,15,62,10,72,139,251,159,5,44,5,221,209,82,194,227,178,69,202,88,13,206,68,93,123,150,237,165,187,105,110,218,91,182,150,237,165,187,105,101,218,89,118,149,143,164,182,93,85,137,111,217,244,245,246,77,83,53,42,41,106,88,31,27,198,241,129,226,14,32,140,65,86,166,131,182,175,74,116,28,79,105,232,123,111,150,162,152,247,149,150,115,55,184,190,225,222,66,223,191,189,163,55,217,165,201,210,17,178,167,171,150,24,161,129,210,74,247,6,177,140,105,115,156,227,128,0,13,229,50,133,148,246,166,144,211,137,43,48,124,84,103,22,71,214,95,188,238,155,130,46,213,238,208,1,183,197,224,154,219,175,98,142,33,151,5,12,13,59,148,20,205,118,216,189,69,3,100,186,96,191,189,13,155,159,21,36,174,144,9,183,245,83,84,61,225,178,18,111,82,74,226,94,226,126,195,185,237,90,178,69,143,21,123,33,199,146,46,141,152,172,61,163,78,245,28,131,16,20,83,7,108,40,166,14,238,135,232,163,144,62,232,124,21,222,112,136,57,240,82,68,94,68,39,244,82,192,93,221,149,53,59,137,104,34,229,36,70,231,173,219,75,118,210,221,180,183,109,44,187,75,118,210,203,180,178,237,32,64,4,224,85,29,190,202,205,48,236,198,146,42,107,99,110,122,251,9,155,16,213,113,47,163,27,153,47,54,101,114,168,163,168,154,150,174,9,32,170,133,238,138,104,102,105,100,145,189,134,231,53,237,118,32,131,188,31,178,139,142,228,249,92,219,154,173,11,110,182,150,130,207,162,124,245,147,56,54,56,216,55,245,60,128,226,74,161,209,72,33,172,172,141,149,54,243,155,181,48,23,178,11,198,44,138,255,0,23,44,26,76,105,140,3,187,76,140,13,128,163,137,187,148,52,204,59,65,67,78,217,59,192,19,35,18,134,205,207,138,115,221,45,211,115,226,159,51,164,186,93,253,84,213,46,117,238,55,34,239,177,8,114,213,145,152,241,11,251,173,165,173,20,120,240,87,180,121,122,249,58,174,171,175,151,175,168,10,100,131,16,162,152,59,96,40,166,107,187,160,163,144,60,136,124,17,105,144,136,60,20,144,186,75,162,55,11,248,41,96,115,182,10,154,153,221,17,105,0,156,86,237,165,151,105,110,218,89,118,150,237,165,151,105,110,218,91,182,149,131,218,197,36,214,221,139,230,44,221,61,99,27,169,88,235,219,5,107,88,46,17,85,6,254,141,144,11,194,182,116,86,217,175,209,253,32,160,150,138,215,162,148,197,81,79,40,197,167,129,4,96,230,184,98,215,12,8,196,125,143,201,57,231,114,124,238,110,194,181,244,174,211,166,179,44,170,35,45,67,241,115,142,17,196,206,50,72,238,13,10,202,208,155,57,144,211,194,217,237,73,26,61,42,181,205,185,239,254,6,125,214,14,73,173,13,37,137,145,129,176,163,140,110,76,133,187,212,84,236,126,218,142,22,201,116,183,111,226,191,189,13,159,159,20,249,140,157,247,62,42,90,151,184,7,155,138,124,174,37,196,159,177,177,11,82,70,226,131,93,22,215,36,29,28,88,173,102,15,87,119,179,14,222,153,32,220,162,152,27,216,20,83,181,253,208,227,193,53,226,66,33,240,78,143,206,17,15,130,150,7,63,186,42,90,119,146,1,4,41,33,112,14,89,118,150,237,165,187,105,101,218,89,118,150,93,165,151,105,110,218,90,53,219,13,135,232,213,193,148,122,73,76,195,251,50,216,99,47,146,35,191,205,75,198,72,93,197,188,55,133,164,157,157,233,5,86,141,233,69,15,163,215,197,183,27,216,117,160,168,132,224,217,160,126,26,236,119,234,55,28,126,197,189,57,238,0,4,250,135,179,97,91,58,109,106,211,217,182,85,47,39,212,84,60,119,80,69,197,239,63,228,55,149,98,104,53,149,29,157,101,65,173,51,174,53,85,114,52,121,217,222,56,187,147,71,6,240,77,96,27,9,145,141,201,140,10,56,90,235,202,142,6,190,233,57,166,196,37,2,108,113,226,139,188,232,19,248,169,38,116,157,247,62,42,106,167,187,108,234,162,227,246,70,164,141,197,106,73,22,215,36,210,200,182,185,32,248,219,143,171,215,201,215,217,135,111,76,148,27,194,134,118,187,96,40,230,18,17,8,95,222,150,193,224,164,133,210,93,10,150,7,187,96,169,169,95,141,247,43,136,218,89,118,150,93,165,187,105,110,218,91,177,91,182,150,93,165,162,221,173,232,249,177,116,134,35,29,84,87,190,207,180,161,3,210,104,229,59,203,9,222,199,93,182,195,129,90,75,217,134,145,77,163,250,71,77,113,198,74,58,200,175,52,245,144,95,112,150,23,31,22,239,105,251,14,244,94,225,134,244,250,135,179,97,91,26,113,107,211,89,118,93,54,2,231,212,212,188,119,84,241,113,123,207,249,14,42,196,208,91,22,158,198,177,233,176,23,58,162,161,227,189,168,151,139,222,71,128,224,152,198,141,148,200,198,228,214,4,200,90,226,92,153,3,100,239,83,88,37,2,111,20,231,186,80,39,231,197,73,59,228,239,47,190,245,37,67,203,158,227,114,39,236,146,199,2,188,212,140,199,136,64,121,161,174,155,35,25,182,131,192,197,117,245,55,122,189,87,47,38,35,203,213,117,92,211,94,10,138,112,235,218,162,168,107,251,160,83,94,36,186,31,4,232,140,132,67,224,164,167,115,251,189,202,106,87,146,2,115,8,4,226,178,237,44,187,75,118,210,221,180,178,237,44,187,75,46,210,209,174,213,52,106,125,28,210,56,57,201,69,91,24,30,126,142,162,235,132,177,19,255,0,19,119,56,45,35,236,191,72,231,209,237,33,131,156,148,85,177,131,230,43,32,191,9,98,63,245,55,123,79,216,69,231,0,159,80,246,108,43,99,78,109,170,75,38,203,166,229,37,77,75,199,117,79,15,25,30,71,128,226,85,133,160,86,29,61,139,99,83,220,0,14,168,169,120,239,106,37,227,36,132,120,14,9,145,129,130,107,2,107,47,197,50,22,187,108,96,153,3,100,239,80,111,157,13,155,159,20,233,93,47,124,164,168,123,192,146,242,122,167,202,226,231,18,126,203,184,163,19,219,113,70,39,197,182,131,132,64,200,155,43,25,180,181,128,199,219,245,245,1,222,153,40,55,133,21,67,95,176,10,100,205,144,136,185,240,69,190,116,136,121,240,82,83,186,78,235,113,60,20,148,207,36,54,226,19,162,112,107,142,43,22,226,178,237,44,187,75,46,210,221,138,221,180,178,226,180,107,181,77,26,155,70,244,146,14,114,81,86,198,7,159,163,158,235,132,177,19,250,57,187,156,22,145,118,95,164,181,58,57,164,16,226,59,218,58,200,193,243,21,148,228,220,217,162,39,244,115,119,180,253,128,94,66,124,239,102,205,234,215,211,59,106,134,197,178,41,60,229,76,187,78,123,176,142,24,155,154,89,29,193,173,86,55,103,118,4,22,53,151,24,124,206,186,74,218,183,54,231,212,205,117,197,199,147,70,230,183,130,17,180,96,131,2,12,6,242,153,3,95,123,211,33,108,183,74,191,190,2,110,124,83,229,124,160,75,127,230,164,169,145,192,62,242,156,243,121,63,102,144,83,162,123,118,145,99,162,5,232,72,216,198,186,18,49,187,75,118,62,77,222,175,95,99,213,117,242,135,131,122,142,118,186,246,133,20,237,147,186,11,9,72,135,159,4,248,29,37,209,41,41,222,237,146,46,41,240,60,49,199,114,203,180,183,109,44,187,75,46,210,203,180,178,237,44,184,173,30,237,111,69,165,209,235,107,186,171,142,249,172,219,65,130,249,104,234,110,184,61,163,13,102,29,207,103,16,180,131,179,205,36,174,209,125,36,165,243,53,244,231,89,146,54,243,13,68,46,201,60,46,57,163,125,216,31,200,251,241,113,78,158,70,13,85,105,233,21,169,103,217,118,85,3,234,107,234,94,25,20,76,24,147,204,242,104,222,73,192,5,100,246,107,97,69,71,78,198,77,108,206,198,58,209,173,187,25,30,62,6,114,141,156,2,12,104,193,6,4,214,3,123,147,32,99,246,194,100,77,150,233,185,241,69,222,120,9,185,241,79,157,207,2,83,199,138,150,165,238,185,232,159,179,203,8,78,133,236,218,95,221,13,126,72,74,200,246,208,123,91,143,151,119,180,221,235,7,111,76,153,166,246,168,234,24,254,236,38,184,74,68,60,211,225,116,132,68,84,148,239,118,193,23,39,211,191,85,220,213,218,187,75,46,210,203,180,178,237,44,187,75,46,210,203,138,176,251,98,209,147,69,81,169,79,164,180,108,123,236,123,75,140,82,156,124,212,183,98,232,100,57,135,13,225,91,26,43,109,90,58,61,111,208,201,71,107,208,202,97,168,130,65,139,78,240,65,226,215,12,90,225,129,24,143,124,36,167,76,246,128,213,81,93,81,75,4,20,239,146,121,94,216,227,141,141,46,115,158,227,112,107,64,222,73,84,189,157,88,241,218,22,140,12,118,149,214,197,117,75,240,112,166,136,155,196,12,35,245,121,226,83,88,208,131,2,17,180,146,83,32,99,246,211,34,108,163,206,243,226,139,140,160,77,207,138,124,238,151,188,82,84,189,192,56,220,137,251,66,228,99,123,113,78,137,209,237,43,196,67,95,146,108,172,102,210,214,104,187,203,215,217,245,91,189,78,190,64,69,197,50,86,155,194,142,161,143,238,193,189,54,65,41,17,115,224,157,19,165,34,36,250,119,191,99,4,250,103,234,147,130,203,180,178,237,44,187,75,46,210,203,138,203,180,178,226,169,59,88,176,127,108,216,112,199,30,158,89,176,221,72,252,24,43,160,110,38,150,87,30,60,99,113,220,85,69,21,77,69,29,100,18,65,87,4,143,134,120,101,105,100,145,201,25,213,115,30,211,136,115,72,184,143,122,188,167,74,240,46,79,158,72,206,167,37,29,131,71,71,166,218,69,72,63,105,207,30,181,151,75,43,63,184,137,219,170,29,127,198,241,151,144,65,141,24,33,24,77,141,174,188,166,64,199,247,137,177,54,110,251,159,20,231,153,128,155,159,20,249,157,39,120,159,82,247,109,97,246,158,169,8,196,246,226,139,29,30,218,15,108,123,104,72,198,226,175,27,252,157,87,95,114,5,54,86,144,163,168,99,246,6,41,175,108,164,69,207,130,49,58,91,162,230,159,78,247,236,220,159,77,38,169,221,122,221,180,183,109,45,216,172,187,75,46,210,202,53,150,236,83,109,250,58,158,211,180,66,138,251,106,154,61,123,118,138,6,255,0,173,64,193,141,91,0,253,236,99,63,222,111,188,222,140,143,2,228,250,137,35,216,76,210,10,184,116,170,222,163,191,71,168,165,186,8,100,110,205,101,75,49,213,35,140,108,248,185,156,19,88,214,224,132,109,77,137,135,105,50,6,73,182,132,98,96,38,231,197,57,230,96,38,79,153,210,95,34,125,67,220,3,176,87,253,169,170,225,138,49,72,205,165,119,155,5,232,72,200,246,144,123,70,62,199,175,181,189,54,70,144,66,101,67,31,177,189,54,70,202,68,92,211,162,124,183,69,207,130,124,15,126,205,201,244,242,106,147,130,203,138,203,115,150,93,165,151,105,101,197,101,197,2,0,38,240,155,160,246,161,211,141,22,164,13,208,251,78,107,170,105,226,23,54,206,172,147,29,64,209,186,25,119,179,131,78,30,240,94,224,19,170,36,102,194,173,211,221,33,164,179,163,99,162,179,161,186,123,66,168,55,8,96,28,191,141,251,154,21,159,97,217,180,22,77,151,74,218,123,62,146,22,193,4,76,220,214,51,175,19,204,241,77,141,169,177,53,216,166,64,217,54,194,17,137,64,151,159,20,231,153,64,155,159,20,249,157,33,50,39,204,247,0,229,127,218,183,35,27,197,197,24,223,30,210,214,17,130,244,36,99,113,87,129,143,171,215,215,227,228,234,186,249,46,227,234,222,132,141,32,132,202,136,223,176,55,32,241,43,132,92,211,161,124,189,223,52,232,36,118,202,116,47,13,59,150,92,86,93,165,151,21,151,21,151,21,151,21,101,233,45,143,104,88,22,221,43,42,172,154,250,119,83,85,64,251,238,124,111,23,28,70,32,141,224,140,65,86,159,101,26,95,83,97,212,151,205,100,79,125,77,145,92,70,21,52,164,241,187,116,140,202,241,238,196,148,233,164,110,207,21,93,110,90,86,117,153,103,81,186,122,234,169,89,12,49,48,98,231,188,171,63,179,157,24,163,177,169,152,215,215,188,9,237,10,160,49,154,160,140,126,141,102,230,132,35,98,108,77,56,166,192,201,54,208,141,179,1,47,62,41,207,51,1,47,62,41,243,62,77,190,105,210,57,192,59,18,137,36,157,255,0,107,144,81,137,236,197,22,152,198,191,36,30,198,109,173,118,12,125,159,95,88,115,245,219,35,72,33,50,120,228,238,208,34,98,34,230,157,4,146,29,78,105,208,200,112,186,228,99,112,105,43,46,210,203,138,203,138,203,138,203,138,203,138,178,251,92,208,186,157,30,171,115,33,181,161,190,166,200,174,119,255,0,199,171,104,184,107,93,143,155,126,87,133,105,104,245,173,104,216,118,197,35,233,173,74,26,135,210,213,65,38,246,73,25,213,35,168,228,119,17,238,166,71,1,114,116,242,68,117,19,52,122,202,135,77,173,138,75,173,90,216,181,108,216,222,49,130,153,251,229,232,233,120,114,106,12,99,80,137,132,166,192,199,141,116,35,108,195,206,243,226,156,243,53,210,243,226,159,51,164,219,69,238,118,210,46,37,199,127,219,37,142,106,116,111,102,210,188,70,53,185,33,35,27,138,214,104,199,212,235,229,235,238,23,166,202,195,120,76,158,57,72,98,187,207,17,23,52,232,36,147,99,137,78,134,75,247,34,11,65,43,46,43,46,43,46,43,46,43,46,43,46,43,251,75,100,30,211,116,114,148,27,110,204,128,54,218,134,54,237,85,81,71,186,124,55,190,1,155,155,62,158,232,92,228,103,150,61,142,43,251,103,111,197,89,105,83,31,236,237,154,89,61,105,35,9,159,189,148,255,0,215,118,215,69,28,49,70,200,216,25,27,26,26,214,180,92,214,129,128,0,4,216,153,189,54,6,63,111,114,17,182,107,165,230,139,204,192,74,157,51,164,239,56,243,69,197,251,87,239,78,149,229,196,253,181,113,70,55,183,21,170,232,198,178,15,100,123,72,61,173,199,215,235,238,27,150,176,197,54,104,221,178,155,52,114,159,54,56,162,199,76,68,124,211,160,146,75,218,157,4,151,142,107,46,210,203,138,203,180,178,237,45,216,172,187,73,178,55,205,200,3,152,240,90,230,187,16,224,119,131,122,119,102,58,94,234,203,42,157,195,67,173,151,62,166,204,112,27,20,242,111,150,144,255,0,37,247,179,155,125,202,242,140,210,52,106,170,235,122,213,179,44,186,10,83,45,109,92,236,130,22,14,47,121,187,30,67,153,86,118,129,104,197,155,163,244,12,107,159,19,67,234,167,2,227,61,67,243,200,122,112,111,32,155,11,19,96,141,251,64,96,132,77,154,233,57,241,69,230,96,37,230,157,43,164,219,69,197,251,72,204,243,142,31,110,22,186,244,99,123,54,184,175,238,198,178,18,49,155,75,89,163,220,250,249,119,121,3,154,111,77,158,55,236,160,246,204,67,57,240,70,41,37,216,230,157,20,142,193,58,25,6,56,94,178,226,178,237,44,184,172,152,172,187,75,46,42,204,237,71,66,45,109,18,180,75,89,44,236,243,180,21,78,23,154,90,216,241,138,81,210,252,29,205,164,133,105,232,213,179,105,216,22,213,43,169,237,90,10,135,211,84,194,239,133,236,55,96,120,131,188,30,35,220,76,143,0,4,233,229,139,99,146,22,77,154,52,238,212,166,2,174,170,55,193,101,177,237,197,144,229,124,248,238,47,202,222,136,68,192,153,79,27,175,114,108,76,150,233,120,21,121,152,9,121,241,78,149,242,247,136,188,191,107,138,50,60,128,126,221,184,162,199,183,20,88,232,198,178,215,107,54,150,187,27,143,183,253,61,143,84,36,105,77,158,41,118,47,43,251,226,35,231,193,24,101,147,97,24,222,112,70,55,6,184,172,184,172,187,75,46,43,46,43,46,43,46,43,246,165,155,15,106,150,21,53,245,180,76,101,45,188,200,198,50,83,100,134,171,235,22,87,255,0,13,220,189,192,184,132,233,229,102,202,151,77,244,170,204,178,140,110,20,12,34,170,208,144,124,20,177,145,175,143,55,94,26,58,149,77,103,210,82,209,210,194,216,169,105,226,100,48,196,204,26,200,227,26,173,104,232,0,76,130,51,121,186,224,153,3,36,186,69,140,195,206,115,226,157,43,229,190,78,105,207,115,246,145,37,216,162,226,73,251,120,181,192,162,199,179,105,97,29,239,90,236,102,42,241,237,186,249,58,251,11,240,77,149,142,4,112,77,149,146,157,68,99,124,199,83,154,48,200,253,158,41,209,186,241,193,29,155,202,203,138,203,138,203,138,203,138,203,138,164,180,168,234,44,234,248,35,168,161,170,133,244,245,16,74,53,153,44,82,13,87,49,192,239,14,6,226,170,187,45,211,171,83,71,92,36,125,146,243,233,118,69,75,255,0,125,69,41,216,188,241,115,49,99,250,143,110,100,123,69,200,205,44,91,28,66,110,130,104,93,44,213,116,229,150,229,170,216,235,43,3,155,115,162,101,221,212,39,171,65,188,245,37,54,24,211,96,142,75,158,174,19,1,47,52,101,124,183,73,205,57,229,251,75,54,214,8,202,242,120,125,191,114,44,123,81,107,163,26,203,89,177,226,181,152,220,125,93,222,211,175,176,15,109,201,179,196,253,158,8,56,76,68,124,209,134,73,72,103,52,99,123,176,78,134,65,201,101,197,101,218,89,113,89,113,89,113,89,113,77,237,47,179,233,107,44,218,96,253,42,176,154,250,251,60,180,119,147,67,117,243,211,14,122,237,23,180,125,224,61,182,179,130,51,75,24,213,67,74,116,166,154,209,173,167,214,177,172,131,29,101,78,176,217,146,91,239,134,30,186,196,94,122,4,34,96,37,50,158,39,237,93,130,213,18,129,39,52,100,116,189,226,116,142,126,210,39,91,105,23,184,180,31,144,75,92,212,88,230,98,176,143,105,107,177,152,171,199,169,135,144,121,58,250,221,125,77,248,249,58,250,152,111,66,70,56,93,193,54,104,228,217,90,166,99,169,205,58,25,95,178,139,74,44,112,105,43,38,43,46,43,46,43,46,43,46,43,46,41,189,159,105,252,213,246,101,47,154,209,139,127,94,208,160,12,23,71,12,247,255,0,164,83,55,144,99,142,179,71,6,184,15,105,121,70,89,26,46,79,169,158,153,140,136,186,71,185,173,107,90,47,46,39,0,0,81,118,125,161,54,109,151,36,96,90,147,129,89,104,187,143,164,72,50,125,35,23,53,54,158,35,138,17,178,80,36,69,238,152,121,206,105,210,58,75,220,139,181,241,89,177,69,238,46,63,32,220,86,163,219,143,21,115,163,26,220,150,179,25,138,189,163,213,234,135,169,215,219,135,53,9,163,126,28,16,123,38,58,136,197,36,187,8,198,242,58,162,199,222,22,92,86,92,86,93,165,147,21,151,21,151,21,23,106,61,156,90,246,36,48,181,214,237,43,77,161,99,188,230,21,112,2,68,96,242,153,183,176,167,198,247,71,35,75,94,210,90,230,184,92,65,24,16,65,246,122,206,8,205,44,99,87,11,211,45,205,40,101,191,93,79,125,151,97,134,84,237,12,31,86,239,238,91,253,55,23,166,195,30,39,130,108,17,60,7,112,87,153,135,156,78,149,242,109,34,226,251,220,179,98,140,178,17,127,200,122,174,110,43,85,236,197,107,49,152,173,102,183,31,47,95,105,215,217,135,176,161,44,114,108,171,140,199,83,154,49,72,252,22,169,33,24,222,5,248,44,152,172,184,172,184,172,184,172,184,172,184,161,161,157,160,191,72,108,232,53,44,13,37,215,175,139,84,108,69,90,8,244,152,191,55,16,241,252,222,204,203,32,193,25,165,134,230,18,73,2,224,20,122,1,160,150,77,151,44,33,150,156,204,21,182,143,222,244,137,134,67,252,141,185,169,180,240,191,107,130,184,74,4,136,200,249,118,249,173,114,242,28,179,98,175,215,23,162,73,39,228,59,156,17,107,216,176,102,43,89,141,87,129,236,186,251,78,168,46,168,56,33,44,79,193,7,182,98,25,205,24,228,151,99,154,49,200,235,194,45,55,132,118,113,89,113,89,113,89,49,89,113,89,49,81,246,159,217,173,179,98,69,16,117,181,74,207,218,86,67,174,189,222,151,78,210,68,99,253,235,73,103,230,139,73,107,129,14,6,226,14,240,125,142,177,70,89,163,193,127,104,244,210,130,182,166,16,235,46,199,13,180,42,117,198,14,145,167,185,143,243,126,63,64,83,97,136,227,193,8,217,40,18,112,40,189,210,141,116,94,231,237,44,216,172,248,163,44,135,28,62,68,184,173,87,181,99,30,42,246,183,21,123,70,62,191,95,115,18,48,161,44,82,236,173,87,76,117,57,163,20,143,217,87,18,140,82,1,192,149,151,21,151,21,151,21,151,21,151,21,151,20,205,5,237,46,182,170,130,15,55,97,91,236,54,189,30,168,185,140,150,71,93,81,11,127,149,248,129,193,174,30,196,189,237,90,210,68,117,121,38,104,103,103,116,21,53,16,134,90,150,192,109,163,80,78,97,19,135,112,207,201,152,221,205,197,8,98,120,14,87,249,209,175,205,23,186,77,190,106,242,243,122,207,138,205,138,36,222,126,69,33,225,92,230,98,175,99,49,87,180,123,126,190,191,95,41,65,193,9,99,118,28,16,115,101,33,171,205,203,38,207,18,139,36,56,43,141,235,46,43,46,43,46,43,38,43,46,43,46,40,105,215,101,85,213,180,177,235,91,58,58,227,107,210,234,182,247,190,6,54,234,152,190,133,155,93,75,71,176,188,175,57,35,47,106,58,97,166,122,63,98,58,34,234,55,204,39,173,55,27,155,75,7,121,37,228,110,214,3,84,30,101,69,75,0,142,32,214,70,198,6,181,173,0,53,173,24,0,0,224,174,108,128,63,4,94,233,118,145,113,147,21,155,21,155,20,100,144,227,242,53,206,10,231,70,182,88,182,70,62,191,95,115,11,94,55,33,36,82,236,243,90,175,152,234,243,70,57,29,130,184,163,28,160,44,184,172,184,172,171,46,43,46,41,146,51,205,188,7,49,205,213,115,92,47,4,29,224,130,159,217,215,104,154,73,162,237,97,20,17,84,26,139,57,196,235,107,81,84,119,144,227,196,181,167,85,221,71,175,172,224,175,124,102,228,219,58,194,182,52,214,170,27,166,172,127,236,234,23,56,98,32,136,135,76,246,244,123,238,31,210,131,35,120,14,69,198,81,175,205,107,185,230,245,155,21,155,21,139,177,69,196,147,242,54,216,91,76,91,12,91,35,218,117,246,250,205,40,73,27,246,120,21,120,148,234,243,90,146,73,178,181,94,81,105,4,35,179,138,203,138,203,138,203,138,203,138,201,138,22,133,129,163,157,161,81,197,124,246,116,159,178,173,7,52,99,232,213,4,190,23,187,163,31,123,126,174,245,245,158,213,61,109,85,21,21,36,70,74,170,137,163,130,24,219,189,242,72,67,90,209,212,146,169,244,51,68,108,61,25,166,115,53,44,234,40,233,220,246,139,132,146,129,124,146,127,91,201,114,58,175,26,200,189,207,218,87,151,98,179,98,179,226,188,228,132,124,143,180,22,211,86,195,22,200,247,157,222,80,248,221,244,90,241,203,135,2,181,36,151,103,154,212,145,222,77,73,0,37,100,197,101,197,100,197,101,197,100,197,82,105,214,134,105,30,137,86,22,249,171,82,130,90,102,189,216,136,230,35,90,25,110,231,27,192,112,85,86,109,109,101,157,91,17,138,182,150,121,41,167,137,219,217,44,78,44,123,79,208,143,86,242,128,115,83,116,135,180,122,75,70,162,34,234,11,10,7,90,143,251,166,113,177,3,79,80,227,174,63,149,92,215,237,34,225,38,210,36,191,21,159,21,155,21,155,21,174,242,126,71,196,45,166,171,154,197,178,61,110,190,233,215,201,172,194,131,226,147,5,113,148,134,243,90,146,63,5,113,69,143,107,150,76,86,76,86,92,86,76,86,92,86,76,83,52,91,181,106,219,78,150,16,203,59,72,105,217,107,179,87,40,168,113,49,212,15,169,123,117,207,243,122,184,173,66,16,209,254,204,231,210,73,217,171,93,164,53,110,153,164,239,244,74,66,97,136,127,139,93,223,66,179,109,34,75,246,150,108,86,124,86,108,81,46,112,249,35,104,45,166,44,26,174,111,147,175,151,175,176,235,237,239,106,215,141,234,241,41,213,230,181,36,147,14,37,106,188,249,46,32,94,178,226,178,226,178,226,178,226,178,226,134,145,246,97,77,164,208,51,90,187,71,43,27,57,32,94,77,37,97,108,50,143,201,218,142,250,15,86,229,87,107,90,86,117,147,64,205,122,234,218,152,169,41,153,187,90,89,222,35,99,127,50,85,46,139,232,229,139,163,148,39,253,18,204,160,130,130,35,197,205,129,129,154,199,171,174,188,171,245,241,88,191,21,157,102,197,103,197,107,202,126,72,218,11,105,139,101,139,1,234,245,245,186,251,144,124,110,65,204,151,5,171,36,152,115,90,146,59,201,169,40,228,86,92,86,85,151,21,147,21,151,21,75,165,90,55,109,232,221,119,250,165,169,65,61,4,166,235,203,91,59,11,53,135,86,223,120,85,118,61,167,104,217,22,132,70,58,250,26,153,168,234,99,59,217,52,15,49,189,191,145,30,165,200,233,39,107,182,85,108,177,135,81,88,84,211,219,19,95,187,94,48,33,132,14,162,71,135,44,216,172,216,172,215,149,139,150,101,155,21,172,73,249,35,104,45,166,173,150,44,7,186,110,91,189,128,115,10,215,142,76,21,207,151,14,104,182,71,96,177,90,174,5,101,197,101,197,101,89,49,89,49,89,113,95,217,174,215,109,74,216,89,171,69,111,83,67,108,197,203,94,75,226,152,125,76,140,46,252,253,95,217,218,25,165,58,95,51,46,154,213,175,101,13,57,63,129,66,219,203,155,209,207,144,143,171,86,108,86,108,86,108,86,101,155,20,75,136,191,228,157,160,182,154,182,88,182,70,43,175,151,159,151,175,178,235,234,245,245,239,105,65,241,191,232,176,144,220,181,100,122,185,199,200,67,128,191,113,89,113,89,49,89,113,89,113,89,113,66,209,208,173,21,210,232,99,6,123,42,209,125,12,238,27,252,197,115,47,5,221,26,248,135,235,234,255,0,99,123,43,208,157,31,115,53,42,33,178,226,158,169,183,92,69,77,95,250,76,195,242,123,200,89,150,108,86,124,86,117,155,21,175,41,249,39,16,174,115,86,13,87,52,99,236,58,251,62,171,175,173,215,203,130,214,141,235,89,178,225,205,106,201,34,185,231,201,169,40,89,86,85,147,21,147,21,149,13,51,236,179,77,116,121,172,15,168,154,203,150,122,86,243,169,164,186,166,17,249,189,131,212,254,216,118,131,161,218,52,232,245,224,174,181,169,162,169,110,255,0,244,102,188,62,115,249,70,10,204,179,98,179,98,179,172,235,54,43,89,238,63,36,226,22,211,85,193,171,15,39,95,109,215,219,107,70,229,172,201,112,87,62,92,21,207,62,77,87,180,172,184,172,152,172,171,42,201,138,7,84,28,65,71,68,59,65,211,29,27,12,212,134,134,213,169,142,156,127,254,119,56,190,19,249,176,143,40,181,59,80,171,183,37,101,240,216,150,68,243,177,228,110,168,170,186,153,131,243,99,158,179,172,235,58,205,138,205,138,205,242,86,33,98,213,131,86,3,214,235,238,221,86,229,124,101,95,28,152,45,185,85,207,119,215,203,149,100,89,86,85,151,21,147,20,44,206,212,169,109,184,153,116,86,221,145,79,80,247,115,158,152,154,103,15,201,140,103,148,81,232,86,152,233,51,217,116,150,141,171,21,3,9,227,29,12,90,247,142,133,211,172,29,138,204,179,44,216,172,203,90,66,58,252,149,138,185,205,88,53,96,49,245,250,250,151,251,157,236,42,246,61,92,249,85,210,59,203,170,251,186,172,152,172,152,172,171,38,43,42,53,186,23,161,218,78,198,94,251,54,212,150,130,66,55,136,235,162,215,188,244,14,135,203,253,158,236,79,65,233,220,205,89,170,232,223,106,72,120,187,211,164,116,236,63,224,115,86,117,157,102,89,177,89,209,116,167,228,172,86,45,87,0,176,91,177,247,77,222,199,96,171,216,245,181,34,185,238,88,159,38,172,193,100,89,49,89,86,69,145,13,33,236,79,78,41,218,219,230,164,164,142,211,140,221,121,111,160,200,217,222,127,192,215,15,36,149,19,69,79,11,117,166,149,237,141,141,230,231,27,128,197,69,97,88,118,69,137,5,222,98,207,160,167,161,142,237,218,148,241,136,199,131,86,117,153,102,197,103,89,150,179,220,126,74,197,98,213,128,242,117,245,58,251,14,190,227,178,175,99,254,139,58,219,127,213,92,79,147,85,237,43,42,200,178,44,171,42,138,221,176,173,123,18,114,4,54,133,5,69,11,201,198,230,212,70,99,62,5,75,77,60,212,211,48,182,104,158,232,228,105,222,28,195,113,11,246,247,106,189,159,217,142,102,180,111,183,41,38,149,187,195,162,166,120,158,65,249,181,133,102,89,214,101,153,103,89,190,75,197,98,213,128,88,12,87,95,46,239,115,221,234,110,242,224,175,99,213,225,235,109,235,104,249,49,89,86,85,145,100,89,86,85,251,7,181,61,63,178,195,117,99,142,220,172,150,38,242,138,162,67,52,99,252,47,8,90,93,179,89,117,101,154,194,203,179,107,235,250,11,227,244,80,127,89,150,101,157,102,89,150,117,139,135,201,120,172,66,192,44,7,169,135,151,175,171,215,212,235,237,176,91,14,250,43,195,214,219,214,209,242,226,213,145,100,89,22,69,149,126,206,237,154,211,171,13,184,90,118,109,5,127,233,31,162,159,24,87,156,210,77,60,182,181,127,213,108,170,106,43,249,122,92,198,79,252,11,50,204,179,172,203,58,189,228,117,249,47,21,185,96,22,30,223,175,147,175,151,175,151,175,175,130,216,114,194,69,182,245,181,229,185,247,117,89,22,85,149,101,89,16,143,72,244,10,217,213,198,170,202,169,162,46,231,232,147,9,60,60,250,16,232,110,156,218,250,184,213,90,208,81,235,115,244,72,124,229,223,243,150,117,153,103,89,214,101,124,191,38,110,11,1,234,245,245,57,31,87,175,179,221,235,97,189,108,57,96,245,182,229,123,188,183,74,178,44,139,38,43,42,200,188,246,134,232,45,175,171,133,53,173,81,71,173,203,210,161,243,159,248,87,161,118,48,218,141,91,189,58,219,174,170,250,234,134,83,223,255,0,41,103,89,214,117,157,103,87,204,126,75,199,216,245,247,140,22,195,150,15,197,94,247,173,163,229,186,96,178,172,152,172,171,42,202,133,111,98,242,84,22,222,104,109,170,10,160,121,107,7,211,255,0,229,66,135,176,173,5,142,235,157,36,21,149,14,235,231,170,229,144,120,21,157,103,89,150,117,153,95,43,190,96,230,186,250,253,125,76,22,195,150,124,85,239,114,196,249,110,149,171,34,200,178,172,171,34,244,238,194,180,238,49,154,56,40,234,6,55,93,230,106,226,144,248,5,232,93,143,246,113,13,215,107,104,245,12,255,0,251,241,9,191,251,44,235,50,206,179,44,235,109,223,95,147,55,43,151,51,229,235,237,119,123,108,21,204,114,197,248,171,222,229,137,242,221,35,126,171,34,200,178,44,139,34,21,189,143,246,145,9,25,116,122,190,124,57,193,17,151,255,0,170,20,125,158,232,61,32,110,168,131,71,172,200,67,121,106,83,49,183,44,203,50,206,179,172,203,109,223,95,146,247,122,221,125,195,175,177,235,228,217,43,101,216,171,203,241,87,185,203,19,229,185,237,250,172,171,42,202,178,44,136,85,246,125,167,52,167,116,218,61,105,197,254,58,103,181,122,62,143,216,180,255,0,133,103,211,71,207,36,96,44,235,58,206,179,44,235,104,253,125,163,183,187,5,201,93,246,239,15,115,235,229,221,236,238,110,245,115,93,138,14,115,241,87,184,250,155,65,101,89,22,69,145,101,94,145,163,214,221,61,215,153,108,234,168,238,221,154,50,16,101,21,43,25,131,27,4,109,31,64,213,153,103,89,214,101,157,98,125,148,147,101,23,55,139,142,228,200,134,24,187,159,203,125,125,91,184,160,214,156,80,185,251,75,93,206,197,94,79,169,136,89,22,69,145,100,89,19,100,162,169,99,197,236,116,15,105,29,11,86,101,157,102,89,150,101,157,98,125,129,113,1,160,146,112,0,35,131,234,62,161,131,254,232,52,0,0,0,110,3,228,62,126,215,175,179,235,228,62,91,150,168,56,160,214,156,86,182,190,210,47,115,177,87,159,83,16,178,44,171,42,200,178,44,171,58,206,179,44,235,58,206,177,62,188,245,143,212,133,152,12,206,57,66,134,140,94,6,180,188,94,127,237,203,214,233,242,127,95,91,175,173,197,106,160,208,118,149,250,219,72,188,187,20,92,113,245,113,11,34,202,178,172,139,34,202,154,250,26,87,180,222,215,65,27,129,230,11,65,89,214,117,157,103,89,214,39,214,154,179,86,105,193,142,155,135,222,127,211,167,85,21,60,98,40,88,26,193,192,124,149,203,213,235,234,245,242,114,242,111,199,214,235,228,235,228,213,27,214,168,59,75,7,109,34,242,113,90,220,85,254,174,33,101,89,22,69,149,100,77,142,138,166,71,155,154,216,36,113,61,3,81,159,71,172,73,201,191,206,89,212,178,95,187,52,64,172,203,50,206,179,172,235,19,234,62,71,181,145,180,185,238,55,53,163,18,74,108,33,181,22,131,67,165,222,216,119,181,191,205,204,251,13,255,0,34,243,245,122,250,221,125,110,190,168,28,86,168,59,75,126,210,46,36,94,139,138,191,214,218,11,34,200,178,44,139,42,244,125,31,182,170,63,10,206,169,147,158,88,137,66,175,179,237,7,170,27,166,209,235,50,81,253,116,204,114,206,179,172,235,50,206,174,123,190,190,90,171,66,118,211,210,198,95,33,223,201,163,155,143,0,169,172,166,7,225,37,89,27,82,158,29,27,200,124,159,119,151,159,173,215,203,187,215,1,0,55,160,209,189,111,197,23,19,138,46,226,175,245,246,219,245,89,22,85,145,100,89,87,162,118,123,167,21,101,218,162,13,30,180,229,46,229,169,76,247,94,133,111,99,253,156,76,49,13,209,234,24,49,231,4,66,47,254,171,50,204,179,44,235,58,186,71,121,43,45,169,174,136,106,83,52,247,147,184,108,142,131,155,186,42,75,46,156,83,210,71,112,222,247,28,92,247,115,113,245,247,225,237,110,249,7,175,182,184,111,87,3,138,223,138,46,59,209,117,234,255,0,97,124,141,89,86,85,149,100,89,23,161,118,63,218,60,215,221,173,163,213,208,127,239,196,97,241,214,94,157,216,86,130,200,115,71,13,101,59,176,252,26,185,88,60,2,206,179,44,235,58,206,174,149,202,162,216,45,171,170,14,138,205,7,54,231,75,119,6,116,234,160,164,130,58,122,104,155,28,12,23,53,141,192,1,228,233,238,151,124,153,114,185,111,197,95,197,23,19,138,37,95,236,111,149,171,34,200,178,44,171,42,20,61,133,105,220,154,215,58,72,40,233,219,215,207,85,196,194,63,66,133,111,98,236,167,190,255,0,65,182,171,169,15,66,224,202,139,191,230,172,203,50,206,179,44,233,245,114,178,209,181,227,115,41,111,214,134,157,194,227,47,241,63,147,122,113,77,99,90,198,180,53,173,23,0,5,192,1,203,215,227,236,183,252,141,119,171,215,215,3,138,195,122,38,252,81,119,31,105,124,193,101,89,22,85,149,100,94,133,216,195,160,214,187,211,173,170,26,91,185,234,135,212,93,255,0,41,121,237,14,211,155,35,91,10,107,90,10,205,94,94,149,15,155,255,0,194,179,224,179,44,234,253,96,2,12,44,180,237,136,175,151,60,52,174,24,55,147,164,28,250,46,240,252,199,119,31,33,60,85,234,255,0,105,124,171,34,202,178,44,171,34,243,58,27,160,182,70,182,53,86,181,69,102,175,63,68,135,205,223,255,0,57,8,244,143,79,108,109,108,106,172,170,106,221,94,126,137,41,143,195,207,172,235,58,115,137,107,90,75,137,184,1,137,36,166,209,93,104,218,145,135,86,102,138,23,98,34,234,238,110,255,0,37,153,92,243,135,169,188,122,151,250,157,62,87,40,159,37,254,214,247,172,139,34,202,178,96,178,47,57,164,154,7,98,235,127,170,217,85,53,183,114,244,201,132,127,248,23,236,238,217,172,202,66,235,133,167,102,215,208,127,134,63,74,30,48,172,232,184,185,160,18,78,0,4,218,16,45,10,246,3,90,113,142,51,136,136,30,63,205,254,75,54,11,54,11,126,30,245,191,228,142,190,227,139,74,200,177,98,200,178,44,136,90,93,179,90,148,129,250,205,178,236,218,10,14,96,95,31,165,17,250,204,191,96,246,167,160,22,161,118,172,113,219,148,113,74,238,80,212,72,32,144,255,0,133,229,102,66,11,173,58,214,119,228,107,65,19,134,64,126,39,117,229,201,103,193,102,193,102,89,176,245,183,249,113,242,111,245,55,250,187,253,77,255,0,35,159,41,247,12,86,69,149,100,89,86,85,149,126,222,237,91,180,11,76,63,94,55,219,149,112,68,253,225,209,83,60,193,25,252,218,192,165,166,158,26,152,94,91,52,79,108,145,184,111,14,97,188,21,14,147,217,22,62,149,62,49,232,53,148,84,245,208,51,120,113,158,49,40,250,134,222,179,44,216,44,197,102,89,176,87,61,195,218,111,91,253,202,239,148,181,164,104,89,86,85,145,100,89,84,86,21,133,107,219,115,221,230,44,250,10,138,233,47,251,148,241,153,15,128,82,84,77,45,68,206,214,154,87,186,71,187,155,156,111,39,15,39,246,147,176,13,7,149,206,190,106,8,102,178,100,105,55,150,250,20,134,38,126,172,1,111,89,150,101,155,5,153,106,200,125,223,167,177,187,229,29,105,66,202,178,96,178,96,178,224,178,175,236,247,98,122,113,80,215,234,205,87,70,203,46,49,197,222,157,35,96,120,255,0,3,157,229,53,186,23,167,218,37,35,239,125,155,106,83,218,81,2,113,17,215,196,99,32,116,14,129,102,89,150,108,22,101,153,106,186,251,184,253,129,112,249,71,90,75,214,85,145,100,89,112,89,80,163,208,173,13,209,150,62,233,45,27,86,90,247,129,188,199,67,22,165,199,161,116,254,95,217,61,179,85,216,50,62,232,109,251,10,174,149,140,231,81,74,91,86,195,249,49,143,89,150,101,155,5,153,102,195,21,155,215,233,238,71,214,232,174,103,231,242,142,66,178,96,178,96,178,172,139,42,22,167,106,52,150,28,79,190,27,18,200,167,129,237,191,117,69,85,245,47,61,47,99,153,229,254,199,118,191,217,214,145,25,53,33,166,183,41,99,157,220,160,169,119,163,203,255,0,3,202,4,57,102,193,102,89,176,89,176,89,149,196,142,62,219,167,147,167,169,191,212,223,235,221,29,253,126,80,214,123,66,203,130,203,130,202,178,96,178,172,184,47,237,135,104,58,99,164,173,147,94,10,235,90,166,90,103,111,255,0,70,107,203,32,31,148,96,15,43,224,154,41,226,55,73,27,218,246,30,78,105,188,40,244,199,179,189,15,210,72,220,31,233,182,92,15,123,134,55,202,198,234,60,254,161,102,89,150,96,179,96,179,96,181,94,125,215,167,178,186,31,234,31,40,107,202,22,76,22,76,22,92,22,92,22,69,253,141,236,175,77,180,129,175,212,168,134,203,150,10,103,95,117,213,53,119,83,66,71,209,239,7,213,22,247,100,45,177,101,146,250,139,42,109,64,222,81,27,227,104,31,77,75,214,108,22,101,153,102,193,102,193,92,92,110,245,119,249,119,251,151,79,86,234,115,252,195,229,11,220,10,203,130,203,130,201,130,200,178,47,217,218,25,162,186,33,4,151,77,106,215,190,186,160,15,192,161,109,193,174,232,231,200,15,213,190,175,236,205,42,180,180,118,105,46,130,177,254,110,227,206,165,187,63,241,196,209,249,173,235,50,204,177,118,11,54,11,23,96,174,36,123,46,158,77,254,227,138,186,149,223,204,223,147,245,156,2,203,130,203,130,203,130,202,178,224,178,163,164,157,175,90,180,81,72,29,69,97,83,65,99,195,118,237,118,3,52,223,152,145,229,191,151,171,62,142,246,141,100,79,4,166,57,39,14,138,55,253,217,163,34,120,143,248,152,2,130,219,178,44,235,94,148,119,21,180,209,84,176,111,184,74,208,235,143,80,179,45,235,54,11,50,222,139,36,62,174,255,0,121,255,0,67,144,242,45,255,0,63,147,203,229,11,22,224,178,224,178,96,178,172,170,147,69,116,110,219,210,90,255,0,245,59,46,130,122,249,71,23,54,157,134,77,81,213,215,92,21,93,177,105,218,54,189,124,158,114,186,186,170,106,202,153,55,107,77,59,204,143,119,230,79,171,53,149,105,89,246,157,57,239,233,42,98,169,143,249,162,112,120,80,105,46,128,195,77,28,154,254,132,88,248,93,191,90,146,176,121,248,157,226,66,204,179,96,183,173,247,5,155,4,65,38,238,62,241,191,214,255,0,64,156,242,213,255,0,168,124,158,73,105,185,101,193,101,193,100,89,48,89,48,67,71,59,48,166,209,152,37,213,175,210,74,198,192,90,55,250,29,25,19,204,127,55,106,52,244,62,187,117,44,219,38,174,124,15,157,176,229,214,230,110,154,149,223,248,194,222,179,96,183,224,175,214,193,102,193,102,193,92,226,61,196,251,79,253,62,167,157,205,255,0,168,124,156,94,240,208,178,96,178,96,178,172,184,44,184,44,184,33,165,29,170,86,89,116,179,23,217,218,61,78,203,33,131,224,53,45,38,74,151,14,161,238,212,63,203,235,203,96,233,169,160,109,65,136,87,198,215,192,238,85,148,135,206,196,239,211,89,67,164,154,63,101,91,176,93,169,89,76,201,92,209,136,100,151,92,246,125,88,224,66,204,179,96,179,96,179,96,179,96,181,92,110,30,251,255,0,167,85,255,0,37,255,0,39,121,201,1,33,101,193,101,193,96,220,17,58,184,34,117,118,85,54,131,104,102,145,105,101,91,90,99,179,40,37,169,99,30,110,18,204,6,172,81,127,91,200,106,170,175,172,171,180,43,101,50,214,85,77,37,68,242,187,23,62,89,92,94,231,30,164,149,143,173,83,100,90,84,22,173,27,181,106,168,234,35,169,136,240,215,137,193,194,254,152,98,169,116,151,69,164,179,162,151,90,39,69,29,173,66,9,4,136,42,0,243,140,254,135,239,234,86,245,191,5,189,102,89,176,89,176,87,94,22,255,0,115,187,216,95,103,86,255,0,185,113,253,7,201,186,196,5,151,5,151,5,151,4,92,91,130,115,203,54,81,185,155,40,80,216,54,14,128,209,203,116,213,207,253,169,104,181,167,117,60,36,178,22,56,114,123,239,119,213,168,48,149,143,174,235,22,178,27,62,170,99,117,149,83,174,91,188,186,205,172,58,178,181,163,143,155,117,238,252,194,107,219,172,210,11,72,188,17,136,32,242,89,176,91,240,91,240,89,176,89,176,90,175,62,249,125,159,92,63,216,75,255,0,73,249,52,201,32,55,96,178,224,178,224,175,44,193,57,230,61,148,72,142,246,40,233,161,50,202,90,200,216,210,247,189,230,230,181,163,18,73,59,128,78,211,109,58,210,45,32,15,46,163,124,230,10,1,141,205,164,131,187,138,224,119,107,1,172,71,50,129,123,128,88,159,92,232,110,151,89,54,211,139,189,13,175,48,86,180,124,84,211,108,191,1,188,183,48,28,194,102,147,104,85,36,110,148,62,174,205,186,141,238,14,214,215,136,54,248,100,29,11,112,234,66,205,130,223,130,223,130,223,130,223,130,223,112,87,97,237,183,250,219,253,77,254,93,106,74,150,243,137,227,195,228,203,200,1,101,89,112,87,150,96,139,203,54,120,132,231,152,239,141,8,216,203,216,153,161,125,156,90,20,148,211,8,237,91,104,58,205,166,3,48,133,195,191,127,228,205,155,248,23,4,53,228,0,173,119,159,98,199,54,146,196,180,234,110,124,13,101,143,85,172,119,194,255,0,245,73,207,242,145,168,86,252,22,252,22,251,194,223,130,222,179,96,181,30,77,222,234,61,109,102,61,188,218,71,201,134,73,1,89,112,87,150,225,130,47,115,46,106,116,142,136,150,114,90,140,140,152,249,38,193,24,217,185,13,36,211,90,234,42,105,131,172,187,24,58,206,166,13,56,57,237,61,244,159,155,240,250,0,140,146,191,30,37,107,56,159,98,237,9,211,27,58,211,150,66,219,54,99,232,150,128,225,232,242,156,95,245,140,220,229,30,152,232,149,159,105,58,86,190,182,54,138,106,203,141,247,205,24,207,244,120,185,203,50,223,130,223,130,204,110,87,235,96,183,224,136,56,251,223,155,168,157,159,118,71,55,244,63,37,23,16,2,197,184,43,203,112,70,71,51,97,58,71,197,221,241,10,225,9,49,242,77,167,137,151,177,71,160,26,9,107,90,145,76,35,180,230,103,161,89,220,253,34,81,156,127,187,109,238,70,73,102,37,247,146,73,36,148,101,145,216,241,246,98,86,141,12,181,234,251,198,54,58,27,158,119,197,186,150,95,233,61,209,91,240,89,176,197,111,193,102,193,102,193,95,126,8,181,196,251,151,79,99,230,173,91,70,62,85,50,221,244,214,63,37,25,31,125,202,253,92,19,158,88,53,19,165,116,93,218,254,231,186,77,130,54,29,68,216,99,0,4,219,115,74,31,96,81,79,125,153,98,7,211,108,156,31,86,239,239,157,253,55,6,35,52,175,218,226,181,156,79,179,172,208,109,41,179,52,134,144,184,182,23,234,84,196,211,119,157,167,126,15,103,215,139,122,128,168,123,67,208,139,27,72,104,234,153,60,146,64,198,206,246,28,207,213,4,73,253,96,135,44,216,44,216,45,248,45,248,44,216,44,216,34,210,71,180,223,237,188,205,189,104,55,155,218,255,0,241,180,59,228,146,247,6,133,147,4,94,99,1,169,210,186,46,239,146,61,209,49,114,77,129,145,146,196,202,120,192,232,163,236,255,0,66,173,59,82,57,64,181,39,6,142,206,111,31,72,148,29,191,164,98,247,39,212,207,81,35,230,47,123,220,92,231,56,222,73,59,201,40,203,35,141,252,125,168,209,237,33,119,103,22,253,110,173,153,95,127,160,190,87,108,181,217,181,58,106,27,220,58,23,45,248,45,248,45,235,126,11,126,11,126,8,180,147,114,233,239,62,106,216,134,97,150,106,118,159,234,105,45,249,37,210,56,58,228,231,150,0,196,249,93,31,118,120,112,87,249,146,98,77,133,145,31,55,192,38,83,198,48,66,54,148,52,167,74,106,108,234,25,239,177,172,131,45,29,54,169,217,146,91,238,154,111,234,34,225,208,35,52,175,218,189,107,56,251,90,219,34,208,163,181,44,233,221,13,117,44,204,158,9,91,189,175,97,188,21,67,219,47,102,150,109,174,38,111,237,234,6,182,134,214,131,227,100,204,24,56,244,114,223,130,204,179,96,179,94,22,108,22,252,17,99,207,186,114,245,75,232,40,171,64,198,25,140,110,254,89,6,255,0,213,191,36,58,105,7,36,233,29,30,194,124,206,139,187,68,249,162,98,228,155,11,98,38,46,73,144,70,221,148,34,97,9,186,11,161,117,80,210,78,89,110,90,205,146,146,140,181,215,58,54,93,223,76,63,148,27,135,82,140,210,205,183,196,163,36,142,55,251,121,187,22,237,26,138,186,186,103,157,17,181,28,202,27,110,16,112,108,78,55,54,160,14,113,28,85,53,109,52,53,148,147,50,106,89,227,108,208,203,25,214,100,145,188,107,53,205,35,120,33,111,193,111,193,102,193,111,193,102,193,111,55,34,9,7,218,111,246,159,180,108,139,66,144,54,249,29,17,116,99,248,217,180,223,17,242,57,145,192,4,249,92,203,154,157,43,162,190,52,79,153,38,30,73,144,178,43,227,229,193,54,6,51,101,54,38,42,122,10,74,170,202,169,155,21,45,60,79,154,105,30,110,107,35,140,107,57,199,160,1,75,167,26,87,105,218,129,238,20,44,190,150,207,140,252,20,177,147,171,127,87,102,61,74,51,202,253,164,92,227,238,3,73,172,55,118,51,165,21,183,219,182,68,15,159,71,166,149,216,213,89,204,197,244,189,95,79,189,188,216,183,172,216,45,248,45,248,44,216,45,248,45,82,79,186,239,245,63,101,219,149,180,237,109,208,189,222,126,46,90,146,99,112,250,28,62,69,46,82,84,72,199,22,28,83,229,116,71,205,242,95,220,147,15,46,9,144,50,43,226,228,155,11,25,179,185,54,54,132,24,211,138,109,147,102,157,4,178,234,64,171,170,99,103,181,30,199,99,28,57,153,6,27,139,243,59,162,116,210,75,183,126,37,25,30,226,79,184,219,58,29,164,54,62,148,232,237,107,233,45,187,46,170,58,202,58,134,111,100,177,155,197,227,139,78,231,52,224,70,10,198,237,171,179,171,23,78,44,173,72,170,102,103,163,218,180,45,117,238,162,180,34,0,77,9,233,197,132,239,97,5,111,193,111,193,111,193,111,193,111,193,102,193,22,56,251,62,158,190,245,130,233,234,121,234,42,107,90,38,237,211,187,205,75,254,237,231,3,249,59,228,66,229,37,92,172,216,36,39,74,232,73,139,151,5,112,132,152,121,112,76,129,145,119,92,184,38,66,214,236,110,65,141,23,4,24,211,138,179,244,11,70,45,29,32,174,115,92,232,219,169,75,1,56,207,80,236,145,142,156,249,5,93,111,218,182,157,169,104,85,25,107,106,231,146,121,164,39,123,158,111,195,144,228,56,4,102,145,199,90,252,85,228,251,148,221,138,105,252,113,90,213,15,58,9,110,186,58,59,110,35,150,7,110,138,181,163,156,68,237,243,98,130,174,8,170,169,164,108,180,211,49,178,197,35,13,237,123,30,47,14,105,28,8,91,240,91,240,91,239,11,126,11,54,11,126,8,180,144,71,187,197,93,73,83,69,56,190,41,163,116,110,227,131,133,215,253,66,154,206,173,170,161,168,23,77,4,142,141,221,110,226,58,31,144,139,142,229,45,92,172,104,98,124,174,134,248,121,32,209,11,140,60,184,38,64,200,251,190,73,144,181,128,53,6,129,112,65,173,76,134,57,36,145,225,172,99,75,156,231,27,131,64,196,146,74,254,217,219,242,209,217,213,55,232,245,154,95,5,16,7,9,159,185,245,31,215,185,189,17,158,87,237,115,69,238,39,221,5,183,102,179,177,157,47,173,6,211,160,136,187,71,42,102,118,51,210,183,53,39,87,69,240,127,2,223,130,223,130,223,130,223,130,205,130,223,130,56,155,145,105,32,143,87,167,185,121,185,105,237,200,25,179,37,208,84,221,193,195,35,143,212,97,242,1,41,207,32,0,165,170,123,26,24,77,229,62,87,68,227,9,225,193,54,49,9,48,114,224,163,167,108,125,208,253,19,34,13,26,155,144,104,24,45,80,131,26,84,122,61,101,79,161,54,61,93,214,173,108,87,218,82,48,227,5,51,247,69,209,242,241,228,212,233,228,151,109,25,94,73,42,255,0,116,180,180,122,214,179,173,203,30,173,244,214,165,13,68,117,84,179,199,153,146,198,117,129,234,57,142,42,203,237,199,64,233,109,50,230,69,164,244,77,109,53,175,70,14,44,157,163,59,111,196,177,251,218,86,252,22,252,22,252,22,245,191,5,191,4,65,36,5,195,217,239,246,112,218,182,125,93,159,80,59,185,163,44,190,236,167,120,112,234,14,42,123,58,178,166,134,169,154,179,193,33,141,227,168,226,58,30,31,111,18,159,41,23,53,75,82,246,119,105,242,186,39,186,11,247,112,76,137,177,95,15,46,10,56,24,206,239,130,108,109,109,205,90,183,45,80,131,26,113,86,127,103,90,49,89,108,212,189,175,174,125,240,217,244,164,227,52,228,113,254,6,111,113,85,214,237,165,104,90,86,133,99,231,174,170,153,243,79,43,206,46,123,138,116,210,60,235,43,201,247,107,111,177,157,56,160,210,139,49,242,62,129,197,176,90,148,109,56,84,82,147,141,215,225,174,205,236,42,195,237,7,70,44,189,41,209,250,182,84,89,245,208,50,118,61,159,198,47,220,113,31,67,136,91,240,91,240,91,240,87,223,130,223,130,205,130,45,36,128,174,242,239,247,50,91,22,144,83,179,40,108,21,96,114,220,199,255,0,216,253,186,92,159,51,155,115,84,147,189,157,217,55,167,72,232,156,248,19,33,108,68,195,203,130,100,12,103,118,155,24,109,205,87,93,130,13,1,6,53,80,88,118,109,125,173,105,213,54,10,10,72,93,60,242,187,115,88,209,226,121,5,91,167,186,67,87,104,61,238,142,206,136,24,44,250,82,112,134,1,207,248,223,189,197,58,161,239,218,226,139,137,199,220,199,171,63,101,90,71,22,137,233,29,103,255,0,162,173,73,238,107,229,117,204,161,169,144,230,36,229,138,79,139,131,93,138,166,180,105,34,173,164,120,125,60,173,214,99,135,249,30,163,138,223,130,223,130,223,130,223,130,196,224,183,224,139,9,55,122,253,61,188,21,148,211,210,84,176,62,9,152,232,222,211,197,174,23,41,236,43,82,170,206,158,242,24,235,226,121,25,226,57,93,246,209,41,207,59,148,147,185,187,5,73,51,163,190,47,4,92,232,156,232,57,112,81,192,200,187,174,92,20,112,53,157,218,107,0,0,43,174,193,92,19,88,212,214,7,109,38,105,13,84,218,43,96,214,95,163,244,82,223,60,209,186,246,214,84,179,13,96,70,248,217,240,243,56,167,207,44,155,104,200,226,73,247,162,69,55,101,90,113,94,93,59,90,25,99,86,78,236,102,137,130,225,1,231,36,99,47,223,98,100,140,18,48,135,70,224,28,215,52,222,8,56,130,10,223,130,223,130,223,130,192,224,183,224,183,224,139,9,32,123,167,79,39,237,123,44,215,210,199,125,161,68,210,240,26,49,146,29,238,103,229,188,125,178,74,124,174,0,53,73,59,155,221,148,249,29,25,48,242,224,135,114,93,7,46,10,58,118,179,186,24,4,200,90,219,152,131,64,193,110,193,110,193,6,181,6,52,226,163,176,104,171,52,39,71,107,7,237,57,227,44,180,234,162,127,250,188,78,223,78,219,190,55,140,220,130,124,242,75,182,157,51,221,138,191,222,170,40,234,105,234,233,39,146,10,184,36,100,208,77,19,139,36,142,70,29,102,189,142,110,33,205,35,2,169,123,74,177,89,161,218,89,86,200,244,198,130,45,183,58,230,54,170,45,194,162,49,225,35,70,87,45,248,45,248,45,248,44,14,11,121,185,111,193,111,193,22,18,110,247,99,97,90,134,178,153,151,89,181,142,115,217,112,194,57,119,186,63,167,22,253,173,122,115,206,1,73,59,154,3,20,179,185,151,196,139,188,209,48,248,38,179,205,23,67,201,69,78,214,119,97,50,48,208,26,131,110,193,110,91,144,104,65,141,56,170,94,206,172,105,104,44,234,134,187,74,171,33,38,149,152,56,83,68,112,51,188,31,209,131,137,85,21,245,21,83,207,82,249,103,149,238,146,73,30,226,231,61,206,55,151,56,157,228,148,249,158,253,164,92,125,242,216,209,91,102,206,210,11,2,186,74,59,90,134,97,53,60,241,28,90,225,129,4,113,107,134,14,105,192,140,10,176,251,105,209,136,104,234,101,142,155,75,168,98,100,85,244,78,118,33,247,102,101,248,186,55,252,7,242,43,126,11,126,11,120,185,111,193,111,193,111,217,91,240,69,151,144,60,155,253,153,246,20,214,245,151,83,102,213,11,155,32,190,55,221,121,142,65,149,227,232,170,172,170,234,155,62,178,50,202,152,30,88,241,254,68,116,59,199,218,133,198,228,249,72,185,170,89,220,222,237,62,87,71,124,94,8,15,55,124,60,184,38,68,35,38,17,250,38,64,214,236,4,214,1,112,64,110,11,114,232,181,0,65,128,226,172,158,205,108,41,107,42,30,201,173,137,216,246,217,212,87,227,35,199,198,254,81,179,137,86,158,145,218,150,133,171,106,87,62,162,190,165,229,242,202,243,137,60,128,224,209,192,12,0,79,157,238,189,200,184,251,174,30,199,72,187,57,210,107,63,74,180,98,177,208,90,84,174,185,205,199,205,79,9,32,186,25,128,35,89,142,187,245,196,45,29,237,199,68,160,180,104,222,32,183,169,218,33,180,104,36,117,242,69,48,23,145,195,91,152,118,231,5,191,5,155,5,155,5,191,5,191,5,137,188,45,251,40,180,146,2,187,3,238,159,181,40,141,181,67,21,246,133,43,59,230,183,124,176,12,79,213,204,225,211,237,34,83,158,64,185,75,59,133,204,82,76,230,95,17,199,162,115,140,68,194,155,24,142,248,121,112,81,194,214,19,16,76,136,55,101,6,221,130,221,135,147,13,200,52,32,198,156,85,141,217,221,129,61,179,106,73,175,51,175,142,138,145,166,231,212,205,118,13,28,154,55,185,220,21,177,166,118,221,125,181,107,213,235,213,75,178,198,55,8,225,137,185,98,140,112,107,83,231,145,251,69,23,184,155,254,192,210,126,202,52,170,139,74,244,94,172,178,120,136,109,69,51,156,68,53,80,223,121,138,64,60,15,2,180,87,182,237,20,130,219,177,106,26,203,82,54,134,90,22,123,200,19,211,205,118,45,115,86,252,22,252,22,252,22,252,22,252,22,108,22,100,70,225,138,35,11,151,79,39,79,39,79,95,167,175,120,230,141,131,104,126,209,162,138,235,38,173,228,128,221,208,204,113,44,250,29,237,251,65,206,34,224,164,152,141,146,165,157,204,238,202,124,134,62,228,160,223,52,76,62,10,56,68,125,208,191,232,163,132,54,246,38,198,5,205,64,112,91,150,236,22,228,26,16,140,28,85,135,160,22,29,69,181,109,84,92,209,123,105,169,154,71,157,169,151,131,24,15,137,224,21,177,167,54,213,85,173,106,84,115,142,154,153,135,186,167,135,132,108,31,230,120,148,249,222,253,190,40,188,147,127,216,90,85,217,46,149,81,105,86,138,214,152,234,35,115,69,77,51,143,115,85,13,248,197,40,30,7,130,209,78,220,52,86,11,118,194,157,177,218,113,53,172,180,172,215,158,250,154,110,32,142,92,138,190,252,22,252,22,252,22,252,22,252,22,252,22,253,149,191,101,22,27,136,246,251,252,131,201,73,108,80,85,89,181,177,235,83,206,194,199,115,105,222,28,222,173,56,133,87,163,182,165,69,153,86,49,97,214,138,78,18,196,114,188,125,126,205,115,142,229,36,132,13,85,44,238,111,118,164,148,179,186,240,68,249,178,96,240,76,136,50,248,124,20,113,6,1,26,100,77,110,194,107,64,193,110,193,110,193,116,91,144,104,189,53,128,226,172,45,0,176,234,45,187,106,162,224,47,109,53,51,8,243,181,50,240,141,128,248,157,193,91,58,117,108,212,218,150,165,77,205,197,148,212,204,119,117,79,23,6,48,127,153,226,159,59,223,182,140,132,222,85,255,0,97,233,103,100,250,81,73,165,58,39,92,97,170,136,134,212,83,184,147,13,84,55,222,98,149,188,71,35,193,104,151,110,90,56,218,235,42,97,77,164,20,205,13,180,172,169,72,243,208,191,159,86,59,131,144,55,160,120,45,248,45,248,46,139,126,11,126,11,126,9,204,247,56,180,162,203,45,141,173,109,169,78,28,250,73,57,158,49,184,253,215,120,21,45,60,210,211,207,27,163,154,55,22,61,142,23,57,174,110,4,31,178,137,82,72,69,193,75,57,110,193,197,75,51,153,124,71,244,78,127,155,38,31,4,214,121,187,225,229,193,71,0,103,118,47,76,96,110,194,99,0,217,92,130,221,130,221,135,146,228,214,132,24,14,42,192,236,238,198,146,212,182,103,214,153,250,205,164,162,141,195,207,84,188,112,111,38,143,137,220,21,181,167,54,197,77,169,106,213,96,47,101,53,52,102,232,105,226,224,200,199,249,157,229,62,119,191,109,25,28,73,42,255,0,177,116,159,179,157,35,161,210,157,19,180,159,71,106,211,59,120,198,57,89,125,238,138,86,225,172,199,45,26,237,190,198,101,52,206,138,207,211,106,104,199,167,89,110,126,126,114,193,126,102,20,10,6,252,16,55,224,183,224,183,224,186,45,248,45,248,34,210,72,8,141,225,111,247,31,75,138,77,35,178,225,190,174,38,255,0,166,196,193,140,177,183,247,163,171,70,254,99,236,130,83,228,35,101,75,49,110,193,82,204,230,223,17,79,121,101,240,248,32,209,25,48,120,40,160,12,238,130,142,32,208,35,9,172,187,101,1,118,11,162,221,130,232,186,43,144,96,65,128,226,172,30,205,108,167,212,86,74,201,237,153,88,125,10,206,107,238,124,156,53,223,247,35,28,92,173,173,50,181,234,237,123,102,184,203,83,37,237,99,27,132,80,198,49,17,196,223,133,141,82,78,247,237,162,242,73,42,255,0,177,237,125,25,181,232,109,235,6,190,90,43,90,138,86,205,77,83,11,181,94,199,55,252,193,226,14,5,88,253,167,211,210,104,158,154,205,5,155,167,108,102,164,111,36,178,158,208,212,227,17,118,87,243,98,5,7,94,129,191,5,191,5,191,5,191,5,191,5,191,101,111,193,57,135,119,184,239,70,195,170,117,179,102,69,255,0,164,84,63,188,99,70,20,242,187,135,70,59,135,45,223,98,151,39,188,139,154,84,178,150,236,21,52,197,189,209,79,121,101,240,248,43,188,221,240,120,40,161,12,190,31,5,20,33,189,216,77,101,215,53,1,118,11,118,11,118,11,118,11,118,11,17,130,13,77,140,38,176,28,85,141,217,213,44,246,109,4,177,86,105,91,153,177,76,77,241,210,135,12,31,81,119,131,55,149,106,105,29,165,93,106,90,182,140,149,85,245,15,47,150,89,14,36,242,0,96,0,224,6,1,62,119,187,111,121,69,231,19,246,84,212,243,71,61,60,175,138,120,222,31,28,145,184,177,236,115,113,14,105,24,130,17,2,135,66,59,90,172,251,176,80,105,3,255,0,64,202,190,188,158,160,171,134,42,138,121,89,44,18,176,62,57,35,112,115,94,215,11,193,4,111,5,2,129,91,214,252,22,252,22,252,22,253,149,191,4,91,121,1,22,146,8,245,186,123,42,106,234,105,232,234,226,108,180,211,48,199,36,111,23,135,52,170,157,20,180,140,99,94,75,50,98,93,75,57,27,199,22,59,248,155,246,17,113,220,164,144,224,210,165,152,141,130,165,148,182,248,138,123,204,100,195,224,174,212,190,31,5,20,65,151,195,224,162,136,55,187,81,198,5,204,64,93,130,28,151,69,209,116,91,176,87,32,2,107,2,107,3,182,149,29,129,29,110,143,104,77,84,115,218,155,81,212,218,141,33,209,65,205,176,112,123,249,187,112,85,53,245,21,51,212,85,62,89,229,123,164,146,73,28,94,247,189,216,151,56,156,73,42,73,158,237,162,139,201,199,236,46,94,207,73,123,43,146,155,71,244,137,211,90,218,14,92,27,230,28,237,106,138,33,206,7,59,123,71,22,45,26,211,171,22,154,223,209,123,90,26,251,50,113,132,145,59,105,142,226,201,27,189,174,28,138,14,226,154,80,114,6,252,22,252,16,55,224,183,139,150,252,23,76,19,153,136,10,239,111,65,111,217,211,217,150,132,90,240,72,47,14,24,58,55,140,175,97,224,66,175,209,155,78,91,54,185,183,252,112,204,50,77,17,220,246,255,0,220,112,62,252,74,115,184,41,36,32,106,149,44,196,119,101,75,41,111,117,224,158,242,203,225,240,64,106,95,7,130,138,32,203,226,240,81,66,27,221,133,28,87,108,160,46,193,1,195,201,187,5,209,110,193,110,87,4,27,189,49,131,50,179,44,58,10,171,78,213,175,134,146,207,129,186,210,207,51,245,88,209,187,245,60,7,21,87,164,45,172,176,52,82,105,40,180,124,131,28,211,228,169,172,111,16,235,178,70,126,238,243,197,73,59,164,239,124,83,230,123,182,145,113,251,63,76,187,42,182,89,107,104,181,162,232,226,113,30,151,67,33,46,165,170,96,225,35,57,242,43,67,251,89,164,142,158,9,133,157,165,12,103,250,69,149,80,253,162,120,186,7,124,109,64,241,64,160,228,13,248,32,120,32,111,193,111,188,45,248,45,248,45,248,39,48,174,99,217,244,242,197,104,232,189,69,110,160,244,187,61,194,120,157,199,81,196,54,70,253,46,199,242,247,194,83,223,117,205,82,202,70,193,82,202,91,221,149,36,165,189,201,253,19,157,168,76,62,8,55,80,152,124,20,81,6,119,62,10,40,67,110,140,5,28,96,108,171,184,33,192,46,139,162,232,183,96,186,32,55,166,176,38,71,196,38,48,27,156,180,103,179,218,3,83,108,85,235,215,72,210,105,168,33,32,207,55,91,190,22,115,113,90,67,167,149,143,125,161,87,230,172,232,220,77,45,159,3,136,130,33,207,248,159,205,197,75,59,159,222,20,249,92,111,114,36,253,148,125,122,203,54,174,10,251,62,170,90,122,200,30,36,134,120,92,88,246,57,184,130,8,82,70,218,61,29,237,69,229,251,162,134,221,99,111,119,33,233,77,27,250,188,42,11,90,138,158,209,179,107,97,170,161,157,129,240,207,3,195,227,123,79,22,144,129,226,129,226,129,64,160,111,64,223,130,232,134,56,45,251,43,162,123,119,5,204,46,158,204,218,22,45,175,65,171,123,170,40,231,132,125,94,194,7,188,146,158,254,10,89,62,18,166,148,183,96,169,100,45,238,148,146,22,247,30,8,157,66,96,240,76,102,165,240,120,40,162,12,238,135,232,162,136,55,187,10,56,238,185,170,235,133,203,162,221,130,232,186,45,216,32,154,221,233,141,81,179,226,81,198,14,218,142,54,189,198,80,214,128,73,36,224,0,84,22,27,106,108,173,15,154,42,203,72,7,49,245,231,106,158,19,187,187,27,165,112,231,149,90,86,221,109,85,125,163,104,75,83,89,51,139,164,154,103,151,189,199,234,84,147,185,219,105,242,29,229,19,246,61,222,191,63,47,63,46,154,118,91,86,211,100,86,154,155,25,207,105,168,178,234,73,116,15,28,117,126,227,186,133,161,157,166,193,12,52,21,130,142,223,212,190,91,42,169,193,178,222,55,249,163,186,65,244,197,117,64,241,64,160,80,40,30,8,30,8,30,11,126,11,126,202,24,236,167,55,112,78,27,199,179,253,157,110,91,20,23,92,41,235,103,132,125,24,242,7,186,146,156,238,10,89,55,52,169,100,213,216,42,89,11,123,162,165,144,179,185,240,79,113,101,240,120,32,53,9,131,193,71,30,173,240,133,20,65,189,208,81,68,27,176,19,27,131,90,183,96,183,96,183,96,186,46,136,11,147,66,99,120,166,55,138,141,155,220,163,140,59,109,49,186,221,226,176,116,82,145,245,86,197,162,216,220,65,49,83,176,235,77,47,70,51,254,251,149,187,165,190,126,134,154,115,67,98,18,64,165,137,251,82,142,115,188,102,254,93,202,73,203,187,207,20,249,75,182,145,119,20,86,63,106,212,209,79,21,85,37,67,224,169,141,193,241,201,27,139,94,215,12,65,4,43,98,197,20,214,55,104,17,190,209,179,70,172,108,180,227,194,174,38,243,147,132,163,197,104,254,150,217,209,218,186,57,107,65,93,68,240,47,124,46,218,97,56,234,200,211,139,29,208,174,168,30,40,30,40,20,10,5,3,193,94,14,8,114,67,28,22,25,85,219,130,123,120,34,55,143,91,127,147,208,180,226,216,184,92,201,252,205,67,127,174,49,173,255,0,16,62,226,83,143,4,247,240,82,190,237,130,165,144,141,130,165,144,183,186,42,89,11,123,159,4,247,234,95,7,130,203,124,30,10,54,6,147,2,138,45,78,232,126,138,40,245,123,176,163,140,13,132,6,230,220,135,37,187,4,57,38,132,208,154,19,27,197,49,188,84,109,248,148,108,25,194,142,48,123,212,198,94,4,190,42,24,35,154,105,170,155,28,44,105,115,222,247,6,181,160,113,36,168,233,132,244,90,46,225,52,248,180,215,74,59,182,159,246,108,57,190,167,5,104,219,21,83,214,218,21,210,212,85,72,111,124,146,184,185,197,73,41,59,105,207,56,148,79,219,90,73,161,182,140,118,166,141,90,211,208,214,55,100,152,157,178,246,239,213,123,78,14,105,228,112,86,69,170,96,179,52,246,157,182,109,109,193,173,180,105,195,157,77,35,183,119,140,23,185,135,168,188,42,43,78,150,26,235,54,182,10,170,41,91,175,20,244,242,9,35,120,230,215,52,144,87,85,213,95,197,3,197,2,129,64,222,129,64,223,130,6,252,22,252,22,253,149,114,123,81,27,199,171,230,109,219,26,188,54,225,81,68,232,126,174,129,228,159,7,251,82,156,83,221,192,169,93,142,169,82,190,237,130,165,125,221,217,82,188,183,186,63,162,149,250,189,207,130,123,181,111,131,193,101,190,31,4,198,106,247,30,10,40,245,123,144,162,143,87,187,10,54,110,98,107,62,20,209,193,48,38,132,208,152,19,7,20,193,197,48,95,180,20,109,248,211,27,241,168,217,127,120,20,108,214,239,124,83,26,29,223,120,172,215,77,226,172,219,36,75,12,83,250,85,112,188,8,162,118,203,79,241,187,130,182,244,146,71,122,109,105,20,193,215,178,154,51,171,19,127,46,39,169,82,74,78,217,78,121,59,72,158,63,111,105,150,128,212,249,253,29,182,37,138,7,56,25,169,36,239,41,165,187,239,198,236,63,49,138,209,155,119,204,208,233,124,31,177,109,35,115,125,37,151,201,68,247,120,186,47,206,241,213,82,215,83,67,89,69,85,21,69,36,173,15,138,120,30,36,142,70,158,45,115,111,4,46,171,175,148,115,64,160,80,40,32,120,32,120,33,201,116,67,146,112,220,19,199,11,211,134,240,139,236,43,26,208,213,198,158,185,208,117,13,157,132,255,0,155,61,114,157,201,60,240,82,29,193,74,239,132,169,95,240,149,51,238,216,55,169,159,119,119,224,165,125,221,209,82,191,87,185,63,162,145,218,183,193,224,137,213,190,15,4,198,234,223,15,130,133,154,183,194,63,69,4,119,119,65,66,203,187,160,161,101,219,1,66,206,1,68,222,73,131,146,96,226,152,56,166,14,33,48,124,65,48,124,73,128,103,76,109,251,97,49,191,188,76,109,253,239,138,141,183,247,163,245,76,110,183,124,134,55,77,226,156,117,174,153,82,80,135,137,106,181,230,225,20,103,89,223,159,37,107,218,194,72,99,156,211,210,59,3,28,103,105,195,248,156,158,242,118,202,115,183,148,93,242,22,152,232,37,71,158,209,235,102,88,96,46,214,150,146,78,242,154,95,231,137,216,95,212,98,180,126,214,124,52,90,99,66,108,154,183,92,61,50,13,105,169,11,191,137,184,190,63,21,103,91,52,145,87,217,54,133,61,101,20,153,39,166,145,178,198,127,54,146,186,250,157,124,161,2,135,36,15,5,211,21,125,251,43,248,87,48,189,63,65,173,144,25,124,144,121,154,150,116,243,114,13,111,248,73,79,224,213,47,0,84,252,143,232,170,126,234,168,63,1,83,157,241,149,57,253,217,189,76,239,221,149,43,174,238,138,145,215,119,71,244,82,58,238,228,254,138,67,171,220,31,209,56,221,220,31,209,12,47,135,193,70,219,175,133,66,205,94,228,126,138,22,93,221,15,209,66,203,182,2,129,151,94,208,169,227,224,20,12,2,224,20,77,228,152,56,166,15,137,52,124,105,131,227,76,31,26,96,253,226,96,191,188,76,23,247,169,130,254,247,197,49,183,247,161,52,95,223,120,160,47,239,188,86,110,253,56,235,119,222,42,71,95,222,159,213,67,79,172,36,168,214,147,238,48,222,229,105,86,235,50,41,76,17,30,12,59,71,234,229,35,201,37,230,242,156,120,162,228,126,220,221,236,116,147,68,234,189,55,71,173,154,170,25,239,5,222,97,247,49,247,110,15,97,189,175,29,28,21,84,98,42,93,55,177,68,204,190,227,95,102,92,201,46,230,248,94,110,113,234,210,22,136,233,156,45,151,71,45,218,122,169,117,67,223,77,173,169,83,31,243,196,251,156,62,187,189,110,168,115,65,2,129,64,166,158,9,167,130,109,167,98,90,244,26,151,250,69,28,240,180,113,189,236,32,38,31,133,48,252,9,142,248,19,29,119,119,130,97,253,222,9,134,238,237,70,110,238,252,20,56,95,16,84,248,119,97,83,11,175,140,42,70,221,221,5,72,219,187,182,170,86,93,176,213,74,203,176,10,153,156,149,59,57,40,27,241,5,11,119,60,40,135,198,19,56,72,163,31,188,241,76,31,189,9,131,247,129,48,95,222,166,15,222,248,166,15,222,248,166,139,251,223,20,49,239,188,86,254,251,197,28,123,239,20,113,239,147,177,239,188,83,205,253,234,145,215,247,190,42,71,95,222,248,166,183,88,9,11,221,201,187,191,85,93,83,172,223,57,168,195,193,187,255,0,84,227,197,19,197,18,175,92,254,72,158,154,88,231,166,149,241,79,27,131,227,146,55,22,61,142,24,130,210,49,4,46,208,180,107,205,65,89,90,203,102,207,101,205,243,54,144,47,148,15,225,153,183,62,255,0,230,189,104,45,185,230,224,182,68,246,29,107,176,186,164,25,169,137,233,52,99,197,205,106,160,181,105,99,173,179,43,160,171,163,144,94,201,233,164,108,177,187,232,230,18,15,144,249,58,174,168,33,205,14,105,169,188,211,120,168,172,235,110,214,160,192,10,122,217,225,3,163,30,64,81,40,121,133,15,69,6,27,148,3,146,128,93,136,84,226,236,66,128,93,180,20,3,227,10,6,252,97,66,223,141,68,63,120,20,67,247,137,159,138,155,248,190,41,184,247,190,40,126,47,138,255,0,107,226,191,218,163,143,123,226,143,227,120,167,126,55,138,118,61,239,138,113,253,242,118,61,239,138,127,226,167,227,222,167,126,42,113,191,188,241,79,117,253,226,145,223,26,119,25,20,142,188,50,242,121,149,60,217,228,36,114,27,145,230,186,249,9,249,58,220,176,42,61,46,196,181,170,232,106,56,190,150,103,68,93,209,218,167,17,208,173,49,179,11,33,210,42,42,91,102,155,113,146,225,73,83,254,56,193,97,255,0,10,236,242,221,212,138,178,178,123,34,168,225,169,104,199,116,100,244,150,50,230,221,213,215,42,43,70,157,149,118,117,100,21,84,175,201,53,52,141,150,55,93,201,204,36,20,81,69,30,104,243,71,154,35,138,60,211,104,116,242,221,137,174,217,123,161,155,243,146,38,184,248,175,227,68,124,104,253,245,119,198,143,226,47,246,136,254,34,63,138,157,248,169,223,136,157,248,169,223,138,157,248,190,41,223,138,157,248,190,41,223,138,157,248,190,41,223,138,157,248,190,41,223,136,157,248,137,223,136,156,127,120,157,141,207,79,63,188,197,63,29,180,243,126,218,144,252,73,238,222,228,243,196,169,29,198,228,78,243,242,81,91,253,165,177,98,78,42,108,107,86,174,134,163,140,148,179,62,23,27,185,234,17,122,211,219,40,178,59,81,212,182,189,56,192,138,168,132,83,93,209,240,234,227,213,192,173,14,180,3,35,183,44,250,219,42,99,153,224,122,92,3,250,163,185,255,0,240,173,22,210,54,180,216,118,253,13,99,157,251,168,166,111,157,31,88,205,206,31,152,242,20,81,77,137,146,75,44,141,100,108,105,115,222,243,115,90,209,137,36,157,192,38,233,30,150,219,150,204,14,38,154,122,141,88,14,235,225,136,8,163,55,117,107,83,249,167,143,137,59,239,39,253,228,255,0,188,159,247,147,190,250,119,223,78,251,233,255,0,125,63,239,167,125,242,159,247,211,254,242,119,223,79,187,58,119,223,79,251,201,255,0,120,222,159,247,147,249,167,159,137,60,241,79,60,83,207,20,227,197,56,148,125,83,242,151,63,92,180,135,7,16,225,136,35,2,22,159,104,254,171,108,253,38,172,48,183,116,53,78,21,81,1,200,54,112,237,81,244,86,220,26,145,219,250,63,73,86,193,129,150,145,238,166,127,212,181,218,224,248,46,207,237,64,214,214,84,213,217,147,17,139,107,32,46,109,253,31,14,191,138,236,230,142,19,51,244,166,150,65,117,225,144,7,204,243,249,70,210,170,116,170,150,123,15,71,169,229,162,177,101,217,168,154,82,5,69,75,62,229,205,193,140,60,70,243,234,158,104,142,41,220,211,185,167,115,79,230,159,205,63,154,127,52,238,105,252,211,185,167,34,143,52,121,163,237,55,124,238,62,211,255,196,0,20,17,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,192,255,218,0,8,1,2,1,1,63,0,0,7,255,196,0,20,17,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,192,255,218,0,8,1,3,1,1,63,0,0,7,255,217,179,77,97,116,99,97,112,32,82,101,102,108,101,99,116,105,111,110,32,53,212,1,0,94,212,1,0,94,212,1,0,94,212,1,0,94,212,1,0,94,212,2,0,144,212,114,74,155,166,105,109,97,103,101,115,166,118,105,100,101,111,115,166,99,111,108,111,114,115,166,97,117,100,105,111,115,169,112,97,114,116,105,99,108,101,115,165,102,111,110,116,115,169,109,97,116,101,114,105,97,108,115,170,99,111,109,112,111,110,101,110,116,115,169,118,97,114,105,97,98,108,101,115,168,117,115,101,114,65,80,73,115,172,117,115,101,114,87,101,98,104,111,111,107,115,212,1,0,94,212,1,0,94,212,1,0,94,212,1,0,94,212,1,0,94,212,1,0,94,212,1,0,94,212,1,0,94,212,1,0,94,212,1,0,94,212,1,0,94,212,1,0,94,212,1,0,94,166,49,46,57,46,51,50];export{AJ as _,MJ as l};
